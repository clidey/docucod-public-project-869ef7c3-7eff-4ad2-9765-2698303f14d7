---
title: "Assertions and Predicates"
description: "Comprehensive reference for all built-in assertions (equality, inequality, floating point, and exception assertions) plus the generic predicate macros (ASSERT_PRED*, EXPECT_PRED*). Includes the AssertionResult pattern, failure messages, and usage best practices with real-world examples."
---

# Assertions and Predicates

This section presents a comprehensive overview of the built-in assertions and predicate macros offered by GoogleTest. Assertions in GoogleTest enable you to verify code behavior, validate test conditions, and produce informative failure messages. Many assertion macros come in pairs, with `EXPECT_` variants producing non-fatal failures that allow test execution to continue, and `ASSERT_` variants generating fatal failures that abort the current function.

> **Include the assertions in your tests by adding:**
>
> ```cpp
> #include <gtest/gtest.h>
> ```

---

## Table of Contents

- [Explicit Success and Failure](#explicit-success-and-failure)
- [Generalized Assertions with Matchers](#generalized-assertions-with-matchers)
- [Boolean Condition Assertions](#boolean-condition-assertions)
- [Binary Comparison Assertions](#binary-comparison-assertions)
- [String Comparison Assertions](#string-comparison-assertions)
- [Floating-Point Assertions](#floating-point-assertions)
- [Exception Assertions](#exception-assertions)
- [Predicate Assertions](#predicate-assertions)
- [Windows HRESULT Assertions](#windows-hresult-assertions)
- [Death Assertions](#death-assertions)

---

## Explicit Success and Failure

These assertions allow explicit control of test success or failure without evaluating expressions, useful in cases where branching logic dictates the test outcome.

### `SUCCEED()`

```cpp
SUCCEED();
```

- Marks a success explicitly at the point it appears.
- Does *not* immediately mark the entire test as successful; the test's final status depends on all assertions.
- Currently has no visible output but may in the future.

### `FAIL()`

```cpp
FAIL();
```

- Generates a fatal failure and aborts the current function.
- Can only be used in `void` returning functions.
- Useful when an unexpected execution path is reached.

### `ADD_FAILURE()`

```cpp
ADD_FAILURE();
ADD_FAILURE() << "Custom failure message.";
```

- Generates a nonfatal failure allowing the test function to continue executing.

### `ADD_FAILURE_AT(file, line)`

```cpp
ADD_FAILURE_AT("my_source.cc", 42);
```

- Generates a nonfatal failure reported at the specified file and line number.

---

## Generalized Assertions with Matchers

Leverage GoogleMock matchers for expressive, readable assertions that produce detailed diagnostics on failure.

### `EXPECT_THAT` / `ASSERT_THAT`

```cpp
EXPECT_THAT(value, matcher);
ASSERT_THAT(value, matcher);
```

- Verifies that *value* satisfies the *matcher*.
- Supports a rich set of built-in matchers (see [Matchers Reference](matchers.md)).
- Generates detailed failure messages describing the mismatch.

**Example:**

```cpp
#include <gmock/gmock.h>

using ::testing::StartsWith;
using ::testing::MatchesRegex;
using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;

EXPECT_THAT(value1, StartsWith("Hello"));
EXPECT_THAT(value2, MatchesRegex("Line \\d+"));
ASSERT_THAT(value3, AllOf(Gt(5), Lt(10)));
```

*Output on failure:* 

```
Value of: value1
  Actual: "Hi, world!"
Expected: starts with "Hello"
```

---

## Boolean Condition Assertions

Check conditions expected to be true or false.

### `EXPECT_TRUE` / `ASSERT_TRUE`

```cpp
EXPECT_TRUE(condition);
ASSERT_TRUE(condition);
```

- Succeeds if *condition* evaluates to true.
- Supports streaming custom failure messages.

### `EXPECT_FALSE` / `ASSERT_FALSE`

```cpp
EXPECT_FALSE(condition);
ASSERT_FALSE(condition);
```

- Succeeds if *condition* evaluates to false.

---

## Binary Comparison Assertions

Compare two values using standard comparison operators.

> **Noteworthy:** When used on pointers, these compare pointer addresses, not contents. For comparing C strings by content, use String Comparison Assertions.

### Equality/Inequality

| Macro         | Operator | Description                               |
|---------------|----------|-------------------------------------------|
| `EXPECT_EQ` / `ASSERT_EQ`    | `==`      | Verify equal                             |
| `EXPECT_NE` / `ASSERT_NE`    | `!=`      | Verify not equal                         |

```cpp
EXPECT_EQ(val1, val2);
ASSERT_NE(ptr1, ptr2);
```

- Evaluates arguments exactly once.
- Support both narrow and wide (`wstring`) strings for types supporting `<<` streaming.

### Order Comparisons

| Macro         | Operator | Description                               |
|---------------|----------|-------------------------------------------|
| `EXPECT_LT` / `ASSERT_LT`    | `<`       | Less than                               |
| `EXPECT_LE` / `ASSERT_LE`    | `<=`      | Less than or equal                      |
| `EXPECT_GT` / `ASSERT_GT`    | `>`       | Greater than                            |
| `EXPECT_GE` / `ASSERT_GE`    | `>=`      | Greater than or equal                   |

---

## String Comparison Assertions

Specifically crafted for comparing **C strings** (`const char*`) or wide C strings (`const wchar_t*`). For `std::string` equality, use `EXPECT_EQ`.

> When comparing C strings to `nullptr`, prefer `EXPECT_EQ(c_string, nullptr)` or `EXPECT_NE(c_string, nullptr)`.

| Macro                     | Description                                   |
|---------------------------|-----------------------------------------------|
| `EXPECT_STREQ` / `ASSERT_STREQ`     | Verifies that two C strings contain equal text  |
| `EXPECT_STRNE` / `ASSERT_STRNE`     | Verifies that two C strings differ               |
| `EXPECT_STRCASEEQ` / `ASSERT_STRCASEEQ` | Verifies equal ignoring case                  |
| `EXPECT_STRCASENE` / `ASSERT_STRCASENE` | Verifies different ignoring case             |

```cpp
EXPECT_STREQ("foo", some_c_string);
ASSERT_STRNE(ptr1, ptr2);
```

- Prints values as UTF-8 if wide strings are used.

---

## Floating-Point Assertions

Due to rounding, floating-point comparisons require special care. GoogleTest provides approximate equality checks based on ULPs (units in last place).

### `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ`

```cpp
EXPECT_FLOAT_EQ(val1, val2);
ASSERT_FLOAT_EQ(val1, val2);
```
- Checks if two `float` values differ by no more than 4 ULPs.
- Properly handles infinities.

### `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ`

```cpp
EXPECT_DOUBLE_EQ(val1, val2);
ASSERT_DOUBLE_EQ(val1, val2);
```
- Same as above but for `double` values.

### `EXPECT_NEAR` / `ASSERT_NEAR`

```cpp
EXPECT_NEAR(val1, val2, abs_error);
ASSERT_NEAR(val1, val2, abs_error);
```
- Verifies the absolute difference between `val1` and `val2` does not exceed `abs_error`.
- Infinity comparisons are handled with special logic.

---

## Exception Assertions

Verify that code throws or does not throw exceptions. Requires exceptions enabled in your build.

| Macro               | Description                                              |
|---------------------|----------------------------------------------------------|
| `EXPECT_THROW` / `ASSERT_THROW` | Verifies a statement throws an exception of a specific type |
| `EXPECT_ANY_THROW` / `ASSERT_ANY_THROW` | Verifies a statement throws any exception                 |
| `EXPECT_NO_THROW` / `ASSERT_NO_THROW` | Verifies a statement does not throw any exception        |

**Usage example:**

```cpp
EXPECT_NO_THROW({
  int n = 5;
  DoSomething(&n);
});
```

---

## Predicate Assertions

For more complex Boolean conditions that require clear failure diagnostics, predicate assertions provide enhanced feedback by printing the values of predicate arguments.

### `EXPECT_PRED1` to `EXPECT_PRED5` / `ASSERT_PRED1` to `ASSERT_PRED5`

```cpp
EXPECT_PRED2(pred_func, val1, val2);
ASSERT_PRED3(pred_functor, val1, val2, val3);
```

- `pred_func` or `pred_functor` must return `bool`.
- On failure, prints call and values of all arguments.

**Example:**

```cpp
bool MutuallyPrime(int m, int n);  // Checks if m and n are coprime
...
EXPECT_PRED2(MutuallyPrime, a, b);  // passes
EXPECT_PRED2(MutuallyPrime, b, c);  // fails and prints b and c
```

**Failure message example:**

```
MutuallyPrime(b, c) is false, where
b is 4
c is 10
```

- For overloaded or template functions, explicit casting may be required.

### `EXPECT_PRED_FORMAT1` to `EXPECT_PRED_FORMAT5` / `ASSERT_PRED_FORMAT1` to `ASSERT_PRED_FORMAT5`

```cpp
EXPECT_PRED_FORMAT2(pred_formatter, val1, val2);
```

- `pred_formatter` is a predicate-formatter function or functor that returns `AssertionResult` and accepts the expressions' textual representations plus values.
- Enables fully customized failure messages.

**Example predicate-formatter:**

```cpp
testing::AssertionResult AssertMutuallyPrime(const char* expr_m, const char* expr_n, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr_m << " and " << expr_n
      << " (" << m << " and " << n << ") are not mutually prime.";
}
...
EXPECT_PRED_FORMAT2(AssertMutuallyPrime, a, b);
```

---

## Windows HRESULT Assertions

Specific assertions for Windows `HRESULT` values.

### `EXPECT_HRESULT_SUCCEEDED` / `ASSERT_HRESULT_SUCCEEDED`

```cpp
EXPECT_HRESULT_SUCCEEDED(expression);
ASSERT_HRESULT_SUCCEEDED(expression);
```

- Verifies that the HRESULT returned denotes a success.

### `EXPECT_HRESULT_FAILED` / `ASSERT_HRESULT_FAILED`

```cpp
EXPECT_HRESULT_FAILED(expression);
ASSERT_HRESULT_FAILED(expression);
```

- Verifies that the HRESULT denotes a failure.
- Failure messages include human-readable error descriptions where possible.

**Example:**

```cpp
CComPtr<IShellDispatch2> shell;
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

---

## Death Assertions

Assertions verifying that code causes the process to terminate, useful for validating fatal errors and preconditions.

> Death tests execute the code in separate processes to verify termination without crashing the main test runner.

### `EXPECT_DEATH` / `ASSERT_DEATH`

```cpp
EXPECT_DEATH(statement, matcher);
ASSERT_DEATH(statement, matcher);
```

- Verify that *statement* causes process termination with non-zero exit.
- `matcher` is a gMock matcher or regular expression against stderr output.
- Supports compound statements.

**Usage example:**

```cpp
EXPECT_DEATH({
  int n = 5;
  DoSomething(&n);
}, "Error on line .* of DoSomething()");
```

### Related macros

- `EXPECT_DEATH_IF_SUPPORTED`
- `EXPECT_DEBUG_DEATH`
- `EXPECT_EXIT`

> See [Death Tests](../advanced.md#death-tests) for detailed guidance.

---

# Additional Notes & Best Practices

- All assertion macros support streaming a custom failure message with `<<`.
- Arguments to the assertions are evaluated exactly once; avoid side effects inside.
- When using predicate assertions with overloaded or templated predicates, explicit casting may be necessary.
- To compare C strings by value, use string comparison assertions rather than general equality assertions.
- For floating-point comparisons, prefer the dedicated floating-point assertions over `EXPECT_EQ` to avoid incorrect failures due to rounding errors.
- Fatal assertions (`ASSERT_*`, `FAIL()`) abort only the current function; if you want to abort the entire test, structure your code accordingly or propagate failures.

---

# See Also

- [Matchers Reference](matchers.md)
- [Advanced GoogleTest Topics](../advanced.md)
- [Death Tests](../advanced.md#death-tests)
- [GoogleTest Primer](primer.md)

---

# Summary Diagram

```mermaid
flowchart TD
  A[Include <gtest/gtest.h>]
  A --> B{Assertion Type}
  B -->|Explicit Success/Failure| C[SUCCEED(), FAIL(), ADD_FAILURE()]
  B -->|Matchers| D[EXPECT_THAT(), ASSERT_THAT()]
  B -->|Boolean Conditions| E[EXPECT_TRUE/FALSE, ASSERT_TRUE/FALSE]
  B -->|Binary Comparison| F[EXPECT_EQ, EXPECT_NE, EXPECT_LT, EXPECT_LE, EXPECT_GT, EXPECT_GE]
  B -->|String Comparisons| G[EXPECT_STREQ, EXPECT_STRNE, EXPECT_STRCASEEQ, EXPECT_STRCASENE]
  B -->|Floating Point| H[EXPECT_FLOAT_EQ, EXPECT_DOUBLE_EQ, EXPECT_NEAR]
  B -->|Exceptions| I[EXPECT_THROW, EXPECT_ANY_THROW, EXPECT_NO_THROW]
  B -->|Predicate Assertions| J[EXPECT_PRED*, ASSERT_PRED*, EXPECT_PRED_FORMAT*, ASSERT_PRED_FORMAT*]
  B -->|Windows HRESULT| K[EXPECT_HRESULT_SUCCEEDED, ASSERT_HRESULT_SUCCEEDED, EXPECT_HRESULT_FAILED, ASSERT_HRESULT_FAILED]
  B -->|Death Assertions| L[EXPECT_DEATH, ASSERT_DEATH, EXPECT_EXIT, ASSERT_EXIT]

  click C "reference/assertions.md#success-failure" "Explicit Success and Failure"
  click D "reference/assertions.md#EXPECT_THAT" "Generalized Assertion (Matchers)"
  click E "reference/assertions.md#boolean" "Boolean Conditions"
  click F "reference/assertions.md#binary-comparison" "Binary Comparison"
  click G "reference/assertions.md#c-strings" "String Comparison"
  click H "reference/assertions.md#floating-point" "Floating Point Comparison"
  click I "reference/assertions.md#exceptions" "Exception Assertions"
  click J "reference/assertions.md#predicates" "Predicate Assertions"
  click K "reference/assertions.md#HRESULT" "Windows HRESULT Assertions"
  click L "reference/assertions.md#death" "Death Assertions"
```
