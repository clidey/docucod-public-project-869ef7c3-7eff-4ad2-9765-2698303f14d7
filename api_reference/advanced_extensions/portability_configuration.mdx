---
title: "Portability & Configuration"
description: "Reference for macros, configuration flags, and platform utility APIs that control test framework execution across compilers and environments. Includes tips for supporting cross-platform projects and integrating in complex build systems."
---

# Portability & Configuration Reference

This reference details the macros, configuration flags, and platform utility APIs that govern the behavior and portability of the GoogleTest framework across a wide range of compilers and operating systems. It provides actionable guidance and rich configuration options for maintaining consistent test framework behavior in cross-platform projects and complex build environments.

---

## Overview

GoogleTest is designed to be portable and configurable to work seamlessly in diverse environments, including various operating systems (Linux, Windows, macOS, etc.) and compilers. This page documents the key portability macros and configuration flags that control how the test framework adapts its execution to the environment.

Users can customize behavior through compile-time macros and configuration headers to ensure GoogleTest integrates smoothly with complex build systems, toolchains, and platform-specific constraints.


---

## Environment Detection Macros

GoogleTest automatically detects the compilation environment, exposing a rich set of macros that describe system features and compiler capabilities. These are central to writing portable tests and conditionally enabling features.

### Platform Macros

| Macro                   | Description                          |
|-------------------------|------------------------------------|
| `GTEST_OS_LINUX`        | Compiled on Linux                   |
| `GTEST_OS_WINDOWS`      | Compiled on Windows (any flavor)   |
| `GTEST_OS_MAC`          | Compiled on Mac OS X or iOS         |
| `GTEST_OS_IOS`          | Specifically iOS                    |
| `GTEST_OS_ANDROID`      | Compilation targeting Android       |
| ...                     | Various others (AIX, FreeBSD, etc.) |

These platform macros are defined to 1 if the platform matches; undefined otherwise.

### Feature-Detection Macros

| Macro                     | Indicates Presence Of                                |
|---------------------------|-----------------------------------------------------|
| `GTEST_HAS_EXCEPTIONS`    | Whether C++ exceptions are enabled                   |
| `GTEST_HAS_RTTI`          | Whether Run-Time Type Information is available      |
| `GTEST_HAS_PTHREAD`       | Whether POSIX threads are usable                      |
| `GTEST_HAS_DEATH_TEST`    | Whether death tests are supported on platform        |
| `GTEST_HAS_POSIX_RE`      | Whether POSIX regex is supported                      |
| `GTEST_IS_THREADSAFE`     | Whether GoogleTest is thread-safe                     |
| `GTEST_HAS_STD_WSTRING`   | Whether `std::wstring` works on this platform         |
| `GTEST_HAS_FILE_SYSTEM`   | Whether file system APIs are available                |

These macros evaluate to `1` or `0` and guide internal framework adaptations.

---

## Configuration Flags & Macros

Customize GoogleTest behavior by defining the following macros and flags in your build environment or custom configuration headers.

### Flag Macros

GoogleTest uses a flag mechanism to control runtime behavior with macros like:

- `GTEST_DEFINE_bool_(name, default_val, doc)` — defines boolean flags.
- `GTEST_DEFINE_int32_(name, default_val, doc)` — defines 32-bit integer flags.
- `GTEST_DEFINE_string_(name, default_val, doc)` — defines string flags.
- `GTEST_FLAG_GET(flag_name)` — reads flag value.
- `GTEST_FLAG_SET(flag_name, value)` — sets flag value.

These enable control over test runs, output verbosity, death test styles, etc.

### Threading and Synchronization

GoogleTest includes abstractions for mutexes, thread-local storage, and notifications adapting to platform facilities:

- On Windows, `Mutex` and `MutexLock` use Win32 APIs.
- On POSIX systems, pthread primitives are leveraged.
- On single-threaded or unsupported systems, dummy implementations exist to preserve API compatibility.

**Macros for threading:**

- `GTEST_HAS_MUTEX_AND_THREAD_LOCAL_` — enable if mutex/thread local storage is provided externally.
- `GTEST_HAS_NOTIFICATION_` — indicate if Notification implementation is provided.

### Logging and Checks

GoogleTest defines logging macros:

- `GTEST_LOG_(severity)` — logs messages with severity level.
- `GTEST_CHECK_(condition)` — fatal check macro that aborts if false.

For custom user environments, these may be overridden.

### Shared Library Support

Configure shared library building and usage with:

- `GTEST_CREATE_SHARED_LIBRARY` — define it to 1 to build gtest as a shared library.
- `GTEST_LINKED_AS_SHARED_LIBRARY` — define it to 1 when linking tests against shared gtest.

### Exception Support

GoogleTest adapts to environments with or without exception support:

- If unknown, GoogleTest tries to detect exceptions at compile time.
- Set `GTEST_HAS_EXCEPTIONS` explicitly if automatic detection is incorrect.

### Death Test Style

Control death test execution style with:

- `GTEST_DEFAULT_DEATH_TEST_STYLE` — default is "fast"; you may use "threadsafe" for compatibility.

### Wide String Support

Control handling of `std::wstring` depending on platform support with:

- `GTEST_HAS_STD_WSTRING`

---

## File System and PATH Utilities

GoogleTest abstracts filesystem and path separators for cross-platform file handling:

- `GTEST_PATH_SEP_` macro — `\` on Windows, `/` on Unix-like systems.
- `GTEST_HAS_ALT_PATH_SEP_` — set to 1 on Windows to indicate an alternate separator exists.

Platform-specific wrappers for file operations like `Stat`, `RmDir`, and path utilities are available under the internal `posix` namespace.

---

## Character Utilities

To ensure proper handling of characters across platforms, GoogleTest offers inline functions wrapping standard libc calls with safe casting:

- `IsAlpha()`, `IsDigit()`, `IsSpace()`, `IsXDigit()`, `ToLower()`, `ToUpper()`

These guarantee that signedness of `char` does not lead to undefined behavior in character classification.

---

## Synchronization Primitives

GoogleTest provides APIs and classes to handle synchronization primitives required for thread safety:

- Classes: `Mutex`, `MutexLock`, `ThreadLocal`, `Notification`.
- On POSIX, backed by pthreads.
- On Windows, backed by Windows kernel primitives.
- Fallback dummy implementations when threading is unsupported.

Refer to the internal implementations for usage consistency.

---

## Utility APIs

Additional utilities include functions for:

- Capturing and retrieving stdout/stderr during tests.
- Parsing environmental variables related to GoogleTest flags.
- Reading and formatting file locations for error reporting.
- Thread counting, with fallback behavior when unsupported.

---

## Tips for Cross-Platform Projects

- **Explicitly define threading support macros** such as `-DGTEST_HAS_PTHREAD=1` when your environment requires.
- **Set shared library flags appropriately**: Use `GTEST_CREATE_SHARED_LIBRARY` when building GoogleTest as a shared library and `GTEST_LINKED_AS_SHARED_LIBRARY` when linking tests.
- Use the `GTEST_OS_*` macros for platform-specific conditional code in your tests.
- When exception support is uncertain, define `GTEST_HAS_EXCEPTIONS` in build configuration.
- When integrating with complex build systems, customize `gtest-port.h` or use the injection point `custom/gtest-port.h`.

---

## Example: Enabling Pthread Support Manually

If GoogleTest fails to detect pthreads support automatically, add:

```cmake
add_compile_definitions(-DGTEST_HAS_PTHREAD=1)
```

or compile with:

```shell
-DGTEST_HAS_PTHREAD=1
```

and ensure your linker uses pthread (e.g., `-pthread` flag).

---

## Troubleshooting Common Issues

<AccordionGroup title="Common Portability & Configuration Issues">
<Accordion title="Threads Not Detected">
Sometimes GoogleTest does not detect pthread support in non-standard environments. Explicitly define `GTEST_HAS_PTHREAD=1` in your build flags and link against pthread.
</Accordion>
<Accordion title="Shared Library Linking Failures">
When building or linking against the shared GoogleTest library, verify that `GTEST_CREATE_SHARED_LIBRARY` and `GTEST_LINKED_AS_SHARED_LIBRARY` are set appropriately.
</Accordion>
<Accordion title="Macro Name Collisions">
If GoogleTest's macros clash with other libraries, use macros like `-DGTEST_DONT_DEFINE_TEST=1` to prefix them, requiring you to use `GTEST_TEST()` instead of `TEST()`.
</Accordion>
</AccordionGroup>

---

## References & Further Reading

- [GoogleTest Portability Internals (gtest-port.h)](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h): Complete list of portability macros and utility APIs.
- [Customization Points README (custom/gtest-port.h)](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/custom/README.md): How to override defaults.
- [Installation Instructions](/getting-started/prerequisites-installation/installation-instructions): Setting up GoogleTest under your platform.
- [Troubleshooting Common Issues](/getting-started/troubleshooting-common-issues/common-setup-issues): Deals with linker errors and environment mismatches.

---

For a structured understanding of how portability fits in the overall GoogleTest framework, consider these related guides:
- [High-Level Architecture](/overview/architecture-features-integration/high-level-architecture)
- [Feature Overview](/overview/architecture-features-integration/feature-overview)
- [Supported Platforms & Integration](/overview/architecture-features-integration/platforms-and-integration)

---

By mastering the macros and flags detailed here, you ensure that your GoogleTest-based tests are robust, portable, and adaptable, regardless of the underlying environment or build system complexities.