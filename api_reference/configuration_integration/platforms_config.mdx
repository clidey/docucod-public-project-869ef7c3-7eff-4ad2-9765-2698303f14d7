---
title: "Platform Support & Configuration"
description: "Describes platform compatibility, configuration flags, and best practices for making tests portable across diverse development environments. Provides references for adapting tests and utilizing key configuration macros."
---

# Platform Support & Configuration

GoogleTest is designed to offer robust and portable testing capabilities across a wide spectrum of platforms and development environments. This page details the platform compatibility considerations, configuration flags, and best practices needed to ensure your tests run reliably and consistently no matter where they are executed. By understanding these facets, you can make your test suites highly portable and adaptable to diverse workflows.

---

## Supported Platforms

GoogleTest conforms to Google's [Foundational C++ Support Policy](https://opensource.google/documentation/policies/cplusplus-support). The policy defines the compiler versions, platforms, and build tools officially supported to maintain stable and consistent functionality.

For a detailed list of supported platforms and compiler versions, refer to the official compatibility matrix [here](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md).

**Key supported platforms include:**

- Major Unix-like systems (Linux, Mac OS X, FreeBSD, OpenBSD)
- Microsoft Windows (Desktop and MinGW variants)
- Fuchsia (supported but not officially guaranteed)
- Various BSD flavors and other POSIX-compliant systems

> Note: Limited or no support exists for embedded or specialized platforms unless explicitly mentioned.

---

## Configuration Flags and Macros

GoogleTest uses a series of configuration macros to adjust behavior depending on environment capabilities and user preferences. These macros enable users to fine-tune GoogleTest's integration with their build systems and platform capabilities.

### Common Configuration Macros

These macros are important for making tests portable and adapting to platform-specific constraints. They are typically defined in the build system or passed as compiler flags.

| Macro                          | Description                                                              | Default / Behavior                                     |
|--------------------------------|--------------------------------------------------------------------------|--------------------------------------------------------|
| `GTEST_HAS_PTHREAD`             | Indicates pthread availability and usage.                              | Auto-detected (1 on POSIX systems with pthread support) |
| `GTEST_HAS_EXCEPTIONS`          | Controls whether exception handling features are enabled.              | Detected based on compiler support                        |
| `GTEST_HAS_RTTI`                | Indicates whether RTTI is enabled on the current platform/compiler.     | Auto-detected                                           |
| `GTEST_HAS_DEATH_TEST`          | Enables death tests, requiring platform support for fork/process.       | Enabled on supported Unix-like and Windows platforms      |
| `GTEST_HAS_STD_WSTRING`         | Indicates if `std::wstring` is fully supported.                         | Enabled on most desktop platforms                          |
| `GTEST_HAS_STREAM_REDIRECTION` | Supports capturing and redirecting stdout/stderr during tests.         | Enabled on platforms with file system access               |

### Examples

Sample compiler flags for enabling pthread support explicitly:

```bash
-DGTEST_HAS_PTHREAD=1
```

To disable exception support if your environment lacks it:

```bash
-DGTEST_HAS_EXCEPTIONS=0
```

### How These Flags Play Together

GoogleTest uses these macros to conditionally compile code, enabling advanced features like death tests or thread safety only when supported. This ensures that tests remain portable without sacrificing capability.

---

## Platform-Specific Best Practices

Achieving maximum portability requires awareness of platform-specific constraints and behaviors. Here are recommended practices for common scenarios:

### 1. Multi-threaded Test Safety

- GoogleTest is thread-safe where pthreads or OS-provided thread libraries are available.
- Confirm thread-safety by checking the macro `GTEST_IS_THREADSAFE` after including `<gtest/gtest.h>`.
- If detection is incorrect in your environment, explicitly set `-DGTEST_HAS_PTHREAD=1` or `0`.

### 2. Building and Linking

- On Windows, watch out for conflicts between static and dynamic runtimes. Use `gtest_force_shared_crt` in CMake builds to align your project's runtime with GoogleTest's.
- When building shared libraries, define `DGTEST_CREATE_SHARED_LIBRARY=1` for GoogleTest and `DGTEST_LINKED_AS_SHARED_LIBRARY=1` when compiling your test executables.
- Ensure all dependencies like pthreads are linked properly for POSIX systems.

### 3. Death Tests

- Require platform support for processes and file systems.
- Typically enabled on Linux, Mac, Windows Desktop; disabled on embedded or restricted systems.
- Use `GTEST_HAS_DEATH_TEST` macro to check availability.

### 4. Exception and RTTI Compatibility

- GoogleTest works best with exceptions and RTTI enabled.
- If your build disables these features, verify `GTEST_HAS_EXCEPTIONS` and `GTEST_HAS_RTTI` macros.
- Some internal GoogleTest features rely on exception support for robust failure handling.

### 5. Stream Redirection

- Capture of stdout and stderr during tests relies on stream redirection.
- Not supported on many embedded platforms or where the filesystem is unavailable.
- Use `GTEST_HAS_STREAM_REDIRECTION` to detect availability.

---

## Adapting Tests for Portability

To ensure your test code works reliably across supported platforms:

- **Check availability of features programmatically.** Use `#ifdef` guards around platform-dependent features.
- **Avoid assumptions about threading and exceptions.** Use the respective macros to detect support before using such features.
- **Write tests that gracefully skip features when unavailable.** For example, death tests should not run on platforms without support.
- **Isolate platform-specific initialization or teardown.** Use fixture setup methods with guards.

For example:

```cpp
#ifdef GTEST_HAS_PTHREAD
// Code that uses multi-threading
#endif

#if GTEST_HAS_EXCEPTIONS
// Code that depends on exceptions
#else
// Alternative implementation or skip
#endif

#ifdef GTEST_HAS_DEATH_TEST
TEST(MyDeathTest, CrashesCorrectly) {
  EXPECT_DEATH(DoSomethingDangerous(), "crash");
}
#endif
```

---

## Configuration in Build Systems

### Bazel Integration

GoogleTest supports Bazel with predefined configurations that handle platform-specific settings automatically.

- Platform constraints like `windows`, `qnx`, `freebsd`, and others are defined in Bazel BUILD files.
- Dependencies on threading, regex, and other system libraries are automatically selected.
- Options for building tests, shared libraries, and linking against Abseil or Fuchsia SDK dependencies are present.

Refer to [BUILD.bazel](https://github.com/google/googletest/blob/main/BUILD.bazel) for an extensive example of such configuration.

### CMake Integration

- GoogleTest provides community-supported CMake files managing platform support.
- Use `gtest_build_tests`, `gtest_force_shared_crt`, and other options to customize your build.
- The build system auto-detects pthread availability and sets appropriate compiler and linker flags.
- Build scripts ensure includes, defines, and dependencies are correctly set per platform.

Example CMake usage:

```bash
cmake -Dgtest_build_tests=ON -Dgtest_force_shared_crt=ON ..
cmake --build .
ctest
```

Refer to the [googletest/CMakeLists.txt](https://github.com/google/googletest/blob/main/CMakeLists.txt) and [googletest/cmake/internal_utils.cmake](https://github.com/google/googletest/blob/main/googletest/cmake/internal_utils.cmake) for full details.

---

## Troubleshooting Platform Compatibility

### Common Issues

| Symptom                         | Cause                                                  | Resolution                                              |
|---------------------------------|--------------------------------------------------------|---------------------------------------------------------|
| Build fails with undefined pthread symbols | Incorrect or missing pthread library linkage         | Add `-lpthread` or configure `find_package(Threads)` correctly in CMake            |
| Runtime errors on Windows linking | Runtime library mismatch (static vs dynamic CRT)        | Enable `gtest_force_shared_crt` option or align runtimes                         |
| Death tests don't run or fail silently | Platform lacks required support                          | Check `GTEST_HAS_DEATH_TEST` availability; skip death tests conditionally          |
| Compilation errors on RTTI or exceptions disabled | Incompatible compiler flags                              | Ensure RTTI and exception support is enabled or set related macros                |

### Diagnosing Feature Availability

Use the macros provided in `<gtest/internal/gtest-port.h>` to query platform capabilities. You can add debug statements or static assertions:

```cpp
#include <gtest/gtest.h>

static_assert(GTEST_HAS_PTHREAD == 1, "Pthreads not supported on this platform");
static_assert(GTEST_HAS_EXCEPTIONS == 1, "Exceptions not enabled");
```

Adjust your build or code based on these diagnostics.

---

## Additional Resources

- [Supported Platforms Table](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md)
- [`<gtest/internal/gtest-port.h>`: Platform Detection Macros and Utilities](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h)
- [Getting Started: Installation and Setup Guide](https://github.com/google/googletest/blob/main/docs/installation-platforms.md)
- [Integration with CMake and Bazel Build Systems](https://github.com/google/googletest/blob/main/guides/integration-and-real-world-scenarios/integrating-with-build-systems.mdx)
- [Troubleshooting Common Issues](https://github.com/google/googletest/blob/main/guides/integration-and-real-world-scenarios/troubleshooting-common-issues.mdx)

---

This comprehensive understanding of platform support and configuration will empower you to create portable, reliable test suites using GoogleTest and GoogleMock across your development environments.

<Check>
Always verify platform capabilities using provided macros before enabling tests that rely on advanced features such as threading, exceptions, or death tests.
</Check>

<Warning>
Building without attention to runtime library compatibility (e.g., on Windows) may cause difficult-to-debug runtime failures. Align runtime settings carefully.
</Warning>

<Note>
Community-based support exists for CMake buildsâ€”maintainers test primarily via Bazel. If you encounter platform-specific build issues, consult community resources.
</Note>
