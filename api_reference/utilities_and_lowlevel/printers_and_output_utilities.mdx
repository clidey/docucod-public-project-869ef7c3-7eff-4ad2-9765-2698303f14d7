---
title: "Printers and Output Utilities"
description: "Explore the API for type-safe and extensible value printing used in assertion result messages and test diagnostics. Includes guidance on customizing printers for user-defined types and understanding output formatting."
---

# Printers and Output Utilities

Explore the API for type-safe and extensible value printing used in assertion result messages and test diagnostics. This page guides you through how GoogleTest prints values in failure messages, how to customize these printers for your user-defined types, and how to understand the output formatting to improve the clarity and usefulness of your test diagnostics.

---

## Overview

When a GoogleTest assertion such as `EXPECT_EQ` or `ASSERT_TRUE` fails, GoogleTest automatically prints the involved values to help you diagnose the cause. The output is generated by a sophisticated, universal value printer designed to handle:

- Built-in types (ints, floats, bools, chars, pointers, etc.)
- STL containers (vectors, maps, sets, tuples, arrays)
- User-defined types
- Smart pointers
- Character arrays and strings with proper escaping

This printer is **type-safe** and **extensible**, meaning you can customize how your own types appear in test output, ensuring clear, readable failure messages that reduce debugging time.

---

## How GoogleTest Prints Values

GoogleTest uses a universal printer implemented as:

```cpp
void ::testing::internal::UniversalPrinter<T>::Print(const T& value, std::ostream* os);
```

This function prints any given value of type `T` into the provided output stream.

### Print Resolution Order

GoogleTest tries the following ways to print the value of type `T`, selecting the first that applies:

1. **User-defined `PrintTo(const T&, std::ostream*)` function**
   - GoogleTest looks for a `PrintTo()` function in the namespace where `T` is defined.
   - This function has priority and overrides other printing behaviors.

2. **User-defined stream insertion operator (`operator<<`)**
   - If no `PrintTo()` exists, GoogleTest attempts to use the stream insertion operator `<<`.

3. **Special printing for standard types and containers**
   - STL containers are printed element-wise as `{ elem1, elem2, ... }` unless `PrintTo()` is defined.
   - Smart pointers print the pointer and value if possible.

4. **Protocol buffer messages**
   - If `T` is a protobuf, it uses its debug string methods for output.

5. **Raw bytes dump**
   - As a last resort, prints the raw bytes of the object as a hex dump.

### Special Cases

- References print both the address and value.
- Character types and strings print with escaping for control and non-printable characters.
- Pointer types print address and for character pointers, also the pointed-to string (if not null).

---

## Printing Built-In and Standard Types

GoogleTest prints primitive types and standard library types with attention to fidelity and readability:

- **Character and string types** get escaped output for control characters (e.g., newline as `\n`), and Unicode characters are printed with code points.
- **Containers** (e.g., vector, map, set) are printed surrounded by braces with elements separated by commas and spaces.
- **Tuples and pairs** are printed with parentheses and element-wise printing.
- **Smart pointers** print as `(nullptr)` if null or as `(ptr = address, value = ...)` if owning.
- **Enums** are printed as their underlying integer value unless an overload exists.

### Example of Container Printing

```cpp
std::vector<int> v = {1, 2, 3};
std::cout << ::testing::PrintToString(v) << std::endl;
// Outputs: { 1, 2, 3 }
```

### Example of String and Char Printing

```cpp
char c = '\n';
std::cout << ::testing::PrintToString(c) << std::endl;
// Outputs: '\n' (10)

const char* s = "Hello\n";
std::cout << ::testing::PrintToString(s) << std::endl;
// Outputs: 0xADDRESS pointing to "Hello\n"
```

---

## Customizing Printers for User-Defined Types

To produce clear diagnostic messages for your own types, you can teach GoogleTest how to print them.

### Preferred Method: Define `PrintTo` Function

In the same namespace as your type `T`, define one of:

```cpp
void PrintTo(const T& value, std::ostream* os);
```

This function should write a textual representation of `value` to the output stream.

**Example:**

```cpp
namespace my_namespace {

class Point {
 public:
  int x, y;

  // Custom PrintTo() for GoogleTest.
  friend void PrintTo(const Point& p, std::ostream* os) {
    *os << "(" << p.x << ", " << p.y << ")";
  }
};

}  // namespace my_namespace
```

GoogleTest will use this overload for printing `Point` instances inside failure messages.

### Alternative Method: Define `AbslStringify` Overload (Advanced)

If your code uses Abseil, you can implement:

```cpp
namespace my_namespace {

template <typename Sink>
void AbslStringify(Sink& sink, const Point& p) {
  absl::Format(&sink, "(%d, %d)", p.x, p.y);
}

}  // namespace my_namespace
```

However, if you define both `PrintTo` and `AbslStringify`, GoogleTest **prefers** `PrintTo` for printing.

### What if Neither `PrintTo` Nor `operator<<` Is Defined?

GoogleTest will print the raw bytes of your object in a hex dump format, which is typically not very helpful. Make sure to provide a `PrintTo` or `operator<<` to improve output quality.

---

## Using `PrintToString` to Get Printable Representations

To convert any value into a string representation using GoogleTest's printers, call:

```cpp
std::string s = ::testing::PrintToString(value);
```

This is especially useful for streaming diagnostic messages in custom assertions or logs:

```cpp
EXPECT_TRUE(IsValid(foo)) << "foo = " << ::testing::PrintToString(foo);
```

---

## Details About Printing Arrays and Strings

GoogleTest carefully prints arrays and strings:

- Character arrays ending with a null terminator are printed as string literals with proper escaping.
- Character arrays without a terminating null include a message `(no terminating NUL)`.
- Escaping is applied for control characters (e.g., `\n`, `\t`), non-ASCII characters in UTF-8, and other special cases.

### Example

```cpp
char str[] = {'H', 'e', 'l', 'l', 'o', '\0'};
std::cout << ::testing::PrintToString(str) << std::endl;
// Outputs: "Hello"
```

---

## Important Tips and Best Practices

- Always define a `PrintTo` function in the same namespace as your type to ensure GoogleTest finds it.
- If your type has an existing streaming operator `operator<<`, consider if it suits test output; if not, `PrintTo` lets you customize test output without changing operator behavior.
- Use `::testing::PrintToString()` in custom assertion messages to get consistent formatting.
- For containers with a large number of elements, GoogleTest truncates printed output after 32 elements with `...` to keep failure messages concise.
- When printing pointers, GoogleTest prints the address and, for character pointers, the string content if non-null.
- For Unicode or UTF-8 strings, GoogleTest prints both hex escapes and a readable text representation when appropriate.

---

## Troubleshooting Common Printing Issues

### Values Print as Raw Bytes

If your objects print as byte dumps (e.g., `16-byte object <EF-12 00-00 ...>`), it means GoogleTest could not find a suitable printer. This usually happens if:

- No `PrintTo` function or `operator<<` exists for your type.
- The printer function is defined in a different namespace or inaccessible.

**Solution:** Make sure to provide a `PrintTo(const YourType&, std::ostream*)` in the same namespace or a suitable `operator<<` overload.

### String Content Not Escaping Properly

If string outputs in assertions look hard to read:

- Verify that your strings are null-terminated or correctly sized.
- Use escaped sequences for special characters to improve readability.

---

## Example Usage

```cpp
#include <vector>
#include <iostream>
#include "gtest/gtest.h"

namespace my {

class Point {
 public:
  int x, y;

  friend void PrintTo(const Point& p, std::ostream* os) {
    *os << "Point(" << p.x << ", " << p.y << ")";
  }
};

}  // namespace my

TEST(PrintTest, VectorOfPoints) {
  std::vector<my::Point> pts = {{1, 2}, {3, 4}};

  EXPECT_EQ(pts.size(), 2);
  // On failure, GoogleTest will print elements of pts using PrintTo().
  EXPECT_EQ(pts[0].x, 1) << "Point 0 is " << ::testing::PrintToString(pts[0]);
}
```

---

## Additional References

- For deeper insights on customizing test output and printers, see the [Advanced GoogleTest Topics](../advanced.md#teaching-googletest-how-to-print-your-values).
- For value-parameterized tests and test naming impacted by printing, see [Advanced Guide](../advanced.md#value-parameterized-tests).
- To understand all assertion macros and their output, refer to [Assertions Reference](reference/assertions.md).
- Explore the [unit tests for printers](https://github.com/google/googletest/blob/main/googletest/test/googletest-printers-test.cc) for many code-level examples.

---

## Summary

This page elucidates the internal and user-facing mechanisms GoogleTest uses to print values in assertion failures and diagnostics. It empowers you to extend or override printing behavior for custom types, ensuring your test outputs are clear and actionable. From native arrays and containers to user-defined classes, detailed guidelines and best practices enable you to achieve readable and informative assertion messages.

---