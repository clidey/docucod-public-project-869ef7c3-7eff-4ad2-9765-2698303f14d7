---
title: "Controlling Mock Strictness"
description: "Describes NiceMock, NaggyMock, and StrictMock and their roles in test suite maintenance. Shows how to select appropriate behaviors for development and CI, with tip-oriented advice for avoiding brittle tests."
---

# Controlling Mock Strictness

GoogleMock (gMock) gives you powerful control over how strictly your mock objects enforce the expectations you set on them. This page explains the three core mock strictness wrappers—`NiceMock`, `NaggyMock`, and `StrictMock`—and how to choose the right one for your testing workflow. It offers practical guidance to balance the need for test robustness with developer productivity, avoiding brittle tests and facilitating smoother test maintenance.

---

## Understanding Mock Strictness

In gMock, a *mock object* can have different behaviors when it encounters calls for which you have not explicitly set expectations. Such calls are called **uninteresting calls**. The strictness level determines whether these calls are ignored, warned about, or treated as errors.

By default, a mock object is **Naggy**, meaning it prints warnings for uninteresting calls but allows the test to continue. The other two wrappers allow you to customize this behavior:

- **`NiceMock`**: Suppresses warnings for uninteresting calls, making tests less noisy.
- **`StrictMock`**: Treats uninteresting calls as test failures, enforcing the strictest verification.

### Key Terms

| Term              | Description                                                                                  |
|-------------------|----------------------------------------------------------------------------------------------|
| Uninteresting Call| A mock method call for which no expectation (`EXPECT_CALL`) was set.                        |
| Unexpected Call   | A mock method call for which there are expectations but none match the actual call.         |
| Nice Mock         | A mock object that silently ignores uninteresting calls without warnings or failures.      |
| Naggy Mock        | A mock object that warns on uninteresting calls but lets tests proceed (default behavior). |
| Strict Mock       | A mock object that considers uninteresting calls as errors, failing the test.              |

---

## Using `NiceMock`, `NaggyMock`, and `StrictMock`

These three template wrappers modify a mock class's behavior regarding uninteresting calls:

### `NiceMock<T>`

Wraps mock class `T`. Ignored uninteresting calls produce no warnings or errors.

```cpp
using ::testing::NiceMock;

NiceMock<MockFoo> nice_mock;
EXPECT_CALL(nice_mock, DoThis());
nice_mock.DoThis();  // Expected call
nice_mock.DoThat();  // Uninteresting, but no warning or error
```

This is ideal when you want to focus on *just* verifying expected calls without noise from extraneous calls.

### `NaggyMock<T>`

Wraps mock class `T`. Prints warnings for uninteresting calls but allows tests to continue.

```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> naggy_mock;
EXPECT_CALL(naggy_mock, DoThis());
naggy_mock.DoThis();  // Expected call
naggy_mock.DoThat();  // Warning: Uninteresting call
```

This is the current *default* behavior of mocks.

### `StrictMock<T>`

Wraps mock class `T`. Any uninteresting call causes a test failure.

```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_mock;
EXPECT_CALL(strict_mock, DoThis());
strict_mock.DoThis();   // Expected call
strict_mock.DoThat();   // Test failure: Uninteresting call
```

This is useful for continuous integration or heavily verifying tests where unexpected calls should never occur.

---

## Practical Guidance for Choosing Strictness

Choosing the right strictness level can save you from brittle tests and improve developer experience.

### Development vs CI

- Use **`NaggyMock`** during active development and debugging to get warnings without breaking tests immediately.
- Use **`NiceMock`** if your test is cluttered with uninteresting call warnings that you want to ignore temporarily.
- Use **`StrictMock`** in continuous integration and production test runs to enforce correctness rigorously.

### Combining With Default Mock Behavior

Remember, uninteresting calls are those without an `EXPECT_CALL`. If you want to allow some calls but suppress warnings on them, explicitly add catch-all expectations:

```cpp
EXPECT_CALL(mock_foo, InterestingMethod(_))  // Expect call with any argument
    .Times(AnyNumber());
```

This tells gMock that these calls are expected and suppresses uninteresting call warnings accordingly.

### When to Avoid Too Strict Tests

Rigid tests treat changes in production code that do not affect behavior as failures. This causes frequent test churn and increases maintenance costs.
- Avoid `StrictMock` for unstable code under heavy refactoring.
- Use `RetiresOnSaturation()` on expectations for repeated calls to avoid sticky failures.

```cpp
EXPECT_CALL(mock_foo, DoSomething()).Times(2).RetiresOnSaturation();
```

- Use **sequences** to ensure calls occur in order without over-constraining the test.

---

## How Do These Wrappers Work?

Each wrapper inherits your mock class and modifies the handling of uninteresting calls:

| Wrapper     | Behavior on Uninteresting Calls                |
|-------------|------------------------------------------------|
| `NiceMock`  | Silently allows, no warnings or error          |
| `NaggyMock` | Prints warnings, allows test to continue       |
| `StrictMock`| Treats uninteresting calls as test failures   |

They attach internally to gMock's verification system to influence mock call reactions.

---

## Example: Using Different Mock Strictness

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(void, DoThat, (), ());
};

void TestNiceMock() {
  NiceMock<MockFoo> nice_foo;
  EXPECT_CALL(nice_foo, DoThis());
  nice_foo.DoThis();    // Passes
  nice_foo.DoThat();    // No warning or error
}

void TestNaggyMock() {
  NaggyMock<MockFoo> naggy_foo;
  EXPECT_CALL(naggy_foo, DoThis());
  naggy_foo.DoThis();   // Passes
  naggy_foo.DoThat();   // Warning printed
}

void TestStrictMock() {
  StrictMock<MockFoo> strict_foo;
  EXPECT_CALL(strict_foo, DoThis());
  strict_foo.DoThis();  // Passes
  strict_foo.DoThat();  // Test failure
}
```

---

## Best Practices & Tips

- **Set expectations before calls:** `EXPECT_CALL` must be in place before exercising the mock.
- **Use `NiceMock` to reduce noise:** If uninteresting call warnings drown others, consider `NiceMock`.
- **Test isolation:** Use `StrictMock` to catch unexpected behavior early but weigh maintenance cost.
- **Use catch-all expectations to explicitly allow otherwise uninteresting calls:**

  ```cpp
  EXPECT_CALL(mock, Method(_)).Times(AnyNumber());
  ```

- **Avoid nesting strictness wrappers:** Nesting `NiceMock` inside `StrictMock` (or combinations) is unsupported.
- **Verify mocks promptly:** Unverified mocks can mask test failures.
- **Customize verbosity:** Control messages with `--gmock_verbose=info|warning|error`.

---

## Troubleshooting

### I get uninteresting call warnings I want to suppress

- Wrap the mock object with `NiceMock`.
- Add catch-all `EXPECT_CALL`s with `Times(AnyNumber())`.
- Confirm you are not accidentally calling methods without expectations.

### Unexpected calls cause failures even in `NiceMock`

- Unexpected calls are always errors regardless of mock type. Use appropriate `EXPECT_CALL`s.

### Tests fail due to excessive calls

- Use `.Times()` to explicitly specify allowed call counts.
- Use `.RetiresOnSaturation()` if you want expectations to become inactive when saturated.

---

## Summary

| Strictness          | Uninteresting Call Handling                  | Use Case                                    |
|---------------------|----------------------------------------------|---------------------------------------------|
| `NiceMock`          | Silently ignored                             | Tests where noise reduction is desired      |
| `NaggyMock` (default)| Warn with message but allow                  | Active development with warnings             |
| `StrictMock`        | Failure; any uninteresting call causes test to fail | CI and high scrutiny environments             |

Choose based on your phase in development and the balance you want between feedback and fragility.

---

## See Also

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — Beginner-friendly intro
- [gMock Cookbook - Nice, Strict, and Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy) — In-depth examples
- [Mocking Reference - NiceMock, NaggyMock, StrictMock](https://google.github.io/googletest/reference/mocking.html#NiceMock) — API reference details
- [Flags - gmock_verbose](https://google.github.io/googletest/reference/flags.html#Flag_gmock_verbose) — Control verbosity

---

## Related Concepts in GoogleMock

- **Uninteresting vs Unexpected Calls:** Understanding this is key to using strictness wrappers correctly.
- **EXPECT_CALL and ON_CALL:** How to set expectations and default behaviors.
- **Sequences and Ordering:** To specify call order.

---