---
title: "Assertions and Predicate Macros"
description: "Complete catalog of built-in assertions (equality, ordering, fatal/non-fatal, exception, death tests) and generic predicate assertions. Provides real-world examples and caveats for assertion usage."
---

# Assertions and Predicate Macros

GoogleTest provides a rich set of assertion macros designed to verify program behavior during testing. This reference catalogs all built-in assertions—from simple Boolean checks to complex predicate assertions—as well as predicate-format macros for more descriptive failure messages. Through real-world examples and practical caveats, you will learn how to use these assertions to write clear and maintainable tests.

---

## 1. Understanding Assertion Types

GoogleTest assertions are divided mainly into `EXPECT_` and `ASSERT_` variants:

- **`EXPECT_` macros**: Generate **non-fatal failures** allowing the test to continue.
- **`ASSERT_` macros**: Generate **fatal failures** causing the current function to abort immediately.

Both kinds support streaming additional failure information for better diagnostics.


## 2. Boolean Assertions

These assertions verify Boolean conditions, providing the foundation for more complex checks.

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

Example:

```cpp
EXPECT_TRUE(is_valid) << "The condition 'is_valid' is false";
ASSERT_FALSE(has_error) << "Unexpected error occurred";
```

## 3. Binary Comparison Assertions

Useful for comparing two values with operators like equality and inequality. Arguments support streaming to display informative error messages when failures occur.

- Equality: `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)`
- Inequality: `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)`
- Ordering: `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE` and their `ASSERT_` variants

**Important Notes:**

- Pointer equality checks are by address; for C strings use specialized string assertions.
- Arguments are evaluated exactly once, so safe to have side-effects.

Example:

```cpp
EXPECT_EQ(actual_count, expected_count) << "Mismatch in count";
ASSERT_LT(value, threshold);
```

## 4. String Comparisons

Assertions specifically tailored for C strings (`char*` or `wchar_t*`), comparing contents rather than addresses:

- `EXPECT_STREQ(str1, str2)`, `ASSERT_STREQ(str1, str2)`
- `EXPECT_STRNE(str1, str2)`, `ASSERT_STRNE(str1, str2)`
- Case-insensitive variants: `EXPECT_STRCASEEQ`, `ASSERT_STRCASEEQ`, `EXPECT_STRCASENE`, `ASSERT_STRCASENE`

They correctly handle `nullptr` and wide strings by converting to UTF-8.

Example:

```cpp
ASSERT_STREQ(user_input, expected_value) << "String mismatch";
EXPECT_STRCASEEQ(header_name, "content-type");
```

## 5. Floating-Point Comparisons

Due to rounding errors, exact equality is not appropriate for floating point. GoogleTest provides specialized assertions:

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)`

These use Units in Last Place (ULPs) or an absolute error for tolerance.

Example:

```cpp
EXPECT_NEAR(computed_pi, 3.14159, 1e-5);
ASSERT_DOUBLE_EQ(calculated_value, expected_value);
```

## 6. Exception Assertions

Require exceptions enabled in your build environment.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)` verifies that a statement throws the expected exception.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)` verifies that some exception is thrown.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)` verifies that no exception is thrown.

Example:

```cpp
EXPECT_THROW(Parse(nullptr), std::invalid_argument);
ASSERT_NO_THROW(Process(data));
```

## 7. Predicate Assertions

When scenarios require verification beyond Boolean conditions or simple comparisons, predicate assertions enable checks against user-defined predicates, with GoogleTest providing helpful failure messages that print the arguments.

### 7.1 Predicate Assertions Without Custom Formatters

Macros:

```cpp
EXPECT_PRED1(pred, val1);
EXPECT_PRED2(pred, val1, val2);
EXPECT_PRED3(pred, val1, val2, val3);
EXPECT_PRED4(pred, val1, val2, val3, val4);
EXPECT_PRED5(pred, val1, val2, val3, val4, val5);
```

Verification succeeds if `pred` returns `true`.

Example:

```cpp
bool MutuallyPrime(int a, int b);  // Returns true if a and b share no common divisors

EXPECT_PRED2(MutuallyPrime, 3, 4);  // Passes
EXPECT_PRED2(MutuallyPrime, 4, 10); // Fails with values printed
```

### 7.2 Predicate Assertions With Custom Formatters

Macros:

```cpp
EXPECT_PRED_FORMAT1(pred_format, val1);
EXPECT_PRED_FORMAT2(pred_format, val1, val2);
// ... up to arity 5
```

Custom predicate-formatter functions return a [`testing::AssertionResult`](#AssertionResult) to express success or failure and can embed detailed explanations.

Example:

```cpp
testing::AssertionResult AssertMutuallyPrime(const char* expr1, const char* expr2, int a, int b) {
  if (MutuallyPrime(a, b)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr1 << " and " << expr2 << " are not mutually prime.";
}

EXPECT_PRED_FORMAT2(AssertMutuallyPrime, x, y);
```

### 7.3 Performance Note

Predicate assertions evaluate each argument **exactly once**, avoiding side effects due to repeated evaluation.

## 8. Explicit Success and Failure

- `SUCCEED()` indicates a test step explicitly succeeded (useful for documentation).
- `FAIL()` generates a fatal failure immediately.
- `ADD_FAILURE()` adds a non-fatal failure that lets the test proceed.

Example:

```cpp
if (!Init()) {
  FAIL() << "Initialization failed.";
}
```

## 9. Windows HRESULT Assertions

Available only on Windows platforms.

- `EXPECT_HRESULT_SUCCEEDED(expr)` / `ASSERT_HRESULT_SUCCEEDED(expr)` checks for successful HRESULT.
- `EXPECT_HRESULT_FAILED(expr)` / `ASSERT_HRESULT_FAILED(expr)` checks for failure HRESULT.

Failing assertions print the HRESULT code and the human-readable system message.

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

## 10. Tips and Best Practices

- Use `ASSERT_` assertions when failure should abort the current test.
- Use custom predicate-formatters when default messages lack clarity.
- Predicate assertions ease diagnosing failing conditions by showing argument values.
- Avoid mixing `EXPECT_` and `ASSERT_` in a way that might continue on fatal failures.
- For comparing C strings, never use `EXPECT_EQ` but `EXPECT_STREQ` instead.
- Use `SCOPED_TRACE` to help locate which call in a helper function caused failure.

## 11. Common Pitfalls

- Overloaded or template predicate functions may require explicit type casts in predicate assertions.

Example:

```cpp
EXPECT_PRED1(static_cast<bool (*)(int)>(IsPositive), 5);
```

- Be aware that `EXPECT_PRED*` macros only support predicates with up to 5 arguments.
- Do not use `ASSERT_*` macros in non-void-returning functions. Use `EXPECT_*` or redesign.

---

## Summary Table of Main Assertion Macros

| Category                | Macro Example                       | Description                                          |
|-------------------------|-----------------------------------|------------------------------------------------------|
| Boolean                 | `EXPECT_TRUE(cond)`                | Checks Boolean condition                              |
| Equality/Ordering       | `ASSERT_EQ(a, b)`, `EXPECT_LT(a, b)` | Compares values                                        |
| String Comparison       | `EXPECT_STREQ(str1, str2)`         | C string content comparison                          |
| Floating-Point          | `ASSERT_FLOAT_EQ(expected, actual)`| Approximate equality with tolerance                  |
| Exception               | `EXPECT_THROW(stmt, ExceptionType)`| Verifies exception throwing                          |
| Predicate Assertions    | `EXPECT_PRED2(pred, val1, val2)`  | Checks custom predicates with automated messages     |
| Predicate Formatters    | `ASSERT_PRED_FORMAT2(formatter, v1, v2)` | Custom formatting of predicate failure messages  |
| Explicit Success/Failure| `SUCCEED()` / `FAIL()`             | To mark an explicit test success/failure            |
| Windows HRESULT         | `EXPECT_HRESULT_SUCCEEDED(hr)`     | Checks success or failure HRESULT on Windows         |

---

For comprehensive examples and advanced usage, consult the [GoogleTest Primer](../primer.md), [Assertions Reference](reference/assertions.md), and [Advanced Assertions Practices](guides/writing-effective-tests/advanced-assertions-practices.mdx).

---

<AccordionGroup title="Example Usage Snippets">
<Accordion title="Using EXPECT_EQ and ASSERT_TRUE">
```cpp
TEST(MathTest, Equality) {
  int result = Compute();
  EXPECT_EQ(result, 42) << "Result should be 42";
  ASSERT_TRUE(result >= 0) << "Result cannot be negative";
}
```
</Accordion>
<Accordion title="Using Predicate Assertions">
```cpp
// A predicate that returns true if a number is even.
bool IsEven(int n) { return n % 2 == 0; }

TEST(PredicateTest, CheckEven) {
  EXPECT_PRED1(IsEven, 4);    // Passes
  ASSERT_PRED1(IsEven, 5);    // Fails, aborting test
}
```
</Accordion>
<Accordion title="Defining a Predicate Formatter">
```cpp
testing::AssertionResult IsEvenWithMessage(const char* expr, int n) {
  if (n % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr << " evaluates to " << n << ", which is not even.";
}

TEST(PredicateFormatterTest, CustomMessage) {
  EXPECT_PRED_FORMAT1(IsEvenWithMessage, 5);
}
```
</Accordion>
</AccordionGroup>