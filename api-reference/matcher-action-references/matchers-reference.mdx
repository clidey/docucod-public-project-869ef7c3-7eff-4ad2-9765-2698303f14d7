---
title: "Matchers Reference"
description: "A structured, alphabetical reference for GoogleTest and GoogleMock matchers, explaining their semantics, parameters, and usage patterns. Includes real-world examples for rapid adoption."
---

# Matchers Reference

Explore this comprehensive, alphabetical reference for matchers in GoogleTest and GoogleMock. Matchers enable expressive, readable, and precise assertions by allowing condition checks on values passed to tests or mocks. Each matcher is explained with its semantics, parameters, real-world usage examples, and best practices.

---

## Overview

Matchers act as predicates that validate values in testing expressions, primarily used with assertions like `EXPECT_THAT` and mock expectations like `EXPECT_CALL`. A matcher can be as simple as `_` (match anything) or more precise with parameterized predicates like `Eq(value)`, `Ge(value)`, or complex user-defined conditions.

Matchers are polymorphic: they adapt to the type of the argument they inspect and provide detailed failure descriptions to improve diagnostics.

## Common Pattern of Using Matchers

Matchers are typically used in the following ways:

```cpp
// Simple equality match
EXPECT_THAT(result, Eq(42));

// Matcher with behavior qualifiers
EXPECT_CALL(mock_obj, Foo(Ge(10)))
    .Times(AtLeast(1))
    .WillOnce(Return(true));

// Wildcard matcher
EXPECT_CALL(mock_obj, Bar(_));  // Accepts any argument
```

---

## Alphabetical List of Matchers

### _ (underscore): Wildcard Matcher

Matches any value of any type without restriction.

```cpp
EXPECT_CALL(mock, Method(_));  // Accepts any argument
EXPECT_THAT(value, _);         // Always matches
```

---

### AllOf(m1, m2, ...): Conjunction Matcher

Matches when **all** of the provided matchers match.

```cpp
EXPECT_THAT(value, AllOf(Ge(0), Lt(10)));  // Checks 0 <= value < 10
```

**Tip:** Use to combine multiple conditions cleanly.

---

### AnyOf(m1, m2, ...): Disjunction Matcher

Matches when **any** of the provided matchers matches.

```cpp
EXPECT_THAT(value, AnyOf(Eq(0), Eq(42)));  // Matches 0 or 42
```

---

### Container Matchers

#### Contains(element_matcher)

Matches containers that contain at least one element satisfying `element_matcher`.

```cpp
EXPECT_THAT(vector, Contains(Ge(10)));
EXPECT_THAT(map, Contains(Pair("key", 42)));
```

#### ElementsAre(e1, e2, ...)

Matches containers whose elements match the given matchers in order.

```cpp
EXPECT_THAT(vec, ElementsAre(1, Ge(2), Lt(10)));  // Exactly 3 elements match
```

#### UnorderedElementsAre(e1, e2, ...)

Matches containers with the given elements in any order.

#### Each(m)

Matches containers where **every element** satisfies matcher `m`.

#### SizeIs(m)

Matches containers whose size satisfies matcher `m`.

#### IsEmpty()

Matches containers or strings that are empty.

---

### Comparison Matchers

| Matcher    | Meaning                                | Example               |
|------------|----------------------------------------|-----------------------|
| Eq(value)  | Equals value (operator==)               | `Eq(42)`              |
| Ne(value)  | Not equal to value                      | `Ne(0)`               |
| Lt(value)  | Less than value                        | `Lt(100)`             |
| Le(value)  | Less than or equal to value            | `Le(5)`               |
| Gt(value)  | Greater than value                     | `Gt(10)`              |
| Ge(value)  | Greater than or equal to value         | `Ge(0)`               |

Example:

```cpp
EXPECT_THAT(x, Ge(10));
EXPECT_CALL(mock, SetValue(Lt(0)));
```

---

### String Matchers

| Matcher     | Description                                  | Example                   |
|-------------|----------------------------------------------|---------------------------|
| StrEq(s)    | Equals string `s` (case-sensitive)           | `StrEq("hello")`        |
| StrNe(s)    | Not equal to string `s` (case-sensitive)     | `StrNe("error")`        |
| StrCaseEq(s)| Equals string `s` (case-insensitive)         | `StrCaseEq("Hello")`    |
| StrCaseNe(s)| Not equal to string `s` (case-insensitive)   | `StrCaseNe("fail")`     |
| StartsWith(prefix) | String starts with `prefix`               | `StartsWith("Error")`   |
| EndsWith(suffix)   | String ends with `suffix`                   | `EndsWith("Happy")`     |
| HasSubstr(substr)  | String contains substring `substr`         | `HasSubstr("world")`    |
| MatchesRegex(regex)| String matches the full regex               | `MatchesRegex("a.*z")`  |
| ContainsRegex(regex)| String contains a substring matching regex | `ContainsRegex("foo.*bar")` |

**Example:**

```cpp
EXPECT_THAT(str, StartsWith("Hello"));
EXPECT_CALL(mock, LogMessage(ContainsRegex("fatal error")));
```


---

### Pointer and Reference Matchers

| Matcher        | Description                                          | Example               |
|----------------|------------------------------------------------------|-----------------------|
| IsNull()       | Matches any null pointer or smart pointer            | `IsNull()`            |
| NotNull()      | Matches any non-null pointer or smart pointer        | `NotNull()`           |
| Pointee(m)     | Pointer whose pointee matches matcher `m`            | `Pointee(Eq(5))`      |
| Ref(variable)  | Argument that references the particular variable      | `Ref(my_var)`         |
| Address(m)     | Object whose address matches matcher `m`              | `Address(Eq(&obj))`   |

---

### Tuple and Pair Matchers

| Matcher     | Description                                    | Example                          |
|-------------|------------------------------------------------|----------------------------------|
| Pair(m1,m2)| Matches std::pair or similar: first matches m1, second matches m2 | `Pair(Ge(0), EndsWith(".txt"))` |
| FieldsAre(m1, m2, ...)| Matches tuples or struct-like objects fieldwise | `FieldsAre(1, "foo", Lt(10))`      |

---

### Special and Utility Matchers

| Matcher           | Description                                             | Example                                   |
|-------------------|---------------------------------------------------------|-------------------------------------------|
| Truly(predicate)  | Matches if the predicate callable returns true          | `Truly([](int x){ return x % 2 == 0; })` |
| Not(m)            | Matches if matcher `m` does **not** match                | `Not(Eq(0))`                              |
| AllArgs(m)        | Matches if all arguments as tuple matches `m`           | Used inside `.With()` clauses               |
| Args&lt;k...&gt;(m)     | Matches a selection of arguments by index                | `.With(Args&lt;0,2&gt;(Lt()))`                      |
| Between(m, n)     | Matches if value is between m and n inclusive            | `Between(1, 10)`                          |

---

## How to Write Custom Matchers

Use the `MATCHER` and `MATCHER_P` macros to define custom matchers succinctly. Your matcher must return a `bool` indicating whether the match succeeded and can optionally stream explanations.

Example:

```cpp
MATCHER(IsDivisibleBy7, "is divisible by 7") {
  return (arg % 7) == 0;
}

EXPECT_THAT(value, IsDivisibleBy7());
```

For parameterized matchers:

```cpp
MATCHER_P(IsWithinRange, range, "is within a certain range") {
  return arg >= -range && arg <= range;
}

EXPECT_THAT(value, IsWithinRange(10));
```

## Behavior on Uninteresting Calls

If a matcher is used in mocks without an explicit `EXPECT_CALL`, calls are uninteresting and may generate warnings unless the mock is marked as `NiceMock`. Use `StrictMock` to elevate warnings to failures for better test hygiene.

## Using Matchers with Mocks

Matchers are vital in `EXPECT_CALL` expressions to verify method invocations precisely:

```cpp
EXPECT_CALL(mock_obj, Method(Ge(0), StartsWith("prefix")))
    .Times(AtLeast(1))
    .WillRepeatedly(Return(true));
```

Use matchers to describe complex conditions on arguments, combinational logic (`AllOf`, `AnyOf`), argument tuples (`Args&lt;&gt;`), and container contents (`Contains`, `ElementsAre`).

## Tips and Best Practices

- Use the wildcard matcher `_` to ignore unimportant arguments.
- Combine matchers using `AllOf()` and `AnyOf()` for robust conditions.
- Use `RetiresOnSaturation()` if the call should only match a limited number of times.
- Prefer `ON_CALL()` to set default behaviors without imposing expectations.
- Group sequences of expectations using `InSequence` or `After` for ordering constraints.
- Suppress uninteresting call warnings with `NiceMock` but be cautious not to hide real problems.
- Write custom matchers for domain-specific logic to keep tests readable and self-explanatory.

## Related Documentation

- [Matchers Guide](https://google.github.io/googletest/gmock_cook_book.html#UsingMatchers)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Actions Reference](reference/actions.md)
- [Assertions Reference](reference/assertions.md)

---

## Example: Using Matchers in Expectations

```cpp
#include <gmock/gmock.h>
using ::testing::_;      // Wildcard matcher
using ::testing::Ge;     // Greater or equal matcher
using ::testing::EndsWith;
using ::testing::Return;

class MockTurtle {
 public:
  MOCK_METHOD(bool, MoveTo, (int x, int y), ());
};

TEST(TurtleTest, MovesCorrectly) {
  MockTurtle turtle;

  EXPECT_CALL(turtle, MoveTo(Ge(0), _))           // x >= 0, y any
      .WillOnce(Return(true));
  EXPECT_CALL(turtle, MoveTo(_, EndsWith(".png")))  // y ends with ".png"
      .Times(0);  // Expects no calls with y ending with .png

  bool success = turtle.MoveTo(10, 5);  // Matches first expectation
  EXPECT_TRUE(success);
}
```

---

# Troubleshooting Matchers

- **Matcher type mismatch:** Template type deduction usually helps, but sometimes explicit casting is required using `SafeMatcherCast<T>(m)`.
- **Ambiguous overloaded functions:** Disambiguate with `Const()` or use fully qualified matcher types.
- **Uninteresting call warnings:** Add `EXPECT_CALL(...).Times(AnyNumber())` or switch to `NiceMock`.
- **Matchers causing compilation errors:** Verify argument and return types match expected signatures.

---

# Further Reading

For deeper mastery, explore these areas:
- Designing and composing *custom matchers*.
- Advanced *argument selection* with `With()`, `Args&lt;&gt;`, and `AllArgs()`.
- Interaction with *actions* controlling mock method behavior.
- Managing *call ordering* using sequences and `After` clauses.

---

GoogleTest's matcher framework offers rich, composable, and expressive constructs for validating behavior and state, helping craft tests that are both precise and maintainable with clear diagnostics when expectations fail.