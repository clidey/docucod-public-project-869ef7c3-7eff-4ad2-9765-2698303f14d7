---
title: "Nice, Naggy & Strict Mocks"
description: "Explains wrappers for tuning strictness of mock objects, their effects on handling unexpected calls, and recommendations for their use in small- and large-scale test suites."
---

# Nice, Naggy & Strict Mocks

GoogleMock provides specialized mock wrappers to control how uninteresting (unexpected and un-expected) calls to mock methods are handled during tests. These wrappers - `NiceMock`, `NaggyMock`, and `StrictMock` - allow developers to tune the strictness level of their mock objects, providing tailored feedback when mock methods are called without explicit expectations.

---

## Why Use Strictness Wrappers?

When a mock method is called without a matching `EXPECT_CALL`, GoogleMock considers it an *uninteresting call*. The default mock behavior is to print a warning for such calls, which can be noisy and sometimes distracting during development or CI runs.

The strictness wrappers give you control over this behavior, to:

- **Suppress warnings** for uninteresting calls (`NiceMock`)
- **Print warnings** as usual (`NaggyMock`)
- **Treat uninteresting calls as test failures** (`StrictMock`)

This control helps write tests that are easier to maintain, less noisy, and better aligned with your testing goals.

---

## Wrappers Overview

### NiceMock

- **Behavior:** Suppresses warnings on uninteresting calls.
- **Use case:** Ideal for large or mature test suites where you don't want test noise from expected but unspecified calls.
- **Construction:** Automatically inherits constructors from the underlying mock.
- **Effect on unexpected calls:** Unexpected calls (calls with expectation but unmatched arguments) still fail.
- **Limitations:** Only affects mock methods defined *directly* in the base mock class using `MOCK_METHOD`. May not work correctly if the destructor is not virtual.

### NaggyMock

- **Behavior:** The default GoogleMock mock behavior
  - Prints warnings on uninteresting calls.
- **Use case:** Ideal when developing or debugging tests, as it alerts you to possibly forgotten expectations.
- **Details:** `NaggyMock<T>` is a subclass of the mock type `T`.

### StrictMock

- **Behavior:** Converts all uninteresting calls into test failures.
- **Use case:** Use sparingly when you want to fully restrict the allowed calls to mocks.
- **Construction & limitations:** Matches `NiceMock` in syntax and constraints.
- **Note:** May cause tests to be brittle and require frequent updates.

---

## Usage Examples

### Creating a NiceMock

```cpp
#include <gmock/gmock.h>

using ::testing::NiceMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
};

TEST(FooTest, NiceMockExample) {
  NiceMock<MockFoo> mock_foo;
  EXPECT_CALL(mock_foo, DoThis());
  // This call is expected
  mock_foo.DoThis();
  
  // Calls to other methods without ExpectCalls cause no warnings
}
```

### Creating a NaggyMock (default behavior)

```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> naggy_foo;
EXPECT_CALL(naggy_foo, DoThis());
naggy_foo.DoThis();

// Uninteresting calls generate warnings
```

### Creating a StrictMock

```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_foo;
EXPECT_CALL(strict_foo, DoThis());

// Any uninteresting or unexpected calls result in failures
strict_foo.DoThis();
```

---

## Key Considerations

- **Inheritance:** These wrappers inherit constructors of the base mock class, allowing seamless substitution.
- **Only direct mock methods are affected:** The wrapper modifiers work only on methods declared directly in the base mock class via `MOCK_METHOD`. Methods mocked in base classes of the mock class won't be affected.
- **Destructors:** The base mock class destructor should be virtual for correct behavior.
- **Default mock behavior:** By default, GoogleMock mocks behave like `NaggyMock`, printing warnings on uninteresting calls.

---

## Best Practices and Recommendations

- **Default to `NiceMock` for large test suites:** Reduces noise and improves maintainability.
- **Use `NaggyMock` for active development:** Helps identify missing expectations without failing tests.
- **Reserve `StrictMock` for critical or tightly controlled interactions:** Be cautious, as tests may become brittle.

---

## Common Pitfalls

- Using `NiceMock` or `StrictMock` with mocks that have non-virtual destructors may produce undefined or unintended behavior.
- Expecting strictness modifiers to apply to mock methods declared in base classes will lead to no effect.
- Nesting strictness wrappers (e.g., `NiceMock<StrictMock<MockFoo>>`) is unsupported.

---

## Advanced Usage

### Supporting Mock Classes With Non-Default Constructors

All wrappers inherit all constructors of the underlying mock, so you can pass constructor arguments naturally:

```cpp
NiceMock<MockClass> nice_mock(arg1, arg2);
StrictMock<MockClass> strict_mock(arg1, arg2);
```

### Allowing Mock Object Leaks

If needed, you can prevent GoogleMock from warning about leaked mocks by:

```cpp
Mock::AllowLeak(&mock_instance);
```

---

## Understanding Uninteresting vs Unexpected Calls

- *Uninteresting calls:* Calls to mock methods with **no** `EXPECT_CALL` set. Defaults to a warning.
- *Unexpected calls:* Calls to mock methods with `EXPECT_CALL`s, but arguments do not match any expectation. Always an error.

The strictness wrappers only change the severity of uninteresting calls.

---

## Related Documentation

- [Creating & Using Mocks](/api-reference/googlemock-api/creating-and-using-mocks)
- [Setting Expectations](/api-reference/googlemock-api/setting-expectations)
- [Effective Mocking Guide](https://google.github.io/googletest/gmock_cook_book.html#effective-mocking)

---

## Summary

The strictness wrappers in GoogleMock provide convenient ways to tune mock object behavior concerning uninteresting calls. They help balance verbosity and test strictness, enabling developers to maintain readable, informative tests without excess noise or brittle failures.

---

<Callout title="Key Notes">
- Use `NiceMock` to suppress warnings from uninteresting calls.
- Use `NaggyMock` (default) to receive warnings.
- Use `StrictMock` to treat uninteresting calls as test failures.
- They only affect mock methods declared directly with `MOCK_METHOD` in the mock class.
- The underlying mock class must have a virtual destructor.
</Callout>

---

## Troubleshooting

- **No effect from strictness wrappers:** Confirm that mock methods are defined directly with `MOCK_METHOD` in the mock class, not in their base classes.
- **Unexpected test failures with `StrictMock`:** Review if uninteresting calls are occurring. Add appropriate `EXPECT_CALL`s or switch to a more permissive wrapper.
- **Warnings despite using `NiceMock`:** Check for mock methods defined in base classes and non-virtual destructors.

---

## Summary Table

| Wrapper      | Behavior on Uninteresting Calls | Use Case                                   |
|--------------|---------------------------------|--------------------------------------------|
| `NiceMock`   | Suppresses warnings              | Large test suites, reduce noise            |
| `NaggyMock`  | Prints warnings (default)        | Development, debugging                      |
| `StrictMock` | Treats as test failures          | Strict validation, last resort for tests   |

---

## Further Reading

Explore related concepts and expand your effectiveness with mocks:

- [Understanding Uninteresting vs Unexpected Calls](#uninteresting-vs-unexpected)
- [Setting Expectations](../api-reference/googlemock-api/setting-expectations)
- [Effective Mocking with GoogleMock](https://google.github.io/googletest/gmock_cook_book.html#effective-mocking)


---

##### Source Code

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googlemock/include/gmock/gmock-nice-strict.h", "range": "1-141"}]} />
