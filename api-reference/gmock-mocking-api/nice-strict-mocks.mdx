---
title: "Nice, Naggy, and Strict Mocks"
description: "Clarifies how to configure the handling of unexpected calls using NiceMock, NaggyMock, and StrictMock wrappers, allowing detailed control over warning, error, or silent behaviors during test execution."
---

# Nice, Naggy, and Strict Mocks

GoogleMock offers fine-grained control over how mock objects behave when they receive calls to methods for which no explicit expectations are set. This control is realized through three wrapper templates: `NiceMock`, `NaggyMock`, and `StrictMock`. These wrappers adjust the reaction of a mock object to uninteresting calls — method invocations with no matching `EXPECT_CALL` in place — allowing you to customize test warnings, errors, or silence during execution.

---

## Understanding Uninteresting Calls

When a mock method is called without a corresponding expectation (`EXPECT_CALL`), the call is considered **uninteresting**. GoogleMock provides several strategies for handling these:

- **Naggy (default)**: Logs a warning message about the uninteresting call but otherwise allows it.
- **Nice**: Suppresses all warnings about uninteresting calls, allowing them silently.
- **Strict**: Treats uninteresting calls as errors, failing the test.

Currently, mocks behave like `NaggyMock` by default, but there is a plan to switch defaults to `NiceMock` in the future for better test maintainability.

---

## Wrapper Templates: NiceMock, NaggyMock, and StrictMock

All three are class templates that you can use to wrap any mock class, inheriting constructors and behavior. For example, for a mock class `MockFoo`, you can create:

```cpp
NiceMock<MockFoo> nice_mock;
NaggyMock<MockFoo> naggy_mock;
StrictMock<MockFoo> strict_mock;
```

Each wrapper:

- Inherits from the original mock class.
- Overrides behavior for uninteresting calls as per its strategy.
- Supports all constructors of the underlying mock class, so you can pass constructor arguments through.

---

### Usage Example

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockWatch {
 public:
  MOCK_METHOD(void, Start, ());
  MOCK_METHOD(void, Stop, ());
};

void Test() {
  NiceMock<MockWatch> nice_watch;   // Suppresses uninteresting warnings.
  NaggyMock<MockWatch> naggy_watch; // Logs warnings on uninteresting calls.
  StrictMock<MockWatch> strict_watch; // Errors on uninteresting calls.

  EXPECT_CALL(nice_watch, Start());
  EXPECT_CALL(strict_watch, Stop());

  nice_watch.Start();      // Ok
  nice_watch.Stop();       // Silently ignored

  naggy_watch.Start();     // Ok
  naggy_watch.Stop();      // Warning printed

  strict_watch.Stop();     // Ok
  strict_watch.Start();    // Test failure (uninteresting call)
}
```

---

## Important Details and Limitations

- **Modeling uninteresting calls only**: The wrappers only affect the treatment of **uninteresting** calls, i.e., calls with **no** matching `EXPECT_CALL`. They do **not** affect **unexpected** calls — calls to methods that have expectations but with arguments or invocation counts that do not satisfy those expectations. Unexpected calls always cause failures.

- **Direct use with `MOCK_METHOD` only**: These wrappers affect only mock methods defined directly using the `MOCK_METHOD` macros within the wrapped class. If the mock method is declared in a base class of the wrapped mock class, the wrappers' behavior on uninteresting calls may not take effect due to compiler limitations.

- **Nesting not supported**: Wrapping an already wrapped mock class (e.g., `NiceMock<StrictMock<MockFoo>>`) is unsupported and will cause compile-time assertions.

- **Destructor considerations**: For reliable behavior, the wrapped mock class's destructor should be virtual. Without a virtual destructor, some callbacks and cleanup related to strictness might not behave correctly.

---

## How It Works Internally

Internally, each wrapper registers with GoogleMock to change the default reaction for this particular mock object instance when uninteresting calls occur:

- **`NiceMock`**: Allows uninteresting calls without warnings.
- **`NaggyMock`**: Prints a warning message when an uninteresting call happens.
- **`StrictMock`**: Makes any uninteresting call a failure.

This registration and deregistration ensure that the wrapped mock object's constructor and destructor run with the correct strictness level matching its uninteresting call policy.

---

## When to Choose Which Wrapper

- **Use `NiceMock`** for cleaner output where certain methods may be called without expectations, and warnings for those are unnecessary. This fosters maintainable tests by not flooding test logs with benign warnings.

- **Use `NaggyMock`** when you want to catch unexpected uninteresting calls but don't want tests to fail outright. This is useful in development phases when exploring call behavior.

- **Use `StrictMock`** to enforce strict adherence to expectations, failing tests immediately if any method is called without an explicit expectation. This is valuable for enforcing precise contract compliance in complex or critical code.

---

## Best Practices and Tips

- Prefer **`NiceMock`** for most tests to reduce noise and increase maintainability unless your test specifically requires strict validation.

- If you encounter warnings about uninteresting calls but are certain those calls are acceptable, wrapping the mock with `NiceMock` or adding a catch-all `EXPECT_CALL` with `Times(AnyNumber())` on those methods is the right approach.

- Avoid nesting these wrappers; choose a single wrapper strategy per mock.

- Always set expectations (`EXPECT_CALL`) before exercising a mock object — this prevents undefined behavior and ensures clear test outcomes.

- Check that your mock classes have **virtual destructors** for correct cleanup, especially when using these wrappers.

- If a wrapped mock class has non-default constructors, you can forward the constructor arguments to the wrapper exactly as needed.

---

## Compile-Time Safety

Applying these wrappers to a mock class that already applies a strictness wrapper will result in a compile-time static assertion, preventing incorrect stacking.

```cpp
using ::testing::NiceMock;
class MyMock : public StrictMock<BaseMock> {}; // This is invalid.
NiceMock<MyMock> nice_mock; // Compile-time error!
```

This keeps the strictness level explicit and avoids confusing combinations.

---

## Troubleshooting

**Symptom:** Uninteresting call warnings clutter test output.

**Solution:** Wrap your mocks in `NiceMock` or add explicit catch-all `EXPECT_CALL`s with `Times(AnyNumber())`.

---

**Symptom:** Uninteresting calls cause test failures.

**Cause:** Using `StrictMock` wrapper.

**Solution:** Either provide explicit expectations for all calls or switch to a `NiceMock` or `NaggyMock` wrapper depending on your needs.

---

## Summary

GoogleMock’s `NiceMock`, `NaggyMock`, and `StrictMock` templates provide powerful, easy-to-use controls over how your mock objects react to unexpected or uninteresting calls. By choosing the appropriate wrapper, you can balance between recognizing unanticipated interactions during development, suppressing noisy warnings in stable tests, or strictly enforcing call expectations.

---

## Further Reading

For more on the use of these wrappers, see:

- [gMock Cookbook, The Nice, the Strict, and the Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [Mocking Reference - NiceMock, NaggyMock, StrictMock](https://google.github.io/googletest/reference/mocking.html#NiceMock)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html#uninteresting-calls)

These provide comprehensive guidance, examples, and best practices to apply these concepts effectively in your test suites.

---

## Source Location

This functionality is implemented in the header file:

```
googlemock/include/gmock/gmock-nice-strict.h
```

and tested extensively in:

```
googlemock/test/gmock-nice-strict_test.cc
```
