---
title: "Printing and Logging Extensions"
description: "Describes printing and logging APIs for customizing test output, assertion failure messages, and value representations. Focuses on value printers, type-specific customization points, and logging facilities for improving the readability and debuggability of test results."
---

# Printing and Logging Extensions

This page details the printing and logging extensions within GoogleTest, focusing on APIs that allow users to customize test output, assertion failure messages, and representations of values. These facilities enhance the readability and debuggability of test results by providing flexible and comprehensive value printing mechanisms and logging capabilities.

---

## Overview

GoogleTest provides a universal printing mechanism that is used throughout the framework to represent test values and messages in assertion failures and logs. This includes specialized printers for built-in types, pointers, arrays, STL containers, user-defined types, and even complex structures like tuples and variants. Logging extensions include facilities to control format, inject semantic colors, and adapt output for different use cases.

Understanding and customizing printing behavior helps you write more informative tests and interpret failures with greater clarity.

---

## Key Concepts and Components

### Universal Value Printing
- **UniversalPrinter<T>::Print(value, ostream_ptr):** Core template that prints a value of any type `T`. It attempts to print the value by:
  1. Calling `PrintTo(const T&, ostream*)` if defined.
  2. Using the stream insertion operator `operator<<` if available.
  3. For containers, printing elements individually.
  4. Printing raw bytes for unprintable types.

- **Customizing Printing:** Define either `PrintTo(const T&, ostream*)` in your type's namespace or operator `<<` for your class to customize how values are printed.

- **Special Support:** Printable support is included for:
  - Built-in scalar types, including chars and wchar_t with special escape sequences.
  - C strings and wide strings (both pointer and array forms), with thoughtful handling of NULL pointers.
  - STL containers (`std::vector`, `std::map`, `std::set`, etc.) printed element-wise with limits on maximum elements for brevity.
  - `std::tuple` and `std::pair` types printed with parentheses and comma-separated elements.
  - Smart pointers (`std::unique_ptr`, `std::shared_ptr`), showing pointer value and dereferenced value if available.
  - `std::optional` and `std::variant`, printed clearly with contained values and active alternatives.
  - User-defined types with `AbslStringify` support if Abseil is enabled.

### Type-Specific Formatting Rules
- **Characters:** Printed with escape sequences when non-printable (e.g. `\n`, `\xFF`), and their code points displayed.
- **Strings:** Printed with escaped characters, showing contents safely even with embedded NULs or control characters.
- **Pointers:** Non-char pointers are printed as raw addresses; char pointers are printed showing both the pointer and the pointed string.
- **Raw Bytes:** For types without printable forms, the bytes of the object are printed in hex with size information, truncating large objects for readability.

### Logging and Assertion Failure Messages
- Assertion macros stream user messages seamlessly; GoogleTest appends them to failure messages.
- Failure messages provide detailed context about the values involved, including custom printing of the operands.
- Support for UTF-8 output and wide strings enhances message clarity on internationalized inputs.
- Colors are used conditionally in console output (configurable with `--gtest_color` flag), improving visibility of test statuses.

---

## Usage Examples

### Printing a User-Defined Type
```cpp
// Suppose you have a class defined as follows:
class MyClass {
 public:
  int x;
  explicit MyClass(int value) : x(value) {}
};

// Option 1: Define PrintTo in your namespace
void PrintTo(const MyClass& obj, std::ostream* os) {
  *os << "MyClass(x=" << obj.x << ")";
}

// Now, when a test framework prints an instance:
MyClass obj(10);
std::cout << testing::PrintToString(obj) << std::endl;
// Output: MyClass(x=10)
```

### Handling Container Printing
```cpp
std::vector<int> v = {1, 2, 3, 4, 5};
std::cout << testing::PrintToString(v) << std::endl;
// Output: { 1, 2, 3, 4, 5 }

std::map<std::string, int> m = { {"a", 1}, {"b", 2} };
std::cout << testing::PrintToString(m) << std::endl;
// Output: { ("a", 1), ("b", 2) }
```

### Customizing Assertion Messages
```cpp
EXPECT_EQ(value1, value2) << "Custom failure message: values differ";
```
The message "Custom failure message: values differ" is appended to the default failure output, helping diagnose issues effectively.

### Printing Smart Pointers
```cpp
std::unique_ptr<int> p(new int(42));
std::cout << testing::PrintToString(p) << std::endl;
// Output: (ptr = 0x12345678, value = 42)

std::unique_ptr<int[]> p_array(new int[3]);
std::cout << testing::PrintToString(p_array) << std::endl;
// Output: (0x12345678)
```

---

## Best Practices

- **Implement `PrintTo()` for complex or domain-specific types** to ensure clear failure reporting without cluttering the global namespace.
- **Avoid overloading `operator<<` in the global namespace** if your type supports AbslStringify or is used in multiple contexts.
- **Use the `UniversalPrinter` and helper functions for ad-hoc printing** in tests or debugging to maintain consistency.
- **For containers, rely on GoogleTest’s built-in container support** — avoid duplicating element-wise printing.
- **Respect resource management when printing smart pointers**; the API prints the pointer and dereferenced value safely.
- **Use custom streaming messages in assertions** judiciously to provide context specific to test failures.

---

## Troubleshooting

- If your type prints as raw bytes (e.g., `16-byte object <XX-XX ... >`), neither a `PrintTo()` nor `operator<<` is defined. Define one of them to improve print readability.
- If printed strings seem mangled, verify encoding and consider wide string printing support.
- For very large containers or arrays, output will be truncated for readability.
- `nullptr` pointers print as 'NULL' or '(nullptr)' for clarity.
- If unexpected characters appear in output, check for unprintable control codes or invalid UTF-8 sequences.

---

## API Reference Highlights

### PrintTo Functions
- Overloads exist for:
  - `char`, `unsigned char`, `signed char`
  - Other characters: `wchar_t`, `char16_t`, `char32_t`
  - C strings, wide strings (including null check)
  - Smart pointers: `std::unique_ptr`, `std::shared_ptr`
  - Strings: `std::string`, `std::wstring`, `std::u8string` (if supported)
  - Containers: element-wise printing
  - Tuples, pairs: formatted with parentheses

### UniversalPrinter Template
- Chooses the appropriate print strategy, falling back to raw bytes if no readable form exists.

### FormatForComparisonFailureMessage()
- Handles formatting values in assertions, choosing safe and human-friendly printing styles depending on the operands' types.

### Logging with Color
- Uses ANSI colors on suitable terminals or platform-specific color APIs to distinguish test statuses.
- Controlled via runtime flag `--gtest_color`.

---

For advanced usage, see the [`api-reference/core-testing-apis/assertions-and-results`](../core-testing-apis/assertions-and-results.md) page for how printing integrates into assertions and failure messages, and the [`guides/core-usage-patterns/assertions-and-matchers-best-practices`](../../guides/core-usage-patterns/assertions-and-matchers-best-practices.md) document for writing robust assertion messages.

---

## Related Pages

- [Mock Classes and Methods](../mocking-and-matchers/mock-classes-and-methods.md)
- [Actions and Behaviors](../mocking-and-matchers/actions-and-behaviors.md)
- [Assertion Macros](../core-testing-apis/assertions-and-results.md)
- [Test Definition and Execution](../core-testing-apis/test-definition-and-execution.md)
- [Community & Further Help](../../getting-started/troubleshooting/community-resources.md)

---

## Code Example: Custom Printing

```cpp
#include <iostream>
#include "gtest/gtest.h"

class Point {
public:
  int x, y;
  Point(int x_val, int y_val) : x(x_val), y(y_val) {}
};

// Define PrintTo in the Point's namespace
void PrintTo(const Point& p, std::ostream* os) {
  *os << "Point(" << p.x << ", " << p.y << ")";
}

TEST(PrintTest, CustomPrintTo) {
  Point p(3, 4);
  EXPECT_EQ("Point(3, 4)", testing::PrintToString(p));
}
```

This example shows how to customize the printed representation of a user-defined `Point` class, improving the test output.

---

## Tips

<Tip>
Use `PrintToString(value)` to get a string representation formatted consistently with test failure messages. This is ideal for debugging and logging.
</Tip>

<Tip>
Wrap assert macros or EXPECT calls with messages streaming custom context to clarify test failures.
</Tip>

<Tip>
Leverage GoogleTest’s container printing to simplify validation of complex data structures without manual formatting.
</Tip>

<Tip>
Be cautious printing very large containers or arrays, as output truncation may hide critical information; use custom logging to output selective elements.
</Tip>

---

## Summary

GoogleTest's printing and logging extensions provide a flexible and comprehensive system to render test-related data clearly and informatively. Through universal printers, type-specific overloads, and customizable user hooks (like `PrintTo` and streaming operators), developers gain control over how values are represented in test results, greatly facilitating debugging and enhancing test clarity. This API page equips users with the knowledge to extend printing behavior and leverage built-in logging options to create enriched test outputs.
