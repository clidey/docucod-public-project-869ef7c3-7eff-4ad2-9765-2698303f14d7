---
title: "Assertions and Expectations"
description: "Reference for the wide variety of assertion macros (EXPECT_*, ASSERT_*) provided by GoogleTest, including custom predicate assertions, death test assertions, and the assertion result API for detailed outcome reporting. Includes how to create user-defined assertions for custom logic."
---

# Assertions and Expectations Reference

GoogleTest equips you with a rich set of assertion macros that empower you to verify your code's behavior precisely and expressively. This reference introduces all available assertions, including common comparisons, predicate assertions for advanced checks, death test assertions for verifying process termination, and the powerful assertion result API for crafting custom validation logic.

Include the main GoogleTest header to access the assertions:

```cpp
#include <gtest/gtest.h>
```

---

## Understanding Assertions: EXPECT_ vs ASSERT_

Most assertion macros come in pairs, starting with `EXPECT_` and `ASSERT_`:

- `EXPECT_` macros record a **nonfatal failure** upon failure, allowing the current test function to continue.
- `ASSERT_` macros record a **fatal failure** and immediately abort the current test function.

Use `EXPECT_` when a failure allows the test to progress meaningfully, and `ASSERT_` when continuation doesn't make sense after failure.

You can add descriptive failure messages by streaming any `ostream`-compatible data after the assertion:

```cpp
EXPECT_TRUE(IsValid(input)) << "Input validation failed for: " << input;
```


---

## Explicit Success and Failure

Sometimes you want to explicitly mark a point in your test as a success or failure rather than testing a condition.

### SUCCEED()

Indicates an explicit success assertion. It does **not** cause the whole test to succeed but can document intent.

```cpp
SUCCEED(); // Marks a successful explicit checkpoint in the test.
```

### FAIL()

Generates a fatal failure that aborts the current function. Useful to indicate unreachable code or forced failure.

```cpp
FAIL() << "Unexpected code path executed.";
```

### ADD_FAILURE()

Generates a nonfatal failure allowing the function to continue.

```cpp
ADD_FAILURE() << "Nonfatal failure encountered.";
```

### ADD_FAILURE_AT(file, line)

Reports a nonfatal failure at a specific file and line number.

```cpp
ADD_FAILURE_AT("foo.cpp", 42) << "Failure at specific location.";
```

---

## Boolean Conditions

### EXPECT_TRUE(condition) / ASSERT_TRUE(condition)

Verifies `condition` is `true`.

```cpp
EXPECT_TRUE(IsPositive(value));
ASSERT_TRUE(PointerIsValid(ptr));
```

### EXPECT_FALSE(condition) / ASSERT_FALSE(condition)

Verifies `condition` is `false`.

```cpp
EXPECT_FALSE(IsEmpty(collection));
ASSERT_FALSE(HasError());
```

---

## Binary Comparisons

These macros compare two values using the respective operator:

<table>
<thead>
<tr><th>Comparison</th><th>Macro</th></tr>
</thead>
<tbody>
<tr><td>Equal</td><td>EXPECT_EQ(val1, val2) / ASSERT_EQ(val1, val2)</td></tr>
<tr><td>Not Equal</td><td>EXPECT_NE(val1, val2) / ASSERT_NE(val1, val2)</td></tr>
<tr><td>Less Than</td><td>EXPECT_LT(val1, val2) / ASSERT_LT(val1, val2)</td></tr>
<tr><td>Less or Equal</td><td>EXPECT_LE(val1, val2) / ASSERT_LE(val1, val2)</td></tr>
<tr><td>Greater Than</td><td>EXPECT_GT(val1, val2) / ASSERT_GT(val1, val2)</td></tr>
<tr><td>Greater or Equal</td><td>EXPECT_GE(val1, val2) / ASSERT_GE(val1, val2)</td></tr>
</tbody>
</table>

**Important:** When comparing C strings (`char*` / `const char*`), these test pointer equality (memory location), not content equality. Use string comparison macros detailed below.

Example:

```cpp
EXPECT_EQ(42, ComputeAnswer());
ASSERT_GT(container.size(), 0);
```


---

## String Comparison

### C Strings

Use these macros to compare the contents of C strings.

| Macro               | Description                                    |
|---------------------|------------------------------------------------|
| EXPECT_STREQ(s1, s2) / ASSERT_STREQ(s1, s2) | Verify strings are equal.                 |
| EXPECT_STRNE(s1, s2) / ASSERT_STRNE(s1, s2) | Verify strings are not equal.             |
| EXPECT_STRCASEEQ(s1, s2) / ASSERT_STRCASEEQ(s1, s2) | Verify strings are equal ignoring case. |
| EXPECT_STRCASENE(s1, s2) / ASSERT_STRCASENE(s1, s2) | Verify strings are not equal ignoring case. |

Examples:

```cpp
EXPECT_STREQ("hello", GetGreeting());
ASSERT_STRNE("error", GetStatusMessage());
EXPECT_STRCASEEQ("Foo", "foo");
```

---

## Floating-Point Comparison

Due to floating-point precision issues, use these macros designed for approximate comparison.

| Macro                  | Description                                |
|------------------------|--------------------------------------------|
| EXPECT_FLOAT_EQ(a, b) / ASSERT_FLOAT_EQ(a, b)   | Compares two floats within 4 ULPs     |
| EXPECT_DOUBLE_EQ(a, b) / ASSERT_DOUBLE_EQ(a, b) | Compares two doubles within 4 ULPs    |
| EXPECT_NEAR(val1, val2, abs_error) / ASSERT_NEAR(val1, val2, abs_error) | Verifies values are within absolute error |

Example:

```cpp
EXPECT_FLOAT_EQ(distance, 10.5f);
ASSERT_NEAR(computed_value, expected_value, 0.01);
```

---

## Exception Assertions

Verify whether code throws exceptions (enabled when exceptions are supported).

| Macro               | Description                              |
|---------------------|------------------------------------------|
| EXPECT_THROW(statement, exception_type) / ASSERT_THROW(statement, exception_type) | Verifies statement throws exception of that type |
| EXPECT_ANY_THROW(statement) / ASSERT_ANY_THROW(statement) | Verifies statement throws any exception     |
| EXPECT_NO_THROW(statement) / ASSERT_NO_THROW(statement)   | Verifies statement does not throw          |

Example:

```cpp
EXPECT_THROW(DoSomething(), std::runtime_error);
ASSERT_NO_THROW(Initialize());
```

---

## Predicate Assertions

For complex validation logic or when you want detailed failure messages with values, use predicate assertions.

### Basic Predicate Assertions

Use `EXPECT_PREDn` / `ASSERT_PREDn` for n=1..5 where you supply a predicate (function or functor) returning `bool`:

```cpp
bool IsPrime(int n); // returns true if prime
EXPECT_PRED1(IsPrime, value);
```

On failure, these print the predicate and argument values.


### Predicate Formatter Assertions

Use `EXPECT_PRED_FORMATn` / `ASSERT_PRED_FORMATn` when you want to customize failure messages precisely. You supply a predicate-formatter function that returns `testing::AssertionResult` and expects expressions and their evaluated values:

```cpp
// Predicate formatter example
::testing::AssertionResult AssertIsEven(const char* expr, int n) {
  if (n % 2 == 0) return ::testing::AssertionSuccess();
  return ::testing::AssertionFailure() << expr << " evaluates to " << n << " which is not even.";
}
EXPECT_PRED_FORMAT1(AssertIsEven, value);
```

This approach lets you craft informative messages that improve debugging.

### Crafting Predicate Functions Using AssertionResult

You can also write predicate functions returning `testing::AssertionResult` to get rich messages with `EXPECT_TRUE` or `EXPECT_FALSE`:

```cpp
::testing::AssertionResult IsPositive(int n) {
  if (n > 0) return ::testing::AssertionSuccess() << n << " is positive";
  else return ::testing::AssertionFailure() << n << " is not positive";
}
EXPECT_TRUE(IsPositive(x));
```

---

## Assert that Value Matches Matcher: EXPECT_THAT and ASSERT_THAT

GoogleTest integrates with GoogleMock matchers for expressive assertions:

```cpp
#include <gmock/gmock.h>
using ::testing::StartsWith;
using ::testing::MatchesRegex;
using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;

EXPECT_THAT(str, StartsWith("Hello"));
ASSERT_THAT(value, AllOf(Gt(5), Lt(10)));
```

Matchers read like English and provide rich failure messages. See the [Matchers Reference](../matchers.md) for details.

---

## Windows HRESULT Assertions

GoogleTest supports verifying Windows `HRESULT` values:

```cpp
EXPECT_HRESULT_SUCCEEDED(expression);
ASSERT_HRESULT_FAILED(expression);
```

These macros verify whether the `HRESULT` indicates success or failure and provide formatted error messages.

---

## Death Assertions

Death tests verify that a statement causes your program to terminate as expected.

| Macro                      | Description                                                    |
|----------------------------|----------------------------------------------------------------|
| EXPECT_DEATH(statement, matcher) / ASSERT_DEATH(statement, matcher) | Verifies `statement` causes termination and stderr matches `matcher` |
| EXPECT_DEATH_IF_SUPPORTED(statement, matcher) / ASSERT_DEATH_IF_SUPPORTED(statement, matcher) | Conditional death test if supported |
| EXPECT_DEBUG_DEATH(statement, matcher) / ASSERT_DEBUG_DEATH(statement, matcher) | Runs death test only in debug mode |
| EXPECT_EXIT(statement, predicate, matcher) / ASSERT_EXIT(statement, predicate, matcher) | Verifies exit code and stderr match |

Example:

```cpp
ASSERT_DEATH({
  AbortProgram();
}, "segmentation fault");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

**Important:** Death tests run `statement` in a separate process, so their side effects are not visible in the parent.

---

## Creating User-Defined Assertions

You can create custom assertions for complex validation by writing predicate functions returning `testing::AssertionResult`. This allows detailed failure messages and seamless integration with `EXPECT_TRUE`.

Example:

```cpp
::testing::AssertionResult IsSorted(const std::vector<int>& v) {
  if (std::is_sorted(v.begin(), v.end())) {
    return ::testing::AssertionSuccess();
  } else {
    return ::testing::AssertionFailure() << "Vector is not sorted";
  }
}

TEST(MyTest, CustomAssertion) {
  std::vector<int> data = {1, 3, 2};
  EXPECT_TRUE(IsSorted(data));
}
```

---

## Tips and Best Practices

- Prefer `EXPECT_` macros when possible to continue test execution after failures, improving coverage.
- Use `ASSERT_` macros to stop a test when continuing makes no sense (e.g., failed preconditions).
- For complex boolean expressions, use predicate assertions or assertion results instead of verbose manual failure messages.
- When testing exceptions, ensure your build environment enables exceptions.
- Use death assertions carefully, respecting their process-separation behavior.
- Stream detailed failure messages to assertions for clearer diagnostics.

---

## Troubleshooting Common Issues

- **Assertion Macros Only Work In Void Functions with Fatal Failures:** Fatal assertions terminate the current function; thus, avoid using them in non-void functions or constructors/destructors.
- **Predicate Assertion Overloads:** For overloaded or templated predicate functions, you may need to explicitly specify types to resolve ambiguity.
- **Death Test Failures:** Death tests must truly cause process termination. Verify the death predicate, matcher, and test environment.•
- **Misuse of EXPECT_EQ with C Strings:** Use the string comparison macros instead.

---

For an exhaustive list of assertions, see the official [Assertions Reference](assertions.md).

---

## Summary

This reference details all macros and functions related to assertions and expectations in GoogleTest, covering basic boolean checks, value comparisons, string and floating-point comparisons, exception assertions, predicate assertions for advanced usage, Windows HRESULT checks, and death tests for fatal cases. Learn how to write custom assertion logic for expressive tests and understand the distinctions between assertion types.

---

## References

- [Assertions Reference](assertions.md) – Complete list of assertion macros with examples.
- [Matchers Reference](matchers.md) – Using GoogleMock matchers with `EXPECT_THAT`.
- [Advanced Guide: Assertions and Matchers Best Practices](../guides/writing-and-running-tests/assertions-and-matchers-best-practices.mdx)
- [Advanced Guide: Death Tests](../docs/advanced.md#death-tests)
- [Registering Tests Programmatically](../docs/advanced.md#registering-tests-programmatically)

---

## See Also

- [Test Cases and Fixtures API](test-case-api.md)
- [GoogleMock Expectations API](expectations-api.md)
- [Exception Handling in GoogleTest](reference/assertions.md#exceptions)

---

*End of Assertions and Expectations Reference*