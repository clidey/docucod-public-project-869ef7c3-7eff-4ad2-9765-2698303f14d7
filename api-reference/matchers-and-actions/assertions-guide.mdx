---
title: "Assertions Guide"
description: "Complete guide to available assertion macros, including equality and inequality assertions, fatal and non-fatal versions, and practical guidance on choosing the right assertion for typical testing situations."
---

# Assertions Guide

GoogleTest provides a rich and comprehensive suite of assertion macros to help you verify the correctness of your C++ code during tests. This guide explains the available assertion macros, how to use them effectively, and tips for choosing the right assertion according to your testing scenarios.

---

## Overview of Assertions

Assertions let you check whether certain conditions hold true during test execution. If an assertion fails, GoogleTest will record the failure and report it in test results.

Assertion macros follow two main categories:

- **Non-fatal assertions** (prefixed with `EXPECT_`): A failure here records the failure but allows the test to continue.
- **Fatal assertions** (prefixed with `ASSERT_`): A failure immediately aborts the current function, stopping further execution therein.

You can always append custom failure messages using the streaming `<<` operator to provide clearer diagnostics.

```cpp
EXPECT_TRUE(condition) << "Condition failed because ...";
ASSERT_EQ(x, y) << "x and y expected to be equal";
```

---

## Using Explicit Success and Failure

Sometimes, your test's success or failure depends on flow control rather than boolean expressions. GoogleTest provides assertions for explicit success and failure:

### SUCCEED()

- Generates a documented success inside a test. It does *not* cause the test to pass if other assertions fail.
- Primarily used to mark points in test flow explicitly as passed.

Example:

```cpp
SUCCEED() << "Reached this point in the test";
```

### FAIL()

- Generates a fatal failure, aborting the current function.
- Can only be used in `void` functions (e.g., test functions).

Example:

```cpp
if (unexpected_condition) {
  FAIL() << "Unexpected condition encountered";
}
```

### ADD_FAILURE()

- Generates a non-fatal failure, allowing the function to proceed.

Example:

```cpp
if (mild_error) {
  ADD_FAILURE() << "Non-fatal failure, but should be checked";
}
```

### ADD_FAILURE_AT(file, line)

- A variant of `ADD_FAILURE()` which reports the failure at a custom file and line number.
- Useful when reporting failures inside helper functions.

---

## Generalized Assertions Using Matchers

GoogleTest supports powerful matchers from GoogleMock for expressive assertions.

### EXPECT_THAT(value, matcher)

- Asserts that a value matches a given matcher.
- Matchers support complex conditions and provide readable failure messages.

```cpp
EXPECT_THAT(my_string, StartsWith("Hello"));
EXPECT_THAT(my_number, AllOf(Gt(5), Lt(10)));
```

Refer to the [Matchers Reference](matchers.md) for comprehensive information.

---

## Boolean Assertions

Use these straightforward macros to check simple boolean conditions.

| Assertion          | Description                               |
|--------------------|-------------------------------------------|
| `EXPECT_TRUE(cond)` | Succeeds if `cond` is `true`.              |
| `ASSERT_TRUE(cond)` | Fails fatally if `cond` is not `true`.    |
| `EXPECT_FALSE(cond)`| Succeeds if `cond` is `false`.             |
| `ASSERT_FALSE(cond)`| Fails fatally if `cond` is not `false`.   |

Example:

```cpp
EXPECT_TRUE(IsActive());
ASSERT_FALSE(IsErrorState());
```

---

## Binary Comparison Assertions

These compare two values based on relational operators.

- Use these for integral, floating, pointer, and string objects (except special string macros below). Arguments are evaluated once.

| Assertion        | Meaning                           | Example           |
|------------------|---------------------------------|-------------------|
| `EXPECT_EQ(a,b)` | Checks `a == b`                  | `EXPECT_EQ(x, y);` |
| `EXPECT_NE(a,b)` | Checks `a != b`                  | `EXPECT_NE(x, y);` |
| `EXPECT_LT(a,b)` | Checks `a < b`                   | `EXPECT_LT(x, y);` |
| `EXPECT_LE(a,b)` | Checks `a <= b`                  | `EXPECT_LE(x, y);` |
| `EXPECT_GT(a,b)` | Checks `a > b`                   | `EXPECT_GT(x, y);` |
| `EXPECT_GE(a,b)` | Checks `a >= b`                  | `EXPECT_GE(x, y);` |

Fatal versions exist as `ASSERT_EQ`, `ASSERT_NE`, etc.

### Important Pointer Notes

- When comparing pointers for equality by value (content), do **not** use `EXPECT_EQ` directly. For C strings (`char*`), use string comparison assertions instead.
- To compare pointer to `nullptr`, prefer `EXPECT_EQ(ptr, nullptr)`.

---

## C-String Comparison

Assertions tailored for comparing **C-style strings** (`const char*` or `wchar_t*`):

| Assertion           | Description                                         |
|---------------------|-----------------------------------------------------|
| `EXPECT_STREQ(a,b)` | Checks that strings `a` and `b` are equal by content. |
| `EXPECT_STRNE(a,b)`  | Checks that strings `a` and `b` are different by content. |
| `EXPECT_STRCASEEQ(a,b)` | Checks strings for equality ignoring case.   |
| `EXPECT_STRCASENE(a,b)` | Checks strings for inequality ignoring case. |

Fatal versions using `ASSERT_` prefix exist as well.

Example:

```cpp
EXPECT_STREQ("hello", actual_cstr);
EXPECT_STRCASEEQ("abc", "ABC");
```

---

## Floating-Point Assertions

Comparing floating-point numbers requires tolerance due to rounding errors. GoogleTest provides dedicated assertions:

| Assertion          | Description                                                      |
|--------------------|------------------------------------------------------------------|
| `EXPECT_FLOAT_EQ(a, b)`  | Checks `float` values within 4 ULP (units in last place) of each other. |
| `EXPECT_DOUBLE_EQ(a, b)` | Same as above for `double` types.                             |
| `EXPECT_NEAR(a, b, abs_error)` | Asserts the absolute difference between `a` and `b` is <= `abs_error`. |

Fatal assertion variants also exist.

Example:

```cpp
EXPECT_FLOAT_EQ(f1, f2);
EXPECT_NEAR(d1, d2, 0.001);
```

---

## Exception Assertions

Requires exceptions enabled in your build environment.

| Assertion              | Description                                   |
|------------------------|-----------------------------------------------|
| `EXPECT_THROW(stmt, type)`       | Expects `stmt` to throw `type` exception.    |
| `EXPECT_ANY_THROW(stmt)`          | Expects `stmt` to throw any exception.        |
| `EXPECT_NO_THROW(stmt)`           | Expects `stmt` not to throw any exception.    |

Fatal versions are `ASSERT_THROW`, `ASSERT_ANY_THROW`, and `ASSERT_NO_THROW`.

Example:

```cpp
EXPECT_THROW({ throw MyException(); }, MyException);
EXPECT_NO_THROW({ SafeOperation(); });
```

You can use compound statements with braces `{ ... }` in assertions.

---

## Predicate Assertions

Predicate assertions allow verifying complex predicates with better failure messages.

### Standard Predicates

- `EXPECT_PRED1(pred, val)`, ... up to `EXPECT_PRED5(pred, val1, ..., val5)`.
- `ASSERT_PRED1` ... `ASSERT_PRED5` variants.

The `pred` is a function or functor matching the arity that returns `bool`. When predicates fail, the values of the arguments are printed automatically.

Example:

```cpp
bool IsNonEmpty(const std::string& s) { return !s.empty(); }
EXPECT_PRED1(IsNonEmpty, my_string);
```

### Predicate-Formatter Assertions

- `EXPECT_PRED_FORMAT1(pred_fmt, val1)`, ... up to 5 arguments.
- `ASSERT_PRED_FORMAT1` ... variants.

Predicates here have signature:

```cpp
testing::AssertionResult PredFmt(const char* expr1, ..., T1 val1, ...);
```

Enables crafting detailed failure messages, improving diagnostics.

Example:

```cpp
testing::AssertionResult AssertIsEven(const char* expr, int n) {
  if (n % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr << " evaluates to odd: " << n;
}
EXPECT_PRED_FORMAT1(AssertIsEven, value);
```

---

## Windows HRESULT Assertions

Specialized assertions for Windows HRESULT codes.

- `EXPECT_HRESULT_SUCCEEDED(expression)`: Validates the result is a success `HRESULT`.
- `EXPECT_HRESULT_FAILED(expression)`: Validates the result is a failure `HRESULT`.

Fatal counterparts exist as `ASSERT_HRESULT_SUCCEEDED` and `ASSERT_HRESULT_FAILED`.

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(CoCreateInstance(...));
```

---

## Death Assertions

Verify code that causes abnormal process termination. GoogleTest runs death assertions in separate child processes.

| Assertion                  | Description                                                            |
|----------------------------|------------------------------------------------------------------------|
| `EXPECT_DEATH(stmt, matcher)`         | Asserts `stmt` terminates the process and stderr output matches `matcher`.
| `EXPECT_DEATH_IF_SUPPORTED(stmt, matcher)` | Runs death test if supported, else no-op.
| `EXPECT_DEBUG_DEATH(stmt, matcher)`  | Runs death test only in debug mode.
| `EXPECT_EXIT(stmt, predicate, matcher)` | Checks exit status satisfies `predicate` and stderr matches `matcher`.

Example:

```cpp
EXPECT_DEATH({ Crash(); }, "fatal error message");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

*Note:* The death test style depends on platform and settings (`fast` vs `threadsafe`).

---

## Adding Messages to Assertions

All assertion macros support streaming a custom failure message using `<<`:

```cpp
EXPECT_EQ(x, y) << "x is not equal to y";
```

This custom message will be displayed on failure, aiding debugging.

---

## Key Best Practices

- Use `EXPECT_` macros when a test can continue after failure.
- Use `ASSERT_` macros to abort if failure makes further test code invalid.
- Prefer specialized assertions (`EXPECT_EQ`, `EXPECT_STREQ`, etc.) over general boolean assertions.
- For complex predicates, use predicate or predicate-format assertions for clearer messages.
- For floating-point comparisons, avoid `EXPECT_EQ`; use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR`.
- Use `EXPECT_THAT()` for expressive matchers, combining with custom or built-in matchers.
- Avoid comparing C strings with `EXPECT_EQ`; use string-specific macros instead.
- When testing death scenarios, name your test suite with suffix `DeathTest`.

---

## Troubleshooting Common Pitfalls

- **Assertion in non-void function:** Fatal assertions (`ASSERT_*`, `FAIL()`) cannot be used in non-void functions; convert to non-fatal `EXPECT_*` or refactor functions.
- **Pointer equality confusion:** `EXPECT_EQ` on pointers compares addresses, not content. Use string comparison macros for C strings.
- **Floating-point equality:** Direct equality with `EXPECT_EQ` can fail due to rounding; use floating-point comparison assertions.
- **Death tests:** Death assertions run in separate processes; avoid side effects you want to observe after them.

---

## Examples

### Basic Boolean Assertions

```cpp
TEST(FooTest, BoolCheck) {
  bool condition = true;
  EXPECT_TRUE(condition);
  ASSERT_FALSE(!condition);
}
```

### Equality Assertions

```cpp
TEST(MathTest, Equality) {
  int result = Add(2, 3);
  EXPECT_EQ(5, result);
  EXPECT_NE(4, result);
}
```

### C-String Comparison

```cpp
TEST(StringTest, StringEquality) {
  const char* expected = "hello";
  const char* actual = GetGreeting();
  EXPECT_STREQ(expected, actual);
}
```

### Floating-Point Comparison

```cpp
TEST(FloatTest, NearComparison) {
  float a = 1.0f;
  float b = 1.0001f;
  EXPECT_NEAR(a, b, 0.001f);
}
```

### Exception Assertions

```cpp
TEST(ExceptionTest, ThrowsOnError) {
  EXPECT_THROW({
    throw std::runtime_error("fail");
  }, std::runtime_error);
  EXPECT_NO_THROW({
    DoNothing();
  });
}
```

### Death Test

```cpp
TEST(MyDeathTest, DiesWhenNull) {
  EXPECT_DEATH({ AbortOnNull(nullptr); }, "null pointer");
}
```

---

## Related Documentation

- [Matchers Reference](matchers.md) — for powerful, expressive matchers
- [gMock Cookbook](gmock_cook_book.md) — advanced mocking patterns including `EXPECT_CALL`
- [Writing Your First Test](guides/get-started/writing-tests.mdx) — starting with tests
- [Troubleshooting Setup Issues](getting-started/first-test-validation/troubleshooting-setup) — common installation and configuration issues


---

## Summary

This guide covers GoogleTest's assertion macros: from basic boolean and equality checks to advanced floating-point comparisons, string-specific assertions, exception and death test assertions, and predicate assertions with custom messages. It highlights the difference between fatal and non-fatal assertions and best practices for their use. Examples showcase typical usage patterns and troubleshooting advice addresses common mistakes.

---

# Additional Tips:

- Always include `<gtest/gtest.h>` to access assertions.
- Custom failure messages with `<<` improve test debuggability.
- For comparing C strings, always use `EXPECT_STREQ` or related.
- For floating point, prefer `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ` or `EXPECT_NEAR` instead of `EXPECT_EQ`.
- Use death tests with care; test names ending with `DeathTest` run earlier.

---