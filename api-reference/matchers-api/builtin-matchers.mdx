---
title: "Built-in Matchers"
description: "Lists and explains all standard matchers for comparing values, containers, arguments, and more. Includes syntax, practical examples, and guidance for robust mock expectations."
---

# Built-in Matchers

This page comprehensively presents the standard matchers provided by GoogleTest and GoogleMock. These matchers enable flexible, readable, and robust verification of values, arguments, containers, and function calls in tests. Use these built-in matchers to express complex verification logic clearly and to receive precise failure explanations.

---

## 1. Overview of Built-in Matchers

Matchers are predicates that test whether a value fulfills certain conditions. You can use matchers in assertions (`EXPECT_THAT`) and mock expectations (`EXPECT_CALL`) to specify constraints on arguments and return values.

- **Simple value matchers**: Match exact values or inequalities (e.g., `Eq()`, `Ne()`, `Lt()`, `Ge()`).
- **String matchers**: Check equality, substring presence, prefix/suffix (e.g., `StrEq()`, `HasSubstr()`, `StartsWith()`).
- **Container matchers**: Validate elements order and content (e.g., `ElementsAre()`, `UnorderedElementsAre()`).
- **Pointer matchers**: Validate pointer values or pointed objects (e.g., `IsNull()`, `Pointee()`).
- **Composite and parametrized matchers**: Compose multiple matchers using combinators (e.g., `AllOf()`, `AnyOf()`, `Not()`).

---

## 2. Matchers for Simple Values

### Equality and Inequality

- `Eq(val)`: Matches values equal to `val`. Implicitly used for literals.

  ```cpp
  EXPECT_THAT(x, Eq(42));
  EXPECT_THAT(str, Eq("hello"));
  EXPECT_CALL(mock, Foo(Eq(5)));
  ```

- `Ne(val)`: Matches values not equal to `val`.

- `Lt(val)`, `Le(val)`, `Gt(val)`, `Ge(val)`: Match less-than, less-or-equal, greater-than, and greater-or-equal conditions respectively.

### Boolean Predicates

- `IsTrue()`: Matches `true`.
- `IsFalse()`: Matches `false`.
- `IsNull()`: Matches `nullptr` or null pointers.
- `NotNull()`: Matches non-null pointers.

---

## 3. String Matchers

Specialized matchers for string content comparison.

- `StrEq(str)`: Matches strings exactly equal to `str` (case-sensitive).
- `StrNe(str)`: Matches strings not equal to `str`.
- `StrCaseEq(str)`: Matches strings equal to `str` ignoring case.
- `StrCaseNe(str)`: Matches strings not equal to `str`, ignoring case.
- `HasSubstr(substr)`: Matches strings containing `substr`.
- `StartsWith(prefix)`: Matches strings that start with `prefix`.
- `EndsWith(suffix)`: Matches strings that end with `suffix`.
- `WhenBase64Unescaped(matcher)`: Matches strings that, after base64 decoding, satisfy `matcher`.

### Example

```cpp
EXPECT_THAT("hello world", StartsWith("hello"));
EXPECT_THAT("foo_bar", HasSubstr("_bar"));
EXPECT_CALL(mock, Method(StrCaseEq("value")));
```

---

## 4. Matchers for Containers

### Exact Element Sequence

- `ElementsAre(elem_matcher1, elem_matcher2, ...)`: Matches containers with elements matching each matcher in order.

```cpp
std::vector<int> v = {1, 2, 3};
EXPECT_THAT(v, ElementsAre(1, 2, 3));
```

- `ElementsAreArray(array_or_container)`: Matches container elements against a homogeneous sequence of matchers or values.

### Unordered Elements

- `UnorderedElementsAre(elem_matcher1, elem_matcher2, ...)`: Matches containers with elements matching the given matchers in any order (bijection).

- `UnorderedElementsAreArray(array_or_container)`: Similar unordered matching for homogeneous input.

### Contents Check

- `Contains(element_matcher)`: Matches containers that contain at least one element matching the matcher.

- `Contains(Key(key_matcher))`: For container of pairs (e.g., maps), matches if container contains an element whose key matches `key_matcher`.

- `Contains(Pair(key_matcher, value_matcher))`: Matches element pairs with key and value matching respective matchers.

### Size and Distance

- `SizeIs(size_matcher)`: Matches containers with sizes satisfying `size_matcher`.

- `BeginEndDistanceIs(distance_matcher)`: Matches containers where the distance between `begin()` and `end()` satisfies `distance_matcher`. Useful for containers without `size()`.

### Composite Matching

- `Pointwise(tuple_matcher, rhs_container)`: Matches containers where elements correspond by position with `rhs_container` elements, each pair satisfying `tuple_matcher` (which matches tuples).

- `UnorderedPointwise(tuple_matcher, rhs_container)`: Like `Pointwise`, but order-independent.

---

## 5. Pointer and Reference Matchers

- `IsNull()`: Matches raw or smart pointers that are `nullptr`.
- `NotNull()`: Matches any non-null pointer or smart pointer.
- `Ref(variable)`: Matches arguments that are references to the given variable.
- `Pointee(matcher)`: Matches a pointer that points to a value matching `matcher`. Matches raw and smart pointers. Matches fail if the pointer is `nullptr`.
- `Pointer(matcher)`: Matches a pointer that itself satisfies the given `matcher` (i.e., matches the pointer value, not the pointed content).
- `Address(matcher)`: Matches an object whose address matches `matcher`.

---

## 6. Composite and Logical Matchers

### Logical Combinations

- `AllOf(m1, m2, ...)`: Matches if all given matchers match.
- `AnyOf(m1, m2, ...)`: Matches if any of the given matchers match.
- `Not(m)`: Matches if `m` does not match.

### Conditional

- `Conditional(condition, matcher_true, matcher_false)`: Matches `matcher_true` if `condition` is true, else `matcher_false`.

### Quantifier Matchers

- `Each(matcher)`: Matches containers whose *all* elements match `matcher`.
- `Contains(matcher).Times(count_matcher)`: Matches containers where the count of matching elements satisfies `count_matcher`.

---

## 7. Matchers for Tuples, Structs, and Fields

- `Pair(first_matcher, second_matcher)`: Matches a `std::pair` whose first and second elements match respective matchers.

- `FieldsAre(m1, m2, ...)`: Matches tuples or structs by matching each field individually.

- `Field(&Class::field, matcher)`: Matches an object whose given named member variable matches `matcher`. Works also for pointers to objects.

- `Property(&Class::property, matcher)`: Matches an object whose getter property (const method with no args) matches `matcher`.

These are especially powerful for validating complex custom objects with multiple relevant members or properties.

---

## 8. Floating Point Matchers

- `FloatEq(value)`: Matches single-precision floats approximately equal to `value` using ULP-based comparison.
- `NanSensitiveFloatEq(value)`: Like `FloatEq` but considers NaNs equal.
- `FloatNear(value, error)`: Matches floats approximately equal to `value` within the absolute error `error`.

- `DoubleEq(value)`, `NanSensitiveDoubleEq(value)`, `DoubleNear(value, error)`: Double-precision versions of the float matchers.

---

## 9. Regex Matchers

- `MatchesRegex(regex)`: Matches strings that fully match the given regular expression.
- `ContainsRegex(regex)`: Matches strings that contain a substring matching the regex.

---

## 10. Using Matchers in Tests

Matchers are used in assertions and to establish expectations on mock calls.

### Example of Assertion with Matcher

```cpp
EXPECT_THAT(value, StartsWith("Hello"));
EXPECT_THAT(numbers, ElementsAre(1, Gt(0), _, 5));
```

### Example of Setting Expectations with Matchers

```cpp
EXPECT_CALL(mock, Foo(Ge(10), _))
    .WillOnce(Return(true));
```

### Combining Matchers

Use combinators for more expressive checks.

```cpp
EXPECT_CALL(mock, Bar(AllOf(Gt(5), Ne(10))));
EXPECT_THAT(my_string, AnyOf(StartsWith("Hi"), EndsWith("Bye")));
```

---

## 11. Tips and Best Practices

- Use `_` matcher to accept any argument when you donâ€™t care about its value.
- Use `SafeMatcherCast<T>(m)` to cast matchers safely between compatible types when necessary.
- Define custom matchers easily using the `MATCHER` macros.
- Combine matchers to express complex conditions concisely.
- Use `Pointee()` when you want to assert properties of the pointed-to value.
- When matching containers with unordered elements, prefer `UnorderedElementsAre()`.
- Use `Field()` and `Property()` for clear semantic validation of object members.
- Avoid over-specifying matchers to keep your tests flexible and maintainable.

---

## 12. Troubleshooting Common Issues

- **Matching pointer vs pointed value:** Remember that `IsNull()` matches a null pointer, whereas `Pointee(m)` matches the value pointed to by non-null pointers.
- **Overloaded method confusion:** Use explicit cast or typed matchers to disambiguate overloaded methods.
- **Matcher description unclear:** Use custom descriptions in your matchers to generate more user-friendly failure messages.
- **Action and matcher incompatibilities:** Ensure actions and matchers conform to the mocked method signature and argument types.

---

## 13. Summary

Use the rich set of built-in matchers to craft precise, readable tests. Combine simple matchers, container matchers, pointer matchers, and composite logical matchers to cover complex verification needs. For advanced use cases, create your own custom matchers using `MATCHER` macros or implement matcher interfaces.

---

## References and Related Documentation

- [Matchers Reference](/api-reference/matchers-api/builtin-matchers)
- [Mocking Reference](/api-reference/mocking-api/mock-methods)
- [Assertions Reference](/api-reference/core-api/assertions)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Setting Expectations and Actions](/api-reference/mocking-api/expectations-actions)

---

<Source url="https://github.com/google/googletest" paths={[{"path": "googlemock/include/gmock/gmock-matchers.h", "range": "1-1425"}]} />
