---
title: "Assertions and Expectations"
description: "List and syntax of available assertions for checking values, state, and error conditions during tests. Covers equality, exception, fatal/non-fatal, and advanced assertions."
---

# Assertions and Expectations

GoogleTest provides a comprehensive set of assertion macros that allow you to verify the correctness of your C++ code during testing. This page documents the available assertions that check values, state, and error conditions, covering fundamental Boolean and binary comparisons, string and floating-point checks, exception handling, predicate assertions, and specialized assertions like death tests.

Include the main header to use assertions:

```cpp
#include <gtest/gtest.h>
```

---

## Understanding Assertions

Assertions in GoogleTest come in two primary forms:

- `EXPECT_` macros: Generate **nonfatal failures**. The test continues after an assertion fails.
- `ASSERT_` macros: Generate **fatal failures**. The current function returns immediately on failure.

This distinction allows you to control the flow of your test execution depending on the severity of the failure.

You can append custom failure messages to any assertion using streaming:

```cpp
EXPECT_TRUE(condition) << "Custom failure message";
```

Anything streamable to an `ostream` (including strings and string objects) can be used.

---

## Explicit Success and Failure

Sometimes you want to indicate a success or failure explicitly rather than checking a condition.

### SUCCEED()

Indicates an explicit success. Does **not** cause the test to pass by itself but serves as documentation or to acknowledge a code path.

```cpp
SUCCEED();
```

### FAIL()

Generates an immediate fatal failure, aborting the current function. Useful for unreachable code or asserting that the code should not reach a point.

```cpp
FAIL() << "This code shouldn't be reached";
```

### ADD_FAILURE()

Generates a nonfatal failure but continues the current function.

---

## Generalized Assertion with Matchers

GoogleTest supports rich matchers via the `EXPECT_THAT` and `ASSERT_THAT` macros. These allow expressive verifications beyond simple equality.

Example:

```cpp
#include <gmock/gmock.h> // For matchers

using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;
using ::testing::MatchesRegex;
using ::testing::StartsWith;

EXPECT_THAT(value1, StartsWith("Hello"));
EXPECT_THAT(value2, MatchesRegex("Line \\d+"));
ASSERT_THAT(value3, AllOf(Gt(5), Lt(10)));
```

Matchers improve readability and provide detailed failure messages. See the [Matchers Reference](matchers.md) for a deep dive.

---

## Boolean Condition Assertions

Verify if a condition is true or false.

| Macro           | Description                      |
|-----------------|--------------------------------|
| `EXPECT_TRUE`    | Verifies condition is true      |
| `ASSERT_TRUE`    | Same as EXPECT_TRUE, but fatal  |
| `EXPECT_FALSE`   | Verifies condition is false     |
| `ASSERT_FALSE`   | Same as EXPECT_FALSE, but fatal |

Example:

```cpp
EXPECT_TRUE(IsPrime(7)) << "7 should be prime";
ASSERT_FALSE(is_error) << "Unexpected error occurred";
```

---

## Binary Comparison Assertions

Compare two values using relational operators.

| Macro           | Meaning                     | Description                                                    |
|-----------------|-----------------------------|----------------------------------------------------------------|
| `EXPECT_EQ`      | Equal (`val1 == val2`)       | Use for general equality, except C strings                    |
| `ASSERT_EQ`      | Equal, fatal failure         | Same as EXPECT_EQ but aborts current function on failure      |
| `EXPECT_NE`      | Not equal                   |                                                                |
| `EXPECT_LT`      | Less than (`val1 < val2`)    |                                                                |
| `EXPECT_LE`      | Less or equal               |                                                                |
| `EXPECT_GT`      | Greater than (`val1 > val2`)|                                                                |
| `EXPECT_GE`      | Greater or equal            |                                                                |

**Important:** When comparing C strings (`const char*`), use string comparison macros instead (below).

### Notes:
- `EXPECT_EQ(ptr1, ptr2)` compares pointer addresses.
- Use `EXPECT_EQ(nullptr, ptr)` for null pointer comparison.

Example:

```cpp
EXPECT_EQ(result, expected);
ASSERT_LT(value, limit);
```

---

## String Comparison Assertions

For comparing C strings (`const char*`) by content.

| Macro               | Description                                                        |
|---------------------|------------------------------------------------------------------|
| `EXPECT_STREQ`       | Strings are equal                                                  |
| `ASSERT_STREQ`       | Same as EXPECT_STREQ but fatal                                     |
| `EXPECT_STRNE`       | Strings are not equal                                              |
| `ASSERT_STRNE`       | Same, fatal failure                                                |
| `EXPECT_STRCASEEQ`   | Case-insensitive equality                                         |
| `ASSERT_STRCASEEQ`   | Same, fatal failure                                                |
| `EXPECT_STRCASENE`   | Case-insensitive inequality                                       |
| `ASSERT_STRCASENE`   | Same, fatal failure                                                |

Example:

```cpp
EXPECT_STREQ("hello", my_string_cstr);
ASSERT_STRCASEEQ("Hello", my_string_cstr);
```

---

## Floating-Point Comparison Assertions

Due to rounding and representation precision, use these specialized assertions for floats and doubles.

| Macro              | Description                                                                |
|--------------------|----------------------------------------------------------------------------|
| `EXPECT_FLOAT_EQ`   | Checks approximate equality of floats within 4 ULPs                      |
| `ASSERT_FLOAT_EQ`   | Same as EXPECT_FLOAT_EQ but fatal                                           |
| `EXPECT_DOUBLE_EQ`  | Checks approximate equality of doubles within 4 ULPs                     |
| `ASSERT_DOUBLE_EQ`  | Fatal failure variant of EXPECT_DOUBLE_EQ                                  |
| `EXPECT_NEAR`       | Checks absolute difference within an error bound                          |
| `ASSERT_NEAR`       | Fatal failure variant                                                     |

Example:

```cpp
EXPECT_FLOAT_EQ(calculated_value, 3.14f);
EXPECT_NEAR(measured, expected, 0.01);
```

See [Floating-Point Comparison](https://randomascii.wordpress.com/2012/02/25/comparing-floating-point-numbers-2012-edition/) for best practices.

---

## Exception Assertions

Verify that a piece of code throws or does not throw exceptions. Requires exceptions enabled in your build.

| Macro              | Description                         |
|--------------------|-----------------------------------|
| `EXPECT_THROW`      | Expects an exception of a specific type thrown  |
| `ASSERT_THROW`      | Fatal failure variant              |
| `EXPECT_ANY_THROW`  | Expects any exception thrown       |
| `ASSERT_ANY_THROW`  | Fatal failure variant              |
| `EXPECT_NO_THROW`   | Expects no exceptions thrown       |
| `ASSERT_NO_THROW`   | Fatal failure variant              |

Example:

```cpp
EXPECT_THROW(FunctionUnderTest(), std::runtime_error);
EXPECT_NO_THROW(FunctionUnderTest());
```

You can assert on multiple statements using compound code blocks:

```cpp
EXPECT_NO_THROW({
  int x = 1;
  SomeFunction(x);
});
```

---

## Predicate Assertions

For expressing more complex checks with informative failure messages.

### `EXPECT_PRED*` and `ASSERT_PRED*`

Verify that a predicate returns `true` given specified arguments. Supports 1 to 5 arguments.

Example:

```cpp
bool IsEven(int n) { return (n % 2) == 0; }
EXPECT_PRED1(IsEven, 4);  // Passes
EXPECT_PRED1(IsEven, 3);  // Fails
```

### `EXPECT_PRED_FORMAT*` and `ASSERT_PRED_FORMAT*`

Allows custom formatting of the failure message by defining a predicate-formatter function that returns `testing::AssertionResult`.

Example:

```cpp
testing::AssertionResult IsEvenDetailed(const char* expr, int n) {
  if (IsEven(n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << n << " is odd";
}

EXPECT_PRED_FORMAT1(IsEvenDetailed, 3);  // Fails with detailed message
```

Allows much more readable failure reports especially for complex predicates.

---

## Windows HRESULT Assertions

Specific assertions for Windows `HRESULT` types.

| Macro                      | Description                              |
|----------------------------|------------------------------------------|
| `EXPECT_HRESULT_SUCCEEDED` | Verifies the HRESULT is a success code   |
| `ASSERT_HRESULT_SUCCEEDED` | Fatal failure variant                     |
| `EXPECT_HRESULT_FAILED`    | Verifies the HRESULT is a failure code   |
| `ASSERT_HRESULT_FAILED`    | Fatal failure variant                     |

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(CoInitialize(nullptr));
EXPECT_HRESULT_FAILED(SomeFailedHRESULTFunction());
```

The failure message will include the associated human-readable error.

---

## Death Assertions

Death assertions verify your code terminates the process under test conditions. The code is run in a child process with stderr captured.

| Macro                    | Description                                                                    |
|--------------------------|--------------------------------------------------------------------------------|
| `EXPECT_DEATH`            | Expects process termination and matches output regex on stderr                |
| `ASSERT_DEATH`            | Fatal failure variant                                                         |
| `EXPECT_DEATH_IF_SUPPORTED` | Runs if death tests are supported; else no test                                |
| `EXPECT_DEBUG_DEATH`      | Runs in debug mode only                                                        |
| `EXPECT_EXIT`             | Verifies exit status predicate and stderr output regex                        |
| `ASSERT_EXIT`             | Fatal failure variant                                                         |

Example:

```cpp
EXPECT_DEATH({ AbortFunction(); }, "Fatal error occurred");
EXPECT_EXIT(ExitFunction(), ::testing::ExitedWithCode(0), "Success");
```

Note: Death tests run in separate processes and should be used carefully especially with mocks.

---

## Advanced Usage Tips

- Use `SCOPED_TRACE(message)` to add contextual trace messages to failure reports within a scope.
- Use `GTEST_SKIP()` to skip tests dynamically at runtime with an optional message.
- Assertions that generate fatal failures (`ASSERT_*`) can only be used in functions returning `void`.
- All assertion macros evaluate each argument exactly once, ensuring safe usage with side effects.

---

## Common Pitfalls and Troubleshooting

- Avoid `ASSERT_*` if subsequent test statements assume the assertion passed unless you want to abort early.
- Use the appropriate string comparison macros for C strings to avoid pointer equality pitfalls.
- Death tests require special consideration to avoid side effects and leak detection issues.
- Matchers can be combined and customized — leverage them for expressive test code.

---

## Examples

### Basic Boolean Assertions

```cpp
EXPECT_TRUE(IsValid(user)) << "User should be valid";
ASSERT_FALSE(IsEmpty(container)) << "Container must not be empty";
```

### Binary Comparisons

```cpp
EXPECT_EQ(actual_value, expected_value) << "Mismatch in value";
ASSERT_LT(size, max_allowed) << "Size exceeded limit";
```

### String Equality

```cpp
EXPECT_STREQ(c_string1, c_string2);
ASSERT_STRCASEEQ(c_string_lower, c_string_upper);
```

### Floating-Point Checks

```cpp
EXPECT_FLOAT_EQ(calculated_float, 3.1415f);
ASSERT_NEAR(measured, expected, 0.001);
```

### Exception Checking

```cpp
EXPECT_THROW(DoSomethingRisky(), std::runtime_error);
ASSERT_NO_THROW(SafeCall());
```

### Death Test

```cpp
EXPECT_DEATH({ CrashFunction(); }, "Error message regex");
```

### Using Predicates

```cpp
bool IsSorted(const std::vector<int>& v);
EXPECT_PRED1(IsSorted, my_vector);
```

### Using Matchers

```cpp
EXPECT_THAT(string_value, StartsWith("Hello"));
EXPECT_THAT(my_vector, ElementsAre(1, 2, 3));
```

---

For full details on the APIs, see the [GoogleTest Assertions Reference](reference/assertions.md). Additional related material includes [Matchers Reference](matchers.md), [Advanced Guide](advanced.md), and testing workflow guides.

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/reference/assertions.md", "range": "1-262"}]} />

