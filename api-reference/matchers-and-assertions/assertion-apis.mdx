---
title: "Assertion APIs in GoogleTest and GoogleMock"
description: "A concise reference to the assertion macros and helper functions available for validating test outcomes. Covers equality, floating point, exception, and fatal/non-fatal assertions, enabling testers to enforce correctness throughout their unit tests."
---

# Assertion APIs in GoogleTest and GoogleMock

A concise reference to the assertion macros and helper functions available for validating test outcomes. This covers equality, floating point, exception, and fatal/non-fatal assertions, enabling testers to enforce correctness throughout their unit tests.

---

## Overview of Assertions

GoogleTest provides a rich set of assertion macros for verifying code behavior during tests. These macros are designed to clearly express test intentions and provide precise feedback on failures.

Key characteristics:

- Assertions support both **nonfatal (`EXPECT_`)** and **fatal (`ASSERT_`)** variants.
- Failures in `EXPECT_` allow the test to continue, whereas `ASSERT_` stops the current test or function.
- All assertion macros support streaming custom failure messages using the `<<` operator.

To use these assertions, include the header:

```cpp
#include <gtest/gtest.h>
```

---

## Categories of Assertions

### 1. Basic Success and Failure

- `SUCCEED()`: Marks a test as successful at that point, useful for documentation.
- `FAIL()`: Generates a fatal failure immediately; the current function must return void.
- `ADD_FAILURE()`: Generates a nonfatal failure without aborting.


### 2. Boolean Condition Assertions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` — Verifies that *condition* is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` — Verifies that *condition* is false.

### 3. Equality and Comparison Assertions

These macros test binary relations between two values. Arguments must be comparable.

| Macro | Description |
| ------ | ----------- |
| `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` | Checks if `val1 == val2`. For pointers, tests pointer equality. For C strings, use `EXPECT_STREQ` instead. |
| `EXPECT_NE` | Checks not equal (≠). |
| `EXPECT_LT` | Checks less than (<). |
| `EXPECT_LE` | Checks less or equal (≤). |
| `EXPECT_GT` | Checks greater than (>) |
| `EXPECT_GE` | Checks greater or equal (≥). |

*Note*: For C strings, use [`EXPECT_STREQ`](#EXPECT_STREQ) family to compare contents rather than pointer addresses.

### 4. String Equality Assertions

Specifically for C strings (including wide strings), these macros check the characters, not addresses.

- `EXPECT_STREQ` / `ASSERT_STREQ`: Equal C strings.
- `EXPECT_STRNE` / `ASSERT_STRNE`: Not equal C strings.
- `EXPECT_STRCASEEQ` / `ASSERT_STRCASEEQ`: Case-insensitive equal.
- `EXPECT_STRCASENE` / `ASSERT_STRCASENE`: Case-insensitive not equal.

### 5. Floating-Point Comparisons

Because of rounding errors, exact equality on floating-point is usually inappropriate. These assertions help compare floats/doubles within acceptable margins.

- `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ`: Compares two `float`s, passing if within 4 ULPs.
- `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ`: For `double`s, similar to above.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR`: Verifies that the absolute difference between two values is within `abs_error`.

### 6. Exception Assertions

Verify that code throws exceptions as expected.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW`: Ensures statement throws specified exception.
- `EXPECT_ANY_THROW` / `ASSERT_ANY_THROW`: Ensures statement throws any exception.
- `EXPECT_NO_THROW` / `ASSERT_NO_THROW`: Ensures statement does not throw.

Example:

```cpp
EXPECT_THROW({ FunctionThatThrows(); }, std::runtime_error);
```

### 7. Predicate-Based Assertions

Use predicates or predicate-formatters with varying numbers of parameters to refine assertions.

- `EXPECT_PRED1(pred, val1)`, `EXPECT_PRED2(pred, val1, val2)`, ..., up to 5 parameters
- `EXPECT_PRED_FORMAT1(formatter, val1)`, ..., for custom formatted failure messages

These allow more complex logical checks and produce clearer failure diagnostics.

### 8. HRESULT Assertions (Windows-specific)

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED`: Checks for successful `HRESULT`.
- `EXPECT_HRESULT_FAILED` / `ASSERT_HRESULT_FAILED`: Checks for failure result.

### 9. Death Assertions

Verify that code causes process termination (crashes, aborts).

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH`: Runs statement in a separate process and verifies stderr output matches matcher.
- `EXPECT_DEATH_IF_SUPPORTED`, `EXPECT_DEBUG_DEATH`, `EXPECT_EXIT` variants exist with specific behaviors and predicates.

---

## Using Assertions with Matchers

For flexible value verification, GoogleTest supports matchers, often used via:

```cpp
EXPECT_THAT(value, matcher);
ASSERT_THAT(value, matcher);
```

Matchers allow readable and descriptive assertions, such as:

```cpp
EXPECT_THAT(my_string, StartsWith("Hello"));
EXPECT_THAT(my_number, AllOf(Gt(5), Lt(10)));
```

Matchers are covered in depth in the [Matchers Reference](https://google.github.io/googletest/reference/matchers.html).

---

## Streaming Custom Failure Messages

All assertion macros support streaming additional context via the `<<` operator.

Example:

```cpp
EXPECT_TRUE(isValid) << "Expected the validation to pass but failed due to ...";
```

This is useful for providing quick diagnosis when an assertion fails.

---

## Practical Example

```cpp
TEST(MathTest, Division) {
  int result = Divide(10, 2);
  EXPECT_EQ(result, 5) << "Division result should be 5";

  EXPECT_THROW(Divide(10, 0), std::invalid_argument);

  double nearValue = ComputeApproximateValue();
  EXPECT_NEAR(nearValue, 3.1415, 0.001) << "Value should approximate pi";
}
```

---

## Troubleshooting Common Assertion Issues

- Use `--gtest_catch_exceptions=1` to enable exception catching if your environment supports it.
- For debugging failed assertions, increase verbosity or add custom messages for context.
- Be aware of the difference between fatal `ASSERT_` and nonfatal `EXPECT_` assertions; misuse can cause missing failures or false positives.
- Use `EXPECT_THAT` with detailed matchers for clearer and more powerful verifications.

---

## Additional Resources

- [Matchers Reference](https://google.github.io/googletest/reference/matchers.html) — For expressive and flexible checking.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Contains advanced use cases.
- [Using Assertions in GoogleTest](https://google.github.io/googletest/reference/assertions.html) — Detailed docs covering all macros.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — For context on interaction with mocks and assertions.

---

_For detailed usage, refer to the [Assertions Reference](https://google.github.io/googletest/reference/assertions.html) and related resources linked above._