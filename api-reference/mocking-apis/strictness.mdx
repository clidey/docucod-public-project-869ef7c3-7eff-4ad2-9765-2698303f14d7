---
title: "Strictness and Mock Call Controls"
description: "How to manage mock class call behaviors with NiceMock, NaggyMock, and StrictMock. This page explains usage, implications for test outcomes, and API references for controlling warning and error reporting."
---

# Strictness and Mock Call Controls

Manage how your mock objects respond to calls that are not explicitly expected or configured. This guide explains the usage and behavior of `NiceMock`, `NaggyMock`, and `StrictMock` classes in GoogleMock to control warnings and errors for uninteresting calls on mock methods.

---

## Introduction

When designing tests with mock objects, you need control over how those mocks handle calls to methods without explicit expectations (called *uninteresting calls*). By default, GoogleMock treats such calls as "naggy": it allows them but emits warnings.

There are scenarios where you want to either silence these warnings or treat such calls as test failures. GoogleMock provides three wrapper class templates to easily adjust this behavior for the lifetime of your mock objects:

- **`NiceMock<T>`**: suppresses warnings on uninteresting calls.
- **`NaggyMock<T>`**: (default) warns about uninteresting calls.
- **`StrictMock<T>`**: treats uninteresting calls as test failures.

Each is a subclass of your mock class `T`, with identical construction signatures.

---

## Concepts and Behavior

### What Are Uninteresting Calls?

An *uninteresting call* occurs when a mock method is invoked but no expectation (`EXPECT_CALL`) has been set for that method. In this case:

- GoogleMock invokes the method's default action if any (`ON_CALL` behavior or built-in defaults).
- It may print warnings to inform you that the call was unexpected in your test context.

### Why Control Mock Strictness?

Depending on your testing goals, you may want:

- To ignore uninteresting calls (less strict, more forgiving).
- To get warnings for unexpected calls (default naggy behavior).
- To treat any such calls as errors, making your test strict and catching unexpected interactions quickly.

Choosing a strictness level improves test clarity and maintainability by matching test expectations to project requirements.

---

## Using `NiceMock<T>`

### Purpose

`NiceMock` suppresses warnings on uninteresting calls, allowing any call to proceed silently unless explicitly disallowed.

### Usage

Wrap your mock class with `NiceMock`:

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;

NiceMock<MockFoo> nice_foo;
EXPECT_CALL(nice_foo, SomeMethod());

// Uninteresting calls produce no warnings.
nice_foo.UnexpectedCall();
```

You can construct `NiceMock<T>` with the same arguments as `T`:

```cpp
NiceMock<MockBar> nice_bar("hello", 42);
```

### Behavior

- Uninteresting calls invoke default actions but generate no warnings.
- Unexpected calls that match some expectations but violate them behave as usual (test fails).
- Uninteresting calls for methods returning a non-default-constructible type that lack an action will throw (or abort) since no default value can be produced.

---

## Using `NaggyMock<T>`

### Purpose

`NaggyMock` is the default mock behavior in GoogleMock: uninteresting calls cause warnings but allow the test to proceed.

### Usage

Wrap your mock with `NaggyMock`:

```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> naggy_foo;
EXPECT_CALL(naggy_foo, SomeMethod());

// Uninteresting calls print warnings.
naggy_foo.UnexpectedCall();
```

### Behavior

- Uninteresting calls produce warnings indicating a call had no expectation.
- Warnings include function call details, and optionally stack traces depending on verbosity flags.
- Unexpected calls fail the test.

---

## Using `StrictMock<T>`

### Purpose

`StrictMock` treats any uninteresting calls as test failures, promoting the most rigorous testing discipline.

### Usage

Wrap your mock with `StrictMock`:

```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_foo;
EXPECT_CALL(strict_foo, AllowedCall());

// Uninteresting calls cause test failures.
strict_foo.UnexpectedCall();  // Fails the test
```

### Behavior

- Fails tests immediately on uninteresting calls.
- Prevents silent ignoring of calls to methods without expectations.
- Promotes precision in specifying exactly which calls are allowed.

---

## Key Characteristics and Notes

- All three wrappers inherit constructors of the mock class, forwarding arguments transparently.
- They only affect mock methods declared *directly* in the mock class using `MOCK_METHOD` macros.
- Nesting or combining these wrappers (e.g., `NiceMock<StrictMock<T>>`) is unsupported.
- Non-virtual destructors in mock classes may cause these wrappers to misbehave.

---

## Controlling Verbosity of Warnings

GoogleMock allows adjusting the verbosity of messages about uninteresting calls using the `--gmock_verbose=` command-line flag or the `FLAGS_gmock_verbose` variable:

| Level    | Description                                  |
| -------- | --------------------------------------------|
| `info`   | Shows warnings and informational messages including stack traces.
| `warning`| Default behavior; shows warnings without stack traces.
| `error`  | Suppresses warnings; only errors are shown.

Example to set verbosity in code:

```cpp
::testing::FLAGS_gmock_verbose = "error";
```

---

## Best Practices and Recommendations

- Use **`NiceMock`** for general tests where warnings from uninteresting calls clutter output but are not critical.
- Use **`NaggyMock`** during test development or debugging to detect unexpected mock method calls.
- Use **`StrictMock`** when you want to enforce that *only* explicitly expected calls are allowed.
- Explicitly disallow unwanted calls by writing `EXPECT_CALL(mock, Method()).Times(0);`
- Avoid suppressing warnings by adding empty `EXPECT_CALL`s; instead, use `NiceMock` or explicitly allow calls with `Times(AnyNumber())`.
- When specifying multiple expectations on the same method, remember that newer expectations override older ones.

---

## Examples

### NiceMock example suppressing warnings

```cpp
using ::testing::NiceMock;

class MockPrinter {
 public:
  MOCK_METHOD(void, Print, (const std::string&), ());
};

TEST(Example, NoWarningOnUninterestingCall) {
  NiceMock<MockPrinter> mock;

  EXPECT_CALL(mock, Print("Hello"));

  mock.Print("Hello");      // Expected call
  mock.Print("Unexpected"); // Uninteresting call, no warning
}
```

### NaggyMock example emitting warnings

```cpp
using ::testing::NaggyMock;

NaggyMock<MockPrinter> naggy_mock;

EXPECT_CALL(naggy_mock, Print("Hello"));

naggy_mock.Print("Hi");  // Warning printed about uninteresting call
```

### StrictMock example failing on uninteresting calls

```cpp
using ::testing::StrictMock;

StrictMock<MockPrinter> strict_mock;

EXPECT_CALL(strict_mock, Print("Hello"));

strict_mock.Print("Unexpected");  // Test fails
```

---

## Troubleshooting

### Why am I still seeing warnings with `NiceMock`?

- Ensure mock methods are declared in the mock class itself using `MOCK_METHOD`. Methods inherited from a base mock class may not honor `NiceMock`.
- Verify your mock class destructor is virtual.

### Can I nest `NiceMock` inside `StrictMock`?

- Nesting `NiceMock`, `NaggyMock`, and `StrictMock` is not supported and causes undefined behavior.

### How to silence warnings for a particular method only?

- Use explicit expectations with `EXPECT_CALL(mock, Method(_)).Times(AnyNumber())`.

### Why does `StrictMock` cause some tests to fail unexpectedly?

- `StrictMock` treats *any* uninteresting call as an error. Add explicit expectations for all allowed calls or switch to `NiceMock` or `NaggyMock`.

---

## References

- [GoogleMock Cookbook: The Nice, the Strict, and the Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- `gmock-nice-strict.h` for implementation details
- Command line flag `--gmock_verbose` for controlling output verbosity

---

## Summary Diagram of Mock Strictness Behaviors

```mermaid
flowchart TD
  Call["Call to Mock Method"] --> CheckExpectation{Is there an EXPECT_CALL with matching args?}
  CheckExpectation -- Yes --> ApplyExpectation[Apply matching expectation]
  CheckExpectation -- No --> CheckWrapper{Is mock wrapped in StrictMock?}
  CheckWrapper -- Yes --> Fail[Fail test immediately]
  CheckWrapper -- No --> CheckNaggy{Is mock wrapped in NaggyMock?}
  CheckNaggy -- Yes --> Warn[Print warning, invoke default action]
  CheckNaggy -- No --> CheckNice{Is mock wrapped in NiceMock?}
  CheckNice -- Yes --> Proceed[Invoke default action silently]
  CheckNice -- No --> WarnDefault[Default (Naggy): warn and invoke default action]
```

