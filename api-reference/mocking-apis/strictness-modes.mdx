---
title: "Strictness Modes"
description: "Reference for NiceMock, NaggyMock, and StrictMock wrappers, which control the handling of unexpected or uninteresting calls on mock objects. Helps select the appropriate mode for different testing scenarios."
---

# Strictness Modes

Control how mock objects handle uninteresting or unexpected calls using the strictness wrappers provided by GoogleMock: `NiceMock`, `NaggyMock`, and `StrictMock`. These wrappers modify the default warning and error behavior for calls without explicit expectations, empowering you to fine-tune test feedback and maintainability.

---

## Overview

When writing tests with mocks, you often encounter calls to mock methods that do not have matching `EXPECT_CALL` specifications. These are termed **uninteresting calls** and can indicate missing expectations or intentional ignored behavior. How such calls are handled can significantly impact test clarity and reliability.

GoogleMock provides three strictness modes to manage uninteresting calls:

| Mode        | Behavior for Uninteresting Calls         | Typical Use Case                                     |
|-------------|------------------------------------------|----------------------------------------------------|
| **NiceMock** | Silences warnings, allows calls silently | Use when uninteresting calls are expected and benign. Ideal for less noisy, maintainable tests. |
| **NaggyMock**| Emits warnings on uninteresting calls    | Default behavior currently; useful during test development to catch unexpected usage. |
| **StrictMock**| Fails the test on uninteresting calls    | Use when precise control and full specification of mock interactions is critical.       |

Each wrapper is a template subclass of your mock class, inheriting constructors and enabling seamless substitution.

---

## Using Strictness Wrappers

Suppose you have a mock class `MockFoo` generated with GoogleMock:

```cpp
class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(int, DoThat, (bool flag), ());
};
```

To change its strictness mode:

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

// Nice mock: suppresses warnings on uninteresting calls
NiceMock<MockFoo> nice_foo;

// Naggy mock: warns on uninteresting calls (default behavior)
NaggyMock<MockFoo> naggy_foo;

// Strict mock: fails test on uninteresting calls
StrictMock<MockFoo> strict_foo;
```

You can construct these wrapped mocks with any arguments supported by the base mock class constructors:

```cpp
class MockBar {
 public:
  explicit MockBar(const std::string& name);
  MOCK_METHOD(void, This, (), ());
};

NiceMock<MockBar> nice_bar("test");
StrictMock<MockBar> strict_bar("test");
```

---

## Behavior Details

### NiceMock
- Allows calls to methods without an expectation without warnings or errors.
- Ideal for tests where certain calls are not relevant or unimportant.
- Ensures tests are quieter and less sensitive to internal changes.

### NaggyMock
- Prints warnings for any uninteresting calls.
- Acts as a temporary, diagnostic setting to ensure you notice unexpected calls.
- Currently the default behavior for GoogleMock mock objects.

### StrictMock
- Treats every uninteresting call as a test failure.
- Forces explicit expectations on all mock method calls.
- Ideal for tests requiring rigorous verification and no surprises.

---

## How It Works Internally

Under the hood, `NiceMock`, `NaggyMock`, and `StrictMock` inherit from internal base classes that register their uninteresting call reactions with the GoogleMock framework. This changes the global behavior of the mock instance:

- `NiceMock` calls `AllowUninterestingCalls` to permit uninteresting calls silently.
- `NaggyMock` calls `WarnUninterestingCalls` to emit warnings.
- `StrictMock` calls `FailUninterestingCalls` to convert uninteresting calls into errors.

They also unregister their reactions when destructed to avoid side effects beyond their lifetime.

### Important Limitations

- Only affects mock methods defined **directly** in the mock class via `MOCK_METHOD`. Mocked methods inherited from base classes may not respect these wrappers.
- Nesting strictness wrappers (e.g., `NiceMock<StrictMock<MockFoo>>`) is **not supported**.
- Effectiveness depends on the base class having a virtual destructor for proper cleanup.

---

## Choosing the Right Strictness Mode

| Scenario                                                      | Recommended Mode   |
|---------------------------------------------------------------|-------------------|
| You want to ignore uninteresting calls and reduce test noise. | `NiceMock`        |
| You want warnings but not failures when calls are uninteresting | `NaggyMock`       |
| You want to treat all uninteresting calls as test failures.    | `StrictMock`      |

---

## Practical Examples

### Suppressing Uninteresting Call Warnings

```cpp
NiceMock<MockFoo> mock;

EXPECT_CALL(mock, DoThis());

mock.DoThis();      // Expected call, passes
mock.DoThat(true);  // Uninteresting call, no warning
```

### Receiving Warnings on Uninteresting Calls

```cpp
NaggyMock<MockFoo> mock;

EXPECT_CALL(mock, DoThis());

mock.DoThis();      // Expected call, passes
mock.DoThat(true);  // Prints warning on uninteresting call
```

### Treating Uninteresting Calls as Failures

```cpp
StrictMock<MockFoo> mock;

EXPECT_CALL(mock, DoThis());

mock.DoThis();      // Expected call, passes
mock.DoThat(true);  // Test fails due to uninteresting call
```

### Using with Non-Default Constructors

```cpp
class MockBar {
 public:
  explicit MockBar(const std::string& name) : str_(name) {}
  MOCK_METHOD(int, This, (), ());
  const std::string& str() const { return str_; }
 private:
  std::string str_;
};

NiceMock<MockBar> nice_bar("hello");
EXPECT_CALL(nice_bar, This());
nice_bar.This();
```

---

## Common Pitfalls and Tips

- Do **not** nest multiple strictness wrappers. Choose one for your mock.
- Prefer `NiceMock` for long-lived tests or libraries where uninteresting calls are expected.
- Use `StrictMock` when you require full verification of all mock interactions.
- Be aware that wrapping mocks with `NiceMock`, `NaggyMock`, or `StrictMock` changes the behavior of uninteresting calls only — unexpected calls (calls not matching any expectation) always cause errors.

---

## Troubleshooting

- **Unexplained warnings or failures:** Check if you accidentally used multiple strictness wrappers or if the mock methods are inherited.
- **Uninteresting call warnings despite using `NiceMock`:** Confirm your mock methods are defined directly in the mock class, not just in a base class.
- **Unexpected test failures in `StrictMock`:** You might be calling mock methods without corresponding `EXPECT_CALL`s. Add expectations or switch to a less strict mode.

---

## Related Documentation

- [gMock Cookbook - The Nice, the Strict, and the Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [Mock Object Definition](../mock-object-definition.md) — Defining mocks and mock methods
- [Setting Expectations and Behavior](../setting-expectations-and-behavior.md) — Using `EXPECT_CALL` and `ON_CALL`
- [Mocking Basics Guide](https://google.github.io/googletest/gmock_for_dummies.html) — Getting started with mocks
- [Mocking Reference](../mocking.md) — Detailed class and macro reference

---

Understanding and choosing the appropriate strictness mode aligns your tests with your verification philosophy — from quiet ignoring with `NiceMock` to strict validation with `StrictMock`. Embrace these wrappers to create maintainable, clear, and robust tests that reflect your project's priorities.
