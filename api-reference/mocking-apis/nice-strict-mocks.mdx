---
title: "Controlling Mock Call Policies"
description: "Explains the use of NiceMock, NaggyMock, and StrictMock wrappers to control how unexpected or uninteresting mock calls are handled. Helps users ensure test intent is clearly communicated and enforced in their code."
---

# Controlling Mock Call Policies

This documentation explains how to use the `NiceMock`, `NaggyMock`, and `StrictMock` wrappers in GoogleMock to control how uninteresting or unexpected mock calls are treated during testing. These wrappers allow you to clearly express your test’s intent by specifying whether unexpected mock calls should be ignored, warned about, or treated as failures.

---

## Understanding Uninteresting vs Unexpected Calls

When working with mock objects, it is essential to distinguish between **uninteresting** calls and **unexpected** calls:

- **Uninteresting calls** are calls to mock methods for which no `EXPECT_CALL` has been set. These occur when the test does not explicitly state an expectation for the call.
- **Unexpected calls** are calls that do not match any existing `EXPECT_CALL` expectations, but where at least one `EXPECT_CALL` has been set on that method.

By default, uninteresting calls generate warnings but are allowed to proceed, while unexpected calls always cause errors.

---

## Why Control Mock Call Policies?

In larger or more complex tests, managing the verbosity and strictness of mock call handling improves test clarity and maintenance:

- You might want to **suppress warnings** for uninteresting calls when they are harmless, to reduce noise.
- You might want to **enforce failures** on uninteresting calls to make sure tests explicitly cover all mock interactions.
- You might want to generate **warnings** to help you detect possible overlooked method calls without failing tests.

GoogleMock provides three wrappers to control this behavior per mock object:

---

## The Mock Wrappers

### 1. `NiceMock<T>`

`NiceMock` is a subclass of your mock class `T` that **suppresses warnings** on uninteresting calls.

- Uninteresting calls to methods of a `NiceMock` object succeed silently.
- Expected calls (those with matching `EXPECT_CALL`) work normally.
- Unexpected calls still fail your test as usual.

**Usage example:**
```cpp
using ::testing::NiceMock;

NiceMock<MockFoo> nice_mock;
EXPECT_CALL(nice_mock, DoSomething());
// Other method calls without EXPECT_CALL will not trigger warnings.
```

**When to use:** Use `NiceMock` when your test cares only about some method calls, but you want to ignore other uninteresting calls without warnings.

---

### 2. `NaggyMock<T>`

`NaggyMock` is a subclass of your mock class `T` that **prints warnings** on uninteresting calls.

- This is currently the **default** behavior for bare mock objects.
- Uninteresting calls print warnings but proceed without failing.
- Expected and unexpected calls function as normal.

**Usage example:**
```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> naggy_mock;
EXPECT_CALL(naggy_mock, DoSomething());
// Uninteresting calls will generate warning messages.
```

**When to use:** Use `NaggyMock` during test development or debugging, when you want to be notified of unplanned mock calls without failing tests.

---

### 3. `StrictMock<T>`

`StrictMock` is a subclass of your mock class `T` that **treats all uninteresting calls as errors**.

- Any uninteresting call to methods of a `StrictMock` object **fails the test**.
- Expected calls proceed as normal.
- Unexpected calls also fail as usual.

**Usage example:**
```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_mock;
EXPECT_CALL(strict_mock, DoSomething());
// Uninteresting calls cause test failures.
```

**When to use:** Use `StrictMock` when you want to enforce complete specification of mock interactions, ensuring tests cover every mock method call.

---

## Key Properties and Usage Details

### Inheritance and Constructors

All mock wrappers (`NiceMock`, `NaggyMock`, and `StrictMock`) inherit constructors from the original mock class. This means you can construct them using the same arguments as the base mock class.

Example:
```cpp
NiceMock<MockFoo> nice_mock(42, "argument");
NaggyMock<MockFoo> naggy_mock("hello");
```

### Compatibility

- Wrappers only affect mock methods **defined directly** in the mock class `T` using the `MOCK_METHOD` macros. Mock methods inherited from base classes might not be affected due to C++ limitations.
- **Mixing wrappers is not supported**; e.g., `NiceMock<StrictMock<MockFoo>>` is not valid.
- The mock class `T` should have a **virtual destructor** to work correctly.

### Default Behavior

- Currently, bare mock objects behave like `NaggyMock` — uninteresting calls are allowed but produce warnings.
- Plans are in place to make bare mocks behave like `NiceMock` by default in the future.

### Behavior Summary Table

| Call Type          | NiceMock            | NaggyMock (Default)       | StrictMock            |
|--------------------|---------------------|---------------------------|-----------------------|
| Expected Call      | Allowed             | Allowed                   | Allowed               |
| Unexpected Call    | Fails test          | Fails test                | Fails test            |
| Uninteresting Call | Allowed without warning | Allowed with warning     | Fails test            |

---

## Practical Tips

- Use `NiceMock` to make tests less noisy and more maintainable by ignoring uninteresting calls.
- Use `NaggyMock` during test development to catch possible missing expectations.
- Use `StrictMock` when you want precise verification and no slack in testing mock usage.
- To allow specific uninteresting calls without warnings on other mocks, use `EXPECT_CALL(mock, Method(_)).Times(AnyNumber());` to catch all other calls intentionally.
- Always set `EXPECT_CALL` expectations **before** exercising code that calls the mock object to avoid undefined behaviors.

---

## Example

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(int, Calculate, (int x), ());
};

void TestNiceMock() {
  NiceMock<MockFoo> nice_mock;
  EXPECT_CALL(nice_mock, DoThis());
  nice_mock.DoThis();       // Expected call
  nice_mock.Calculate(42);  // Uninteresting call, no warning
}

void TestNaggyMock() {
  NaggyMock<MockFoo> naggy_mock;
  EXPECT_CALL(naggy_mock, DoThis());
  naggy_mock.DoThis();      // Expected call
  naggy_mock.Calculate(99); // Uninteresting call, prints warning
}

void TestStrictMock() {
  StrictMock<MockFoo> strict_mock;
  EXPECT_CALL(strict_mock, DoThis());
  strict_mock.DoThis();       // Expected call
  strict_mock.Calculate(15);  // Uninteresting call, fails test
}
```

---

## Troubleshooting

- **No warnings generated on uninteresting calls?**
  Verify if you're using `NiceMock` intentionally.
- **Unexpected calls not causing failures?**
  Check if uninteresting calls are confused with unexpected calls; only unexpected calls cause failures by default.
- **Mock behaves unexpectedly with base class methods?**
  Confirm mock methods are declared using `MOCK_METHOD` directly in the mock class, as wrappers do not modify base class mock methods.
- **Test fails unexpectedly after refactoring?**
  Consider using `NiceMock` to reduce brittle tests caused by overly strict call policies.

---

## Additional References

- [Mocking Reference - The Nice, the Strict, and the Naggy](https://google.github.io/googletest/reference/mocking.html#NiceStrictNaggy)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [gMock Cookbook - Knowing When to Expect](https://google.github.io/googletest/gmock_cook_book.html#UseOnCall)
- [Defining and Using Mock Classes](https://google.github.io/googletest/api/gmock_reference.html)

---

`Controlling Mock Call Policies` ensure that your tests communicate the expectations on mock calls effectively. By selecting appropriate wrappers (`NiceMock`, `NaggyMock`, `StrictMock`), you balance between test strictness and maintainability, promoting robust and clear testing practices.
