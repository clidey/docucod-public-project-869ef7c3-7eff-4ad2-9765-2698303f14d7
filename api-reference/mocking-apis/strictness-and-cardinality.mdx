---
title: "Strictness Levels and Cardinalities"
description: "Control uninteresting calls and enforce call count constraints using NiceMock, NaggyMock, StrictMock, and cardinalities (Times, AtLeast, AtMost). This page documents strictness-related APIs and how they shape test reliability."
---

# Strictness Levels and Cardinalities

Control uninteresting call reporting and enforce call count constraints with GoogleMock's strictness modifiers and cardinalities. This documentation details how to use **NiceMock**, **NaggyMock**, and **StrictMock** to manage the behavior upon uninteresting calls, as well as how to specify cardinalities with the `Times()` clause to control how many times mocked methods are expected to be invoked.

---

## Strictness Levels: Nice, Naggy, and Strict Mocks

GoogleMock provides three modifiers to control how mock objects behave in response to uninteresting calls â€” calls to mock methods for which no **EXPECT_CALL** expectation is set:

- **NiceMock** suppresses warnings and allows uninteresting calls silently.
- **NaggyMock** (the default) prints warnings when uninteresting calls happen.
- **StrictMock** treats any uninteresting call as a test failure.

Using these modifiers helps you tailor the verbosity and strictness of your tests according to your verification needs.

### Why Strictness Levels Matter

Uninteresting calls can indicate either intentional ignoring of interactions or oversight in specifying expectations. These modifiers help you avoid noisy test output or detect unintended calls early.

### Usage Patterns

Suppose you have a mock class `MockFoo`:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

// Default (NaggyMock): warns on uninteresting calls
MockFoo naggy_foo;

// NiceMock: ignores uninteresting calls
NiceMock<MockFoo> nice_foo;

// StrictMock: fails on uninteresting calls
StrictMock<MockFoo> strict_foo;
```

`NiceMock<T>`, `NaggyMock<T>`, and `StrictMock<T>` are subclasses of `T` and forward constructors, so you can instantiate them with the same arguments as `T`.

### Characteristics Summary

| Modifier      | Behavior on Uninteresting Calls | Impact on Unexpected Calls |
| ------------- | ------------------------------- | -------------------------- |
| `NiceMock`    | Silently ignores                 | Fail                        |
| `NaggyMock`   | Prints warning                  | Fail                        |
| `StrictMock`  | Test failure                   | Fail                        |


### Important Considerations

- These modifiers affect **only uninteresting calls**, not unexpected calls (calls for which an expectation exists but the arguments don't match).
- They only work for mock methods declared directly in `T` using `MOCK_METHOD`. Methods mocked in base classes may not be affected.
- Using strict mocks tends to make tests fragile and should be applied judiciously.
- Nesting of strictness modifiers (`NiceMock<StrictMock<T>>`) is **not supported**.

### Suppressing Uninteresting Call Warnings for Specific Mocks

If you allocate mocks on the heap and want to suppress leak warnings, use `Mock::AllowLeak()`:

```cpp
NiceMock<MockFoo>* leaked = new NiceMock<MockFoo>;
Mock::AllowLeak(leaked);
EXPECT_CALL(*leaked, DoThis());
leaked->DoThis();
```

---

## Cardinalities: Controlling Call Counts with `Times()` Clause

The `Times()` clause lets you specify how many times a mocked method call is expected. You can express exact counts or flexible ranges.

### Cardinality Types

| Cardinality               | Description                               | Example
|---------------------------|-------------------------------------------|---------------------------------------------------|
| `Exactly(n)` or `n`      | Exactly n times                            | `.Times(Exactly(3))` or `.Times(3)` expects exactly 3 calls
| `AtLeast(n)`             | At least n times                          | `.Times(AtLeast(1))` expects 1 or more calls
| `AtMost(n)`              | At most n times                           | `.Times(AtMost(2))` expects up to 2 calls
| `Between(m, n)`          | Between m and n times (inclusive)        | `.Times(Between(1, 3))` expects 1, 2, or 3 calls
| `AnyNumber()`            | Any number of calls, including zero      | `.Times(AnyNumber())` allows any number of calls


### Default Cardinality Inference

GoogleMock infers the expected call counts automatically if you omit `.Times()`:

- If **no** `WillOnce()` or `WillRepeatedly()`, default to `.Times(1)`.
- If *n* `WillOnce()` and **no** `WillRepeatedly()`, default to `.Times(n)`.
- If *n* `WillOnce()` and one `WillRepeatedly()`, default to `.Times(AtLeast(n))`.

### Example Usages

```cpp
EXPECT_CALL(mock, DoThis()).Times(3);  // expect exactly 3 calls

EXPECT_CALL(mock, DoThis()).Times(AtLeast(1));  // expect one or more calls

EXPECT_CALL(mock, DoThis()).Times(AnyNumber());  // do not care how many times

EXPECT_CALL(mock, DoThis())
    .WillOnce(Return(1))
    .WillOnce(Return(2));  // will expect exactly 2 calls, returns 1 then 2

EXPECT_CALL(mock, DoThis())
    .WillOnce(Return(1))
    .WillRepeatedly(Return(2));  // n>=1 calls expected; 1 then 2s
```

### Enforcing No Calls

Use `.Times(0)` to forbid calls to a method:

```cpp
EXPECT_CALL(mock, DoThat(_)).Times(0);  // fail if DoThat called at all
```

### Best Practices

- Overly restrictive cardinalities can make tests brittle.
- Use `AnyNumber()` or `AtLeast()` to allow flexibility in less critical calls.
- When ordering or exact call count matters, use explicit cardinalities.

---

## Working with Strictness and Cardinalities Together

These two features complement each other:

- **Strictness modifiers** manage behavior for *uninteresting* calls.
- **Cardinalities** define the expected call count for *interesting* calls.

You can combine strict mocks with precise cardinalities to enforce strict contract checking:

```cpp
StrictMock<MockFoo> strict_foo;
EXPECT_CALL(strict_foo, DoThis()).Times(2);

// test will fail if DoThis() is called not exactly twice
// or if any other mock method with no expectation is called
```

---

## Practical Tips and Common Pitfalls

- Always set **EXPECT_CALL()** *before* exercising code that might call mocked methods.
- Avoid mixing strictness modifiers on the same mock class hierarchy.
- Use `NiceMock` when you want to reduce noise from uninteresting calls during development.
- Use `StrictMock` only when it is critical to catch any unexpected method calls.
- To suppress uninteresting call warnings for specific mocks, use `Mock::AllowLeak()` or `NiceMock`.
- Remember that cardinalities are *sticky*: saturated expectations stay active unless `RetiresOnSaturation()` is used.
- For expectations that should be retired immediately upon saturation, append `.RetiresOnSaturation()`:

```cpp
EXPECT_CALL(mock, DoThis())
    .Times(1)
    .RetiresOnSaturation();
```

- If you want to allow a default expectation to catch calls that don't match any specific expectations, write a catch-all with `Times(AnyNumber())`:

```cpp
EXPECT_CALL(mock, DoThis(_)).Times(AnyNumber());
EXPECT_CALL(mock, DoThis(5)).Times(1);
```

- Newer expectations override older ones.

---

## Summary

GoogleMock's strictness levels and cardinalities empower you to write precise, maintainable tests by clearly expressing how mocks should behave with unexpected calls and how many times methods should be called. Using these tools together helps strike the right balance between test robustness and flexibility.

---

## References & Related Documentation

- [GoogleMock Mocking Reference](https://google.github.io/googletest/reference/mocking.html#NiceMock)
- [gMock for Dummies: Setting Expectations](https://google.github.io/googletest/gmock_for_dummies.html#setting-expectations)
- [gMock Cookbook: The Nice, the Strict, and the Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [EXPECT_CALL Clause: Times](https://google.github.io/googletest/reference/mocking.html#EXPECT_CALL.Times)
- [GoogleTest Primer: Writing Your First Test](https://google.github.io/googletest/getting-started.html#writing-your-first-test)

---