---
title: "Strictness Policies & Unexpected Calls"
description: "Documents the use of NiceMock, NaggyMock, and StrictMock templates to control how mocks react to uninteresting or unexpected calls. Users learn to select strictness policies that balance test stability with warning and failure handling requirements."
---

# Strictness Policies & Unexpected Calls

This page guides you through the use of **NiceMock**, **NaggyMock**, and **StrictMock** templates in GoogleMock, which control how mock objects handle uninteresting or unexpected method calls. Choosing the appropriate strictness policy helps you balance between test stability and feedback sensitivity by controlling whether calls without explicit expectations result in warnings, failures, or are silently ignored.

---

## Understanding Mock Strictness Policies

When working with mock objects, it is common that not all method calls need explicit expectations. Some calls may be "uninteresting" — not affecting the test's outcome or verifications. GoogleMock provides three main policies to handle these calls:

### 1. NiceMock

- **Suppresses warnings** on uninteresting calls.
- Treats uninteresting calls as allowed with no output.
- Behavior otherwise is identical to the underlying mock.

### 2. NaggyMock (Default Behavior)

- Prints **warnings** when uninteresting calls are made.
- Does **not** treat uninteresting calls as failures.
- Default policy for mock objects unless overridden.

### 3. StrictMock

- Treats **uninteresting calls as test failures**.
- Useful for catching unexpected behavior early.
- Makes tests more brittle but more precise.

<Note>
`NiceMock<T>`, `NaggyMock<T>`, and `StrictMock<T>` wrap a user-defined mock class `T` and modify its behavior regarding uninteresting calls. These wrappers inherit all constructors from `T`, so they can be constructed with the same arguments.
</Note>

---

## Using Strictness Wrappers

The wrappers apply strictness at the **mock object** level. Here's how to use them:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

// Suppose MockFoo is your mock class.

// Nice mock: suppresses warnings on uninteresting calls.
NiceMock<MockFoo> nice_mock;

// Naggy mock: warns on uninteresting calls (default behavior).
NaggyMock<MockFoo> naggy_mock;

// Strict mock: treats uninteresting calls as failures.
StrictMock<MockFoo> strict_mock;
```

They can be constructed with the same arguments as your mock class:

```cpp
NiceMock<MockBar> nice_bar("example", 42);
StrictMock<MockBar> strict_bar('a', 'b', "test", "data", 1, 2, "x", "y", true, false);
```

<Check>
Ensure your mock class `T` defines its mock methods directly (with `MOCK_METHOD` macros) inside the class — strictness wrappers only work reliably in this case.
</Check>

<Warning>
Strictness wrappers depend on `T` having a virtual destructor to function correctly. Lack of a virtual destructor may cause undefined behavior.
</Warning>

---

## How Strictness Affects Unexpected and Uninteresting Calls

### Uninteresting Calls

- Calls to mock methods without an explicit `EXPECT_CALL`.
- By default (naggy), these produce warnings but do not fail tests.
- `NiceMock` suppresses these warnings.
- `StrictMock` turns these warnings into test failures.

### Unexpected Calls

- Calls to mock methods with `EXPECT_CALL`s, but with arguments that do not match any expectation.
- Always treated as failures regardless of strictness.


default mock = NaggyMock behavior

Thus, **strictness wrappers only affect uninteresting calls**, not unexpected calls.

---

## When and Why to Use Different Strictness Levels

| Strictness     | When to Use                                  | Benefits                                      | Risks                         |
|----------------|---------------------------------------------|-----------------------------------------------|-------------------------------|
| NiceMock       | When uninteresting calls are common and noise is unwanted | Cleaner test output; reduces false alarms | May hide missed calls unintentionally |
| NaggyMock      | Default for development and debugging       | Alerts on potentially missing expectations    | Test output can be noisy        |
| StrictMock     | When test correctness depends on exact interaction | Catches unexpected calls promptly             | Tests may become brittle        |


Use **NiceMock** in stable tests where uninteresting calls are inconsequential. Use **StrictMock** for critical tests demanding exact interaction fidelity.

---

## Example: Using Strictness Policies

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockDatabase {
 public:
  MOCK_METHOD(void, Connect, (), ());
  MOCK_METHOD(int, GetData, (int key), ());
};

// Nice mock example:
NiceMock<MockDatabase> nice_db;
// Only expect Connect, ignore GetData calls
EXPECT_CALL(nice_db, Connect());
// Calling GetData without expectation will not warn or fail
nice_db.GetData(123);  // No warning or error

// Naggy mock example:
NaggyMock<MockDatabase> naggy_db;
EXPECT_CALL(naggy_db, Connect());
// Calling GetData without expectation issues a warning
naggy_db.GetData(123);  // Warning printed

// Strict mock example:
StrictMock<MockDatabase> strict_db;
EXPECT_CALL(strict_db, Connect());
// Calling GetData without expectation fails the test
strict_db.GetData(123);  // Test failure due to unexpected call
```

---

## Important Notes and Best Practices

- **Do not nest strictness wrappers:** For example, `NiceMock<StrictMock<MockFoo>>` is unsupported.
- Always set **explicit expectations for methods you want to verify**; use `ON_CALL` for default behavior.
- To avoid warning spam from uninteresting calls, prefer using `NiceMock` or add a catch-all expectation (`EXPECT_CALL(mock, Method(_)).Times(AnyNumber())`).
- If a mock method returns a type without a default constructor, uninteresting calls on a nice mock can throw exceptions.
- Use `Mock::AllowLeak(&mock_instance)` if you intentionally leak mocks to avoid false positives in leak detection.

<Warning>
The strictness wrappers only affect uninteresting calls, NOT unexpected calls. Unexpected calls (calls not matching any expectation) ALWAYS fail the test.
</Warning>

---

## Troubleshooting Common Scenarios

<AccordionGroup title="Troubleshooting Strictness Wrappers">
<Accordion title="Why am I still getting warnings with NiceMock?">
If your mock methods are defined in a **base class** and not directly in the mock class wrapped by `NiceMock`, warnings may still appear. Define mocks directly in the wrapped class or ensure your compiler supports correct behavior.
</Accordion>

<Accordion title="Why doesn't StrictMock fail on all uninteresting calls?">
`StrictMock` only affects methods defined with `MOCK_METHOD` macros **directly** in the mock class. Methods inherited from base classes may not honor strict mode due to compiler limitations.
</Accordion>

<Accordion title="How do I disable warnings for specific uninteresting calls?">
Add an explicit catch-all expectation with:

```cpp
EXPECT_CALL(mock, Method(_)).Times(AnyNumber());
```

This declares the call as expected, preventing warnings.
</Accordion>
</AccordionGroup>

---

## Summary

Choosing the right strictness policy with `NiceMock`, `NaggyMock`, and `StrictMock` lets you fine-tune your test suite’s balance between noise and strictness. Use `NiceMock` to silence warnings on uninteresting calls, `NaggyMock` for default verbosity, and `StrictMock` to enforce strict adherence to expectations by failing on any uninteresting calls. Remember, unexpected calls always fail, regardless of strictness. Proper use of these wrappers leads to more maintainable and reliable tests.

---

## Related Documentation

- [Mocking Reference](docs/reference/mocking.md) — Detailed info on mock syntax and usage
- [gMock for Dummies](docs/gmock_for_dummies.md) — Beginner-friendly tutorial covering mock concepts
- [gMock Cookbook](docs/gmock_cook_book.md) — Practical recipes for advanced mocking scenarios
- [Defining Expectations & Actions](api-reference/mocking-apis/defining-expectations-actions.md) — How to specify mock behaviors
- [Mock Classes & Method Macros](api-reference/mocking-apis/mock-classes-methods.md) — Defining mock interfaces

---

## Source Code Reference

For the underlying implementation details, see the official source files:

- `googlemock/include/gmock/gmock-nice-strict.h` — Defines the `NiceMock`, `NaggyMock`, and `StrictMock` classes.
- `googlemock/src/gmock-spec-builders.cc` — Implements behavior for these classes and uninteresting call handling.

---

### Visual Overview

```mermaid
classDiagram
  class NiceMock~T~ {
    + constructors(...)
    + inherits From T
    + suppressUninterestingWarning()
  }

  class NaggyMock~T~ {
    + constructors(...)
    + inherits From T
    + warnUninterestingCall()
  }

  class StrictMock~T~ {
    + constructors(...)
    + inherits From T
    + failUninterestingCall()
  }

  class MockClass {
    + MOCK_METHOD(...)
  }

  NiceMock~MockClass~ <|-- MockClass
  NaggyMock~MockClass~ <|-- MockClass
  StrictMock~MockClass~ <|-- MockClass

  Note for MockClass "Defines mock methods using\nMOCK_METHOD macro"
  Note for StrictMock~T~ "Fails tests on uninteresting\ncalls"
  Note for NaggyMock~T~ "Warns on uninteresting calls"
  Note for NiceMock~T~ "Suppresses warnings on uninteresting calls"
```

This diagram shows how the three strictness wrappers are subclasses of the mock class and modify uninteresting call handling.

---

**End of Strictness Policies & Unexpected Calls Documentation**
