---
title: "Built-in Matchers"
description: "API index and descriptions for the full suite of built-in matchers, including equality, relational, container, and arithmetic matchers. Practical examples and tips for matching arguments and values effectively."
---

# Built-in Matchers

The Built-in Matchers page serves as your comprehensive index and guide to GoogleMock's powerful suite of pre-defined matchers. These matchers empower you to specify and verify the arguments passed to mock functions with great precision and clarity. From simple equality checks to sophisticated relational, container-based, and arithmetic conditions, this reference equips you to write expressive, maintainable tests that capture your intent accurately.

---

## Understanding Built-in Matchers

Matchers are predicates used in `EXPECT_CALL` and `ON_CALL` macros to define expectations and behaviors on mock object methods. They allow flexible and powerful validation of function arguments, enabling you to specify exactly what inputs you expect and how they should be matched.

Matchers can be passed as individual argument validators or combined and nested to formulate complex conditions. They apply in assertions like `EXPECT_THAT(actual_value, matcher)` to directly verify values as well.

---

## Categories of Matchers

GoogleMock’s built-in matchers cover broad usage scenarios. Below we describe key matcher categories with usage scenarios and example code to get you started quickly and effectively.

### 1. Wildcard Matchers

- `_` — Matches any value of the correct type, useful when you don't care about an argument.
- `A<type>()` or `An<type>()` — Matches any value of a specific type.

**Example:**
```cpp
EXPECT_CALL(mock_obj, Method(_, 42));
// Matches any first argument, second argument must equal 42.
```

### 2. Equality and Relational Matchers

Matchers that test arguments using standard comparison operators:

| Matcher              | Meaning                                |
|---------------------|---------------------------------------|
| `Eq(value)` or `value` | Equals `value` (using operator==)    |
| `Ne(value)`           | Not equal to `value`                  |
| `Lt(value)`           | Less than `value`                     |
| `Le(value)`           | Less than or equal to `value`        |
| `Gt(value)`           | Greater than `value`                  |
| `Ge(value)`           | Greater than or equal to `value`     |

**Example:**
```cpp
EXPECT_CALL(mock, SetAge(Ge(18)));  // The age argument must be >= 18.
```

### 3. Boolean Matchers

Matchers that verify the Boolean state or pointer validity.

| Matcher      | Description                     |
|--------------|--------------------------------|
| `IsTrue()`   | Argument evaluates to true      |
| `IsFalse()`  | Argument evaluates to false     |
| `IsNull()`   | A NULL pointer (raw or smart)  |
| `NotNull()`  | A non-null pointer              |
| `Ref(variable)` | Matches argument that is a reference to variable. Useful for verifying reference identity. |

**Example:**
```cpp
EXPECT_CALL(mock, ProcessData(NotNull()));
```

### 4. Floating-Point Matchers

Use these to compare floating-point numbers allowing for rounding error and NaN handling.

| Matcher                      | Description                              |
|-----------------------------|-----------------------------------------|
| `FloatEq(value)`, `DoubleEq(value)` | Approximately equal to `value` using ULP comparison (NaNs unequal)  |
| `NanSensitiveFloatEq(value)`, `NanSensitiveDoubleEq(value)` | Approx equal treating NaNs equal                  |
| `FloatNear(value, max_abs_error)`, `DoubleNear(value, max_abs_error)` | Close to `value` within absolute error boundary                |
| `IsNan()`                   | Argument is a NaN value                  |

**Example:**
```cpp
EXPECT_CALL(mock, GetMeasurement())
    .WillOnce(Return(DoubleNear(3.1415, 0.001)));
```

### 5. String Matchers

For matching string or C-string arguments with common string operations or regex.

| Matcher               | Description                                      |
|----------------------|-------------------------------------------------|
| `StartsWith(prefix)`  | Argument starts with `prefix`                    |
| `EndsWith(suffix)`    | Argument ends with `suffix`                      |
| `HasSubstr(substring)`| Argument contains substring                      |
| `StrEq(string)`       | String equality                                  |
| `StrNe(string)`       | String inequality                                |
| `StrCaseEq(string)`   | Case-insensitive string equality                 |
| `StrCaseNe(string)`   | Case-insensitive string inequality               |
| `MatchesRegex(regex)` | Argument matches entire regex                     |
| `ContainsRegex(regex)`| Argument contains a match for regex anywhere    |
| `WhenBase64Unescaped(m)` | Argument is a Base64-encoded string whose unescaped value matches matcher `m`|

**Example:**
```cpp
EXPECT_CALL(mock, SendMessage(StartsWith("Hello")));
```

### 6. Container Matchers

Matchers to validate STL-like containers and arrays.

| Matcher                    | Description                                                    |
|---------------------------|----------------------------------------------------------------|
| `Contains(e)`              | Container contains an element matching `e`                    |
| `Each(e)`                  | Every element in the container matches `e`                   |
| `ElementsAre(e0, e1, ..., en)` | Container has exactly `n+1` elements matching each `e_i` in order |
| `ElementsAreArray(array)`  | Same as `ElementsAre` but takes a contiguous array or container  |
| `UnorderedElementsAre(...)`| Like `ElementsAre` ignoring element order                     |
| `UnorderedElementsAreArray(array)` | Same as above but from array/container                    |
| `IsEmpty()`                | Container is empty                                            |
| `SizeIs(matcher)`          | Container size matches `matcher`                             |
| `IsSubsetOf(collection)`   | Container is a subset of the given collection               |
| `IsSupersetOf(collection)` | Container is a superset of the given collection             |
| `Pointwise(m, container)`  | Elements match pointwise with `container` via matcher `m`  |
| `UnorderedPointwise(m, container)` | Like `Pointwise` ignoring order                             |
| `ContainerEq(container)`   | Container is exactly equal to `container` with enhanced diagnostic messages|

**Example:**
```cpp
EXPECT_CALL(mock, ProcessIds(ElementsAre(1, Gt(10), _)));
EXPECT_CALL(mock, ConfigureSettings(IsEmpty()));
```

### 7. Member and Property Matchers

Matchers that validate specific fields or properties of complex objects.

| Matcher                                   | Description                                  |
|------------------------------------------|----------------------------------------------|
| `Field(&Class::field, matcher)`           | Matches if `obj.field` satisfies `matcher`   |
| `Property(&Class::property, matcher)`     | Matches if `obj.property()` satisfies `matcher`. The method must be `const` and argument-free. |
| `Key(matcher)`                            | Matches std::pair whose .first matches `matcher` |
| `Pair(matcher1, matcher2)`                | Matches std::pair whose fields match respective matchers  |
| `FieldsAre(m1, m2, ... mn)`               | Matches tuple-like types element-wise                     |

**Example:**
```cpp
EXPECT_CALL(mock, SetFoo(Field(&Foo::id, Ge(100))));
EXPECT_CALL(mock, ProcessBar(Property(&Bar::Name, StartsWith("X"))));
```

### 8. Pointer Matchers

Matchers that work on raw or smart pointers.

| Matcher                     | Description                                            |
|----------------------------|--------------------------------------------------------|
| `IsNull()`                 | Matches a null pointer                                  |
| `NotNull()`                | Matches a non-null pointer                              |
| `Pointee(matcher)`         | Matches pointer pointing to a value matching `matcher`|
| `Pointer(matcher)`         | Matches pointer value matching `matcher`              |
| `Address(matcher)`         | Matches the address of the object to matcher          |
| `WhenDynamicCastTo<T>(matcher)` | Matches object after dynamic_cast to `T` matches matcher (requires RTTI) |

### 9. Composite Matchers

Matchers built by combining other matchers for more expressive conditions.

| Matcher                | Description                          |
|-----------------------|------------------------------------|
| `AllOf(m1, m2, ..., mn)` | Matches if *all* matchers succeed  |
| `AnyOf(m1, m2, ..., mn)` | Matches if *any* matcher succeeds  |
| `Not(matcher)`          | Matches if the inner matcher does not match
| `Conditional(cond, m1, m2)`| Matches `m1` if `cond` is true else `m2`

---

## Practical Examples

### Basic Equality & Wildcard
```cpp
EXPECT_CALL(mock, Calculate(_)); // Argument can be anything
EXPECT_CALL(mock, Calculate(42)); // Argument must be 42
```

### Range & Relational
```cpp
EXPECT_CALL(mock, SetLevel(Ge(10))); // Argument >= 10
EXPECT_CALL(mock, SetValue(AllOf(Gt(0), Lt(100)))); // Argument in (0,100)
```

### Container Matchers
```cpp
// Expect vector to have exactly these elements in order
EXPECT_CALL(mock, ProcessIds(ElementsAre(1,2,3)));

// Expect container with elements 3,1,2 in any order
EXPECT_CALL(mock, ProcessIds(UnorderedElementsAre(3,1,2)));

// Expect container where every element is >= 0
EXPECT_CALL(mock, ProcessIds(Each(Ge(0))));
```

### String Matchers
```cpp
EXPECT_CALL(mock, SendMessage(StartsWith("Hello")));
EXPECT_CALL(mock, SendMessage(HasSubstr("error")));
EXPECT_CALL(mock, SendMessage(MatchesRegex(".*error.*")));
```

### Advanced Field Checking
```cpp
// Match Foo object whose id >= 5 and name starts with 'J'
EXPECT_CALL(mock, AddUser(
    AllOf(Field(&User::id, Ge(5)), Field(&User::name, StartsWith("J")))));
```

### Pointer Validation
```cpp
EXPECT_CALL(mock, ProcessData(IsNull()));      // Must receive nullptr
EXPECT_CALL(mock, ProcessData(NotNull()));     // Non-null ptr
EXPECT_CALL(mock, ProcessData(Pointee(Ge(100)))); // Pointer pointing to value >= 100
```

### Composite and Multi-arg Matching
```cpp
// The 2 argument tuple must satisfy less than for first < second
EXPECT_CALL(mock, UpdatePosition(_, _)).With(Lt());

// The argument must not be zero and less than 10
EXPECT_CALL(mock, SetThreshold(Not(AllOf(Eq(0), Lt(10)))));
```

---

## Best Practices & Tips

- **Specify only necessary matchers.** Overly strict expectations cause brittle tests.
- **Use `_` wildcard** for arguments whose values are irrelevant.
- **Order matters:** Newer `EXPECT_CALL`s override older ones.
- **Combine matchers** with `AllOf()`, `AnyOf()`, and `Not()` to express complex conditions succinctly.
- **Validate complex objects' members** using `Field()` and `Property()` rather than their entire state.
- **Use container matchers** like `ElementsAre()` to precisely control sequence and content.
- **Leverage pointer matchers** to avoid null pointer issues and inspect pointed-to values.
- When matching overloaded methods, use `TypedEq<T>()` or `Matcher<T>()` to specify exact types.

---

## Troubleshooting Common Issues

- **Ambiguous Overloads:** Specify argument types explicitly using `TypedEq<T>()` or `Matcher<T>()` to disambiguate.
- **Unintended Match Failures:** Check if default actions or cardinalities in `EXPECT_CALL` clauses are appropriate.
- **Sticky Expectations:** Use `.RetiresOnSaturation()` to ensure expectations no longer match after exhausted calls.
- **Null Pointer Dereferencing:** Utilize `NotNull()` along with `Pointee()` to ensure safety.
- **Mixin Matchers:** Nested matchers (e.g., `Pointee(Field(...))`) require familiarity with matcher combinators.

---

## Additional Resources

- [Matchers Reference](https://google.github.io/googletest/reference/matchers.html) — detailed list and explanation of all matchers.
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — beginner friendly guide on mocking, including matchers.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#MatchForMockMethod) — recipes and advanced use cases.
- [Writing Powerful Assertions](../guides/core_workflows/writing-assertions.md) — how to combine matchers and expectations effectively.
- Source code reference: [`gmock-matchers.h`](https://github.com/google/googletest/blob/main/googlemock/include/gmock/gmock-matchers.h)

---

This page bridges you from basic `EXPECT_CALL` usage to mastering expressive matchers, accelerating your testing workflow with richer and more precise validations.

---