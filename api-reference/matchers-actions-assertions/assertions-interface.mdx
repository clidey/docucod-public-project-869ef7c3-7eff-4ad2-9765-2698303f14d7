---
title: "Assertions Interface"
description: "Reference to assertion macros and their behaviors: fatal/non-fatal, death tests, and user-defined assertions. Enables users to verify program correctness and failure modes with precision."
---

# Assertions Interface

The Assertions Interface provides a comprehensive system of macros and support mechanisms within GoogleTest and GoogleMock to enable precise verification of your program's correctness and failure handling. This interface empowers you to define, detect, and control failures — both fatal and non-fatal — and to create your own user-defined assertions tailored to your testing needs.

---

## 1. Understanding Assertions

Assertions form the backbone of any robust testing framework. They represent checks performed at runtime to verify that the program state meets your expectations. If an assertion fails, it indicates a problem either in the code under test or in the test itself.

### 1.1. Types of Assertions

- **Fatal Assertions**: Immediately stop the current test upon failure. Useful when continuing the test makes no sense or would cause confusing cascaded errors.

- **Non-fatal Assertions**: Record the failure but allow the test to continue. This lets you detect multiple failures in a single test and gather more diagnostic information.

- **Death Tests**: Verify that your program terminates in expected ways (e.g., crash or call `exit()`) when given invalid inputs or in error scenarios.

### 1.2. When to Use Fatal vs Non-fatal

Use fatal assertions when subsequent test logic depends on the state validated by the assertion. Use non-fatal assertions when independent verifications can continue, enabling more comprehensive feedback.

---

## 2. Built-in Assertion Macros

GoogleTest and GoogleMock provide a rich set of assertion macros with expressive naming patterns:

| Macro Type             | Example                  | Description                                |
|-----------------------|--------------------------|--------------------------------------------|
| Fatal assertion         | `ASSERT_TRUE(condition);` | Stops test immediately on failure          |
| Non-fatal assertion     | `EXPECT_EQ(val1, val2);`  | Logs failure but continues test             |
| Death test              | `ASSERT_DEATH(statement, regex);` | Verifies program termination as expected |
| Fatal assertion with message | `ASSERT_TRUE(condition) << message;` | Adds custom diagnostic message           |

**Examples:**

```cpp
TEST(SampleTest, BasicAssertions) {
  int x = 5;
  ASSERT_EQ(x, 5) << "X should be 5 at this point";  // Fatal

  EXPECT_NE(x, 0);      // Non-fatal: test continues even if this fails
}
```

```cpp
TEST(FooDeathTest, CrashesOnNull) {
  ASSERT_DEATH(Foo(nullptr), "Null pointer");
}
```

---

## 3. Writing User-Defined Assertions

If your testing scenario demands verification not directly supported by built-in macros, GoogleTest lets you define your own assertions.

### 3.1. ASSERT/EXPECT macros using predicates

Create assertion macros from predicates using `ASSERT_PRED_FORMAT*` and `EXPECT_PRED_FORMAT*`. This allows rich custom failure messages and argument printing.

```cpp
::testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) return ::testing::AssertionSuccess();
  return ::testing::AssertionFailure() << n << " is odd";
}

TEST(MyTest, Custom) {
  int value = 3;
  ASSERT_PRED_FORMAT1(IsEven, value);
}
```

### 3.2. Basic macros for booleans and equality

To quickly implement simple assertions, use `ASSERT_TRUE(condition)` or `ASSERT_EQ(expected, actual)`.

### 3.3. Providing Diagnostic Messages

All assertion macros support streaming additional diagnostic information for clarity:

```cpp
ASSERT_TRUE(foo) << "Failure because foo was false";
EXPECT_EQ(2, bar) << "bar is not 2 as expected";
```

Your custom predicates also allow you to describe the failure in detail.

---

## 4. Assertion Failure Behavior

- **Fatal failures** abort the current test method execution.
- **Non-fatal failures** log the failure and continue execution.
- **Assertion failures** may be reported with source file and line number information, helping you quickly locate the problem.

The framework provides detailed messages including argument values, mismatched expectations, and call traces when related to mock invocation failures.

---

## 5. Integration with GoogleMock

GoogleMock leverages the Assertions Interface to verify mock method calls against expectations:

- When an `EXPECT_CALL` expectation is violated, the framework reports failures through assertions.
- Uninteresting or unexpected calls generate warnings or errors based on mock strictness.
- The testing framework checks assertions at mock destruction and can verify expectations manually using `Mock::VerifyAndClearExpectations` and `Mock::VerifyAndClear`.

Example:

```cpp
MockFoo foo;
EXPECT_CALL(foo, Bar(42));
foo.Bar(43);  // Will trigger an assertion failure due to argument mismatch
```

---

## 6. Best Practices for Using Assertions

- Use `EXPECT_` macros when subsequent test steps can still provide valuable checks.
- Use `ASSERT_` macros to prevent cascading errors.
- Provide meaningful diagnostic messages to ease debugging.
- Avoid excessively strict expectations or overly generic assertions to prevent brittle or weak tests.
- When mocking, prefer setting expectations before exercising the mock to get immediate verification.

---

## 7. Troubleshooting Common Assertion Issues

- Assertion failures often include actionable messages. Read them carefully for mismatched values and failed preconditions.
- Use verbose flags in GoogleTest and GoogleMock (`--gtest_break_on_failure` or `--gmock_verbose=info`) to get detailed call stacks and diagnostic output.
- For flaky test failures, check for thread-safety or environment dependencies.

---

## 8. Additional Resources

- [GoogleTest Assertions Reference](https://google.github.io/googletest/reference/assertions.html)
- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — for mocking best practices
- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — beginner-friendly overview
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — detailed explanation of mocking

---

<Info>
Remember: the ultimate goal of assertions is to write tests that are both precise and maintainable, catching issues early while providing clear insight into failures.
</Info>
