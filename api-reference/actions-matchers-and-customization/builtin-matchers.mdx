---
title: "Built-in Matchers"
description: "Comprehensive listing of GoogleMock's provided matchers for argument validation, as well as facilities for composing, extending, and customizing matcher logic to fit diverse testing scenarios."
---

# Built-in Matchers

GoogleMock provides a comprehensive set of **built-in matchers** to validate function arguments when setting expectations on mock methods. These matchers allow you to precisely specify the properties and patterns that mocked function arguments should satisfy, enabling expressive and readable test assertions.

---

## Overview

Matchers are predicates that check whether an argument value meets specific criteria. GoogleMock's built-in matchers can match primitive values, pointers, strings, containers, tuples, and user-defined types. You can compose matchers, parameterize them, and combine them logically for complex matching scenarios.

Matchers are fundamental in writing effective tests with GoogleMock, enabling you to verify that method calls happen with the exact, or more flexibly specified, arguments you expect.

---

## Using Built-in Matchers

Matchers are used with macros like `EXPECT_CALL` and `ON_CALL` to specify expectations or default actions on mock methods.

Example:

```cpp
EXPECT_CALL(mock_object, SomeMethod(Ge(5), NotNull(), StartsWith("Hello")));  // Expects: first arg >= 5, second arg non-null, third arg string starting with "Hello"
```

The above will check that the method `SomeMethod` is called with arguments that satisfy the matchers: `Ge(5)`, `NotNull()`, and `StartsWith("Hello")`.

---

## Common Built-in Matchers

### Wildcard Matchers

- `_` or `A<T>()` / `An<T>()` — matches **any value** of type `T`.
- `IsNull()` — matches any null raw or smart pointer.
- `NotNull()` — matches any non-null raw or smart pointer.

### Comparison Matchers

- `Eq(value)` — equals `value` (`==`).
- `Ne(value)` — not equal to `value` (`!=`).
- `Lt(value)`, `Le(value)`, `Gt(value)`, `Ge(value)` — relational comparisons (<, <=, >, >=).

Example:

```cpp
EXPECT_CALL(foo, Bar(Gt(5)));  // Matches calls where the argument is > 5
```

### String Matchers

- `StrEq(str)` / `StrNe(str)` — string equal / not equal, case-sensitive.
- `StrCaseEq(str)` / `StrCaseNe(str)` — string equal / not equal, case-insensitive.
- `HasSubstr(substring)` — string contains the given substring.
- `StartsWith(prefix)` — string starts with the prefix.
- `EndsWith(suffix)` — string ends with the suffix.

All accept `std::string`, C strings, and wide string forms (when supported).

Example:

```cpp
EXPECT_CALL(mock, SetName(StartsWith("Mr.")));
```

### Container Matchers

- `ElementsAre(m1, m2, ...)` — matches container with elements matching each specified matcher in order.
- `UnorderedElementsAre(m1, m2, ...)` — matches container with elements matching specified matchers regardless of order.
- `ElementsAreArray(array_or_container)` — similar to `ElementsAre` but for an array or container.
- `Contains(value_or_matcher)` — matches container containing an element that matches.
- `Each(matcher)` — all elements in the container match the given matcher.
- `SizeIs(matcher)` — container's `.size()` matches the matcher.
- `BeginEndDistanceIs(matcher)` — distance between `begin()` and `end()` matches.

Example:

```cpp
EXPECT_CALL(mock, ProcessVector(ElementsAre(1, Gt(0), _, 5)));
EXPECT_CALL(mock, CheckSet(UnorderedElementsAre(1, 5, 2)));
```

### Tuple and Pair Matchers

- `Pair(m1, m2)` — matches a `std::pair` with first and second elements matching `m1` and `m2`.
- `Key(matcher)` — matches the key of a pair (e.g. map element).
- `Field(field_ptr, matcher)` — matches a member variable field of an object.
- `Property(getter_ptr, matcher)` — matches the result of a const getter method.
- `FieldsAre(m1, m2, ...)` — matches aggregates or tuple-like types by fields.

Example:

```cpp
EXPECT_THAT(my_map, Contains(Pair(Eq("foo"), Gt(42))));
EXPECT_CALL(mock, Foo(Field(&MyClass::number, Le(10))));
```

### Logical Combinators

Compose matchers for combined logical conditions:

- `AllOf(m1, m2, ...)` — matches if **all** matchers match.
- `AnyOf(m1, m2, ...)` — matches if **any** matcher matches.
- `Not(m)` — negates matcher `m`.

Example:

```cpp
EXPECT_CALL(mock, Foo(AllOf(Gt(5), Ne(10))));  // Matches argument > 5 and != 10
EXPECT_THAT(x, Not(HasSubstr("error")));
```

### Approximate and Floating Point Matchers

- `DoubleEq(expected)` — matches floating-point value approximately equal to `expected`.
- `NanSensitiveDoubleEq(expected)` — same as above but treats NaNs as equal.
- `DoubleNear(expected, max_abs_error)` — matches values within absolute error.
- Similar matchers exist for `float` values (`FloatEq`, `NanSensitiveFloatEq`, `FloatNear`).

Example:

```cpp
EXPECT_CALL(mock, Foo(DoubleNear(3.14, 0.0001)));
```

### Pointer and Reference Matchers

- `Pointee(matcher)` — matches a pointer whose pointee satisfies `matcher`.
- `Pointer(matcher)` — matches a pointer (raw or smart) that matches `matcher`.
- `Address(matcher)` — matches an object's address.
- `Ref(variable)` — matches the exact reference to the given variable.

Example:

```cpp
EXPECT_CALL(mock, Bar(Pointee(Ge(5))));      // Pointer points to value >= 5
int x = 10;
EXPECT_CALL(mock, Foo(Ref(x)));               // Matches arguments that are 'x' by reference
```

---

## Parameterized Matchers

GoogleMock provides macros to easily define parameterized matchers:

- `MATCHER_P(name, param, description) { ... }` defines a matcher with one parameter.
- `MATCHER_P2`, `MATCHER_P3`, ..., up to `MATCHER_P10` for multiple parameters.

In the matcher body, you have access to:

- `arg` — the value being matched
- `param` / `param1`, `param2`, ... — the matcher parameters
- `negation` — boolean indicating if match is negated (for description)
- `result_listener` — optionally stream additional failure explanation

Example - divisor matcher:

```cpp
MATCHER_P(IsDivisibleBy, divisor, "") {
  if (arg % divisor == 0) return true;
  *result_listener << "with remainder " << (arg % divisor);
  return false;
}

EXPECT_CALL(mock, Foo(IsDivisibleBy(7)));
```

---

## Customizing Match Descriptions

Matchers allow custom failure message descriptions including conditionally describing negation (e.g. "is divisible by 7" versus "is not divisible by 7") and streaming additional diagnostics to clarify failure reasons.

---

## Composing Matchers

Matchers can be combined neatly with logical operators like `AllOf()`, `AnyOf()`, and `Not()`. These combinators accept multiple matchers and combine predicates accordingly.

Example:

```cpp
EXPECT_CALL(mock, Func(AllOf(Ge(0), Le(10))));  // Argument between 0 and 10
```

---

## Practical Tips and Best Practices

- Use `_` to match any argument when you don't care about it.
- Parameterize matchers for flexible argument validation.
- Use `SafeMatcherCast<T>()` to safely convert matchers for compatible argument types.
- Combine matchers for complex conditions without losing clarity.
- Stream additional failure diagnostics in custom matchers using `result_listener` for clearer error messages.
- Leverage container and tuple matchers for complex argument types.

---

## Troubleshooting Common Issues

- Unprotected commas in argument types require wrapping with parentheses or using type aliases in `MOCK_METHOD` declarations.
- Use `Ref(variable)` carefully since arguments must be matched by reference and the variable should outlive the expectation.
- When mocking overloaded methods, specify matcher types explicitly if necessary to disambiguate.
- Avoid side effects in matchers; they must be purely functional.
- If default matcher descriptions do not suit your needs, provide custom description strings.

---

## References and Related Information

- For defining mock methods using `MOCK_METHOD`, see the [Mock Method Definitions](reference/mocking-and-behavior-specification/mock-method-definitions) page.
- For customizing and creating new matchers, see the [Custom Actions and Matchers](api-reference/actions-matchers-and-customization/custom-actions-matchers) page.
- To understand the context and usage of matchers in expectations, consult [Setting Expectations and Call Sequences](api-reference/mocking-and-behavior-specification/expectations-and-call-sequences). 
- For sample matcher implementations, see the GoogleMock [MATCHER macro documentation](https://google.github.io/googletest/gmock_cook_book.md#writing-new-matchers-quickly).

---

## Summary

This page provides a comprehensive listing and guide to GoogleMock's built-in matchers, covering their usage, categories, combinators, parameterization, and customization options so you can write precise, readable, and maintainable test expectations.

---

# Code Example Summary

```cpp
using ::testing::*;

EXPECT_CALL(mock, Foo(Ge(5), NotNull(), StartsWith("Hello")));
EXPECT_CALL(mock, Bar(ElementsAre(1, Lt(5), _)));
EXPECT_CALL(mock, Baz(Pointee(Ne(nullptr))));

MATCHER_P(IsDivisibleBy, divisor, "") {
  if (arg % divisor == 0) return true;
  *result_listener << "with remainder " << (arg % divisor);
  return false;
}

EXPECT_CALL(mock, Computation(IsDivisibleBy(7)));
```

---

*For detailed syntax and recipes, visit the gMock Cookbook and Matchers Reference.*
