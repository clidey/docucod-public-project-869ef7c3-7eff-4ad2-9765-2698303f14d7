---
title: "Initialization & Platform Support"
description: "Explains initialization procedures, platform compatibility, and main function requirements for running tests on different operating systems and compilers. Includes best practices for reliable and portable test execution."
---

# Initialization & Platform Support

GoogleTest supports a wide variety of platforms and compilers, providing flexible initialization and execution procedures that ensure your tests run reliably and portably across different environments. This document details the recommended initialization routines, platform compatibility considerations, and main function requirements you must follow to achieve consistent test runs.

---

## 1. Initialization Procedures

To run tests with GoogleTest (and the integrated GoogleMock), you must initialize the testing framework properly before executing any tests. This guarantees correct setup of internal state, parsing of command-line flags, and readying the framework for test discovery and execution.

### 1.1 Using `InitGoogleTest` and `InitGoogleMock`

- **`testing::InitGoogleTest(&argc, argv)`**

  - Parses flags intended for GoogleTest.
  - Removes recognized flags from `argv`.
  - Must always be called before running tests with `RUN_ALL_TESTS()`.
  - Essential for enabling flag-driven test configuration (e.g., filtering tests, output formats).

- **`testing::InitGoogleMock(&argc, argv)`**

  - Initializes GoogleMock, which depends on GoogleTest, and as such calls `InitGoogleTest` internally.
  - Use this if your tests use GoogleMock features.

### 1.2 Example: Custom `main()` Function

If you need a custom `main()` function, the canonical pattern is:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);  // Or InitGoogleMock if mocks are used
  return RUN_ALL_TESTS();
}
```

### 1.3 When Can You Skip Writing `main()`?

GoogleTest provides a ready-to-use `gtest_main` library that defines a suitable `main()` implementation. Linking your test binary with `gtest_main` lets you omit writing any main program code.

<Tip>
Most users should link against `gtest_main` unless specific setup or teardown logic prior to running tests is required.
</Tip>

### 1.4 Important Initialization Notes

- **Always pass the command-line arguments (`argc`, `argv`) to `InitGoogleTest` or `InitGoogleMock`** to enable proper parsing of flags.
- The initialization removes recognized testing flags from `argv` to prevent interference with your own argument parsing.
- Only call `RUN_ALL_TESTS()` once per program execution; multiple calls lead to undefined behavior.

## 2. Platform Compatibility

GoogleTest's design ensures broad portability. However, platform-specific considerations apply to maintain reliability in test execution and output.

### 2.1 Supported Platforms

GoogleTest supports these major platforms:

- Linux
- Mac OS X
- Windows (Desktop, MinGW, Mobile variants)
- BSDs (FreeBSD, OpenBSD, NetBSD, DragonFlyBSD)
- Solaris
- IBM AIX
- Android
- Others as listed in the [Supported Platforms](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md)

For the most up-to-date list and versions, refer to the linked matrix.

### 2.2 Compiler and C++ Standard Requirements

- Requires a **C++17-compliant compiler**.
- Tested and supported compilers include GCC, Clang, Microsoft Visual C++, Intel C++, SunPro, LLVM-based compilers.
- Compiler flags should enable C++17 (e.g., `-std=c++17` in GCC/Clang, appropriate MSVC version settings).

<Tip>
Ensure your build system explicitly sets C++17 standard support, either globally or within test targets.
</Tip>

### 2.3 Thread-Safety and Platform Nuances

- GoogleTest is thread-safe on platforms with POSIX `pthread` support and Windows Desktop.
- On platforms lacking pthreads, thread-safety may be limited.
- For embedded or constrained platforms (e.g., ESP32, ESP8266), GoogleTest adapts initialization and test invocation accordingly.

### 2.4 Features Dependent on Platform Capabilities

- **Death Tests** rely on OS support for process forks and file system access.
- **Stream Redirection** (capturing stdout/stderr) depends on platform file descriptor management.
- GoogleTest disables features gracefully when the platform does not support them.

## 3. Main Function Requirements per Platform

GoogleTest adapts its entry point depending on the detected platform to smooth integration with OS norms and compiler expectations.

### 3.1 Standard Desktop Environments (Linux, macOS, Windows)

- Expect standard `int main(int argc, char** argv)` function.
- On Windows Mobile platforms, uses `_tmain(int argc, TCHAR** argv)` to conform with platform expectations.

### 3.2 Embedded or Specialized Platforms (e.g., ESP8266, ESP32)

- Provide alternate setup functions instead of standard `main` (e.g., `void setup()` and `void loop()` in Arduino environments).
- Initialization happens within these functions with calls to `InitGoogleMock()` and periodically running tests.

### 3.3 Linking with `gtest_main` or `gmock_main`

GoogleTest and GoogleMock include convenient main implementations:

- `gtest_main` defines `main()` that initializes GoogleTest and runs all tests.
- `gmock_main` does the same with GoogleMock initialization.

Linking with these libraries simplifies test binaries and ensures consistent platform-specific entry points.

## 4. Best Practices for Reliable and Portable Test Execution

### 4.1 Use Initialization Functions Consistently

Always call `InitGoogleTest` or `InitGoogleMock` passing in command-line arguments before any other GoogleTest APIs.

### 4.2 Avoid Custom `main()` Unless Necessary

Leverage the provided `gtest_main` or `gmock_main` if your test program does not require custom startup logic.

### 4.3 Verify C++17 Support Thoroughly

Check that your environment, build system, and compiler flags enable C++17, as GoogleTest depends on it fully.

### 4.4 Handle Platform-Specific Edge Cases

Be aware of OS-specific behavior when writing death tests, using threading features, or capturing output.

### 4.5 Link Properly Against GoogleTest and GoogleMock Libraries

Follow recommended build integration patterns (see [Integrating with CMake, Bazel, and Custom Build Systems](/guides/real-world-integrations/integrating-with-build-systems)) for setting include paths and linking libraries.

### 4.6 Manage Runtime Dependencies

- On Windows, ensure CRT linkage consistency, especially when mixing static and shared runtimes.
- On POSIX platforms, link with pthreads if threading features are used.

## 5. Troubleshooting Common Issues

<AccordionGroup title="Common Initialization and Platform Issues">
<Accordion title="Tests Not Running or No Output">
Check that you called `InitGoogleTest(&argc, argv)` before `RUN_ALL_TESTS()`. Verify your test cases are properly defined with `TEST()` or `TEST_F()` macros.
</Accordion>
<Accordion title="Linker Errors on Windows Related to Runtime Libraries">
Make sure the `gtest_force_shared_crt` option is set appropriately if building with CMake, to avoid mismatches in CRT linkage between GoogleTest and your project.
</Accordion>
<Accordion title="Unsupported Compiler or Platform Errors">
Confirm your compiler supports C++17 and is in the list of supported compilers. Update your environment or compiler if possible.
</Accordion>
<Accordion title="Thread-Safety or Assertion Issues on Embedded Systems">
Review platform support notes. On embedded or minimal OSes, some features like thread-safety and output capture may be limited or unavailable.
</Accordion>
</AccordionGroup>

## 6. References and Further Reading

- [System Requirements & Supported Platforms](/getting-started/prerequisites-and-installation/system-requirements)
- [Installation Methods (CMake, Bazel, Manual)](/getting-started/prerequisites-and-installation/installation-methods)
- [Project Setup for GoogleTest](/getting-started/configuration-and-first-run/project-setup)
- [Writing and Running Tests](/api-reference/core-testing-apis/writing-tests)
- [Integrating with Build Systems](/guides/real-world-integrations/integrating-with-build-systems)

---

Ensure all initialization follows these guidelines to achieve consistent, portable, and reliable test executions across all targeted environments.