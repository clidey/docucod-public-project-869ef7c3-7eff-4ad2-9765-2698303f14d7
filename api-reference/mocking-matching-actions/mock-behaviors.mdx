---
title: "Mock Strictness and Behavior Modes"
description: "Describes configuration for handling uninteresting calls, including `NiceMock`, `NaggyMock`, and `StrictMock` wrappers. Outlines best practices for integrating these behaviors into test suites."
---

# Mock Strictness and Behavior Modes

This document describes how to configure and use different mock strictness modes in GoogleMock: `NiceMock`, `NaggyMock`, and `StrictMock`. These wrappers control how mocks handle uninteresting calls—calls to mock methods with no explicit expectations—and thus help tailor the noise level and strictness of your test suite. We will explain each behavior, show how to integrate them into your tests, and provide best practices for managing mock behaviors effectively.

---

## Understanding Uninteresting Calls

An **uninteresting call** occurs when a mock method that has no `EXPECT_CALL` expectation is invoked during a test run. By default, GoogleMock classifies such calls as:

- **Naggy**: It prints a warning message but allows the call to proceed, returning the default value.
- **Nice**: It suppresses such warnings, silently allowing the call.
- **Strict**: It treats such calls as errors, failing the test immediately.

Managing these calls appropriately is crucial to reduce noise in test logs and enforce the intended contract between tests and mocks.

---

## Mock Strictness Wrappers Overview

GoogleMock provides three template wrappers around your mock classes to control these behaviors:

| Wrapper Class      | Behavior on Uninteresting Calls                  | Description                                                  |
| :----------------- | :---------------------------------------------- | :----------------------------------------------------------- |
| `NiceMock<T>`      | Suppresses all warnings and errors               | Ideal for tests that want to ignore unimportant mock calls.  |
| `NaggyMock<T>`     | Prints warnings but allows calls                  | The default behavior for regular mock objects (`T`).         |
| `StrictMock<T>`    | Treats uninteresting calls as fatal test failures| Enforces strict contract: all calls must be expected.       |

These wrappers derive from your mock class `T` and can be used interchangeably,
retaining all constructors of `T`. This lets you write:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

NiceMock<MockFoo> nice_foo;      // suppresses uninteresting call warnings
NaggyMock<MockFoo> naggy_foo;    // warns on uninteresting calls (default)
StrictMock<MockFoo> strict_foo;  // errors on uninteresting calls
```

---

## When to Use Each Mode

### NiceMock

Use `NiceMock` when your test does not care about certain mock method calls and you'd prefer clean, warning-free test output. It is especially valuable when:

- You want to suppress warnings on calls not directly relevant to the test's focus.
- Making tests less brittle to implementation changes.

### NaggyMock

`NaggyMock` is Google's current default. It warns when there are uninteresting calls, which can help identify unexpected interactions. Use it when:

- Developing or debugging tests where you want to be aware of all method invocations.
- Monitoring unexpected but harmless calls.

### StrictMock

Turn to `StrictMock` when you want to enforce that your mocks only receive calls you explicitly expect. This mode helps:

- Catch unintended dependencies or changes in mock usage.
- Ensure test precision and prevent silent bugs.

Note that strict mocks are verbose and may lead to brittle tests if overused.

---

## How to Integrate and Use

Mock strictness wrappers seamlessly integrate into your existing GoogleMock workflow.

### Basic Usage

Given a mock class:

```cpp
class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(int, DoThat, (bool flag), ());
};
```

You can create a mock with desired strictness:

```cpp
NiceMock<MockFoo> nice_foo;
NaggyMock<MockFoo> naggy_foo;
StrictMock<MockFoo> strict_foo;
```

Their constructors exactly mirror those of `MockFoo`, including non-default ones.

### Setting Expectations

Expectations and behavior setup are the same regardless of wrapper used:

```cpp
EXPECT_CALL(nice_foo, DoThis()).Times(1);
EXPECT_CALL(naggy_foo, DoThat(true)).WillOnce(Return(42));
EXPECT_CALL(strict_foo, DoThis()).Times(0);  // forbids calls
```

If an uninteresting call occurs:

- `NiceMock` will not report it.
- `NaggyMock` will print a warning.
- `StrictMock` will fail the test.

### Handling Non-default Constructible Mock Classes

The wrappers inherit your mock class constructors. For classes without default constructors or with complex constructors, you construct wrapped mocks like so:

```cpp
NiceMock<MockBar> nice_bar("hello");
StrictMock<MockBar> strict_bar(1, 2, "arg3", true, false);
```

### AllowLeak Support

You can suppress leak detection on strictness-wrapped mocks using:

```cpp
Mock::AllowLeak(&nice_foo);
Mock::AllowLeak(&strict_foo);
```

### Known Limitations

- Wrappers only support methods declared with `MOCK_METHOD` directly in your mock class - methods from base classes may not behave as expected.
- Wrapping multiple strictness levels is not supported (e.g., `NiceMock<StrictMock<MockFoo>>`).
- Correct strictness behavior requires mocks to have virtual destructors.

---

## Best Practices for Using Strictness Modes

1. **Favor Nice Mocks for Most Tests:**
   - Keeps tests clean and resilient.
   - Avoids noisy outputs from irrelevant mock traffic.

2. **Use Naggy Mocks When Debugging or Developing:**
   - Provides visibility on unexpected mock method calls.
   - Helps catch unintended interactions early.

3. **Reserve Strict Mocks for Critical Paths:**
   - Use sparingly where you want to impose a tight contract.
   - Ideal for tests that verify protocol adherence rigorously.

4. **Set Catch-All Expectations to Prevent Unexpected Calls:**
   - Avoid uninteresting call warnings or failures by adding default expectations:

   ```cpp
   EXPECT_CALL(mock, Method(_)).Times(AnyNumber());
   ```

5. **Be Mindful of Expectation Ordering and Stickiness:**
   - Remember expectations are "sticky"; use `.RetiresOnSaturation()` or sequences for ordered calls.

6. **Test Your Wrapper Choice by Running with Different Strictness:**
   - Try toggling between strictness wrappers to find the balance between test stability and coverage.

---

## Troubleshooting Common Issues

### Uninteresting Call Warnings or Failures

If your test outputs warnings or failures about uninteresting calls:

- Evaluate if you truly care about those calls.
- Use `NiceMock` to hide harmless calls.
- Add explicit `EXPECT_CALL(...).Times(AnyNumber())` for expected but unimportant calls.
- Switch to `StrictMock` only if you want to catch direct violations.

### Unexpected Behavior With Base Class Methods

Strictness wrappers may not affect mock methods defined in base classes due to C++ limitations. Define mocks using `MOCK_METHOD` directly in your mock classes for consistent behavior.

### Destructor Virtuality

Ensure your mock classes have virtual destructors to avoid undefined behavior with wrappers.

### Non-default Constructor Compatibility

Use the wrapper constructors mirroring your mock class constructors for mocks requiring parameters.

---

## Summary

GoogleMock’s `NiceMock`, `NaggyMock`, and `StrictMock` provide flexible control over how tests react to uninteresting mock method calls. Choosing the right wrapper helps balance test noise, strictness, and maintainability. Integrate these wrappers transparently with your existing mocks, setting expectations as usual while gaining better control over mock behavior noise.

---

## References and Related Documentation

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) - introductory guide to GoogleMock concepts
- [gmock_cook_book.md#NiceStrictNaggy](../guides/mocking-techniques/gmock_cook_book.md#NiceStrictNaggy) - detailed recipes using the strictness wrappers
- [`NiceMock`, `NaggyMock`, and `StrictMock` Declarations](https://github.com/google/googletest/blob/main/googlemock/include/gmock/gmock-nice-strict.h) - internal implementation
- [Mocking Reference](../reference/mocking.md#NiceMock) - detailed usage of wrappers within mocking context
- [Mocking Patterns and Best Practices](../guides/mocking-techniques/mocking-patterns-and-best-practices.mdx) - strategies for effective use of mock strictness modes

---

For more foundational knowledge, see [Introduction to Mocking](../guides/mocking-techniques/introduction-to-mocking.mdx) and the general [Mocking Reference](../reference/mocking.md). When implementing or migrating tests, review behavior differences and choose strictness wrappers to optimize test reliability and clarity.

<Source url="https://github.com/google/googletest" paths='[{"path":"googlemock/include/gmock/gmock-nice-strict.h","range":"1-207"},{"path":"googlemock/test/gmock-nice-strict_test.cc","range":"40-215"}]' />