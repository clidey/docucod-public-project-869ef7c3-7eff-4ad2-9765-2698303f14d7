---
title: "Test Output and Configuration"
description: "Describes APIs for configuring test execution, output formatting, event listeners, and result reporting. Outlines environment setup, test shuffling, and other test-runner options provided through the API."
---

# Test Output and Configuration

GoogleTest offers a rich API to configure how tests are executed, how output is generated and formatted, and how test results are reported. This page serves as your comprehensive guide to leveraging these options to tailor test runs to your needs, ensuring clear, structured, and actionable test outcomes.

---

## Overview

When working with GoogleTest, you will want control over various aspects of running tests and obtaining results:

- Configure which tests run and in what order.
- Manage output format and destination, including XML reports.
- Set up event listeners to hook into test lifecycle events.
- Control test execution modes such as randomization, repetition, and sharding.
- Log additional test metadata and environment details.

GoogleTest exposes all of this configurability via a set of flags and an extensible listener API described here.

---

## Test Execution Configuration

GoogleTest allows fine-grained control over the test execution lifecycle using command-line flags or programmatic configuration before `RUN_ALL_TESTS()`.

### Key Flags Affecting Test Execution

| Flag                         | Description                                                                                  |
|------------------------------|----------------------------------------------------------------------------------------------|
| `--gtest_filter`              | Selects which tests to run by name using glob-like patterns.                                 |
| `--gtest_repeat`              | Specifies how many times to repeat the tests. Use `-1` for infinite repetition.             |
| `--gtest_shuffle`             | Randomizes the order tests are run in.                                                      |
| `--gtest_random_seed`         | Sets the seed for test randomization, ensuring reproducible runs.                           |
| `--gtest_fail_fast`           | Stops test execution on the first test failure.                                             |
| `--gtest_also_run_disabled_tests` | Runs tests marked as disabled in addition to regular tests.                              |

### Configuring Test Execution Programmatically

Before calling `RUN_ALL_TESTS()`, you can set flags in code:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);

  // Example: run disabled tests as well
  ::testing::GTEST_FLAG(also_run_disabled_tests) = true;

  // Example: repeat tests 3 times
  ::testing::GTEST_FLAG(repeat) = 3;

  // Seed the randomization to a fixed value
  ::testing::GTEST_FLAG(random_seed) = 12345;

  // Enable test shuffling
  ::testing::GTEST_FLAG(shuffle) = true;

  return RUN_ALL_TESTS();
}
```

This approach is useful for dynamic test run customization.

### Tips & Best Practices

- Always specify `random_seed` when shuffling for test repeatability.
- Use `fail_fast` for quicker feedback loops during development.
- Leverage `repeat` combined with `shuffle` to catch flaky tests.

---

## Output Configuration

GoogleTest supports multiple output formats to fit different reporting and integration needs.

### Supported Output Formats

| Format | Description                                                  |
|--------|--------------------------------------------------------------|
| `text` | Default human-readable console output.                      |
| `xml`  | XML test report compliant with JUnit-compatible schemas.    |

You specify output formats with the `--gtest_output` flag.

#### Examples

- Write XML to a file `results.xml`:

  ```
  --gtest_output=xml:results.xml
  ```

- Generate XML output in a directory named `test_logs`:

  ```
  --gtest_output=xml:test_logs/
  ```

  The output file name will be generated based on the executable name.

### Output File Path Resolution

- If no path is specified for XML output, the default is `test_detail.xml` in the original working directory.
- Relative paths are resolved relative to the process's initial working directory (the directory from which the test executable was started), not the current working directory at runtime. 

### Programmatic Access to Output Paths

You can query the resolved output file path using `UnitTestOptions::GetAbsolutePathToOutputFile()`:

```cpp
#include "gtest/internal/gtest-internal-inl.h"
#include <iostream>

std::cout << "Test output file: "
          << testing::internal::UnitTestOptions::GetAbsolutePathToOutputFile()
          << std::endl;
```

### Controlling Console Output

Several flags adjust the verbosity and format of console output:

- `--gtest_brief`: Only prints failed tests.
- `--gtest_print_time`: Prints elapsed time for each test.
- `--gtest_color`: Controls colored output (`yes`, `no`, `auto`).
- `--gtest_print_utf8`: Prints UTF-8 characters correctly.

---

## Event Listeners

GoogleTest provides an event listener interface (`TestEventListener`) that you can implement to hook into the test execution lifecycle. This mechanism lets you customize or extend how test events are handled.

### Core Listener Events

Listeners receive notifications such as:

- `OnTestProgramStart` and `OnTestProgramEnd`
- `OnTestIterationStart` and `OnTestIterationEnd`
- `OnEnvironmentsSetUpStart`/`End` and `OnEnvironmentsTearDownStart`/`End`
- `OnTestSuiteStart` and `OnTestSuiteEnd`
- `OnTestStart` and `OnTestEnd`
- `OnTestPartResult` (for assertion results)
- `OnTestDisabled` (when a test is disabled)

### Using the Listener API

To add a custom listener, create a subclass overriding desired methods:

```cpp
class MyListener : public ::testing::EmptyTestEventListener {
  void OnTestStart(const ::testing::TestInfo& test_info) override {
    std::cout << "Starting: " << test_info.test_suite_name() << "." << test_info.name() << std::endl;
  }

  void OnTestEnd(const ::testing::TestInfo& test_info) override {
    std::cout << "Finished: " << test_info.test_suite_name() << "." << test_info.name() << std::endl;
  }
};

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);

  ::testing::UnitTest::GetInstance()->listeners().Append(new MyListener());

  return RUN_ALL_TESTS();
}
```

Removing or replacing the default listeners, such as the console printer or XML generator, allows complete control over reporting.

### Best Practices

- Use `EmptyTestEventListener` as a base to avoid boilerplate.
- Append listeners before running tests to ensure proper notifications.
- Remember GoogleTest takes ownership of listeners and deletes them upon program exit.

---

## Test Environment Configuration

GoogleTest supports global environments that have setup and teardown hooks invoked once per test run or per repeat iteration.

- Create custom environment classes by subclassing `testing::Environment` and overriding `SetUp()` and `TearDown()`.
- Register environments with `AddGlobalTestEnvironment()` before running tests.

Example:

```cpp
class MyEnv : public testing::Environment {
 public:
  void SetUp() override {
    // Initialize shared resources
  }
  void TearDown() override {
    // Cleanup shared resources
  }
};

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  testing::AddGlobalTestEnvironment(new MyEnv);
  return RUN_ALL_TESTS();
}
```

---

## Environment Variables and Test Sharding

GoogleTest supports test sharding, which allows distributing tests across multiple processes or machines.

- Set environment variables `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX` to indicate total shards and this shard's index.
- Tests will automatically be assigned to shards, ensuring mutually exclusive runs.

Use case:

```bash
export GTEST_TOTAL_SHARDS=4
export GTEST_SHARD_INDEX=2
./my_test_binary
```

The binary will only run tests assigned to shard 2.

### Important Considerations

- Sharding is disabled for death tests to maintain correctness.
- Sharded runs will skip tests assigned to other shards.

---

## Logging Properties to Tests

You can add custom key/value properties to tests, test suites, or the entire test run to pass metadata to test reports.

```cpp
  // Log a string property.
  testing::Test::RecordProperty("Priority", "High");

  // Log an integer property.
  testing::Test::RecordProperty("TimeoutSec", 30);
```

Properties logged during individual test runs appear in their XML `<testcase>` elements. Properties logged during test suite setup appear at the `<testsuite>` level. Global properties are attached at the `<testsuites>` element.

**Note:** Keys must be valid XML attribute names and must not clash with reserved GoogleTest names like `name`, `file`, `line`, etc.

---

## Common Pitfalls & Troubleshooting

- **Output File Location Confusion:** Output paths are resolved relative to the original working directory — not the current directory if changed.
- **Forgetting to Call `InitGoogleTest`:** Flags must be initialized to apply configurations.
- **Multiple Calls to `RUN_ALL_TESTS()`:** GoogleTest expects a single call per program execution.
- **Randomization Not Reproducible:** Always specify a seed with shuffle to reproduce test orders.
- **Ownership of Listeners:** Removing a default listener transfers ownership to the user; you must manage lifetime.

---

## Summary

GoogleTest's Test Output and Configuration API empowers you to precisely control test runs, output formats, and event handling. Combined with test environment customization and sharding support, this enables integration into diverse CI systems and complex build pipelines.

For a smooth experience, configure your runs with deliberate flag settings, extend functionality via listeners, and log meaningful properties to enrich your reports.

---

## See Also

- [GoogleTest Primer](reference/primer.md)
- [Testing Reference](docs/reference/testing.md) — for macros and API details
- [Test Infrastructure](api-reference/core-testing-apis/test-infrastructure.md)
- [Assertions and Failure Handling](api-reference/core-testing-apis/assertions-and-failure-handling.md)
- [Test Discovery and Execution](guides/getting-started-testing/test-discovery-execution.md)
- [Integration and Build Systems](guides/integration-and-patterns/build-system-integration.md)

---