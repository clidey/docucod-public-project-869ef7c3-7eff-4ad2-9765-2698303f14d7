---
title: "Assertions Reference"
description: "Detailed overview of built-in assertions for equality, inequality, truthiness, floating-point comparisons, exception checks, and death tests. Explains assertion macro categories (fatal vs non-fatal), assertion result handling, and sample usage patterns."
---

# Assertions Reference

This page offers a detailed overview of GoogleTest's built-in assertion macros. These assertions cover a wide range of common testing needsâ€”including verifying equality and inequality, checking truthiness, handling floating-point comparisons carefully, confirming exception behavior, and supporting death tests for validating program termination. It clarifies the fundamental distinction between fatal and non-fatal assertions and illustrates usage patterns with practical examples.

---

## Assertion Macro Categories: Fatal vs Non-Fatal

GoogleTest assertions come in pairs differentiated by their severity:

- **`ASSERT_*` Macros**: Generate *fatal failures*. When such an assertion fails, it immediately aborts the current function. This behavior is essential when continuing the test after the failure would cause undefined behavior or nonsensical results.
- **`EXPECT_*` Macros**: Generate *non-fatal failures*. These do not abort the current function, allowing the test to continue and report multiple errors in one run.

### When to Use Which?
Use `EXPECT_*` when the test can still proceed meaningfully after a failure, thus revealing additional failures in a single run. Use `ASSERT_*` when it is unsafe or pointless to continue after a failure. For example, use `ASSERT_*` when a prerequisite condition must be true for further checks.

> Streaming user-defined failure messages using the `<<` operator is supported in all assertion macros. This helps provide context for failures.


## Assertion Result Handling

An assertion evaluates an expression and produces one of several outcomes:

- **Success**: The assertion condition is met.
- **Non-fatal failure**: The assertion condition failed, but the test continues.
- **Fatal failure**: The assertion condition failed, and the current function aborts.
- **Skipped**: The assertion indicates the test was skipped (rare and used with `GTEST_SKIP()`).

GoogleTest internally represents an assertion result as a `TestPartResult` object which stores the type of failure (or success), source file, line number, and an associated message. Users interact with these via macros, not directly.

---

## Built-in Assertion Macro Types

### 1. Explicit Success and Failure

- `SUCCEED()`: Generates a success. Use it for documenting success points; doesn't cause the test to pass meaningfully by itself.

- `FAIL()`: Generates a fatal failure that aborts the current function immediately.

- `ADD_FAILURE()`: Generates a non-fatal failure allowing test continuation.

- `ADD_FAILURE_AT(file, line)`: Generates a non-fatal failure reporting the specified file and line.

#### Example
```cpp
switch(value) {
  case 1:
    ...
  case 2:
    ...
  default:
    FAIL() << "Should never get here.";
}
```

### 2. Boolean Assertions

Check plain boolean conditions.

- `EXPECT_TRUE(condition)`, `ASSERT_TRUE(condition)`: Check that condition is true.
- `EXPECT_FALSE(condition)`, `ASSERT_FALSE(condition)`: Check that condition is false.

#### Example
```cpp
EXPECT_TRUE(x > 0) << "x is not positive";
ASSERT_FALSE(IsValid(user)) << "User should not be valid yet";
```

### 3. Binary Comparison Assertions

Compare two values with standard operators.

- `EXPECT_EQ(val1, val2)`, `ASSERT_EQ(val1, val2)`: Checks `val1 == val2`.
- `EXPECT_NE(val1, val2)`, `ASSERT_NE(val1, val2)`: Checks `val1 != val2`.
- `EXPECT_LT(val1, val2)`, `ASSERT_LT(val1, val2)`: Checks `val1 < val2`.
- `EXPECT_LE(val1, val2)`, `ASSERT_LE(val1, val2)`: Checks `val1 <= val2`.
- `EXPECT_GT(val1, val2)`, `ASSERT_GT(val1, val2)`: Checks `val1 > val2`.
- `EXPECT_GE(val1, val2)`, `ASSERT_GE(val1, val2)`: Checks `val1 >= val2`.

**Note**: Pointer comparisons check pointer equality, not content equality. Use string-specific assertions for C strings.

#### Example
```cpp
EXPECT_EQ(Foo(), 42);
ASSERT_LT(value, max) << "Value too large";
```

### 4. String Comparison Assertions

Compare null-terminated C strings by content, including case-insensitive variants.

- `EXPECT_STREQ(str1, str2)`, `ASSERT_STREQ(str1, str2)`: Equal content.
- `EXPECT_STRNE(str1, str2)`, `ASSERT_STRNE(str1, str2)`: Non-equal content.
- `EXPECT_STRCASEEQ(str1, str2)`, `ASSERT_STRCASEEQ(str1, str2)`: Equal ignoring case.
- `EXPECT_STRCASENE(str1, str2)`, `ASSERT_STRCASENE(str1, str2)`: Non-equal ignoring case.

Wide string counterparts (`wchar_t*`) are also supported equivalently.

#### Example
```cpp
EXPECT_STREQ(c_str1, c_str2);
ASSERT_STRCASEEQ(name1, name2) << "Names differ ignoring case";
```

### 5. Floating-Point Comparison Assertions

Because of rounding errors, floating-point numbers require special care.

- `EXPECT_FLOAT_EQ(val1, val2)`, `ASSERT_FLOAT_EQ(val1, val2)`: Checks `float` values approximately equal within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)`, `ASSERT_DOUBLE_EQ(val1, val2)`: Same for `double`.
- `EXPECT_NEAR(val1, val2, abs_error)`, `ASSERT_NEAR(val1, val2, abs_error)`: Checks difference is within absolute error bound.

#### Example
```cpp
EXPECT_FLOAT_EQ(result, 3.14f) << "Result differs";
ASSERT_NEAR(computed, expected, 1e-5);
```

### 6. Exception Assertions

Require exceptions support enabled.

- `EXPECT_THROW(statement, exception_type)`, `ASSERT_THROW(...)`: Checks `statement` throws `exception_type`.
- `EXPECT_ANY_THROW(statement)`, `ASSERT_ANY_THROW(...)`: Checks `statement` throws any exception.
- `EXPECT_NO_THROW(statement)`, `ASSERT_NO_THROW(...)`: Checks `statement` does not throw any exception.

#### Example
```cpp
EXPECT_THROW(DoSomething(), std::runtime_error);
ASSERT_NO_THROW(Foo());
```

### 7. Predicate Assertions

Allow more expressive checks with predicate functions or predicate-formatters, reporting detailed failure messages with the argument's values.

- `EXPECT_PREDn(pred, val1, val2, ...)`, `ASSERT_PREDn(...)`: Use predicate functions returning bool.
- `EXPECT_PRED_FORMATn(pred_fmt, val1, ...)`, `ASSERT_PRED_FORMATn(...)`: Use predicate-formatters returning `AssertionResult` for detailed messages.

Useful when existing macros aren't expressive enough or when you want clearer failure diagnostics.

#### Example
```cpp
bool IsPrime(int n) { ... }

EXPECT_PRED1(IsPrime, value);

// Using predicate formatter:
testing::AssertionResult IsEven(int n) { ... }
EXPECT_PRED_FORMAT1(IsEven, value);
```

### 8. Windows HRESULT Assertions (Windows only)

Check success or failure of COM HRESULT return values.

- `EXPECT_HRESULT_SUCCEEDED(expr)`, `ASSERT_HRESULT_SUCCEEDED(expr)`: Checks `expr` is a success HRESULT.
- `EXPECT_HRESULT_FAILED(expr)`, `ASSERT_HRESULT_FAILED(expr)`: Checks `expr` is a failure HRESULT.

---

## Death Assertions

Death assertions verify that a piece of code causes the program to terminate or crash as expected. They are essential for testing precondition checks or fatal error conditions.

- `EXPECT_DEATH(statement, matcher)`, `ASSERT_DEATH(...)`
- `EXPECT_DEATH_IF_SUPPORTED(...)`, etc.

`statement` can be a compound statement (using braces `{ ... }`). `matcher` checks the expected stderr output, which can be a regular expression or a matcher.

Special variants include `EXPECT_DEBUG_DEATH` (only in debug mode) and `EXPECT_EXIT` which enables checking the exit status using predicates.

#### Example
```cpp
ASSERT_DEATH({ Foo(42); }, "Error on line .* of Foo");
EXPECT_EXIT(ExitStatusFunc(), testing::ExitedWithCode(0), "Success");
```

**Note:** Death tests spawn child processes, so side-effects inside death tests do not affect the parent test process.

---

## Usage Patterns and Tips

- **Use non-fatal assertions (`EXPECT_*`) to collect multiple failures** in a single test run when it is safe to continue.
- **Use fatal assertions (`ASSERT_*`) to protect unsafe operations** or where continuing doesn't make sense.
- **Stream custom messages** to assertions using `<<` to provide context on failures.
- **Use string-specific macros** (`EXPECT_STREQ`, etc.) for comparing C strings to compare their values rather than pointer addresses.
- **Use floating-point comparison macros** to avoid brittle tests due to rounding errors.
- **Verify exceptions with exception assertions** only when exceptions are enabled in your build.
- For complex predicates, prefer predicate assertions for better diagnostics.
- Follow naming conventions and avoid underscores in test and test suite names for compatibility.

---

## Common Pitfalls

- Using `ASSERT_*` in constructors or destructors is disallowed; use `SetUp()` and `TearDown()` instead.
- Beware that `ASSERT_*` aborts the current function, not the entire test.
- Floating-point comparisons using `EXPECT_EQ` are unreliable; use `EXPECT_FLOAT_EQ` or `EXPECT_DOUBLE_EQ` instead.
- Death tests require careful setup; ensure the death test suite is named with the `DeathTest` suffix.
- Streaming wide strings will be converted to UTF-8 for output.

---

## Code Examples

### Equality Assertion with Custom Message
```cpp
ASSERT_EQ(x.size(), y.size()) << "Vectors x and y differ in length";
for (int i = 0; i < x.size(); ++i) {
  EXPECT_EQ(x[i], y[i]) << "Mismatch at index " << i;
}
```

### Using Predicate Assertion
```cpp
bool IsPositive(int n) { return n > 0; }

EXPECT_PRED1(IsPositive, value);
```

### Death Test Example
```cpp
TEST(MyDeathTest, CrashOnError) {
  ASSERT_DEATH({ DoSomethingDangerous(); }, "Fatal error");
}
```

### Handling Floating-point Comparisons
```cpp
EXPECT_FLOAT_EQ(result, 3.14159f) << "Pi approximation failed";
ASSERT_NEAR(computed_value, expected_value, 1e-5);
```

---

## References and Links

- Assertions Reference (this page): Detailed list and description of all assertion macros.
- [GoogleTest Primer](primer.md): Introduction to GoogleTest with basics about assertions and test writing.
- [Advanced GoogleTest Topics](advanced.md): Techniques for predicate assertions, death tests, and logging.
- [Testing Reference](testing.md): Overview of test macros including `TEST`, `TEST_F`, and `TEST_P`.
- [Death Tests Guide](guides/common-workflows/death-tests): Detailed instructions and best practices for death tests.

---

This page focuses strictly on available assertion macros and their behavior. For guidance on writing tests, fixtures, and advanced usage, consult the corresponding guides.

---

<Info>
GoogleTest assertions are foundational for verifying your code's correctness. Choosing between fatal and non-fatal assertions strategically enables effective failure handling and rich diagnostics.
</Info>

<AccordionGroup title="Assertion Macro Categories">
<Accordion title="Fatal Assertions (ASSERT_*)">
Use when failure prevents meaningful continuation of the current function. Aborts the current function immediately upon failure.
</Accordion>
<Accordion title="Non-fatal Assertions (EXPECT_*)">
Use when tests can continue after failure to uncover multiple issues. Reports failure but runs remaining code in the test function.
</Accordion>
</AccordionGroup>

<AccordionGroup title="Common Assertion Macros with Examples">
<Accordion title="EXPECT_EQ / ASSERT_EQ">
Checks that two values are equal (`==`). Use for comparing scalars, objects with `operator==`, but beware pointer comparisons are by address.

```cpp
EXPECT_EQ(Foo(), 42);
ASSERT_EQ(expected.size(), actual.size()) << "Size mismatch";
```
</Accordion>
<Accordion title="EXPECT_STREQ / ASSERT_STREQ">
Checks that two C strings are equal in content.

```cpp
EXPECT_STREQ("hello", my_c_string);
ASSERT_STREQ(expected_string, actual_string);
```
</Accordion>
<Accordion title="EXPECT_FLOAT_EQ / ASSERT_FLOAT_EQ">
Checks two float values are approximately equal within a small epsilon (4 ULPs).

```cpp
EXPECT_FLOAT_EQ(computed_pi, 3.14159f);
```
</Accordion>
<Accordion title="EXPECT_THROW / ASSERT_THROW">
Checks that executing a statement throws a specific exception type.

```cpp
EXPECT_THROW(Foo(), std::runtime_error);
```
</Accordion>
<Accordion title="EXPECT_DEATH / ASSERT_DEATH">
Verifies that code causes the process to terminate with expected output.

```cpp
ASSERT_DEATH({ CrashFunction(); }, "Fatal error");
```
</Accordion>
</AccordionGroup>