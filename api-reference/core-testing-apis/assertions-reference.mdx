---
title: "Assertions Reference"
description: "Concise overview and explanation of all core assertion macros (e.g., EXPECT_EQ, ASSERT_TRUE), their behaviors (fatal vs. non-fatal failures), and when to use each. Provides usage examples and maps assertions to test outcomes."
---

# Assertions Reference

This documentation page provides a comprehensive guide to the core assertion macros provided by GoogleTest. Assertions are the fundamental building blocks to verify code behavior in tests. This page explains the differences between `EXPECT_` and `ASSERT_` macros, clarifies their usage patterns including failure severity, and offers detailed descriptions and examples for each assertion type.

> To use these assertions, include `#include <gtest/gtest.h>` in your test source files.

---

## Understanding Assertion Failures: Fatal vs Non-fatal

GoogleTest assertions come in two flavors:

- **`EXPECT_` assertions:** Generate *non-fatal* failures; the test continues running after a failure.
- **`ASSERT_` assertions:** Generate *fatal* failures; the current function exits immediately on failure.

Use `EXPECT_` if you want your test to continue checking additional conditions, enabling multiple failures to be detected in one run. Use `ASSERT_` when it does not make sense to continue testing after a failure (for example, if further checking would lead to crashes or meaningless results).

Every assertion macro supports streaming a custom failure message with the `<<` operator, enabling more insightful failure diagnostics.

Example:

```cpp
EXPECT_TRUE(my_condition) << "my_condition is false: " << some_value;
```

---

## Explicit Success and Failure Assertions

Sometimes you want to explicitly indicate success or failure in a test, typically when control flow rather than a Boolean condition determines the test outcome.

### SUCCEED()

- Generates a test success.
- This does **not** make the overall test pass unless no other assertions fail.
- Currently produces no visible output but serves as documentation.

```cpp
SUCCEED();
```

### FAIL()

- Generates a fatal failure that aborts the current function.
- Only usable in `void`-returning functions.

```cpp
FAIL() << "Reached unexpected code path";
```

### ADD_FAILURE()

- Generates a nonfatal failure, allowing the test to continue.

```cpp
ADD_FAILURE() << "Something went wrong";
```

### ADD_FAILURE_AT(file, line)

- Generates a nonfatal failure at a specific file and line number.

```cpp
ADD_FAILURE_AT("foo.cc", 123) << "Failure at specific location";
```

---

## Assertions Using Matchers

GoogleTest supports flexible assertions using [matchers](matchers.md) for validating values.

### EXPECT_THAT(value, matcher) / ASSERT_THAT(value, matcher)

- Assert that a value satisfies a matcher predicate.
- Supports expressive matchers like `StartsWith()`, `MatchesRegex()`, `AllOf()`, etc.

Example:

```cpp
EXPECT_THAT(str, StartsWith("Hello"));
ASSERT_THAT(num, AllOf(Gt(5), Lt(10)));
```

Failure message example on mismatch:

```
Value of: str
  Actual: "Hi there!"
Expected: starts with "Hello"
```

---

## Boolean Condition Assertions

Verify basic Boolean conditions.

### EXPECT_TRUE(condition) / ASSERT_TRUE(condition)

Verifies `condition` is `true`.

```cpp
EXPECT_TRUE(is_ready) << "System should be ready";
```

### EXPECT_FALSE(condition) / ASSERT_FALSE(condition)

Verifies `condition` is `false`.

```cpp
ASSERT_FALSE(has_error) << "Unexpected error state";
```

---

## Binary Comparison Assertions

Compare two values with standard comparison operators.

- Each of these comes in `EXPECT_` and `ASSERT_` variants.
- Arguments are evaluated exactly once.
- Works with built-in types, classes with overloaded operators, `std::string`, etc.

### Equality and Inequality

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` -- Verifies `val1 == val2`.
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` -- Verifies `val1 != val2`.

> Important: For pointers, equality is pointer equality.
> To compare C strings by content, use string comparison assertions instead.

### Ordering Operators

- `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)` -- Verifies `val1 < val2`.
- `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)` -- Verifies `val1 <= val2`.
- `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)` -- Verifies `val1 > val2`.
- `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)` -- Verifies `val1 >= val2`.

Example:

```cpp
EXPECT_EQ(result.size(), expected_size) << "Unexpected vector size";
ASSERT_LT(value, max_value) << "Value exceeds maximum";
```

---

## C String Comparison Assertions

Specialized assertions to compare C-style strings by contents rather than pointer identity. Accepts narrow and wide strings.

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` -- Verifies strings are equal.
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)` -- Verifies strings differ.
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)` -- Case-insensitive equality.
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)` -- Case-insensitive inequality.

Example:

```cpp
EXPECT_STREQ(cstr1, cstr2) << "Strings differ";
ASSERT_STRCASEEQ(wide_str1, wide_str2) << "Wide strings differ (case ignored)";
```

Use `nullptr` comparisons as `EXPECT_EQ(ptr, nullptr)` or `EXPECT_NE(ptr, nullptr)`.

---

## Floating-Point Comparison Assertions

Due to inherent rounding errors, direct equality comparison for floating-point numbers is not reliable. GoogleTest provides specialized assertions that consider precision and tolerance.

### EXPECT_FLOAT_EQ(val1, val2) / ASSERT_FLOAT_EQ(val1, val2)

- Verifies two `float` values are approximately equal within 4 Units in the Last Place (ULPs).

### EXPECT_DOUBLE_EQ(val1, val2) / ASSERT_DOUBLE_EQ(val1, val2)

- Verifies two `double` values are approximately equal within 4 ULPs.

### EXPECT_NEAR(val1, val2, abs_error) / ASSERT_NEAR(val1, val2, abs_error)

- Verifies that the absolute difference between `val1` and `val2` does not exceed `abs_error`.

Example:

```cpp
EXPECT_FLOAT_EQ(computed_float, expected_float);
ASSERT_NEAR(computed_double, expected_double, 1e-5);
```

---

## Exception Assertions

Use these assertions if your build environment supports exceptions to verify the throwing or non-throwing of exceptions.

### EXPECT_THROW(statement, exception_type) / ASSERT_THROW(statement, exception_type)

Asserts that `statement` throws an exception of type `exception_type`.

### EXPECT_ANY_THROW(statement) / ASSERT_ANY_THROW(statement)

Asserts that `statement` throws any type of exception.

### EXPECT_NO_THROW(statement) / ASSERT_NO_THROW(statement)

Asserts that `statement` does not throw any exception.

Use these assertions with compound statements when necessary:

```cpp
EXPECT_NO_THROW({
  int x = 5;
  doSomething(x);
});
```

---

## Predicate Assertions for Complex Conditions

When simple Boolean conditions are not enough or debugging failure is difficult, predicate assertions offer expressive and informative ways to check arbitrary predicates.

### EXPECT_PRED* and ASSERT_PRED*

- `EXPECT_PRED1(pred, val1)`, `EXPECT_PRED2(pred, val1, val2)`, ... up to 5 arguments.
- Verifies that predicate `pred` returns `true` when passed the given arguments.

Example:

```cpp
bool MutuallyPrime(int a, int b) { /* returns true if a and b have no common divisor except 1 */ }
EXPECT_PRED2(MutuallyPrime, 3, 4);  // succeeds
EXPECT_PRED2(MutuallyPrime, 4, 10); // fails
```

Failure message example:

```
MutuallyPrime(4, 10) is false, where
 4 is 4
 10 is 10
```

If the predicate is overloaded or templated, explicit casting can help disambiguate.

### EXPECT_PRED_FORMAT* and ASSERT_PRED_FORMAT*

- Use *predicate-formatters* that return a `testing::AssertionResult` with custom failure messages.
- More flexible and produce clearer failure diagnostics than `EXPECT_PRED*` alone.

Example predicate-formatter:

```cpp
testing::AssertionResult AssertMutuallyPrime(
    const char* expr1, const char* expr2, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr1 << " and " << expr2
      << " are not mutually prime: " << m << " and " << n;
}
```

Example usage:

```cpp
EXPECT_PRED_FORMAT2(AssertMutuallyPrime, 4, 10);
```

Failure message:

```
4 and 10 are not mutually prime: 4 and 10
```

---

## Windows HRESULT Assertions

On Windows, you can verify success or failure HRESULT values.

### EXPECT_HRESULT_SUCCEEDED(expression) / ASSERT_HRESULT_SUCCEEDED(expression)

- Verifies that `expression` returns a success HRESULT.

### EXPECT_HRESULT_FAILED(expression) / ASSERT_HRESULT_FAILED(expression)

- Verifies that `expression` returns a failure HRESULT.

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

---

## Death Assertions

Verify that a statement causes the process to terminate with a specific exit status and/or output.

These spawn a child process and execute the statement in it, allowing tests of abnormal termination.

### EXPECT_DEATH(statement, matcher) / ASSERT_DEATH(statement, matcher)

- Verifies the process terminated with a nonzero exit code and `stderr` output matching `matcher`.
- `matcher` can be a matcher or a regex string (substring matching).

### EXPECT_DEATH_IF_SUPPORTED(statement, matcher) / ASSERT_DEATH_IF_SUPPORTED(statement, matcher)

- Runs like `EXPECT_DEATH` if death tests are supported; otherwise, does nothing.

### EXPECT_DEBUG_DEATH(statement, matcher) / ASSERT_DEBUG_DEATH(statement, matcher)

- In debug mode, functions like `EXPECT_DEATH`.
- In release mode, just runs the statement normally.

### EXPECT_EXIT(statement, predicate, matcher) / ASSERT_EXIT(statement, predicate, matcher)

- Verifies process exit status satisfies `predicate` (e.g. exit code or signal) and `stderr` output matches `matcher`.

Example:

```cpp
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

---

## Usage Tips & Best Practices

- Use `EXPECT_` macros to keep tests running after a failure, allowing comprehensive diagnostics.
- Use `ASSERT_` macros when it is unsafe or meaningless to continue after failure.
- Always provide custom failure messages where helpful.
- Prefer specialized assertions over generic `EXPECT_TRUE` to get clearer failure output.
- In complex checks, consider predicate or predicate-format assertions to improve clarity.
- For death tests, remember the statement runs in a separate process; side effects are not observable in the parent.
- When comparing floating-point values, use the specialized floating-point assertions to avoid false failures due to rounding.

---

For further information, see the related documentation:

- [GoogleTest Primer - Assertions](../primer.md#assertions)
- [GoogleTest Advanced Topics - More Assertions](../advanced.md#more-assertions)
- [Matchers Reference](matchers.md) for powerful value matching
- [Death Tests](../advanced.md#death-tests)

---

## Summary Table of Assertion Macros

| Category                 | Macro Examples                                 | Failure Type         | Verifies                                                 |
|--------------------------|-----------------------------------------------|----------------------|----------------------------------------------------------|
| Explicit Success & Failure | `SUCCEED()`, `FAIL()`, `ADD_FAILURE()`       | Success / Fatal / Nonfatal | Immediate test success/failure                             |
| Boolean Conditions        | `EXPECT_TRUE()`, `ASSERT_FALSE()`             | Nonfatal / Fatal     | Boolean expression truthiness                              |
| Binary Comparisons        | `EXPECT_EQ()`, `ASSERT_LT()`                   | Nonfatal / Fatal     | Equality / Ordering between two values                     |
| String Comparisons        | `EXPECT_STREQ()`, `ASSERT_STRCASEEQ()`        | Nonfatal / Fatal     | C string equality (with or without case sensitivity)      |
| Floating-Point Comparisons | `EXPECT_FLOAT_EQ()`, `ASSERT_NEAR()`          | Nonfatal / Fatal     | Floating-point approximate equality                        |
| Exception Assertions      | `EXPECT_THROW()`, `ASSERT_NO_THROW()`          | Nonfatal / Fatal     | Exception throwing behavior                                |
| Predicate Assertions      | `EXPECT_PRED2()`, `ASSERT_PRED_FORMAT3()`     | Nonfatal / Fatal     | Arbitrary predicates with detailed failure messages       |
| HRESULT Assertions (Windows) | `EXPECT_HRESULT_SUCCEEDED()`                 | Nonfatal / Fatal     | Windows HRESULT success/failure                            |
| Death Assertions          | `EXPECT_DEATH()`, `ASSERT_EXIT()`              | Nonfatal / Fatal     | Process termination and stderr output                      |

---

For reference and examples, see the [`docs/reference/assertions.md`](https://github.com/google/googletest/blob/main/docs/reference/assertions.md) in GoogleTest source.
