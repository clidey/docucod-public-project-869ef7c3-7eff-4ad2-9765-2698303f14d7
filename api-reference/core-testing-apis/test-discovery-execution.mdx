---
title: "Test Discovery and Execution"
description: "Reference on how GoogleTest discovers, registers, and executes tests. Includes API documentation for main entry points, test macros, test case organization, and options for running specific or parameterized tests. Contains runnable code snippets and best practices for large and small projects."
---

# Test Discovery and Execution

Comprehensive reference on how GoogleTest discovers, registers, and executes tests within your C++ projects. This documentation provides detailed API insights into the main entry points, test macros, organization of test cases and suites, and options for running selective or parameterized tests. It includes runnable code examples and best practices tailored for managing both large and small test projects effectively.

---

## Overview

GoogleTest automates test discovery and management, allowing you to focus on writing your tests rather than registering and running them manually. This page explains how tests and test suites are registered, how they can be organized, and the mechanisms to run tests selectively or with parameters.

## Key Concepts

- **Test Registration**: GoogleTest automatically registers tests created with the provided macros.
- **Test Suites**: Group related tests for better structure and optional shared setup.
- **Parameterized Tests**: Run a single test logic over multiple inputs or types.
- **Test Execution**: Control which tests to run through filtering and command-line options.

---

## Test Macros and Registration

GoogleTest provides several macros to define and register tests. Each macro serves a specific purpose in test discovery and execution.

### Simple Tests: `TEST()` Macro

Defines a test belonging to a test suite with no fixture.

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}
```

- `FactorialTest` is the test suite name.
- `HandlesZeroInput` is the test name.
- Automatically registered by GoogleTest.

### Test Fixtures: `TEST_F()` Macro

Defines tests that share a common fixture class.

```cpp
class QueueTest : public ::testing::Test {
protected:
  void SetUp() override { /* common setup */ }
  Queue<int> q;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q.size(), 0);
}
```

- `QueueTest` is the fixture class.
- `IsEmptyInitially` is the test name.
- Fixture setup/teardown run before/after each test.

### Parameterized and Typed Tests

GoogleTest supports running the same test logic with multiple parameters or types.

- **Value-Parameterized Tests:** Implemented with `TEST_P()` and instantiated with `INSTANTIATE_TEST_SUITE_P()`.

  ```cpp
  class MyTest : public ::testing::TestWithParam<int> {};

  TEST_P(MyTest, HandlesValues) {
    int value = GetParam();
    EXPECT_GT(value, 0);
  }

  INSTANTIATE_TEST_SUITE_P(MyGroup, MyTest, ::testing::Values(1, 2, 3));
  ```

- **Typed Tests:** Allow testing across multiple types.

---

## Test Suite Organization

- Related tests should be grouped into test suites for logical clarity.
- Test fixtures enable reuse of setup and teardown logic.
- Test names must be unique within a test suite.
- Test suites correspond to test case groups internally.

---

## Running Tests

### Running All Tests

Use `RUN_ALL_TESTS()` in your `main()` function after initializing GoogleTest.

```cpp
int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This runs every registered test.

### Filtering Tests

GoogleTest supports filtering which tests to run using the `--gtest_filter` flag.

- Syntax: `--gtest_filter=<positive_patterns>[-<negative_patterns>]`
- Wildcards `*` are supported.

Example - Run only tests in `QueueTest`:

```sh
test_binary --gtest_filter=QueueTest.*
```

Run all but a specific test:

```sh
test_binary --gtest_filter=-QueueTest.IsEmptyInitially
```

### Running Disabled Tests

Tests prefixed with `DISABLED_` are skipped by default.
Run them explicitly with:

```sh
test_binary --gtest_also_run_disabled_tests
```

### Selecting Individual Tests

You can combine filters to run a precise selection of tests.

---

## Test Discovery Workflow

1. GoogleTest scans linked test object files for test registrations.
2. Registered tests are stored in an internal factory.
3. When `RUN_ALL_TESTS()` is invoked, GoogleTest enumerates tests to run.
4. Tests are run in order or filtered as specified.
5. Results and failures are reported.

---

## API Reference

### Functions

| Function                     | Description                                  |
|------------------------------|----------------------------------------------|
| `testing::InitGoogleTest()`  | Initializes the framework and parses flags. |
| `RUN_ALL_TESTS()`            | Runs all registered tests.                    |

### Macros

| Macro       | Purpose                             |
|-------------|----------------------------------|
| `TEST(suite, name)` | Registers a simple test.          |
| `TEST_F(fixture, name)` | Registers a test with a fixture. |
| `TEST_P(fixture, name)` | Defines a parameterized test.    |
| `INSTANTIATE_TEST_SUITE_P()` | Instantiates parameterized tests. |

---

## Best Practices

- Group related tests into test suites to keep the project organized.
- Use test fixtures for shared common setup.
- Use parameterized tests to avoid duplication.
- Use filtering for selective and speedy test execution.
- Name tests clearly and consistently for easy identification.

---

## Troubleshooting

- If tests are not running, confirm they are defined with supported `TEST` macros.
- Use `--gtest_list_tests` to see all registered tests.
- Misnamed tests or missing macros prevent registration and execution.
- Watch out for name collisions between test suites or test names.

---

## Example: Writing and Running Basic Tests

```cpp
#include <gtest/gtest.h>

int Factorial(int n) {
  return n <= 1 ? 1 : n * Factorial(n - 1);
}

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(3), 6);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Run with:

```
./factorial_test
```

To run just the positive input test:

```
./factorial_test --gtest_filter=FactorialTest.HandlesPositiveInput
```

---

## Diagram: Test Discovery & Execution Flow

```mermaid
flowchart TD
  Start([Program Start]) --> Init[InitGoogleTest()] --> Register[Test Registration]
  Register --> Store[Store tests in registry]
  Store --> RUN[RUN_ALL_TESTS()]
  RUN --> Select[Apply filter / Select tests]
  Select -->|Tests to run| Execute[Execute tests sequentially]
  Execute --> Report[Test results output]
  Report --> End([Program End])
```

---

For more detailed guides, explore:

- [Getting Started: Writing Your First Test](../guides/getting-started/writing-your-first-test.md)
- [Parameterized and Typed Tests](../guides/essential-workflows/parameterized-and-typed-tests.md)
- [Test Discovery and Execution Guide](../guides/essential-workflows/test-discovery-execution.md)

The Test Discovery and Execution features provide powerful means to efficiently manage your test suite as it growsâ€”you'll save time and maintain clarity.

---

## Related Resources

- [Test Assertions API Reference](../api-reference/core-testing-apis/test-assertions.md)
- [GoogleTest Primer](../docs/primer.md) for foundational concepts
- [Configuration Basics](../getting-started/configuration-troubleshooting/configuration-basics.md) for setup
- [Advanced Mocking with GoogleMock](../guides/essential-workflows/basic-mocking.md) for mock objects

---