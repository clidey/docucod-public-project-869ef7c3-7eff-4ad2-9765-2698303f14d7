---
title: "Assertion Macros"
description: "Comprehensive guide to the suite of assertion macros provided by GoogleTest for verifying conditions in tests. Includes equality, inequality, exception checking, and custom assertion creation, along with typical usage patterns and edge cases."
---

# Assertion Macros

GoogleTest provides a comprehensive suite of assertion macros that let you verify conditions within your tests clearly and effectively. These macros cover a range of checks including Boolean conditions, equality and inequality comparisons, exception handling, string comparisons, floating-point comparisons, and even process death verification. They serve as the fundamental building blocks for writing expressive and precise tests.

In this documentation, you will explore how to use GoogleTest's assertion macros from a practical standpoint. We begin with a simple overview of the success and failure assertions, then progressively dive into specialized assertions including predicate and exception assertions, binary comparisons, string and floating-point comparisons, and the powerful matcher-based assertions.

---

## Using Assertion Macros Effectively

### Basic Concepts

Most GoogleTest assertions come in **two variants:**

- `EXPECT_*`: Generates a **nonfatal failure** and allows the test to continue running.
- `ASSERT_*`: Generates a **fatal failure** and aborts the current function immediately.

This strict distinction lets you control whether a test should stop immediately upon failure, or continue to gather more failure information.

### Streaming Failure Messages

All assertion macros support streaming custom failure messages using the `<<` operator. Anything that can be streamed to an `ostream` can be appended, for example:

```cpp
EXPECT_TRUE(user_logged_in) << "User should be logged in here.";
```

This helps supplement failure reports with context-critical information for faster diagnosis.

---

## Explicit Success and Failure Assertions

Sometimes your test's outcome depends not on a Boolean expression but on complex flow control. GoogleTest offers explicit macros:

- `SUCCEED()`: Generates a success notification without influencing the overall test pass/fail (useful for documenting intent).
- `FAIL()`: Generates a fatal failure immediately aborting the current function (use only in void-returning functions).
- `ADD_FAILURE()`: Generates a nonfatal failure allowing continued execution.
- `ADD_FAILURE_AT(file, line)`: Generates a nonfatal failure reported at a specified file and line.

Example usage:

```cpp
switch (code) {
  case 1: // Checks for case 1
    ...
    break;
  case 2: // Checks for case 2
    ...
    break;
  default:
    FAIL() << "Unexpected code path encountered.";
}
```

---

## Generalized Assertions Using Matchers

GoogleTest integrates seamlessly with gMock matchers to enable expressive verification:

- `EXPECT_THAT(value, matcher)`
- `ASSERT_THAT(value, matcher)`

This syntax allows writing assertions that read much like English, e.g.,

```cpp
EXPECT_THAT(greeting, StartsWith("Hello"));
EXPECT_THAT(response, MatchesRegex("\d{3}-\d{4}"));
ASSERT_THAT(value, AllOf(Gt(5), Lt(10)));
```

Matchers enhance clarity and provide highly descriptive failure messages, aiding debugging.

Learn more about matchers in the [Matchers Reference](/api-reference/matchers-and-actions/argument-matchers).

---

## Boolean Condition Assertions

These macros check Boolean conditions directly:

- `EXPECT_TRUE(condition)` and `ASSERT_TRUE(condition)`: Verify the condition is true.
- `EXPECT_FALSE(condition)` and `ASSERT_FALSE(condition)`: Verify the condition is false.

Example:

```cpp
EXPECT_TRUE(is_prime(7));
ASSERT_FALSE(is_even(3));
```

Failures print the value and expression to help identify issues.

---

## Binary Comparison Assertions

Verify relationships between two values using standard comparison operators:

| Macro           | Meaning                   |
|-----------------|---------------------------|
| `EXPECT_EQ(a,b)` | a == b                    |
| `EXPECT_NE(a,b)` | a != b                    |
| `EXPECT_LT(a,b)` | a < b                     |
| `EXPECT_LE(a,b)` | a <= b                    |
| `EXPECT_GT(a,b)` | a > b                     |
| `EXPECT_GE(a,b)` | a >= b                    |

Each has a fatal variant (`ASSERT_*`).

**Important Notes:**
- Comparing pointers is by address, not content.
- For C strings, don't use `EXPECT_EQ`; use string-specific macros instead (see below).
- Arguments are evaluated exactly once.

Example:

```cpp
EXPECT_EQ(calculated_value, expected_value) << "Calculation mismatch.";
```

---

## C String Comparison Assertions

GoogleTest includes dedicated macros to compare C-style strings (`const char*` and wide strings):

- `EXPECT_STREQ(str1, str2)` and `ASSERT_STREQ(str1, str2)`: Equal contents.
- `EXPECT_STRNE(str1, str2)` and `ASSERT_STRNE(str1, str2)`: Different contents.
- `EXPECT_STRCASEEQ(str1, str2)` and `ASSERT_STRCASEEQ(str1, str2)`: Equal contents ignoring case.
- `EXPECT_STRCASENE(str1, str2)` and `ASSERT_STRCASENE(str1, str2)`: Different contents ignoring case.

Example:

```cpp
EXPECT_STREQ(user_input, expected_input) << "User input mismatch.";
```

Treats `nullptr` safely and prints wide strings as UTF-8.

---

## Floating-Point Comparison Assertions

Due to rounding, comparing floats or doubles requires tolerances rather than exact match.

- `EXPECT_FLOAT_EQ(val1, val2)`: Approximately equal floats (within 4 ULPs).
- `EXPECT_DOUBLE_EQ(val1, val2)`: Approximately equal doubles (within 4 ULPs).
- `EXPECT_NEAR(val1, val2, abs_error)`: Difference within absolute error bound.

Each has a fatal (`ASSERT_*`) variant.

**Tips:**
- Prefer these for floating-point comparisons to avoid spurious failures.
- For more advanced control, see predicate-format assertions for floating-point in the advanced guide.

---

## Exception Assertions

GoogleTest supports exception verification when exceptions are enabled:

- `EXPECT_THROW(statement, exception_type)` and `ASSERT_THROW(statement, exception_type)`: Verifies the statement throws the specified exception.
- `EXPECT_ANY_THROW(statement)` and `ASSERT_ANY_THROW(statement)`: Verifies the statement throws any exception.
- `EXPECT_NO_THROW(statement)` and `ASSERT_NO_THROW(statement)`: Verifies the statement does not throw.

Example:

```cpp
EXPECT_THROW(Foo(0), std::invalid_argument);
ASSERT_NO_THROW(Bar());
```

Statements can be compound, enclosed in braces.

---

## Predicate Assertions

If you want more precise control over condition checks and desire better failure messages than `EXPECT_TRUE()`, use predicate assertions:

### Using Boolean Predicate Functions

- `EXPECT_PREDn(pred, val1, val2, ...)` and `ASSERT_PREDn(pred, val1, val2, ...)`

Here, `pred` is a function or functor returning `bool`, receiving `n` arguments. On failure, argumentsâ€™ values are printed.

Example:

```cpp
bool IsMutuallyPrime(int a, int b);
EXPECT_PRED2(IsMutuallyPrime, x, y);
```

### Using Predicate-Formatter Functions

- `EXPECT_PRED_FORMATn(pred_fmt, val1, val2, ...)` and `ASSERT_PRED_FORMATn(pred_fmt, val1, val2, ...)`

`pred_fmt` returns `testing::AssertionResult` which can contain detailed failure explanations. This allows rich custom messages beyond true/false.

Example:

```cpp
testing::AssertionResult AssertMutuallyPrime(const char* a_expr, const char* b_expr, int a, int b);
EXPECT_PRED_FORMAT2(AssertMutuallyPrime, x, y);
```

The advanced guide has detailed recipes on creating these.

---

## Windows HRESULT Assertions

For Windows-specific code using `HRESULT` values, GoogleTest offers:

- `EXPECT_HRESULT_SUCCEEDED(expression)` and `ASSERT_HRESULT_SUCCEEDED(expression)` to verify success `HRESULT`s.
- `EXPECT_HRESULT_FAILED(expression)` and `ASSERT_HRESULT_FAILED(expression)` to verify failure `HRESULT`s.

Upon failure, the human-readable error message associated with the HRESULT is displayed.

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(CoCreateInstance(...));
```

---

## Death Assertions

Use these to verify that a statement causes program termination.

- `EXPECT_DEATH(statement, matcher)` and `ASSERT_DEATH(statement, matcher)`: Verifies process dies with nonzero exit status and stderr matches the `matcher` (regex or gMock matcher).
- `EXPECT_DEATH_IF_SUPPORTED(...)` and `ASSERT_DEATH_IF_SUPPORTED(...)`: Same as above if death tests are supported, else no verification.
- `EXPECT_DEBUG_DEATH(...)` and `ASSERT_DEBUG_DEATH(...)`: Runs only in debug mode.
- `EXPECT_EXIT(statement, predicate, matcher)` and `ASSERT_EXIT(...)`: Verifies process exit with exit status satisfying `predicate` and matching `matcher` output.

Example:

```cpp
EXPECT_DEATH({ DoSomething(); }, "Error on line .* of DoSomething()");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

**Important:** Run death tests in special test suites named `*DeathTest` for proper thread and order handling.

---

## Practical Tips and Best Practices

- Use `EXPECT_` for non-fatal checks that allow tests to continue gathering failures.
- Use `ASSERT_` when failure should stop further execution in the current function.
- Always set meaningful failure messages to clarify test intent.
- For complex assertions, prefer predicate or matcher-based assertions.
- Use `GTEST_SKIP()` to programmatically skip tests when preconditions are unmet.
- Avoid using `ASSERT_*` in constructors and destructors, use test fixture `SetUp()` and `TearDown()` instead.

---

## Related Documentation

- [Matchers Reference](/api-reference/matchers-and-actions/argument-matchers): For advanced matching strategies.
- [Advanced Topics](../advanced.md#more-assertions): Deeper dive into custom assertions and predicate assertions.
- [Guides on Writing Your First Test](/guides/getting-started/writing-first-test): How to use assertions in practical tests.

---

Harnessing GoogleTest's rich assertion macros accelerates test creation with confidence and clarity. Use the appropriate macros based on your test intentions and allow GoogleTest to provide actionable diagnostics that empower you to deliver robust, maintainable C++ tests.