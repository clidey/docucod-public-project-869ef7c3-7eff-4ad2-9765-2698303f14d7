---
title: "Test Infrastructure"
description: "Defines the main types, classes, and macros for organizing tests and test suites, managing test lifecycle, and extending test functionality. Covers the Test, TestSuite, TestInfo, and UnitTest classes, and central macros for test declaration and execution."
---

# Test Infrastructure

This page defines and explains the core classes, types, and macros provided by GoogleTest to help you structure, organize, and control your tests and test suites effectively. It details the behavior and usage of the `Test`, `TestSuite`, `TestInfo`, and `UnitTest` classes, along with central macros that declare and execute tests.

GoogleTestâ€™s test infrastructure forms the foundation for writing tests that are isolated, repeatable, and maintainable, with ample support for test lifecycle management and extensibility.

---

## Key Classes and Types

### testing::Test

The abstract base class from which all individual tests inherit. Each test is executed in isolation, giving you a clean slate every time.

#### Test Lifecycle Methods

- `SetUpTestSuite()`: Override to perform shared setup operations **once** before all tests in a test suite run.
- `TearDownTestSuite()`: Override to perform shared cleanup 
  after all tests in a test suite have finished.
- `SetUp()`: Override to initialize state or resources before **each individual test**.
- `TearDown()`: Override to clean up after **each test** finishes.

These methods enable you to manage setup/teardown efficiently, whether for individual tests or the entire test suite.

#### Test State Queries

- `HasFatalFailure()`, `HasNonfatalFailure()`, `HasFailure()`: Check for failures within the current executing test.
- `IsSkipped()`: Detect if the test was skipped during execution.

#### Test Properties

You can attach arbitrary key-value pairs to tests with `RecordProperty()`. This is useful for integration with continuous integration systems and custom reporting.

### testing::TestSuite

Represents a collection of related tests grouped logically into a test suite.

#### Information and Status

- Retrieve the name of the test suite.
- Query counts of passed, failed, skipped, disabled, and total tests.
- Check whether the test suite as a whole has passed or failed.
- Access timers and timestamps to measure suite execution duration.

#### Test Access

- Access individual `TestInfo` objects within the suite by index.

This class gives you detailed insight into the execution and results of a test suite.

### testing::TestInfo

Represents metadata and status about a single test.

#### Key Attributes

- Names: test name and the suite it belongs to.
- Source file and line number where the test is defined.
- Parameter information for parameterized or typed tests.

#### State and Outcome

- Whether the test should run given filters and flags.
- Whether the test was skipped.
- Test result details: passed, failed, flaky, etc.

You typically interact with `TestInfo` when you need granular control or inspection of individual tests.

### testing::UnitTest

Singleton class representing the entire test program.

#### Global State and Statistics

- Aggregate counts across all test suites: total, passed, failed, skipped, disabled.
- Control and introspect the current running test and suite.
- Retrieve overall execution duration and random seed.

#### Test Suite Access

- Enumerate test suites and retrieve `TestSuite` objects by index.

#### Event Listeners

Access and manipulate listeners tracking test events lifecycle.

This class acts as the global orchestrator and is your entry point for test run information.

---

## Core Macros for Declaring and Running Tests

GoogleTest uses a set of macros to simplify defining and registering tests.

### TEST

```cpp
TEST(TestSuiteName, TestName) {
  // test code
}
```
- Defines an individual test in the specified suite.
- Use for simple tests without shared fixtures.
- Both arguments must be valid C++ identifiers without underscores (`_`).

### TEST_F

```cpp
TEST_F(TestFixtureClassName, TestName) {
  // test code
}
```
- Defines a test using a fixture class, allowing shared setup and teardown.
- The first parameter is the fixture class name.
- Enables reuse of the same setup for multiple tests.

### TEST_P and INSTANTIATE_TEST_SUITE_P

- For value-parameterized tests that run the same logic with multiple input values.
- `TEST_P` defines the parameterized test.
- `INSTANTIATE_TEST_SUITE_P` provides the data sets to run the tests with, supporting multiple parameter generators like `Values()`, `Range()`, `Combine()`, etc.

### TYPED_TEST, TYPED_TEST_SUITE, and Related Macros

- Allow writing tests that run over a list of types.
- `TYPED_TEST_SUITE` declares the list of types.
- `TYPED_TEST` defines the tests.
- Support for type-parameterized tests enables powerful type-generic test coverage.

### FRIEND_TEST

- Enables a test to access a class's private members by declaring the test a friend.

### SCOPED_TRACE

- Annotates test failure messages in a scoped manner to aid debugging.

### GTEST_SKIP

- Skips test execution at runtime with an optional message.
- Can be used inside tests or fixture `SetUp()` to skip tests dynamically.

### RUN_ALL_TESTS

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```
- Runs all registered tests.
- Should be called once in `main()` after initialization.

---

## Usage Flow

1. **Initialize** the GoogleTest framework using `testing::InitGoogleTest()`.
2. **Declare** tests using `TEST()`, `TEST_F()`, or parameterized/typed variants.
3. Optionally use **fixtures** by subclassing `testing::Test` and overriding setup/teardown methods.
4. Use **assertions** inside tests to verify conditions.
5. Run the tests with `RUN_ALL_TESTS()` to execute all registered tests.
6. Inspect results using the test output or programmatic access to `UnitTest`, `TestSuite`, and `TestInfo`.

---

## Practical Tips and Best Practices

- **Organize tests into suites** logically related to the code under test.
- Use **fixtures (`TEST_F`)** when several tests share common setup/teardown.
- When testing multiple inputs, prefer **parameterized tests (`TEST_P`)** instead of duplicating code.
- Use **test properties** to attach metadata, facilitating richer reporting.
- Call `GTEST_SKIP()` when certain runtime conditions make a test irrelevant.
- Use `SCOPED_TRACE` to add context to failure messages, making complex tests easier to debug.
- Access `UnitTest::GetInstance()` for global state or orchestrating custom test tools.
- Avoid underscores in suite and test names to prevent issues in parsing or filtering.
- Call `RUN_ALL_TESTS()` only once.

---

## Troubleshooting

- If `TEST_F` causes build errors, ensure the fixture class is defined correctly and accessible.
- Use `SetUpTestSuite` and `TearDownTestSuite` sparingly; errors here can prevent all tests from running.
- Remember that tests run independently; do not rely on order or shared mutable state between tests.
- If tests are being skipped unexpectedly, verify test filters, disabled flag, and whether `GTEST_SKIP()` is called.
- Use detailed failure output and `SCOPED_TRACE` to diagnose assertion failures.

---

## Further Exploration and Related Documentation

- For **writing assertions**, see the [Assertions and Failure Handling](assertions-and-failure-handling) reference.
- To leverage **parameterized and typed tests**, consult the [Parameterized and Typed Tests](parameterized-and-typed-tests) documentation.
- Combined with **GoogleMock**, the testing infrastructure enables powerful mocking capabilities. Learn more in the [Mock Creation and Basics](mock-creation-and-basics) and [Actions and Expectations](actions-and-expectations) references.
- The [Primer](primer) provides an approachable introduction, including writing your first test and fixtures.
- Learn about **test discovery, filtering, and execution** in the corresponding guides.

---

This infrastructure is at the heart of GoogleTest's design, empowering you to write clear, maintainable, and well-structured tests.
