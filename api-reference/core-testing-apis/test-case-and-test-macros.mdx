---
title: "Test Suites and Test Case Macros"
description: "Reference for defining tests and test fixtures using macros like TEST, TEST_F, and TEST_P. Learn how to structure test suites, implement setup/teardown logic, and understand test execution flow."
---

# Test Suites and Test Case Macros

GoogleTest provides a concise and expressive set of macros to define and organize tests, making it easy to build comprehensive test suites. This reference focuses on the core macros for defining test cases and test fixtures: `TEST`, `TEST_F`, `TEST_P`, and `INSTANTIATE_TEST_SUITE_P`. Understanding these macros unlocks the power to structure tests, implement setup and teardown logic, and control test behavior through parameterization.

---

## Overview

At the heart of defining tests in GoogleTest are macros that allow you to specify:

- Individual test cases with `TEST`
- Tests that use shared setup/teardown logic (test fixtures) with `TEST_F`
- Tests that run across multiple parameter values with `TEST_P` and instantiations

Each macro fits into the test execution workflow by associating a test name to statements and user-defined fixtures, facilitating discovery, execution, and reporting.

---

## 1. TEST Macro

### Purpose
Defines a simple, independent test without any shared fixture or setup class.

### Syntax

```cpp
TEST(TestSuiteName, TestName) {
  // Test code here
}
```

- **TestSuiteName**: Name of the collection of related tests.
- **TestName**: Name of this specific test case.

### Rules

- Both names must be valid C++ identifiers.
- Names must not contain underscores.
- Tests in different suites can have the same test name.

### Example

```cpp
TEST(MathTest, Addition) {
  EXPECT_EQ(2 + 2, 4);
}
```

This defines a test called `Addition` in the `MathTest` suite.

---

## 2. TEST_F Macro

### Purpose
Defines a test that uses a test fixture class, where the fixture provides setup and teardown shared across multiple tests.

### Syntax

```cpp
TEST_F(TestFixtureName, TestName) {
  // Test code here
}
```

- **TestFixtureName**: Must be the name of a user-defined test fixture class.
- **TestName**: Name of this test case.

The fixture class must inherit from `::testing::Test` and implement optional:
- `SetUp()` - runs before each test
- `TearDown()` - runs after each test
- Static `SetUpTestSuite()` - runs once before the first test
- Static `TearDownTestSuite()` - runs once after the last test

### Test Fixture Class Example

```cpp
class MyFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    // Common setup
  }

  void TearDown() override {
    // Common cleanup
  }

  // Member variables to be shared
  int shared_data_;
};
```

### Test Example Using Fixture

```cpp
TEST_F(MyFixture, DoesSomething) {
  shared_data_ = 5;
  EXPECT_GT(shared_data_, 0);
}
```

### Value

Using fixtures enables you to avoid code duplication for common initialization or cleanup, and also lets tests share data with consistent state, improving readability and maintainability.

---

## 3. TEST_P and INSTANTIATE_TEST_SUITE_P Macros

### Purpose
Allow defining *value-parameterized tests* that run the same test logic multiple times with different input values.

### TEST_P Syntax

```cpp
TEST_P(TestFixtureName, TestName) {
  // Access parameter via GetParam()
  auto value = GetParam();
  // Test code using value
}
```

- The test fixture class must inherit from `::testing::TestWithParam<T>`
- `T` is the parameter type
- Use `GetParam()` inside the test body to obtain the current parameter value

### INSTANTIATE_TEST_SUITE_P Syntax

```cpp
INSTANTIATE_TEST_SUITE_P(
  InstantiationName,    // Unique name of this test instantiation
  TestFixtureName,      // Previously defined fixture with TEST_P
  param_generator,      // Source for the set of parameters
  [name_generator]      // Optional: function/functor for custom test names
);
```

### Parameter Generators

GoogleTest offers various generators in the `::testing` namespace:

| Generator Function             | Description                                       |
|-------------------------------|--------------------------------------------------|
| `Range(begin, end [, step])`   | Generates values in range `[begin, end)`          |
| `Values(v1, v2, ..., vN)`     | Generates the listed values                        |
| `ValuesIn(container)`          | Generates values from a container or iterator     |
| `Bool()`                      | Generates `{false, true}`                          |
| `Combine(g1, g2, ..., gN)`    | Cartesian product of generators                    |
| `ConvertGenerator<T>(g[, func])` | Converts generated values using static_cast or a conversion function |

### Example

```cpp
class MyParamTest : public ::testing::TestWithParam<int> {};

TEST_P(MyParamTest, IsPositive) {
  int n = GetParam();
  EXPECT_GT(n, 0);
}

INSTANTIATE_TEST_SUITE_P(SomeValues, MyParamTest, testing::Values(1, 5, 10));
```

This will run `IsPositive` three times with parameters 1, 5, and 10.

---

## 4. Test Execution Flow

1. **Define tests** with `TEST`, `TEST_F`, or parameterized `TEST_P`.
2. **Implement setup and cleanup** logic in fixture classes if necessary.
3. **Instantiate parameterized tests** with `INSTANTIATE_TEST_SUITE_P`.
4. **Run tests** by invoking `RUN_ALL_TESTS()` in your main function.

At runtime, GoogleTest collects all test cases and runs them according to filters, reporting status for each test suite and case.

---

## 5. Best Practices

- **Use `TEST`** for simple, stateless tests.
- **Use `TEST_F`** for tests that share setup/cleanup or state.
- **Use `TEST_P`** to test the same logic with multiple data inputs efficiently.
- **Name tests descriptively** to clarify their intent.
- **Avoid underscores** in `TestSuiteName` and `TestName` to prevent ambiguous parsing.
- **Set up and tear down shared resources** in fixtures to avoid repeated code.

---

## 6. Troubleshooting

- **Tests not discovered?** Ensure your tests have valid names and macros.
- **Fixture class errors?** Confirm it inherits `::testing::Test` or `TestWithParam`.
- **Multiple tests with same name?** Namespacing via suites avoids conflicts.
- **Parameterized tests not running?** Validate instantiation with appropriate generators.

---

## 7. Related Macros and Concepts

| Macro/Concept              | Description                                      |
|---------------------------|-------------------------------------------------|
| `FRIEND_TEST`             | Allows tests to access private members           |
| `SCOPED_TRACE`            | Adds file, line, and message context to failures |
| `GTEST_SKIP()`            | Skips the current test dynamically at runtime    |

---

## 8. Example: Combining It All

```cpp
#include <gtest/gtest.h>

class DatabaseTest : public ::testing::Test {
 protected:
  void SetUp() override {
    db_.Connect();
  }
  void TearDown() override {
    db_.Disconnect();
  }
  Database db_;
};

TEST_F(DatabaseTest, InsertRecord) {
  Record r{"Alice", 30};
  EXPECT_TRUE(db_.Insert(r));
}

class FactorialTest : public ::testing::TestWithParam<int> {};

int Factorial(int n) { return n <= 1 ? 1 : n * Factorial(n - 1); }

TEST_P(FactorialTest, ComputesCorrectly) {
  int n = GetParam();
  EXPECT_GT(Factorial(n), 0);
}

INSTANTIATE_TEST_SUITE_P(FactorialValues, FactorialTest, ::testing::Values(1, 2, 3, 4, 5));
```

---

## See Also

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primitives.md) for the basics of GoogleTest
- [Assertions and Expectations](../api-reference/core-testing-apis/assertions-and-expectations.md) for validation methods inside tests
- [Test Parameterization](../api-reference/core-testing-apis/test-parameterization.md) for detailed parameterized test usage
- [Mocking Basics](../guides/mocking-and-advanced-techniques/mocking-basics.md) for advanced test doubles

---

## References

- Test case and fixture APIs: `TEST`, `TEST_F`, `TEST_P`, `INSTANTIATE_TEST_SUITE_P`
- Test suite lifecycle hooks: `SetUpTestSuite()`, `TearDownTestSuite()`, `SetUp()`, `TearDown()`
- Parameter generators: `Values()`, `Range()`, `Bool()`, `ValuesIn()`, `Combine()`

---

This completes the reference and guidance for writing test suites and test cases using GoogleTest macros.