---
title: "Assertion Macros and Functions"
description: "Complete list and reference of core assertion macros and functions (equality, inequality, fatal/non-fatal, exception, death tests). Discusses best practices for choosing assertions and customizing output, enabling users to write precise, expressive tests."
---

# Assertion Macros and Functions Reference

This reference documents the comprehensive set of assertion macros provided by GoogleTest for verifying program behavior in tests. Use `#include <gtest/gtest.h>` to access these assertions.

---

## Understanding Assertion Behavior

GoogleTest assertions come in pairs of `EXPECT_` and `ASSERT_` macros:

- **`EXPECT_` macros** generate **nonfatal failures** and allow the test function to continue executing after a failure.
- **`ASSERT_` macros** generate **fatal failures**, immediately aborting the current test function when a failure occurs.

Use `EXPECT_` when subsequent test logic can still safely run after a verification failure. Use `ASSERT_` when continuing past a failed check would cause undefined or dangerous behavior.

You can append a custom failure message to any assertion using the streaming `<<` operator, enabling descriptive messages that clarify test context:

```cpp
EXPECT_TRUE(my_condition) << "Expected condition to hold, but it failed.";
```

---

## Explicit Success and Failure Assertions

These macros generate explicit success or failure in tests.

### `SUCCEED()`

- Generates a silent non-failure success.
- Useful for documenting explicit success points without producing output.

### `FAIL()`

- Immediately generates a fatal failure and aborts the current void-returning test function.
- Use to denote unreachable code or explicitly mark failure scenarios.

### `ADD_FAILURE()`

- Generates a nonfatal failure but continues execution.
- Handy for reporting errors without stopping the test.

### `ADD_FAILURE_AT(file, line)`

- Reports a nonfatal failure at a specific source code location.

---

## Generalized Value Assertions with Matchers

GoogleTest supports matcher-based assertions that provide expressive checks and rich failure diagnostics.

### `EXPECT_THAT(value, matcher)` / `ASSERT_THAT(value, matcher)`

- Verifies that `value` satisfies the behavior defined by `matcher`.
- `matcher` is from the gMock matcher library, allowing highly readable and composable predicates.

Example:

```cpp
#include <gmock/gmock.h>
using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;
using ::testing::StartsWith;

EXPECT_THAT(value1, StartsWith("Hello"));
EXPECT_THAT(value2, MatchesRegex("Line \\d+"));
ASSERT_THAT(value3, AllOf(Gt(5), Lt(10)));
```

Failure example:

```
Value of: value1
  Actual: "Hi, world!"
Expected: starts with "Hello"
```

Matchers are extensible and allow fine-grained validation beyond simple equality.

---

## Boolean Condition Assertions

Test raw Boolean conditions.

| Macro          | Description                          |
| -------------- | ---------------------------------- |
| `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` | Verifies `condition` evaluates to true. |
| `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` | Verifies `condition` evaluates to false. |

Example:

```cpp
EXPECT_TRUE(is_valid) << "Object should be valid";
ASSERT_FALSE(has_errors) << "No errors expected";
```

---

## Binary Comparison Assertions

These assertions compare two values with the specified relation. Both arguments are evaluated exactly once.

| Macro          | Meaning                              |
| -------------- | ---------------------------------- |
| `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` | Checks that `val1 == val2`.
| `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` | Checks that `val1 != val2`.
| `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)` | Checks that `val1 < val2`.
| `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)` | Checks that `val1 <= val2`.
| `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)` | Checks that `val1 > val2`.
| `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)` | Checks that `val1 >= val2`.

**Special notes:**
- For pointers, equality is pointer address equality, not content equality.
- To compare C-strings by content, use *string comparison* assertions (see below).
- When comparing a pointer to `NULL`, prefer comparing to `nullptr`.

Example:

```cpp
EXPECT_EQ(result, expected_value);
ASSERT_NE(ptr, nullptr) << "Pointer should not be null";
```

---

## String Comparison Assertions for C Strings

These macros specifically compare C-style strings (`const char*`) by their content, not by pointer identity.

| Macro                  | Description                                |
| ---------------------- | ------------------------------------------ |
| `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` | Verifies `str1` and `str2` are equal strings.
| `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)` | Verifies `str1` and `str2` are different strings.
| `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)` | Verifies strings are equal ignoring case.
| `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)` | Verifies strings are different ignoring case.

These also accept wide strings and print messages as UTF-8 narrow strings.

Example:

```cpp
EXPECT_STREQ("hello", actual.c_str());
ASSERT_STRNE("hello", wrong.c_str());
```

---

## Floating-Point Comparison Assertions

Floating-point comparison requires tolerance due to rounding errors. Use the following assertions for robust comparison:

| Macro                | Description                                            |
| -------------------- | ------------------------------------------------------ |
| `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)` | Asserts `float` values are approximately equal within 4 ULPs.
| `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)` | Asserts `double` values are approximately equal within 4 ULPs.
| `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` | Asserts that the absolute difference is less than or equal to `abs_error`.

Infinity and largest finite float/double are treated as one ULP apart.

Example:

```cpp
EXPECT_FLOAT_EQ(computed_float, expected_float);
ASSERT_NEAR(computed_double, expected_double, 0.001);
```

---

## Exception Assertions

Only available if exceptions are enabled. Check whether code throws specific exceptions.

| Macro                 | Description                                      |
| --------------------- | ------------------------------------------------ |
| `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)` | Verifies `statement` throws the specified exception type.
| `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)` | Verifies that `statement` throws any exception.
| `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)` | Verifies that `statement` does not throw any exception.

Example:

```cpp
EXPECT_THROW(Foo(), std::runtime_error);
EXPECT_NO_THROW(Bar());
```

---

## Predicate Assertions

Allow verification of custom predicates with clearer error messages.

| Macro                        | Description                                  |
| ---------------------------- | -------------------------------------------- |
| `EXPECT_PRED1(pred, val1)` through `EXPECT_PRED5(pred, val1, ..., val5)` | Verifies unary to 5-argument predicates return true.
| `ASSERT_PRED1(...)` through `ASSERT_PRED5(...)` | Fatal versions of above.
| `EXPECT_PRED_FORMAT1(format, val1)` through `EXPECT_PRED_FORMAT5(format, val1, ..., val5)` | Assert predicates with custom formatting functions.

Example:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, 4);  // Succeeds
EXPECT_PRED1(IsEven, 3);  // Fails with detailed message
```

Use `EXPECT_PRED_FORMAT*` to provide richer failure messages.

---

## Windows `HRESULT` Assertions

Verify Windows COM API calls' HRESULT values.

| Macro                             | Description                                |
| -------------------------------- | ------------------------------------------ |
| `EXPECT_HRESULT_SUCCEEDED(expr)` / `ASSERT_HRESULT_SUCCEEDED(expr)` | Verifies HRESULT indicates success.
| `EXPECT_HRESULT_FAILED(expr)` / `ASSERT_HRESULT_FAILED(expr)` | Verifies HRESULT indicates failure.

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell->CoCreateInstance(...));
EXPECT_HRESULT_FAILED(foo->QueryInterface(...));
```

GoogleTest will print human-readable error messages based on HRESULT codes.

---

## Death Assertions

Verify that executing code causes program termination.

| Macro                                  | Description                                                 |
| ------------------------------------- | ----------------------------------------------------------- |
| `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH(statement, matcher)` | Expects process termination with stderr matching `matcher`.
| `EXPECT_DEATH_IF_SUPPORTED(statement, matcher)` / `ASSERT_DEATH_IF_SUPPORTED(...)` | Same as death assertions if supported, otherwise no-op.
| `EXPECT_DEBUG_DEATH(statement, matcher)` / `ASSERT_DEBUG_DEATH(...)` | Death assertions only in debug builds, no-op in release.
| `EXPECT_EXIT(statement, predicate, matcher)` / `ASSERT_EXIT(...)` | Verifies termination with exit code satisfying `predicate` and stderr matching `matcher`.

Details:
- Death tests spawn subprocesses.
- The `matcher` is a regex or matcher checked against stderr.
- The `predicate` inspects exit status, e.g., normal exit or by signal.

Example:

```cpp
EXPECT_DEATH(DoSomething(42), "My error message");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

---

# Practical Tips and Best Practices

- Always use `ASSERT_` macros when a failed check leaves subsequent code unsafe or meaningless.
- Use the streaming `<<` operator to add context to test failures; this improves debuggability significantly.
- Use matcher-based assertions (`EXPECT_THAT`) for richer argument validation.
- Use `EXPECT_PRED*` macros for complex predicates that can’t easily be expressed by matchers.
- Use `EXPECT_DEATH` and related assertions carefully; ensure tests cleanly terminate to avoid flaky test runs.
- For floating-point comparisons, prefer `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR` instead of `EXPECT_EQ`.
- When comparing C strings, always use `EXPECT_STREQ` or similar to avoid pointer miscomparation.

---

# Examples

### Basic Equality Check

```cpp
EXPECT_EQ(result, expected_value) << "Result does not match the expected value.";
ASSERT_NE(pointer, nullptr) << "Pointer should not be null.";
```

### Matcher Usage

```cpp
using ::testing::StartsWith;
EXPECT_THAT(name, StartsWith("John"));
```

### Floating-Point Approximate Equality

```cpp
EXPECT_NEAR(computed, expected, 0.001);
```

### Exception Check

```cpp
EXPECT_THROW(FuncThatThrows(), std::runtime_error);
```

### Death Test

```cpp
EXPECT_DEATH({ CrashFunction(); }, "Segmentation fault");
```

### Predicate Check

```cpp
bool IsPositive(int n) { return n > 0; }
EXPECT_PRED1(IsPositive, value);
```


---

# Troubleshooting Common Issues

- **False failures on equality checks:** Verify you're not comparing pointers instead of content. Use string-specific assertions for `const char*`.
- **Tests aborting prematurely:** Ensure that you’re using `ASSERT_` macros only when failure should stop execution; otherwise use `EXPECT_`.
- **Death tests not triggering:** Confirm your code under test does terminate or abort as expected and that death test style is configured appropriately.
- **Floating-point comparisons failing:** Switch to `EXPECT_NEAR` or the approximate equality macros.

---

# Additional Resources

- [Matchers Reference](matchers.md)
- [Mocking Reference](reference/mocking.md)
- [gMock for Dummies](gmock_for_dummies.md)
- [Writing Custom Matchers](gmock_cook_book.md#NewMatchers)
- [Death Tests Guide](../advanced.md#death-tests)

---

For detailed examples and advanced usage, explore the above links and the full GoogleTest and GoogleMock documentation.