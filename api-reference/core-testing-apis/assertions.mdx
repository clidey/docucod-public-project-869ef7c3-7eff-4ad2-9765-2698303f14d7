---
title: "Assertions and Expectations"
description: "Comprehensive guide to built-in assertions (ASSERT_*, EXPECT_*) in GoogleTest, including success/failure semantics, custom failure messages, and rich diagnostics via AssertionResult. Covers fatal and non-fatal assertions as well as advanced scenarios like predicate assertions."
---

# Assertions and Expectations

GoogleTest offers a comprehensive set of assertion macros to verify the correctness of your C++ code during testing. These assertions form the backbone of your test validations and report detailed diagnostics when tests fail.

## Understanding Assertion Semantics

GoogleTest assertions come primarily in pairs: `EXPECT_` and `ASSERT_` variants. Both verify a particular condition but differ in how they affect test execution:

- **`EXPECT_` assertions** generate **nonfatal failures** upon failure, allowing the current test function to continue executing. These are useful when you want to check multiple conditions even if one fails.

- **`ASSERT_` assertions** generate **fatal failures** on failure, immediately aborting the current function. Use these when it makes no sense to proceed if the condition is not met.

You can attach custom failure messages to any assertion by streaming additional information with the `<<` operator, improving failure diagnosability.

```cpp
EXPECT_TRUE(is_valid) << "Input validation failed";
ASSERT_EQ(result, expected) << "Calculation result differs";
```

If the message data is streamable to an `ostream` (including strings and wide strings), it will be included in the failure output.

## Explicit Success and Failure Assertions

Sometimes, you want to explicitly indicate success or failure in your tests, beyond evaluating expressions.

### SUCCEED()

- Generates an explicit success event.
- Does NOT mark the overall test as passed by itself; a test passes only if no assertion fails throughout.
- Mainly serves as a documentation aid or for future enhancement with visible success messages.

```cpp
SUCCEED() << "Checkpoint reached successfully";
```

### FAIL()

- Generates a fatal failure, aborting the current function.
- Can only be used in void-returning functions.

```cpp
if (unexpected_condition) {
  FAIL() << "Unexpected error encountered";
}
```

### ADD_FAILURE()

- Generates a nonfatal failure, allowing test execution to continue.

```cpp
if (!CheckCondition()) {
  ADD_FAILURE() << "Condition check failed";
}
```

### ADD_FAILURE_AT(file, line)

- Allows generating a nonfatal failure at a specified source code location.

```cpp
ADD_FAILURE_AT("foo.cc", 42) << "Issue at foo.cc:42";
```

## Assertions with Matchers: EXPECT_THAT

GoogleTest supports matcher-based assertions that allow expressive and readable checks.

```cpp
EXPECT_THAT(value, StartsWith("Hello"));
ASSERT_THAT(numbers, AllOf(HasSize(3), Contains(42)));
```

Matchers come from GoogleMock's matcher framework, providing rich, English-like syntax and detailed failure diagnostics.

## Boolean Assertions

Use these to verify simple Boolean conditions.

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

Example:

```cpp
EXPECT_TRUE(user.IsAuthenticated()) << "User should be authenticated";
ASSERT_FALSE(pointer == nullptr) << "Pointer must not be null";
```

## Binary Comparison Assertions

Compare pairs of values using standard relational operators. Arguments are evaluated exactly once.

| Macro       | Description                     |
| ----------- | -------------------------------|
| `EXPECT_EQ` / `ASSERT_EQ` | Verifies equality (`val1 == val2`)           |
| `EXPECT_NE` / `ASSERT_NE` | Verifies inequality (`val1 != val2`)         |
| `EXPECT_LT` / `ASSERT_LT` | Verifies less than (`val1 < val2`)            |
| `EXPECT_LE` / `ASSERT_LE` | Verifies less or equal (`val1 <= val2`)       |
| `EXPECT_GT` / `ASSERT_GT` | Verifies greater than (`val1 > val2`)         |
| `EXPECT_GE` / `ASSERT_GE` | Verifies greater or equal (`val1 >= val2`)    |

**Important:**
- For pointer comparisons, `EXPECT_EQ` compares addresses, not pointed-to content.
- For C strings, use string comparison macros instead to compare by content.

Example:

```cpp
EXPECT_EQ(result.size(), expected.size()) << "Size mismatch";
ASSERT_LT(index, vector.size()) << "Index out of bounds";
```

## String Comparison Assertions

Special macros exist for comparing C strings (`const char*`) or wide C strings, taking care of null pointers and content differences:

| Macro            | Description                              |
| ---------------- | ----------------------------------------|
| `EXPECT_STREQ` / `ASSERT_STREQ` | Strings are equal (content equality)       |
| `EXPECT_STRNE` / `ASSERT_STRNE` | Strings are not equal                      |
| `EXPECT_STRCASEEQ` / `ASSERT_STRCASEEQ` | Strings equal ignoring case                |
| `EXPECT_STRCASENE` / `ASSERT_STRCASENE` | Strings different ignoring case            |

Example:

```cpp
EXPECT_STREQ(actual_name, "John Doe") << "Unexpected name";
ASSERT_STRNE(error_msg, nullptr) << "Error message should not be null";
```

## Floating-Point Comparisons

Due to rounding errors, floating-point equality checks require special handling. GoogleTest offers floating-point specific assertions:

- `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ`: Checks approximate equality of `float`s based on Units in the Last Place (ULPs).
- `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ`: Same for `double`s.
- `EXPECT_NEAR` / `ASSERT_NEAR(value1, value2, abs_error)`: Verifies values differ by no more than `abs_error`.

Use these macros to avoid false positives in floating-point comparisons.

Example:

```cpp
EXPECT_FLOAT_EQ(computed_value, expected_value);
ASSERT_NEAR(measured, reference, 0.001) << "Value not within tolerance";
```

## Exception Assertions

GoogleTest supports assertions that verify whether code throws exceptions. Exceptions must be enabled in your build.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW`: Verifies statement throws the specified exception type.
- `EXPECT_ANY_THROW` / `ASSERT_ANY_THROW`: Verifies statement throws any exception.
- `EXPECT_NO_THROW` / `ASSERT_NO_THROW`: Verifies statement does not throw.

Example:

```cpp
EXPECT_THROW(Divide(1, 0), std::invalid_argument);
ASSERT_NO_THROW(ProcessInput(data));
```

## Predicate Assertions

For sophisticated conditions that can't be expressed with built-in assertions, GoogleTest provides predicate assertions that print clearer failure messages with argument values.

- `EXPECT_PRED1(pred, val1)` up to `EXPECT_PRED5` for predicates with multiple arguments.
- Corresponding `EXPECT_PRED_FORMAT` and `ASSERT_PRED_FORMAT` macros allow customizing failure message formatting with predicate-formatters.

Example:

```cpp
bool IsPrime(int n) { ... }
EXPECT_PRED1(IsPrime, 7);

using testing::AssertionResult;
AssertionResult IsEven(int n) {
  return (n % 2) == 0 ? testing::AssertionSuccess() : testing::AssertionFailure() << n << " is odd";
}
EXPECT_TRUE(IsEven(value));
```

## Windows HRESULT Assertions

On Windows, GoogleTest can assert on `HRESULT` values, interpreting success/failure and reporting system error messages:

- `EXPECT_HRESULT_SUCCEEDED(expr)` / `ASSERT_HRESULT_SUCCEEDED`: Checks HRESULT success.
- `EXPECT_HRESULT_FAILED(expr)` / `ASSERT_HRESULT_FAILED`: Checks HRESULT failure.

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(CoCreateInstance(...));
EXPECT_HRESULT_FAILED(someFunctionCall());
```

## Death Assertions

Death assertions verify that code causes the tested process to terminate due to fatal conditions.

- `EXPECT_DEATH(statement, regex)` / `ASSERT_DEATH`: Verifies that `statement` causes process death and outputs stderr matching `regex`.
- `EXPECT_DEATH_IF_SUPPORTED`, `EXPECT_DEBUG_DEATH`: Variants for platform or build-mode specific death tests.
- `EXPECT_EXIT(statement, predicate, regex)` / `ASSERT_EXIT`: Verifies process terminates with exit status matching predicate and stderr matching regex.

Example:

```cpp
ASSERT_DEATH(AbortIfBad(input), "Fatal error on invalid input");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

### Best Practices for Using Assertions

- Prefer `EXPECT_` over `ASSERT_` when continuation after failure is safe and valuable.
- Use assertion streaming (`<<`) to add context-specific failure details.
- For complex conditions, use predicate assertions or matchers with `EXPECT_THAT` to get expressive messages.
- Use string-specific assertions for C strings to avoid pointer-based comparisons.
- For floating-point comparisons, always use floating-point assertions to avoid spurious failures due to precision.

### Common Pitfalls

- Using `ASSERT_` in non-void functions causes compile errors due to function return omission.
- Comparing C strings for content equality with `EXPECT_EQ` checks addresses, not content.
- Forgetting to call `InitGoogleTest()` before `RUN_ALL_TESTS()` may cause flags to be ignored.
- Using assertion macros that generate fatal failures in constructors or destructors is disallowed.

### Summary

GoogleTest's suite of assertions empowers you to write robust, clear, and maintainable tests. With built-in assertions for fundamental checks, advanced predicate and matcher assertions for complex validation, and support for exceptions, death tests, and Windows-specific HRESULT checks, you can cover a broad range of test scenarios. Using these effectively will greatly improve your test reliability and developer productivity.

---

<Info>
For full API details, see the [Assertions Reference](reference/assertions.md).
</Info>

<Info>
To learn advanced usage of predicates and custom failure messages, see [Advanced GoogleTest Topics](advanced.md#predicate-assertions-for-better-error-messages).
</Info>

<Info>
See [Writing Your First Tests](guides/getting-started/writing-your-first-tests.mdx) for introductory tutorials using these assertions.
</Info>
