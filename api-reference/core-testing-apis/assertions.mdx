---
title: "Assertions"
description: "Describes the variety of built-in assertion macros and functions provided by GoogleTest, including equality/inequality, exception, fatal and non-fatal assertions, as well as how to create custom assertions. Users will learn when and how to use each assertion type for accurate test outcomes."
---

# Assertions Reference

This documentation describes the variety of built-in assertion macros and functions provided by GoogleTest. Assertions help you check the correctness of your code during test execution by verifying various conditions such as equality, exception throwing behavior, and boolean expressions. Each assertion macro exists in two forms: `EXPECT_*` and `ASSERT_*`, which differ in the severity of test failure they trigger.

---

## Overview of Assertions

GoogleTest assertions come in two pairs that test identical conditions but have different effects on the test flow:

- `ASSERT_*`: Generate **fatal failures** that abort the current function immediately.
- `EXPECT_*`: Generate **nonfatal failures** that allow the test to continue after failure.

Use `ASSERT_*` when it does not make sense to continue the test upon failure. Prefer `EXPECT_*` otherwise, so multiple failures can be detected during a single test run.

All assertion macros allow streaming of custom failure messages by using the `<<` operator. Anything streamable to `std::ostream` can be appended, including wide strings (which get converted to UTF-8).

```cpp
EXPECT_TRUE(x > 5) << "x must be greater than 5 but is " << x;
```

---

## Explicit Success and Failure

For control-flow driven success or failure reporting instead of boolean checks.

### SUCCEED()

Generates an explicit success notification.

Note: it does not influence the overall test result which depends only on failures.

```cpp
SUCCEED();
```

### FAIL()

Generates a **fatal failure** and aborts the current function. Can only be used in void-returning functions.

```cpp
if (unexpected_condition) FAIL() << "This code path should never be reached";
```

### ADD_FAILURE()

Generates a **nonfatal failure**, allowing the current function to continue running.

```cpp
if (unexpected_condition) ADD_FAILURE() << "Something went wrong";
```

### ADD_FAILURE_AT(file, line)

Generates a **nonfatal failure** reported at the specified file and line number.

```cpp
ADD_FAILURE_AT("foo.cc", 42) << "Failure happened here";
```

---

## Boolean Condition Assertions

Verify that a condition is true or false.

| Macro            | Description                        |
|------------------|----------------------------------|
| `EXPECT_TRUE(cond)`  | Checks that *cond* is true.       |
| `ASSERT_TRUE(cond)`  | Checks that *cond* is true and aborts on failure. |
| `EXPECT_FALSE(cond)` | Checks that *cond* is false.      |
| `ASSERT_FALSE(cond)` | Checks that *cond* is false and aborts on failure. |

Example:

```cpp
EXPECT_TRUE(IsValid(x));
ASSERT_FALSE(IsEmpty(container));
```


---

## Equality and Comparison Assertions

Compare two values using relational operators. Values must be comparable and printable.

| Macro             | Meaning                                 |
|-------------------|-----------------------------------------|
| `EXPECT_EQ(a, b)` | Checks `a == b`                         |
| `ASSERT_EQ(a, b)` | Checks `a == b` and aborts on failure  |
| `EXPECT_NE(a, b)` | Checks `a != b`                         |
| `ASSERT_NE(a, b)` | Checks `a != b` and aborts on failure  |
| `EXPECT_LT(a, b)` | Checks `a < b`                          |
| `ASSERT_LT(a, b)` | Checks `a < b` and aborts on failure   |
| `EXPECT_LE(a, b)` | Checks `a <= b`                         |
| `ASSERT_LE(a, b)` | Checks `a <= b` and aborts on failure  |
| `EXPECT_GT(a, b)` | Checks `a > b`                          |
| `ASSERT_GT(a, b)` | Checks `a > b` and aborts on failure   |
| `EXPECT_GE(a, b)` | Checks `a >= b`                         |
| `ASSERT_GE(a, b)` | Checks `a >= b` and aborts on failure  |

Use caution: `EXPECT_EQ` and `ASSERT_EQ` on pointers check pointer equality (address), not pointer content equality. To compare C strings by content, use string comparison assertions described below.

Example:

```cpp
EXPECT_EQ(value, expected_value) << "Mismatch detected.";
```

---

## String Comparison Assertions

These compare **C-style strings** (`const char*`, `wchar_t*`) by content rather than pointer address. Wide strings are UTF-8 encoded for output.

| Macro                  | Description                                   |
|------------------------|-----------------------------------------------|
| `EXPECT_STREQ(s1, s2)` | Checks if C strings `s1` and `s2` are equal. |
| `ASSERT_STREQ(s1, s2)` | Checks equality and aborts on failure.       |
| `EXPECT_STRNE(s1, s2)` | Checks if C strings `s1` and `s2` are not equal. |
| `ASSERT_STRNE(s1, s2)` | Checks inequality and aborts on failure.     |
| `EXPECT_STRCASEEQ(s1, s2)` | Checks equality ignoring case for strings. |
| `ASSERT_STRCASEEQ(s1, s2)` | Checks equality ignoring case and aborts on failure. |
| `EXPECT_STRCASENE(s1, s2)` | Checks inequality ignoring case.           |
| `ASSERT_STRCASENE(s1, s2)` | Checks inequality ignoring case and aborts. |

Example:

```cpp
EXPECT_STREQ("hello", actual_c_string) << "String differs";
```

---

## Floating-Point Comparison Assertions

Due to rounding, exact equality tests on floating-point numbers are unreliable.

| Macro                  | Description                                           |
|------------------------|-------------------------------------------------------|
| `EXPECT_FLOAT_EQ(a, b)`   | Checks if two `float` values are approximately equal (within 4 ULPs). |
| `ASSERT_FLOAT_EQ(a, b)`   | Same as `EXPECT_FLOAT_EQ` but aborts on failure.     |
| `EXPECT_DOUBLE_EQ(a, b)`  | Checks if two `double` values are approximately equal (within 4 ULPs). |
| `ASSERT_DOUBLE_EQ(a, b)`  | Same as `EXPECT_DOUBLE_EQ` but aborts on failure.    |
| `EXPECT_NEAR(a, b, error)`| Checks if difference between `a` and `b` does not exceed `error` (absolute). |
| `ASSERT_NEAR(a, b, error)`| Same as `EXPECT_NEAR` but aborts on failure.          |

Example:

```cpp
EXPECT_NEAR(computed_value, expected_value, 0.001);
```

---

## Exception Assertions

Require exceptions enabled in the build environment. Verify behavior of code that throws or does not throw exceptions.

| Macro                  | Description                               |
|------------------------|-------------------------------------------|
| `EXPECT_THROW(stmt, exc_type)` | Verifies `stmt` throws exception of type `exc_type`. |
| `ASSERT_THROW(stmt, exc_type)` | Same as above but aborts on failure.    |
| `EXPECT_ANY_THROW(stmt)`         | Verifies that `stmt` throws any exception. |
| `ASSERT_ANY_THROW(stmt)`         | Same as above but aborts on failure.    |
| `EXPECT_NO_THROW(stmt)`          | Verifies that `stmt` does *not* throw any exception. |
| `ASSERT_NO_THROW(stmt)`          | Same as above but aborts on failure.    |

Example:

```cpp
EXPECT_THROW(function_that_should_throw(), std::runtime_error);
```

Note: `stmt` can be a compound statement in `{ }` braces.

---

## Predicate Assertions

These allow assertions on complex predicates with detailed failure messages.

### Predicate Assertions with Boolean Predicates

Macros: `EXPECT_PRED1` to `EXPECT_PRED5` and `ASSERT_PRED1` to `ASSERT_PRED5`.

Use these to test functions or functors returning `bool`. Failure messages print the evaluated arguments.

```cpp
bool IsPositive(int x) { return x > 0; }
EXPECT_PRED1(IsPositive, 5);  // passes
EXPECT_PRED1(IsPositive, -1); // fails with message showing argument value
```

### Predicate Assertions with Predicate-Formatters

Macros: `EXPECT_PRED_FORMAT1` to `EXPECT_PRED_FORMAT5` and `ASSERT_PRED_FORMAT1` to `ASSERT_PRED_FORMAT5`.

Use these to define custom messages using predicate-formatter functions that return `testing::AssertionResult` and include source expressions and values.

```cpp
// Predicate formatter ensuring both numbers add to even
AssertionResult IsSumEven(const char* e1, const char* e2, int v1, int v2) {
  if ((v1 + v2) % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << e1 << " + " << e2 << " is not even";
}
EXPECT_PRED_FORMAT2(IsSumEven, 3, 5); // Passes
EXPECT_PRED_FORMAT2(IsSumEven, 3, 4); // Fails with detailed message
```

Predicate assertions evaluate arguments exactly once.

---

## Using gMock Matchers with Assertions

Use `EXPECT_THAT(value, matcher)` or `ASSERT_THAT(value, matcher)` to assert complex matching conditions with rich matchers from GoogleMock.

Example:

```cpp
EXPECT_THAT(foo_string, ::testing::StartsWith("Hello"));
ASSERT_THAT(value, ::testing::AllOf(::testing::Gt(5), ::testing::Lt(10)));
```

Matchers produce descriptive failure messages, making tests expressive.

---

## Windows HRESULT Assertions

On Windows, use these to assert the success or failure of `HRESULT` values.

| Macro                          | Description                        |
|--------------------------------|------------------------------------|
| `EXPECT_HRESULT_SUCCEEDED(expr)` | Checks that `expr` returns a success `HRESULT`. |
| `ASSERT_HRESULT_SUCCEEDED(expr)` | Same but aborts on failure.      |
| `EXPECT_HRESULT_FAILED(expr)`    | Checks that `expr` is a failed `HRESULT`. |
| `ASSERT_HRESULT_FAILED(expr)`    | Same but aborts on failure.      |

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

Failure messages include human-readable system error information.

---

## Death Assertions

Verifies that code causes the process to terminate or exit with a matching output.

| Macro                          | Description                                                  |
|--------------------------------|--------------------------------------------------------------|
| `EXPECT_DEATH(stmt, matcher)`    | Verifies `stmt` causes process to exit with nonzero status and stderr matching `matcher`. |
| `ASSERT_DEATH(stmt, matcher)`    | Same, but aborts on failure.                                 |
| `EXPECT_DEATH_IF_SUPPORTED(stmt, matcher)` | Like `EXPECT_DEATH` if death tests are available; otherwise a no-op. |
| `ASSERT_DEATH_IF_SUPPORTED(stmt, matcher)` | Like `ASSERT_DEATH` if death tests are available.           |
| `EXPECT_DEBUG_DEATH(stmt, matcher)` | Like `EXPECT_DEATH` but only in debug mode.                |
| `ASSERT_DEBUG_DEATH(stmt, matcher)` | Like `ASSERT_DEATH` but only in debug mode.                |
| `EXPECT_EXIT(stmt, predicate, matcher)` | Verifies that `stmt` exits with status satisfying `predicate` and output matching `matcher`. |
| `ASSERT_EXIT(stmt, predicate, matcher)` | Same, but aborts on failure.                               |

Example:

```cpp
EXPECT_DEATH(DoSomething(42), "My error");
ASSERT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

The matcher can be a regular expression or a matcher of string output.

---

## Creating Custom Assertions

GoogleTest enables creation of custom predicates returning `testing::AssertionResult` that can be used within `EXPECT_TRUE` or `ASSERT_TRUE` to produce expressive, clear failure messages.

Example:

```cpp
testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << n << " is odd";
}

EXPECT_TRUE(IsEven(Fib(10)));  // Prints detailed message if fails
```

Use predicate-formatter functions for even more customizable messages.

---

## Practical Tips and Best Practices

- Prefer `EXPECT_*` when it makes sense to continue testing after failure.
- Use `ASSERT_*` if continuing after a failure would cause further errors (such as dereferencing null pointers).
- Always stream informative messages to assertions to ease debugging.
- Use string comparison assertions (`EXPECT_STREQ` etc.) for checking C string content.
- Use floating-point assertions (`EXPECT_FLOAT_EQ`, `EXPECT_NEAR`) instead of `EXPECT_EQ` for approximate equality.
- Employ predicate assertions to handle complex conditions with good diagnostics.
- Use `EXPECT_THROW` and related macros for exception testing when exceptions are enabled.
- For death tests, carefully specify expected output and exit conditions.
- Avoid putting fatal assertions in constructors or destructors; prefer `SetUp` and `TearDown`.

---

## Examples

```cpp
// Equality assertion with message
EXPECT_EQ(vec.size(), expected_size) << "Vector size mismatch.";

// String comparison
EXPECT_STREQ("hello", my_c_string);

// Floating-point near equality
EXPECT_NEAR(computed, expected, 0.001);

// Exception assertion
EXPECT_THROW(MyFunction(), std::runtime_error);

// Predicate assertion
bool IsNonNegative(int x) { return x >= 0; }
EXPECT_PRED1(IsNonNegative, value);

// Predicate formatter example
AssertionResult IsEven(const char* expr, int n) {
  if (n % 2 == 0) return AssertionSuccess();
  return AssertionFailure() << expr << " is not even, actual: " << n;
}
EXPECT_PRED_FORMAT1(IsEven, x);

// Death test
EXPECT_DEATH({ abort(); }, "abort");
```

---

## Troubleshooting

- If you get unexpected failures, verify that your assertion arguments are evaluated exactly once.
- Avoid fatal assertions inside constructors or destructors; this can lead to partial construction.
- Use `ASSERT_NO_FATAL_FAILURE()` to verify that a helper function doesn't generate fatal failures.
- Use proper string assertions when comparing C strings.
- For floating-point comparisons, prefer floating-point specific macros to handle rounding.
- Make sure exceptions are enabled if using exception assertions.

---

## See Also

- [Advanced GoogleTest Topics](../advanced.md#more-assertions)
- [Writing Effective Tests: Assertions and Matchers](../guides/writing-effective-tests/assertions-matchers.mdx)
- [GoogleMock Expectation and Behaviors](../guides/mocking-real-world/expectations-behaviors.mdx)
- [Death Testing](../guides/solutions-and-patterns/death-tests.mdx)
- [Matchers Reference](matchers.md)
- [Actions Reference](actions.md)


---

## Appendices

### Assertion Macro Groups

| Group                  | Macros Examples                             | Purpose                         |
|------------------------|---------------------------------------------|--------------------------------|
| Explicit Success/Failure | `SUCCEED()`, `FAIL()`, `ADD_FAILURE()`      | Report explicit test outcomes  |
| Boolean Conditions      | `EXPECT_TRUE()`, `ASSERT_FALSE()`            | Boolean condition checks       |
| Binary Comparison       | `EXPECT_EQ()`, `ASSERT_LT()`                  | Compare values                 |
| String Comparison       | `EXPECT_STREQ()`, `ASSERT_STRCASEEQ()`       | Compare C-string contents      |
| Floating-point          | `EXPECT_FLOAT_EQ()`, `ASSERT_NEAR()`          | Approximate floating-point check|
| Exception Assertions    | `EXPECT_THROW()`, `ASSERT_NO_THROW()`         | Exception thrown/no thrown     |
| Predicate Assertions    | `EXPECT_PRED1()`, `ASSERT_PRED_FORMAT2()`     | Complex predicate validation   |
| HRESULT Assertions      | `EXPECT_HRESULT_SUCCEEDED()`, `ASSERT_HRESULT_FAILED()` | Windows error checks          |
| Death Assertions        | `EXPECT_DEATH()`, `ASSERT_EXIT()`             | Process exit behavior          |


---

## Summary

GoogleTest assertions provide versatile and expressive macros for verifying code correctness, handling various data types, control flows, exceptions, and process termination. They form the core mechanism by which tests reveal defects effectively and informatively, enabling fast development cycles.

Use fatal assertions to abort tests when further progress is meaningless or harmful. Use non-fatal assertions to report multiple issues in one test invocation. Customize assertion failure messages to aid debugging. Employ predicate assertions and `EXPECT_THAT` with matchers to express complex validation clearly. Death assertions enable testing for program termination behavior.

Together, these tools empower you to write robust, clear, and maintainable tests.
