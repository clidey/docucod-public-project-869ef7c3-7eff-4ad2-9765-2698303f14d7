---
title: "Assertions and Result Handling"
description: "Describes the core assertion macros and support types used to check conditions, compare values, and handle success and failure states in tests. Covers both built-in assertions and custom assertion utilities provided by GoogleTest, including fatal and non-fatal behaviors."
---

# Assertions and Result Handling

This reference covers the core assertion macros and support types used in GoogleTest to verify conditions, compare values, and report success or failure in tests. It includes built-in assertions, explicit success/failure macros, predicate assertions with rich failure messages, and mechanisms to extend assertion behavior.

To use any of the assertions, include GoogleTest in your test program with:

```cpp
#include <gtest/gtest.h>
```

---

## Understanding Assertions

Assertions in GoogleTest are statements that check whether a condition holds true during a test execution. There are two categories:

- **Fatal assertions (`ASSERT_`)**: Abort the current function on failure, preventing further execution.
- **Nonfatal assertions (`EXPECT_`)**: Record the failure but allow the test function to continue executing.

This allows you to decide when failure should stop a test or when it should continue to gather more information.

All assertion macros support streaming custom failure messages using the `<<` operator:

```cpp
EXPECT_TRUE(my_condition) << "Condition expected to be true but failed.";
```

Anything streamable to an output stream (like strings or numeric values) can be used in these custom messages.

---

## Explicit Success and Failure

Sometimes tests need to explicitly mark success or failure irrespective of condition checks.

### SUCCEED()

Generates a success assertion.

```cpp
SUCCEED();
```

It has no effect on the overall test result but provides documentation and can be streamed with messages for clarity.

### FAIL()

Generates a fatal failure and aborts the current function.

```cpp
FAIL() << "This test has failed!";
```

This macro only works inside functions returning void.

### ADD_FAILURE()

Generates a nonfatal failure allowing the test function to continue.

```cpp
ADD_FAILURE() << "Nonfatal failure occurred.";
```

### ADD_FAILURE_AT(file, line)

Generates a nonfatal failure at a specific file and line number.

```cpp
ADD_FAILURE_AT("foo.cc", 42) << "Failure at a specific location.";
```

---

## Boolean Conditions

These macros verify Boolean expressions:

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

Example:

```cpp
EXPECT_TRUE(is_valid) << "Expected validity check to be true.";
EXPECT_FALSE(is_empty) << "Should not be empty.";
```

---

## Comparing Values

Compare two values with relational operators. Failures print both expressions and actual values for clarity.

| Macro                 | Verifies                             |
| --------------------- | ---------------------------------- |
| `EXPECT_EQ(val1, val2)`  | `val1 == val2`                     |
| `EXPECT_NE(val1, val2)`  | `val1 != val2`                     |
| `EXPECT_LT(val1, val2)`  | `val1 < val2`                      |
| `EXPECT_LE(val1, val2)`  | `val1 <= val2`                     |
| `EXPECT_GT(val1, val2)`  | `val1 > val2`                      |
| `EXPECT_GE(val1, val2)`  | `val1 >= val2`                     |

Their fatal counterparts are `ASSERT_*` versions.

Example:

```cpp
EXPECT_EQ(expected_size, actual_size) << "Sizes do not match.";
ASSERT_LT(value, upper_limit) << "Value exceeds limit.";
```

### Pointer Comparison Caveats

Comparisons on pointers test address equality. To compare C strings by content, use string comparison macros (see below).

---

## String Comparisons

Special macros exist for comparing **C strings** (`const char*`) and wide strings:

| Macro                             | Description                          |
| -------------------------------- | ---------------------------------- |
| `EXPECT_STREQ(str1, str2)`       | Strings have identical contents     |
| `EXPECT_STRNE(str1, str2)`       | Strings have different contents     |
| `EXPECT_STRCASEEQ(str1, str2)`   | Case-insensitive equality           |
| `EXPECT_STRCASENE(str1, str2)`   | Case-insensitive inequality         |

Examples:

```cpp
EXPECT_STREQ("hello", ptr_to_hello);
EXPECT_STRCASEEQ("foo", "FOO");
EXPECT_STRNE(c_str1, c_str2);
```

Wildcards or substrings are not supported by these macros; for advanced string checks, use matchers with `EXPECT_THAT`.

---

## Floating-Point Comparisons

Special macros use tolerance to compare floating-point values safely:

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)`

They handle rounding and numerical errors gracefully.

Example:

```cpp
EXPECT_FLOAT_EQ(3.14159f, computed_value);
ASSERT_NEAR(0.0, some_result, 1e-5);
```

---

## Exception Assertions

Require exceptions enabled in your build environment. They verify whether code throws or does not throw exceptions:

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`

Example:

```cpp
EXPECT_THROW(DoDangerousStuff(), std::runtime_error);
ASSERT_NO_THROW(DoSafeStuff());
```

---

## Predicate Assertions

Enable more complex assertions with clearer failure messages by using predicates or predicate-formatters.

### Using Predicates

Predicates are functions or functors returning `bool` accepting arguments to test.

```cpp
bool IsPositive(int n) { return n > 0; }
EXPECT_PRED1(IsPositive, 42);
```

Variations exist for 1 to 5 arguments: `EXPECT_PRED1`, `EXPECT_PRED2`, ...

### Using Predicate-Formatters

More flexible than predicates, predicate-formatters return `AssertionResult` and craft detailed failure messages.

```cpp
::testing::AssertionResult IsEven(int n) {
  if ((n % 2) == 0) return ::testing::AssertionSuccess();
  return ::testing::AssertionFailure() << n << " is odd";
}

EXPECT_PRED_FORMAT1(IsEven, 5);  // Fails with message "5 is odd"
```

Use `EXPECT_PRED_FORMAT*()` macros.

### Why Use Them?

They improve diagnostic messages, especially for complex or expensive expressions.

---

## Assertion Placement

Assertions that generate fatal failures (`ASSERT_*` and `FAIL()`) must be placed in functions returning `void`. They cannot be used in constructors, destructors, or non-void functions without care.

Use `EXPECT_*` or `ADD_FAILURE` in non-void functions or constructors/destructors.

---

## Skipping Test Execution

The macro `GTEST_SKIP()` allows skipping a test at runtime meaningfully.

```cpp
TEST(SomeTest, ConditionalSkip) {
  if (environment_unavailable) {
    GTEST_SKIP() << "Skipping test due to environment.";
  }
  // rest of test
}
```

It can be used similarly inside fixtures during `SetUp()`.

---

## Logging Additional Information

You can record key-value properties during a test execution with `RecordProperty()` to enrich test reports.

```cpp
TEST_F(MyTest, RecordsProperties) {
  ::testing::Test::RecordProperty("MaxWidgets", ComputeMaxWidgets());
  ::testing::Test::RecordProperty("MinWidgets", ComputeMinWidgets());
}
```

These properties appear in XML/JSON output for later analysis.

---

## Customizing Failure Messages and Printing

GoogleTest prints assertion failures including expression content and variable values. For user-defined types, customize printing by defining:

- A friend `AbslStringify()` function template, or
- A `PrintTo()` function in the same namespace

Example:

```cpp
class Point {
  friend void PrintTo(const Point& p, std::ostream* os) {
    *os << "(" << p.x << ", " << p.y << ")";
  }
  int x, y;
};
```

These enable readable messages on assertion failure.

---

## Advanced Assertion Utilities

- `StaticAssertTypeEq<T1, T2>()` enables compile-time checks that two types are identical.
- Use `ASSERT_NO_FATAL_FAILURE(statement)` to verify that `statement` does not generate any fatal failures.
- Use `EXPECT_NO_FATAL_FAILURE(statement)` similarly for nonfatal failures.

---

## Death Tests

For testing that code terminates abnormally, see the Death Tests documentation page, which uses specialized assertion macros such as `EXPECT_DEATH` and `ASSERT_DEATH`.

---

## Examples

### Basic Assertion
```cpp
TEST(FactorialTest, HandlesZero) {
  EXPECT_EQ(Factorial(0), 1) << "Factorial of zero should be 1.";
}
```

### Predicate Formatter
```cpp
testing::AssertionResult IsEven(int n) {
  if ((n % 2) == 0)
    return testing::AssertionSuccess();
  else
    return testing::AssertionFailure() << n << " is odd";
}

TEST(NumberTest, EvenCheck) {
  EXPECT_PRED_FORMAT1(IsEven, 3);
}
```

Failure message:
```
Value of: IsEven(3)
  Actual: false (3 is odd)
Expected: true
```

### Skipping a Test at Runtime
```cpp
TEST(SkipExample, SkipsIfNoEnv) {
  if (!IsEnvReady()) {
    GTEST_SKIP() << "Environment not ready.";
  }
  // Test code here
}
```

---

For comprehensive lists of assertions, matchers, and death tests, consult the corresponding sections in the GoogleTest API Reference.


---

<AccordionGroup title="Assertion Macros Overview">
<Accordion title="Success and Failure">
- `SUCCEED()`  
- `FAIL()`  
- `ADD_FAILURE()`  
- `ADD_FAILURE_AT(file, line)`
</Accordion>
<Accordion title="Boolean Conditions">
- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`  
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`
</Accordion>
<Accordion title="Value Comparisons">
- `EXPECT_EQ`, `EXPECT_NE`, `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE`  
- `ASSERT_EQ`, `ASSERT_NE`, `ASSERT_LT`, `ASSERT_LE`, `ASSERT_GT`, `ASSERT_GE`
</Accordion>
<Accordion title="String Comparisons">
- `EXPECT_STREQ`, `EXPECT_STRNE`, `EXPECT_STRCASEEQ`, `EXPECT_STRCASENE`  
- `ASSERT_STREQ`, `ASSERT_STRNE`, `ASSERT_STRCASEEQ`, `ASSERT_STRCASENE`
</Accordion>
<Accordion title="Floating Point Comparisons">
- `EXPECT_FLOAT_EQ`, `ASSERT_FLOAT_EQ`  
- `EXPECT_DOUBLE_EQ`, `ASSERT_DOUBLE_EQ`  
- `EXPECT_NEAR`, `ASSERT_NEAR`
</Accordion>
<Accordion title="Exception Assertions">
- `EXPECT_THROW`, `ASSERT_THROW`  
- `EXPECT_ANY_THROW`, `ASSERT_ANY_THROW`  
- `EXPECT_NO_THROW`, `ASSERT_NO_THROW`
</Accordion>
<Accordion title="Predicate Assertions">
- `EXPECT_PRED*` and `EXPECT_PRED_FORMAT*`  
- `ASSERT_PRED*` and `ASSERT_PRED_FORMAT*`
</Accordion>
</AccordionGroup>

<AccordionGroup title="Support Types and Classes">
<Accordion title="AssertionResult">
Class representing the assertion outcome, success or failure message.
</Accordion>
<Accordion title="TestPartResult">
Represents a single assertion's outcome with file/line info.
</Accordion>
<Accordion title="TestProperty">
Key/value pairs logged during test execution for reporting.
</Accordion>
<Accordion title="TestResult">
Aggregates all assertion results for a single test.
</Accordion>
<Accordion title="TestInfo">
Information about a specific test, including name, file, line, results.
</Accordion>
<Accordion title="TestSuite">
Collection of related tests.
</Accordion>
<Accordion title="UnitTest">
Singleton representing the test program instance.
</Accordion>
<Accordion title="TestEventListener">
Interface to receive test execution events.
</Accordion>
<Accordion title="ScopedTrace">
Utility to add trace information on failures.
</Accordion>
</AccordionGroup>