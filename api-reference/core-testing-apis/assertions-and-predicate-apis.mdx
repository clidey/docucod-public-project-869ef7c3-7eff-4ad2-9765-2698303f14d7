---
title: "Assertions and Predicate APIs"
description: "Detailed reference and practical usage of all assertion macros and the flexible predicate facilities in GoogleTest. Covers equality, comparison, exception, and custom assertions, illustrating their diagnostic capabilities. Enables users to diagnose failures and create clear, expressive tests."
---

# Assertions and Predicate APIs

Detailed reference and practical usage of all assertion macros and the flexible predicate facilities in GoogleTest. Covers equality, comparison, exception, and custom assertions, illustrating their diagnostic capabilities. Enables users to diagnose failures and create clear, expressive tests.

---

## Overview

GoogleTest provides a comprehensive suite of assertion macros designed to verify the correctness of your C++ code during testing. These assertions help identify failures with informative diagnostics, supporting a wide variety of verification needs, including boolean conditions, value comparisons, exceptions, and complex predicates.

This page focuses on the assertion macros and flexible predicate mechanisms that enable you to write concise, precise tests with improved failure messages. It covers:

- Explicit success and failure assertions
- Boolean condition checks
- Binary and string comparisons
- Floating-point value comparisons
- Exception verification
- Predicate assertions with custom diagnostic messages
- Windows-specific HRESULT assertions
- Death assertions to verify program termination behavior

Throughout this documentation, you will find concrete examples and patterns to frame your testing logic effectively.

---

## Table of Contents

1. [Using Basic Assertions](#using-basic-assertions)
2. [Boolean Assertions](#boolean-assertions)
3. [Equality and Comparison Assertions](#equality-and-comparison-assertions)
4. [String Comparison Assertions](#string-comparison-assertions)
5. [Floating-Point Comparisons](#floating-point-comparisons)
6. [Exception Assertions](#exception-assertions)
7. [Predicate Assertions](#predicate-assertions)
8. [Windows HRESULT Assertions](#windows-hresult-assertions)
9. [Death Assertions](#death-assertions)
10. [Best Practices and Tips](#best-practices-and-tips)
11. [Troubleshooting Common Assertion Issues](#troubleshooting-common-assertion-issues)

---

## Using Basic Assertions

GoogleTest assertions come in pairs: `EXPECT_*` and `ASSERT_*`.

- `EXPECT_*` assertions generate nonfatal failures, allowing the test to continue and report multiple failures in one run.
- `ASSERT_*` assertions generate fatal failures that abort the current function immediately.

Example usage:

```cpp
ASSERT_EQ(x.size(), y.size()) << "Vectors have different sizes";
EXPECT_EQ(x[0], y[0]) << "Vectors differ at index 0";
```

You can stream custom messages to assertions with `<<`, providing context on failure.

### Explicitly Indicating Success or Failure

- `SUCCEED()` informs GoogleTest of an explicit success point in your test flow.
- `FAIL()` manually generates a failure and aborts the function. 
- `ADD_FAILURE()` adds a nonfatal failure.

Example:

```cpp
if (!CheckCondition()) {
  FAIL() << "Precondition failed";
}
```

---

## Boolean Assertions

### EXPECT_TRUE / ASSERT_TRUE

Verifies that a condition is true.

```cpp
EXPECT_TRUE(IsValid(value)) << "Value should be valid";
ASSERT_TRUE(x > 0);
```

If the condition is false, GoogleTest prints the condition and the actual result.

### EXPECT_FALSE / ASSERT_FALSE

Verifies that a condition is false.

```cpp
EXPECT_FALSE(IsEmpty(container));
ASSERT_FALSE(error_occurred);
```

---

## Equality and Comparison Assertions

These macros compare two values or pointers.

| Macro         | Description                              |
|---------------|------------------------------------------|
| EXPECT_EQ / ASSERT_EQ  | Verify that two values are equal (`==`).         |
| EXPECT_NE / ASSERT_NE  | Verify that two values are not equal (`!=`).     |
| EXPECT_LT / ASSERT_LT  | Verify that one value is less than another (`<`).|
| EXPECT_LE / ASSERT_LE  | Verify that one value is less than or equal (`<=`).|
| EXPECT_GT / ASSERT_GT  | Verify that one value is greater than another (`>`).|
| EXPECT_GE / ASSERT_GE  | Verify that one value is greater than or equal (`>=`).|

**Important Notes:**

- For pointer equality, `EXPECT_EQ` compares pointer addresses.
- To compare C strings by content, use string comparison assertions described below.
- Arguments are evaluated exactly once.

Example:

```cpp
EXPECT_EQ(foo, bar) << "foo and bar should be equal";
ASSERT_LT(value, max_limit);
```

---

## String Comparison Assertions

To compare C strings or wide C strings by content, not by address, use:

| Macro         | Description                                   |
|---------------|-----------------------------------------------|
| EXPECT_STREQ / ASSERT_STREQ | Verify two C strings have the same content.       |
| EXPECT_STRNE / ASSERT_STRNE | Verify two C strings have different content.      |
| EXPECT_STRCASEEQ / ASSERT_STRCASEEQ | Verify two C strings have the same content ignoring case. |
| EXPECT_STRCASENE / ASSERT_STRCASENE | Verify two C strings differ ignoring case.         |

Example:

```cpp
EXPECT_STREQ("hello", actual_c_string);
ASSERT_STRCASEEQ("FOO", "foo");
```

Wide strings (`wchar_t*`) are supported in equivalent macros and failure messages are printed as UTF-8.

---

## Floating-Point Comparisons

Due to precision and rounding errors, comparing floating-point numbers using `EXPECT_EQ` is unreliable.

GoogleTest offers specialized assertions:

| Macro              | Description                                           |
|--------------------|-------------------------------------------------------|
| EXPECT_FLOAT_EQ / ASSERT_FLOAT_EQ | Approximately equal floats (within 4 ULPs)          |
| EXPECT_DOUBLE_EQ / ASSERT_DOUBLE_EQ | Approximately equal double-precision floats (within 4 ULPs) |
| EXPECT_NEAR / ASSERT_NEAR | Verifies difference within an absolute error margin    |

Example:

```cpp
EXPECT_FLOAT_EQ(3.14f, computed_value);
ASSERT_NEAR(expected, actual, 0.01);
```

---

## Exception Assertions

These macros verify exception throwing behavior. Exceptions must be enabled to use these.

| Macro               | Description                              |
|---------------------|------------------------------------------|
| EXPECT_THROW / ASSERT_THROW | Verifies a statement throws a specific exception type. |
| EXPECT_ANY_THROW / ASSERT_ANY_THROW | Verifies a statement throws any exception.        |
| EXPECT_NO_THROW / ASSERT_NO_THROW | Verifies a statement does not throw any exception.  |

Example:

```cpp
ASSERT_THROW(Foo(), std::runtime_error);
EXPECT_NO_THROW(DoWork());
```

Compound statements can be wrapped with braces `{ ... }`.

---

## Predicate Assertions

Predicate assertions verify complex conditions and produce clearer diagnostic messages by printing argument values when failures occur.

### Basic Predicate Assertions

Macros `EXPECT_PREDn` and `ASSERT_PREDn` for n=1..5 verify that a predicate function or functor returns `true` for the given arguments.

Example:

```cpp
bool IsEven(int n) { return (n % 2) == 0; }

EXPECT_PRED1(IsEven, 4);  // Succeeds
EXPECT_PRED2(IsMutuallyPrime, a, b);  // Custom binary predicate
```

**Important:** When predicates are overloaded or templates, explicit type casts may be necessary.

### Predicate-Formatter Assertions

For advanced use cases where you want to customize failure messages, use `EXPECT_PRED_FORMATn` and `ASSERT_PRED_FORMATn`. These take a predicate-formatter function or functor that accepts source expressions and values and returns a `testing::AssertionResult` which can contain rich, formatted messages.

Example:

```cpp
AssertionResult AssertIsEven(const char* expr, int n) {
  if (n % 2 == 0) return AssertionSuccess();
  return AssertionFailure() << expr << " evaluates to " << n << ", which is not even.";
}

EXPECT_PRED_FORMAT1(AssertIsEven, 5);  // Prints informative failure
```

### Supported Arity

GoogleTest supports predicates up to 5 arguments in both predicate and predicate-formatter form.

---

## Windows HRESULT Assertions

Specific assertions to verify success or failure of Windows `HRESULT` return codes.

| Macro                       | Description                                        |
|-----------------------------|----------------------------------------------------|
| EXPECT_HRESULT_SUCCEEDED / ASSERT_HRESULT_SUCCEEDED | Verify `HRESULT` indicates success.               |
| EXPECT_HRESULT_FAILED / ASSERT_HRESULT_FAILED       | Verify `HRESULT` indicates failure.               |

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

Failure messages include human-readable error descriptions when available.

---

## Death Assertions

Death assertions verify that a statement causes the program to terminate (crash, abort, exit).

| Macro              | Description                                                                   |
|--------------------|-------------------------------------------------------------------------------|
| EXPECT_DEATH / ASSERT_DEATH | Verify that statement causes process to die with expected output and exit code. |
| EXPECT_DEATH_IF_SUPPORTED / ASSERT_DEATH_IF_SUPPORTED | Like above, but silently ignores if death tests not supported.                 |
| EXPECT_DEBUG_DEATH / ASSERT_DEBUG_DEATH | Like EXPECT_DEATH but only in debug builds.                                |
| EXPECT_EXIT / ASSERT_EXIT | Verify statement terminates process with exit status and output matching criteria |

Example:

```cpp
EXPECT_DEATH(Foo(), "Error message regex");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

**Important:** Death tests run code in a subprocess to isolate failures.

---

## Best Practices and Tips

- Use `EXPECT_*` assertions when it is safe to continue test execution after failure to collect multiple errors.
- Use `ASSERT_*` to abort a test early when continuation is meaningless or dangerous.
- Predicate assertions and predicate-formatter assertions provide clearer failure messages when complex conditions are evaluated, avoid excessive use of `EXPECT_TRUE` with custom messages.
- When writing custom assertions, consider using `testing::AssertionResult` for rich messages.
- Prefer `EXPECT_STREQ` for C strings, not `EXPECT_EQ`.
- Be mindful of arity limitations of predicate assertions (max 5).
- Use `GTEST_SKIP()` to skip tests dynamically when preconditions are not met.

---

## Troubleshooting Common Assertion Issues

### Assertions Not Aborting Loops/Functions

Remember `ASSERT_*` macros abort the current function, not the whole test execution. If assertions are inside helper functions, the calling function must check the result via `HasFatalFailure()` or use `ASSERT_NO_FATAL_FAILURE()`.

### Predicate Assertion Type Errors

If using overloaded or templated predicates with predicate assertions, explicit type casting may be necessary for the compiler to resolve correct overload.

### Unexpected Failures with Floating-Point Assertions

Check if you're using `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR` correctly; understand that exact equality is not guaranteed for floating-point.

### Death Tests Fail to Detect Termination

Ensure the death test statement terminates the process and does not throw exceptions, returns normally, or calls `ASSERT_*` which only abort the current function.

---

## Related Documentation

- [GoogleTest Primer](../primer.md) – For getting started and learning core concepts.
- [Assertions Reference](reference/assertions.md) – For the full list of assertion macros.
- [Using Assertions Effectively Guide](../guides/core-workflows/using-assertions.md) – For strategies on using assertions.
- [Advanced GoogleTest Topics](../advanced.md#predicate-assertions-for-better-error-messages) – For more on predicate assertions and AssertionResult.
- [Matchers Reference](matchers.md) – To use matchers with `EXPECT_THAT`.

---

## Code Examples

```cpp
// Basic Boolean and equality assertions
TEST(FooTest, BasicCheck) {
  int x = 5;
  int y = 10;

  EXPECT_TRUE(x < y) << "x should be less than y";
  EXPECT_EQ(x + 5, y);
}

// Using predicate assertion for a unary predicate
bool IsEven(int n) {
  return (n % 2) == 0;
}

TEST(FooTest, PredicateCheck) {
  int val = 4;
  EXPECT_PRED1(IsEven, val);
}

// Using predicate-formatter assertion
testing::AssertionResult AssertIsEven(const char* expr, int n) {
  if ((n % 2) == 0) return testing::AssertionSuccess();

  return testing::AssertionFailure() << expr << " evaluates to " << n << ", which is not even.";
}

TEST(FooTest, PredicateFormatterCheck) {
  int val = 5;
  EXPECT_PRED_FORMAT1(AssertIsEven, val);
}

// Exception assertions
TEST(FooTest, ExceptionCheck) {
  EXPECT_THROW(ThrowInvalidArgument(), std::invalid_argument);
  EXPECT_NO_THROW(SafeFunction());
}

// Death test example
TEST(FooDeathTest, DeathOnNullPointer) {
  EXPECT_DEATH({
    int* p = nullptr;
    *p = 42;  // Should terminate the process
  }, "segmentation fault");
}
```

---

## Summary

This page equips you with detailed knowledge of the assertion and predicate APIs in GoogleTest, enabling precise and expressive verifications in your tests. By understanding and applying these macros and patterns—including predicate-formatter assertions for customized diagnostics—you will create tests that are both powerful and readable, making failure investigations straightforward.

---

<AccordionGroup title="Assertion Macro Cheat Sheet">
<Accordion title="Boolean Assertions">
- `EXPECT_TRUE(condition)`
- `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)`
- `ASSERT_FALSE(condition)`
</Accordion>
<Accordion title="Equality and Comparison Assertions">
- `EXPECT_EQ(val1, val2)`
- `ASSERT_EQ(val1, val2)`
- `EXPECT_NE(val1, val2)`
- `ASSERT_NE(val1, val2)`
- `EXPECT_LT(val1, val2)`
- `ASSERT_LT(val1, val2)`
- `EXPECT_LE(val1, val2)`
- `ASSERT_LE(val1, val2)`
- `EXPECT_GT(val1, val2)`
- `ASSERT_GT(val1, val2)`
- `EXPECT_GE(val1, val2)`
- `ASSERT_GE(val1, val2)`
</Accordion>
<Accordion title="String Comparison Assertions">
- `EXPECT_STREQ(str1, str2)`
- `ASSERT_STREQ(str1, str2)`
- `EXPECT_STRNE(str1, str2)`
- `ASSERT_STRNE(str1, str2)`
- `EXPECT_STRCASEEQ(str1, str2)` (case insensitive)
- `ASSERT_STRCASEEQ(str1, str2)`
- `EXPECT_STRCASENE(str1, str2)`
- `ASSERT_STRCASENE(str1, str2)`
</Accordion>
<Accordion title="Floating-Point Assertions">
- `EXPECT_FLOAT_EQ(val1, val2)`
- `ASSERT_FLOAT_EQ(val1, val2)`
- `EXPECT_DOUBLE_EQ(val1, val2)`
- `ASSERT_DOUBLE_EQ(val1, val2)`
- `EXPECT_NEAR(val1, val2, abs_error)`
- `ASSERT_NEAR(val1, val2, abs_error)`
</Accordion>
<Accordion title="Exception Assertions">
- `EXPECT_THROW(statement, exception_type)`
- `ASSERT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)`
- `ASSERT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)`
- `ASSERT_NO_THROW(statement)`
</Accordion>
<Accordion title="Predicate Assertions">
- `EXPECT_PREDn(predicate, args...)` for up to 5 arguments
- `ASSERT_PREDn(predicate, args...)`
- `EXPECT_PRED_FORMATn(formatter, args...)` for custom messages
- `ASSERT_PRED_FORMATn(formatter, args...)`
</Accordion>
<Accordion title="Death Assertions">
- `EXPECT_DEATH(statement, regex)`
- `ASSERT_DEATH(statement, regex)`
- `EXPECT_EXIT(statement, predicate, regex)`
- `ASSERT_EXIT(statement, predicate, regex)`
</Accordion>
</AccordionGroup>

---

## Additional Resources

- [GoogleTest Primer](../primer.md) for basics and getting started.
- [Assertions Reference](reference/assertions.md) for complete macro details and examples.
- [Using Assertions Effectively](../guides/core-workflows/using-assertions.md) for best usage practices.
- [Advanced GoogleTest Topics on Predicate Assertions](../advanced.md#predicate-assertions-for-better-error-messages) for extending assertions with `AssertionResult`.
- [Matchers Reference](matchers.md) for powerful rich matchers used with `EXPECT_THAT`.

---

<style>
  pre { background-color: #f8f8f8; padding: 12px; border-radius: 4px; overflow-x: auto; }
  code { font-family: monospace; }
</style>
