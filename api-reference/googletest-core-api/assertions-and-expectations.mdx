---
title: "Assertions and Expectations"
description: "Outlines all the assertion macros and result types, from basic checks like EXPECT_TRUE/FALSE to advanced predicate and failure reporting. Helps users select the most appropriate assertion type, includes messaging, and demonstrates rich failure outputs."
---

# Assertions and Expectations Reference

This documentation outlines the comprehensive set of assertion macros and result types provided by GoogleTest. It guides you through selecting the appropriate assertion type—from basic Boolean checks like `EXPECT_TRUE` and `EXPECT_FALSE` to advanced predicate assertions and rich failure messaging—empowering you to write robust, expressive tests. You will also learn how GoogleTest reports failures, enabling quick diagnosis and resolution.

---

## 1. Overview of Assertions

Assertions are your primary tool for verifying code correctness in tests. GoogleTest provides two categories of assertion macros:

- **`EXPECT_` macros** generate nonfatal failures, allowing tests to continue execution after failure.
- **`ASSERT_` macros** generate fatal failures, which abort the current function immediately.

Both types support streaming custom failure messages to provide additional context when a check fails.

Example usage:

```cpp
EXPECT_TRUE(condition) << "Condition failed: " << additional_info;
ASSERT_EQ(value1, value2) << "Values not equal";
```

### Key Behavior

- Use `EXPECT_` assertions when you want tests to continue after failure and report all issues.
- Use `ASSERT_` assertions when failure invalidates further test logic (e.g., null pointers to dereference).


## 2. Assertion Macros by Category

### 2.1 Explicit Success and Failure

- `SUCCEED()` marks a test as successful explicitly; used for documentation, it currently produces no visible output.
- `FAIL()` and `ADD_FAILURE()` generate fatal and nonfatal failures respectively.
- `ADD_FAILURE_AT(file, line)` generates nonfatal failures at specific locations.

Example:

```cpp
if (unexpected_case) {
  FAIL() << "Unexpected case reached.";
}
```

### 2.2 Boolean Condition Assertions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` verify that `condition` is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` verify that `condition` is false.

### 2.3 Binary Comparison Assertions

- These macros compare two values (`EXPECT_EQ`, `EXPECT_NE`, `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE`) and print detailed messages on failure showing expected vs actual values.
- Use `ASSERT_` variants for fatal checks.

Example:

```cpp
EXPECT_EQ(x, y) << "x and y differ";
```

**Note:** Use `EXPECT_STREQ` instead when comparing C strings for content equality.

### 2.4 String Comparison Assertions

Specialized macros for comparing C-style and wide character strings:

- `EXPECT_STREQ` / `ASSERT_STREQ`: expect equal strings.
- `EXPECT_STRNE` / `ASSERT_STRNE`: expect unequal strings.
- Case-insensitive variants: `EXPECT_STRCASEEQ` / `ASSERT_STRCASEEQ` and `EXPECT_STRCASENE` / `ASSERT_STRCASENE`.

### 2.5 Floating-Point Comparison Assertions

Floating-point values are tricky due to rounding; GoogleTest provides:

- `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ` for approximate equality with 4 ULP tolerance.
- `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ` for double precision.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` to specify custom absolute error bounds.

### 2.6 Exception Assertions

Verify that code throws or does not throw exceptions (requires exception support):

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW`
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW`
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW`

### 2.7 Predicate Assertions

These assertions improve failure messages when testing custom predicates:

- `EXPECT_PRED*` and `ASSERT_PRED*` (where `*` is the number of predicate arguments, 1 to 5) check predicates returning `bool`.
- `EXPECT_PRED_FORMAT*` and `ASSERT_PRED_FORMAT*` allow predicates to return `testing::AssertionResult` for richer messages.

Example:

```cpp
bool IsPrime(int n);
EXPECT_PRED1(IsPrime, value);
```

### 2.8 Windows HRESULT Assertions

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED`: verify success HRESULTs.
- `EXPECT_HRESULT_FAILED(expression)` / `ASSERT_HRESULT_FAILED`: verify failure HRESULTs with meaningful message.

### 2.9 Death Assertions

Verify that code terminates or crashes as expected:

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH`
- `EXPECT_DEATH_IF_SUPPORTED` / `ASSERT_DEATH_IF_SUPPORTED`
- `EXPECT_DEBUG_DEATH` / `ASSERT_DEBUG_DEATH`
- `EXPECT_EXIT(statement, predicate, matcher)` / `ASSERT_EXIT`

These run the statement in a subprocess and check for termination and matching output.


## 3. Advanced Usage and Best Practices

### 3.1 Streaming Custom Failure Messages

You can append detailed diagnostics to any assertion via streaming:

```cpp
EXPECT_EQ(foo, bar) << "foo and bar differ, foo=" << foo << ", bar=" << bar;
```

### 3.2 Single Evaluation Guarantee

All assertion macro arguments are evaluated exactly once. This ensures safe usage even with expressions having side effects.

### 3.3 Writing Custom Predicates and Predicate-Formatters

To get richer failure messages, write predicates returning `testing::AssertionResult` and use the `EXPECT_PRED_FORMAT*` macros.

### 3.4 Using Matchers for Expressive Tests

For complex value validation, use `EXPECT_THAT(value, matcher)` with GoogleMock matchers (`Eq()`, `StartsWith()`, `AllOf()`, etc.) for readable, flexible tests and helpful failure reports.

### 3.5 Proper Use of `ASSERT_` vs `EXPECT_`

- Use `ASSERT_` to guard test continuation when further steps depend on prior conditions—for example, pointer dereferencing.
- Use `EXPECT_` when failures should not abort the current test, allowing multiple checks per test.

### 3.6 Avoiding Over-Specification

Write assertions that verify behavior contracts but avoid overspecifying internal details that may cause fragile tests.

### 3.7 Assertion Placement

Fatal assertions can only be used in void functions; use nonfatal in non-void. Also, avoid placing fatal assertions in constructors and destructors.

### 3.8 Handling Exceptions within Assertions

GoogleTest supports assertions inside exception handlers and can assert on exceptions thrown from code.

### 3.9 Skipping Tests

Use `GTEST_SKIP()` to conditionally skip tests during execution, optionally with a message.


## 4. Common Failure Scenarios and Troubleshooting

- **Unexpected Values:** Use predicate assertions or custom matchers to identify why a value doesn't meet expectations.
- **Assertion Failures in Subroutines:** Use `SCOPED_TRACE` to attach context to assertions deep in call stacks.
- **Multiple Failures:** Prefer `EXPECT_` to reveal more than one failure in a single test.
- **Failures that Abort Too Early:** Use `ASSERT_NO_FATAL_FAILURE` or exception-based approaches to propagate fatal failures when needed.


## 5. Code Examples

### Basic Boolean Assertion

```cpp
TEST(SimpleTest, IsTrue) {
  EXPECT_TRUE(IsActive());
  ASSERT_FALSE(IsError());
}
```

### Equality Assertion with Custom Message

```cpp
TEST(ValueTest, EqualCheck) {
  int expected = 5;
  int actual = ComputeValue();
  EXPECT_EQ(expected, actual) << "ComputeValue() returned " << actual << ", expected " << expected;
}
```

### Floating Point Comparison

```cpp
TEST(FloatingTest, ApproxEqual) {
  double val1 = 0.1 + 0.2;
  double val2 = 0.3;
  EXPECT_DOUBLE_EQ(val1, val2);
}
```

### Predicate Assertion

```cpp
bool IsSorted(const std::vector<int>& v);
TEST(SortedTest, CheckOrdering) {
  std::vector<int> data = {1, 2, 3};
  EXPECT_PRED1(IsSorted, data);
}
```

### Exception Assertion

```cpp
TEST(ExceptionTest, ThrowsOnBadInput) {
  EXPECT_THROW(DoSomething(-1), std::invalid_argument);
}
```

### Death Assertion

```cpp
TEST(DeathTest, CrashesOnFatal) {
  EXPECT_DEATH(AbortFunction(), "Fatal error");
}
```


## 6. Related Documentation and Next Steps

- See the [Assertions Reference](reference/assertions.md) for a complete list of assertion macros.
- Use [Using Assertions Effectively](guides/core-testing-workflows/using-assertions-effectively.mdx) to master best practices.
- Combine assertions with [Matchers API](api-reference/googletest-core-api/matchers-api.mdx) for expressive validations.
- Use [gMock for Dummies](docs/gmock_for_dummies.md) for mocking and predicate-driven assertions.

---

This page fits within the GoogleTest Core API Reference and complements foundational pages like the [Architecture Overview](overview/architecture-and-key-concepts/architecture-overview) and the [Assertions Reference](reference/assertions.md).


<Accordion title="Troubleshooting Common Assertion Failures">

### Problem: Assertion Fails but Values Appear Correct

- **Cause:** The equality operator may behave unexpectedly or types are not streaming well.
- **Solution:** Use custom matchers or override streaming operators for better diagnostics.

### Problem: Floating-Point Assertion Fails Due to Rounding

- **Tip:** Prefer `EXPECT_NEAR` or `EXPECT_FLOAT_EQ` over `EXPECT_EQ`.

### Problem: Fatal Failures Do Not Abort Test as Expected

- Ensure that fatal assertions appear only in void-returning functions or test bodies.
- Use `ASSERT_NO_FATAL_FAILURE` when calling subroutines with assertions.

### Problem: Exceptions Not Detected

- Confirm exception handling is enabled in your build.
- Use `EXPECT_THROW` and related macros correctly.

</Accordion>

<Accordion title="Assert Macros Summary">
| Macro | Behavior | Description |
|---|---|---|
| `EXPECT_TRUE(cond)` | Nonfatal failure if `cond` is false | Checks Boolean condition is true |
| `ASSERT_TRUE(cond)` | Fatal failure if `cond` is false | Checks Boolean condition is true and aborts current function on failure |
| `EXPECT_FALSE(cond)` | Nonfatal failure if `cond` is true | Checks Boolean condition is false |
| `ASSERT_FALSE(cond)` | Fatal failure if `cond` is true | Checks Boolean condition is false and aborts current function on failure |
| `EXPECT_EQ(val1, val2)` | Nonfatal failure if inequality | Checks equality of two values |
| `ASSERT_EQ(val1, val2)` | Fatal failure if inequality | Checks equality of two values and aborts current function on failure |
| ... | ... | ... |
| `EXPECT_THROW(statement, exception_type)` | Checks code throws the expected exception |
| `EXPECT_DEATH(statement, regex)` | Checks code causes process to die with output matching regex |
</Accordion>

## 7. Practical Tips

- Use `EXPECT_*` as the default assertions.
- Use `ASSERT_*` when further test execution depends on success.
- Stream custom diagnostic messages to improve failure analysis.
- Use predicate assertions for checking complex properties with detailed failure reports.
- Leverage matchers (`EXPECT_THAT`) to express rich and expressive conditions.
- Use death tests to validate fatal error conditions.

---

GoogleTest provides a powerful, consistent, and expressive assertion framework helping developers write reliable and maintainable tests that are easy to debug and understand.


---

## Related Links

- [Assertions Reference](reference/assertions.md): Full catalog of assertions.
- [Using Assertions Effectively](guides/core-testing-workflows/using-assertions-effectively.mdx): Best practices and advanced usage.
- [Matchers API](api-reference/googletest-core-api/matchers-api): Integrating matchers with assertions for flexible validation.
- [gMock for Dummies](docs/gmock_for_dummies.md): Introduction to mocking and predicate-driven tests.
- [Architecture Overview](overview/architecture-and-key-concepts/architecture-overview): Understanding where assertions fit in GoogleTest architecture.
