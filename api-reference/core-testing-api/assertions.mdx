---
title: "Assertions and Expectations"
description: "Detailed guide to all built-in assertions, including value, exception, fatal and non-fatal checks. Documents macros, usage patterns, and extension points for custom assertions. Helps users select the most appropriate assertion style for various testing scenarios."
---

# Assertions and Expectations

This documentation provides a detailed guide to the built-in assertions available in GoogleTest. It covers value assertions, exception assertions, fatal and non-fatal checks, and best practices for writing robust tests. This guide helps you select the most appropriate assertion style for various testing scenarios and extend assertions where needed.

---

## 1. Introduction to Assertions

Assertions are the cornerstone of test verification in GoogleTest. They allow you to check that conditions hold true during test execution, and their results determine whether a test passes or fails.

- **Fatal assertions**, such as `ASSERT_*`, immediately abort the current function on failure, preventing further execution.
- **Non-fatal assertions**, such as `EXPECT_*`, record failures but allow the test function to continue.

GoogleTest offers a rich set of macros designed to verify values, compare objects, check exception behavior, and verify boolean conditions.

<Note>
Use assertions to clearly express your test's expected outcomes. Choose between fatal and non-fatal assertions based on whether further test steps should proceed after a check.
</Note>

---

## 2. Basic Assertion Macros

| Macro       | Description                                             | Fatal/Non-Fatal |
|-------------|---------------------------------------------------------|----------------|
| `ASSERT_TRUE(condition)` | Checks that `condition` is `true`                   | Fatal          |
| `EXPECT_TRUE(condition)` | Checks that `condition` is `true`                   | Non-Fatal      |
| `ASSERT_FALSE(condition)`| Checks that `condition` is `false`                  | Fatal          |
| `EXPECT_FALSE(condition)`| Checks that `condition` is `false`                  | Non-Fatal      |
| `ASSERT_EQ(val1, val2)`  | Checks equality between `val1` and `val2`            | Fatal          |
| `EXPECT_EQ(val1, val2)`  | Checks equality between `val1` and `val2`            | Non-Fatal      |
| `ASSERT_NE(val1, val2)`  | Checks inequality between `val1` and `val2`          | Fatal          |
| `EXPECT_NE(val1, val2)`  | Checks inequality between `val1` and `val2`          | Non-Fatal      |
| `ASSERT_LT(val1, val2)`  | Checks if `val1 < val2`                               | Fatal          |
| `EXPECT_LT(val1, val2)`  | Checks if `val1 < val2`                               | Non-Fatal      |
| `ASSERT_LE(val1, val2)`  | Checks if `val1 <= val2`                              | Fatal          |
| `EXPECT_LE(val1, val2)`  | Checks if `val1 <= val2`                              | Non-Fatal      |
| `ASSERT_GT(val1, val2)`  | Checks if `val1 > val2`                               | Fatal          |
| `EXPECT_GT(val1, val2)`  | Checks if `val1 > val2`                               | Non-Fatal      |
| `ASSERT_GE(val1, val2)`  | Checks if `val1 >= val2`                              | Fatal          |
| `EXPECT_GE(val1, val2)`  | Checks if `val1 >= val2`                              | Non-Fatal      |

### Usage Example
```cpp
TEST(StackTest, BasicAssertions) {
  Stack stack;
  ASSERT_TRUE(stack.IsEmpty());

  stack.Push(42);
  EXPECT_FALSE(stack.IsEmpty());
  EXPECT_EQ(42, stack.Top());
  EXPECT_NE(43, stack.Top());
}
```

<Info>
Prefer `EXPECT_*` when partial test execution can still yield valuable feedback; prefer `ASSERT_*` to stop impossible further testing.
</Info>

---

## 3. Exception Assertions

Sometimes, you want to verify that a piece of code throws or does not throw exceptions.

| Macro               | Description                                            |
|---------------------|--------------------------------------------------------|
| `ASSERT_THROW(statement, exception_type)` | Asserts `statement` throws the specified exception (Fatal) |
| `EXPECT_THROW(statement, exception_type)` | Same as above but Non-fatal                   |
| `ASSERT_NO_THROW(statement)`               | Asserts `statement` does NOT throw an exception       |
| `EXPECT_NO_THROW(statement)`               | Same as above but Non-fatal                   |

### Example
```cpp
ASSERT_THROW(Foo().Bar(), std::runtime_error);
EXPECT_NO_THROW(DoSomething());
```

<Note>
Exception assertions ensure your code under test correctly signals error conditions, supporting robust error handling practices.
</Note>

---

## 4. Understanding Fatal vs Non-Fatal Assertions

- **Fatal Assertions (`ASSERT_*`)**
  - Abort the current function immediately upon failure.
  - Prevents further code execution which relies on the assertion.
  - Use when subsequent test steps are meaningless if the check fails.

- **Non-Fatal Assertions (`EXPECT_*`)**
  - Allow test execution to continue after failure.
  - Useful for checking multiple independent conditions in a single test.

<Callout>
Choosing between fatal and non-fatal assertions influences test robustness and failure pinpointing. Err on the side of fatal when a failure invalidates further test logic.
</Callout>

---

## 5. Assertion Variants for String Comparisons

GoogleTest provides specialized assertions and matchers for string comparisons, which improve error messages by showing differences clearly.

- Use `EXPECT_STREQ(expected, actual)` and `ASSERT_STREQ(expected, actual)` for C strings (null-terminated `char*`).
- Use `EXPECT_STRNE` for checking non-equality of C strings.
- For `std::string`, use the generic `EXPECT_EQ` but prefer `EXPECT_THAT` with string matchers (see [Matchers Reference](/api-reference/matchers-assertions/core-matchers)).

### Example
```cpp
EXPECT_STREQ("hello", foo.CStringResult());
ASSERT_STRNE("bye", foo.CStringResult());
EXPECT_EQ("world", foo.StringResult());
```

---

## 6. Using `EXPECT_THAT` with Matchers

`EXPECT_THAT(value, matcher);` combines value checking with flexible matchers and provides expressive assertions.

Example:
```cpp
using ::testing::Contains;
using ::testing::HasSubstr;

EXPECT_THAT(my_vector, Contains(42));
EXPECT_THAT(my_string, HasSubstr("world"));
```

Matchers allow complex conditions like partial ordering, subset matching, predicate matching, and much more.

See [Built-in Matchers](../matchers-assertions/core-matchers.md) for details.

---

## 7. Writing Custom Assertions

Users can create custom assertion macros or functions by using the `ASSERT_PRED`, `EXPECT_PRED` macros, or by writing functions returning `::testing::AssertionResult`.

Example custom predicate assertion:
```cpp
::testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) return ::testing::AssertionSuccess();
  else return ::testing::AssertionFailure() << n << " is odd";
}

TEST(MyTest, CustomAssertion) {
  EXPECT_PRED_FORMAT1(IsEven, 4);
}
```

---

## 8. Best Practices and Common Pitfalls

- Set expectations and assertions **before** exercising the code under test.
- Avoid overly strict expectations that break when implementation details change.
- Use `EXPECT_*` when multiple related conditions should be checked in one test.
- Use `ASSERT_*` when failed checks prevent meaningful further testing.
- Prefer expressive matchers with `EXPECT_THAT` over raw `EXPECT_EQ` for clarity.
- Do not mock or assert on internal implementation detailsâ€”focus on observable behavior.
- Use `ASSERT_THROW` and `EXPECT_THROW` to verify error conditions robustly.

---

## 9. Troubleshooting Common Assertion Issues

- **Tests fail due to incorrect argument types in assertions:** Ensure types exactly match or use suitable matchers.
- **Fatal assertion prevents useful error info:** When possible, replace with `EXPECT_*` to gather multiple failure points.
- **Unexpected exceptions during tests:** Use exception assertions to refine test behavior.
- **Assertion failure messages not informative:** Use matchers and custom messages for clarity.

---

## 10. Summary

Assertions are fundamental to expressing test expectations and controlling test flow in GoogleTest. By choosing the appropriate assertions, employing matchers, and following sound test design, you can write clear, maintainable, and effective tests that catch bugs early and provide actionable diagnostics.

---

## 11. References and Further Reading

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [Matchers Reference](../matchers-assertions/core-matchers.md)
- [Custom Matchers and Assertions](../guides/advanced-testing/custom-matchers-and-assertions.md)
- [Mocking with GoogleMock](../guides/advanced-testing/mocking-with-googlemock.md)
- [gMock Cheat Sheet](../docs/gmock_cheat_sheet.md)
- [gMock Cookbook](../docs/gmock_cook_book.md)

---

## 12. Example: Combining Assertions in a Test

```cpp
TEST(FooTest, CombinedAssertions) {
  Foo foo;
  ASSERT_FALSE(foo.HasErrors()) << "Precondition failed";

  int value = foo.Compute(5);
  EXPECT_GE(value, 0) << "Value should be non-negative";

  std::string result = foo.GetResult();
  EXPECT_THAT(result, HasSubstr("success"));
}
```

---

<Callout>
Remember: effective use of assertions improves test reliability and debugging speed. Choose assertion types and styles always grounded in user intent and the test goal.
</Callout>
