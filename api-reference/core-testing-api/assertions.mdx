---
title: "Assertions"
description: "Reference for built-in and custom assertion macros, explaining their usage, result types, and error reporting. Covers fatal and non-fatal failure options, custom predicate assertions, and construction of domain-specific checks for robust test validation."
---

# Assertions Reference

This page provides an authoritative reference for the built-in and custom assertion macros available in GoogleTest, empowering you to verify your C++ code's behavior confidently. To access these assertion macros in your tests, include the header:

```cpp
#include <gtest/gtest.h>
```

---

## Overview of Assertion Behaviors

GoogleTest assertion macros generally come in pairs:

- **`EXPECT_`** variants: generate **nonfatal failures**, allowing the current test function to continue running even if the assertion fails.
- **`ASSERT_`** variants: generate **fatal failures**, immediately aborting the current test function when the assertion fails.

This pairing enables you to control whether a test continues or stops upon encountering a failed assertion, supporting flexible and robust test flows.

### Custom Failure Messages

All assertion macros support streaming additional messages using the `<<` operator. This allows you to provide context or diagnostics when an assertion fails:

```cpp
EXPECT_TRUE(my_condition) << "Condition check failed, expected true.";
```

You can stream any value or object that supports streaming to a standard C++ `ostream`, including strings and string literals. Wide character strings are automatically converted to UTF-8 for safe output.

---

## Explicit Success and Failure Assertions

Sometimes your test logic requires explicitly reporting success or failure without testing a value. These macros facilitate that:

### `SUCCEED()`

```cpp
SUCCEED();
```

- Marks a success explicitly.
- Does **not** cause the overall test to be successful by itself. A test passes only if no assertions fail.
- Primarily useful as documentation or to mark that a particular code path was reached.

### `FAIL()`

```cpp
FAIL();
```

- Generates a **fatal failure** immediately, aborting the current function.
- Can only be used in `void`-returning functions.

Example:

```cpp
switch(expression) {
  case 1:
    ... // checks
    break;
  case 2:
    ... // other checks
    break;
  default:
    FAIL() << "Unexpected value: " << expression;
}
```

### `ADD_FAILURE()`

```cpp
ADD_FAILURE();
```

- Generates a **nonfatal failure**, allowing execution to continue.

### `ADD_FAILURE_AT(file, line)`

```cpp
ADD_FAILURE_AT("foo.cc", 42);
```

- Generates a **nonfatal failure** reported at a specific file and line number.
- Useful when logging a failure from a location other than the current source location.

---

## Generalized Assertions with Matchers

Leverage the expressive power of [GoogleMock matchers](matchers.md) for detailed, readable assertions.

### `EXPECT_THAT(value, matcher)` and `ASSERT_THAT(value, matcher)`

These macros assert that the given `value` satisfies the provided matcher.

```cpp
#include <gmock/gmock.h>
using ::testing::StartsWith;

EXPECT_THAT(my_string, StartsWith("Hello"));
ASSERT_THAT(my_vector, ::testing::ElementsAre(1, 2, 3));
```

Matchers produce expressive failure messages, helping you understand assertion failures quickly.

---

## Boolean Condition Assertions

Check simple true/false conditions explicitly.

| Macro            | Description                           |
|------------------|-------------------------------------|
| `EXPECT_TRUE(cond)`  | Verifies that `cond` is true.        |
| `ASSERT_TRUE(cond)`  | Fatal version of `EXPECT_TRUE`.      |
| `EXPECT_FALSE(cond)` | Verifies that `cond` is false.       |
| `ASSERT_FALSE(cond)` | Fatal version of `EXPECT_FALSE`.     |

Example:

```cpp
EXPECT_TRUE(IsValid(input));
ASSERT_FALSE(has_error);
```

---

## Binary Comparison Assertions

These assertions compare two values and verify relational properties. Arguments are evaluated exactly once to avoid side effects.

| Macro          | Meaning                              |
|----------------|------------------------------------|
| `EXPECT_EQ(a, b)`  | `a == b`                          |
| `ASSERT_EQ(a, b)`  | Fatal version of `EXPECT_EQ`.    |
| `EXPECT_NE(a, b)`  | `a != b`                          |
| `ASSERT_NE(a, b)`  | Fatal version of `EXPECT_NE`.    |
| `EXPECT_LT(a, b)`  | `a < b`                           |
| `ASSERT_LT(a, b)`  | Fatal version of `EXPECT_LT`.    |
| `EXPECT_LE(a, b)`  | `a <= b`                          |
| `ASSERT_LE(a, b)`  | Fatal version of `EXPECT_LE`.    |
| `EXPECT_GT(a, b)`  | `a > b`                           |
| `ASSERT_GT(a, b)`  | Fatal version of `EXPECT_GT`.    |
| `EXPECT_GE(a, b)`  | `a >= b`                          |
| `ASSERT_GE(a, b)`  | Fatal version of `EXPECT_GE`.    |

> **Note:** When comparing pointers, `EXPECT_EQ` tests pointer equality.
> Use `EXPECT_STREQ` for comparing C strings by content (see below).

Example:

```cpp
EXPECT_EQ(result, expected_result);
ASSERT_LT(value, max_limit);
```

---

## String Comparison Assertions (C Strings)

Specialized macros for comparing C strings (`const char*`) by content rather than pointer address.

| Macro                | Description                               |
|----------------------|-------------------------------------------|
| `EXPECT_STREQ(s1,s2)`  | Verifies that C strings `s1` and `s2` have the same contents.  |
| `ASSERT_STREQ(s1,s2)`  | Fatal version of `EXPECT_STREQ`.          |
| `EXPECT_STRNE(s1,s2)`  | Verifies that strings differ in content. |
| `ASSERT_STRNE(s1,s2)`  | Fatal version of `EXPECT_STRNE`.          |
| `EXPECT_STRCASEEQ(s1,s2)` | Case-insensitive equality check.       |
| `ASSERT_STRCASEEQ(s1,s2)` | Fatal version of `EXPECT_STRCASEEQ`.    |
| `EXPECT_STRCASENE(s1,s2)` | Case-insensitive not-equal check.      |
| `ASSERT_STRCASENE(s1,s2)` | Fatal version of `EXPECT_STRCASENE`.    |

These macros work with both narrow and wide strings; wide strings are printed as UTF-8 in failure messages.

Example:

```cpp
EXPECT_STREQ("abc", my_cstring);
ASSERT_STRNE(ptr1, ptr2);
EXPECT_STRCASEEQ("foo", "FOO");
```

---

## Floating-Point Comparison Assertions

Due to rounding errors, comparing floating-point values requires special consideration. GoogleTest offers approximate equality with tolerances.

| Macro                | Description                                             |
|----------------------|---------------------------------------------------------|
| `EXPECT_FLOAT_EQ(a,b)` | Verifies `float` values are approximately equal within 4 ULPs. |
| `ASSERT_FLOAT_EQ(a,b)` | Fatal version of `EXPECT_FLOAT_EQ`.                 |
| `EXPECT_DOUBLE_EQ(a,b)` | Verifies `double` values approximately equal within 4 ULPs. |
| `ASSERT_DOUBLE_EQ(a,b)` | Fatal version of `EXPECT_DOUBLE_EQ`.               |
| `EXPECT_NEAR(a,b,abs_error)` | Verifies difference between `a` and `b` doesn't exceed absolute error bound.  |
| `ASSERT_NEAR(a,b,abs_error)` | Fatal version of `EXPECT_NEAR`.                    |

Example:

```cpp
EXPECT_FLOAT_EQ(computedValue, expectedValue);
ASSERT_NEAR(pi, 3.14, 0.01);
```

> **Important:** Comparing floating-point values for exact equality using `EXPECT_EQ` is unsafe due to precision limitations.

---

## Exception Assertions

Verify whether statements throw or do not throw exceptions. These macros require that exceptions are enabled in your build environment.

| Macro             | Description                                         |
|-------------------|-----------------------------------------------------|
| `EXPECT_THROW(stmt, ExceptionType)`  | Verifies `stmt` throws an exception of the specified type.  |
| `ASSERT_THROW(stmt, ExceptionType)`  | Fatal version of `EXPECT_THROW`.               |
| `EXPECT_ANY_THROW(stmt)`              | Verifies `stmt` throws any type of exception.  |
| `ASSERT_ANY_THROW(stmt)`              | Fatal version of `EXPECT_ANY_THROW`.           |
| `EXPECT_NO_THROW(stmt)`               | Verifies `stmt` does not throw any exceptions. |
| `ASSERT_NO_THROW(stmt)`               | Fatal version of `EXPECT_NO_THROW`.            |

Example:

```cpp
EXPECT_THROW({ throw std::runtime_error("fail"); }, std::runtime_error);
ASSERT_NO_THROW({ DoSomething(); });
```

> Complex statements inside these macros can be compound blocks `{ ... }`.

---

## Predicate Assertions

For complex logical conditions and clearer failure messages beyond `EXPECT_TRUE()`, GoogleTest offers predicate assertions.

### `EXPECT_PRED*` and `ASSERT_PRED*`

Allow you to use predicate functions or functors returning `bool`. These macros also print the argument values on failure, better informing you about the reason.

There are variants for predicates of arity 1 through 5:

```cpp
EXPECT_PRED1(pred, val1);
ASSERT_PRED2(pred, val1, val2);
EXPECT_PRED3(pred, val1, val2, val3);
// ... up to PRED5
```

Example:

```cpp
bool IsPrime(int n); // your predicate function
EXPECT_PRED1(IsPrime, 7);  // Succeeds
EXPECT_PRED1(IsPrime, 10); // Fails with nicely formatted message
```

### Predicate Formatter Assertions (`EXPECT_PRED_FORMAT*` / `ASSERT_PRED_FORMAT*`)

Allow you to provide full control over failure message formatting.

Your predicate-formatter function/functor must have the signature:

```cpp
testing::AssertionResult PredicateFormatter(const char* expr1, const char* expr2, ..., T1 val1, T2 val2, ...);
```

where `expr1`, `expr2`, ... are the expressions as strings and `val1`, `val2`, ... are their actual values.

You must return `testing::AssertionSuccess()` on success, or `testing::AssertionFailure()` with streaming messages on failure.

Example:

```cpp
// Checks if two ints are mutually prime and print custom failure message.
testing::AssertionResult AssertMutuallyPrime(const char* m_expr, const char* n_expr, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << m_expr << " and " << n_expr << " are not mutually prime (" << m << ", " << n << ")";
}

EXPECT_PRED_FORMAT2(AssertMutuallyPrime, 3, 4);  // Succeeds
EXPECT_PRED_FORMAT2(AssertMutuallyPrime, 4, 6);  // Provides failure with a detailed message
```

These provide the utmost flexibility for domain-specific checks.

---

## Windows HRESULT Assertions

If you work with Windows APIs returning HRESULT codes, use these assertions to verify success or failure, showing human-readable error messages on failure.

| Macro                         | Description                            |
|-------------------------------|--------------------------------------|
| `EXPECT_HRESULT_SUCCEEDED(expr)` | Verifies HRESULT `expr` indicates success. |
| `ASSERT_HRESULT_SUCCEEDED(expr)` | Fatal version of `EXPECT_HRESULT_SUCCEEDED`. |
| `EXPECT_HRESULT_FAILED(expr)`     | Verifies HRESULT `expr` indicates failure. |
| `ASSERT_HRESULT_FAILED(expr)`     | Fatal version of `EXPECT_HRESULT_FAILED`. |

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
EXPECT_HRESULT_FAILED(someFailedFunction());
```

The failure messages include the HRESULT code and system error descriptions.

---

## Death Assertions

Death tests verify that code causes process termination under expected conditions.

They work by running the test statement in a child process and checking:

1. That the child process terminates (non-zero exit status for `EXPECT_DEATH`).
2. That the exit status matches an optional predicate (`EXPECT_EXIT`).
3. That the process's `stderr` output matches a provided regex or matcher.

| Macro                         | Description                                 |
|-------------------------------|---------------------------------------------|
| `EXPECT_DEATH(statement, matcher)` | Verifies process dies executing `statement` with `stderr` matching `matcher`. |
| `ASSERT_DEATH(statement, matcher)` | Fatal version of `EXPECT_DEATH`.           |
| `EXPECT_DEATH_IF_SUPPORTED(statement, matcher)` | Runs `EXPECT_DEATH` if death tests supported.| 
| `ASSERT_DEATH_IF_SUPPORTED(statement, matcher)` | Fatal version of `EXPECT_DEATH_IF_SUPPORTED`.|
| `EXPECT_DEBUG_DEATH(statement, matcher)` | Like `EXPECT_DEATH`, only in debug builds.  |
| `ASSERT_DEBUG_DEATH(statement, matcher)` | Fatal version of `EXPECT_DEBUG_DEATH`.      |
| `EXPECT_EXIT(statement, predicate, matcher)` | Verifies exit code matches `predicate` and output matches `matcher`. |
| `ASSERT_EXIT(statement, predicate, matcher)` | Fatal version of `EXPECT_EXIT`.             |

Example:

```cpp
EXPECT_DEATH({ int x = 5; CrashIfNegative(x); }, "negative");
EXPECT_EXIT(NormalExit(), ::testing::ExitedWithCode(0), "Success");
```

---

## Important Usage Notes and Best Practices

- **Fatal Assertions in Functions**: Only use fatal assertions (`ASSERT_*`, `FAIL()`) in functions that return `void`. Using them elsewhere results in confusing compiler errors.

- **Assertion Placement**: Use `ADD_FAILURE()` or `EXPECT_*` macros for assertions in non-void functions or constructors/destructors.

- **Predicate Assertions**: Prefer predicate assertions over `EXPECT_TRUE` with complex conditions to get richer diagnostic messages.

- **Custom Messages**: Make use of the streaming operator `<<` to add context to assertion failures.

- **Death Tests**: Name death test suites with `*DeathTest` suffix for correct execution order and thread safety.

- **Wide String Handling**: Wide strings in assertions are seamlessly converted to UTF-8.

---

For more details, tutorials, and examples, see the following related documentation pages:

- [Matchers Reference](matchers.md) for writing expressive matcher expressions.
- [Advanced GoogleTest Topics](../advanced.md#predicate-assertions-for-better-error-messages) for predicate and predicate formatter patterns.
- [Death Tests Guide](../guides/core-workflows/death-tests.mdx) to write robust death tests.
- [Testing Reference](testing.md) for overview of test macros and classes.
- [Value and Type Parameterized Tests](../advanced.md#value-and-type-parameterized-tests) for test code reuse.
