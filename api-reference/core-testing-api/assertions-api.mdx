---
title: "Assertions and Expectation Macros"
description: "Comprehensive documentation for all assertion macros provided by GoogleTest, including core, fatal, non-fatal, and user-defined assertions. Covers value assertions, death tests, exception checks, and best practices for readable, robust tests."
---

# Assertions and Expectation Macros

Comprehensive documentation for all assertion macros provided by GoogleTest, including core, fatal, non-fatal, and user-defined assertions. Covers value assertions, death tests, exception checks, and best practices for readable, robust tests.

---

## Overview

GoogleTest offers a broad suite of macro-based assertions to verify your C++ code's behavior in tests. These assertions allow you to specify expected conditions, producing detailed messages and test failure reports when those conditions are not met. Assertions come in pairs: `EXPECT_` macros which generate nonfatal failures (allowing test continuation) and `ASSERT_` macros which generate fatal failures (immediately aborting the current test).

Using assertions effectively is key to writing readable, maintainable, and robust tests. They help you express expectations clearly, diagnose failures quickly, and improve test reliability.

---

## Assertion Categories

### 1. Explicit Success and Failure

These assertions generate explicit success or failure without evaluating any Boolean expression. They help control test flow when the pass or fail decision depends on conditions outside of a simple Boolean check.

- `SUCCEED()`
  - Generates a success status.
  - Does not force a passing test but records that the flow reached a successful check.

- `FAIL()`
  - Generates a fatal failure, immediately aborting the current function.
  - Useful when control flow determines the failure, e.g., in a default case in a switch statement.

- `ADD_FAILURE()`
  - Generates a nonfatal failure, allowing the test to continue.

- `ADD_FAILURE_AT(file, line)`
  - Generates a nonfatal failure reported at a specific file and line number.

#### Example
```cpp
switch(expression) {
  case 1:
    ... // some checks
    break;
  default:
    FAIL() << "Unexpected case encountered.";
}
```

### 2. Generalized Assertions Using Matchers

- `EXPECT_THAT(value, matcher)` / `ASSERT_THAT(value, matcher)`
  - Verify that a value satisfies a matcher condition.
  - Matchers are expressive predicates that produce helpful failure messages.
  - Allows complex conditions like string prefixes, regex, numeric ranges, container contents, and user-defined conditions.

#### Example
```cpp
EXPECT_THAT(my_str, StartsWith("Hello"));
ASSERT_THAT(number, AllOf(Gt(5), Lt(10)));
```

See the [Matchers Reference](reference/matchers.md) for a wide library of matchers and instructions on creating custom ones.

### 3. Boolean Conditions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

These assert that a Boolean expression evaluates to true or false, respectively.

### 4. Binary Comparison Assertions

Check relationships between two comparable values. Use these to verify equality, inequality, ordering, etc.

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — test `val1 == val2`
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — test `val1 != val2`
- `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)` — test `val1 < val2`
- `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)` — test `val1 <= val2`
- `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)` — test `val1 > val2`
- `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)` — test `val1 >= val2`

**Special notes:**
- For pointers, tests are by pointer equality, not pointed-to value.
- For C strings, prefer `EXPECT_STREQ` and related string comparison macros.

### 5. String Comparison Assertions

Compare C strings (`const char*`) or wide C strings (`wchar_t*`) by content, ignoring or respecting case.

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` — expect strings to be equal
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)` — expect strings to be not equal
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)` — expect strings to be equal ignoring case
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)` — expect strings to differ ignoring case

### 6. Floating-Point Comparison Assertions

Due to rounding and representation, direct equality may fail unexpectedly with floats and doubles. GoogleTest provides approximate equality assertions based on Units in the Last Place (ULPs) and absolute difference measures.

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)` — approximately equal `float`
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)` — approximately equal `double`
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` — difference no greater than `abs_error`

### 7. Exception Assertions

Test that a piece of code throws or does not throw exceptions.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)` — expect a particular exception type
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)` — expect any exception
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)` — expect no exception thrown

Useful for verifying exception safety and error handling code.

### 8. Predicate Assertions

Allow checking arbitrary predicates (functions or functors) with arguments, providing custom failure messages.

- `EXPECT_PREDn(pred, val1, val2, ..., valn)` / `ASSERT_PREDn(pred, val1, val2, ..., valn)` — test predicate of n arguments
- `EXPECT_PRED_FORMATn(formatter, val1, ..., valn)` / `ASSERT_PRED_FORMATn(formatter, val1, ..., valn)` — allow custom formatted failure messages

### 9. Windows HRESULT Assertions

Special assertions for testing `HRESULT` values on Windows platforms.

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED(expression)` — verify success code
- `EXPECT_HRESULT_FAILED(expression)` / `ASSERT_HRESULT_FAILED(expression)` — verify failure code

### 10. Death Assertions

Verify that a statement causes the process to terminate with an expected error and optionally matching output.

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH(statement, matcher)`
- `EXPECT_DEATH_IF_SUPPORTED(statement, matcher)` / `ASSERT_DEATH_IF_SUPPORTED(statement, matcher)`
- `EXPECT_DEBUG_DEATH(statement, matcher)` / `ASSERT_DEBUG_DEATH(statement, matcher)`
- `EXPECT_EXIT(statement, predicate, matcher)` / `ASSERT_EXIT(statement, predicate, matcher)`

Requirements depend on platform support and build configuration.

---

## Best Practices

- Prefer `EXPECT_` macros when you want tests to continue after failure, and `ASSERT_` macros when an assertion failure invalidates subsequent code.
- Use expressive matchers with `EXPECT_THAT` and related macros for clearer intent and diagnostics.
- Avoid over-specification: specify only the conditions your test cares about.
- Use nonfatal failures (`EXPECT_`) to collect multiple failures in a single test run.
- Use custom predicates and predicate-format assertions for complex conditions and improved failure messages.
- Ensure exception assertions are used only when exceptions are enabled in your build.
- Use death tests thoughtfully, as they spawn subprocesses and may increase test runtime.

---

## Examples

### Basic Value Assertions

```cpp
TEST(FooTest, BasicAssertions) {
  int result = ComputeValue();

  EXPECT_EQ(result, 42) << "Result should be the answer to life.";
  ASSERT_NE(result, 0) << "Result must not be zero.";

  EXPECT_TRUE(IsPositive(result));
  EXPECT_FALSE(IsNegative(result));
}
```

### Using EXPECT_THAT with Matchers

```cpp
#include <gmock/gmock.h>
using ::testing::StartsWith;
using ::testing::MatchesRegex;
using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;

TEST(ValidationTest, StringAndNumberMatchers) {
  std::string greeting = GetGreeting();
  int value = GetValue();

  EXPECT_THAT(greeting, StartsWith("Hello"));
  EXPECT_THAT(greeting, MatchesRegex("Hello, [A-Za-z]+!"));

  EXPECT_THAT(value, AllOf(Gt(5), Lt(10)));
}
```

### Exception Assertions

```cpp
TEST(ExceptionTest, ThrowsOnInvalidInput) {
  EXPECT_THROW(DoSomething(-1), std::invalid_argument);
  EXPECT_ANY_THROW(DoOtherThing());
  EXPECT_NO_THROW(DoSafeThing());
}
```

### Death Test Example

```cpp
TEST(FatalTest, DeathOnInvalidConfig) {
  EXPECT_DEATH(SetupConfig("bad.cfg"), "Invalid configuration");
}
```

---

## Troubleshooting and Tips

- When your test fails with unclear error messages, consider replacing binary assertions with matcher-based assertions for richer diagnostics.
- Use the streaming operator `<<` following assertions for custom messages to clarify intent.
- Avoid relying on pointer equality unless explicitly testing pointers; use string or container matchers for content.
- For floating-point values, avoid direct equality; use `EXPECT_FLOAT_EQ` or `EXPECT_NEAR`.
- Remember that `ASSERT_` macros abort the current function immediately, so place them where a failure blocks subsequent valid operations.
- When writing death tests, ensure the tested code actually terminates the process to prevent hangs.

---

## See Also

- [Matchers Reference](reference/matchers.md) – Extensive list of built-in matchers and guidelines for creating custom ones.
- [gMock Cookbook](docs/gmock_cook_book.md) – Recipes for advanced assertion and mocking patterns.
- [GoogleTest Primer](guides/getting-started/writing-your-first-test.mdx) – Introduction to writing GoogleTest tests.
- [Effective Assertions Guide](guides/testing-patterns/effective-assertions.mdx) – Best practices for using assertions effectively.

---

## Related Navigation

You can find this documentation under **API Reference > Core Testing API > Assertions and Expectation Macros**. For related information and other key GoogleTest components, see:

- [Test Fixtures and Test Cases](api-reference/core-testing-api/test-fixtures-api.mdx)
- [Mock Class and Method APIs](api-reference/mocking-and-matcher-api/mock-methods-api.mdx)
- [Matchers Reference](api-reference/mocking-and-matcher-api/matchers-api.mdx)


---

For comprehensive guidance, review the associated guides and tutorials on GoogleTest and GoogleMock usage to deepen your testing proficiency and promote maintainable, robust C++ tests.
