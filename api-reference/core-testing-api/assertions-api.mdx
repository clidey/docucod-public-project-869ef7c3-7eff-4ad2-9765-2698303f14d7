---
title: "Assertions API"
description: "Comprehensive guide to all built-in GoogleTest assertions, including equality, floating point, string, and exception assertions. Describes fatal vs. non-fatal failures, custom assertion authoring, and usage with code examples to help users verify program correctness at every point."
---

# Assertions API

Comprehensive guide to all built-in GoogleTest assertions, including equality, floating point, string, and exception assertions. Describes fatal vs. non-fatal failures, custom assertion authoring, and usage with code examples to help users verify program correctness at every point.

---

## Overview of GoogleTest Assertions

GoogleTest provides a rich set of assertion macros for verifying your program's correctness at every point of execution. These assertions form the backbone of writing reliable, readable, and maintainable tests. They range from simple boolean checks to complex predicate assertions that improve test expressiveness and diagnostic clarity.

Assertions come in pairs:

- **EXPECT_***: Generate non-fatal failures allowing tests to continue and report multiple failures.
- **ASSERT_***: Generate fatal failures that abort the current function immediately.

Use `EXPECT_*` when you want your test to continue after failure and `ASSERT_*` when continuation is unsafe or meaningless.


## Types of Assertions

### 1. Boolean Conditions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`: Verifies that the condition is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`: Verifies that the condition is false.


### 2. Equality and Relational Assertions

For comparing values, including pointers and primitive types. GoogleTest prints actual and expected values for easier debugging.

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)`: Checks if `val1 == val2`.
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)`: Checks if `val1 != val2`.
- `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)`: Checks if `val1 < val2`.
- `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)`: Checks if `val1 <= val2`.
- `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)`: Checks if `val1 > val2`.
- `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)`: Checks if `val1 >= val2`.


### 3. String Assertions

Designed specifically for comparing C strings and wide strings. They check string content, not pointer equality.

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)`: Verifies string equality.
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)`: Verifies string inequality.
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)`: Case-insensitive equality.
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)`: Case-insensitive inequality.

**Example:**
```cpp
EXPECT_STREQ("hello", foo.getString()) << "The string did not match";
```


### 4. Floating-Point Comparisons

These handle the imprecision inherent in floating-point computations, comparing two values within a tolerance or ULP (units in the last place) range.

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`: `float` comparison within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`: `double` comparison within 4 ULPs.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)`: Checks that the absolute difference is within `abs_error`.

**Example:**
```cpp
EXPECT_NEAR(calculatePiEstimate(), 3.14159, 0.0001);
```


### 5. Predicate Assertions

When complex verification is needed beyond simple comparisons, predicate assertions allow writing custom logic with clear failure messages.

- `EXPECT_PRED1(pred, val)` / `ASSERT_PRED1(pred, val)`
- `EXPECT_PRED2(pred, val1, val2)` / `ASSERT_PRED2(pred, val1, val2)`
- ... up to 5 parameters.

They accept boolean predicates or functors.

Furthermore, predicate formatter variants allow detailed custom failure messages:

- `EXPECT_PRED_FORMAT1(pred_formatter, val)` / `ASSERT_PRED_FORMAT1(pred_formatter, val)`
- ... up to 5 parameters.

**Example predicate function using AssertionResult:**
```cpp
testing::AssertionResult IsEven(int n) {
  if ((n % 2) == 0)
    return testing::AssertionSuccess();
  else
    return testing::AssertionFailure() << n << " is odd";
}
```

**Usage:**
```cpp
EXPECT_PRED1(IsEven, value);
```


### 6. Exception Assertions

Check for expected exceptions thrown by code snippets, helps ensure robustness.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`


### 7. Explicit Success and Failure

For indicating unconditional success or failure:

- `SUCCEED()`: Records an explicit success.
- `FAIL()`: Generates a fatal failure and aborts the current function.
- `ADD_FAILURE()`: Non-fatal failure.


### 8. Generalized Assertions (Matchers)

Use GoogleMock's generalized matcher-based assertions for expressive checks:

- `EXPECT_THAT(value, matcher)` / `ASSERT_THAT(value, matcher)`

Match values against matchers like `HasSubstr()`, `Contains()`, `StartsWith()`, `MatchesRegex()`, and custom matchers.

**Example:**
```cpp
EXPECT_THAT(my_string, StartsWith("Hello"));
EXPECT_THAT(numbers, ElementsAre(1, 2, _, 4));
```


## Fatal vs. Non-fatal Failures

- **Fatal failure** (from `ASSERT_*`): Aborts the current function, useful when further execution might cause undefined behavior.
- **Non-fatal failure** (from `EXPECT_*`): Records failure but allows the current function to continue for more checks.

Choose `ASSERT_*` for critical preconditions and `EXPECT_*` for softer checks.


## Streaming Custom Messages

You can add debugging context by streaming a custom message after the assertion macro:

```cpp
EXPECT_EQ(value, expected) << "Failure at index " << i;
```

GoogleTest will append this message to the assertion failure output.


## Best Practices and Tips

- Use `EXPECT_*` unless you must abort the test early.
- Compare floating point with `EXPECT_FLOAT_EQ` or `EXPECT_NEAR` instead of `EXPECT_EQ`.
- Use `EXPECT_STREQ` when comparing C strings, not `EXPECT_EQ`.
- Use predicate or matcher assertions to improve failure diagnostics for complex conditions.
- Use `SCOPED_TRACE` to add contextual information in deeply nested test logic, making failures easier to trace.
- For exception testing, verify the exact exception type and message where appropriate.


## Common Pitfalls

- Don't use `ASSERT_*` in functions returning non-void; fatal assertions can only be used in void-returning functions.
- When testing private code, use `FRIEND_TEST` or test public interfaces.
- Avoid overly strict expectations with too many `EXPECT_CALL`s (in mocking) unless explicitly verifying call counts or orders.
- Remember that `EXPECT_EQ` on pointers compares addresses, not pointed-to contents.


## Sample Code Examples

### Equality Assertion Example
```cpp
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(3), 6) << "Factorial of 3 should be 6";
}
```

### Floating-Point Assertion Example
```cpp
TEST(MathTest, ApproximatelyEqual) {
  EXPECT_FLOAT_EQ(3.14f, CalculatePiApprox());
  EXPECT_NEAR(CalculatePiApprox(), 3.14159f, 0.0001f);
}
```

### Exception Assertion Example
```cpp
TEST(ExceptionTest, ThrowsExpected) {
  EXPECT_THROW(MyFunctionThatThrows(), std::runtime_error);
  EXPECT_NO_THROW(FunctionThatDoesNotThrow());
}
```

### Predicate Assertion Example
```cpp
bool IsPositive(int n) { return n > 0; }
TEST(PredicateTest, PositiveCheck) {
  EXPECT_PRED1(IsPositive, value);
}
```

---

## Troubleshooting

- **Unexpected assertion failures**: Check that arguments are evaluated exactly once and have expected values.
- **Compile errors on assertions**: Verify that arguments to macros match expected call signatures, especially for `ASSERT_*` fatal assertions.
- **Incorrect string comparison results**: Use `EXPECT_STREQ` for C strings, not `EXPECT_EQ`.
- **Flaky floating-point comparisons**: Use appropriate ULP-based or near comparison macros.
- **Fatal assertion inside non-void function causes compile errors**: refactor to return void or use non-fatal assertions.


## Related Documentation

- [Assertions Reference](reference/assertions.md) for full list of assertion macros.
- [Writing and Structuring Tests](guides/writing-and-structuring-tests/assertions-and-matchers.md) for guidance on idiomatic usage.
- [Advanced Topics](docs/advanced.md#assertions) for predicate assertions and advanced usage.
- [GoogleMock Integration](api-reference/mocking-actions-matchers/mock-objects-and-methods) for mixing assertions with mocks.

---

For the complete and latest API details and examples, refer to the official GoogleTest repository or online documentation.
