---
title: "Test Fixtures and Test Cases"
description: "A detailed reference to the classes, macros, and functions for creating test fixtures, organizing test cases, and running unit tests with GoogleTest. Learn how to set up and manage common test state, define typed and parameterized tests, and utilize main entry points."
---

# Test Fixtures and Test Cases

A detailed reference for GoogleTest users on how to create, organize, and run tests using test fixture classes, test cases, and test suites. This documentation guides you through setting up shared test states, defining typed and parameterized tests, and controlling test execution entry points with clarity and practical examples.

---

## 1. Introduction to Test Fixtures and Test Cases

GoogleTest enables you to group related tests that share common setup and teardown code into **test fixtures**. A test fixture is a C++ class derived from `testing::Test`, which allows you to create reusable contexts for multiple tests, improving readability and reducing duplication.

A **test case** (or test suite) consists of one or more **test methods** that use the fixture. Each test method runs independently on a fresh instance of the test fixture class.

This section covers:

- How to create and use test fixtures
- Using the macros `TEST`, `TEST_F`, and `TEST_P` to define tests
- Writing typed tests and parameterized test suites
- Managing shared setup and teardown across tests

---

## 2. Creating Test Fixtures

To define a test fixture:

1. Create a class derived from `testing::Test`.
2. Declare data members and helper methods inside it.
3. Optionally override `SetUp()` and `TearDown()` to run code before and after each test.
4. Optionally define `static void SetUpTestSuite()` and `static void TearDownTestSuite()` to run code once for the entire suite.

**Example:**

```cpp
class QueueTest : public ::testing::Test {
 protected:
  QueueTest() {
    // Setup code here (called before each test)
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  // Optional teardown
  ~QueueTest() override = default;

  void SetUp() override {
    // Runs immediately before each test
  }

  void TearDown() override {
    // Runs immediately after each test
  }

  // Shared resources
  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};
```

### Portable and Robust SetUp/Teardown

- Prefer `SetUp()`/`TearDown()` for initialization and cleanup that may fail or generate test failures.
- Use constructor/destructor only for trivial initialization (do not generate assertions).
- `SetUpTestSuite()` and `TearDownTestSuite()` allow costly global setup/teardown shared by all tests.

<Tip>
Ensure your fixture has a **default constructor** because GoogleTest creates a fresh instance for each test.
</Tip>

---

## 3. Defining Tests Using Fixtures

- **`TEST`** creates a basic test function without a fixture.
- **`TEST_F`** creates a test that uses a fixture class (inherits from `testing::Test`).
- **`TEST_P`** creates a **value-parameterized test** using fixtures that also inherit from `WithParamInterface<T>`.

### 3.1 Using `TEST`

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}
```

This macro defines a test in the test suite `FactorialTest` with the name
`HandlesZeroInput`.

### 3.2 Using `TEST_F`

When tests share common setup/teardown or resources, write:

```cpp
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  delete n;
}
```

Each test runs independently with a fresh `QueueTest` instance, so state changes
in one don't affect others.

### 3.3 Using `TEST_P` and `INSTANTIATE_TEST_SUITE_P` for Value-Parameterized Tests

Value-parameterized tests allow running the same test logic with different input data.

```cpp
class MyTest : public ::testing::TestWithParam<int> {};

TEST_P(MyTest, HandlesVariousInputs) {
  int param = GetParam();
  EXPECT_TRUE(Process(param));
}

INSTANTIATE_TEST_SUITE_P(MyGroup, MyTest, testing::Values(1, 2, 3, 4));
```

This example runs the test `HandlesVariousInputs` with values 1, 2, 3, and 4.

You can generate parameters using provided functions like `Values()`, `ValuesIn()`,
`Range()`, `Bool()`, `Combine()`, and more.

<Tip>
Declare `SetUpTestSuite()` and `TearDownTestSuite()` as **public** when using with `TEST_P`.
</Tip>

---

## 4. Typed and Type-Parameterized Tests

Typed tests are powerful when you want to run the same tests on multiple types.

### 4.1 Typed Tests

```cpp
template <typename T>
class FooTest : public ::testing::Test {
 public:
  T value_;
};

using MyTypes = ::testing::Types<int, char, double>;
TYPED_TEST_SUITE(FooTest, MyTypes);

TYPED_TEST(FooTest, IsZeroInitially) {
  EXPECT_EQ(this->value_, 0);
}
```

The test `IsZeroInitially` runs once for each type in `MyTypes`.

### 4.2 Type-Parameterized Tests

Define tests without a type list and instantiate later:

```cpp
template <typename T>
class BaseTest : public ::testing::Test {
  // Common logic
};

TYPED_TEST_SUITE_P(BaseTest);
TYPED_TEST_P(BaseTest, DoesBlah) {
  // Test body using TypeParam
}
REGISTER_TYPED_TEST_SUITE_P(BaseTest, DoesBlah);

using MyTypes = ::testing::Types<int, float>;
INSTANTIATE_TYPED_TEST_SUITE_P(My, BaseTest, MyTypes);
```

This enables sharing test logic across projects and libraries.

---

## 5. Controlling Test Execution and Grouping

- Tests are grouped into **test suites** named by either the test fixture or the first argument to the macro.
- Test fixtures control the environment setup and teardown for the test suite.
- Tests run independently with isolated fixture instances.
- You can use **test properties** to log metadata during a test using `RecordProperty`.

Example of a test property:

```cpp
TEST_F(FooTest, LogsProperty) {
  RecordProperty("API_Version", "v1.2.3");
}
```

Properties are included in XML or JSON reports.

---

## 6. Main Entry Points for Running Tests

GoogleTest comes with a predefined main function, but you can implement your own.

A typical main function looks like:

```cpp
int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- `InitGoogleTest` parses command-line flags and sets up the testing environment.
- `RUN_ALL_TESTS` runs all registered tests and returns zero on success.

Avoid ignoring the return value of `RUN_ALL_TESTS()` to ensure correct test suite status.

---

## 7. Practical Tips & Common Pitfalls

- Always give your fixture a default constructor.
- For test suites with expensive shared resources, use `SetUpTestSuite` and `TearDownTestSuite`.
- Prefer `EXPECT_*` assertions for non-fatal checks; use `ASSERT_*` when test must abort on failure.
- Use `SCOPED_TRACE` to add context when calling helper functions in tests.
- Avoid using underscores `_` in test suite and test names to prevent clashes.
- Use `GTEST_SKIP()` to skip tests at runtime based on dynamic conditions.

---

## 8. Troubleshooting Test Fixtures

**Problem:** Tests fail with errors like "no matching constructor".

**Solution:** Ensure your test fixture class has a default constructor accessible to GoogleTest.

**Problem:** Fatal assertions in setup subroutines don't abort entire test.

**Solution:** Use `ASSERT_NO_FATAL_FAILURE()` to wrap subroutine calls or propagate fatal failures manually by checking `HasFatalFailure()`.

**Problem:** Unexpected test behavior from shared resources.

**Solution:** Remember each test has a fresh fixture; shared resources must be static and properly managed.

---

## 9. Summary

This page provided an actionable reference for:

- Defining test fixture classes deriving from `testing::Test`.
- Declaring tests with `TEST`, `TEST_F`, and value-parameterized `TEST_P`.
- Using typed and type-parameterized tests for templated code.
- Managing per-test and per-suite setup and teardown.
- Writing main functions and running tests with GoogleTest.

For deeper exploration, see related guides on assertions, mocking, test parameters, and core architecture in the rest of the GoogleTest documentation.

---

## Related Links

- [GoogleTest Primer (Basic Testing Concepts)](/docs/primer.md)
- [Advanced Guide (Typed and Parameterized Tests)](/docs/advanced.md#value-parameterized-tests)
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md)
- [Test Macros Reference](/docs/reference/testing.md#TEST_F)
- [GoogleTest Official GitHub Repository](https://github.com/google/googletest)

---

## Visualizing Test Fixture and Test Case Flow

```mermaid
flowchart TD
  A[Define Test Fixture Class (inherits testing::Test)] --> B[Override SetUp() and TearDown()]
  B --> C[Write TEST_F or TEST_P Using Fixture]
  C --> D[Run Each Test with Fresh Fixture Instance]
  D --> E{Shared Setup Needed?}
  E -->|Yes| F[Define SetUpTestSuite() and TearDownTestSuite()]
  E -->|No| G[Run Tests Independently]
  F --> G

  subgraph Test Execution
    direction LR
    G --> H[Execute Test Body]
    H --> I[Assertions and Checks]
    I --> J[Test Pass or Fail]
  end

  classDef testSuite fill:#f9f,stroke:#333,stroke-width:2px;
  class A,B,E,F testSuite;
```

This flow highlights the typical user workflow creating and running tests using test fixture classes.

---

