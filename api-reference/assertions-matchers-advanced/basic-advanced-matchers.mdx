---
title: "Built-in Matchers"
description: "Documentation of built-in matcher APIs for equality, relational, regex, and container-based assertions. Details matcher composition and provides common scenarios for integrating matchers with assertions or expectations."
---

# Built-in Matchers

Comprehensive documentation of the built-in matcher APIs provided by GoogleMock. This page covers equality, relational, regex, and container-based assertions, details how matchers are composed, and provides practical scenarios for integrating matchers with assertions or expectations.

---

## Overview

Matchers in GoogleMock provide a powerful mechanism to specify patterns that function arguments or values should satisfy during unit testing. This page documents the built-in matchers that cover everything from simple equality and relational checks to string pattern matching, container element matching, and advanced composite matchers.

Matchers serve as predicates that check properties of values or arguments and provide clear, descriptive failure messages if the matching fails. Their design enables expressive, flexible, and readable test assertions.

## Categories of Built-in Matchers

### Wildcard Matchers

- `_` : Matches any value of the correct type.
- `A<type>()` or `An<type>()` : Matches any value of the specified type.

### Generic Comparison Matchers

| Matcher    | Description            |
|------------|------------------------|
| `Eq(value)` or just `value` | Matches if argument equals `value` (`argument == value`). |
| `Ne(value)` | Argument not equal to `value`. |
| `Ge(value)` | Argument greater than or equal to `value`. |
| `Gt(value)` | Argument greater than `value`. |
| `Le(value)` | Argument less than or equal to `value`. |
| `Lt(value)` | Argument less than `value`. |
| `IsTrue()`  | Argument evaluates to `true`. |
| `IsFalse()` | Argument evaluates to `false`. |
| `IsNull()`  | Argument is a null pointer (raw or smart). |
| `NotNull()` | Argument is a non-null pointer (raw or smart). |
| `Optional(m)` | Argument is an optional containing a value matching matcher `m`. |
| `VariantWith<T>(m)` | Argument is a `variant` holding alternative `T` matching `m`. |
| `Ref(variable)` | Argument is a reference to the specified variable. |
| `TypedEq<T>(value)` | Argument has type `T` and equals `value`. Useful for disambiguating overloads. |

### Floating-Point Matchers

- `DoubleEq(a_double)`, `FloatEq(a_float)` : Matches floating-point values approximately equal to the specified value.
- `NanSensitiveDoubleEq(a_double)`, `NanSensitiveFloatEq(a_float)` : Like above but treat NaNs as equal.
- `DoubleNear(a_double, max_abs_error)`, `FloatNear(a_float, max_abs_error)` : Matches values within an absolute error.

### String Matchers

Support both C strings and C++ `std::string` types, including wide string variants (UTF-16/32).

- `StrEq(string)`, `StrNe(string)` : Exact string equality/inequality.
- `StrCaseEq(string)`, `StrCaseNe(string)` : Case-insensitive string equality/inequality.
- `StartsWith(prefix)`, `EndsWith(suffix)` : Matches prefix or suffix of strings.
- `HasSubstr(string)` : Contains substring.
- `MatchesRegex(regex)` : Matches entire string against a regex.
- `ContainsRegex(regex)` : Matches if the string contains a substring matching the regex.
- `WhenBase64Unescaped(matcher)` : Matches base64-encoded strings whose decoded form matches `matcher`.

### Container and Element Matchers

Designed for STL-style containers and arrays.

- `IsEmpty()` : Matches empty containers or strings.
- `Contains(element_matcher)` : Container contains at least one matching element.
- `Each(element_matcher)` : All elements match the given matcher.
- `ElementsAre(e0, e1, ..., en)` : Container has exactly the specified elements in order.
- `ElementsAreArray(container_or_array)` : Like `ElementsAre` but accepts containers, arrays, iterators.
- `UnorderedElementsAre(...)` and `UnorderedElementsAreArray(...)` : Like `ElementsAre` but order doesn't matter.
- `IsSubsetOf(...)` and `IsSupersetOf(...)` : Partial containment matcher variants.
- `Pointwise(matcher, container)` : Element-wise comparator using a matcher on tuple pairs.
- `UnorderedPointwise(matcher, container)` : Like `Pointwise` but ignores order.
- `WhenSorted(matcher)` and `WhenSortedBy(comparator, matcher)` : Match containers when sorted.

### Member Matchers

Matcher for components or subfields of compound objects.

- `Field(&Class::field, matcher)`: Matches an object's field that satisfies `matcher`.
- `Property(&Class::method, matcher)`: Matches result of calling a member function (getter).
- `Key(matcher)`: Matches the `.first` key field in pairs.
- `Pair(matcher1, matcher2)`: Matches an std::pair whose first and second fields satisfy respective matchers.
- `FieldsAre(m1, m2, ...)`: Matches the fields of a tuple-like or aggregate object piecewise.

### Pointer Matchers

- `Pointee(matcher)`: The value pointed to matches `matcher`. Works on raw and smart pointers.
- `Pointer(matcher)`: The pointer itself matches a matcher on raw pointers.
- `Address(matcher)`: Matches if the address of the argument matches.
- `WhenDynamicCastTo<T>(matcher)`: Match after `dynamic_cast` to type `T`.

### Composite Matchers

Enables combining multiple matchers:

- `AllOf(m1, m2, ...)`: All matchers match the argument.
- `AnyOf(m1, m2, ...)`: At least one matcher matches.
- `Not(m)`: Matches when `m` does not match.
- `Conditional(cond, m1, m2)`: Chooses matcher based on a boolean condition.

### Matchers as Predicates

- `Matches(m)`: Converts a matcher to a unary predicate.
- `ExplainMatchResult(m, value, listener)`: Evaluates and explains the match result, used internally for diagnostics.
- `Value(value, matcher)`: Returns `true` if `value` matches `matcher`.

### Defining New Matchers

Users can define custom matchers using:

- `MATCHER(name, description) { ... }` for simple matchers.
- `MATCHER_P(name, param, description) { ... }` for parameterized matchers.
- Implementing matcher interfaces for advanced or polymorphic matchers.

### Practical Examples of Using Common Matchers

```cpp
#include <gmock/gmock.h>
using ::testing::Eq;
using ::testing::Gt;
using ::testing::_;

// Matches any int argument equal to 5
EXPECT_CALL(mock_obj, Foo(Eq(5))); 

// Matches any int argument greater than 10
EXPECT_CALL(mock_obj, Bar(Gt(10)));

// Matches any string argument that starts with "Hello"
EXPECT_CALL(mock_obj, Baz(StartsWith("Hello")));

// Matches container having elements 1, 2, 3 in any order
EXPECT_CALL(mock_obj, Process(UnorderedElementsAre(1, 2, 3)));
```

### Common Matcher Idioms and Tips

- Use `_` to match any argument when specific values don't matter.
- Use `Ref(variable)` to check if a function receives an argument that refers to a particular variable.
- Combine matchers using `AllOf()` and `AnyOf()` to specify complex argument constraints.
- Use `Key()` and `Pair()` when verifying associative containers like maps.
- Use `SafeMatcherCast<T>(m)` when type conversions are needed between matcher and argument types.

### Troubleshooting and Notes

- Matchers must be pure functions without side effects.
- Matcher arguments are copied internally; use `std::ref()` to match non-copyable or mutable arguments by reference.
- When working with overloaded functions, use `TypedEq<T>()` or cast matchers explicitly to avoid ambiguity.
- Use descriptions and explanations provided by matchers for clear error messages.

### Summary

Built-in matchers provide a comprehensive foundation to express expectations on function arguments or values in tests with GoogleMock. Mastering their use empowers writing clear, robust, and maintainable test assertions.

---

## See Also

- [Matchers Reference](reference/matchers.md) &ndash; Complete list of matchers and detailed descriptions.
- [Mocking Reference](reference/mocking.md) &ndash; How to use matchers with mocks and expectations.
- [gMock Cookbook: Writing New Matchers](gmock_cook_book.md#NewMatchers) &ndash; How to create custom matchers.
- [Assertions Reference: EXPECT_THAT](reference/assertions.md#EXPECT_THAT) &ndash; Using matchers in test assertions.

---

## Example: Using Built-in Matchers in an EXPECT_CALL

```cpp
using ::testing::_;
using ::testing::Ge;
using ::testing::HasSubstr;

// Expect that foo.Bar() is called with an integer >= 0 and a string containing "ok"
EXPECT_CALL(foo, Bar(Ge(0), HasSubstr("ok")));

// Accept any argument for other parameters
EXPECT_CALL(foo, Baz(_)).WillRepeatedly(Return(true));
```

This assertion checks arguments using built-in matchers to boost test readability and correctness.

---