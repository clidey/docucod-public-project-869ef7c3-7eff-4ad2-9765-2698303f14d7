---
title: "Assertions & Predicate Assertions"
description: "Details the assertion macros and predicate assertion mechanisms available in GoogleTest, including standard checks for equality, conditions, exceptions, and user-defined predicates. Includes guidelines for fatal and non-fatal failures and debugging support."
---

# Assertions & Predicate Assertions

GoogleTest empowers you to write precise, expressive assertions that verify the correctness of your code. These assertions cover a wide spectrum—from simple Boolean conditions, equality checks, and exception testing, to sophisticated predicate assertions that enable clear diagnostics for complex expressions.

This document guides you through GoogleTest's comprehensive assertion macros and predicate mechanisms, helping you write tests that not only catch bugs but present them with actionable clarity.

---

## Explicit Success and Failure

GoogleTest provides assertion macros for signaling unambiguous success or failure conditions, useful when a control flow, rather than a Boolean expression, dictates the test outcome.

### SUCCEED()

- **Purpose**: Marks a test as successful at a specific point.
- **Behavior**: Does not affect the overall test result unless no failures occur.
- **Usage**:

  ```cpp
  SUCCEED();
  SUCCEED() << "Step succeeded with value " << value;
  ```

### FAIL()

- **Purpose**: Generates a fatal failure, aborting the current function immediately.
- **Behavior**: Must be used **only** in `void` functions.

  ```cpp
  FAIL() << "Unexpected branch hit.";
  ```

### ADD_FAILURE()

- **Purpose**: Generates a non-fatal failure, allowing the test to continue.

  ```cpp
  ADD_FAILURE() << "Non-fatal failure explanation.";
  ```

### ADD_FAILURE_AT(file_path, line_number)

- **Purpose**: Generates a non-fatal failure pointing to a specific source location.

  ```cpp
  ADD_FAILURE_AT("foo.cc", 42) << "Failure message at custom location";
  ```

---

## Boolean Conditions

Verify that conditions evaluate to true or false using paired macros:

| Assertion      | Verifies                       | Behavior on Failure           |
|----------------|-------------------------------|------------------------------|
| `EXPECT_TRUE`  | Condition is true             | Non-fatal (continues test)    |
| `ASSERT_TRUE`  | Condition is true             | Fatal (abort current function)|
| `EXPECT_FALSE` | Condition is false            | Non-fatal                    |
| `ASSERT_FALSE` | Condition is false            | Fatal                        |

**Example:**

```cpp
EXPECT_TRUE(IsValid(value));
ASSERT_FALSE(IsError(state));
```

Failing assertions display detailed diagnostics including the expression and the values that caused the failure.

---

## Binary Comparison

GoogleTest offers rich macros to compare two values using relational operators. On failure, the macros print the expected expression, actual expression, and their evaluated values (if printable).

| Assertion            | Verifies                     | Notes                                    |
|----------------------|-----------------------------|------------------------------------------|
| `EXPECT_EQ(val1, val2)` | `val1 == val2`                | For C strings, compares pointers, not content—use `EXPECT_STREQ` instead. |
| `EXPECT_NE(val1, val2)` | `val1 != val2`                | For C strings, compares pointers—use `EXPECT_STRNE` for content comparison. |
| `EXPECT_LT(val1, val2)` | `val1 < val2`                 |                                            |
| `EXPECT_LE(val1, val2)` | `val1 <= val2`                |                                            |
| `EXPECT_GT(val1, val2)` | `val1 > val2`                 |                                            |
| `EXPECT_GE(val1, val2)` | `val1 >= val2`                |                                            |

There are corresponding `ASSERT_` variants that generate fatal failures.

**Example:**

```cpp
EXPECT_EQ(foo.size(), bar.size()) << "Sizes differ";
ASSERT_LT(value, max_value);
```

---

## String Comparison

Specialized macros exist for comparing null-terminated strings by value:

| Assertion          | Description                                   |
|--------------------|-----------------------------------------------|
| `EXPECT_STREQ`     | Strings are equal (content equality)          |
| `EXPECT_STRNE`     | Strings are not equal                          |
| `EXPECT_STRCASEEQ` | Strings are equal, ignoring case               |
| `EXPECT_STRCASENE` | Strings are not equal, ignoring case           |

**Important:** These compare C strings' contents, not pointers. For `std::string`, use `EXPECT_EQ` or `EXPECT_NE`.

**Example:**

```cpp
EXPECT_STREQ("hello", strdup_hello());
ASSERT_STRCASEEQ(user_input.c_str(), "YES");
```

---

## Floating-Point Comparison

Floating-point values are compared approximately to handle rounding errors.

| Assertion           | Description                            |
|---------------------|---------------------------------------|
| `EXPECT_FLOAT_EQ`   | Compares two `float` values to within 4 ULPs |
| `EXPECT_DOUBLE_EQ`  | Compares two `double` values likewise |
| `EXPECT_NEAR(val1, val2, abs_error)` | Verifies that difference between values is within an absolute error bound |

**Example:**

```cpp
EXPECT_FLOAT_EQ(a, b);
ASSERT_NEAR(distance, expected_distance, 0.01);
```

These macros provide robust comparisons superior to naive `EXPECT_EQ` for floating-point numbers.

---

## Exception Assertions

If exceptions are enabled, verify that code throws or does not throw exceptions.

| Assertion        | Description                                    |
|------------------|------------------------------------------------|
| `EXPECT_THROW(statement, exception_type)` | Checks if `statement` throws exception_type    |
| `EXPECT_NO_THROW(statement)`     | Checks if `statement` does not throw            |
| `EXPECT_ANY_THROW(statement)`    | Checks if `statement` throws any exception      |

Corresponding `ASSERT_` variants generate fatal failures.

**Example:**

```cpp
EXPECT_THROW(Foo(), std::runtime_error);
ASSERT_NO_THROW(ProcessData());
```

---

## Predicate Assertions

Predicate assertions provide flexible syntax to verify complex conditions while generating detailed diagnostic messages.

### Using Boolean Predicate Functions

If you have a function or functor returning `bool`, you can use `EXPECT_PREDn()` macros, where `n` is the number of arguments (up to 5). These macros evaluate the predicate and print the argument values on failure.

**Macros:**

- `EXPECT_PRED1(pred, v1)` through `EXPECT_PRED5(pred, v1, ..., v5)`
- `ASSERT_PREDn` variants generate fatal failures

**Example:**

```cpp
bool MutuallyPrime(int m, int n) { ... }
EXPECT_PRED2(MutuallyPrime, a, b);
```

If the assertion fails, GoogleTest prints the predicate evaluation with argument values.


### Using AssertionResult-Based Predicates

For richer diagnostic messages, define predicates returning `AssertionResult`:

```cpp
testing::AssertionResult IsEven(int n) {
  if ((n % 2) == 0)
    return testing::AssertionSuccess() << n << " is even";
  else
    return testing::AssertionFailure() << n << " is odd";
}
```

Use with `EXPECT_TRUE` or `ASSERT_TRUE`:

```cpp
EXPECT_TRUE(IsEven(num));
```

Failed assertions will show detailed messages, including reasons for failure and success.

### Using Predicate-Formatter Assertions

If you require **full control over the failure message**, or your predicate arguments cannot be streamed directly, use predicate-formatter macros:

| Macro                  | Description                           |
|------------------------|-------------------------------------|
| `EXPECT_PRED_FORMATn(pred_fmt, v1, ..., vn)` | Uses a predicate-formatter function which receives expressions and values |
| `ASSERT_PRED_FORMATn`   | Same as above but fatal on failure   |

The predicate-formatter must have the signature:

```cpp
testing::AssertionResult PredFmt(const char* expr1, ..., const T1& val1, ...);
```

**Example:**

```cpp
testing::AssertionResult AssertMutuallyPrime(
  const char* m_expr, const char* n_expr, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << m_expr << " and " << n_expr
         << " (" << m << " and " << n << ") are not mutually prime.";
}

EXPECT_PRED_FORMAT2(AssertMutuallyPrime, a, b);
```

The generated message fully describes the failure, including the expressions and evaluated values.

---

## Message Streaming

All assertions support streaming of custom failure messages using the `<<` operator:

```cpp
EXPECT_EQ(x, y) << "x and y differ at index " << i;
```

This message is appended to the standard diagnostic output, offering contextual details.

---

## Best Practices and Tips

- Prefer `EXPECT_*` macros when possible to allow tests to continue and reveal multiple failures at once.
- Use `ASSERT_*` macros when further execution doesn't make sense after failure (e.g., when dereferencing pointers).
- Use predicate assertions to improve failure messages on complex or custom conditions.
- Use **predicate-formatter** assertions if argument streaming isn't suitable or you want precise message control.
- Avoid side effects in assertion arguments; GoogleTest evaluates each argument exactly once but argument order is unspecified.
- Use `SUCCEED()` and `FAIL()` sparingly to clarify explicit success/failure scenarios.
- Remember `ASSERT_*` and `FAIL()` must be used in *void* functions; for non-void, use non-fatal assertions or restructure your code.

---

## Troubleshooting

- **Assertion Message Not Shown?**
  Make sure you stream messages using `<<` inside the assertion macro.

- **ASSERT_* Used in Non-void Function?**
  You will get confusing compile errors. Refactor your code to avoid this or use `EXPECT_*` instead.

- **Predicate Assertion Causes Compiler Errors?**
  For overloaded or template predicate functions, specify exact type or cast to resolve ambiguity.

- **Assertion Arguments Evaluated Multiple Times?**
  GoogleTest evaluates arguments exactly once. If you see unexpected behavior, ensure no macro side effects or undefined behavior.

- **Strings Comparing by Pointer Instead of Content?**
  Use `EXPECT_STREQ` and related macros for C string content comparison.

- **Unexpected Test Failures on Floating-Points?**
  Use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR` instead of raw equality.

---

## Example: Unary Predicate With AssertionResult

```cpp
#include <gtest/gtest.h>

// Predicate returning AssertionResult with detailed feedback.
testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) return testing::AssertionSuccess() << n << " is even";
  return testing::AssertionFailure() << n << " is odd";
}

TEST(PredicateTest, UnaryPredicate) {
  EXPECT_TRUE(IsEven(4));
  EXPECT_FALSE(IsEven(5));
}
```

When the test fails on 5, output includes:

```
Value of: IsEven(5)
  Actual: false (5 is odd)
Expected: true
```

## Example: Binary Predicate-Formatter Assertion

```cpp
#include <gtest/gtest.h>

bool MutuallyPrime(int m, int n) {
  // Simple implementation just for illustration
  for (int i = 2; i <= std::min(m, n); ++i) {
    if (m % i == 0 && n % i == 0) return false;
  }
  return true;
}

// Predicate-formatter for detailed failure message

testing::AssertionResult AssertMutuallyPrime(
    const char* m_expr, const char* n_expr, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();

  return testing::AssertionFailure()
      << m_expr << " and " << n_expr << " (" << m << " and " << n
      << ") are not mutually prime.";
}

TEST(PredicateTest, BinaryPredicateFormatter) {
  int a = 3, b = 4, c = 10;
  EXPECT_PRED_FORMAT2(AssertMutuallyPrime, a, b);  // Passes
  EXPECT_PRED_FORMAT2(AssertMutuallyPrime, b, c);  // Fails
}
```

Failure output is:

```
b and c (4 and 10) are not mutually prime.
```

## Summary

GoogleTest assertion macros and predicate assertions form an expressive suite enabling you to write tests with clear intention and precise failure reporting. From simple Boolean checks to detailed predicate-format assertions, GoogleTest helps uncover bugs with insightful diagnostics, facilitating fast, confident debugging and verification.

---

For a full list of assertion macros, examples, and predicate assertion details, refer to the [GoogleTest Assertions Reference](reference/assertions.md).

Explore also advanced topics on [Custom Assertions](../concepts/extensibility-and-performance/custom-assertions-and-matchers) and [Predicate Assertions](docs/advanced.md#more-assertions) for deeper mastery.

---

## See Also

- [GoogleTest Primer](docs/primer.md)
- [Advanced GoogleTest Topics](docs/advanced.md)
- [Mocking Reference](docs/reference/mocking.md)
- [Testing Reference](docs/reference/testing.md)

---

## Illustrative API Overview

| Assertion Type             | Macros Example                                                               | Description                                                  |
|----------------------------|-----------------------------------------------------------------------------|--------------------------------------------------------------|
| Explicit Success/Failure   | `SUCCEED()`, `FAIL()`, `ADD_FAILURE()`                                     | Mark fixed success or failure points                         |
| Boolean Checks             | `EXPECT_TRUE(condition)`, `ASSERT_FALSE(expr)`                             | Check conditions quickly with pass/fail                      |
| Binary Comparisons         | `EXPECT_EQ(expected, actual)`, `ASSERT_LT(a, b)`                          | Compare values for equality and ordering                     |
| String Assertions          | `EXPECT_STREQ(str1, str2)`, `ASSERT_STRCASEEQ(a, b)`                       | Compare C string contents                                    |
| Floating-Point Comparison  | `EXPECT_FLOAT_EQ(a, b)`, `ASSERT_NEAR(x, y, abs_error)`                   | Approximate floating-point comparisons                       |
| Exception Assertions       | `EXPECT_THROW(expr, ExceptionType)`, `ASSERT_NO_THROW(stmt)`              | Verify exceptions are (not) thrown                           |
| Predicate Assertions       | `EXPECT_PRED1(pred, v1)`, `ASSERT_PRED_FORMAT2(pred_formatter, v1, v2)`    | Complex predicates with improved diagnostics                 |

---