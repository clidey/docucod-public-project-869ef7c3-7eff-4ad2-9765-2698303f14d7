---
title: "Argument Matchers and Call Strictness"
description: "Leverage a rich library of matchers to verify arguments passed to mock methods, or define custom matchers for your domain. Control how strictly your mocks enforce call expectations using NiceMock, StrictMock, and NaggyMock wrappers."
---

# Argument Matchers and Call Strictness

GoogleMock offers a powerful set of **argument matchers** to precisely verify the arguments passed to your mock methods. Alongside this, you can control the **strictness** of your mocks to enforce how rigorously mock call expectations are validated during testing. This page unpacks how to leverage matchers for argument verification and how to use **NiceMock**, **NaggyMock**, and **StrictMock** wrappers to influence mock behavior.

---

## Understanding Argument Matchers

At the core of effective mocking is the ability to specify which arguments you expect your mock methods to receive. GoogleMock provides a rich set of matchers to enable flexible, expressive argument verification, ensuring tests are both readable and maintainable.

### What Are Matchers?

Matchers are predicates that apply to individual function arguments or collections of arguments. They let you define what values are acceptable at runtime for mock invocations. Use them inside `EXPECT_CALL` or `ON_CALL` to match arguments partially or exactly.

### Basic Examples

```cpp
using ::testing::_;  // Wildcard matcher
using ::testing::Eq; // Equality matcher
...
EXPECT_CALL(mock_obj, Foo(5));              // Argument must be exactly 5
EXPECT_CALL(mock_obj, Foo(_));               // Argument can be anything
EXPECT_CALL(mock_obj, Foo(Eq(42)));          // Using explicit equality matcher
```

### Common Built-in Matchers

- `_`: Matches any argument (wildcard)
- `Eq(value)`: Matches arguments equal to `value`
- `Ne(value)`: Matches arguments not equal to `value`
- `Lt(value)`, `Le(value)`, `Gt(value)`, `Ge(value)`: Comparison matchers
- `Not(matcher)`: Negates another matcher
- `Pointee(matcher)`: Matches pointers whose referenced value matches

### Matching Multiple Arguments as a Tuple

Use `.With()` to match function arguments as a tuple for more complex conditions.

```cpp
EXPECT_CALL(mock_obj, SetPosition(_, _))
    .With(Lt());  // First argument < second argument
```

### Composite Matchers and Combining Matchers

You can compose matchers using logical combinators like `AllOf()`, `AnyOf()`, and `Not()` for complex conditions.

```cpp
EXPECT_CALL(mock_obj, Foo(AllOf(Gt(5), Ne(10))));  // Argument > 5 and != 10
```

### Custom Matchers

Define domain-specific matchers using the `MATCHER` macros or by implementing the matcher interface for reusable and expressive test conditions.

---

## Controlling Mock Strictness with Wrappers

GoogleMock supports three mock behavior wrappers to refine how strictly mocks enforce expectations on uninteresting calls — calls to mock methods without an explicit `EXPECT_CALL`.

### NaggyMock (Default Behavior)

- Produces **warnings** when a mock method without an expectation is called.
- Helps catch unexpected interactions without failing tests immediately.

```cpp
using ::testing::NaggyMock;
NaggyMock<MockFoo> naggy_mock;
```

### NiceMock

- Suppresses warnings for uninteresting calls.
- Ideal for tests that don't need to monitor every call.

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> nice_mock;
```

### StrictMock

- Treats uninteresting calls as **test failures**.
- Use when you want to enforce *strict* adherence to mock expectations.

```cpp
using ::testing::StrictMock;
StrictMock<MockFoo> strict_mock;
```

### Behavior Summary

| Wrapper    | Uninteresting Calls Behavior               | Warning or Failure   |
|------------|--------------------------------------------|---------------------|
| NaggyMock  | Warns but test continues                    | Warning             |
| NiceMock   | Silently ignores uninteresting calls       | No warning          |
| StrictMock | Fails the test on uninteresting calls      | Test Failure        |

### Using Wrappers with Constructor Arguments

Wrappers inherit constructors of the underlying mock class, so you can pass any arguments to construct the mock:

```cpp
NiceMock<MockBar> nice_bar("test_input");
StrictMock<MockBar> strict_bar('a', 'b', "foo", "bar", 1, 2, "x", "y", true, false);
```

### Choosing the Right Wrapper

- Use **NiceMock** to reduce warning noise when you consciously ignore uninteresting calls.
- Use **NaggyMock** (default) when you want to be alerted but not fail for uninteresting calls.
- Use **StrictMock** to prevent any unplanned interactions, guaranteeing comprehensive mock validation.

### Important Notes

- Wrappers only affect *uninteresting* calls, not *unexpected* calls, which always fail.
- Wrappers only work correctly for mock methods defined **directly** with `MOCK_METHOD` in the mock class.
- You should not nest wrappers (e.g., `NiceMock<StrictMock<MockFoo>>`) as it is unsupported.

---

## Using Matchers and Mock Wrappers: Typical Workflow

1. **Import GoogleMock symbols** and define your mock class normally with `MOCK_METHOD`.
2. **Choose a wrapper** (`NiceMock`, `NaggyMock`, or `StrictMock`) based on your testing strictness needs.
3. **Set expectations using `EXPECT_CALL`**, specifying argument matchers to define how your mock methods will be called.
4. **Run your tests** and interpret warnings and failures according to the wrapper behavior.

### Example: Using Matchers with a StrictMock

```cpp
#include <gmock/gmock.h>
using ::testing::
    StrictMock, _ , Eq;

class MockFoo {
 public:
  MOCK_METHOD(void, Bar, (int x), ());
};

TEST(FooTest, UsesStrictMock) {
  StrictMock<MockFoo> mock;
  EXPECT_CALL(mock, Bar(Eq(42)));  // Expect Bar to be called with 42.
  mock.Bar(42);                    // Passes.
  mock.Bar(10);                   // Fails: unexpected call.
}
```

### Example: Suppressing Warnings with NiceMock

```cpp
using ::testing::NiceMock;

NiceMock<MockFoo> nice_mock;
// No EXPECT_CALL for Bar
nice_mock.Bar(123);  // No warning
```

---

## Troubleshooting Common Issues

- **Uninteresting call warnings:** Consider if you intended to ignore calls or if you forgot to add expectations. Suppress warnings selectively with `NiceMock` or add `EXPECT_CALL(...).Times(AnyNumber())`.

- **Unexpected calls causing test failures:** Verify that your argument matchers are correct and expectations are set before exercising the mock.

- **Mock methods not behaving as expected:** Ensure methods are mocked with `MOCK_METHOD` and not accidentally calling real implementations.

- **Using wrappers with mocks from base classes:** Be aware that strictness wrappers might not affect inherited mock methods properly.

---

## Related Pages and References

- [gMock Tutorial for Beginners](https://google.github.io/googletest/gmock_for_dummies.html) for concrete mock setup and expectation examples.
- [GoogleMock Mocking Reference](reference/mocking.md) for complete details on `EXPECT_CALL`, matchers, actions, and wrappers.
- [Mock Strictness: Nice, Naggy, and Strict Mocks](guides/mocking-masterclass/mock-class-strictness.mdx) for deep dive on mock object strictness.
- [GoogleMock Cookbook](gmock_cook_book.md) for advanced usage patterns and recipes.

---

## Summary

Argument matchers in GoogleMock allow you to specify what method arguments you expect during testing, providing flexible and expressive verification. Coupled with the choice of NiceMock, NaggyMock, or StrictMock wrappers, you control how strictly your mocks handle unmet or unexpected call expectations—striking the right balance between test reliability and ease of maintenance.

<Check>
Ensure you apply matchers judiciously to avoid brittle tests, and select the appropriate mock wrapper to match your test's rigor and verbosity requirements.
</Check>

---