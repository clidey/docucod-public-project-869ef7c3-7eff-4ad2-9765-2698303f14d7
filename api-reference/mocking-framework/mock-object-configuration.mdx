---
title: "Mock Object Configuration & Strictness"
description: "Provides APIs for configuring mocks’ behaviors towards unexpected or uninteresting calls, using NiceMock, NaggyMock, and StrictMock. Highlights best practices for test reliability and signal-to-noise ratio."
---

# Mock Object Configuration & Strictness

Google Mock offers powerful APIs designed to configure how mock objects behave, especially when they receive unexpected or uninteresting calls. This page focuses on the usage and implications of mock object configuration classes — specifically `NiceMock`, `NaggyMock`, and `StrictMock` — that help you manage the signal-to-noise ratio in your tests, ensure test reliability, and foster cleaner test outputs.

---

## Overview

In interaction-based testing, mock objects play a critical role by verifying the behavior of the code under test. However, the handling of **uninteresting calls** (calls for which no explicit expectations are set) can significantly impact how you interpret test results and the noise level in test logs.

Google Mock lets you control how these calls are handled on a per-mock-object basis using three primary wrappers:

- **NiceMock<T>**: Silences warnings about uninteresting calls.
- **NaggyMock<T>**: (Default behavior) Warns when uninteresting calls occur.
- **StrictMock<T>**: Treats uninteresting calls as test failures.

This design empowers you to choose between strict enforcement and more lenient mock behavior, letting you balance test strictness and maintenance overhead.


---

## The Three Mock Object Configurations

### 1. `NiceMock<T>`
Suppresses warnings on uninteresting calls, allowing your tests to run quietly when methods not explicitly expected get called. This is commonly used when those calls are genuinely uninteresting and not indicative of test failures.

#### Usage Example:
```cpp
using ::testing::NiceMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), (override));
  MOCK_METHOD(int, Compute, (int x), (override));
};

TEST(ExampleTest, UsesNiceMock) {
  NiceMock<MockFoo> mock_foo;

  // Only DoThis is expected; calls to other methods are ignored without warnings.
  EXPECT_CALL(mock_foo, DoThis());

  mock_foo.DoThis();   // satisfies expectation
  mock_foo.Compute(42);  // no warning, no failure
}
```

<Note>
`NiceMock<T>` inherits from `T`, so it can be used anywhere `T` is accepted. It also inherits constructors, so you can provide constructor arguments.
</Note>

### 2. `NaggyMock<T>`
This is the **default behavior** of plain mock objects. They emit warnings on uninteresting calls, helping you notice unexpected behavior that may or may not be a test failure.

If you want to keep track of uninteresting calls but not fail tests on them, this type is appropriate.

<Warning>
Naggy mocks can produce noisy logs when mocks have many uninteresting method calls. Use judiciously during test development or debugging.
</Warning>

### 3. `StrictMock<T>`
Enforces test discipline by failing tests if an uninteresting call occurs.

Use when you want to ensure that no mock calls have gone unverified, which is useful for critical modules or when building highly maintainable test suites.

#### Usage Example:
```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_mock;

EXPECT_CALL(strict_mock, DoThis());

strict_mock.DoThis();  // Okay
strict_mock.Compute(10);  // Test failure: uninteresting call not expected
```

<Warning>
`StrictMock<T>` may not catch uninteresting calls on mock methods defined in base classes of `T` due to C++ limitations. Also, the destructor of `T` should be virtual for correct behavior.
</Warning>

---

## Choosing the Right Mock Configuration

The three mock configurations provide a trade-off:

| Mock Wrapper          | Behavior on Uninteresting Calls       | Recommended For                             |
|----------------------|--------------------------------------|--------------------------------------------|
| `NiceMock<T>`        | No warnings, calls ignored            | Reducing noise, when uninteresting calls are acceptable |
| `NaggyMock<T>` (default) | Emits warnings on uninteresting calls | General-purpose use and during test development  |
| `StrictMock<T>`      | Fails tests on uninteresting calls   | Guaranteeing full mock coverage and strict testing |

### Best Practices

- **Default to NiceMock** for most tests to keep outputs clean and focus on failures that matter.
- Use **NaggyMock** during debugging to detect calls you might have overlooked.
- Reserve **StrictMock** for critical interfaces or when building tests that must never tolerate unexpected calls.

---

## How to Use Mock Object Configurations

Given a mock class:

```cpp
class MockFoo {
 public:
  MOCK_METHOD(int, DoThing, (int), (override));
  MOCK_METHOD(void, DoOtherThing, (), (override));
};
```

You can instantiate with different behaviors:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

NiceMock<MockFoo> nice_mock;   // ignores uninteresting calls
NaggyMock<MockFoo> naggy_mock; // warns on uninteresting calls (default)
StrictMock<MockFoo> strict_mock; // fails on uninteresting calls
```

These mock objects can be used the same way as the original mock class.

---

## How Mock Configuration Affects Test Behavior

### Uninteresting Calls

An *uninteresting call* occurs when a mock method without any explicit `EXPECT_CALL` is invoked.

- **NiceMock**: Uninteresting calls are silently allowed.
- **NaggyMock**: Uninteresting calls generate warnings but do not fail the test.
- **StrictMock**: Uninteresting calls cause immediate test failures.

### Unexpected Calls

An *unexpected call* happens when there are expectations set but none match the actual call.

- In **all** configurations, unexpected calls cause test failures.

---

## Managing Uninteresting Calls on Specific Mock Methods

If you want to allow uninteresting calls for certain methods within an otherwise strict mock, consider adding a catch-all expectation:

```cpp
EXPECT_CALL(mock, SomeMethod(_)).Times(testing::AnyNumber());
```

This tells Google Mock to expect any number of calls to `SomeMethod` with any arguments, suppressing uninteresting call failure for this method.

---

## Runtime Control and Diagnostics

Google Mock provides flags and functions to control verbosity and analyze mock behavior:

- `--gmock_verbose=LEVEL` controls the verbosity; levels are `info` (most verbose), `warning` (default), and `error` (quiet).
- Use `Mock::AllowLeak(&mock_obj)` to allow a mock object to be leaked without generating failure.
- Use `Mock::VerifyAndClearExpectations(&mock_obj)` to manually verify expectations before destruction.

---

## Behind the Scenes

- Internally, Google Mock maintains a registry of mock objects and their expectations.
- Calls to mocked methods consult this registry, using the wrapper configuration to decide whether warnings or failures happen on uninteresting calls.
- The search for matching expectations is last to first, allowing later expectations to override earlier ones.

---

## Practical Tips and Common Pitfalls

- **Always set expectations before exercising the mock**. Setting expectations late leads to undefined behavior.
- **Use `NiceMock` during initial test development** to avoid being overwhelmed by warnings.
- **Use `StrictMock` only in final tests or critical modules**, as it results in brittle tests that require frequent maintenance.
- **Avoid nesting `NiceMock` and `StrictMock`**, e.g., `NiceMock<StrictMock<MockFoo>>` is unsupported.
- Ensure your mock classes have **virtual destructors** for behavior correctness.
- For mock methods defined in base classes, the configuration wrappers may not affect their warning/failure behavior.

---

## Summary

Mock object configuration is a straightforward yet powerful way to calibrate how much your tests enforce on mock interactions. By choosing between `NiceMock`, `NaggyMock`, and `StrictMock`, you tailor your testing feedback to your current phase of development and the strictness your tests deserve.

---

## References

- [GoogleMock Cheat Sheet - Nice, Strict, and Naggy](https://google.github.io/googletest/gmock_cheat_sheet.html#NiceStrictNaggy)
- [Mocking Reference - Mock Classes and Mock Object Configuration](docs/reference/mocking.md#NiceMock)
- [gMock Cookbook - The Nice, the Strict, and the Naggy](docs/gmock_cook_book.md#NiceStrictNaggy)
- [gMock for Dummies - Using Mocks in Tests](docs/gmock_for_dummies.md#UsingMocks)

---

## See Also

- [Setting Expectations & Actions](api-reference/mocking-framework/expectations-actions.md) for detailed expectation setup
- [Matchers Reference](api-reference/mocking-framework/matchers.md) for argument matching
- [Defining Mock Classes & Methods](api-reference/mocking-framework/mock-classes-methods.md) for mock class setup
- [Mocking Patterns and Best Practices](guides/common_patterns_scenarios/mocking_patterns_and_strategies.md) for practical advice

---

<Callout title="Why Using the Right Mock Config Matters">
Choosing the correct strictness for your mocks directly impacts test clarity, developer productivity, and reliability. Overly strict mocks can make your tests fragile and high maintenance, while overly lenient mocks can hide bugs. The sweet spot is where your tests meaningfully notify you of real issues without noise.
</Callout>

---

<AccordionGroup title="Mock Object Configuration FAQs">
<Accordion title="What happens if I mix different mock configurations?">
Nesting or mixing wrappers like `NiceMock<StrictMock<MockFoo>>` is **not supported** and leads to unpredictable behavior.
</Accordion>
<Accordion title="How do I suppress warnings for some methods but fail for others?">
Add an `EXPECT_CALL` with `Times(AnyNumber())` on uninteresting methods to cascade suppression selectively.
</Accordion>
<Accordion title="Is it possible to change a mock object's strictness at runtime?">
Mock strictness is set at construction time via the wrapper (Nice/Naggy/Strict). At runtime, use `Mock::WarnUninterestingCalls`, `Mock::AllowUninterestingCalls`, or `Mock::FailUninterestingCalls` to adjust behavior programmatically.
</Accordion>
</AccordionGroup>