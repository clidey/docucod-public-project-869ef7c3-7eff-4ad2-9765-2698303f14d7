---
title: "Mock Class Definition"
description: "Explains how to define and use mock classes using GoogleMock's macros and templates. Includes guidance on generating mock methods for various signatures, argument types, and qualifiers."
---

# Mock Class Definition

This page explains how to define and use mock classes with GoogleMock. Mock classes let you simulate the behavior of real classes or interfaces in your tests by generating mock methods for various function signatures, argument lists, and qualifiers using GoogleMock’s macros and templates.

---

## Defining Mock Classes with `MOCK_METHOD`

GoogleMock provides the powerful `MOCK_METHOD` macro to create mock methods within your mock classes. Defining a mock class involves these key steps:

- Derive your mock class from the interface or base class you want to mock.
- In the `public:` section of your mock class, declare mock methods using `MOCK_METHOD`.

### Basic Usage

The `MOCK_METHOD` macro takes 3 or 4 parameters:

```cpp
MOCK_METHOD(ReturnType, MethodName, (Args...), (Qualifiers));
```

- **ReturnType**: The return type of the mocked method.
- **MethodName**: The method's name.
- **Args...**: The argument list in parentheses.
- **Qualifiers**: (Optional) a list of method qualifiers like `const`, `override`, `noexcept`, calling convention, and reference qualifiers.

Example:

```cpp
class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, Turn, (int degrees), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

### Using Qualifiers

You should specify qualifiers to correctly match the original method, especially for:

- `const` methods: e.g., `(const, override)`
- `override`: recommended for virtual methods
- `noexcept` if appropriate
- Calling conventions via `Calltype(...)`
- Reference qualifiers such as `ref(&)` or `ref(&&)`

### Handling Commas in Types

Types with commas (e.g., template types like `std::pair<bool, int>`) must be wrapped in extra parentheses or replaced with type aliases:

```cpp
// Wrap types containing commas
MOCK_METHOD((std::pair<bool, int>), GetPair, ());

// Or use type alias
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());
```

### Mocking Non-Virtual Methods

GoogleMock allows mocking of non-virtual methods by defining a mock class unrelated to the real class but with matching method signatures (without `override` qualifier):

```cpp
class MockPacketStream {
 public:
  MOCK_METHOD(const Packet*, GetPacket, (size_t packet_number), (const));
  MOCK_METHOD(size_t, NumberOfPackets, (), (const));
};
```

You will use template-based dependency injection or other compile-time techniques to switch between real and mock types.

### Mocking Overloaded Methods

Mock each overload distinctly:

```cpp
MOCK_METHOD(int, Add, (Element x), (override));
MOCK_METHOD(int, Add, (int times, Element x), (override));
MOCK_METHOD(Bar&, GetBar, (), (override));
MOCK_METHOD(const Bar&, GetBar, (), (const, override));
```

If you mock only some overloads, use `using` declarations to bring the others into scope:

```cpp
using Foo::Add;  // Bring in base class overloads
```

### Mocking Template Classes

You can mock class templates naturally:

```cpp
template <typename Elem>
class MockStack : public StackInterface<Elem> {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(void, Push, (const Elem& x), (override));
};
```

### Mocking Private or Protected Methods

Always put the `MOCK_METHOD` declarations in `public:` for access by testing code, even if the base class method is `protected` or `private`:

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, Resume, (), (override));   // base class protected
  MOCK_METHOD(int, GetTimeOut, (), (override));  // base class private
};
```

### Mocking Free Functions

Direct mocking of free (non-member) functions is not supported. Instead, introduce an interface:

```cpp
class FileInterface {
 public:
  virtual bool Open(const char* path, const char* mode) = 0;
};
```

Then provide a concrete implementation and mock this interface.

### Old `MOCK_METHODn` Macros

Previously, GoogleMock provided `MOCK_METHODn` macros per arity. These are superseded by the generic `MOCK_METHOD` macro but still supported:

| Old Macro                   | New Equivalent                                     |
| --------------------------- | ------------------------------------------------- |
| `MOCK_METHOD1(Foo, bool(int))`           | `MOCK_METHOD(bool, Foo, (int))`                  |
| `MOCK_CONST_METHOD1(Foo, bool(int))`     | `MOCK_METHOD(bool, Foo, (int), (const))`         |
| `MOCK_METHOD1_T(Foo, bool(int))`         | `MOCK_METHOD(bool, Foo, (int))`                  |
| `MOCK_METHOD1_WITH_CALLTYPE(STDMETHODCALLTYPE, Foo, bool(int))` | `MOCK_METHOD(bool, Foo, (int), (Calltype(STDMETHODCALLTYPE)))` |

Refer to the [Mocking Reference](reference/mocking.md#MOCK_METHOD) for details.

---

## Using Mock Objects

1. Include `#include <gmock/gmock.h>`.
2. Create instances of your mock class:

```cpp
MockTurtle turtle;
```

3. Specify expectations on mock methods with `EXPECT_CALL`.
4. Optionally define default behaviors with `ON_CALL`.
5. Use the mock object in your tests; GoogleMock will verify calls and argument matching automatically.

Example:

```cpp
#include <gmock/gmock.h>

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
};

TEST(PainterTest, DrawsCircle) {
  MockTurtle turtle;

  EXPECT_CALL(turtle, PenDown()).Times(1);
  EXPECT_CALL(turtle, Forward(100)).Times(AtLeast(1));

  Painter painter(&turtle);
  painter.DrawCircle(0, 0, 10);
}
```

---

## Specialized Mock Classes: NiceMock, NaggyMock, StrictMock

GoogleMock offers decorators for mock objects that control behavior on uninteresting calls:

- **NiceMock<T>** suppresses warnings on uninteresting calls.
- **NaggyMock<T>** (default in most builds) warns on uninteresting calls.
- **StrictMock<T>** treats uninteresting calls as test failures.

Create these by wrapping your mock class:

```cpp
NiceMock<MockTurtle> nice_turtle;
NaggyMock<MockTurtle> naggy_turtle;
StrictMock<MockTurtle> strict_turtle;
```

> **Tip:** Prefer `NiceMock` to reduce test noise. Use `StrictMock` only when you want to catch unexpected calls strictly.

---

## Best Practices

- Always place `MOCK_METHOD` declarations in the `public:` section.
- Match the original method qualifiers (const, noexcept, override) exactly.
- Use type aliases or extra parentheses to handle complex argument types involving commas.
- Use `EXPECT_CALL` to set expectations before exercising the mock.
- Use `ON_CALL` to specify default behavior without setting an expectation.
- Use `NiceMock` to suppress warnings on uninteresting calls and reduce noise.
- For non-virtual methods, consider high-performance dependency injection patterns.
- Avoid mocking free functions directly; prefer interfaces.

---

## Troubleshooting

- If your mock does not compile due to overload ambiguity, specify argument types clearly or use `using` to disambiguate base class methods.
- Missing or incorrect qualifiers in `MOCK_METHOD` can cause compilation or runtime errors.
- Warnings about uninteresting calls mean calls occurred without matching expectations; consider using `NiceMock` or adding catch-all expectations.
- If you encounter unexpected call failures, check that `EXPECT_CALL`s are set before exercising the mock and that the argument matchers match your actual call arguments.

---

## Additional Resources

- [Mocking Reference](reference/mocking.md) — Detailed documentation on mocking macros, classes, and functions.
- [gMock Cookbook](guides/advanced-testing-patterns/mocking-with-googlemock.mdx) — Practical examples and best practices for mocks.
- [gMock for Dummies](docs/gmock_for_dummies.md) — Beginner-friendly introduction to mocking.
- [MOCK_METHOD macro details](reference/mocking.md#MOCK_METHOD) — Exact syntax and available qualifiers.
- [Nice, Naggy, and Strict mocks](reference/mocking.md#NiceStrictNaggy) — Behavior variants for mock objects.

---

This page focuses exclusively on mock class definitions and their creation via GoogleMock macros and templates, providing you with the foundation to build mocks tailored to your testing needs.