---
title: "Mock Strictness Wrappers"
description: "How to use NiceMock, NaggyMock, and StrictMock wrappers to control mock object behavior for uninteresting or unexpected calls, supporting test maintainability and granularity."
---

# Mock Strictness Wrappers

Control the handling of **uninteresting calls**—calls to mock methods without explicit expectations—by using NiceMock, NaggyMock, and StrictMock wrappers. These wrappers help you balance between test maintainability and strictness, allowing you to specify whether uninteresting calls should be silently ignored, generate warnings, or cause test failures.

---

## Why Control Mock Strictness?

When using GoogleMock, uninteresting calls on mock objects can:

- Be silently allowed and produce no output (*NiceMock* behavior).
- Generate warnings to alert you of unexpected usage (*NaggyMock* behavior, the current default).
- Cause immediate test failures, enforcing exact call expectations (*StrictMock* behavior).

Choosing the right strictness level improves test clarity and robustness. You can suppress noise from irrelevant calls, catch unplanned interactions early, or strike a balance tailored to your testing needs.

---

## The Wrappers at a Glance

Each wrapper is a class template inheriting your mock class with a specified strictness:

| Wrapper         | Behavior on Uninteresting Calls                           | Use Case                                                   |
|-----------------|-----------------------------------------------------------|------------------------------------------------------------|
| `NiceMock<T>`   | Silently allows uninteresting calls without warnings.     | Ideal for tests focusing on specific interactions, suppressing noise.        |
| `NaggyMock<T>`  | Prints warnings for uninteresting calls (default).        | Useful during test development or debugging to identify unintended calls.      |
| `StrictMock<T>` | Treats uninteresting calls as errors, causing test failures.| Enforces rigorous mock usage; useful for tight control and behavioral correctness. |

All wrappers accept constructor arguments compatible with the underlying mock, supporting classes with non-default constructors.

---

## Using Strictness Wrappers

### Basic Usage

Wrap your mock class with the desired strictness wrapper:

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoSomething, ());
  MOCK_METHOD(int, Calculate, (int x), (const));
};

TEST(ExampleTest, NiceMockExample) {
  NiceMock<MockFoo> nice_mock;

  EXPECT_CALL(nice_mock, DoSomething());  // Expectation as usual.

  nice_mock.DoSomething();    // Passes silently.
  nice_mock.Calculate(42);    // Allowed even if no expectation, no warning.
}

TEST(ExampleTest, NaggyMockExample) {
  NaggyMock<MockFoo> naggy_mock;

  EXPECT_CALL(naggy_mock, DoSomething());

  naggy_mock.DoSomething();  // As expected.
  naggy_mock.Calculate(42);  // Warning: uninteresting call.
}

TEST(ExampleTest, StrictMockExample) {
  StrictMock<MockFoo> strict_mock;

  EXPECT_CALL(strict_mock, DoSomething());

  strict_mock.DoSomething();  // Passes.
  strict_mock.Calculate(42);  // Fails test: unexpected uninteresting call.
}
```

### Using Wrappers with Mocks That Have Parameters

If your mock class constructor requires parameters, just forward them through:

```cpp
NiceMock<MockFoo> mock_with_args(5, "example");
```

This behavior works similarly with `NaggyMock` and `StrictMock`.

---

## How Strictness Is Implemented Under the Hood

Each wrapper internally registers its desired reaction to uninteresting calls with the global mock registry. This ensures consistent behavior across all mock methods in the object:

- `NiceMock` registers to **allow** uninteresting calls without notification.
- `NaggyMock` registers to **warn** on uninteresting calls.
- `StrictMock` registers to **fail** on uninteresting calls.

When a mock method is called without a matching expectation, GoogleMock queries this setting and reacts accordingly.

---

## Best Practices

- **Prefer `NiceMock` in most cases** to reduce noise and keep tests maintainable.
- Use `NaggyMock` during **test development or debugging** phases to catch unexpected interactions.
- Reserve `StrictMock` for **critical tests** where every mock interaction must be verified.
- Avoid nesting strictness wrappers (e.g., `NiceMock<StrictMock<MockFoo>>`), as this is unsupported.
- Remember wrappers only affect **uninteresting calls** (no expectations); unexpected calls that do not match any expectation always cause errors.

---

## Common Pitfalls

- Wrappers only work for methods defined with the `MOCK_METHOD` macros **directly** in the mock class. Methods inherited from base classes may not respect the strictness.
- If your mock class destructor is not `virtual`, behavior might be undefined or inconsistent.
- Avoid defining `EXPECT_CALL` on uninteresting methods just to suppress warnings—use `NiceMock` or appropriate cardinalities instead.

---

## Verifying and Resetting Mocks

You can verify mock expectations explicitly and reset mocks using:

```cpp
// Verify but keep default actions.
::testing::Mock::VerifyAndClearExpectations(&mock_obj);

// Verify and clear expectations and default actions.
::testing::Mock::VerifyAndClear(&mock_obj);

// Allow leaking a mock (skip verification).
::testing::Mock::AllowLeak(&mock_obj);
```

This is useful to force verification before mock destruction or to reuse mocks safely.

---

## Summary

Strictness wrappers provide a crucial layer of control over mock behavior, letting you silence, warn on, or error out on mock calls that are uninteresting to the test. Adopting the appropriate wrapper improves your test clarity and robustness without burdening every test with irrelevant warnings or brittle failures.

---

## Related Topics

- [`MOCK_METHOD` macro and mock class definitions](mock-method-macros.md)
- [`EXPECT_CALL` and call expectations](cardinalities-and-expectations.md)
- [Default actions and `ON_CALL`](mock-method-macros.md#ON_CALL)
- [Understanding uninteresting vs unexpected calls](gmock_cook_book.md#NiceStrictNaggy)

## Learn More

- [gMock Cookbook section on Nice, Naggy, and Strict Mocks](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [Mocking Basics Guide](../guides/get-started/mocking-basics.md)

---

<Accordion title="Code Example: Using Strictness Wrappers">
```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockWidget {
 public:
  MOCK_METHOD(void, Refresh, (), ());
  MOCK_METHOD(int, Compute, (int), (const));
};

TEST(WrapperExample, NiceMockSuppressesWarnings) {
  NiceMock<MockWidget> mock;
  // Only cares about Refresh.
  EXPECT_CALL(mock, Refresh());

  mock.Refresh();        // OK
  mock.Compute(5);        // Silently allowed (no warning or failure)
}

TEST(WrapperExample, NaggyMockWarnsOnUninterestingCall) {
  NaggyMock<MockWidget> mock;

  EXPECT_CALL(mock, Refresh());
  mock.Refresh();        // OK
  mock.Compute(5);        // Warning: uninteresting call.
}

TEST(WrapperExample, StrictMockFailsOnUninterestingCall) {
  StrictMock<MockWidget> mock;

  EXPECT_CALL(mock, Refresh());
  mock.Refresh();        // OK
  mock.Compute(5);        // Test failure: unexpected uninteresting call.
}
```
</Accordion>

---

## Troubleshooting

<AccordionGroup title="Common Issues with Strictness Wrappers">
<Accordion title="Uninteresting call warning not suppressed in NiceMock">
If you define mock methods in a base class of your target mock, the strictness wrappers may not affect them. Ensure `MOCK_METHOD` is used directly in the mock class you are wrapping.
</Accordion>
<Accordion title="Test failure on uninteresting calls when using NaggyMock">
This behavior is expected: NaggyMock prints warnings but does not fail tests on uninteresting calls. Switch to `NiceMock` to suppress warnings or `StrictMock` to fail such calls.
</Accordion>
<Accordion title="Unexpected call errors still occur in NiceMock">
NiceMock suppresses only uninteresting call warnings. Unexpected calls (calls that do not match any expectation) always cause errors regardless of the wrapper used.
</Accordion>
</AccordionGroup>

---

## Implementation Diagram

```mermaid
graph TD

  M ["Mock Object"]
  NM["NiceMock Wrapper"]
  NGM["NaggyMock Wrapper"]
  SM ["StrictMock Wrapper"]

  MORegistry[("Mock Object Registry")]
  ReactionMap[("Uninteresting Call Reaction Map")]

  NM -->|Registers: allow uninteresting calls| MORegistry
  NGM -->|Registers: warn on uninteresting calls| MORegistry
  SM -->|Registers: fail on uninteresting calls| MORegistry

  MORegistry --> ReactionMap

  subgraph MockCallHandling
    MC["Mock Method Call"]
    MC -->|checks reaction behavior| ReactionMap
    ReactionMap -->|allow|  ALLOW["Allow call"]
    ReactionMap -->|warn| WARN["Warn uninteresting call"]
    ReactionMap -->|fail| FAIL["Fail test"]
  end

  classDef wrappers fill:#f9f,stroke:#333,stroke-width:2px;
  class NM,NGM,SM wrappers;

```

---