---
title: "Mock Strictness Controls"
description: "Describes how to use NiceMock, StrictMock, and NaggyMock class templates to manage mock call strictness, allowing tests to ignore, warn or fail on unexpected calls. Explains trade-offs and scenarios for each mock variant."
---

# Mock Strictness Controls

GoogleMock provides three class templates—`NiceMock`, `NaggyMock`, and `StrictMock`—that control how uninteresting calls to mock objects are handled in tests. By wrapping your mock class with one of these templates, you can choose whether unexpected calls are ignored, warned about, or treated as errors. This page explains the behavior and trade-offs of each mock strictness variant to help you decide which fits your testing scenarios best.

---

## Understanding Mock Strictness

When using mocks, **uninteresting calls** are calls to mock methods that have no associated `EXPECT_CALL` expectation set. How these calls are handled is crucial for managing test maintainability and clarity:

- **Ignorance**: The test silently allows such calls.
- **Warning**: The test prints warnings but continues.
- **Failure**: The test fails immediately.

GoogleMock provides three mock wrappers to control this behavior:

| Mock Variant    | Behavior on Uninteresting Calls                        | Typical Use Case                                         |
|-----------------|--------------------------------------------------------|----------------------------------------------------------|
| `NiceMock<T>`   | Ignores uninteresting calls silently                   | When you want to reduce noise and allow implicit calls    |
| `NaggyMock<T>`  | Prints warnings on uninteresting calls (default today) | When you want to be alerted but not fail tests            |
| `StrictMock<T>` | Treats uninteresting calls as test failures            | When you want strict verification, no unhandled calls    |


## Using Mock Strictness Wrappers

These wrappers subclass your mock type and adjust its behavior regarding uninteresting calls. They also inherit your mock's constructors, so you can seamlessly substitute your mock with one of these wrappers without changing your test setup.

```cpp
#include <gmock/gmock.h>

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
};

// Using NiceMock: uninteresting calls are silently ignored
testing::NiceMock<MockFoo> nice_foo;

// Using NaggyMock: uninteresting calls print warnings
testing::NaggyMock<MockFoo> naggy_foo;

// Using StrictMock: uninteresting calls cause test failures
testing::StrictMock<MockFoo> strict_foo;
```

If your mock class constructor takes arguments, you can forward them directly:

```cpp
NiceMock<MockFoo> nice_foo(5, "hello");
StrictMock<MockFoo> strict_foo(5, "hello");
```

## Behavior and Trade-offs

### NiceMock<T>
- **Ignores uninteresting calls silently.**
- Encourages focusing tests only on explicitly expected interactions.
- Useful in large mocks where irrelevant calls should not clutter test output.
- Example scenario: When testing a complex object that calls many helper methods, and you only care to verify some.

<CodeGroup>
```cpp
NiceMock<MockFoo> nice_foo;
EXPECT_CALL(nice_foo, DoThis());
nice_foo.DoThis();            // Expected call succeeds
nice_foo.AnotherMethod();    // Uninteresting call: silently ignored
```
```cpp
// Note: If an uninteresting call returns a type that is not default-constructible, NiceMock will throw or terminate.
```
</CodeGroup>

### NaggyMock<T> (Default Mock Behavior Currently)
- **Prints warnings** on uninteresting calls but does not fail the test.
- Helps to alert developers about unexpected interactions while still allowing tests to pass.
- Good for development or debugging tests to catch surprises.
- The default behavior of mocks today; subject to change to "nice" in future versions.

<CodeGroup>
```cpp
NaggyMock<MockFoo> naggy_foo;
EXPECT_CALL(naggy_foo, DoThis());
naggy_foo.DoThis();          // Expected call succeeds
naggy_foo.AnotherMethod();  // Uninteresting call: prints warning
```
```text
GMOCK WARNING: Uninteresting mock function call - returning default value.
    Function call: AnotherMethod()
    ...stack trace...
```
</CodeGroup>

### StrictMock<T>
- **Treats uninteresting calls as errors causing test failures.**
- Enforces strict interaction specifications.
- Useful in tests where you want to ensure no unexpected calls happen.
- Best used in stable test suites where all interactions are deliberately expected.

<CodeGroup>
```cpp
StrictMock<MockFoo> strict_foo;
EXPECT_CALL(strict_foo, DoThis());
strict_foo.DoThis();          // Expected call succeeds
strict_foo.AnotherMethod();  // Uninteresting call: test fails immediately
```
```text
... Failure: Uninteresting mock function call
    Function call: AnotherMethod()
```
</CodeGroup>

## Key Points When Choosing Strictness

- **Uninteresting vs Unexpected Calls:** Wrappers only affect uninteresting calls (no matching `EXPECT_CALL`). Unexpected calls (calls with mismatched arguments against existing expectations) always fail.
- **Maintaining Tests:** Overly strict mocks can cause fragile tests that fail on legitimate code refactoring. Overly lenient mocks might miss bugs.
- **Constructor Forwarding:** You can use these wrappers with mocks that have custom constructors.
- **Nested Wrappers:** Nesting `NiceMock`, `NaggyMock`, or `StrictMock` is not supported.
- **Limitations:** These wrappers only affect mock methods declared directly in the mock class with `MOCK_METHOD`. Methods inherited from base classes may not be affected depending on compiler behavior.

## Troubleshooting Common Scenarios

<Tip>
If you see warnings or failures due to uninteresting calls that you expect to be ignored, try wrapping your mock in `NiceMock`.
</Tip>

<Tip>
To enforce strict mock behavior (fail on any unexpected method calls), use `StrictMock`. This helps keep your mocks clean and interaction errors visible.
</Tip>

<Warning>
If your mock class does not have a virtual destructor, behavior with `NiceMock` and `StrictMock` may be unpredictable. Always ensure your mock's base class has a virtual destructor.
</Warning>

## Practical Example

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

class Foo {
 public:
  virtual ~Foo() {}
  virtual void DoThis() = 0;
  virtual int DoThat(bool flag) = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, DoThis, (), (override));
  MOCK_METHOD(int, DoThat, (bool flag), (override));
};

TEST(FooTest, UsingStrictMock) {
  testing::StrictMock<MockFoo> mock;

  // Expect DoThis to be called once.
  EXPECT_CALL(mock, DoThis());

  mock.DoThis();  // Passes

  // Call to DoThat is uninteresting => test failure
  mock.DoThat(true); // Fails test
}

TEST(FooTest, UsingNiceMock) {
  testing::NiceMock<MockFoo> mock;

  EXPECT_CALL(mock, DoThis());

  mock.DoThis();    // Passes
  mock.DoThat(true); // Silently ignored
}
```

## Summary

| Behavior                 | NiceMock         | NaggyMock         | StrictMock        |
|--------------------------|------------------|-------------------|-------------------|
| On uninteresting calls   | Ignored silently | Prints warnings   | Treats as errors  |
| Test execution           | Continues        | Continues         | Fails immediately |
| Typical usage            | Default preferred | Current default   | Highest strictness |
| Impact on unexpected calls | No effect       | No effect         | No effect         |

## Additional Tips & Best Practices

- Use `NiceMock` by default to reduce noise; switch to `StrictMock` when you want to lock down the expected interactions.
- Always declare expectations before exercising your mock to avoid undefined behavior.
- Combine `EXPECT_CALL` with argument matchers for precise control of expected calls.
- Use the command-line flag `--gmock_verbose=info|warning|error` to adjust diagnostic message verbosity.

## Related Documentation & References

- [Setting Expectations and Sequences](https://github.com/google/googletest/blob/main/docs/reference/mocking.md#EXPECT_CALL)
- [Actions and Matchers for Mocks](https://github.com/google/googletest/blob/main/docs/api-reference/mocking-framework/actions-and-matchers.md)
- [Writing Mocks Guide](https://github.com/google/googletest/blob/main/docs/guides/core-workflow/writing-mocks.md)
- [Understanding Uninteresting vs Unexpected Calls](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#NiceStrictNaggy)

---

For further mastery, consult the GoogleMock [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md) and [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md).


---

<Info>
GoogleMock currently defaults to naggy mocks, warning on uninteresting calls. This may change to nice mocks in future releases for greater test maintainability.
</Info>

<Warning>
Do not nest `NiceMock`, `NaggyMock`, or `StrictMock`. Wrapping a mock already wrapped with one of these will cause compilation errors.
</Warning>

<Check>
Ensure your mock classes have virtual destructors for correct strictness behavior.
</Check>

---

<AccordionGroup title="Key Differences Between Mock Strictness Wrappers">
<Accordion title="NiceMock">
Allows all uninteresting calls silently with no warnings or failures.

- Use to reduce test noise
- Default recommended strictness
- May throw if method returns non-default-constructible type on unexpected call
</Accordion>
<Accordion title="NaggyMock">
Prints warnings when uninteresting calls occur but does not fail.

- Useful during test development
- Default mock behavior at present
- Keeps tests informative without breaking
</Accordion>
<Accordion title="StrictMock">
Fails tests on any uninteresting call, enforcing all calls are expected.

- Best for strict interaction testing
- Quickly catches unexpected calls
- May increase test brittleness
</Accordion>
</AccordionGroup>

---

## How to Choose the Right Mock Strictness

1. **Developing Tests:** Use `NaggyMock` to detect unexpected interactions early.
2. **Stable Code Base:** Switch to `NiceMock` to avoid flaky failures due to unimportant calls.
3. **Strict Contracts:** Use `StrictMock` to enforce precise test expectations.

---

## Constructor Forwarding Details

The strictness wrappers forward constructors of your mock class:

- You can instantiate with any arguments your mock class supports.
- Single-argument constructors must be explicit wrapped.
- Supports any number of constructor arguments.

Example:

```cpp
NiceMock<MockFoo> mock_foo(10, "hello");
StrictMock<MockFoo> strict_foo(20);
```

---

## Common Pitfalls

- Mock methods defined in base classes may not honor the strictness modifier correctly.
- Using non-virtual destructors in mocks can cause unexpected behavior.
- Expectation must be set before exercising mocks to avoid undefined behavior.

---

<Note>
Current default verbosity level (`--gmock_verbose`) affects how warnings and info are displayed for uninteresting calls on naggy mocks.
</Note>

---

If you want to customize strictness behavior globally, consider using `Mock::AllowUninterestingCalls()`, `Mock::WarnUninterestingCalls()`, or `Mock::FailUninterestingCalls()` on individual mock objects, but prefer the wrappers for cleaner, easier-to-read tests.

---

This concludes the documentation for the Mock Strictness Controls page.
