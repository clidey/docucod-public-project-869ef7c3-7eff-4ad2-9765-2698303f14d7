---
title: "Mock Behavior Controls"
description: "Reference on configuring mock object attitudes (nice, naggy, strict), error handling for unexpected calls, and strategies for balancing warnings and test enforcements. Helps users prevent brittle tests while capturing critical contract violations."
---

# Mock Behavior Controls

Configure and understand how to control the behavior of mock objects with respect to uninteresting calls, error handling, and balancing warnings versus test enforcement. This reference helps you tune your tests to avoid brittleness while ensuring critical contract violations are caught.

---

## Overview of Mock Behavior Attitudes

GoogleMock allows you to configure mock objects in three principal behavior modes to govern how uninteresting calls (calls on mock methods for which there are no expectations) are treated:

- **Nice Mocks (`NiceMock<T>`)**  
  Suppress warnings on uninteresting calls. These mocks quietly accept any call for which there is no explicit expectation, performing the default action without cluttering test output.

- **Naggy Mocks (`NaggyMock<T>`)**  
  Emit warnings on uninteresting calls. This is the default behavior if you just use the plain mock object. It alerts you to unexpected usage that might suggest missing expectations, but allows tests to continue.

- **Strict Mocks (`StrictMock<T>`)**  
  Treat uninteresting calls as test failures. These mocks enforce stricter contracts by failing tests if unexpected method calls happen.

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

NiceMock<MockFoo> nice_foo;      // No warnings for uninteresting calls.
NaggyMock<MockFoo> naggy_foo;    // Warnings for uninteresting calls (default).
StrictMock<MockFoo> strict_foo;  // Fail test on uninteresting calls.
```


## What Is an Uninteresting Call?

An **uninteresting call** occurs when a mock method is invoked for which no `EXPECT_CALL()` expectation exists. The mock will perform its default action, but:

- On a **naggy** mock, gMock prints a warning message.
- On a **nice** mock, gMock quietly proceeds without warning.
- On a **strict** mock, gMock treats it as a test failure.

## What Is an Unexpected Call?

An **unexpected call** is when a mock method is called and there *are* existing `EXPECT_CALL` expectations on that method, but none of them matches the actual call arguments. This is always considered a test failure regardless of strictness mode.

## Configuring Uninteresting Call Behavior on a Per-Mock Object Basis

You can programmatically configure the reaction to uninteresting calls on a mock object at runtime using these static methods:

```cpp
#include <gmock/gmock.h>

// mock_obj is a pointer or raw address of your mock object.

// Allow uninteresting calls without warnings or failures.
testing::Mock::AllowUninterestingCalls(reinterpret_cast<uintptr_t>(mock_obj));

// Warn when an uninteresting call happens (default behavior).
testing::Mock::WarnUninterestingCalls(reinterpret_cast<uintptr_t>(mock_obj));

// Fail tests on uninteresting calls.
testing::Mock::FailUninterestingCalls(reinterpret_cast<uintptr_t>(mock_obj));
```

Use these carefully to balance catching errors versus avoiding test brittleness.

## Balancing Warnings and Test Enforcement

Using **naggy mocks** allows you to be alerted to uninteresting calls without failing tests outright. This is helpful during test development or debugging when your mocks may not be fully specified.

**Strict mocks** enforce rigorous contract adherence, ensuring no unplanned interactions occur. Use them when tests need exact call discipline, typically in later-stage or critical tests.

**Nice mocks** help suppress noise from unimportant calls, keeping tests clean and focusing on expected call verification.

<Info>
When anchoring tests with complex dependencies or evolving APIs, prefer starting with nice mocks to keep tests resilient, then selectively add expectations or switch to stricter modes for areas where precision matters most.
</Info>

---

## Common Scenarios and Best Practices

### 1. Suppressing Noisy Warnings

If your test output is cluttered with messages like:

```
GMOCK WARNING:
Uninteresting mock function call - returning default value.
```

Consider wrapping your mock with `NiceMock<>` or adding catch-all expectations:

```cpp
EXPECT_CALL(mock, Foo(_)).Times(AnyNumber());
```

### 2. Enforcing Call Expectations Strictly

When your test must ensure no unexpected calls, use `StrictMock<>` or configure failure reaction manually.

### 3. Selectively Expecting Calls

Use `EXPECT_CALL` to explicitly specify expectations on interesting methods, and leave others to default behavior.

### 4. Handling Uninteresting Calls When Using Default Behavior

If your uninteresting calls need custom default behavior, pair `ON_CALL` with `WillByDefault` to tailor responses, e.g.: 

```cpp
ON_CALL(mock, SomeMethod(_)).WillByDefault(Return(true));
EXPECT_CALL(mock, SomeMethod(42));
```

### 5. Avoid Suppressing Real Errors with Blanket Expectations

Do *not* silence warnings by adding `EXPECT_CALL(...).Times(AnyNumber())` on every method carelessly. This weakens tests and hides real bugs.

<Warning>
Adding catch-all expectations to hide uninteresting-call warnings compromises test integrity. Use sparingly and intentionally.
</Warning>

---

## Technical Details

- The default mock attitude is currently **naggy**.
- Using `NiceMock<T>` suppresses uninteresting-call warnings for `T`.
- Using `StrictMock<T>` promotes uninteresting calls to errors.
- Mock objects maintain internal reaction settings which determine how uninteresting calls are handled.
- You can check the current attitude of a mock using:

```cpp
bool is_nice = testing::Mock::IsNice(mock_obj);
bool is_naggy = testing::Mock::IsNaggy(mock_obj);
bool is_strict = testing::Mock::IsStrict(mock_obj);
```

- The mock reactions are maintained in thread-safe global registries.

## Cleaning Up: Verifying and Clearing Expectations

You can force verification of all expectations on a mock at any point, rather than waiting for destruction:

```cpp
bool verified = testing::Mock::VerifyAndClearExpectations(&mock_obj);
```

Or clear both expectations and default actions:

```cpp
bool verified = testing::Mock::VerifyAndClear(&mock_obj);
```

After verification and clearing, do *not* add new expectations to the mock.

## API Summary for Behavior Control

| Method                            | Description                                            |
| -------------------------------- | ------------------------------------------------------ |
| `Mock::AllowUninterestingCalls(uintptr_t mock_obj)` | Allow uninteresting calls without warnings or failure. |
| `Mock::WarnUninterestingCalls(uintptr_t mock_obj)`  | Warn on uninteresting calls (default).                  |
| `Mock::FailUninterestingCalls(uintptr_t mock_obj)`  | Fail test on uninteresting calls.                       |
| `Mock::AllowLeak(const void* mock_obj)`              | Ignore leaks of this mock object (skips verification). |
| `Mock::VerifyAndClearExpectations(void* mock_obj)`   | Verify and clear expectations on mock.                  |
| `Mock::VerifyAndClear(void* mock_obj)`               | Verify and clear expectations and default actions.     |

---

## Practical Example

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::StrictMock;
using ::testing::Return;

class MockFoo {
 public:
  MOCK_METHOD(int, GetValue, (), ());
};

TEST(MockBehaviorTest, UsingNiceMock) {
  NiceMock<MockFoo> nice_foo;
  EXPECT_CALL(nice_foo, GetValue())
      .WillOnce(Return(42));

  // Uninteresting calls to other methods on nice_foo won't print warnings.
  int val = nice_foo.GetValue();  // Returns 42
}

TEST(MockBehaviorTest, UsingStrictMock) {
  StrictMock<MockFoo> strict_foo;
  EXPECT_CALL(strict_foo, GetValue())
      .WillOnce(Return(24));

  // Any uninteresting calls will cause the test to fail.
  int val = strict_foo.GetValue();  // Returns 24
  // strict_foo.OtherMethod();  // Would cause failure if called.
}

TEST(MockBehaviorTest, ConfiguringAtRuntime) {
  MockFoo foo;
  testing::Mock::WarnUninterestingCalls(reinterpret_cast<uintptr_t>(&foo));
  EXPECT_CALL(foo, GetValue())
      .WillOnce(Return(7));

  int val = foo.GetValue();  // Returns 7
  // Uninteresting calls emit warnings, not failures.
}
```

---

## Troubleshooting Common Issues

- **Warning: "Uninteresting function call encountered"**
  - This indicates a call was made to a mock method without a matching `EXPECT_CALL`.
  - If expected, wrap the mock with `NiceMock<>` or add a catch-all expectation.
  - Otherwise, verify if some expectations are missing.

- **Unexpected call errors despite `ON_CALL` specified**
  - `ON_CALL` sets default behavior but does *not* establish expectations. Use `EXPECT_CALL` for expected calls.

- **Tests failing when calls change order unexpectedly**
  - Verify if unintentional calls are triggering strict mocks.
  - Use `Sequence` or `InSequence` to control call order.
  - Relax strictness if needed, or specify expected calls carefully.

- **Mock leaks leading to missing verification**
  - If mock objects are leaked and not destroyed, their expectations are never checked.
  - Use `Mock::AllowLeak(&mock_obj)` to suppress if intentional, else fix ownership.

<Note>
Always set expectations before exercising mocks to avoid undefined behavior.
</Note>

---

## Related Documentation

- [Mocking Reference](./mocking.md) — full details on mocks, expectations, actions.
- [Creating Mocks](../guides/mocking-best-practices/creating-mocks.md) — how to write mock classes.
- [Defining Expectations](../guides/mocking-best-practices/defining-expectations.md) — setting call expectations using `EXPECT_CALL` and `ON_CALL`.
- [Mock Strictness Modes](../guides/mocking-best-practices/mock-strictness-modes.md) — user guide on `NiceMock`, `NaggyMock`, and `StrictMock`.

---

<Source url="https://github.com/google/googletest" paths='[{"path":"googlemock/include/gmock/gmock.h"},{"path":"googlemock/include/gmock/gmock-spec-builders.h"},{"path":"googlemock/src/gmock-spec-builders.cc"}]' />