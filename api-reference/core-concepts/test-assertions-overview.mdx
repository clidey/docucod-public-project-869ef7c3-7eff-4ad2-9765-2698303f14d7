---
title: "Assertions and Test Results"
description: "Covers the APIs for making assertions in tests, interpreting test outcomes, and managing both fatal and non-fatal failures using GoogleTest's assertion macros and result types."
---

# Assertions and Test Results

This page presents the API and concepts essential for making assertions in tests, interpreting their outcomes, and managing failures using GoogleTest assertion macros. It is designed to help you validate code behavior effectively and understand the details of test success and failure reporting.

---

## 1. Overview of Assertions

Assertions in GoogleTest are the primary way to verify correctness in your code during testing. GoogleTest provides a rich variety of assertion macros, each serving specific verification purposesâ€”from simple truth checks to detailed value comparisons and exception handling.

### Key Points

- **Types of Assertions:** Mostly come in pairs `EXPECT_` (nonfatal) and `ASSERT_` (fatal). Nonfatal assertions allow the test function to continue, while fatal ones abort the current test function.
- **Custom Messages:** Assertions support appending custom failure messages using the streaming `<<` operator.
- **Value Printing:** Arguments to assertions are printed on failure using GoogleTest's extensible printer.

### Usage Example

```cpp
EXPECT_TRUE(is_initialized) << "The system is not initialized properly.";
EXPECT_EQ(result, expected_value) << "The calculation result is incorrect.";
```

## 2. Assertion Macros Categories

GoogleTest organizes assertions into logical groups based on what they verify.

### 2.1 Explicit Success and Failure

| Macro      | Description                                                 |
|------------|-------------------------------------------------------------|
| `SUCCEED()`| Reports success without checking any condition.             |
| `FAIL()`   | Generates a fatal failure instantly.                        |
| `ADD_FAILURE()` | Generates a nonfatal failure at the point called.        |
| `ADD_FAILURE_AT(file, line)` | Generates a nonfatal failure at a specific source location. |

### 2.2 Boolean Conditions

Verify Boolean expressions.

| Macro      | Description                  |
|------------|------------------------------|
| `EXPECT_TRUE(condition)` | Checks if condition is true       |
| `ASSERT_TRUE(condition)` | Aborts if condition is false      |
| `EXPECT_FALSE(condition)`| Checks if condition is false      |
| `ASSERT_FALSE(condition)`| Aborts if condition is true       |

### 2.3 Binary Comparison

Compare two values directly with common operators.

| Macro      | Description                      |
|------------|----------------------------------|
| `EXPECT_EQ(val1, val2)` | Checks if val1 == val2             |
| `ASSERT_EQ(val1, val2)` | Aborts if val1 != val2             |
| `EXPECT_NE(val1, val2)` | Checks if val1 != val2             |
| `ASSERT_NE(val1, val2)` | Aborts if val1 == val2             |
| `EXPECT_LT(val1, val2)` | Checks if val1 < val2              |
| `ASSERT_LT(val1, val2)` | Aborts if val1 >= val2             |
| `EXPECT_LE(val1, val2)` | Checks if val1 <= val2             |
| `ASSERT_LE(val1, val2)` | Aborts if val1 > val2              |
| `EXPECT_GT(val1, val2)` | Checks if val1 > val2              |
| `ASSERT_GT(val1, val2)` | Aborts if val1 <= val2             |
| `EXPECT_GE(val1, val2)` | Checks if val1 >= val2             |
| `ASSERT_GE(val1, val2)` | Aborts if val1 < val2              |

**Note:** When comparing pointers, `EXPECT_EQ` and `EXPECT_NE` compare addresses, not contents.

### 2.4 String Comparison

Dedicated macros to compare C-style strings for equality or inequality, including case-insensitive variants.

| Macro           | Description                                             |
|-----------------|---------------------------------------------------------|
| `EXPECT_STREQ(str1, str2)` | Verify contents of C strings equal                |
| `ASSERT_STREQ(str1, str2)` | Aborts if contents differ                          |
| `EXPECT_STRNE(str1, str2)` | Verify contents of C strings not equal             |
| `ASSERT_STRNE(str1, str2)` | Aborts if contents equal                            |
| `EXPECT_STRCASEEQ(str1, str2)` | Case-insensitive equality check                   |
| `ASSERT_STRCASEEQ(str1, str2)` | Aborts if case-insensitive check fails            |
| `EXPECT_STRCASENE(str1, str2)` | Case-insensitive inequality check                 |
| `ASSERT_STRCASENE(str1, str2)` | Aborts if case-insensitive inequality check fails |

### 2.5 Floating-Point Comparison

Because floating-point precision requires special handling, GoogleTest provides assertions that check approximate equality.

| Macro             | Description                                     |
|-------------------|-------------------------------------------------|
| `EXPECT_FLOAT_EQ(val1, val2)` | Checks if floats are approximately equal (within 4 ULPs) |
| `ASSERT_FLOAT_EQ(val1, val2)` | Aborts if floats not approximately equal       |
| `EXPECT_DOUBLE_EQ(val1, val2)`| Checks doubles approximate equality (4 ULPs)  |
| `ASSERT_DOUBLE_EQ(val1, val2)`| Aborts if doubles not approximate equal       |
| `EXPECT_NEAR(val1, val2, abs_error)` | Checks if difference is within absolute error |
| `ASSERT_NEAR(val1, val2, abs_error)` | Aborts if difference exceeds abs_error         |

### 2.6 Exception Assertions

Verify if code throws or does not throw exceptions.

| Macro                       | Description                                       |
|-----------------------------|---------------------------------------------------|
| `EXPECT_THROW(statement, exception_type)` | Checks whether statement throws expected exception        |
| `ASSERT_THROW(statement, exception_type)` | Aborts if exception is not thrown as expected             |
| `EXPECT_ANY_THROW(statement)` | Checks whether statement throws any exception               |
| `ASSERT_ANY_THROW(statement)` | Aborts if no exception is thrown                            |
| `EXPECT_NO_THROW(statement)` | Verifies statement does not throw                         |
| `ASSERT_NO_THROW(statement)` | Aborts if statement throws exception                       |

### 2.7 Predicate Assertions

These provide generalized assertions by calling custom predicates/functors with 1-5 arguments and reporting failures with detailed messages.

| Macro             | Description                                          |
|-------------------|------------------------------------------------------|
| `EXPECT_PRED1(pred, val1)`   | Checks predicate with 1 argument                  |
| `EXPECT_PRED2(pred, val1, val2)` | Checks predicate with 2 arguments               |
| `EXPECT_PRED3(pred, val1, val2, val3)` | With 3 args                                |
| `EXPECT_PRED4(...)` | With 4 args                                         |
| `EXPECT_PRED5(...)` | With 5 args                                         |

(And their fatal variants: `ASSERT_PRED*`)

There are also `EXPECT_PRED_FORMAT*` variants that allow custom messages via predicate-formatters.

### 2.8 Windows HRESULT Assertions

Special macros to verify success or failure HRESULT codes.

| Macro                       | Description                        |
|-----------------------------|----------------------------------|
| `EXPECT_HRESULT_SUCCEEDED(expression)` | Checks HRESULT indicates success |
| `ASSERT_HRESULT_SUCCEEDED(expression)` | Aborts on failure                |
| `EXPECT_HRESULT_FAILED(expression)`    | Checks HRESULT indicates failure|
| `ASSERT_HRESULT_FAILED(expression)`    | Aborts on success               |

### 2.9 Death Assertions

Verify that code causes the process to terminate with expected outputs.

| Macro                        | Description                                           |
|------------------------------|-------------------------------------------------------|
| `EXPECT_DEATH(statement, matcher)`   | Verifies statement causes death with expected stderr match |
| `EXPECT_DEATH_IF_SUPPORTED(statement, matcher)` Same if supported, else no-op    |
| `EXPECT_DEBUG_DEATH(statement, matcher)` | Same as EXPECT_DEATH in debug mode only        |
| `EXPECT_EXIT(statement, predicate, matcher)` | Verify statement terminates with predicate and output|

---

## 3. How to Use Assertions Effectively

### Custom Messages

All assertions support streaming additional information for failure context:

```cpp
EXPECT_EQ(actual, expected) << "Failed due to unexpected result.";
```

### Distinguish Between `EXPECT_` and `ASSERT_`

- Use `EXPECT_` when the test can logically continue after failure (for richer failure reports).
- Use `ASSERT_` when proceeding with the test doesn't make sense or will cause crashes.

### Use Matchers with `EXPECT_THAT`

For complex conditions, use `EXPECT_THAT(value, matcher)` to leverage GoogleTest matchers for expressive verification.

```cpp
EXPECT_THAT(name, StartsWith("John"));
EXPECT_THAT(numbers, ElementsAre(1, 2, 3));
```

### Use Predicate Assertions for Complex Logic

When matching requires arbitrary logic, write predicate functions and use `EXPECT_PRED*` macros.

### Floating-Point Considerations

Floating-point numbers should be checked with approximate comparisons (`EXPECT_FLOAT_EQ`, `EXPECT_NEAR`) instead of `EXPECT_EQ` due to rounding errors.

---

## 4. Understanding Test Result Types

GoogleTest categorizes test results into:

- **Success:** No failures during test execution.
- **Nonfatal Failure:** Assertions like `EXPECT_` fail but allow test function to continue.
- **Fatal Failure:** Assertions like `ASSERT_` fail and abort the current test function.

Failed assertions provide informative messages including:

- The expression evaluated and expected condition
- Actual values and types
- The source file and line number

Additional diagnostic information, such as stack traces for uninteresting mock calls (in gMock context), are included when verbosity flags are enabled.

---

## 5. Common Pitfalls & Troubleshooting

### Common Issues

- Using `EXPECT_EQ` to compare C-string pointers instead of their contents. Use `EXPECT_STREQ` instead.
- Forgetting to use `ASSERT_` when a failure must abort further test execution.
- Misusing floating-point equality assertions (`EXPECT_EQ` instead of `EXPECT_FLOAT_EQ`).
- Not providing failure messages, making diagnosis harder.

### Debugging Failed Assertions

- Run tests with `--gtest_break_on_failure` to stop on failed assertions.
- Use `--gtest_output` to generate XML reports for CI.
- Use `EXPECT_THAT` with matchers for better failure messages.

### Verbosity Controls

GoogleMock (part of GoogleTest) supports verbosity flags like `--gmock_verbose=info|warning|error` to control how detailed uninteresting/mock call warnings are reported.

---

## 6. Examples

### Simple Truth Check

```cpp
EXPECT_TRUE(user.IsLoggedIn()) << "User should be logged in";
```

### Equality Check

```cpp
EXPECT_EQ(count, 5) << "Expected count to be 5";
```

### Floating-Point Check

```cpp
EXPECT_NEAR(result, 3.14, 0.01) << "Pi approximation failed";
```

### String Comparison

```cpp
EXPECT_STREQ(output.c_str(), "Hello World") << "Output mismatch";
```

### Exception Assertion

```cpp
EXPECT_THROW(CallProcessing(), std::runtime_error);
```

### Predicate Assertion

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, value);
```

### Death Test

```cpp
EXPECT_DEATH(ExitFunction(), "Fatal error");
```

---

## 7. Additional Resources

- [Assertions Reference](https://google.github.io/googletest/reference/assertions.html)
- [Matchers Reference](../api-reference/mocking-and-behavior/matchers-reference.md)
- [Using Mocks in Tests](../guides/core-workflows/using-mocks-in-tests.md)
- [gMock Cookbook](../docs/gmock_cook_book.md)

---