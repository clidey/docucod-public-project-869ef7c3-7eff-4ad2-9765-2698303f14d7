---
title: "Configuration and Test Options"
description: "Documents command-line flags, configuration macros, and environment options for controlling test execution, filtering, output, and platform compatibility."
---

# Configuration and Test Options

This documentation details command-line flags, configuration macros, and environment options that control the behavior of GoogleTest and Google Mock during test execution. These options allow you to tailor test filtering, output verbosity, platform compatibility, and mock object behavior, helping you achieve precise control over test runs in diverse environments.

---

## Command-Line Flags

GoogleTest and Google Mock provide several command-line flags to customize test execution. Flags prefixed with `--gtest_` relate to GoogleTest core functionalities, while `--gmock_` flags configure Google Mock features.

### Common Google Mock Flags

- `--gmock_verbose=LEVEL`
  - Controls the verbosity of Google Mock diagnostic messages.
  - `LEVEL` can be `info`, `warning`, or `error`.
    - `info`: Most verbose; logs all mock calls, expectations, and includes stack traces for uninteresting calls.
    - `warning`: Default level; logs warnings and errors without stack traces for uninteresting calls.
    - `error`: Least verbose; logs errors only.

- `--gmock_catch_leaked_mocks=0|1`
  - When enabled (1), Google Mock will report leaked mock objects as test failures.
  - When disabled (0), it ignores leaked mocks.

- `--gmock_default_mock_behavior=VALUE`
  - Sets the default behavior for mock calls.
  - Values typically correspond to enumerations controlling strictness (not commonly set via command line).

### Example

```shell
./my_test --gmock_verbose=info
```

This runs your test executable with verbose mock call logging.

---

## Defining and Using Flags in Code

Google Mock supports programmatic access to its flags for use inside tests or custom test runners. You can get or set flag values using provided macros:

```cpp
// Access flag values
bool catch_leaks = GMOCK_FLAG_GET(catch_leaked_mocks);
std::string verbosity = GMOCK_FLAG_GET(verbose);
int default_behavior = GMOCK_FLAG_GET(default_mock_behavior);

// Set flag values
GMOCK_FLAG_SET(verbose, "error");
```

This allows dynamic control over mock behavior based on runtime conditions.

---

## Initialization

Before using Google Mock, initialize the framework and parse any command-line flags:

```cpp
int argc = ...;
char** argv = ...;
testing::InitGoogleMock(&argc, argv);
```

This processes `--gmock_` flags by removing them from `argv` and applying the settings.

### Supported Init Variants

- `InitGoogleMock(int* argc, char** argv)`
- `InitGoogleMock(int* argc, wchar_t** argv)` (for Windows UNICODE)
- `InitGoogleMock()` (for platforms without `argc`/`argv`)

Refer to [Main Functions and Initialization](api-reference/integration-examples/main-entry-points.md) for detailed guidance.

---

## Platform and Portability Macros

GoogleTest provides macros to detect platform features and environment capabilities, which can be used to write portable tests:

- `GTEST_HAS_PTHREAD` — Whether POSIX threads are supported.
- `GTEST_HAS_RTTI` — Whether Runtime Type Information (RTTI) is enabled.
- `GTEST_HAS_DEATH_TEST` — Whether death tests are supported on this platform.
- `GTEST_HAS_STD_WSTRING` — Whether `std::wstring` is supported.

These macros enable conditional compilation, allowing tests to adapt to the environment.

---

## Runtime Configuration via Environment Variables

Certain GoogleTest flags can also be configured through environment variables named after the flags, e.g., `GTEST_FLAGNAME`.

For example, setting `GTEST_VERBOSITY` environment variable can control message verbosity similar to `--gtest_verbose`.

This mechanism allows configuration without modifying command-line arguments.

---

## Controlling Mock Behavior

Several flags and macros influence Google Mock's runtime behavior, such as:

- Enabling strictness levels (imitated via mock types `NiceMock`, `NaggyMock`, and `StrictMock`).
- Controlling warning and error messages for uninteresting calls.

Detailed usage and best practices for these are described in the [Mocking Reference](docs/reference/mocking.md) and the [gMock Cookbook](docs/gmock_cook_book.md).

---

## Best Practices

- Prefer setting verbosity to `warning` or `error` in automated test suites to reduce noise.
- Use `NiceMock` or `StrictMock` classes to tune mock warning behavior per test.
- Initialize Google Mock early in your test harness to ensure flags are parsed correctly.
- Avoid setting flags after Google Mock initialization as behavior may not reflect changes.

---

## Example: Using Google Mock Flags in Tests

```cpp
#include <gmock/gmock.h>
using testing::GMOCK_FLAG_GET;

TEST(MyMockTest, VerbosityControl) {
  std::string old_verbose = GMOCK_FLAG_GET(verbose);

  GMOCK_FLAG_SET(verbose, "error");

  // Your test code here.

  GMOCK_FLAG_SET(verbose, old_verbose);  // Restore original verbosity.
}
```

This example demonstrates saving and restoring a flag value for temporary configuration.

---

## Additional Resources

- [Mocking Reference](docs/reference/mocking.md) – Detailed docs on mock API and usage.
- [gMock Cookbook](docs/gmock_cook_book.md) – Recipes and advanced usage patterns.
- [API Reference: Main Entry Points](api-reference/integration-examples/main-entry-points.md) – Initialization and main function.
- [Platform and Portability Guide](guides/real-world-scenarios/platforms-and-portability.md) – Handling multi-platform testing.

---

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "name": "Configuration and Test Options for GoogleTest and GoogleMock",
  "description": "Documentation on command-line flags, environment variables, and configuration macros to control test execution and mock behavior.",
  "url": "/api-reference/integration-examples/config-options"
}
</script>
