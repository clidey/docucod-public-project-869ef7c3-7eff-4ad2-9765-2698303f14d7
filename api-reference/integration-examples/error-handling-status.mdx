---
title: "Error Handling and Status Reporting"
description: "Explains how errors are reported, managed, and handled in test and mock executions. Includes information on assertion failures, fatal errors, and customizing error output."
---

# Error Handling and Status Reporting

GoogleTest and GoogleMock provide detailed mechanisms for reporting, managing, and handling errors that occur during test execution and mock interactions. Understanding how these errors surface, how to interpret the failure messages, and how to customize error reporting is critical for developing robust and maintainable test suites. This documentation explains the types of failures you might encounter, how GoogleTest and GoogleMock communicate issues, and best practices for customizing and troubleshooting error output.

---

## 1. Overview of Error Handling in GoogleTest and GoogleMock

When writing tests and mocks, errors may occur due to failed assertions, unexpected mock function calls, or violations of expectations. GoogleTest classifies failures as either fatal (aborting the current function) or nonfatal (continuing test execution but marking it as failed).

GoogleMock extends this by tracking expectations set on mocks, and reporting detailed diagnostic information when calls are unexpected or incorrect. It automatically verifies that all expectations are met when mock objects are destroyed.

---

## 2. Types of Failures and Error Messages

### 2.1 Assertion Failures

Assertions fail when the expected conditions are not met. GoogleTest offers `EXPECT_` macros for nonfatal assertions and `ASSERT_` macros for fatal assertions.

Example failure output for an unmet assertion:

```
path/to/file.cc:123: Failure
Expected: some_condition
  Actual: false
```

### 2.2 Uninteresting Calls

An "uninteresting call" occurs when a mock method is called without a matching `EXPECT_CALL`. By default, GoogleMock issues a warning but continues execution.

Example warning:

```
GMOCK WARNING:
Uninteresting mock function call - returning default value.
    Function call: SomeMethod()
``` 

### 2.3 Unexpected Calls

An unexpected call is a method invocation on a mock that matches no active `EXPECT_CALL` due to argument mismatches or call count violations. These are considered errors.

Sample error message:

```
Unexpected mock function call - returning default value.
    Function call: SomeMethod(42)
Google Mock tried the following 1 expectation, but none matched:
  Expected arg #0: is equal to 10
           Actual: 42
         Expected: to be called once
           Actual: called zero times - unsatisfied and active
```

### 2.4 Excessive Calls

Excessive calls happen when a mock function is called more times than expected. GoogleMock flags this as an error.

Example:

```
Mock function called more times than expected - returning default value.
    Function call: Foo(5)
         Expected: to be called once
           Actual: called twice - over-saturated and active
```

### 2.5 Retired Expectations

When an expectation is retired (due to call order or [RetiresOnSaturation] clause), calls matching it later produce failure messages explaining that the expectation is no longer active.

---

## 3. GoogleMock Specific Error Reporting Features

### 3.1 Verbose Output Control

The verbosity of mock call reporting is controlled by the `--gmock_verbose` flag:

- `info`: Reports all informational messages and stack traces for matching calls and uninteresting calls.
- `warning` (default): Reports warnings without stack traces for uninteresting calls.
- `error`: Only reports errors; silent on warnings and expected calls.

This helps tune the amount of error diagnostic detail you receive.

### 3.2 Stack Trace Inclusion

When enabled, GoogleMock displays stack traces pointing to where unexpected or uninteresting calls happened, helping identification of problematic call sites.

### 3.3 Descriptions of Exception Causes

GoogleMock provides detailed explanations for why a call fails to match expectations:

- Argument mismatches (showing expected and actual values).
- Unsatisfied call order constraints.
- Expectations that have been retired or saturated.

This context enables rapid root cause identification when mocks behave unexpectedly.

---

## 4. Controlling Error Handling Behavior

### 4.1 Using `NiceMock`, `NaggyMock`, and `StrictMock`

You can control the strictness of mock objects regarding uninteresting calls:

- `NiceMock<T>`: Suppresses warnings on uninteresting calls.
- `NaggyMock<T>`: (Default) Warns on uninteresting calls.
- `StrictMock<T>`: Treats uninteresting calls as errors (failures).

Example usage:

```cpp
using ::testing::NiceMock;
using ::testing::StrictMock;

NiceMock<MockFoo> mock;  // No warnings for uninteresting calls
StrictMock<MockFoo> strict_mock;  // Errors on uninteresting calls
```

**Note:** These wrappers require that mock methods be defined directly within the mock class using `MOCK_METHOD` macros.

### 4.2 Setting Expected Calls to Accept Any Number

Suppress warnings for a particular method by adding a catch-all expectation:

```cpp
EXPECT_CALL(mock, SomeMethod(_)).Times(AnyNumber());
```

This specifies that the method can be called any number of times without warnings.

### 4.3 Controlling Default Actions

Set the default behavior for methods using `ON_CALL` to prevent unexpected call errors when no specific expectation is set:

```cpp
ON_CALL(mock, SomeMethod(_)).WillByDefault(Return(default_value));
```

---

## 5. Customizing Error Output

### 5.1 Capturing and Redirecting Output

GoogleTest supports capturing standard output and error streams during test runs, enabling you to test expected log or error output.

### 5.2 Writing Custom Printers

You can teach GoogleTest how to print user-defined types for better error messages in assertions and mock failures. See the [Advanced Guide on Printing Values](../advanced.md#teaching-googletest-how-to-print-your-values).

---

## 6. Best Practices and Troubleshooting

- **Set expectations before exercising mocks** to ensure predictable error reporting.
- Use `EXPECT_CALL` sparingly and specify constraints only on relevant interactions to avoid brittle tests.
- Use `NiceMock` during development phases to reduce noise from warnings.
- Increase verbosity (`--gmock_verbose=info`) to diagnose why expectations fail or are unmatched.
- Use `RetiresOnSaturation()` to avoid sticky expectations causing upper-bound violations.
- Review call sequence constraints (`InSequence`, `After`) carefully to troubleshoot unexpected call failures.

---

## 7. Example: Handling Errors in Mocks

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

using ::testing::Return;
using ::testing::StrictMock;
using ::testing::_;

class MockCalculator {
 public:
  MOCK_METHOD(int, Add, (int a, int b), ());
};

TEST(CalculatorTest, StrictMockReportsUnexpectedCalls) {
  StrictMock<MockCalculator> calc;

  EXPECT_CALL(calc, Add(1, 2)).WillOnce(Return(3));

  // Expected call: succeeds
  EXPECT_EQ(calc.Add(1, 2), 3);

  // Unexpected call: triggers failure
  calc.Add(2, 3);  // Test fails here
}
```

Running this test reports an unexpected mock function call error, showing the call, expected arguments, and the discrepancy.

---

## 8. Related Diagnostic Flags and Functions

| Flag                        | Purpose                                                |
|-----------------------------|--------------------------------------------------------|
| `--gmock_verbose=LEVEL`      | Controls verbosity of mock-related messages.           |
| `Mock::VerifyAndClearExpectations(&mock)` | Force verification of mock at any point.             |
| `Mock::AllowLeak(&mock)`    | Suppress leaked mock warnings for the given mock object. |

---

## 9. Troubleshooting Common Issues

### 9.1 "Uninteresting mock function call" warnings

- Usually mean a mock method was called without an `EXPECT_CALL`.
- Use `NiceMock` to suppress these warnings or add `EXPECT_CALL(...).Times(AnyNumber())`.
- Avoid suppressing warnings by adding expectations you donâ€™t intend to verify.

### 9.2 Expectation failed due to call order

- Use `InSequence` or `After` clauses to define expected call order.
- Review sequence setup if calls report unsatisfied prerequisites.

### 9.3 Calls with wrong arguments

- Verify matchers and arguments in `EXPECT_CALL`.
- Use `--gmock_verbose=info` to see detailed matching information.

---

## 10. Further Reading

- [Mocking Reference](../api-reference/core-apis/mocking-and-methods)
- [Matchers Reference](../api-reference/advanced-behaviors/argument-matchers)
- [Actions Reference](../api-reference/advanced-behaviors/mock-actions)
- [Expectations and Call Ordering](../api-reference/advanced-behaviors/expectations-verification)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Assertions Reference](../api-reference/core-apis/assertions)

---