---
title: "Assertions Reference"
description: "Describes the suite of built-in assertions, including equality, inequality, exception, and fatal/non-fatal checks. Offers practical code snippets and recommendations for best usage patterns."
---

# Assertions Reference

This page documents the built-in assertion macros provided by GoogleTest for verifying code behavior in your C++ tests. Assertions help confirm that your code produces expected results and that incorrect behavior is detected and reported during test execution.

To use any assertions, include the header:

```cpp
#include <gtest/gtest.h>
```

---

## Assertion Categories

GoogleTest assertions come in pairs: `EXPECT_*` macros generate **nonfatal failures** allowing the test to continue, while `ASSERT_*` macros generate **fatal failures** which abort the current function immediately.

Assertions cover a wide range of needs:

- Boolean values and conditions
- Binary comparisons (equality, inequality, ordering)
- String comparisons (including case-insensitive and partial matches)
- Floating-point comparisons
- Exception assertions
- Predicate assertions
- Windows HRESULT validations
- Death tests (verifying code termination)

---

## Key Assertion Macros and How to Use Them

### Boolean Conditions

**Use when you want to check if a condition is true or false.**

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

Example:

```cpp
EXPECT_TRUE(is_valid);
ASSERT_FALSE(has_error);
```

### Binary Comparisons

**Compare values for equality, inequality, or ordering.**

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)`  – tests `val1 == val2`
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)`  – tests `val1 != val2`
- `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)`  – tests `val1 < val2`
- `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)`  – tests `val1 <= val2`
- `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)`  – tests `val1 > val2`
- `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)`  – tests `val1 >= val2`

**Note:** Comparisons involving pointers check pointer equality, except for C strings, where you should use the string comparison assertions below.

Example:

```cpp
EXPECT_EQ(result, 42);
ASSERT_NE(ptr, nullptr);
EXPECT_LT(len, max_size);
```

### String Comparisons

Specialized assertions to compare C strings (`const char*` or wide strings).

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)`  – identical C string contents
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)`  – different C string contents
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)`  – same contents ignoring case
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)`  – different ignoring case

Example:

```cpp
EXPECT_STREQ(username, "admin");
ASSERT_STRCASEEQ(response, "OK");
```

### Floating-Point Comparisons

Use these to avoid pitfalls of floating-point equality due to rounding errors.

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`  – float near equality within 4 ULPs
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`  – double near equality within 4 ULPs
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` – compares within absolute error

Example:

```cpp
EXPECT_FLOAT_EQ(pi_float, calculated_value);
ASSERT_NEAR(measured, expected, 0.001);
```

### Exception Assertions

These verify whether code throws exceptions or not (requires exceptions enabled in your build).

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`

You can place compound statements directly:

```cpp
EXPECT_THROW({ DoWork(); }, std::runtime_error);
```

### Predicate Assertions

Use when asserting on complex Boolean predicates, with helpful diagnostics.

- `EXPECT_PREDn(pred, val1, val2, ..., valn)` / `ASSERT_PREDn(pred, val1, val2, ..., valn)`
- `EXPECT_PRED_FORMATn(pred_formatter, val1, ..., valn)` / `ASSERT_PRED_FORMATn(pred_formatter, val1, ..., valn)`

Here, `pred` is a Boolean function of `n` arguments, and `pred_formatter` is a function returning `testing::AssertionResult` to control message formatting.

Example:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
...
EXPECT_PRED1(IsEven, x);
```

### Windows HRESULT Assertions

Check if `HRESULT` indicates success or failure.

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED(expression)`
- `EXPECT_HRESULT_FAILED(expression)` / `ASSERT_HRESULT_FAILED(expression)`

Example:

```cpp
EXPECT_HRESULT_SUCCEEDED(CoCreateInstance(...));
```

### Death Tests

Verify that a statement causes the process to terminate (crash, abort).

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH(statement, matcher)`
- Other variants allow conditional exit code or debug mode only assertions.

Example:

```cpp
EXPECT_DEATH(FunctionThatShouldCrash(), "error message regex");
```

---

## Explicit Success and Failure

- `SUCCEED()` generates a documented success.
- `FAIL()` generates a fatal failure stopping the current function.
- `ADD_FAILURE()` generates a nonfatal failure allowing test to continue.

Example:

```cpp
if (!initialized) {
  FAIL() << "Initialization failed";
}
```

---

## Using Assertions Effectively

- Always understand whether you want the test to proceed after a failure (`EXPECT_`) or stop (`ASSERT_`).
- Stream detailed failure messages for clarity:

```cpp
EXPECT_TRUE(condition) << "Failed because X happened";
```

- Use `EXPECT_THAT(value, matcher)` to leverage gMock matchers for expressive assertions.
- Avoid mixing assertion types in helper functions; prefer predicate assertions or use `SCOPED_TRACE` for better context.

---

## Advanced Tips

### Using `EXPECT_THAT` with Matchers

Enable expressive checks with matchers on values or containers:

```cpp
EXPECT_THAT(container, ::testing::ElementsAre(1, 2, 3));
EXPECT_THAT(string_val, ::testing::StartsWith("Hello"));
```

### Adding Trace Info

Use `SCOPED_TRACE("message")` to attach contextual info that appears in failure messages.

### Multiple Checks in Subroutines

To avoid unclear failures in helper functions, either use custom predicates or `ASSERT_NO_FATAL_FAILURE()` guards.

---

## Summary of Common Assertions

| Assertion Type                  | Macro Example                          | Description                             |
| ------------------------------ | ------------------------------------ | ------------------------------------- |
| Boolean Conditions             | `EXPECT_TRUE(cond)`                   | Check if condition is true             |
| Equality and Comparison        | `EXPECT_EQ(a, b)`, `EXPECT_LT(x, y)`| Compare two values                     |
| String Equality               | `EXPECT_STREQ(str1, str2)`            | Check C string equality                |
| Floating Point Comparison      | `EXPECT_FLOAT_EQ(a, b)`               | Floating-point approximate equality   |
| Exception Assertions           | `EXPECT_THROW(stmt, ExceptionType)`  | Verify exceptions                     |
| Predicate Assertions           | `EXPECT_PRED1(f, val)`                | Assert on predicate functions         |
| Windows HRESULT               | `EXPECT_HRESULT_SUCCEEDED(hr)`        | Check HRESULT success                  |
| Death Tests                   | `EXPECT_DEATH(stmt, matcher)`          | Verify process death                   |

---

## Practical Examples

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

using ::testing::Eq;
using ::testing::StartsWith;
using ::testing::Throw;

TEST(MyTestSuite, BooleanAssertion) {
  bool is_ready = true;
  EXPECT_TRUE(is_ready);
}

TEST(MyTestSuite, EqualityAssertion) {
  int result = 5 + 3;
  EXPECT_EQ(result, 8);
}

TEST(MyTestSuite, StringComparison) {
  const char* message = "hello world";
  EXPECT_STREQ(message, "hello world");
  EXPECT_THAT(std::string(message), StartsWith("hello"));
}

TEST(MyTestSuite, FloatingPoint) {
  double val = 0.1 + 0.2;
  EXPECT_NEAR(val, 0.3, 1e-9);
}

TEST(MyTestSuite, ExceptionHandling) {
  EXPECT_THROW(throw std::runtime_error("fail"), std::runtime_error);
}

// Using predicate assertion
bool IsEven(int n) { return (n % 2) == 0; }

TEST(MyTestSuite, Predicate) {
  EXPECT_PRED1(IsEven, 4);
  EXPECT_PRED1(IsEven, 5); // Fails, outputs "5 is not even"
}

// Death test, requires running test with death test support
TEST(MyDeathTest, CrashTest) {
  EXPECT_DEATH(
    { throw std::runtime_error("crash"); },
    "crash"
  );
}
```

---

## Troubleshooting Common Issues

- **Assertion fails unexpectedly:** Use `SCOPED_TRACE()` to add context.
- **Confusing output:** Prefer using `EXPECT_THAT` with rich matchers for clearer diagnostics.
- **Tests continue on failures unexpectedly:** Verify use of `EXPECT_` vs. `ASSERT_` macros.
- **Death test does not run as expected:** Ensure test is run with death test enabled and process properly terminates.

---

## References and Further Reading

- [GoogleTest Primer](overview/product-intro-and-value/what-is-googletest)
- [gMock for Dummies](docs/gmock_for_dummies.md) – for using matchers in assertions
- [Assertions Reference (This Page)](docs/reference/assertions.md)
- [Mocking Reference](docs/reference/mocking.md) – for combining assertions with mocks
- [Advanced GoogleTest Topics](docs/advanced.md) – for deepening your understanding

---

This page is part of the [GoogleTest API Reference](#) documenting core test macros and assertions.
