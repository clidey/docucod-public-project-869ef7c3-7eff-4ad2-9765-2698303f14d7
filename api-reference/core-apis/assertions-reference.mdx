---
title: "Assertions Reference"
description: "Reference and examples for built-in assertions, covering equality, inequality, exceptions, string comparison, and floating-point checks. Explains fatal/non-fatal failures and patterns for custom assertions."
---

# Assertions Reference

This page lists the assertion macros provided by GoogleTest for verifying code behavior. To use them, add `#include <gtest/gtest.h>`.

GoogleTest offers pairs of macros: `EXPECT_*` which generate nonfatal failures allowing tests to continue and `ASSERT_*` which produce fatal failures that abort the current function. All assertions can receive a custom failure message via the `<<` operator.

---

## Explicit Success and Failure

These assertions let you directly specify success or failure, useful for controlling test flow when a Boolean condition is insufficient.

### SUCCEED

`SUCCEED()` generates a successful assertion. It does not cause the overall test to succeed nor prints output currently but can be used for documentation or potential future visibility in test reports.

### FAIL

`FAIL()` generates a fatal failure that aborts the current void-returning function immediately. Use it to signal that a code path should never be reached.

### ADD_FAILURE

`ADD_FAILURE()` generates a nonfatal failure allowing the test to continue.

### ADD_FAILURE_AT

`ADD_FAILURE_AT(file_path, line_number)` produces a nonfatal failure reported at a specified file and line number. Useful to more precisely attribute failures inside helper functions.

---

## Generalized Assertion

### EXPECT_THAT

```cpp
EXPECT_THAT(value, matcher)
ASSERT_THAT(value, matcher)
```

Enables verification of complex conditions on values using gMock matchers. This supports flexible matching of values with expressive failure messages.

Example:
```cpp
#include <gmock/gmock.h>

using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;
using ::testing::MatchesRegex;
using ::testing::StartsWith;

EXPECT_THAT(value1, StartsWith("Hello"));
EXPECT_THAT(value2, MatchesRegex("Line \\d+"));
ASSERT_THAT(value3, AllOf(Gt(5), Lt(10)));
```

If the assertion fails, GoogleTest prints the actual value and the matcher description.

---

## Boolean Condition Assertions

Used to verify Boolean expressions.

- `EXPECT_TRUE(condition)`, `ASSERT_TRUE(condition)`: Verify that condition is true.
- `EXPECT_FALSE(condition)`, `ASSERT_FALSE(condition)`: Verify that condition is false.

Example:
```cpp
EXPECT_TRUE(IsValid(user)) << "User must be valid";
```

---

## Binary Comparison Assertions

Verify relations between two values. Arguments are evaluated once; the order is undefined.

- `EXPECT_EQ(val1, val2)`, `ASSERT_EQ(val1, val2)`: Verifies `val1 == val2`.
- `EXPECT_NE(val1, val2)`, `ASSERT_NE(val1, val2)`: Verifies `val1 != val2`.
- `EXPECT_LT(val1, val2)`, `ASSERT_LT(val1, val2)`: Verifies `val1 < val2`.
- `EXPECT_LE(val1, val2)`, `ASSERT_LE(val1, val2)`: Verifies `val1 <= val2`.
- `EXPECT_GT(val1, val2)`, `ASSERT_GT(val1, val2)`: Verifies `val1 > val2`.
- `EXPECT_GE(val1, val2)`, `ASSERT_GE(val1, val2)`: Verifies `val1 >= val2`.

**Note:** For pointer equality use `EXPECT_EQ`. For C strings, use string comparison assertions described below.

Example:
```cpp
EXPECT_EQ(result.size(), expected_size) << "Size does not match";
```

---

## String Comparison Assertions

Compare **C strings** by content. Use `EXPECT_EQ` for `std::string` objects.

- `EXPECT_STREQ(str1, str2)`, `ASSERT_STREQ(str1, str2)`: Verifies contents are equal.
- `EXPECT_STRNE(str1, str2)`, `ASSERT_STRNE(str1, str2)`: Verifies contents differ.
- `EXPECT_STRCASEEQ(str1, str2)`, `ASSERT_STRCASEEQ(str1, str2)`: Case-insensitive equality.
- `EXPECT_STRCASENE(str1, str2)`, `ASSERT_STRCASENE(str1, str2)`: Case-insensitive inequality.

Example:
```cpp
EXPECT_STREQ(actual.c_str(), expected.c_str());
```

---

## Floating-Point Comparison Assertions

Due to precision issues, floating-point comparisons require specialized assertions.

- `EXPECT_FLOAT_EQ(val1, val2)`, `ASSERT_FLOAT_EQ(val1, val2)`: Asserts two floats are approximately equal within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)`, `ASSERT_DOUBLE_EQ(val1, val2)`: Asserts two doubles are approximately equal within 4 ULPs.
- `EXPECT_NEAR(val1, val2, abs_error)`, `ASSERT_NEAR(val1, val2, abs_error)`: Checks the absolute difference.

Example:
```cpp
EXPECT_NEAR(computed_value, expected_value, 0.001);
```

---

## Exception Assertions

For environments with exceptions enabled, assertions verify code throws or doesn't throw.

- `EXPECT_THROW(statement, exception_type)`, `ASSERT_THROW(statement, exception_type)`: Verify statement throws specified exception.
- `EXPECT_ANY_THROW(statement)`, `ASSERT_ANY_THROW(statement)`: Verify statement throws any exception.
- `EXPECT_NO_THROW(statement)`, `ASSERT_NO_THROW(statement)`: Verify statement does not throw.

Example:
```cpp
EXPECT_THROW(MyFunc(), std::runtime_error);
```

---

## Predicate Assertions

For conditions more complex than Boolean expressions, GoogleTest provides predicate assertions.

### EXPECT_PRED*

Macros to verify predicates of 1 to 5 arguments, printing argument values

Example:
```cpp
bool IsEven(int n) { return (n % 2) == 0; }
EXPECT_PRED1(IsEven, 4);
```

### EXPECT_PRED_FORMAT*

Use predicate-formatter functions returning `testing::AssertionResult` to customize failure messages.

Example:
```cpp
testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << n << " is odd";
}
EXPECT_PRED_FORMAT1(IsEven, 3);  // Will fail with message "3 is odd"
```

---

## Windows HRESULT Assertions

Test HRESULT success or failure results.

- `EXPECT_HRESULT_SUCCEEDED(expression)`, `ASSERT_HRESULT_SUCCEEDED(expression)`: Verifies HRESULT indicates success.
- `EXPECT_HRESULT_FAILED(expression)`, `ASSERT_HRESULT_FAILED(expression)`: Verifies HRESULT indicates failure.

Example:
```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

---

## Death Assertions

Verify that code causes the process to terminate (death tests).

- `EXPECT_DEATH(statement, matcher)`, `ASSERT_DEATH(statement, matcher)`: Verifies process exit with output matching `matcher`.
- `EXPECT_DEATH_IF_SUPPORTED`, `ASSERT_DEATH_IF_SUPPORTED`: Run the above only if death tests are supported.
- `EXPECT_DEBUG_DEATH`, `ASSERT_DEBUG_DEATH`: Run only in debug mode.
- `EXPECT_EXIT(statement, predicate, matcher)`, `ASSERT_EXIT(statement, predicate, matcher)`: Verify exit status satisfies `predicate` and output matches `matcher`.

Example:
```cpp
EXPECT_DEATH(ExitWithError(), "Error happened");
```

---

# Best Practices

- Use `EXPECT_` assertions for tests where subsequent checks can proceed despite failure.
- Use `ASSERT_` assertions when further test execution is invalid or unsafe after failure.
- Prefer `EXPECT_THAT` with matchers for readable, expressive assertions.
- For complex predicates, define predicate or predicate-formatter functions for clearer failure messages.
- Use string-specific assertions (`EXPECT_STREQ`, etc.) for C strings.
- For floating-point, prefer `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR`.
- When testing exceptions, confirm that exceptions thrown are of the expected type.
- For death tests, ensure that mock objects are allowed to leak if an exit is expected.

---

# Practical Example

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

using ::testing::_;  
using ::testing::Return;
using ::testing::StartsWith;
using ::testing::Test;

TEST(MathTest, IntegerEquality) {
  int x = 5;
  int y = 5;
  EXPECT_EQ(x, y) << "x and y should be equal";
}

TEST(StringTest, StringComparison) {
  const char* hello = "hello";
  const char* greeting = "hello";
  EXPECT_STREQ(hello, greeting);
  EXPECT_THAT(std::string("hello world"), StartsWith("hello"));
}

TEST(FloatingPointTest, NearValue) {
  double result = 3.14159;
  EXPECT_NEAR(result, 3.14, 0.01);
}

TEST(ExceptionTest, ThrowsRuntimeError) {
  EXPECT_THROW(throw std::runtime_error("fail"), std::runtime_error);
}

TEST(DeathTest, ProcessExits) {
  EXPECT_DEATH([](){ exit(1); }(), "");
}
```

---

# Troubleshooting Tips

- Use `EXPECT_PRED_FORMAT*` when dealing with predicates where argument streaming is problematic.
- If a test unexpectedly passes or fails, ensure the correct assertion type (`EXPECT_` vs `ASSERT_`) is used.
- For death tests, use `Mock::AllowLeak()` with mocks used in tests expected to exit early.
- Remember that `EXPECT_EQ` on pointers compares addresses, not content; use `EXPECT_STREQ` for C strings.
- Floating point comparisons require tolerant functions due to precision issues.
- When using `EXPECT_THROW`, ensure exceptions are enabled and the correct exception type is tested.

---

# See Also

- [Matchers Reference](matchers.md) for details on matchers used in `EXPECT_THAT`.
- [GoogleMock Cookbook](gmock_cook_book.md) for advanced usage of assertions in mocks.
- [GoogleTest Primer](primer.md) for foundational testing concepts and writing tests.
- [Mocking Reference](reference/mocking.md) for mocking capabilities.
- [Advanced GoogleTest Topics](docs/advanced.md) for predicates and specialized assertions.
