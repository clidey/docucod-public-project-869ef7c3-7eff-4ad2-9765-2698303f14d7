---
title: "Assertions and Predicate Macros"
description: "Provides detailed reference for assertion macros such as EXPECT_EQ, ASSERT_TRUE, and predicate-based assertions like ASSERT_PREDn/EXPECT_PREDn. Explains available assertion types, expected behaviors, typical usage, and how failures are reported."
---

# Assertions and Predicate Macros

This reference document details the comprehensive set of assertion macros provided by GoogleTest. These macros are fundamental for expressing test expectations and verifying conditions in your test code. Assertions can result in successes, nonfatal failures (allowing tests to continue), or fatal failures (which abort the current function).

---

## Overview of Assertion Macros

GoogleTest’s assertions come primarily in pairs:

- `EXPECT_*`: Generate nonfatal failures, allowing the function to continue.
- `ASSERT_*`: Generate fatal failures, aborting the current void-returning function.

Both kinds support streaming of custom failure messages with the `<<` operator for richer output and diagnostics.

### Using Custom Failure Messages

You can enhance failure feedback by streaming custom messages into assertions, for example:

```cpp
EXPECT_TRUE(condition) << "Condition failed because of reason X.";
ASSERT_EQ(a, b) << "Values do not match as expected.";
```

This message appends to GoogleTest’s default failure explanation, aiding debugging.


## Explicit Success and Failure

Sometimes, you want to mark success or failure explicitly.

### SUCCEED()

Generates a success assertion. It does not guarantee overall test success but can be used for documentation or to assert a logical branch was reached.

```cpp
SUCCEED();
```

### FAIL()

Generates a fatal failure and aborts execution in the current void-returning function.

```cpp
FAIL() << "Unexpected error occurred.";
```

### ADD_FAILURE()

Generates a nonfatal failure allowing the test to continue.

```cpp
ADD_FAILURE() << "Nonfatal failure detected.";
```

### ADD_FAILURE_AT(file, line)

Generates a nonfatal failure reported at a specific source file and line number.

```cpp
ADD_FAILURE_AT("foo.cc", 42) << "Check failed at line 42.";
```


## Boolean Conditions

These macros verify if an expression evaluates to true or false.

### EXPECT_TRUE(expression)

Verifies that the expression is true.

```cpp
EXPECT_TRUE(is_ready) << "Not ready to proceed.";
```

### ASSERT_TRUE(expression)

Same as `EXPECT_TRUE` but aborts the current function on failure.

### EXPECT_FALSE(expression)

Verifies that the expression is false.

```cpp
EXPECT_FALSE(has_errors) << "Unexpected errors occurred.";
```

### ASSERT_FALSE(expression)

Fatal version of `EXPECT_FALSE`.


## Binary Comparison

Compare two values with the expected relational operator.

They support types with properly overloaded operators and streaming.

### EXPECT_EQ(val1, val2)

Checks `val1 == val2`.

```cpp
EXPECT_EQ(result, expected) << "Result differs from expected.";
```

Use `EXPECT_STREQ` for C strings to compare contents, as `EXPECT_EQ` compares pointer addresses.

### ASSERT_EQ(val1, val2)

Fatal version of `EXPECT_EQ`.

### EXPECT_NE(val1, val2)

Checks `val1 != val2`.

### ASSERT_NE(val1, val2)

Fatal version of `EXPECT_NE`.

### EXPECT_LT(val1, val2)

Checks `val1 < val2`.

### ASSERT_LT(val1, val2)

Fatal version of `EXPECT_LT`.

### EXPECT_LE(val1, val2)

Checks `val1 <= val2`.

### ASSERT_LE(val1, val2)

Fatal version of `EXPECT_LE`.

### EXPECT_GT(val1, val2)

Checks `val1 > val2`.

### ASSERT_GT(val1, val2)

Fatal version of `EXPECT_GT`.

### EXPECT_GE(val1, val2)

Checks `val1 >= val2`.

### ASSERT_GE(val1, val2)

Fatal version of `EXPECT_GE`.


## C String Comparison

Specialized assertions for comparing C-style strings (`const char*`, `wchar_t*`).

### EXPECT_STREQ(str1, str2)

Verifies `str1` and `str2` have the same character contents.

### ASSERT_STREQ(str1, str2)

Fatal version of `EXPECT_STREQ`.

### EXPECT_STRNE(str1, str2)

Verifies `str1` and `str2` differ.

### ASSERT_STRNE(str1, str2)

Fatal version of `EXPECT_STRNE`.

### EXPECT_STRCASEEQ(str1, str2)

Case-insensitive equality check.

### ASSERT_STRCASEEQ(str1, str2)

Fatal version.

### EXPECT_STRCASENE(str1, str2)

Verifies strings differ ignoring case.

### ASSERT_STRCASENE(str1, str2)

Fatal version.

If `wchar_t*` strings are compared, failures print UTF-8 conversion of strings.


## Floating-Point Comparison

Because direct equality on floating points is unreliable due to rounding, GoogleTest offers specialized approximate comparisons.

### EXPECT_FLOAT_EQ(val1, val2)

Verifies `float` values equal within 4 ULPs.

### ASSERT_FLOAT_EQ(val1, val2)

Fatal version.

### EXPECT_DOUBLE_EQ(val1, val2)

For `double` values.

### ASSERT_DOUBLE_EQ(val1, val2)

Fatal version.

### EXPECT_NEAR(val1, val2, abs_error)

Verifies `|val1 - val2| <= abs_error`.

### ASSERT_NEAR(val1, val2, abs_error)

Fatal version.


## Exception Assertions

Require that exceptions are enabled in your build.

### EXPECT_THROW(statement, exception_type)

Verifies `statement` throws `exception_type`.

### ASSERT_THROW(statement, exception_type)

Fatal version.

### EXPECT_ANY_THROW(statement)

Verifies `statement` throws any exception.

### ASSERT_ANY_THROW(statement)

Fatal version.

### EXPECT_NO_THROW(statement)

Verifies `statement` throws nothing.

### ASSERT_NO_THROW(statement)

Fatal version.


## Predicate Assertions

Designed for complex predicates with clearer failure diagnostics than `EXPECT_TRUE()`.

### EXPECT_PREDn(pred, val1, val2, ...)

Verifies the `pred` function/functor returns true with the given values.

- Supports up to 5 parameters (e.g., `EXPECT_PRED1`, `EXPECT_PRED2`, ..., `EXPECT_PRED5`).
- On failure, prints the expression values.

Example:

```cpp
bool MutuallyPrime(int m, int n) { ... }
EXPECT_PRED2(MutuallyPrime, a, b);
```

### ASSERT_PREDn(pred, ...)

Fatal version of `EXPECT_PREDn`.

### EXPECT_PRED_FORMATn(pred_formatter, ...)

Predicate-formatter allows full control on failure message formatting.

The `pred_formatter` has signature:

```cpp
testing::AssertionResult PredicateFormatter(
    const char* expr1, const char* expr2, ..., const char* exprn,
    T1 val1, T2 val2, ..., Tn valn);
```

Returns `AssertionSuccess()` or `AssertionFailure()` with a message.

Used like:

```cpp
testing::AssertionResult AssertMutuallyPrime(
    const char* m_expr, const char* n_expr, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << m_expr << " and " << n_expr <<
      " are not mutually prime.";
}
EXPECT_PRED_FORMAT2(AssertMutuallyPrime, a, b);
```

### ASSERT_PRED_FORMATn(pred_formatter, ...)

Fatal version.


## Windows HRESULT Assertions

Microsoft Windows uses HRESULT type for COM operations. GoogleTest provides macros to verify success/failure.

### EXPECT_HRESULT_SUCCEEDED(expression)

Checks the HRESULT indicates success.

### ASSERT_HRESULT_SUCCEEDED(expression)

Fatal version.

### EXPECT_HRESULT_FAILED(expression)

Checks the HRESULT indicates failure.

### ASSERT_HRESULT_FAILED(expression)

Fatal version.

The failure message includes system error text for clarity.


## Death Assertions

Verifies that executing code causes the process to terminate.

Test is run in a separate process.

### EXPECT_DEATH(statement, matcher)

Verifies that `statement` causes the process to terminate with stderr output matching `matcher`. `matcher` can be a regular expression or a matcher object.

```cpp
EXPECT_DEATH(Foo(42), "Error occurred");
```

### ASSERT_DEATH(statement, matcher)

Fatal version.

### EXPECT_DEATH_IF_SUPPORTED(statement, matcher)

Behaves like `EXPECT_DEATH` if death tests are supported.

### EXPECT_DEBUG_DEATH(statement, matcher)

Runs `EXPECT_DEATH` in debug mode, else executes `statement` normally.

### EXPECT_EXIT(statement, predicate, matcher)

Verifies process exits with status satisfying `predicate` and stderr matching `matcher`. Example predicates: `ExitedWithCode(int)` or `KilledBySignal(int)`.


## Additional Utilities

### SCOPED_TRACE(message)

Adds contextual trace info (file, line, message) to each failure in scope.

Useful to identify which iteration or call site caused failures in shared subroutines.

Example:

```cpp
void Sub1(int n) {
  EXPECT_EQ(Bar(n), 1);
  EXPECT_EQ(Bar(n + 1), 2);
}

TEST(FooTest, Bar) {
  {
    SCOPED_TRACE("A");
    Sub1(1);
  }
  Sub1(9);
}
```


### HasFatalFailure()

Query whether current test has a fatal failure.

### HasNonfatalFailure()

Query whether current test has a nonfatal failure.

### HasFailure()

Checks if any failure (fatal or nonfatal) exists in current test.

### ASSERT_NO_FATAL_FAILURE(statement)

Verifies statement does not cause new fatal failures.

### EXPECT_NO_FATAL_FAILURE(statement)

Nonfatal version.

---

## Practical Tips

- Use `EXPECT_*` for continuing tests after failure to detect multiple issues.
- Use `ASSERT_*` when test logic depends on previous assertions.
- Use predicate assertions (`EXPECT_PRED*`) for clearer diagnostics on complex conditions.
- Use predicate-format assertions (`EXPECT_PRED_FORMAT*`) for custom failure messages.
- For string comparisons, prefer `EXPECT_STREQ` and family over `EXPECT_EQ` to compare contents.
- When testing exceptions, use the exception assertions macros.
- Use `SCOPED_TRACE` when testing code invoked multiple times to identify failure context.
- Use `RecordProperty()` (see Advanced docs) to attach custom key-value info to tests.


---

For full understanding of how to write tests and use assertions effectively, consult:

- [GoogleTest Primer](primer.md)
- [Advanced Topics: Assertions](advanced.md#using-assertions-in-sub-routines)
- [Assertions Reference](reference/assertions.md)


---

## Example: Using Predicate Assertions

```cpp
// Simple predicate
bool IsEven(int n) { return n % 2 == 0; }

TEST(NumberTest, IsEvenCheck) {
  EXPECT_PRED1(IsEven, 4);  // Succeeds
  EXPECT_PRED1(IsEven, 5);  // Fails, prints failure with evaluated argument
}

// Predicate with detailed message

testing::AssertionResult AssertIsEven(const char* expr, int n) {
  if (IsEven(n)) return testing::AssertionSuccess();

  return testing::AssertionFailure() << expr << " evaluates to " << n << ", which is not even.";
}

TEST(NumberTest, IsEvenDetailedCheck) {
  EXPECT_PRED_FORMAT1(AssertIsEven, 3);  // Failure prints custom message
}
```

This greatly improves test failure clarity over just `EXPECT_TRUE(IsEven(n))`.

---

## See Also

- [Matcher Assertions Reference](reference/matchers.md)
- [Mocking Reference](reference/mocking.md)
- [Advanced GoogleTest Topics](advanced.md)
- [Writing Your First Test](getting-started/configuration-first-run/first-test.md)
- [Test Macros and Test Registration](api-reference/core-apis/test-macros.md)



