---
title: "Writing and Running Tests"
description: "Explore the essential APIs and functions used to define and execute test cases using GoogleTest. Includes main test entry points, test discovery mechanisms, and details on integration with supported platforms."
---

# Writing and Running Tests

Explore the essential APIs and functions used to define and execute test cases in GoogleTest, including the main test entry points, the test discovery mechanism, and details on integration with supported platforms.

---

## 1. Getting Started with Tests

GoogleTest provides a straightforward way to define and run tests in your C++ projects. This section guides you through the core APIs that enable you to write test cases, organize them into test suites, and invoke the test runner.

### 1.1 Defining Tests

GoogleTest uses macros to define tests as functions with assertions inside.

- **`TEST(TestSuiteName, TestName)`**: Defines a basic test function inside a named test suite.

Example:

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}
```

- **`TEST_F(TestFixture, TestName)`**: Defines a test that uses a test fixture for shared setup and teardown, supporting more complex tests.

Example:

```cpp
class QueueTest : public ::testing::Test {
 protected:
  Queue<int> queue_;
  void SetUp() override {
    queue_.Enqueue(1);
  }
};

TEST_F(QueueTest, StartsNonEmpty) {
  EXPECT_FALSE(queue_.IsEmpty());
}
```

### 1.2 Using Assertions

Rules to check expectations inside your test functions. Assertions come in two kinds:

- **Fatal assertions (`ASSERT_*`)** abort the current function on failure.
- **Nonfatal assertions (`EXPECT_*`)** continue even after failure.

Example using assertion macros:

```cpp
ASSERT_EQ(actual, expected) << "Custom failure message";
EXPECT_TRUE(condition);
```

Use assertions to verify the behavior you expect in your code.

---

## 2. Running Tests

Once your tests are defined, GoogleTest offers a simple interface to run them all.

### 2.1 Initialization

Call `testing::InitGoogleTest(&argc, argv);` at the start of your `main()` function. This initializes the framework and parses command-line flags to configure behavior.

Example:

```cpp
int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### 2.2 Test Runner

- **`RUN_ALL_TESTS()`** runs all registered tests and returns 0 for success, or 1 if failures occur.
- You must check the return value of `RUN_ALL_TESTS()` as it reflects test success.
- The test runner runs tests independently to ensure isolation and repeatability.

### 2.3 Filtering Tests

You can run a subset of tests using filters by specifying the `--gtest_filter` flag when running the binary:

```
./my_test --gtest_filter=FactorialTest.*
```

Wildcards allow you to choose which test suites or individual tests to execute.

---

## 3. Test Discovery and Organization

GoogleTest automatically discovers tests defined with `TEST()` and `TEST_F()` macros.

- Tests are grouped into **test suites** (formerly called test cases) based on the suite name.
- Tests within a suite can share common setup via test fixtures.
- Each test runs in a fresh fixture instance, ensuring independence.

### 3.1 Test Fixtures

Use test fixtures (`TEST_F`) to set up shared objects and state common to multiple tests.

Example:

```cpp
class DatabaseTest : public ::testing::Test {
 protected:
  void SetUp() override {
    db.Connect();
  }
  void TearDown() override {
    db.Disconnect();
  }
  Database db;
};

TEST_F(DatabaseTest, InsertKey) {
  EXPECT_TRUE(db.Insert("key", "value"));
}
```

### 3.2 Naming Conventions

- Test suite and test names must be valid C++ identifiers.
- Avoid underscores in test names for consistency.
- Choose descriptive names that clearly express test intent.

---

## 4. Platform Integration

GoogleTest supports Linux, Windows, and Mac OS platforms with unified APIs.

### 4.1 Initialization Variants

- On Windows with UNICODE, use `InitGoogleTest(int* argc, wchar_t** argv)`.
- On embedded platforms, `InitGoogleTest()` without parameters is available.

### 4.2 Linking

- Use the `gtest_main` library if you don't want to write your own `main()` function.
- If custom behavior is required during startup, write your own `main()` as shown above.

---

## 5. Writing Tests: Workflow Summary

### Step-by-step process:

1. Define a test using `TEST()` or `TEST_F()`.
2. Put expectations inside the test body using assertions (`EXPECT_*` / `ASSERT_*`).
3. Initialize GoogleTest in your `main()` function.
4. Run `RUN_ALL_TESTS()` and handle the return value.

This flow guarantees isolated, fast, and maintainable tests.

---

## 6. Troubleshooting Common Issues

- **Tests not running?** Ensure tests are defined with `TEST`/`TEST_F` macros and your test binary links with GoogleTest properly.
- **No tests detected?** Check naming conventions and build system to include test files.
- **Crashes or assertion failures?** Use `EXPECT_*` assertions to allow multiple verifications per test.
- **Test output cluttered?** Use flags such as `--gtest_filter` to run focused tests.

---

## 7. Additional Resources

- [GoogleTest Primer](primer.md): Learn to write simple tests and understanding basic concepts.
- [Writing Your First Test](guides/getting-started/writing-your-first-test.md): Tutorial for beginners.
- [Assertions Reference](reference/assertions.md): Comprehensive assertion macros reference.
- [Mocking with GoogleMock](guides/advanced-testing-patterns/using-googlemock.md): For testing with mocks.
- [Integration and Extensibility](overview/system-architecture-and-key-concepts/integration-and-extensibility.md): Integrate with build and IDEs.

---

## Example: Basic Test Program

```cpp
#include <gtest/gtest.h>

int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Run this program and see GoogleTest execute the test and report results.

---

## Best Practices

- Always set up all necessary state in fixtures or the test itself to avoid dependencies between tests.
- Use `EXPECT_*` for most assertions to allow a test to check multiple conditions.
- Check the return value of `RUN_ALL_TESTS()` to ensure test results are reflected in your process exit status.
- Use `--gtest_filter` to run targeted test subsets and speed up development.

---

By mastering these APIs and workflows, you will be equipped to write effective, maintainable, and fast C++ tests with GoogleTest.
