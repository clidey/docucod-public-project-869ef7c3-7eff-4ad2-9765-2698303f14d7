---
title: "Assertions"
description: "Describes all assertion macros and functions for writing effective C++ tests, including equality, inequality, exception, floating-point, string, and death test assertions. Explains when to use each assertion type and the difference between fatal and non-fatal failures, with usage examples and references to extensibility points for custom assertion creation."
---

# Assertions

GoogleTest provides a rich set of assertion macros and functions to verify the behavior of your C++ code in tests. These include checks for equality, inequality, exceptions, floating-point comparisons, strings, and more. Assertions can generate either **fatal failures** (which abort the current function) or **nonfatal failures** (which log failures but continue execution), offering flexibility in test flow control.

---

## 1. Understanding Assertions

Assertions serve to verify that your code under test behaves as expected. In GoogleTest, assertions come in pairs:

- `EXPECT_*`: Nonfatal. Report failures but continue executing the current test function.
- `ASSERT_*`: Fatal. Abort the current test function immediately upon failure.

This allows fine-grained control over whether subsequent test statements should run after an assertion failure.

All assertions accept custom failure messages via `<<` streaming for richer diagnostics.

---

## 2. Explicit Success and Failure

Sometimes, you want to explicitly mark a test as successful or failed without testing a condition.

### SUCCEED()

```cpp
SUCCEED();
```
Generates a success, which is mainly useful for documenting that a particular point was reached. It does not affect the overall test outcome.

### FAIL()

```cpp
FAIL() << "This failure message explains the reason.";
```
Generates a fatal failure, aborting the current function immediately. Use it when a failure is unconditional or arises due to unexpected control flow.

### ADD_FAILURE()

```cpp
ADD_FAILURE() << "A nonfatal failure message.";
```
Generates a nonfatal failure allowing the test function to continue.

### ADD_FAILURE_AT(file, line)

```cpp
ADD_FAILURE_AT("myfile.cc", 123) << "Failure at a specific line.";
```
Generates a nonfatal failure reported at the specified source location.

---

## 3. Generalized Assertions with Matchers

GoogleTest supports expressive assertions using matchers, integrating seamlessly with GoogleMock.

### EXPECT_THAT(value, matcher)

```cpp
EXPECT_THAT(value, ::testing::StartsWith("Hello"));
ASSERT_THAT(value, ::testing::AllOf(::testing::Gt(5), ::testing::Lt(10)));
```
Verifies that a value matches the specified matcher, which can be a built-in matcher or a custom one. Matchers provide rich and readable criteria for validation.

Matchers enable detailed failure messages explaining mismatches clearly.

---

## 4. Boolean Condition Assertions

### EXPECT_TRUE(condition) / ASSERT_TRUE(condition)

Verifies that the given condition is true.

### EXPECT_FALSE(condition) / ASSERT_FALSE(condition)

Verifies that the given condition is false.

```cpp
EXPECT_TRUE(IsValid(input)) << "Input should be valid";
ASSERT_FALSE(Failed()) << "Should not fail";
```

---

## 5. Binary Comparison Assertions

For comparing two values. The values must be comparable with the corresponding operator.

- `EXPECT_EQ(val1, val2)` — verifies `val1 == val2`
- `EXPECT_NE(val1, val2)` — verifies `val1 != val2`
- `EXPECT_LT(val1, val2)` — verifies `val1 < val2`
- `EXPECT_LE(val1, val2)` — verifies `val1 <= val2`
- `EXPECT_GT(val1, val2)` — verifies `val1 > val2`
- `EXPECT_GE(val1, val2)` — verifies `val1 >= val2`

Example:
```cpp
EXPECT_EQ(result, expected_value) << "Result mismatch";
```

### Important Notes:
- For pointers, `EXPECT_EQ`/`EXPECT_NE` check pointer addresses, not contents.
- To compare C strings by value use string-specific assertions (see next section).

---

## 6. String Comparison Assertions

For comparing **C strings** (`const char*`, `wchar_t*`):

- `EXPECT_STREQ(str1, str2)` — verifies string content equality
- `EXPECT_STRNE(str1, str2)` — verifies string content inequality
- `EXPECT_STRCASEEQ(str1, str2)` — case-insensitive equality
- `EXPECT_STRCASENE(str1, str2)` — case-insensitive inequality

For `std::string` objects, use `EXPECT_EQ` or `EXPECT_NE` instead.

```cpp
EXPECT_STREQ(actual.c_str(), "expected string") << "Strings differ!";
```

---

## 7. Floating-Point Comparison Assertions

Due to rounding errors, exact equality for floating-points is rarely meaningful. GoogleTest provides specialized assertions for approximate equality:

- `EXPECT_FLOAT_EQ(val1, val2)` — Verifies the two floats are approximately equal within 4 Units in the Last Place (ULPs).
- `EXPECT_DOUBLE_EQ(val1, val2)` — Same as above for doubles.
- `EXPECT_NEAR(val1, val2, abs_error)` — Verifies the absolute difference between values is within `abs_error`.

```cpp
EXPECT_NEAR(computed_value, expected_value, 1e-5) << "Values are not close enough";
```

Note: Matching infinity values considers specific edge cases as described in GoogleTest’s documentation.

---

## 8. Exception Assertions

These assertions verify exception-throwing behavior. Requires compiler support for exceptions.

- `EXPECT_THROW(statement, exception_type)` — Verifies `statement` throws `exception_type`.
- `EXPECT_ANY_THROW(statement)` — Verifies `statement` throws any exception.
- `EXPECT_NO_THROW(statement)` — Verifies `statement` does not throw.

```cpp
EXPECT_THROW(Divide(1, 0), std::invalid_argument);
EXPECT_NO_THROW(ProcessData(data));
```

---

## 9. Predicate Assertions

Sometimes verifying a complex condition requires custom predicates.

- `EXPECT_PREDx(pred, ...)` asserts a predicate function/functor *pred* returns true for given arguments.
- `EXPECT_PRED_FORMATx(pred_formatter, ...)` allows richer failure messages via predicate-formatters returning `AssertionResult`.

Example:
```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, value) << "Value must be even";
```

Predicate formatters can generate informative failure messages, improving debugging clarity.

---

## 10. Death Assertions

Death assertions verify that code snippets terminate the current process with specified output.

- `EXPECT_DEATH(statement, matcher)` — Verifies that `statement` causes the process to exit nonzero and outputs stderr matching `matcher`.
- `EXPECT_DEATH_IF_SUPPORTED` — Performs death test if supported, otherwise no verification.
- `EXPECT_DEBUG_DEATH` — Runs death test only in debug mode.
- `EXPECT_EXIT(statement, predicate, matcher)` — Verifies exit status satisfies `predicate` and stderr output matches `matcher`.

Example:
```cpp
EXPECT_DEATH(CallFailingFunction(), "Fatal Error");
EXPECT_EXIT(CleanExit(), ::testing::ExitedWithCode(0), "Success");
```

---

## 11. Fatal vs Nonfatal Failures and When to Use Which

- Use `ASSERT_*` when subsequent operations depend on the success of the assertion.
- Use `EXPECT_*` when you want the test to continue to catch multiple failures in one run.

For example, if a failing condition makes the rest of the test irrelevant, use `ASSERT_*` to immediately stop.

---

## 12. Practical Tips & Best Practices

- Use matchers (`EXPECT_THAT`) for expressive and maintainable checks.
- Avoid over-constraining tests by verifying only necessary properties.
- Use `EXPECT_*` for validations, reserving `ASSERT_*` for essential prerequisites.
- For floating-point tests, prefer `EXPECT_NEAR` or `EXPECT_FLOAT_EQ` over `EXPECT_EQ`.
- When testing exceptions, use `EXPECT_THROW` to ensure correctness.
- For death tests, carefully specify expected output and ensure the code terminates as intended.
- Supplement assertions with meaningful custom failure messages for faster debugging.

---

## 13. Summary of Common Assertions

| Assertion       | Description                                    |
| --------------- | ---------------------------------------------- |
| `EXPECT_TRUE` / `ASSERT_TRUE` | Condition is true                      |
| `EXPECT_FALSE` / `ASSERT_FALSE` | Condition is false                    |
| `EXPECT_EQ(a, b)` / `ASSERT_EQ(a, b)` | `a == b`                        |
| `EXPECT_NE(a, b)` / `ASSERT_NE(a, b)` | `a != b`                        |
| `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE` | Relational comparisons  |
| `EXPECT_STREQ`, `EXPECT_STRNE`      | C string equality / inequality         |
| `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ` | Approximate float/double equality   |
| `EXPECT_NEAR`                       | Approximate comparison within error    |
| `EXPECT_THROW`, `EXPECT_NO_THROW`               | Exception assertions              |
| `EXPECT_THAT`                      | Matcher-based flexible assertions      |
| `EXPECT_DEATH`                    | Death tests                            |

---

For examples, usage notes, and details about custom assertion creation, see the GoogleTest [Assertions Reference](https://google.github.io/googletest/reference/assertions.html).

---

## Related Documentation

- [Matchers Reference](../matchers.md): For building complex matching criteria used inside assertions.
- [GoogleMock Cookbook](../gmock_cook_book.md): For extending assertions with mocks and actions.
- [Death Tests, Fatal, and Non-Fatal Failures](../guides/advanced-and-integrations/death-tests-and-fatal-failures.mdx): Best practices for death test assertions.

---

<Source url="https://github.com/google/googletest" paths={[{"path": "docs/reference/assertions.md", "range": "1-200"}]} />
