---
title: "Test Macros and Test Registration"
description: "Documents the macros used to define and register tests and test suites, such as TEST, TEST_F, TEST_P, and typed test macros. Explains their purpose, usage patterns, and typical code examples to quickly onboard users into writing unit tests."
---

# Test Macros and Test Registration

GoogleTest provides a rich set of macros and APIs that empower you to define, organize, and register tests in your C++ projects. This page focuses specifically on the essential macros and runtime registration functions used to write individual tests, test fixtures, parameterized tests, typed tests, and their variants. Understanding these tools lets you seamlessly build comprehensive and maintainable test suites.

---

## 1. Core Test Definition Macros

GoogleTest offers several macros to define tests based on different user intentions and test design patterns. Each serves a distinct role in organizing test logic, sharing common test data, or parameterizing test execution.

### 1.1 `TEST`

**Purpose:** Defines an independent, non-fixture-based test.

**Use Case:** When you want to write simple tests that are quick and straightforward without any shared test data or complex setup.

**Syntax:**
```cpp
TEST(TestSuiteName, TestName) {
  // Test body containing assertions
}
```

- `TestSuiteName`: Groups related tests logically.
- `TestName`: Identifies the individual test uniquely within the suite.

**Example:**
```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(3), 6);
}
```

### 1.2 `TEST_F`

**Purpose:** Defines a test that uses a test fixture class for shared setup and teardown.

**Use Case:** When multiple tests need common objects, state, or utility functions.

**Syntax:**
```cpp
TEST_F(TestFixtureName, TestName) {
  // Test body
}
```

- `TestFixtureName` must be a class derived from `testing::Test`.

**Example:**
```cpp
class QueueTest : public testing::Test {
 protected:
  Queue<int> queue_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(queue_.size(), 0);
}

TEST_F(QueueTest, DequeueReturnsNullWhenEmpty) {
  EXPECT_EQ(queue_.Dequeue(), nullptr);
}
```

### 1.3 `TEST_P`

**Purpose:** Defines a *value-parameterized* test.

**Use Case:** When you want to run the same logical test repeatedly with different input parameters.

**Syntax:**
```cpp
TEST_P(TestFixtureWithParam, TestName) {
  auto param = GetParam();
  // Test that uses param
}
```

- The fixture class needed: derive from `testing::TestWithParam<T>` or `testing::Test` and `testing::WithParamInterface<T>`.
- Use `GetParam()` to access the test parameter.

**Example:**
```cpp
class FooTest : public testing::TestWithParam<int> {};

TEST_P(FooTest, IsEven) {
  EXPECT_EQ(GetParam() % 2, 0);
}

INSTANTIATE_TEST_SUITE_P(EvenNumbers, FooTest, testing::Values(2, 4, 6));
```

### 1.4 Typed Tests and Type-Parameterized Tests

For scenarios where the same test logic needs to be applied over multiple types, GoogleTest supports two complementary patterns.

#### 1.4.1 `TYPED_TEST_SUITE` and `TYPED_TEST`

- Use these to write *typed tests* when you know the complete list of types at test writing time.
- Define a template fixture class parameterized by `typename T`.
- Instantiate the test suite with a list of types.

**Syntax:**
```cpp
template <typename T>
class MyTypedTest : public testing::Test {
  // fixture code
};
using MyTypes = ::testing::Types<int, double, char>;
TYPED_TEST_SUITE(MyTypedTest, MyTypes);

TYPED_TEST(MyTypedTest, DoesBlah) {
  TypeParam value = ...;  // refer to current tested type
  // test code
}
```

#### 1.4.2 `TYPED_TEST_SUITE_P`, `TYPED_TEST_P`, and Registration

- Use these *type-parameterized tests* when you want to define generic type-based tests first and instantiate them with subsets of types later.
- Declare the suite as _parameterized_ and register test patterns.

**Syntax:**
```cpp
template <typename T>
class MyTypedTest : public testing::Test {};

TYPED_TEST_SUITE_P(MyTypedTest);

TYPED_TEST_P(MyTypedTest, HasPropertyA) { ... }

REGISTER_TYPED_TEST_SUITE_P(MyTypedTest, HasPropertyA);

using MySelectedTypes = ::testing::Types<int, double>;
INSTANTIATE_TYPED_TEST_SUITE_P(MyInstantiation, MyTypedTest, MySelectedTypes);
```

---

## 2. Test Suite and Fixture Registration

Normally, tests defined with the above macros register automatically. In some advanced cases, you may want to register tests dynamically at runtime.

### 2.1 `RegisterTest`

Enables dynamic runtime registration of individual tests.

**Signature:**
```cpp
template <typename Factory>
TestInfo* RegisterTest(const char* test_suite_name, const char* test_name,
                      const char* type_param, const char* value_param,
                      const char* file, int line, Factory factory);
```

- Takes a test suite name and test name, with optional type/value parameters.
- Requires a factory callable that produces new test fixture instances.
- You must register **before** calling `RUN_ALL_TESTS()`.

**Use Case:**
- Dynamically create tests based on external data or configuration.
- Useful in plugins or frameworks where tests are not statically known.

**Example:**
```cpp
class MyFixture : public testing::Test {
  //...
};

class DynamicTest : public MyFixture {
 public:
  explicit DynamicTest(int param) : param_(param) {}
  void TestBody() override {
    EXPECT_GT(param_, 0);
  }
 private:
  int param_;
};

void RegisterDynamicTests(const std::vector<int>& params) {
  for (int p : params) {
    testing::RegisterTest(
        "MyDynamicSuite", 
        ("Test" + std::to_string(p)).c_str(),
        nullptr, std::to_string(p).c_str(),
        __FILE__, __LINE__,
        [p]() -> MyFixture* { return new DynamicTest(p); });
  }
}

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  RegisterDynamicTests({1, 2, 3});
  return RUN_ALL_TESTS();
}
```

---

## 3. Common Usage Patterns and Best Practices

### 3.1 Naming Conventions

- Test suite names and test names should be valid C++ identifiers without underscores to avoid issues.
- Typed tests and parameterized tests automatically generate suffixes, but you can customize them.

### 3.2 Test Independence and Fixture Freshness

- Each test runs with a fresh instance of the fixture.
- Avoid side effects in fixtures that can affect other tests.

### 3.3 When to Use What

| Scenario                                        | Recommended Macro                      |
|------------------------------------------------|-------------------------------------|
| Simple, standalone test                         | `TEST`                              |
| Tests sharing common setup/teardown             | `TEST_F`                            |
| Running same logic on different input values    | `TEST_P` + `INSTANTIATE_TEST_SUITE_P` |
| Running same logic on multiple data types       | `TYPED_TEST_SUITE` + `TYPED_TEST`   |
| Generic tests instantiated later with types     | `TYPED_TEST_SUITE_P`, `TYPED_TEST_P`, `REGISTER_TYPED_TEST_SUITE_P` |
| Dynamic test creation at runtime                 | `RegisterTest()`                    |

### 3.4 Instantiation Macros

To create actual tests from parameterized test patterns:

- **Value-Parameterized Tests:**
  ```cpp
  INSTANTIATE_TEST_SUITE_P(InstantiationName, TestSuiteName, param_generator);
  ```

- **Typed Tests:**
  ```cpp
  TYPED_TEST_SUITE(TestSuiteName, TypeList);
  ```

- **Type-Parameterized Tests:**
  ```cpp
  REGISTER_TYPED_TEST_SUITE_P(TestSuiteName, TestNames...);
  INSTANTIATE_TYPED_TEST_SUITE_P(InstantiationName, TestSuiteName, TypeList);
  ```

---

## 4. Practical Code Examples

### 4.1 Basic Test
```cpp
TEST(MathTest, Addition) {
  EXPECT_EQ(2 + 2, 4);
}
```

### 4.2 Test Fixture
```cpp
class DatabaseTest : public testing::Test {
 protected:
  void SetUp() override {
    db.Connect();
  }
  void TearDown() override {
    db.Disconnect();
  }
  Database db;
};

TEST_F(DatabaseTest, QueryReturnsResults) {
  EXPECT_TRUE(db.Query("SELECT * FROM users"));
}
```

### 4.3 Value-Parameterized Test
```cpp
class IsEvenTest : public testing::TestWithParam<int> {};

TEST_P(IsEvenTest, ReturnsTrueForEvenNumbers) {
  EXPECT_EQ(GetParam() % 2, 0);
}

INSTANTIATE_TEST_SUITE_P(EvenValues, IsEvenTest, testing::Values(2, 4, 6, 8));
```

### 4.4 Typed Test
```cpp
template <typename T>
class MathTest : public testing::Test {};

using MyTypes = ::testing::Types<int, double>;
TYPED_TEST_SUITE(MathTest, MyTypes);

TYPED_TEST(MathTest, CanAdd) {
  TypeParam a = 1;
  TypeParam b = 2;
  EXPECT_EQ(a + b, 3);
}
```

### 4.5 Dynamic Test Registration
```cpp
class CustomTest : public testing::Test {
 public:
  explicit CustomTest(const std::string& data) : data_(data) {}
  void TestBody() override {
    EXPECT_FALSE(data_.empty());
  }
 private:
  std::string data_;
};

void RegisterCustomTests(const std::vector<std::string>& inputs) {
  for (const auto& input : inputs) {
    testing::RegisterTest(
      "CustomTestSuite", input.c_str(), nullptr, nullptr, __FILE__, __LINE__,
      [input]() -> CustomTest* { return new CustomTest(input); });
  }
}
```

---

## 5. Troubleshooting and Common Pitfalls

- **Using `TEST_F` Without Fixture Definition:** Ensure the fixture class exists and derives from `testing::Test`.
- **Value-Parameterized Tests Without Instantiation:** Always pair `TEST_P` with `INSTANTIATE_TEST_SUITE_P` or use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` to suppress errors.
- **Naming Conflicts:** Avoid underscores in test suite and test names to prevent filtering issues.
- **RegisterTest Usage:** Call `RegisterTest` before invoking `RUN_ALL_TESTS()`. Late registrations have undefined behavior.
- **Fixture Freshness:** Do not rely on state persistence between tests.

---

For deeper understanding and examples, consider exploring complementary pages such as the [Testing Reference](reference/testing.md) and [Value and Type-Parameterized Tests Guide](guides/core-testing-workflows/parameterized-tests.mdx).

---

## Additional Resources

- [GoogleTest Primer](docs/primer.md) — Learn foundational concepts and patterns.
- [Advanced GoogleTest Topics](docs/advanced.md) — Explore assertions, test environment, and advanced registration.
- [Mocking Reference](docs/reference/mocking.md) — For adding mocks alongside tests.
- [Core Features Overview](overview/introducing-googletest/core-features-benefits) — High-level feature summary.

<Source url="https://github.com/google/googletest" branch="main" paths='[{"path": "docs/reference/testing.md", "range": "0-500"},{"path": "googletest/include/gtest/gtest-param-test.h", "range": "0-150"},{"path": "googletest/include/gtest/gtest-typed-test.h", "range": "0-200"}]' />