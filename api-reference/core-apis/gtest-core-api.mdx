---
title: "Basic Test API"
description: "Overview and details of the core GoogleTest API, including test case/class definitions, test registration, and the lifecycle of a test. Lays the groundwork for all further use of the framework."
---

# Basic Test API

An essential foundation for using the GoogleTest framework is understanding its core API, which revolves around defining, registering, and executing tests. This page provides an overview of the foundational test constructs such as test cases (test suites), individual tests, fixtures, and the life cycle of tests. Mastering these concepts is critical as they establish the groundwork upon which all GoogleTest functionality is built.

---

## Test Suites and Test Cases

In GoogleTest, tests are organized into groups known as *test suites* (previously called *test cases*). A test suite logically bundles related tests, typically reflecting the structure or behavior of the software under test. Each test suite can contain one or more individual tests, providing a clear hierarchy for organizing test code.

### Creating a Simple Test

The simplest way to define a test is by using the `TEST()` macro:

```cpp
TEST(TestSuiteName, TestName) {
  // ... test code and assertions ...
}
```

- `TestSuiteName`: Name of the test suite (group of tests).
- `TestName`: Name of the specific test within the suite.

Both names must be valid C++ identifiers without underscores to align with naming conventions.

Example:

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
}
```

This example defines two tests related to a factorial function within the `FactorialTest` suite.

### Test Outcome

Test results depend on assertions within the test body. A test passes if:

- All assertions succeed,
- No fatal failures occur,
- The test does not crash.

If an assertion fails, it produces either a *non-fatal failure* (test continues) or a *fatal failure* (test aborts).

---

## Test Fixtures: Sharing Setup Across Tests

For scenarios where multiple tests require the same setup or shared resources, GoogleTest uses *test fixtures*. These are classes derived from `testing::Test` that group related tests and provide common setup/teardown code.

### Defining a Test Fixture

Steps to create a fixture:

1. Define a subclass of `testing::Test`:

   ```cpp
   class MyTestFixture : public testing::Test {
    protected:
     // Members and setup/teardown.
   };
   ```

2. Declare any shared objects or resources in the protected section.

3. Override the `SetUp()` method to initialize resources before each test.

4. Override the `TearDown()` method to clean up after each test.

Example fixture:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};
```

### Writing Tests Using Fixtures

Use `TEST_F()` instead of `TEST()` to access members of the test fixture:

```cpp
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  delete n;
}
```

Each `TEST_F()` call runs with a fresh instance of the fixture, ensuring test isolation.

---

## Test Lifecycle

Understanding the lifecycle of a test helps in structuring tests effectively.

### For a Simple `TEST()`

1. Construct the test object.
2. Run the test body.
3. Destroy the test object.

### For `TEST_F()` with Fixtures

1. Create a new fixture instance.
2. Call its `SetUp()` method.
3. Run the test body.
4. Call `TearDown()`.
5. Destroy the fixture instance.

This happens for each test, guaranteeing independence.

---

## Test Program Execution

The GoogleTest framework automatically registers all defined tests at compile time. To run the tests, you usually:

1. Initialize GoogleTest in `main()`:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

2. `RUN_ALL_TESTS()` runs every registered test and returns `0` on success, or `1` if any test fails.

---

## Important Notes and Best Practices

- **Do not ignore `RUN_ALL_TESTS()`'s return value.** It signals test success or failure and should be returned.
- **Use `TEST_F()` only with properly defined fixtures.** Defining a fixture after using it leads to compilation errors.
- **Tests should be independent and repeatable.** Avoid sharing state between tests without clear fixture design.
- **Name test suites and tests clearly and consistently,** preferably matching domain or feature names.
- **Avoid underscores in test and suite names** to conform with GoogleTest's naming conventions.

---

## Example: Putting It All Together

```cpp
#include <gtest/gtest.h>

int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

TEST(FactorialTest, HandlesZero) {
  EXPECT_EQ(Factorial(0), 1);
}

class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This example defines both simple tests and fixture-based tests and demonstrates the typical test program structure.

---

## Troubleshooting Common Issues

- **Test fixture compiler errors:** ensure your fixture class is declared before using it with `TEST_F()`.
- **`RUN_ALL_TESTS()` not called or return ignored:** your test program won't run tests or may violate CI expectations.
- **Tests run in unexpected order:** test order can be randomized; use appropriate flags if order matters.
- **Shared mutable state between tests:** avoid side effects between tests; use fixtures to isolate state.

For more help with these and other common problems, see the [Troubleshooting Common Installation & Build Issues](https://github.com/google/googletest/blob/main/docs/getting-started/first-test-debugging/troubleshooting-common-issues.md) guide.

---

## See Also

- **[GoogleTest Primer](primer.md):** An introduction to writing tests with GoogleTest.
- **[Mocking Reference](reference/mocking.md):** For advanced use cases with GoogleMock.
- **[Test Fixtures Guide](../guides/core-workflows/structuring-tests.md):** Deep dive into writing and organizing tests with fixtures.
- **[Assertions Reference](reference/assertions.md):** Details on assertion macros used to determine test outcomes.
- **[Running Tests](../guides/getting-started/writing-your-first-test.md#running-tests):** Understanding test execution and command-line options.

---

Embedding this foundational knowledge will enable you to write, organize, and execute GoogleTest tests effectively, unlocking the full power of the framework as you advance.