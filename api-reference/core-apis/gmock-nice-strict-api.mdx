---
title: "Mock Strictness Control"
description: "API for controlling how uninteresting calls to mocks are handled: silent (NiceMock), warning (NaggyMock), and error (StrictMock). Guides users on using and choosing the right strictness for their testing scenario."
---

# Mock Strictness Control

The Mock Strictness Control API enables precise management of how a mock object handles calls to its methods that have no explicit expectations, known as *uninteresting calls*. By applying strictness modifiers—`NiceMock`, `NaggyMock`, and `StrictMock`—you decide whether these uninteresting calls should be silently ignored, issue warnings, or cause errors. This guidance helps you choose the right strictness level that aligns with your test's goals and maintainability.

---

## Overview of Mock Strictness

When testing with mocks, you often face calls your code makes on mock methods that you did not explicitly set expectations for. How these calls are handled affects both the clarity and robustness of your tests. GoogleTest offers three strictness modifiers for your mock classes:

| Modifier      | Behavior on Uninteresting Calls                       | Use Case                                                                                      |
|---------------|-------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| `NiceMock`    | Silences all warnings for uninteresting calls.        | Use when uninteresting calls are expected and should not clutter test output.                  |
| `NaggyMock`   | Prints a warning for each uninteresting call.         | Default behavior; useful during test development to catch unexpected usage.                    |
| `StrictMock`  | Treats uninteresting calls as errors, failing tests.  | Use to enforce strict checking that no unexpected calls happen.                               |


## Why Control Mock Strictness?

Choosing the appropriate strictness level ensures your tests reflect exactly what you want to observe:

- **Encourage test stability and readability:** Too strict mocks may cause tests to fail on harmless changes, while too lenient mocks may hide bugs.
- **Balance noise and safety:** Warnings with `NaggyMock` help identify unplanned calls without immediately failing tests.
- **Focus on critical behavior:** Use `StrictMock` when you want to be sure your code only calls methods you've explicitly expected.


## Using Strictness Modifiers

The strictness modifiers are class templates that wrap your mock classes, inheriting their interfaces and constructors. They do not require any changes to your mock class definitions.

### Syntax

```cpp
// Assuming you have a mock class: MockFoo
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

// Constructing mocks with different strictness:
NiceMock<MockFoo> nice_mock;
NaggyMock<MockFoo> naggy_mock;
StrictMock<MockFoo> strict_mock;

// Supports passing constructor arguments to MockFoo:
NiceMock<MockFoo> nice_with_args(arg1, arg2);
```

### Differences in Behavior

| Strictness  | Uninteresting Call Outcome                 | Effect on Test                                                                              |
|-------------|-------------------------------------------|--------------------------------------------------------------------------------------------|
| `NiceMock`  | Calls succeed silently, no warnings.      | Test continues, ignoring unexpected calls.                                                |
| `NaggyMock` | Calls permitted, warning printed to stdout.| Test continues, but you get diagnostic info for unexpected calls.                          |
| `StrictMock`| Calls treated as failure, immediate test failure.| Test fails when uninteresting call occurs, enabling early detection of unwanted calls. |


## Practical Examples

### Suppressing Uninteresting Call Warnings with `NiceMock`

```cpp
class MockDatabase {
 public:
  MOCK_METHOD(bool, Connect, (), ());
  MOCK_METHOD(int, Query, (const std::string&), ());
};

TEST(DatabaseTest, AllowsUninterestingCalls) {
  NiceMock<MockDatabase> db;
  EXPECT_CALL(db, Connect()).Times(1);

  db.Connect();  // OK
  db.Query("SELECT * FROM table");  // No warning, no failure
}
```

In this test, calls to `Query` without explicit expectations do not produce warnings, allowing flexible test coding.


### Warning on Uninteresting Calls with `NaggyMock` (Default)

```cpp
NaggyMock<MockDatabase> db;
EXPECT_CALL(db, Connect()).Times(1);

db.Connect();
db.Query("foo");  // Prints warning: Uninteresting mock function call
```

Helpful when developing tests to discover unexpected interactions.


### Enforcing No Unexpected Calls with `StrictMock`

```cpp
StrictMock<MockDatabase> db;
EXPECT_CALL(db, Connect()).Times(1);

db.Connect();
db.Query("foo");  // Test failure: Uninteresting mock function call
```

Use this when you want to ensure all mock function calls are expected and verified.


## Construction and Inheritance

The modifiers `NiceMock<T>`, `NaggyMock<T>`, and `StrictMock<T>` inherit all constructors from the mock class `T`. This means you can construct them just like the original mock:

```cpp
MockFoo(int x, const std::string& s);

NiceMock<MockFoo> nice(x, s);
StrictMock<MockFoo> strict(x, s);
```

This is essential for mocks requiring parameters.


## Important Considerations

- **Qualified Constructors:** The modifiers forward constructor arguments ensuring correct initialization.
- **Support Only for MOCK_METHOD:** The modifiers work only with mock methods defined by `MOCK_METHOD` macros directly in the mock class, not base classes.
- **No Nesting:** Combining nested strictness modifiers (e.g., `NiceMock<StrictMock<MockFoo>>`) is unsupported.
- **Virtual Destructors:** The original mock class should have a virtual destructor to ensure correct polymorphic behavior.


## Common Use Cases and Best Practices

### When to Use `NiceMock`

- During early stages of test writing to reduce noise.
- When calls to certain methods are expected but irrelevant to verify.
- To maintain test readability without overwhelming warning messages.

### When to Use `NaggyMock`

- As the default for testing, to catch unexpected usage without failing 
immediately.
- Helpful for debugging unexpected interactions in complex tests.

### When to Use `StrictMock`

- When you want strict verification that no calls go unmatched.
- To catch regressions caused by code calling unplanned API methods.
- Useful in critical modules where unexpected calls represent serious issues.


## Understanding Uninteresting vs Unexpected Calls

- An **uninteresting call** is a call to a mock method with no matching `EXPECT_CALL`.
- An **unexpected call** is a call to a method where some `EXPECT_CALL` exists but no matching expectation fits the call.
- `NiceMock` and `StrictMock` only affect *uninteresting calls* behavior.
- Unexpected calls always cause test failures regardless of strictness modifier.


## Troubleshooting

### Are Uninteresting Calls Still Warning or Failing?

- Check if you wrapped your mock with `NiceMock` or `StrictMock`.
- Ensure your mock methods use `MOCK_METHOD` macros directly in the mock class.
- Verify no nested strictness modifiers are used.

### Why Are Warnings Still Printed with `NiceMock`?

- Some method mocks defined in a base class do not get affected by the strictness modifier due to compiler limitations.
- Unwrapped calls or mocks without strictness wrappers will show warnings.

### Unexpected Calls Always Fail

- This is intentional. Ensure you set `EXPECT_CALL` for all intended method calls.


## Additional Tips

- Use explicit `EXPECT_CALL` or `ON_CALL` to define behaviors for methods you care about.
- For methods where call count or arguments don’t matter, omit `EXPECT_CALL` or wrap with `NiceMock`.
- To ignore certain methods entirely, add a catch-all expectation with `.Times(AnyNumber())`.
- Use sequences and ordering constraints to specify call orders regardless of strictness.


## Related Documentation

- [Mocking API](https://google.github.io/googletest/api-reference/core-apis/gmock-mocking-api) for detailed information on `EXPECT_CALL` and mock methods.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy) for recipes and practical guidance on strictness.
- [Mocking Basics](https://google.github.io/googletest/guides/core-workflows/mocking-basics) for workflows using mocks.


---

## Conceptual Mermaid Diagram: Control Flow of Uninteresting Calls Based on Mock Strictness

```mermaid
flowchart TD
  Start([Mock Method Called]) --> CheckExpectation{Is there an EXPECT_CALL matching?}
  CheckExpectation -->|Yes| MatchAndRun[Run matching EXPECT_CALL action]
  MatchAndRun --> End([Return result or void])

  CheckExpectation -->|No| CheckStrictness{Strictness of the Mock?}
  CheckStrictness -->|NiceMock| SilentReturn[Return default; no warnings]
  CheckStrictness -->|NaggyMock| Warn[Print "Uninteresting mock function call" warning]
  Warn --> SilentReturn

  CheckStrictness -->|StrictMock| Fail[Test failure: uninteresting call detected]

  SilentReturn --> End
  Fail --> End
```

This diagram clarifies the decision path gMock takes when a mocked function is called.

---

## Summary
The Mock Strictness Control API provides essential tools to tailor the behavior of uninteresting mock calls, enhancing test robustness and developer experience. By understanding and applying `NiceMock`, `NaggyMock`, and `StrictMock`, you gain fine control over warnings and failures related to unexpected calls.

---

## Source Reference
<Source url="https://github.com/google/googletest" branch="main" path="include/gmock/gmock-nice-strict.h" range="1-190" />