---
title: "Built-in Matchers"
description: "Reference for the extensive library of built-in matchers including equality, inequality, container, floating point, and custom matchers. Covers matcher cascading, composition, and best practices."
---

# Built-in Matchers

This page provides a comprehensive reference to the extensive library of built-in matchers available in GoogleMock (gMock). These matchers enable you to precisely specify the expected arguments in mock method calls. The matchers cover equality, inequality, container, floating-point, string, pointer, member, composite, and custom conditions. You will also find guidance on composing matchers, cascading matchers, and best practices to help you write robust, readable, and maintainable tests.

---

## Matcher Basics

Matchers are predicates that test individual argument values in mock method calls or assertions. They are used inside `EXPECT_CALL()`, `ON_CALL()`, and assertions like `EXPECT_THAT()`. Built-in matchers simplify verifying complex argument conditions without writing verbose code.

- Use `_` as a wildcard matcher to accept any argument value.
- Use matchers like `Eq()`, `Ne()`, `Gt()`, `Lt()`, etc., to express precise value matches.
- Combine matchers with logical operators (`AllOf`, `AnyOf`, `Not`) to build complex conditions.
- Utilize container matchers to inspect STL containers, arrays, or associative containers.


---

## Wildcard Matchers

| Matcher          | Description                           |
|------------------|-------------------------------------|
| `_`              | Matches any value of the correct type. |
| `A<type>()`      | Matches any value of exactly the specified type. Alias: `An<type>()`. |

Example:

```cpp
EXPECT_CALL(mock, Foo(_));  // Accepts any argument
EXPECT_CALL(mock, Bar(A<int>()));  // Argument must be int
```

---

## Basic Comparison Matchers

| Matcher             | Meaning                         |
|---------------------|---------------------------------|
| `Eq(value)` or `value` | Argument equals `value` (`==`). |
| `Ne(value)`          | Argument not equal to `value`.   |
| `Ge(value)`          | Argument greater than or equal to `value`. |
| `Gt(value)`          | Argument greater than `value`.   |
| `Le(value)`          | Argument less than or equal to `value`. |
| `Lt(value)`          | Argument less than `value`.      |
| `Ref(variable)`      | Argument is a reference to the given variable. |
| `TypedEq<type>(value)` | Argument of type `type` equal to `value`. Useful with overloaded methods. |

Example:

```cpp
EXPECT_CALL(mock, DoSomething(Eq(5)));  // Argument == 5
EXPECT_CALL(mock, DoSomething(Ne(0)));  // Argument != 0
```

---

## Floating-Point Matchers

These matchers compare floating-point numbers with tolerance and handle NaN values appropriately.

| Matcher                      | Description                             |
|------------------------------|---------------------------------------|
| `DoubleEq(double)`           | Approximate equality for double.      |
| `FloatEq(float)`             | Approximate equality for float.       |
| `NanSensitiveDoubleEq(double)` | Approximate equality treating NaNs as equal. |
| `NanSensitiveFloatEq(float)`   | Approximate equality treating NaNs as equal. |
| `DoubleNear(double, max_err)` | Equality within absolute error for double. |
| `FloatNear(float, max_err)`   | Equality within absolute error for float. |
| `NanSensitiveDoubleNear(double, max_err)` | Near equality including NaNs.     |
| `NanSensitiveFloatNear(float, max_err)`    | Near equality including NaNs.     |
| `IsNan()`                   | Matches NaN values.                    |

Example:

```cpp
EXPECT_CALL(mock, Compute(DoubleEq(3.14159)));  // Approximate pi
EXPECT_CALL(mock, Compute(FloatNear(2.718f, 0.001f)));  // Approximate e
```

---

## String Matchers

Matchers for strings (C-style, `std::string`, wide strings available).

| Matcher           | Meaning                                                |
|-------------------|--------------------------------------------------------|
| `StrEq(string)`   | String equals (case sensitive).                        |
| `StrNe(string)`   | String not equal.                                       |
| `StrCaseEq(string)` | String equals ignoring case.                           |
| `StrCaseNe(string)` | String not equal ignoring case.                        |
| `HasSubstr(string)` | String contains substring.                            |
| `StartsWith(prefix)` | String starts with prefix.                            |
| `EndsWith(suffix)`  | String ends with suffix.                              |
| `ContainsRegex(regex)` | Regex matches substring.                             |
| `MatchesRegex(regex)`  | Entire string matches regex.                         |
| `WhenBase64Unescaped(matcher)` | Matches Base64 string after unescaping.         |

Example:

```cpp
EXPECT_THAT(name, StartsWith("John"));
EXPECT_THAT(email, HasSubstr("@example.com"));
EXPECT_THAT(output, MatchesRegex("^error:.*$");
```

---

## Exception Matchers

Matchers for verifying that callable arguments throw exceptions.

| Matcher                    | Description                                    |
|----------------------------|------------------------------------------------|
| `Throws<E>()`             | Callable throws exception type `E`.             |
| `Throws<E>(matcher)`      | Callable throws `E` matching `matcher`.          |
| `ThrowsMessage<E>(matcher)` | Callable throws `E` with message matching `matcher`. |

Example:

```cpp
EXPECT_THAT([] { throw std::runtime_error("fail"); }, Throws<std::runtime_error>());
EXPECT_THAT([] { throw std::runtime_error("fail"); }, ThrowsMessage<std::runtime_error>(HasSubstr("fail")));
```

---

## Container Matchers

Matchers for STL containers, native arrays, and similar collections.

| Matcher                                        | Description                                                     |
|------------------------------------------------|-----------------------------------------------------------------|
| `Contains(element_matcher)`                    | Container contains at least one element matching the matcher.    |
| `Contains(element_matcher).Times(n)`           | Contains elements matching matcher exactly `n` times.            |
| `Each(element_matcher)`                         | All elements match the matcher.                                  |
| `ElementsAre(e0, e1, ..., en)`                 | Container has exactly elements matching the matchers in order.  |
| `ElementsAreArray(container_or_array)`         | Same as `ElementsAre` but from a container or iterator range.    |
| `UnorderedElementsAre(e0, e1, ..., en)`        | Container has elements matching matchers, ignoring order.       |
| `UnorderedElementsAreArray(container_or_array)` | Same as `UnorderedElementsAre` but from a container or array.    |
| `IsEmpty()`                                    | Container or string is empty.                                    |
| `SizeIs(matcher)`                              | Container size matches matcher.                                 |
| `ContainerEq(container)`                        | Exact container equality with helpful mismatch info.             |
| `IsSubsetOf(container)`                         | Container is a subset of the given container in content.         |
| `IsSupersetOf(container)`                       | Container is a superset of the given container in content.       |
| `Pointwise(pair_matcher, container)`           | Elements and container elements match pairwise.                   |
| `UnorderedPointwise(pair_matcher, container)`  | Like `Pointwise` but order ignored.                              |

Example:

```cpp
EXPECT_CALL(mock, ProcessData(Contains(Eq(10)))); // container contains 10
EXPECT_CALL(mock, ProcessData(ElementsAre(1, _, 3))); // container has 3 elements
EXPECT_THAT(container, UnorderedElementsAre(3, 1, 2)); // container has 1,2,3 in any order
```

---

## Member Matchers

Matchers that inspect members or properties of objects.

| Matcher                                       | Description                                                 |
|-----------------------------------------------|-------------------------------------------------------------|
| `Field(&Class::field, matcher)`                | Matches if the member variable `field` matches `matcher`.   |
| `Field(name, &Class::field, matcher)`          | Same as above with name for better error messages.          |
| `Property(&Class::getter, matcher)`            | Matches if the property (getter method) matches `matcher`.  |
| `Property(name, &Class::getter, matcher)`      | Same as above with name for better error messages.          |
| `Key(matcher)`                                 | Matches the `first` field of a `std::pair` matches `matcher`|
| `Pair(first_matcher, second_matcher)`          | Matches a `std::pair` with given matchers on first and second fields. |

Example:

```cpp
EXPECT_CALL(mock, DoSomething(Field(&Foo::count, Ge(5))));
EXPECT_THAT(pair, Pair(Eq(1), HasSubstr("foo")));
EXPECT_THAT(obj, Property(&Foo::Name, StartsWith("John")));
```

---

## Matchers for Pointers and References

| Matcher                | Description                                            |
|------------------------|--------------------------------------------------------|
| `IsNull()`             | Matches any null raw or smart pointer.                  |
| `NotNull()`            | Matches a non-null pointer.                              |
| `Pointee(matcher)`     | Matches pointer that points to a value matching matcher. |
| `Pointer(matcher)`     | Matches pointer itself with matcher (matcher applies to the raw pointer). |
| `WhenDynamicCastTo<T>(matcher)` | Matches if dynamic_cast to T succeeds and the result matches matcher (requires RTTI). |
| `Ref(variable)`        | Matches any argument that is a reference to given variable. |

Example:

```cpp
EXPECT_CALL(mock, Func(IsNull()));  // Argument is nullptr
EXPECT_CALL(mock, Func(Pointee(Eq(10))));  // Pointer points to 10
EXPECT_THAT(ptr, NotNull());
EXPECT_THAT(base_ptr, WhenDynamicCastTo<Derived*>(Pointee(_)));
```

---

## Composite Matchers

Use these to combine or modify matchers.

| Matcher                                 | Description                                         |
|-----------------------------------------|-----------------------------------------------------|
| `Not(matcher)`                         | Matches values that do NOT match the matcher.      |
| `AllOf(m1, m2, ..., mn)`                | Matches values matching ALL of the given matchers. |
| `AnyOf(m1, m2, ..., mn)`                | Matches values matching ANY of the given matchers. |
| `Conditional(cond, m1, m2)`            | Matches if `cond` is true matches `m1`, else `m2`. |
| `Truly(predicate)`                      | Matches if predicate returns true on the value.    |
| `Matches(matcher)`                      | Returns a predicate functor for use in algorithms.
|
Example:

```cpp
EXPECT_CALL(mock, Foo(AllOf(Ge(5), Lt(10))));  // Value between 5 and 10
EXPECT_CALL(mock, Bar(Not(Eq(0))));
EXPECT_THAT(value, AnyOf(Lt(0), Gt(100)));
```

---

## Multi-Argument Matchers

Allows matching a group of arguments together as a single tuple.

| Matcher                      | Description                                                       |
|------------------------------|-------------------------------------------------------------------|
| `With(matcher)`              | Restricts expectation to calls for which the full arguments tuple matches the matcher. |
| `AllArgs(matcher)`           | Equivalent to `matcher`. Useful for readability.                  |
| `Args<N1,...,Nk>(matcher)`   | Matches the subset of arguments at the specified indices.
|
Example:

```cpp
EXPECT_CALL(mock, Func(_, _)).With(AllArgs(Lt()));  // First < Second
EXPECT_CALL(mock, Func(_, _, _)).With(Args<0,2>(Gt()));  // Argument0 > Argument2
```

---

## Using Matchers in Assertions

Matchers can be used in assertions to verify arbitrary values:

```cpp
EXPECT_THAT(actual_value, matcher);
ASSERT_THAT(actual_value, matcher);
```

These provide expressive tests with good failure messages.

---

## Tips and Best Practices

- Use `_` to accept any argument when the exact value isn’t important.
- Use `Eq()` explicitly when needed to avoid confusion with implicit conversions.
- Use container matchers (`ElementsAre`, `Contains`) instead of writing manual loops/checks.
- Compose matchers with `AllOf` and `AnyOf` to clearly express complex conditions.
- When testing strings, prefer `StrEq` or `HasSubstr` rather than manual comparisons.
- For floating-point, prefer `DoubleEq`, `FloatNear` with tolerances over `Eq`.
- Avoid over-specification by only matching arguments you care about.
- Use `RetiresOnSaturation()` in `EXPECT_CALL` to prevent expectations from being sticky if that fits your scenario.
- When mocking overloaded methods, disambiguate overloads with `TypedEq` or `Const()`.

---

## Examples

### Matching a value greater than 10 and not equal to 15:

```cpp
EXPECT_CALL(mock, Func(AllOf(Gt(10), Ne(15))));
```

### Expecting a container with exactly 3 specific elements (in order):

```cpp
EXPECT_CALL(mock, ProcessData(ElementsAre(1, _, 3)));
```

### Expecting a string argument starting with "Error":

```cpp
EXPECT_CALL(mock, Log(StartsWith("Error")));
```

### Matching a pointer argument that points to value 5:

```cpp
EXPECT_CALL(mock, Write(Pointee(5)));
```

### Expecting a std::pair where key matches and value has substring "foo":

```cpp
EXPECT_THAT(pair, Pair(Ge(10), HasSubstr("foo")));
```

### Matching a call whose second and third argument satisfy a condition:

```cpp
EXPECT_CALL(mock, Func(_, _, _)).With(Args<1, 2>(Lt()));
```

---

For an full list of matchers and detailed usage, see the [Matchers Reference](reference/matchers.md).

---

## Additional Resources

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#NewMatchers) for advanced custom matching
- [Built-in Matchers Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html#MatcherList)
- Guides on Mocking Best Practices and Writing Custom Matchers

---

<Info>
This page focuses exclusively on built-in argument matchers used for specifying expected method call arguments in GoogleMock. For related information on mock class definitions or setting expectations, see the corresponding API reference pages.
</Info>
