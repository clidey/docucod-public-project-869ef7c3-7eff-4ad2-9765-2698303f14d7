---
title: "Matchers for Arguments and Outcomes"
description: "Provides an exhaustive list of built-in matchers, with syntax, parameters, and example usage. Covers extending matchers and composing complex test conditions with readable code."
---

# Matchers for Arguments and Outcomes

This page provides an exhaustive list of built-in matchers in GoogleMock, explaining their syntax, parameters, and usage examples. It also covers how to compose complex matchers and extend existing ones for expressive and readable test assertions.

---

## Introduction to Matchers

Matchers are predicates that specify constraints on arguments or expected outcomes in mock function calls or assertions. They form the basis of expressive test specifications in GoogleMock and GoogleTest.

### What is a Matcher?

A matcher checks whether a value satisfies a condition. For example:

- `Eq(value)` matches an argument exactly equal to `value`.
- `Ge(5)` matches an argument greater than or equal to 5.
- `_` is the wildcard matcher that accepts any value.

Matchers are used inside `EXPECT_CALL` and `ON_CALL` in mock expectations, as well as in assertions like `EXPECT_THAT`.

---

## Basic Matchers

### Wildcard Matcher: `_`

Matches any value of any type.

```cpp
EXPECT_CALL(mock_obj, Method(_));  // Accepts any argument.
```

### Equality Matcher: `Eq(expected)`

Matches arguments equal to `expected` using `operator==`.

```cpp
EXPECT_CALL(mock_obj, Method(Eq(42)));
```

### Inequality Matcher: `Ne(value)`

Matches arguments not equal to `value`.

### Relational Matchers

- `Lt(value)`: less than
- `Le(value)`: less or equal
- `Gt(value)`: greater than
- `Ge(value)`: greater or equal

Example:

```cpp
EXPECT_CALL(mock_obj, Method(Ge(10)));
```

### Logical Matchers

- `Not(matcher)`: negates the matcher
- `AllOf(m1, m2, ...)`: matches if all sub-matchers match
- `AnyOf(m1, m2, ...)`: matches if any sub-matcher matches

Example:

```cpp
EXPECT_CALL(mock_obj, Method(AllOf(Ge(5), Le(10))));
```

---

## Working with Containers

### `Contains(element_matcher)`

Matches if the container contains at least one element matching the given matcher.

```cpp
EXPECT_THAT(my_vector, Contains(5));
EXPECT_THAT(my_set, Contains(Ge(10)));
```

### `ElementsAre(e1, e2, ..., en)`

Matches containers whose elements exactly match the given sequence.

```cpp
EXPECT_THAT(my_vector, ElementsAre(1, 2, 3));
```

### `UnorderedElementsAre(e1, e2, ..., en)`

Matches containers with exactly the elements, but order does not matter.

### `Each(matcher)`

Matches containers where every element matches the given matcher.

```cpp
EXPECT_THAT(my_vector, Each(Ge(0)));  // All elements >= 0
```

### `SizeIs(matcher)`

Matches containers whose size matches the given matcher.

```cpp
EXPECT_THAT(my_vector, SizeIs(Ge(3)));
```

---

## String Matchers

### Equality and Case-Insensitive

- `StrEq(string)`: exact string match
- `StrNe(string)`: string mismatch
- `StrCaseEq(string)`: case-insensitive equality
- `StrCaseNe(string)`: case-insensitive inequality

### Substring Matching

- `HasSubstr(substring)`: string contains substring
- `StartsWith(prefix)`: string starts with prefix
- `EndsWith(suffix)`: string ends with suffix

Example:

```cpp
EXPECT_THAT(my_string, StartsWith("Hello"));
```

---

## Pointer and Reference Matchers

### `IsNull()` / `NotNull()`

Match null or non-null pointers (raw or smart).

### `Pointee(matcher)`

Matches pointers whose value pointed to matches the inner matcher.

```cpp
EXPECT_CALL(mock_obj, Method(Pointee(Eq(5))));
```

### `Ref(variable)`

Matches any argument that is a reference to `variable`.

### `Address(matcher)`

Matches objects whose address matches the inner matcher.

---

## Tuple and Pair Matchers

### `Pair(matcher_for_first, matcher_for_second)`

Matches pairs according to matchers for both elements.

### `Args<k1, ..., kn>(matcher)`

Matches tuple elements at positions k1 to kn against `matcher`.

### Multi-Argument Matcher with `.With(matcher)` Clause

Inside `EXPECT_CALL` or `ON_CALL`, `.With(matcher)` can specify a matcher that checks all arguments as a tuple.

Example:

```cpp
EXPECT_CALL(mock_obj, Func(_, _))
    .With(Lt());  // first arg less than second
```

---

## Custom Matchers

You can define simple custom matchers with the `MATCHER` macro:

```cpp
MATCHER(IsEven, "checks if number is even") {
  return (arg % 2) == 0;
}
```

Use as:

```cpp
EXPECT_CALL(mock_obj, Func(IsEven()));
EXPECT_THAT(value, IsEven());
```

You can define parameterized custom matchers with `MATCHER_P` (and `_P2`, `_P3`, etc):

```cpp
MATCHER_P(IsDivisibleBy, divisor, "divisible by") {
  return (arg % divisor) == 0;
}
```

---

## Composing Matchers

Matchers support composition to create complex, readable conditions:

```cpp
EXPECT_CALL(mock_obj, Func(AllOf(Gt(10), Lt(20))));
EXPECT_THAT(container, Each(Not(Eq(0))));
```

---

## Tips and Best Practices

- Use `_` wildcard matcher when argument values are not important.
- Prefer `ON_CALL` to set default behavior without enforcing call expectations.
- Set `EXPECT_CALL` only for calls you want to verify.
- Use `RetiresOnSaturation()` to make sequential `WillOnce()` expectations manageable.
- Use `InSequence` or `After` to enforce call ordering when needed.
- Use container matchers (`Contains`, `ElementsAre`) for flexible validation of collections.
- When mocking overloaded methods, specify argument list explicitly to help the compiler.
- Write custom matchers to encapsulate complex checks and improve error messages.

---

## Example Usage

```cpp
#include <gmock/gmock.h>
using ::testing::_;
using ::testing::Return;
using ::testing::Ge;
using ::testing::ElementsAre;

class MockFoo {
 public:
  MOCK_METHOD(int, GetSize, (), (const));
  MOCK_METHOD(void, Process, (int a, const std::string& s));
};

TEST(ExampleTest, Usage) {
  MockFoo mock;

  // Default action (returns 10 when GetSize is called).
  ON_CALL(mock, GetSize()).WillByDefault(Return(10));

  // Expect Process to be called with first arg >= 100 and any string
  EXPECT_CALL(mock, Process(Ge(100), _));

  // Exercise calls
  EXPECT_EQ(10, mock.GetSize());  // returns 10
  mock.Process(150, "test");    // matches expectation
}
```

---

## Related Matchers and Features

- **Matchers in Assertions:** Use with `EXPECT_THAT(value, matcher)` for expressive assertion.
- **Actions:** Combine with matchers to specify mock behavior.
- **Cardinalities:** Control expected call counts in `EXPECT_CALL`.
- **Advanced Matching:** Compose with `With()`, `Args<>`, and complex predicates.
- **Custom Actions and Matchers:** Extend gMock to suit application needs.

---

## References and Further Reading

- [Matchers Reference](reference/matchers.md): Comprehensive list and details.
- [gMock Cookbook](docs/gmock_cook_book.md): Recipes for effective mocking.
- [Setting Expectations and Actions](reference/mocking-apis/mock-expectations-actions.md)
- [Assertions Reference](reference/assertions.md)
- [Using Matchers in GoogleTest Assertions](reference/assertions.md#EXPECT_THAT)

---

This page equips users with the knowledge to use Google's C++ mocking matchers robustly and skillfully, enabling thorough and maintainable tests.


