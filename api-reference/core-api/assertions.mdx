---
title: "Assertions and Expectations"
description: "Provides a reference to all core assertion macros and methods, such as equality, exception, and floating point checks. Explains distinction between fatal and non-fatal assertions, and demonstrates usage with concise code examples."
---

# Assertions and Expectations

This reference documentation provides a comprehensive guide to the core assertion macros and methods available in GoogleTest, covering various types such as equality checks, exception assertions, and floating point comparisons. It also clarifies the distinction between fatal and non-fatal assertions, empowering you to write robust tests that align exactly with your verification goals. With concise examples and clear explanations, you'll master how to leverage assertions to express your test intent precisely.

---

## Understanding Assertions in GoogleTest

Assertions are fundamental constructs that verify conditions within your test code. GoogleTest offers a rich array of assertion macros that you can use to verify different aspects of your code behavior. These macros come in pairs:

- `EXPECT_` macros generate **nonfatal failures**. When they fail, the current test function continues executing.
- `ASSERT_` macros generate **fatal failures**. When they fail, the current test function returns immediately.

This design lets you control test flow depending on the severity of the check.

All assertion macros support streaming additional failure messages using the `<<` operator to provide clearer diagnostics when your test fails.

```cpp
EXPECT_TRUE(my_condition) << "Condition was expected to be true.";
```

---

## Types of Assertions

### 1. Success, Failure, and Explicit Non-Test Checks

- **SUCCEED()**: Generates explicit success; useful for documenting that a code path has been reached. It does *not* cause the overall test to pass or fail by itself.

- **FAIL()**: Generates a fatal failure, returning from the current function. Only usable in functions returning `void`.

- **ADD_FAILURE()**: Generates a nonfatal failure, allowing the current function to continue.

- **ADD_FAILURE_AT(file, line)**: Generates a nonfatal failure reported at a specific file and line number.


### 2. Boolean Conditions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`: Verifies that the condition is `true`.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`: Verifies that the condition is `false`.

Example:
```cpp
EXPECT_TRUE(IsValid(input));
ASSERT_FALSE(HasErrors(report));
```

### 3. Binary Comparisons

Verify that two values relate in expected ways using comparison assertions:

| Macro          | Meaning                      |
|----------------|------------------------------|
| `EXPECT_EQ`/`ASSERT_EQ` | Checks that two values are equal (`==`).
| `EXPECT_NE`/`ASSERT_NE` | Checks that two values are not equal (`!=`).
| `EXPECT_LT`/`ASSERT_LT` | Checks if first value is less than second (`<`).
| `EXPECT_LE`/`ASSERT_LE` | Checks if first value is less than or equal (`<=`).
| `EXPECT_GT`/`ASSERT_GT` | Checks if first value is greater than second (`>`).
| `EXPECT_GE`/`ASSERT_GE` | Checks if first value is greater than or equal (`>=`).

**Important:** When comparing pointers, these assertions check pointer equality, *not* pointed-to value equality (for C-strings, use string comparison macros).

Example:
```cpp
EXPECT_EQ(expected_value, actual_value);
ASSERT_LT(min_limit, computed);
```

### 4. String Comparisons

For comparing **C strings** (`const char*` or `wchar_t*`), GoogleTest provides:

| Macro                   | Purpose                                     |
|-------------------------|---------------------------------------------|
| `EXPECT_STREQ`/`ASSERT_STREQ` | Checks two C strings have the same contents.
| `EXPECT_STRNE`/`ASSERT_STRNE` | Checks two C strings have different contents.
| `EXPECT_STRCASEEQ`/`ASSERT_STRCASEEQ` | Checks two C strings match ignoring case.
| `EXPECT_STRCASENE`/`ASSERT_STRCASENE` | Checks two C strings differ ignoring case.

Example:
```cpp
EXPECT_STREQ("hello", output.c_str());
ASSERT_STRNE("error", message);
```

### 5. Floating-Point Comparisons

Comparing floating-point numbers requires careful handling due to rounding and representation errors. GoogleTest provides specialized assertions:

| Macro                   | Description                               |
|-------------------------|-------------------------------------------|
| `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ` | Checks two `float` values are approximately equal within 4 ULPs.
| `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ` | Checks two `double` values are approximately equal within 4 ULPs.
| `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` | Checks absolute difference between values does not exceed `abs_error`.

Example:
```cpp
EXPECT_FLOAT_EQ(calculated, expected);
ASSERT_NEAR(measured, target, 0.001);
```

### 6. Exception Assertions

These verify whether specific exceptions are thrown or not during execution. They depend on exceptions enabled in your build.

- `EXPECT_THROW(statement, ExceptionType)` / `ASSERT_THROW`: Verifies that `statement` throws an exception of `ExceptionType`.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW`: Verifies that `statement` throws any exception.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW`: Verifies that `statement` does not throw any exception.

Example:
```cpp
EXPECT_THROW(MyFunction(), std::runtime_error);
EXPECT_NO_THROW(CleanUp());
```

You can test compound statements using braces:
```cpp
EXPECT_NO_THROW({ Initialize(); Process(); });
```

### 7. Predicate Assertions

Enables verifying custom predicates with better diagnostic output than raw boolean checks.

- `EXPECT_PRED1`, `EXPECT_PRED2`, ..., `EXPECT_PRED5`: Assert a predicate-like function returning `bool` returns true for given parameters.
- Similarly, `EXPECT_PRED_FORMAT*` allows predicates that produce detailed failure messages.

Example:
```cpp
bool IsPrime(int n) { ... }
EXPECT_PRED1(IsPrime, 7);
```

### 8. Windows HRESULT Assertions

Specifically designed for `HRESULT` values on Windows:

- `EXPECT_HRESULT_SUCCEEDED(expr)` / `ASSERT_HRESULT_SUCCEEDED`: Checks `expr` is a success `HRESULT`.
- `EXPECT_HRESULT_FAILED(expr)` / `ASSERT_HRESULT_FAILED`: Checks `expr` is a failure `HRESULT`.

### 9. Death Assertions

Verify that a code statement causes program termination with expected error output or exit code. Useful for testing fatal conditions.

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH`: Verifies `statement` causes abnormal termination and output matching `matcher`.
- Variants like `EXPECT_DEATH_IF_SUPPORTED`, `EXPECT_DEBUG_DEATH`, and `EXPECT_EXIT` provide more control based on platform and conditions.

Example:
```cpp
EXPECT_DEATH(FailFunction(), "Fatal error message");
```


---

## Fatal vs Non-fatal Assertion Use Cases

Use `ASSERT_` macros when a failure should abort the current test immediately because subsequent code depends on a condition being true.
Use `EXPECT_` macros when you want the test to continue after failure to accumulate more assertion results.

```cpp
TEST(MyTest, FatalExample) {
  ASSERT_NE(ptr, nullptr);  // Stops if ptr is null.
  ptr->DoSomething();     // Safe as ptr is guaranteed non-null.
}

TEST(MyTest, NonFatalExample) {
  EXPECT_EQ(val, expected);
  EXPECT_EQ(other_val, other_expected);
  // Both checked even if the first fails.
}
```

---

## Using Matchers for Flexible Assertions

GoogleTest supports rich matchers used in `EXPECT_THAT` and `ASSERT_THAT` macros, allowing highly readable expressive assertions beyond strict equality.

Example:

```cpp
EXPECT_THAT(value, StartsWith("Hello"));
EXPECT_THAT(numbers, ElementsAre(1, 2, 3));
EXPECT_THAT(str, MatchesRegex("\d{3}-\d{4}"));
```

Match expressive conditions, combine them logically, and provide granular diagnostics.

More details on matchers are in the [Matchers Reference](../matchers-api/builtin-matchers).

---

## Best Practices and Recommendations

- Use fatal assertions (`ASSERT_`) to guard critical conditions affecting subsequent code.
- Use nonfatal assertions (`EXPECT_`) when independent checks make sense.
- Use descriptive failure messages with streaming to clarify intent and aid debugging.
- Prefer matchers and `EXPECT_THAT` for readable, flexible assertions.
- Avoid over-constraining with overly specific matchers or cardinalities that cause brittle tests.

---

## Assertion Code Examples

### Basic Equality Check

```cpp
TEST(FactorialTest, ComputesCorrectFactorials) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  ASSERT_EQ(Factorial(3), 6) << "Factorial of 3 should be 6.";
}
```

### Floating Point Approximate Comparison

```cpp
TEST(MathTest, FloatingPointNearCheck) {
  double result = CalculatePiApproximation();
  EXPECT_NEAR(result, 3.14159, 0.0001);
}
```

### Exception Checking

```cpp
TEST(FileTest, ThrowsOnInvalidFile) {
  EXPECT_THROW(OpenFile("nonexistent.txt"), std::runtime_error);
}
```

### Predicate Usage

```cpp
bool IsOdd(int n) { return n % 2 == 1; }

TEST(NumTest, ChecksOddness) {
  EXPECT_PRED1(IsOdd, 3);
  EXPECT_PRED1(IsOdd, 4);  // This will fail
}
```

### Death Assertion

```cpp
TEST(DeathTest, CrashOnInvalidInput) {
  EXPECT_DEATH(ProcessInput(nullptr), "Null pointer detected");
}
```

---

## Troubleshooting and Common Pitfalls

- **Using `EXPECT_EQ` on C strings compares addresses, not string content.** Use `EXPECT_STREQ` to compare string contents.
- **Floating point comparisons should not use `EXPECT_EQ`.** Use `EXPECT_NEAR` or `EXPECT_FLOAT_EQ`/`EXPECT_DOUBLE_EQ` instead.
- **Make sure exceptions are enabled in your build for exception assertions.**
- **Use `ASSERT_` assertions to guard against null pointers before dereferencing.**
- **Avoid side effects in assertions — arguments are evaluated once but order is undefined.**
- **Death assertions may not work properly if test environment or OS limits support.**

---

For a deeper understanding of assertions, including best practices and advanced scenarios, see the [Assertions Best Practices Guide](../guides/core-test-workflows/assertions-best-practices).

---

## Related Documentation

- [Matchers Reference](../api-reference/matchers-api/builtin-matchers) — Learn more about flexible matching strategies.
- [Writing and Running Your First Test](../getting-started/configuration-and-first-use/writing-first-test) — For beginner test-writing workflows.
- [GoogleMock Basics](../getting-started/configuration-and-first-use/using-googlemock-basics) — Using mocks with assertions.
- [Assertions Best Practices Guide](../guides/core-test-workflows/assertions-best-practices) — How to write effective assertions.

