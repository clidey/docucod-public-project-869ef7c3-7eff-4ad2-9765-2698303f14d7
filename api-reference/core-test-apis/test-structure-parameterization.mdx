---
title: "Test Case Structure and Parameterization"
description: "Documentation of how to define test cases, suites, fixtures, and parameterized/value-typed tests in GoogleTest. Details macros and APIs that support reusable and scalable test authoring for various input values and data types."
---

# Test Case Structure and Parameterization in GoogleTest

GoogleTest provides a powerful and flexible framework for defining and organizing tests that can scale across different input parameters and data types. This documentation focuses specifically on how to author test cases, suites, and fixtures, emphasizing the mechanisms for parameterizing tests both by value and by type. These features enable you to write reusable, scalable, and maintainable test logic that systematically covers a broad spectrum of test data.

---

## Overview

At its core, GoogleTest supports three main patterns for test case structuring:

- **Basic Tests**: Individual tests implemented with the `TEST()` macro.
- **Fixture-Based Tests**: Groupings of related tests sharing common setup/teardown using `TEST_F()` and `Test`-derived classes.
- **Parameterized Tests**: Tests whose behavior is executed repeatedly with distinct input parameter sets or types, ensuring comprehensive coverage without redundant code.

This page zooms in on parameterized tests, describing how to define test fixtures and suites that accept parameters (both values and types), and how to instantiate and run tests over those parameters. It covers APIs and macros that support reusable and scalable test authoring for various input values and data types.

---

## Value-Parameterized Tests

Value-parameterized tests allow you to run the same test logic with multiple distinct values as inputs. This is useful for verifying that your code behaves correctly across various inputs without writing repetitive test code.

### Defining a Value-Parameterized Test

1. **Define the Test Fixture**

Create a test fixture class inheriting from `::testing::TestWithParam<T>`, where `T` is the type of the input parameter. This fixture can contain setup and teardown logic common to all parameterized runs.

```cpp
class MyValueParamTest : public ::testing::TestWithParam<int> {
  // Optional setup/teardown and helper methods.
};
```

2. **Define Parameterized Test Cases**

Use `TEST_P` instead of `TEST` to declare test cases that use the parameterized fixture:

```cpp
TEST_P(MyValueParamTest, HandlesValuesCorrectly) {
  int param = GetParam();  // Access the current test parameter
  EXPECT_TRUE(FunctionUnderTest(param));
}
```

3. **Instantiate the Test Suite**

Use `INSTANTIATE_TEST_SUITE_P` to provide the set of parameters for the test suite. GoogleTest offers many parameter generators such as `Values()`, `ValuesIn()`, `Range()`, `Bool()`, and `Combine()` to produce test inputs.

```cpp
INSTANTIATE_TEST_SUITE_P(PositiveTests, MyValueParamTest, ::testing::Values(1, 2, 5));
```

Each generated parameter instantiates the test case separately. The tests are named for easy filtering and identification, e.g., `PositiveTests/MyValueParamTest.HandlesValuesCorrectly/0`.

### Advanced Parameter Generators

- **Range(start, end[, step])**: Generates a sequence of values from `start` up to but not including `end` with optional `step`.
- **ValuesIn(container or iterator pair)**: Uses values from existing containers or ranges.
- **Bool()**: Generates `{false, true}` for boolean flags.
- **Combine(...)**: Generates Cartesian product tuples from multiple generators for multi-parameter tests.
- **ConvertGenerator**: Wraps generators when your parameter types are explicitly convertible or require custom conversions.

### Tips and Best Practices

- Ensure your fixture's `SetUpTestSuite()` and `TearDownTestSuite()`—used for shared resources—are declared `public`, especially when used with `TEST_P`.
- Use custom name generators as the optional fourth parameter to `INSTANTIATE_TEST_SUITE_P` to produce meaningful test names instead of default indices.
- Make sure parameters are copyable types or manage their lifetimes appropriately if using pointers.

### Example

```cpp
class FooTest : public ::testing::TestWithParam<const char*> {};

TEST_P(FooTest, StringLengthIsNonZero) {
  const char* input = GetParam();
  ASSERT_NE(strlen(input), 0u);
}

INSTANTIATE_TEST_SUITE_P(ExampleInstantiation, FooTest, ::testing::Values("cat", "dog", "bird"));
```

---

## Typed Tests

To verify that different types conform to expected behavior, GoogleTest introduces **typed tests**, which run the same test logic for a list of known types.

### Defining Typed Tests

1. **Define a Template Test Fixture**

Derive a fixture class template from `testing::Test`, parameterized by a type:

```cpp
template <typename T>
class TypedTestFixture : public testing::Test {
 public:
  T value_;
  // Setup common to all types.
};
```

2. **Associate a List of Types**

Create a type list using `::testing::Types<>` and associate it with your fixture via `TYPED_TEST_SUITE`:

```cpp
using MyTypes = ::testing::Types<char, int, std::string>;
TYPED_TEST_SUITE(TypedTestFixture, MyTypes);
```

3. **Define Typed Tests**

Use `TYPED_TEST` to define tests that apply to each type:

```cpp
TYPED_TEST(TypedTestFixture, InitializesCorrectly) {
  TypeParam val = this->value_;
  // Perform checks on val
}
```

Note the use of `TypeParam` as the type parameter currently being tested.

### Customizing Test Names

You can supply an optional third argument to `TYPED_TEST_SUITE` to provide custom type-name suffixes for generated test names by implementing a `NameGenerator` class with a static `GetName(int)` method.

### Example

```cpp
template <typename T>
class MyTypedTest : public testing::Test {
 public:
  T value_;
};

using MyTypes = ::testing::Types<int, double>;

TYPED_TEST_SUITE(MyTypedTest, MyTypes);

TYPED_TEST(MyTypedTest, IsDefaultConstructible) {
  TypeParam val{};
  EXPECT_TRUE(true);  // Replace with meaningful tests
}
```

---

## Type-Parameterized Tests

Type-Parameterized tests are like typed tests but where the list of types is unknown at test definition time and can be instantiated in multiple translation units. This is ideal for verifying interface conformance or similar scenarios where multiple components can instantiate the same set of type-parameterized test patterns.

### Defining Type-Parameterized Tests

1. **Define a Template Fixture Class**

Just like typed tests, define a fixture template:

```cpp
template <typename T>
class MyTypeParamTest : public testing::Test {
  // Fixture code.
};
```

2. **Declare the Test Suite as Parameterized**

Use the `TYPED_TEST_SUITE_P` macro:

```cpp
TYPED_TEST_SUITE_P(MyTypeParamTest);
```

3. **Define Type-Parameterized Tests**

Use `TYPED_TEST_P` similar to typed tests but for the parameterized suite:

```cpp
TYPED_TEST_P(MyTypeParamTest, TestA) {
  TypeParam val{};
  // Test logic
}

TYPED_TEST_P(MyTypeParamTest, TestB) {
  // More tests
}
```

4. **Register the Test Names**

Before instantiation, register the tests:

```cpp
REGISTER_TYPED_TEST_SUITE_P(MyTypeParamTest, TestA, TestB);
```

5. **Instantiate the Test Suite**

In one or more translation units, instantiate the suite with actual types:

```cpp
using MyTypes = ::testing::Types<int, float>;
INSTANTIATE_TYPED_TEST_SUITE_P(MyInstance, MyTypeParamTest, MyTypes);
```

This pattern supports extensible and reusable type-parameterized test definitions across translation units.

---

## Test Fixtures

Fixtures are classes used to hold common setup, teardown, and utilities. They increase code reuse and test clarity.

- Value-parameterized fixtures must derive from `testing::TestWithParam<T>`, which itself derives from `testing::Test`.
- Typed and type-parameterized fixtures are class templates deriving from `testing::Test`.

Fixtures can implement `SetUp()` and `TearDown()` for per-test setup and teardown, and `SetUpTestSuite()`, `TearDownTestSuite()` for suite-wide preparation.

---

## Parameter Access

Within value-parameterized tests (using `TEST_P`), the test parameter is accessed via the member function:

```cpp
const ParamType& GetParam() const;
```

In typed and type-parameterized tests (using `TYPED_TEST` or `TYPED_TEST_P`), you refer to the test type with the special name `TypeParam` within the test method body.

---

## Best Practices & Common Pitfalls

<AccordionGroup title="Best Practices and Common Pitfalls">
<Accordion title="Declaring Test Fixtures">
Always derive fixtures for value-parameterized tests from `TestWithParam<T>`. For typed tests, define template fixtures on type parameter.
</Accordion>
<Accordion title="Use of Parameter Generators">
Choose built-in generators (`Values`, `ValuesIn`, `Range`, `Bool`, `Combine`) thoughtfully to keep tests clear and maintainable. Avoid overly large parameter sets causing slow test runs.
</Accordion>
<Accordion title="Custom Test Naming">
Use the optional `name_generator` in `INSTANTIATE_TEST_SUITE_P` and third parameter in `TYPED_TEST_SUITE` for more readable test instance names.
</Accordion>
<Accordion title="Avoiding Dangling References in Conversions">
When using `ConvertGenerator` with lambdas, ensure the converted types do not hold dangling references (e.g., avoid returning `std::string_view` from lambda holding reference to `std::string` in `Values`).
</Accordion>
<Accordion title="Shared Resources in Fixtures">
Use `SetUpTestSuite()` and `TearDownTestSuite()` for expensive shared setup/teardown ensuring they are `public` for parameterized tests.
</Accordion>
<Accordion title="Multiple Instantiations Across Translation Units">
Use abstract value-parameterized or type-parameterized tests to separate test definitions and instantiations, supporting multiple translation units.
</Accordion>
</AccordionGroup>

---

## Illustrative Examples

### Value-Parameterized Test

```cpp
class FactorialTest : public ::testing::TestWithParam<int> {};

TEST_P(FactorialTest, HandlesVariousInputs) {
  int n = GetParam();
  EXPECT_GT(Factorial(n), 0);
}

INSTANTIATE_TEST_SUITE_P(ValidInputs, FactorialTest, ::testing::Values(1, 2, 3, 8));
```

### Typed Test

```cpp
template <typename T>
class NumericLimitsTest : public ::testing::Test {
 public:
  T invalidValue = T{};
};

using TestedTypes = ::testing::Types<int, float, double>;
TYPED_TEST_SUITE(NumericLimitsTest, TestedTypes);

TYPED_TEST(NumericLimitsTest, DefaultValueIsZero) {
  EXPECT_EQ(TypeParam{}, this->invalidValue);
}
```

### Type-Parameterized Test

```cpp
template <typename T>
class ContainerTest : public ::testing::Test {
  // ...
};

TYPED_TEST_SUITE_P(ContainerTest);

TYPED_TEST_P(ContainerTest, IsEmptyInitially) {
  TypeParam container;
  EXPECT_TRUE(container.empty());
}

REGISTER_TYPED_TEST_SUITE_P(ContainerTest, IsEmptyInitially);

using MyContainers = ::testing::Types<std::vector<int>, std::list<int>>;
INSTANTIATE_TYPED_TEST_SUITE_P(VectorAndList, ContainerTest, MyContainers);
```

---

## Troubleshooting

- **Test Names Not Appearing as Expected:** Confirm that you provide a valid `name_generator` if you want custom test names for parameter instances.
- **Parameters Not Applied:** Check that fixture inherits correctly from `TestWithParam<T>`, and that `INSTANTIATE_TEST_SUITE_P` is called with the correct fixture.
- **Dangling References in Converted Types:** Use `ConvertGenerator` with care, ensuring lambdas/lists do not create references to temporary or out-of-scope objects.
- **Tests Not Running or Linking:** For abstract parameterized test patterns, verify your instantiations appear in the build and are linked.
- **Slow Test Execution:** Limit the number of parameters or combinations especially when using `Combine` with many generators.

---

## References and Further Reading

- [GoogleTest Primer: Value-Parameterized Tests](https://github.com/google/googletest/blob/main/docs/primer.md#value-parameterized-tests)
- [Typed Tests and Type-Parameterized Tests](https://github.com/google/googletest/blob/main/docs/advanced.md#typed-tests)
- [API Reference: `testing::TestWithParam`](https://github.com/google/googletest/blob/main/include/gtest/gtest-param-test.h)
- [Parameterized Test Generators: `Values`, `Range`, `Combine`](https://github.com/google/googletest/blob/main/include/gtest/gtest-param-test.h)
- [GoogleTest Advanced Guide](https://github.com/google/googletest/blob/main/docs/advanced.md)

---

## Source Files Related to Parameterized and Typed Tests

- [googletest/include/gtest/gtest-param-test.h](https://github.com/google/googletest/blob/main/googletest/include/gtest/gtest-param-test.h): Defines macros and generators for value-parameterized tests.
- [googletest/include/gtest/gtest-typed-test.h](https://github.com/google/googletest/blob/main/googletest/include/gtest/gtest-typed-test.h): Implements typed and type-parameterized tests supporting testing over type lists.
- [googletest/test/googletest-param-test-test.cc](https://github.com/google/googletest/blob/main/googletest/test/googletest-param-test-test.cc): Internal tests verifying parameter generators and test instantiation correctness.

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googletest/include/gtest/gtest-param-test.h", "range": "1-243"},{"path": "googletest/include/gtest/gtest-typed-test.h", "range": "1-271"},{"path": "googletest/test/googletest-param-test-test.cc", "range": "1-430"}]} />
