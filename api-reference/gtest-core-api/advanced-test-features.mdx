---
title: "Advanced Test Features"
description: "Outlines support for advanced workflows including parameterized and type-parameterized tests, test discovery options, and controlling execution order. Explores test environment customization, parallel execution, and special tools like death tests."
---

# Advanced Test Features

Explore advanced capabilities in GoogleTest that empower you to create expressive, flexible, and efficient test workflows. This page details support for parameterized and type-parameterized tests, tunable test discovery and execution order, environment customization, parallel test running, and specialized tools like death tests.

---

## Parameterized and Type-Parameterized Tests

GoogleTest helps you avoid redundant code and promote test reuse by supporting parameterized tests, where the same test logic runs with different inputs or types.

### Value-Parameterized Tests

These allow a single test to run multiple times with distinct input values. Define a test fixture class and use `TEST_P` to write parameterized tests:

```cpp
class MyTest : public testing::TestWithParam<int> {};

TEST_P(MyTest, IsEven) {
  int n = GetParam();
  EXPECT_EQ(n % 2, 0);
}

INSTANTIATE_TEST_SUITE_P(EvenNumbers, MyTest, testing::Values(2, 4, 6));
```

*Run the same test body with parameters 2, 4, and 6.*


### Type-Parameterized Tests

Analogous to value-parameterized tests but iterate over types. Typically used to validate generic code against multiple type instantiations.

```cpp
template <typename T> class TypedTestExample : public testing::Test {};

using MyTypes = testing::Types<int, double, std::string>;

TYPED_TEST_SUITE(TypedTestExample, MyTypes);

TYPED_TEST(TypedTestExample, CanDefaultConstruct) {
  TypeParam obj;
  ...
}
```

This runs `CanDefaultConstruct` for each type in `MyTypes`.

**Best Practices**:
- Use parameterized tests to reduce duplication and focus on varied inputs or types.
- Combine with fixtures to share setup and teardown.
- Avoid over-parameterization which can make tests harder to understand.

See [Parameterized and Type-Parameterized Tests guide](/guides/advanced-patterns/parameterized-type-tests) for in-depth details.

---

## Test Discovery Options and Controlling Execution Order

GoogleTest automatically discovers and runs tests in your binary. Beyond default discovery, you can influence which tests run and in what order.

### Test Filters

Control test execution with the `--gtest_filter` flag, specifying glob patterns:

```
--gtest_filter=TestSuiteName.TestName
--gtest_filter=Foo*.*:BarBaz.*
```

This enables running a subset of tests matching specific patterns.

### Ordering Tests

By default, tests can run in any order. You can control ordering for clarity or dependency reasons.

- **Sequences in Mocks:** When using GoogleMock, use the `Sequence` class with `InSequence()` or `.InSequence()` clauses inside `EXPECT_CALL()` to enforce call order.

- **`After()` Clause:** Use `.After()` with `Expectation` objects to express partial order dependencies between expectations.

Example of call order enforcement with sequences:

```cpp
Sequence s1, s2;
EXPECT_CALL(mock, Init()).InSequence(s1);
EXPECT_CALL(mock, Start()).InSequence(s1, s2);
EXPECT_CALL(mock, Finish()).InSequence(s2);
```

This declares `Init()` before `Start()`, and `Start()` before `Finish()` with overlapping sequences.

### Pitfalls

- Avoid relying on implicit test order; explicitly declare order dependencies where needed.
- Overusing sequences can lead to brittle tests if the implementation changes their call ordering unnecessarily.

---

## Test Environment Customization

Configure and manipulate per-test or global environments to prepare prerequisites, manage shared resources, or adjust settings affecting tests.

GoogleTest provides mechanisms to:
- Define `Environment` classes with `SetUp()` and `TearDown()` for global setup/cleanup.
- Use test fixtures (`TEST_F`) for per-test setup.
- Customize behavior with environment variables and flags.

### Parallel Execution

GoogleTest supports running tests in parallel for speed. Control the number of threads with `--gtest_parallel` in appropriate environments.

Note: Be mindful of test isolation and thread safety. Shared resources accessed by multiple tests should be protected or avoided.

---

## Special Tools: Death Tests

Death tests verify that certain code paths cause your program to terminate (e.g., due to fatal errors). GoogleTest provides robust death test support.

### Usage Example

```cpp
TEST(FooDeathTest, TerminatesOnInvalidInput) {
#if GTEST_HAS_DEATH_TEST
  EXPECT_DEATH({ foo.DoSomething(-1); }, "Invalid input");
#endif
}
```

Death tests run code in a subprocess and capture the termination and output.

### Best Practices
- Keep death tests isolated, as they fork processes.
- Avoid complex test fixtures in death tests.
- Use regex patterns to assert the death message.

See [Death Testing for Robustness](/guides/advanced-patterns/death-testing) for complete guidance.

---

## Practical Tips and Troubleshooting

### Tips
- Use `.RetiresOnSaturation()` in `EXPECT_CALL()` to automatically retire expectations after saturation, preventing over-call errors.
- Use `ON_CALL()` to specify default behavior without expectation, reducing noisy warnings for uninteresting calls.
- Control mock strictness via `NiceMock`, `NaggyMock`, and `StrictMock` wrappers to suit test strictness requirements.

### Common Pitfalls
- Ignoring the order of `EXPECT_CALL()` statements can shadow expectations.
- Forgetting to mark mock methods `public` even if base methods are `private` or `protected` causes inaccessible mocks.
- Mixing default actions and expectations without clear intent may cause subtle test failures.

### Debugging
- Enable verbose mock output with `--gmock_verbose=info` to get detailed traces of mock calls and expectations.
- Use `Mock::VerifyAndClearExpectations()` to force verification before a mock is destroyed.

---

## Additional Resources

- [Mocking Reference](../reference/mocking.md): Complete guide on mocks, macros, expectations, and sequences.
- [Actions Reference](../reference/actions.md): List of built-in actions and how to write custom behaviors.
- [gMock Cookbook](../gmock_cook_book.md): Practical recipes and advanced usage patterns.

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/reference/mocking.md", "range": "all"},{"path": "docs/gmock_cook_book.md", "range": "all"},{"path": "docs/reference/actions.md", "range": "all"}]}/>
