---
title: "Assertions and Expectations"
description: "Detailed overview of all built-in assertion macros for checking conditions in testsâ€”covering basic, fatal, and non-fatal assertions. Includes usage patterns, example code, and best practices for expressing intent and diagnosing failures."
---

# Assertions and Expectations

Explore how GoogleTest's assertion macros empower you to precisely verify conditions and behaviors in your tests. This page presents the complete set of built-in assertion macros, detailing their purpose, usage patterns, differences between fatal and non-fatal assertions, and best practices to write expressive, maintainable test code.

---

## Overview of Assertions

Assertions are the core mechanism by which you verify assumptions within test cases. GoogleTest provides two primary categories of assertions:

- **Fatal Assertions**: Abort the current function immediately if they fail, preventing subsequent code from executing. Useful when further test steps depend on the asserted condition.
- **Non-Fatal Assertions**: Report failure but allow the test to continue executing, enabling multiple checks within one test.

Choosing between these assertion types depends on whether failing the condition invalidates the rest of the test.

---

## Basic Assertion Macros

GoogleTest includes macros to check various conditions straightforwardly:

| Macro              | Description                          | Behavior on Failure            |
|--------------------|------------------------------------|-------------------------------|
| `ASSERT_TRUE(cond)` | Checks that `cond` evaluates true  | Fatal                         |
| `ASSERT_FALSE(cond)`| Checks that `cond` evaluates false | Fatal                         |
| `EXPECT_TRUE(cond)` | Checks that `cond` evaluates true  | Non-fatal                     |
| `EXPECT_FALSE(cond)`| Checks that `cond` evaluates false | Non-fatal                     |
| `ASSERT_EQ(val1, val2)` | Checks equality (`val1 == val2`) | Fatal                         |
| `EXPECT_EQ(val1, val2)` | Checks equality (`val1 == val2`) | Non-fatal                     |
| `ASSERT_NE(val1, val2)` | Checks inequality                | Fatal                         |
| `EXPECT_NE(val1, val2)` | Checks inequality                | Non-fatal                     |
| `ASSERT_LT(val1, val2)` | Checks less-than                 | Fatal                         |
| `EXPECT_LT(val1, val2)` | Checks less-than                 | Non-fatal                     |
| `ASSERT_LE(val1, val2)` | Checks less-or-equal            | Fatal                         |
| `EXPECT_LE(val1, val2)` | Checks less-or-equal            | Non-fatal                     |
| `ASSERT_GT(val1, val2)` | Checks greater-than             | Fatal                         |
| `EXPECT_GT(val1, val2)` | Checks greater-than             | Non-fatal                     |
| `ASSERT_GE(val1, val2)` | Checks greater-or-equal        | Fatal                         |
| `EXPECT_GE(val1, val2)` | Checks greater-or-equal        | Non-fatal                     |

**Example Usage:**

```cpp
TEST(MyTestSuite, BasicAssertions) {
  int a = 5, b = 10;

  ASSERT_LT(a, b);        // Fatal, test stops if false
  EXPECT_EQ(a + b, 15);   // Non-fatal, test continues
  EXPECT_TRUE(a > 0);
}
```

---

## Fatal vs Non-Fatal Assertions: When to Use What

- Use **`ASSERT_`** family when the failure of the assertion means the rest of the test is meaningless or likely to cause unexpected behavior (e.g., program crash).
- Use **`EXPECT_`** family to record failures but continue executing, useful in tests with multiple independent checks.

---

## Advanced Assertion Macros

GoogleTest also supports:

- `ASSERT_THROW(statement, exception_type)` / `EXPECT_THROW`: Verifies a statement throws a specific exception.
- `ASSERT_ANY_THROW` / `EXPECT_ANY_THROW`: Verifies a statement throws any exception.
- `ASSERT_NO_THROW` / `EXPECT_NO_THROW`: Verifies a statement does not throw any exception.
- `ASSERT_STREQ(expected_cstr, actual_cstr)` / `EXPECT_STREQ`: Compares C-style strings for equality.
- `ASSERT_STRNE` / `EXPECT_STRNE`: Compares C-style strings for inequality.
- `ASSERT_FLOAT_EQ` / `EXPECT_FLOAT_EQ`: Checks floating point equality with epsilon tolerance.
- `ASSERT_DOUBLE_EQ` / `EXPECT_DOUBLE_EQ`: Checks double precision floating point equality with epsilon tolerance.

**Example:**

```cpp
EXPECT_THROW(MyFunction(), std::invalid_argument);
ASSERT_NO_THROW(MyFunctionThatShouldNotThrow());
EXPECT_STREQ("hello", str);
EXPECT_FLOAT_EQ(3.14f, CalculatePiApproximation());
```

---

## Expressive Failures and Descriptions

Failure messages generated by GoogleTest assertions include:

- The expression that failed and its values
- Source file and line number
- Optional user-supplied messages (see next section)

This aids rapid diagnosis of test failures and understanding of the underlying condition that broke.

---

## Custom Messages with Assertions

To provide additional context on failure, append `<<` and a stream expression to any assertion macro:

```cpp
EXPECT_EQ(x, y) << "Expected values to match due to reason Z";
ASSERT_TRUE(ptr != nullptr) << "Pointer must not be null for test to proceed.";
```

This message is printed if the assertion fails, enriching failure logs.

---

## Using `EXPECT_THAT()` for Matcher-Based Assertions

For more complex conditions, use the `EXPECT_THAT(value, matcher)` macro, which accepts rich matchers like `ElementsAre`, `HasSubstr`, or custom matchers.

```cpp
EXPECT_THAT(vec, ElementsAre(1, 2, 3));
EXPECT_THAT(str, HasSubstr("needle"));
```

This enables expressive, flexible assertions on values and containers.

---

## Common Usage Patterns

### Verifying Expected Outcomes

Set clear assertions at the end of your test to verify correctness directly:

```cpp
TEST(CalculatorTest, AddsNumbersCorrectly) {
  Calculator calc;

  int result = calc.Add(2, 3);
  EXPECT_EQ(result, 5) << "Addition computation failed.";
}
```

### Checking Multiple Properties

Use non-fatal assertions to check various aspects without stopping at the first failure:

```cpp
EXPECT_GT(value, 0);
EXPECT_LT(value, 100);
EXPECT_NE(ptr, nullptr);
```

### Testing Exception-Throwing Code

Use `EXPECT_THROW` macros to ensure error conditions are correctly triggered:

```cpp
EXPECT_THROW(ParseConfig(file), ConfigParseException);
```

---

## Best Practices and Recommendations

- **Fail fast with `ASSERT_` macros** if subsequent code depends on successful assertion.
- **Avoid over-specifying**: assert only what your test aims to verify to reduce brittleness.
- Use **custom messages** to explain the "why" behind assertions for easier debugging.
- Prefer **`EXPECT_THAT`** with matchers for complex or container assertions.
- Combine **assertions with test fixtures** to write clean, maintainable test code.
- Use **floating point specific assertions** (`EXPECT_FLOAT_EQ`, etc.) instead of generic equality for numeric stability.

---

## Troubleshooting Assertions

### Assertion Not Firing

- Ensure the assertion condition is reachable in the test.
- Verify you are using the correct `ASSERT_` or `EXPECT_` variant.

### Unexpected Test Failure

- Check if the failure message points to an incorrect assumption in your test.
- Use `--gtest_verbose` command-line flags for enhanced failure diagnostics.

### Multiple Failures in One Test

- Use non-fatal assertions (`EXPECT_`) strategically to gather multiple failures.
- Remember excessive non-fatal failures can clutter test results; balance test granularity.

---

## Summary

Assertions are your primary tool to specify and verify test conditions in GoogleTest. Mastering their use will empower you to write clear, reliable, and expressive tests that catch bugs effectively and communicate intent precisely.

---

## Further Reading and Related Documentation

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [Matchers Reference](https://github.com/google/googletest/blob/main/docs/reference/matchers.md)
- [Assertions Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md)
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md)
- [Writing Your First Test Case](https://github.com/google/googletest/blob/main/getting-started/first-test-validation/writing-your-first-test.mdx)

---

## Code Examples

<CodeGroup>
```cpp
// Basic assertion usage
TEST(ExampleTest, SimpleAssertions) {
  int x = 5, y = 10;

  ASSERT_LT(x, y);             // Test aborts if false
  EXPECT_EQ(x + y, 15);        // Test continues if false
  EXPECT_TRUE(x > 0) << "x should be positive";
}
```
```cpp
// Using assertions with exception checks
TEST(ExampleTest, ExceptionCheck) {
  EXPECT_THROW({ throw std::runtime_error("fail"); }, std::runtime_error);
  EXPECT_NO_THROW([](){}());
}
```
```cpp
// Using EXPECT_THAT with matchers
#include <vector>
#include <string>
#include <gmock/gmock.h>

using ::testing::ElementsAre;
using ::testing::HasSubstr;

TEST(ExampleTest, ContainerMatcher) {
  std::vector<int> v = {1, 2, 3};
  std::string message = "Hello, world!";

  EXPECT_THAT(v, ElementsAre(1, 2, 3));
  EXPECT_THAT(message, HasSubstr("world"));
}
```
</CodeGroup>