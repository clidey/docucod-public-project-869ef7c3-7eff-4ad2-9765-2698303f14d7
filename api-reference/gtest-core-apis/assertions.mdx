---
title: "Assertions"
description: "Comprehensive guide to GoogleTest's assertion macros, their diagnostic capabilities, assertion results, custom assertions, and controlling test outcomes through fatal and non-fatal failures. Includes explanations and usage patterns for all major assertion types."
---

# Assertions

GoogleTest provides a rich set of assertion macros designed to help you verify expectations in your C++ tests. These macros give you clear diagnostics describing what went wrong and where, enabling quick debugging and improved confidence in your code.

This documentation covers the full range of assertion macros, their behaviors, diagnostic features, and how you can use and extend them for your testing needs.

---

## Overview of Assertions

Assertions are the fundamental building blocks in writing tests. They check whether a specific condition holds and report success or failure accordingly.

- **Fatal assertions** (`ASSERT_`) generate a fatal failure on failure, aborting the current test function immediately.
- **Nonfatal assertions** (`EXPECT_`) generate nonfatal failures, allowing the test to continue and report multiple issues in one run.

This distinction lets you control the flow depending on the test condition's criticality.

All assertions optionally accept streamed messages, allowing you to supplement failure diagnostics with custom, detailed context.

Example:

```cpp
ASSERT_EQ(x.size(), y.size()) << "Vectors x and y differ in length";
EXPECT_EQ(x[i], y[i]) << "Vectors differ at index " << i;
```

---

## Assertion Macro Categories

### Explicit Success and Failure

Use when you want to explicitly declare success or failure within a test block.

- `SUCCEED()` — Generates a success. Helpful for documentation or skipping elaborate assertions.
- `FAIL()` — Generates a fatal failure immediately.
- `ADD_FAILURE()` — Generates a nonfatal failure.
- `ADD_FAILURE_AT(file, line)` — Generates a nonfatal failure at a specific source location.

Example:

```cpp
switch (expr) {
  case 1:
    ...
  default:
    FAIL() << "Unexpected value";
}
```


### Boolean Condition Assertions

Verify simple true/false conditions.

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`


### Binary Comparison Assertions

Compare two values using relational operators.

- Equality:
  - `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)`
  - `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)`

- Ordering:
  - `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)` (less than)
  - `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)` (less or equal)
  - `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)` (greater than)
  - `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)` (greater or equal)

**Pointer equality:** Use `EXPECT_EQ(nullptr, pointer)` rather than `EXPECT_EQ(pointer, NULL)` for clarity and safety.

**String equality:** Use special macros (`EXPECT_STREQ`, `EXPECT_STRNE`) for C strings.

Example:

```cpp
EXPECT_EQ(expected_value, actual_value) << "Mismatch in calculation";
ASSERT_NE(nullptr, ptr) << "Pointer should not be null";
```


### String Assertions

Special macros for comparing C strings and wide strings by content rather than by pointer.

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` — strings are equal
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)` — strings are not equal
- Case-insensitive:
  - `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)`
  - `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)`

Example:

```cpp
EXPECT_STREQ("hello", buffer.c_str()) << "Buffer content incorrect";
ASSERT_STRCASEEQ("ABC", input);  // Ignore case
```


### Floating-Point Comparison Assertions

Due to the nature of floating-point precision, use specialized macros for approximate equality.

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)` — match within 4 units in the last place (ULPs) for `float`
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)` — match within 4 ULPs for `double`
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` — match within an absolute error margin

Example:

```cpp
EXPECT_FLOAT_EQ(result, 1.0f) << "Results differ beyond floating point precision";
EXPECT_NEAR(computed_value, expected_value, 0.01) << "Value mismatch with margin";
```


### Exception Assertions

Verify exception throwing behavior (when exceptions are enabled).

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`

Example:

```cpp
EXPECT_THROW(ThrowOnError(), std::runtime_error);
ASSERT_NO_THROW(StartService());
```


### Predicate Assertions

Use predicates or custom predicate-formatters to get expressive failure messages when Boolean logic isn't enough.

- `EXPECT_PRED1(pred, val1)` ... `EXPECT_PRED5(pred, val1, ..., val5)` / `ASSERT_PRED*`
- `EXPECT_PRED_FORMAT1(pred_formatter, val1)` ... / `ASSERT_PRED_FORMAT*`

Predicates are functions that return `bool` or `testing::AssertionResult`. Predicates with `AssertionResult` can provide richer failure descriptions.

Example:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, value);

AssertionResult IsEvenDetailed(int n) {
  if (n % 2 == 0) return AssertionSuccess();
  return AssertionFailure() << n << " is odd";
}
EXPECT_PRED_FORMAT1(IsEvenDetailed, value);
```


### Windows HRESULT Assertions

Verify success or failure of Windows `HRESULT` codes (available on Windows).

- `EXPECT_HRESULT_SUCCEEDED(hr_expression)` / `ASSERT_HRESULT_SUCCEEDED(hr_expression)` ensures the HRESULT indicates success
- `EXPECT_HRESULT_FAILED(hr_expression)` / `ASSERT_HRESULT_FAILED(hr_expression)` ensures failure

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(CoCreateInstance(...));
EXPECT_HRESULT_FAILED(FunctionThatReturnsError());
```


### Death Assertions

Assert that a statement causes the program to terminate with an expected status and output. These spawn a new process to isolate the effect.

- `EXPECT_DEATH(statement, regex_matcher)` / `ASSERT_DEATH`
- `EXPECT_DEATH_IF_SUPPORTED` / `ASSERT_DEATH_IF_SUPPORTED`
- `EXPECT_DEBUG_DEATH` / `ASSERT_DEBUG_DEATH`
- `EXPECT_EXIT(statement, predicate, regex_matcher)` / `ASSERT_EXIT`

Example:

```cpp
EXPECT_DEATH(AbortIfNull(ptr), "Null pointer error");
EXPECT_EXIT(ExitWithCode0(), testing::ExitedWithCode(0), "Success");
```

---

## Using Assertion Results and Custom Messages

All assertion macros support streaming custom diagnostic messages that get appended to the standard GoogleTest failure messages. This allows you to supply actionable context that aids debugging.

```cpp
EXPECT_EQ(x, y) << "x and y differ for input foo=" << foo;
ASSERT_TRUE(IsValid(data)) << "Invalid data at index " << index;
```

If a failure occurs, the output includes your message after the built-in failure details.


## Recommended Usage Patterns

- Use `EXPECT_` variants when it makes sense to continue running the test despite failure, so you can catch multiple issues.
- Use `ASSERT_` variants to prevent subsequent code that depends on the assertion from executing (e.g., preventing null pointer dereference).
- Supply informative custom messages wherever helpful for context.
- Use predicate assertions or predicate-formatters for complex conditions to get intelligible failure messages.


## Common Pitfalls and Tips

- Fatal assertions (`ASSERT_*`) abort the current function only. Beware of partially constructed objects or skipped clean-up if placing them in constructors/destructors. Instead, override `SetUp()`/`TearDown()`.
- Assertions that compare pointers (`EXPECT_EQ`, `EXPECT_NE`) will check address equality; for strings use string-specific assertions.
- When comparing floating-point numbers, always prefer `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR` to `EXPECT_EQ` due to precision issues.
- `SUCCEED()` doesn't make a test pass on its own; tests pass only if no assertions fail.


## Assertion Predicate Example

Sometimes Boolean assertions alone do not provide clear failure messages about why a test failed. Custom predicate functions with `AssertionResult` can improve clarity.

```cpp
// Custom assertion that prints why n is not even.
testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << n << " is odd";
}

TEST(MyTestSuite, EvenCheck) {
  int value = 3;
  EXPECT_TRUE(IsEven(value));  // Will print: Value of: IsEven(value) Actual: false (3 is odd)
}
```


## Special Assertion Macros for Subroutines

- `ASSERT_NO_FATAL_FAILURE(statement);` wraps a statement and asserts it runs without generating a fatal failure.
- `SCOPED_TRACE(message);` adds information about the current location to failure messages in the scope, useful for diagnosing failures inside helper functions or loops.


## Accessing Assertion Results in Tests

GoogleTest provides APIs to check assertion status inside your tests:

- `Test::HasFatalFailure()`, `Test::HasNonfatalFailure()`, `Test::HasFailure()` — query if the current test has those failures.
- Use these to conditionally skip logic or early return if previous assertions failed.

Example:

```cpp
TEST(MyTest, HalfSuccess) {
  EXPECT_TRUE(DoSomething());
  if (HasFatalFailure()) return;
  EXPECT_TRUE(DoSomethingElse());
}
```


## Summary

GoogleTest assertions provide a comprehensive and flexible toolkit:

- Fatal vs nonfatal controls
- Rich diagnostic messages and custom failure context
- Specialized assertions for strings, floating points, exceptions, and system HRESULTs
- Predicate and predicate-format assertions for complex checks
- Death assertions for testing process termination

They empower you to write tests that provide clear, actionable feedback on failures, minimizing debugging time and improving code quality.


## See Also
- [Assertions Reference](reference/assertions.md) — Complete list and details
- [Matchers Reference](reference/matchers.md) — Rich assertions with matchers
- [Advanced Guide: More Assertions](advanced.md#more-assertions)
- [GoogleTest Primer](primer.md) — Getting started with GoogleTest
- [Core Testing Workflows: Using Assertions](guides/core-testing-workflows/using-assertions.mdx)

---