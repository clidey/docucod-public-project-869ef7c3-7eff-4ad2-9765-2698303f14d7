---
title: "Value Printing and Diagnostics"
description: "Leverage custom and built-in value printers to produce readable, actionable test failure messages. Covers printing for primitives, STL containers, user-defined types, and extending the printing system. Helps improve test maintainability and debuggability."
---

# Value Printing and Diagnostics

GoogleTest enhances the clarity and effectiveness of test failure messages by providing a comprehensive system for value printing and diagnostics. This system includes built-in printers for primitive types, STL containers, user-defined types, and offers extensibility to teach GoogleTest how to print custom types. Leveraging these capabilities improves test maintainability and speeds debugging by presenting readable, actionable output.

---

## Overview of GoogleTest's Value Printing

GoogleTest provides a universal value printer designed to convert various types of values into human-readable strings. This printing functionality underpins failure diagnostics and assertion messages, making it essential for understanding test results quickly.

Key principles of GoogleTest's value printing include:

- **Support for a wide range of types**: primitives, pointers, strings, containers, and user-defined objects.
- **Extensibility**: Developers can provide custom printing logic for their types.
- **Intelligent printing of pointers and arrays**, including C-style strings.
- **Readable formatting** that highlights differences in complex objects such as containers or tuples.

The core API function involved is `testing::PrintToString(value)`, which converts any printable value to a string representation suitable for output in test diagnostics.

---

## Built-In Printers for Primitive and Common Types

GoogleTest includes specific printers for many fundamental and common C++ types, ensuring accurate and readable output.

### Character Types

- Prints printable characters as literals with their ASCII (or code) values.
- Escapes non-printable and special characters appropriately.
- Wide characters (`wchar_t`, `char16_t`, `char32_t`) are printed in their code point representations and literal escapes.

### Numeric Types

- Prints integers and floating-point numbers with appropriate precision.
- Floating-point values use specialized formatting to minimize confusing trailing digits.

### Boolean Values

- Prints `true` or `false` as literal text.

### Strings and C-Strings

- Prints `std::string` and string view types enclosed in quotes, escaping special characters.
- For C-style strings (char*, wchar_t*, char16_t*, char32_t*), prints the pointer address and the string content if not null.
- Null pointers print as `NULL` or `(nullptr)`.

### Pointers

- Generic pointers are printed by their address unless they are character pointers to be printed as strings.
- Function pointers print their address.
- Member pointers print raw byte representations.

### Arrays and Container-like Types

- Native arrays print with braces and comma-separated elements, supporting multi-dimensional arrays.
- STL containers print each element recursively, enclosed in braces.
- Printing limits the number of elements output to avoid overwhelming diagnostics.

---

## Advanced Printing for Complex and User-Defined Types

### Tuples and Pairs

- Prints tuples as parenthesized lists with elements separated by commas.
- Supports nested tuples.
- Prints pairs similarly.

### Smart Pointers

- Prints whether a smart pointer is null, and if not, prints the pointer address and the pointed-to value.

### `std::any`, `std::optional`, and `std::variant`

- Prints information about contained values or voidness, handling alternative types in variants with type names and values.

### User-Defined Classes

- GoogleTest detects whether the type supports streaming (`operator<<`) or a custom `PrintTo()` function, using the first available for printing.
- If both are absent, prints raw bytes safely without crashing.

### Extending the Printer

To teach GoogleTest how to print a user-defined type `Foo`, you can:

1. Define `void PrintTo(const Foo&, std::ostream*)` in the `Foo` namespace. This takes precedence.
2. Provide an appropriate `operator<<(std::ostream&, const Foo&)`.
3. Use Abseil's `AbslStringify()` if available for a structured print.

This layered approach ensures minimal intrusion while enabling precise output customized to the type.

---

## Common Use Patterns and Examples

### Basic Usage of `PrintToString`

```cpp
int x = 42;
std::string output = testing::PrintToString(x);  // "42"

std::vector<int> v = {1, 2, 3};
std::string output_vec = testing::PrintToString(v); // "{ 1, 2, 3 }"
```

### Custom Printing with `PrintTo()`

```cpp
namespace mynamespace {
  class MyType {
    int value;
  };

  void PrintTo(const MyType& obj, std::ostream* os) {
    *os << "MyType with value=" << obj.value;
  }
}
```

This allows GoogleTest to print instances of `MyType` as `MyType with value=...` in assertion failure messages.

### Streaming Operator for User Types

```cpp
class Point {
public:
  int x, y;
};

std::ostream& operator<<(std::ostream& os, const Point& p) {
  return os << "(" << p.x << ", " << p.y << ")";
}
```

GoogleTest will use this to print points when they appear in assertions.

---

## Diagnostics and Failure Message Enhancements

GoogleTest's value printer collaborates with assertion macros to produce diagnostic messages.

- When a test fails, the assertion framework automatically prints the expected and actual values by invoking the printer.
- For string and container comparisons, GoogleTest produces diffs highlighting the differences inline.
- For floating-point assertions, it formats numbers with precision to reduce false positives arising from subtle rounding issues.
- When printing pointers to strings, it shows both the pointer address and the string content to avoid confusion.
- Unicode strings and wide characters get UTF-8 validation and safe printing, indicating textual content when possible.

These features collectively create diagnostic messages that are informative, enabling fast identification and correction of issues.

---

## Troubleshooting and Tips

- **Custom printers must be within the namespace of the type** to be found by ADL (Koenig lookup).
- If your custom `operator<<` is not picked up, consider implementing `PrintTo`.
- Avoid printing very large containers fully; prefer subset sampling or limiting output.
- Check pointers for null before dereferencing in printers.
- For parameterized tests with complex types, provide custom printer functions to make test output readable.
- Use `testing::PrintToString()` in debugging to verify how values will appear.

---

## Summary

GoogleTest's value printing system is a critical feature, turning raw test failures into insightful, clear diagnostics. By supporting a variety of types and allowing custom printers, it ensures that test output is both human-readable and actionable. Mastering this feature boosts developers' ability to maintain clean, trustworthy, and debuggable tests.

---

## See Also

- [Assertions Reference](reference/assertions.md) — how assertions use value printing
- [GoogleTest Primer](primer.md) — introduction including writing basic tests
- [Customizing Print Functions](googletest/include/gtest/internal/custom/README.md) — customization details
- [Parameterized and Typed Tests](api-reference/gtest-core-apis/parameterized-and-typed-tests.mdx) — handling complex test types with custom printing

---

## Mermaid Diagram: Value Printing Flow

```mermaid
flowchart TD
  A[User test with assertion] --> B[Values passed to assertion macros]
  B --> C{Type supports PrintTo()} 
  C -- Yes --> D[Call PrintTo() to print value]
  C -- No --> E{Type supports operator<<?}
  E -- Yes --> F[Call operator<< to print stream]
  E -- No --> G{Type is STL Container?}
  G -- Yes --> H[Iterate elements and print each]
  G -- No --> I[Print raw bytes safely]
  D --> J[Formatted string returned]
  F --> J
  H --> J
  I --> J
  J --> K[Diagnostic message constructed with printed values]
  K --> L[Test failure message displayed]
```

---
