---
title: "Test Registration and Execution"
description: "A practical guide to defining and registering test cases and suites using GoogleTest’s API. Covers TEST and TEST_F macros, main entry points, and lifecycle management, empowering users to structure and execute tests efficiently."
---

# Test Registration and Execution

A practical guide to defining and registering test cases and suites using GoogleTest’s API. This document covers the key macros and functions that enable you to write and organize tests, control their execution lifecycle, and understand how GoogleTest discovers and runs tests efficiently.

---

## Introduction

GoogleTest offers a straightforward and powerful way to create C++ unit and integration tests. At its core are macros like `TEST` and `TEST_F` for defining individual tests and test fixtures. Understanding these, along with entry points and lifecycle hooks, empowers you to build well-structured and maintainable test suites.

---

## Defining Tests

### The `TEST` Macro

Use the `TEST` macro to define a simple, standalone test without fixture setup:

```cpp
TEST(TestSuiteName, TestName) {
  // Your test code here
  EXPECT_EQ(1, 1);
}
```

- **TestSuiteName**: Groups related tests.
- **TestName**: Unique identifier for this test within the suite.

**Outcome:**
- Each `TEST` defines a function that is automatically registered.
- Test names must be unique within a suite.

### The `TEST_F` Macro

`TEST_F` uses **test fixtures**, allowing you to reuse setup and teardown code across multiple tests:

```cpp
class MyTestFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    // Code here runs before each test
  }

  void TearDown() override {
    // Code here runs after each test
  }

  // Shared test data members
  int shared_value;
};

TEST_F(MyTestFixture, TestOne) {
  shared_value = 5;
  EXPECT_EQ(shared_value, 5);
}

TEST_F(MyTestFixture, TestTwo) {
  EXPECT_NE(shared_value, 10);
}
```

- Use `TEST_F` when you need common setup or shared context.
- The fixture class must inherit from `::testing::Test`.

---

## Organizing Test Suites

- Group tests logically by functionality using the **test suite** name in `TEST` or class name in `TEST_F`.
- Reuse fixtures for tests that share setup/teardown or common test utilities.

---

## Main Entry Points for Running Tests

### Using `RUN_ALL_TESTS()`

Your test executable must call `RUN_ALL_TESTS()` to discover and execute all registered tests. This function:

- Automatically locates all tests registered via `TEST` and `TEST_F` macros.
- Runs each test, reporting failures and successes.
- Returns `0` if all tests pass, or a non-zero value otherwise.

Example main function:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

**Tip:** GoogleTest initializes with command-line arguments, allowing you to control test selection and output.

### `InitGoogleTest` Utility

- Prepares GoogleTest for execution.
- Parses command-line flags such as `--gtest_filter` to selectively run tests.

---

## Test Lifecycle Management

GoogleTest manages test lifecycle with optional setup and teardown:

### Per-Test Setup and Teardown

Within fixtures derived from `::testing::Test`, override:

- `SetUp()`: Code runs before each test.
- `TearDown()`: Code runs after each test.

These ensure consistent environment initialization and cleaning.

### Test Suite-wide Setup and Teardown

For expensive or global setup/cleanup per test suite, use static methods:

```cpp
class MyTestSuite : public ::testing::Test {
 public:
  static void SetUpTestSuite() {
    // Runs once before all tests in this suite
  }

  static void TearDownTestSuite() {
    // Runs once after all tests in this suite
  }
};
```

This works well for tasks like opening database connections or initializing shared state.

---

## Test Registration Internals

- Every `TEST` or `TEST_F` invocation creates a uniquely named function and registers it via global registry.
- GoogleTest uses this registry at runtime to discover all test cases.
- This automatic registration means you don't manually list tests.

---

## Advanced Usage Tips

- **Parameterized Tests**: Use for running the same test logic with different inputs (see `Parameterized and Typed Tests` docs).
- **Typed Tests**: Run tests with multiple types efficiently.
- **Filtering Tests**: Run specific tests using command-line flag `--gtest_filter=TestSuiteName.TestName` or wildcards.
- **Test Execution Order**: Tests are not guaranteed to run in any specific order; tests should not rely on order.

---

## Troubleshooting

- **Duplicate Test Names**: Compile-time or runtime errors occur if two tests share suite and test names.
- **Setup Fails Silently**: If `SetUp()` throws or fails without explicit errors, test may abort early.
- **Tests Not Running**: Ensure `RUN_ALL_TESTS()` is called and tests are linked into the executable.
- **Test Output is Empty**: Run with `--gtest_verbose=info` for detailed logs.

---

## Example

Complete example combining key concepts:

```cpp
#include <gtest/gtest.h>

class CalculatorTest : public ::testing::Test {
 protected:
  void SetUp() override {
    calculator.Add(2);
  }

  void TearDown() override {
    // Cleanup if needed
  }

  Calculator calculator;
};

TEST_F(CalculatorTest, InitialValue) {
  EXPECT_EQ(calculator.Value(), 2);
}

TEST_F(CalculatorTest, Addition) {
  calculator.Add(3);
  EXPECT_EQ(calculator.Value(), 5);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## Summary

This page guided you in registering and executing tests with GoogleTest, focusing on:

- Writing tests (`TEST`, `TEST_F`)
- Organizing tests into suites and fixtures
- Executing tests via `RUN_ALL_TESTS()` and command line
- Managing setup and teardown lifecycle hooks
- Understanding test registration and discovery

For deeper dives, see guides on parameterized tests, mock objects, and assertion APIs.

---

## Related Topics

- [Writing Your First Test](https://googletest.googlesource.com/gmock/+/refs/heads/main/docs/guides/core-workflow/getting-started-tests.md)
- [Test Fixtures and Reusable Setups](https://googletest.googlesource.com/gmock/+/refs/heads/main/docs/guides/advanced-usage/test-fixtures-best-practices.md)
- [Parameterized and Typed Tests](https://googletest.googlesource.com/gmock/+/refs/heads/main/docs/guides/advanced-usage/parameterized-tests.md)
- [Assertions and Failure Reporting](https://googletest.googlesource.com/gmock/+/refs/heads/main/docs/api-reference/core-testing-framework/assertions-and-failures.md)

---

Please refer to other pages in the `API Reference` and `Guides` tabs for broader context and advanced topics.