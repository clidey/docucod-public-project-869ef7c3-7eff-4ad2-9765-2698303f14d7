---
title: "Assertions Reference"
description: "Covers the wide variety of assertions provided by GoogleTest, such as equality, exception, and predicate assertions. Demonstrates usage patterns and best practices for both built-in and user-defined assertions."
---

# Assertions Reference

This page lists the assertion macros provided by GoogleTest for verifying code behavior. To use them, add `#include <gtest/gtest.h>`.

Most assertion macros come in pairs: an `EXPECT_` variant and an `ASSERT_` variant. Upon failure, `EXPECT_` generates nonfatal failures allowing continued execution, whereas `ASSERT_` generates fatal failures, aborting the current function.

All assertion macros support streaming custom failure messages with the `<<` operator, for example:

```cpp
EXPECT_TRUE(my_condition) << "My condition is not true";
```

Anything streamable to an `ostream`—including strings and C strings—can be used. Streaming wide strings (`wchar_t*`, `TCHAR*`, or `std::wstring`) converts them to UTF-8 when printed.

---

## Explicit Success and Failure

These assertions directly generate success or failure rather than testing a value. Useful when control flow—not a Boolean expression—determines test success.

### SUCCEED

`SUCCEED()`

Generates a success. Note, this does *not* automatically make a test succeed; a test succeeds only if no assertions fail during its execution.

Currently documented only; no user-visible output.

### FAIL

`FAIL()`

Generates a fatal failure aborting the current function.

**Note:** Can only be used in `void`-returning functions.

### ADD_FAILURE

`ADD_FAILURE()`

Generates a nonfatal failure, allowing the current function to continue.

### ADD_FAILURE_AT

`ADD_FAILURE_AT(file_path, line_number)`

Generates a nonfatal failure at the specific file and line number.

---

## Generalized Assertion with Matchers

### EXPECT_THAT

`EXPECT_THAT(value, matcher)`
`ASSERT_THAT(value, matcher)`

Verifies that a value matches a specified matcher, providing expressive and readable test conditions.

Example:

```cpp
EXPECT_THAT(value1, StartsWith("Hello"));
EXPECT_THAT(value2, MatchesRegex("Line \\d+"));
ASSERT_THAT(value3, AllOf(Gt(5), Lt(10)));
```

Matchers support rich composition and provide detailed failure messages.

---

## Boolean Conditions

### EXPECT_TRUE / ASSERT_TRUE

`EXPECT_TRUE(condition)`
`ASSERT_TRUE(condition)`

Verifies that the condition is true.

### EXPECT_FALSE / ASSERT_FALSE

`EXPECT_FALSE(condition)`
`ASSERT_FALSE(condition)`

Verifies that the condition is false.

---

## Binary Comparison Assertions

These compare two values with the specified operators. Arguments must be compatible types, and supporting streaming for better failure messages is recommended.

### Equality and Inequality

- `EXPECT_EQ(val1, val2)` verifies `val1 == val2`.
- `ASSERT_EQ(val1, val2)` fatal variant.
- `EXPECT_NE(val1, val2)` verifies `val1 != val2`.
- `ASSERT_NE(val1, val2)` fatal variant.

**Note:**
- Pointer comparisons test addresses, so to compare C strings by content use string comparison assertions.
- To compare a pointer to `nullptr`, use `EXPECT_EQ(ptr, nullptr)`.

### Relational Operators

- `EXPECT_LT(val1, val2)`, `ASSERT_LT(val1, val2)` : verifies `<`.
- `EXPECT_LE(val1, val2)`, `ASSERT_LE(val1, val2)` : verifies `<=`.
- `EXPECT_GT(val1, val2)`, `ASSERT_GT(val1, val2)` : verifies `>`.
- `EXPECT_GE(val1, val2)`, `ASSERT_GE(val1, val2)` : verifies `>=`.

---

## String Comparison Assertions

For comparing **C strings** (narrow or wide). To compare `std::string` objects, use equality assertions instead.

- `EXPECT_STREQ(s1, s2)` verifies that two C strings have the same contents.
- `EXPECT_STRNE(s1, s2)` verifies that two C strings have different contents.
- `EXPECT_STRCASEEQ(s1, s2)` verifies equality ignoring case.
- `EXPECT_STRCASENE(s1, s2)` verifies inequality ignoring case.

Corresponding `ASSERT_` variants exist.

To compare C strings with `nullptr`, use `EXPECT_EQ(c_str, nullptr)` or `EXPECT_NE(c_str, nullptr)`.

---

## Floating-Point Comparison

Due to rounding, exact comparison is unreliable. Use provided macros which apply an appropriate tolerance.

- `EXPECT_FLOAT_EQ(val1, val2)`, `ASSERT_FLOAT_EQ` for floats — approximately equal within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)`, `ASSERT_DOUBLE_EQ` for doubles — similarly.
- `EXPECT_NEAR(val1, val2, abs_error)`, `ASSERT_NEAR` verify absolute difference doesn't exceed `abs_error`.

GoogleTest provides predicate-format functions `FloatLE()` and `DoubleLE()` for less-than-or-equal approximate comparisons usable with predicate assertions.

---

## Exception Assertions

Require exception support enabled in your environment.

- `EXPECT_THROW(statement, exception_type)`, `ASSERT_THROW` verify `statement` throws exactly the specified exception.
- `EXPECT_ANY_THROW(statement)`, `ASSERT_ANY_THROW` verify that `statement` throws any exception.
- `EXPECT_NO_THROW(statement)`, `ASSERT_NO_THROW` verify no exception is thrown.

`statement` can be compound code blocks.

---

## Predicate Assertions

Enable verifying complex predicates with more detailed messages than `EXPECT_TRUE()` provides.

### Using Existing Boolean Functions

If you have a Boolean function or functor, use these assertions:

```cpp
EXPECT_PRED1(pred, val1);
EXPECT_PRED2(pred, val1, val2);
...
```

They print argument values on failure, evaluating arguments exactly once.

### Using Functions Returning `AssertionResult`

For even better failure messages, write predicates returning `testing::AssertionResult` objects:

```cpp
testing::AssertionResult IsEven(int n) {
  if ((n % 2) == 0)
    return testing::AssertionSuccess();
  else
    return testing::AssertionFailure() << n << " is odd";
}
```

This enables printing actual predicate results and custom messages.

### Predicate-Formatter Assertions

Use for full control over failure message formatting when default messages are insufficient or arguments don't support streaming.

Signature of predicate-formatter:

```cpp
testing::AssertionResult PredicateFormatter(
    const char* expr1, const char* expr2, ..., T1 val1, T2 val2, ...);
```

Use with `EXPECT_PRED_FORMAT*()` / `ASSERT_PRED_FORMAT*()` macros.

Example:
```cpp
testing::AssertionResult AssertMutuallyPrime(const char* m_expr, const char* n_expr, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << m_expr << " and " << n_expr << " are not mutually prime.";
}
EXPECT_PRED_FORMAT2(AssertMutuallyPrime, a, b);
```

---

## Windows HRESULT Assertions

Test HRESULT values with automatic failure message including human-readable system error message.

- `EXPECT_HRESULT_SUCCEEDED(expression)`, `ASSERT_HRESULT_SUCCEEDED`: succeeds if HRESULT indicates success.
- `EXPECT_HRESULT_FAILED(expression)`, `ASSERT_HRESULT_FAILED`: succeeds if HRESULT indicates failure.

Example:

```cpp
CComPtr<IShellDispatch2> shell;
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

---

## Death Assertions

Validate that a piece of code terminates the process in the expected way.

- `EXPECT_DEATH(statement, matcher)`, `ASSERT_DEATH`: verifies `statement` causes process termination with stderr matching `matcher`.
- `EXPECT_DEATH_IF_SUPPORTED`, `ASSERT_DEATH_IF_SUPPORTED`: run if death tests are supported, otherwise no check.
- `EXPECT_DEBUG_DEATH`, `ASSERT_DEBUG_DEATH`: run only in debug mode.
- `EXPECT_EXIT(statement, predicate, matcher)`, `ASSERT_EXIT`: verifies termination with exit status satisfying `predicate` and stderr matching `matcher`.

Example:

```cpp
EXPECT_DEATH({ int n = 5; Foo(&n); }, "Error on line .* of Foo()");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

**Note:** A death test only cares about:

1. Process terminates.
2. Exit status matches expected criteria.
3. Stderr output matches expected.

**Important:** Name death test suites ending with `DeathTest` to ensure they run before other tests and handle threading issues.

---

## Using Assertions in Sub-routines

When you put assertions in helper functions, be aware that `ASSERT_*` macros abort only the function they are in, not the entire test. To propagate failures:

- Use `HasFatalFailure()` to check after subroutine calls.
- Use `ASSERT_NO_FATAL_FAILURE(statement)` to verify no fatal failures occur inside `statement`.
- Use event listeners that throw exceptions on failure to propagate errors beyond subroutine boundaries.

---

## Skipping Test Execution

Use `GTEST_SKIP()` to skip the remaining part of a test or fixture at runtime.

Example:

```cpp
TEST(SkipTest, DoesSkip) {
  GTEST_SKIP() << "Skipping single test";
  FAIL();  // Won't execute
}

class SkipFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    GTEST_SKIP() << "Skipping all tests for this fixture";
  }
};
```

---

## Logging Additional Information

Logging key-value test properties can be done with `RecordProperty` during test execution, suite setup/teardown, or globally.

Example:

```cpp
TEST_F(WidgetUsageTest, MinAndMaxWidgets) {
  RecordProperty("MaximumWidgets", ComputeMaxUsage());
  RecordProperty("MinimumWidgets", ComputeMinUsage());
}
```

Note the following:

- `RecordProperty` is `public static` allowing use outside test bodies.
- Keys must be valid XML attributes and not conflict with reserved names like `name`, `time`, `classname`.
- Values recorded in different contexts appear at different XML levels (`<testcase>`, `<testsuite>`, or `<testsuites>`).

---

For a full list of assertion macros with examples and best practices, consult the [Testing Reference](reference/testing.md) and [Using Assertions Effectively](guides/core-workflows/using-assertions.md).

---

### Tips & Best Practices

- Prefer `EXPECT_` macros when test continuation after failure is desired.
- Use streaming to provide contextual messages for clearer diagnostics.
- Use predicate assertions (`EXPECT_PRED*` or `EXPECT_PRED_FORMAT*`) to improve failure messages for complex conditions.
- For floating-point comparisons, use GoogleTest's floating-point macros rather than `EXPECT_EQ`.
- Name death test suites ending with `DeathTest` to ensure they execute safely and first.
- Use `GTEST_SKIP()` to programmatically skip tests when preconditions are not met.
- Use `RecordProperty` for reporting auxiliary data in XML or JSON outputs.

---

For advanced customized assertions and predicate-formatters, see [Advanced GoogleTest Topics](guides/advanced.md#more-assertions).

For death tests best practices and configuration, see [Death Tests Guide](guides/parameterization-and-patterns/death-tests.md).

