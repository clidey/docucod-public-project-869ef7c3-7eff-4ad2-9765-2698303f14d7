---
title: "Error Handling and Status Codes"
description: "Documents the error handling model, supported status codes, and result interpretation policies in GoogleTest and GoogleMock. Guides users in diagnosing failures, managing flaky tests, and customizing error reporting."
---

# Error Handling and Status Codes

GoogleTest and GoogleMock provide a robust error handling model, detailed status reporting, and flexible policies for interpreting test results. This documentation page focuses specifically on how errors are reported, the various status codes used during test execution, and strategies to diagnose failures, handle intermittent (flaky) tests, and customize error outputs to suit your workflow.

---

## Overview of the Error Handling Model

GoogleTest’s approach to error handling centers around assertions, test results, and event notifications. When a failure occurs, GoogleTest logs detailed failure messages including stack traces and file locations to help you quickly identify the source of the problem.

Failures are categorized as either fatal or non-fatal:

- **Fatal Failures** (e.g., from `ASSERT_*` macros) abort the current function immediately.
- **Non-fatal Failures** (e.g., from `EXPECT_*` macros) report the failure but allow the test to proceed.

Errors related to mocks in GoogleMock, such as unexpected or excessive calls, also follow this model but include additional verbose output based on verbosity settings.


## Supported Status Codes and Test Results

GoogleTest maintains rich internal information about each test’s execution, summarized via distinct status codes and categories that can be queried programmatically.

### TestPartResult Types

Each assertion or failure produces a `TestPartResult` with the following types:

- `kSuccess`: The assertion succeeded.
- `kNonFatalFailure`: A non-fatal failure (e.g., `EXPECT_*`).
- `kFatalFailure`: A fatal failure (e.g., `ASSERT_*`).
- `kSkip`: The test or part of it was skipped via `GTEST_SKIP()`.

This granular status enables test frameworks and tooling to differentiate between failure severities and skipped tests.

### Test and TestSuite Status

At higher levels, `TestResult` summarises the overall status:

- **Passed**: No failing assertions.
- **Failed**: Contains at least one failure.
- **Skipped**: Contains skip markers.

GoogleTest reports these as status strings such as `RUN`, `NOTRUN`, `PASSED`, `FAILED`, or `SKIPPED` in both console outputs and XML/JSON reports.


## Diagnosing Failures

GoogleTest and GoogleMock provide rich diagnostics when failures occur; understanding how to interpret these messages is critical for efficient debugging.

### Failure Messages

Failure messages include:

- The exact expression or function call that failed.
- Actual and expected values.
- File and line number locations.
- User-streamed custom messages to assertions.
- Stack traces when enabled or verbosity is high.

#### GoogleMock Specific Messages

Mock failures (such as unexpected calls or argument mismatches) provide verbose explanation including:

- The nature of the mismatch (unexpected call, excessive call, argument mismatch).
- Detailed matching attempts against all expectations.
- Whether an expectation was retired, unsatisfied, or saturated.
- Function names, arguments, and their expected states.


### Common Failure Scenarios

#### Propagating Fatal Failures

Fatal failures stop only the current function, not the entire test. To ensure that failures in helper functions cause test aborts, make use of:

- Exception throwing listeners
- `ASSERT_NO_FATAL_FAILURE()` checks
- The `HasFatalFailure()` API


#### Catching Failures for Custom Testing Utilities

For utilities built on top of GoogleTest, macros like `EXPECT_FATAL_FAILURE` and `EXPECT_NONFATAL_FAILURE` (from `gtest-spi.h`) help verify that failures are correctly reported during execution.


## Managing Flaky Tests and Automatic Retry

Intermittent failures can severely hamper productivity. GoogleTest provides mechanisms to help diagnose and attempt to reproduce flaky tests.

### Repeating Tests

Use the flag `--gtest_repeat=<count>` to run tests multiple times. This helps:

- Expose flakes by forcing multiple executions.
- Combine with `--gtest_break_on_failure` to drop into the debugger on first failure.
- Control global environment setup and teardown between runs via `--gtest_recreate_environments_when_repeating`.


### Shuffling Tests

Run tests in a random order using `--gtest_shuffle`, combined with `--gtest_random_seed`, to detect inter-test dependencies causing flaky behavior.


## Customizing Error Reporting

You can tailor how errors and failures are reported to match your workflow.

### Using Event Listeners

GoogleTest provides an event listener interface allowing:

- Capturing and redirecting error messages.
- Building custom reporters, GUIs, or integrating with external dashboards.
- Filtering or augmenting failure messages.


### Controlling Verbosity and Output Formatting

- GoogleTest prints colored and formatted output by default, with options to disable (`--gtest_color=no`).
- Use `--gtest_brief=1` to only print failures.
- Generate detailed XML or JSON reports (`--gtest_output=xml:<file>` or `json:<file>`).


### Break on Failure and Throw on Failure

- `--gtest_break_on_failure` induces a debugger trap at failure.
- `--gtest_throw_on_failure` turns failures into exceptions (requires exceptions enabled in build), useful when embedding GoogleTest into other frameworks.


## Handling Skipped Tests

Use the macro `GTEST_SKIP()` within tests or `SetUp()` routines to mark tests as skipped at runtime, optionally supplying a custom skip message.

For example:

```cpp
TEST(MyTest, ConditionalSkip) {
  if (!IsEnvironmentSupported()) {
    GTEST_SKIP() << "Environment not supported";
  }
  // rest of test
}
```

Skipped tests are reported distinctly in output and reports.


## GoogleMock Specific Error Handling and Status Codes

### Uninteresting Calls

GoogleMock categorizes mock function calls as:

- **Expected Calls**: Calls that fulfill existing expectations.
- **Uninteresting Calls**: Calls without expectations but allowed.
- **Unexpected Calls**: Calls that violate expectations.
- **Excessive Calls**: Calls beyond the defined call count.

Depending on the verbosity flag (`--gmock_verbose`), warnings or failures are shown for uninteresting calls, helping control test noise.


### Mock Call Failure Message Structure

Failure messages include:
- The function call.
- Expected arguments and actual arguments.
- The state of expectations (active, retired, saturated, unsatisfied).
- For excessive calls, the number of times the method was called compared to expectations.


## Debugging Practices and Common Pitfalls

- Bear in mind that fatal assertions abort only current function, not entire test execution.
- Avoid using fatal assertions in non-void returning functions; use non-fatal assertions or adjust function signatures.
- Leaked mocks cause test failures unless allowed via `Mock::AllowLeak()`.
- Multiple death tests in a suite should be named with the `DeathTest` suffix to ensure proper ordering.


## Practical Tips

- Use the `HasFatalFailure()` API to control the flow of a test after a fatal assertion.
- When developing custom assertions, use `AssertionResult` to provide detailed failure messages.
- Leverage XML/JSON test reports for integration with CI/CD tools and dashboards.
- Use `SCOPED_TRACE` macro to add trace context for failures within helper functions.


## Examples

### Using `EXPECT_FATAL_FAILURE` to test that a failure is produced

```cpp
EXPECT_FATAL_FAILURE(
    { EXPECT_EQ(1, 2); }, "Expected: 1 == 2");
```

### Skipping a test gracefully

```cpp
TEST(FooTest, ConditionalSkip) {
  if (SomeExternalCondition()) {
    GTEST_SKIP() << "Skipping due to external condition";
  }
  // Test code
}
```

### Writing a death test to verify fatal termination

```cpp
TEST(DeathTestSample, DiesOnInvalidInput) {
  ASSERT_DEATH(SomeFunction(-1), "Invalid input");
}
```

### Controlling mock call expectations and diagnosing failures

```cpp
class MockFoo {
 public:
  MOCK_METHOD(int, Bar, (int));
};

TEST(MockTest, CallsExpected) {
  MockFoo mock;
  EXPECT_CALL(mock, Bar(42)).Times(1);

  mock.Bar(42);  // OK
  mock.Bar(43);  // Fails: unexpected call
}
```


---

For comprehensive usage details, refer to:

- [Assertions Reference](../core-testing-apis/assertions.md)
- [Advanced GoogleTest Topics](../advanced.md)
- [Mocking Reference](../mocking-and-matchers/mock-methods.md)
- [GoogleMock Strictness Modes](../mocking-and-matchers/mock-strictness.md)

Explore the sections on test output control and event listeners to tailor error reporting and failure handling to your project needs.


### Response Structure

This documentation page is designed to empower you with in-depth knowledge of GoogleTest and GoogleMock error semantics, enabling precise failure diagnosis and control over flaky tests through powerful features like repeated execution, test shuffling, skipping, and customized reporting.


---

<Info>
GoogleTest's error model emphasizes clear failure messages, stack traces, and rich failure types, while GoogleMock extends this with detailed call expectation diagnostics. Customize your reports with listeners and flags for the best developer experience.
</Info>
