---
title: "Test Output and Logging"
description: "Documents APIs and output helpers for formatting, capturing, and customizing test output. Includes message-building, custom printers, and utilities for managing XML/JSON outputs."
---

# Test Output and Logging

GoogleTest provides a robust set of APIs and utilities for managing, formatting, capturing, and customizing test output. Whether you want to build rich failure messages, implement custom output printers, generate structured XML/JSON reports, or capture standard output streams during test execution, these components give you precise control over how test results are reported and consumed.

---

## Message Building and Failure Descriptions

### Building Informative Messages

GoogleTest's core unit for failure reporting is the `Message` class, which lets you construct and stream complex diagnostic messages safely and with high precision:

```cpp
::testing::Message msg;
msg << "Expected value but got " << actual_value;
std::string failure_msg = msg.GetString();
```

This supports streaming wide characters, UTF-8 conversion, and handles null characters gracefully.

### Appending User Messages

You can append user-supplied messages to GoogleTest-generated failure strings to enrich diagnostics:

```cpp
std::string AppendUserMessage(const std::string& gtest_msg, const Message& user_msg);
```

This function merges the detailed GoogleTest failure message with any extra contextual information you provide.

### Equality and Boolean Assertion Messages

For binary comparisons (like `EXPECT_EQ`), GoogleTest constructs detailed diff messages even when output values span multiple lines:

```cpp
AssertionResult EqFailure(const char* expr1, const char* expr2,
                          const std::string& val1, const std::string& val2,
                          bool ignoring_case);
```

Boolean assertions such as `EXPECT_TRUE` use:

```cpp
std::string GetBoolAssertionFailureMessage(const AssertionResult& result,
                                           const char* expr_text,
                                           const char* actual_val,
                                           const char* expected_val);
```

which include actual and expected values alongside the Boolean expression.

---

## Output Customization: Event Listeners and Printers

GoogleTest structures output via listeners that respond to test events, enabling you to customize or replace the default console output.

### Default Result Printers

GoogleTest ships with two main printer implementations:

- **PrettyUnitTestResultPrinter**: The default verbose output, showing test progress, failures with stack traces, and summary.
- **BriefUnitTestResultPrinter**: Produces minimal output, showing only failures.

You can swap these by releasing the default printer and appending your own:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  auto& listeners = ::testing::UnitTest::GetInstance()->listeners();
  delete listeners.Release(listeners.default_result_printer());
  listeners.Append(new YourCustomPrinter());
  return RUN_ALL_TESTS();
}
```

### Implementing Custom Printers

Create a class inheriting from `TestEventListener` or `EmptyTestEventListener` and override events such as:

- `OnTestProgramStart`
- `OnTestStart`
- `OnTestPartResult`
- `OnTestEnd`
- `OnTestProgramEnd`

The `sample9_unittest.cc` demonstrates a terse printer that prints minimal progress messages.

<Accordion title="Minimal Custom Printer Skeleton">
```cpp
class MinimalPrinter : public ::testing::EmptyTestEventListener {
public:
  void OnTestStart(const ::testing::TestInfo& test_info) override {
    // e.g., log test start
  }
  void OnTestPartResult(const ::testing::TestPartResult& result) override {
    // e.g., print assertion failures
  }
  void OnTestEnd(const ::testing::TestInfo& test_info) override {
    // e.g., log test end
  }
};
```
</Accordion>

---

## Structured Test Outputs: XML and JSON Reports

GoogleTest can generate machine-readable XML or JSON test reports, useful for CI systems or other tools.

### Enabling Output Generation

Set the `--gtest_output` flag to one of the following:

- `xml:path/to/output.xml`
- `json:path/to/output.json`
- `xml` or `json` (defaults to current directory with appropriate filename)

For example:

```bash
./your_test --gtest_output=xml:output/test_results.xml
```

### XML Report

The XML report adheres loosely to a [JUnit-style XML schema](https://github.com/google/googletest/blob/main/docs/advanced.md#generating-an-xml-report). It includes:

- `<testsuites>`: The entire test run
- `<testsuite>`: A test suite containing multiple tests
- `<testcase>`: Individual test with result attributes
- `<failure>` and `<skipped>`: Failure and skipped test details

The report includes attributes like test names, file, line, time, and more.

The `XmlUnitTestResultPrinter` class handles this generation.

### JSON Report

Similarly, GoogleTest can produce JSON reports, following a defined schema compatible with protos. Set `--gtest_output=json[:path]` to enable.

The `JsonUnitTestResultPrinter` class creates JSON output with the same test suite and test case structure.

---

## Capturing stdout and stderr

GoogleTest supports capturing output streams during tests to verify or suppress output:

```cpp
// Start capturing stdout
::testing::internal::CaptureStdout();

std::cout << "Hello world";

// Stop capturing and get the output
std::string output = ::testing::internal::GetCapturedStdout();
```

The analogous functions exist for stderr capturing.

This is useful for tests that verify console output without polluting the test logs.

---

## Specialized Output: Streaming and Stack Traces

### Streaming Results

On supported platforms (Linux/macOS), GoogleTest can stream test events to a socket via `--gtest_stream_result_to=host:port`. You can implement real-time dashboards or external handlers. This feature encodes messages with URL-escaped key-value pairs.

### Stack Traces

Failure messages include optional OS stack traces captured at the failure point to improve debugging. GoogleTest supports multiple OS-specific implementations to generate stack traces.

Users can enable or disable internal stack frames display via flags.

---

## Utilities and Helpers

### Test Properties

GoogleTest lets you attach custom key/value properties during test execution for richer reports using:

```cpp
::testing::Test::RecordProperty("Key", "Value");
```

Properties recorded during a test are emitted as XML attributes in reports.

### Colored Output

By default, GoogleTest uses colored output for improved readability. Control this behavior with `--gtest_color` (`yes`, `no`, `auto`).

### Formatting Helpers

GoogleTest includes string formatting helpers:

- `FormatIntWidth2(int)` — pad integers to width 2
- `FormatHexUInt32(uint32_t)` — format integers in uppercase hex
- `StripTrailingSpaces(std::string)` — trim trailing whitespace

These are leveraged internally for consistent output.

---

## Best Practices and Tips

- **Use event listeners** when you need to customize test output format or destination.
- **Leverage structured output (XML/JSON)** for integrating test results with CI systems.
- **Use message streaming** for detailed and informative failure diagnostics.
- When capturing stdout/stderr, remember to stop capture and fetch output promptly to avoid conflicts.
- Enable colored output only if your terminal supports it.
- Extend the `TestEventListener` interface to build custom reporters to fit your test infrastructure needs.

---

## Troubleshooting

- **No output or incomplete output:** Check that your listener is attached correctly and that the default printer is not conflicting.
- **Malformed XML/JSON:** Ensure that test properties use valid XML attribute names and no reserved keys.
- **Output not showing custom messages:** Use `AppendUserMessage` or stream into assertions to include your context.

---

For further information and practical examples, refer to the [Test Output and Logging](./api-reference/specialized-testing-apis/test-output-and-logging.md) guide and `sample9_unittest.cc` for implementing custom printers.

---

[Go to Assertions Reference](reference/assertions.md) | [Testing Reference](docs/reference/testing.md) | [Sample9 Unittest Example](googletest/samples/sample9_unittest.cc)
