---
title: "Assertions & Predicates"
description: "Details all available assertions for verifying test expectations, including checks for equality, exceptions, predicates, and failures. Explains the use of fatal and non-fatal assertion macros."
---

# Assertions & Predicates

GoogleTest assertions let you verify your code's behavior with concise, expressive macros. This page details all available assertions for verifying test expectations, including checks for equality, exceptions, predicates, and failures. These assertions come in two variants: nonfatal (`EXPECT_`) and fatal (`ASSERT_`), enabling you to control the flow upon failure.

---

## Overview

GoogleTest provides a rich set of assertion macros designed to help you check various conditions in your C++ tests, report failures with meaningful messages, and control test execution flow. Assertions fall broadly into the following categories:

- **Explicit Success and Failure** — Generate success or failure directly.
- **Boolean Conditions** — Check truthiness or falseness.
- **Binary Comparison** — Compare two values with relational operators.
- **String Comparison** — Compare C strings, with or without case sensitivity.
- **Floating-Point Comparison** — Specialized macros handling rounding errors.
- **Exception Assertions** — Verify exception throwing behavior.
- **Predicate Assertions** — For custom predicate functions with rich messages.
- **Windows HRESULT Assertions** — Verify success or failure in Windows HRESULT values.
- **Death Assertions** — Validate that code crashes or exits as expected.
- **Generalized Assertions** — Use matchers for powerful and expressive checks.

All assertion macros support streaming a custom failure message using `<<` for clear diagnostics.

## Explicit Success and Failure

Sometimes you want to mark a test as succeeded or failed without using a Boolean expression. GoogleTest provides the following macros for explicit success or failure:

### SUCCEED()

`SUCCEED()` generates a documented success within a test.

Note: This does *not* cause the entire test to pass — only that this point was reached successfully.

Example:
```cpp
SUCCEED() << "Reached this point without failure.";
```

### FAIL()

`FAIL()` generates a fatal failure and returns from the current function immediately.

Use only in `void` functions like test bodies.

Example:
```cpp
if (unexpected_condition) {
  FAIL() << "Unexpected condition encountered!";
}
```

### ADD_FAILURE()

`ADD_FAILURE()` generates a nonfatal failure allowing the test to continue running.

### ADD_FAILURE_AT(file, line)

`ADD_FAILURE_AT("file.cc", 42)` generates a nonfatal failure at the specified file and line number. Useful to report failures indirectly.

## Generalized Assertion with Matchers

### EXPECT_THAT(value, matcher)

`EXPECT_THAT` and `ASSERT_THAT` enable verification of values against powerful matchers, which can test complex conditions like collections, regex matches, ranges, and more.

Example:
```cpp
#include <gmock/gmock.h>
using ::testing::StartsWith;

EXPECT_THAT(my_string, StartsWith("Hello"));
```

This produces clear, English-like error messages for mismatches.

## Boolean Condition Assertions

### EXPECT_TRUE(condition)

Verifies that `condition` is true.

### EXPECT_FALSE(condition)

Verifies that `condition` is false.

`ASSERT_TRUE` and `ASSERT_FALSE` are the fatal variants.

Example:
```cpp
EXPECT_TRUE(is_valid) << "is_valid must be true";
ASSERT_FALSE(has_error) << "Should not have error";
```

## Binary Comparison Assertions

These macros compare two values using relational operators, printing their values on failures.

| Macro        | Meaning                                |
| ------------ | --------------------------------------|
| `EXPECT_EQ`  | Checks for equality (`==`)             |
| `EXPECT_NE`  | Checks for inequality (`!=`)           |
| `EXPECT_LT`  | Checks if less than (`<`)              |
| `EXPECT_LE`  | Checks if less or equal (`<=`)         |
| `EXPECT_GT`  | Checks if greater than (`>`)           |
| `EXPECT_GE`  | Checks if greater or equal (`>=`)      |

Corresponding `ASSERT_` macros exist which abort on failure.

**Important:**
- Pointer equality is by address.
- Use `EXPECT_STREQ` for C string equality.

Example:
```cpp
EXPECT_EQ(result, expected) << "Result differs from expected";
ASSERT_LT(value, limit);
```

## String Comparison Assertions

Specialized for **C strings** (`const char*`), with wide string support.

| Macro             | Meaning                                |
| ----------------- | --------------------------------------|
| `EXPECT_STREQ`    | C string equality (content)            |
| `EXPECT_STRNE`    | C string inequality (content)          |
| `EXPECT_STRCASEEQ`| Case-insensitive equality              |
| `EXPECT_STRCASENE`| Case-insensitive inequality            |

Use these macros when comparing C strings. For `std::string`, use `EXPECT_EQ`.

Example:
```cpp
EXPECT_STREQ(c_str1, c_str2) << "Strings should be equal";
ASSERT_STRCASEEQ(header1, header2);
```

## Floating-Point Comparison Assertions

Because floating-point comparisons must account for rounding errors, GoogleTest provides specialized comparators.

| Macro          | Purpose                                              |
| -------------- | ----------------------------------------------------|
| `EXPECT_FLOAT_EQ`   | Checks float equality within 4 ULPs                |
| `EXPECT_DOUBLE_EQ`  | Checks double equality within 4 ULPs               |
| `EXPECT_NEAR`       | Checks difference within absolute error bound      |

`ASSERT_` variants are available.

Example:
```cpp
EXPECT_FLOAT_EQ(computed_float, expected_float);
EXPECT_NEAR(computed_double, expected_double, 1e-5);
```

### Notes:
- Infinity values are treated specially.
- Always choose an appropriate error bound for `EXPECT_NEAR`.

## Exception Assertions

These macros test for exception throwing behavior (requires exceptions enabled).

| Macro             | Expected Behavior                                |
| ----------------- | -----------------------------------------------|
| `EXPECT_THROW(stmt, exception_type)`   | *stmt* must throw *exception_type*             |
| `EXPECT_ANY_THROW(stmt)`                | *stmt* must throw any exception                 |
| `EXPECT_NO_THROW(stmt)`                 | *stmt* must not throw any exception             |

Use `ASSERT_` variants for fatal failures.

Example:
```cpp
EXPECT_THROW(DoSomething(), std::runtime_error);
EXPECT_NO_THROW(SafeOperation());
```

## Predicate Assertions

For complex custom predicates where Boolean conditions lose useful diagnostics, predicate assertions provide better failure messages by printing argument values.

There are two flavors:

- **Predicate assertions:** Use `EXPECT_PREDn` or `ASSERT_PREDn`, where `n` is number of parameters (1 to 5). The predicate is a function or functor returning `bool`.

- **Predicate-formatter assertions:** Use `EXPECT_PRED_FORMATn` or `ASSERT_PRED_FORMATn` for predicates returning `testing::AssertionResult` to customize failure messages fully.

Example for predicate assertion:
```cpp
bool IsEven(int n) { return (n % 2) == 0; }
EXPECT_PRED1(IsEven, value);
```

Example for predicate-formatter assertion:
```cpp
testing::AssertionResult AssertIsEven(const char* expr, int n) {
  if ((n % 2) == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr << " is not even, got " << n;
}
EXPECT_PRED_FORMAT1(AssertIsEven, value);
```

These macros print useful error messages showing the values of arguments on failure.

### Tips
- Overloaded or template predicates may require explicit type specifications.
- Arguments are evaluated exactly once.

## Windows HRESULT Assertions

On Windows, you can test if `HRESULT` values indicate success or failure.

| Macro                   | Meaning                          |
| ----------------------- | --------------------------------|
| `EXPECT_HRESULT_SUCCEEDED` | Passes if HRESULT succeeds      |
| `EXPECT_HRESULT_FAILED`    | Passes if HRESULT fails         |

Use corresponding `ASSERT_` variants.

Example:
```cpp
ASSERT_HRESULT_SUCCEEDED(CoCreateInstance(...));
EXPECT_HRESULT_FAILED(SomeFunction());
```

The failure output includes descriptive system error messages.

## Death Assertions

GoogleTest supports assertions that verify your code terminates abnormally, known as *death tests*. These spawn child processes to check exit status and stderr output using regular expressions or matchers.

| Macro                       | Description                                            |
| --------------------------- | ------------------------------------------------------|
| `EXPECT_DEATH(statement, matcher)`             | Verifies `statement` crashes; matches stderr via `matcher`.
| `EXPECT_DEATH_IF_SUPPORTED(statement, matcher)`| Same as `EXPECT_DEATH` if death tests supported, else does nothing.
| `EXPECT_DEBUG_DEATH(statement, matcher)`       | Runs in debug mode only.
| `EXPECT_EXIT(statement, predicate, matcher)`   | Verifies `statement` exits with status matching `predicate` and output matching `matcher`.

Example:
```cpp
EXPECT_DEATH(MyFunctionThatShouldAbort(), "Fatal error");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

### Notes
- Test suite names ending with `DeathTest` are run first.
- Death tests are run in new processes to isolate crashes.
- Multi-threading considerations have led to different death test styles (`fast` and `threadsafe`).

## Using Assertions in Test Code

- `EXPECT_*` generates nonfatal failures, letting tests continue.
- `ASSERT_*` generates fatal failures, aborting the current function.
- Use `ASSERT_*` when continuing makes no sense or risks crashes.

You can append custom failure messages with `<<` on the assertion macros.

## Best Practices and Tips

- Use nonfatal assertions when you want to check multiple conditions in a test.
- Use fatal assertions when subsequent code depends on the assertion.
- For complex conditions, consider **predicate assertions** or **predicate-formatters** for more informative failures.
- Use `SCOPED_TRACE()` or `ScopedTrace` to add context traces for failures in helper functions.
- Avoid placing fatal assertions in constructors or destructors.

## Example Usage

```cpp
TEST(FactorialTest, Basic) {
  EXPECT_EQ(Factorial(1), 1);
  ASSERT_GT(Factorial(2), 1) << "Factorial of 2 must be > 1";

  int n = 3;
  EXPECT_PRED1(IsEven, n) << "Number should be even";

  EXPECT_THROW(MightThrow(true), std::runtime_error);

  SUCCEED() << "Reached the end of FactorialTest.Basic successfully.";
}

bool IsPositive(int n) {
  return n > 0;
}

TEST(PositiveTest, Check) {
  EXPECT_PRED1(IsPositive, 5);
}
```

## Troubleshooting Common Issues

- Using `ASSERT_*` macros in non-void functions will cause compiler errors.
- Assertions on C strings require `EXPECT_STREQ` / `ASSERT_STREQ` instead of `EXPECT_EQ`.
- Floating-point values should use specialized assertions like `EXPECT_FLOAT_EQ` instead of `EXPECT_EQ`.
- For predicate assertions, ensure that predicates do not have overloaded versions ambiguously.

---

For complete details, see the linked sections below.

---

### Related Links

- [GoogleTest Primer (primer.md)](/docs/primer.md)
- [Assertions Reference](reference/assertions.md)
- [Matchers Reference](reference/matchers.md)
- [GoogleMock Mocking Reference](reference/mocking.md)
- [Core Testing API](api-reference/core-test-api/assertions.md)
- [Advanced Guide: More Assertions](guides/core-workflows/assertions-best-practices.md)
- [Writing Custom Matchers](api-reference/assertions-and-matchers/custom-matchers.md)

---