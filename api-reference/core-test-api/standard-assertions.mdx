---
title: "Assertions and Matchers"
description: "Explains Google's rich set of assertions (equality, inequality, exceptions, floating-point, etc.) and built-in matchers. Covers macro usage, expected outcomes, and demonstrates with concise code examples."
---

# Assertions and Matchers Reference

This reference page provides a comprehensive overview of GoogleTest’s powerful assertions and matchers, essential for verifying your code’s behavior effectively. Assertions come in pairs—`EXPECT_` for nonfatal failures and `ASSERT_` for fatal failures—and support detailed failure messages. Matchers enable expressive checks on argument values and containers, helping tests communicate intent clearly.

---

## 1. Explicit Success and Failure Assertions

Use these to generate explicit success or failure conditions without testing a value.

### SUCCEED

```cpp
SUCCEED();
```
Generates a success. Useful for documenting that a point in code is reached.

### FAIL

```cpp
FAIL();
```
Generates a fatal failure and aborts the current function, useful for unreachable code sections.

### ADD_FAILURE

```cpp
ADD_FAILURE();
```
Generates a nonfatal failure and allows continued execution.

### ADD_FAILURE_AT

```cpp
ADD_FAILURE_AT("file.cpp", 123);
```
Generates a nonfatal failure reported at a specific file and line.

---

## 2. Generalized Assertions with Matchers

### EXPECT_THAT and ASSERT_THAT

```cpp
EXPECT_THAT(value, matcher);
ASSERT_THAT(value, matcher);
```

Check that `value` matches the `matcher`. Matchers enable readable, composable predicates that produce detailed failure messages.

Example:

```cpp
using ::testing::StartsWith;
using ::testing::MatchesRegex;
using ::testing::AllOf;
using ::testing::Gt;
using ::testing::Lt;

EXPECT_THAT(str, StartsWith("Hello"));
EXPECT_THAT(email, MatchesRegex("[\\w.-]+@[\\w.-]+\\.com"));
ASSERT_THAT(num, AllOf(Gt(5), Lt(10)));
```

If an assertion fails, the failure message will clearly describe the expectations versus actual values, easing debugging.

---

## 3. Boolean Condition Assertions

Verify simple true/false conditions.

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

Example:

```cpp
EXPECT_TRUE(is_connected);
ASSERT_FALSE(error_occurred);
```

---

## 4. Binary Comparison Assertions

Compare two values using common comparison operators. Operands must be comparable.

| Assertion       | Description                |
|-----------------|----------------------------|
| `EXPECT_EQ` / `ASSERT_EQ` | Checks equality (`==`)     |
| `EXPECT_NE` / `ASSERT_NE` | Checks inequality (`!=`)   |
| `EXPECT_LT` / `ASSERT_LT` | Checks less than (`<`)     |
| `EXPECT_LE` / `ASSERT_LE` | Checks less or equal (`<=`)|
| `EXPECT_GT` / `ASSERT_GT` | Checks greater than (`>`)  |
| `EXPECT_GE` / `ASSERT_GE` | Checks greater or equal (`>=`)|

**Note: For C strings, use the string-specific macros below.**

Example:

```cpp
EXPECT_EQ(result, expected);
ASSERT_NE(ptr, nullptr);
EXPECT_LT(index, max_size);
```

---

## 5. C String Comparison Assertions

Specially compare C strings by contents, not pointer values.

| Assertion            | Description                                 |
|----------------------|---------------------------------------------|
| `EXPECT_STREQ` / `ASSERT_STREQ`   | Checks equality of C strings (strcmp == 0)    |
| `EXPECT_STRNE` / `ASSERT_STRNE`   | Checks inequality of C strings (strcmp != 0)  |
| `EXPECT_STRCASEEQ` / `ASSERT_STRCASEEQ` | Checks equality ignoring case                   |
| `EXPECT_STRCASENE` / `ASSERT_STRCASENE` | Checks inequality ignoring case                 |

Example:

```cpp
EXPECT_STREQ(c_str, "hello");
ASSERT_STRNE(c_str, "goodbye");
```

---

## 6. Floating-Point Comparisons

Due to rounding errors, direct equality checks are unreliable for floats/doubles.

| Assertion            | Description                              |
|----------------------|------------------------------------------|
| `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ`     | Checks float equality within 4 ULPs       |
| `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ`   | Checks double equality within 4 ULPs      |
| `EXPECT_NEAR` / `ASSERT_NEAR`              | Checks difference within an absolute error |

Example:

```cpp
EXPECT_FLOAT_EQ(a, b);
ASSERT_DOUBLE_EQ(x, y);
EXPECT_NEAR(pi, 3.14, 0.01);
```

---

## 7. Exception Assertions

Verify whether a statement throws or does not throw exceptions.

| Assertion              | Description            |
|------------------------|------------------------|
| `EXPECT_THROW` / `ASSERT_THROW` | Verifies statement throws specific exception |
| `EXPECT_ANY_THROW` / `ASSERT_ANY_THROW` | Verifies statement throws any exception       |
| `EXPECT_NO_THROW` / `ASSERT_NO_THROW` | Verifies statement throws no exception        |

Example:

```cpp
EXPECT_THROW(foo.Bar(), std::runtime_error);
ASSERT_NO_THROW(foo.Baz());
```

You can use compound statements with braces for complex scenarios.

---

## 8. Predicate Assertions

Use predicates or predicate-formatters to perform complex condition checks with detailed failure messages.

### EXPECT_PRED*

Accepts predicates with 1 to 5 arguments. They must return `true` or `false`.

Example:

```cpp
bool IsPrime(int n);
EXPECT_PRED1(IsPrime, 7);
```

### EXPECT_PRED_FORMAT*

More powerful; uses a predicate-formatter that returns a reusable assertion result including custom failure messages.

Example:

```cpp
testing::AssertionResult AssertIsPrime(const char* expr, int n) {
  if (IsPrime(n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr << " is not prime";
}
EXPECT_PRED_FORMAT1(AssertIsPrime, number);
```

---

## 9. Windows HRESULT Assertions

Verify success or failure of `HRESULT` expressions in Windows.

- `EXPECT_HRESULT_SUCCEEDED(expr)` / `ASSERT_HRESULT_SUCCEEDED(expr)`
- `EXPECT_HRESULT_FAILED(expr)` / `ASSERT_HRESULT_FAILED(expr)`

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

---

## 10. Death Assertions

Verify that a statement causes the process to terminate (crash or exit).

| Assertion                  | Description                                             |
|----------------------------|---------------------------------------------------------|
| `EXPECT_DEATH` / `ASSERT_DEATH`           | Verifies process terminates with matching stderr output  |
| `EXPECT_DEATH_IF_SUPPORTED` / `ASSERT_DEATH_IF_SUPPORTED` | Same as above if death test supported, otherwise no-op |
| `EXPECT_DEBUG_DEATH` / `ASSERT_DEBUG_DEATH`           | Verifies death only in debug mode                         |
| `EXPECT_EXIT` / `ASSERT_EXIT`             | Verifies process exits with code and matching stderr     |

Example:

```cpp
EXPECT_DEATH({ DoSomething(42); }, "Error on line .* of DoSomething()");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
```

---

# Practical Examples

```cpp
// Basic Boolean assertion
EXPECT_TRUE(IsConnected()) << "Connection failed";

// String match with matcher
EXPECT_THAT(response, StartsWith("OK"));

// Numeric comparison
ASSERT_GT(value, 10);

// Floating point near comparison
EXPECT_NEAR(CalculatedPi(), 3.14159, 0.00001);

// Exception handling
EXPECT_THROW(Foo(), std::logic_error);

// Callback invocation
EXPECT_CALL(mock, ProcessData(_)).Times(3).WillRepeatedly(Return(true));
```

---

# Common Troubleshooting Tips

- For floating-point comparisons, prefer `EXPECT_NEAR` or `EXPECT_FLOAT_EQ` over `EXPECT_EQ` to avoid false failures due to rounding.
- When matching strings, always use the appropriate string comparison macros, not pointer equality.
- Use `EXPECT_THAT` with matchers when validating complex objects or containers.
- Remember that `ASSERT_` macros abort the current function, so use them when failure should halt test execution immediately.

# Best Practices

- Use `EXPECT_` variants when you want tests to continue despite failure, enabling multiple checks per test.
- Over-specifying matchers or call counts leads to brittle tests; specify only what matters.
- Use custom matchers and predicates to express domain-specific validation clearly.
- Leverage `EXPECT_THAT` and matchers for readable and maintainable tests.

---

# Additional Resources

- [Matchers Reference](matchers.md): Full list of available matchers.
- [Mocking Reference](mocking.md): For integrating matchers into mock expectations.
- [gMock Cookbook](gmock_cook_book.md): Recipes for mocks, actions, and advanced usage.
- [Using Assertions and Matchers Effectively](../guides/core-testing-patterns/using-assertions-and-matchers.md): Guide with practical strategies.

---

# See Also

- [GoogleMock: Expectations, Actions, and Sequences](reference/mocking-framework-api/expectations-actions-sequences.md) for testing interactions.
- [Assertions and Matchers](reference/core-test-api/standard-assertions.md) overview.

{/* EOF */}