---
title: "Built-in Matchers"
description: "Lists all standard matchers provided by GoogleTest and GoogleMock, with syntax, example usages, and notes on when to use each. Provides quick lookup tables for matching common argument types and behaviors."
---

# Built-in Matchers

GoogleTest and GoogleMock provide a rich set of built-in matchers that simplify checking expected argument values in mock function calls or in assertions. These matchers improve test readability and produce clear, informative failure messages.

---

## Overview

Matchers allow you to specify flexible, readable conditions under which function arguments are considered a match. Instead of exact values, you can write expressive conditions like "greater than 5", "starts with Hi", or "contains substring foo".

Matchers can be used with **EXPECT_CALL** to set expectations on mock methods, or with **EXPECT_THAT** and **ASSERT_THAT** for regular assertions.

---

## Common Matchers and Usage

### Wildcard Matcher

- **`_`**
  - Matches any argument of any type.
  - Usage:

    ```cpp
    EXPECT_CALL(mock, DoThis(_, NotNull()));
    ```

### Equality and Comparison

| Matcher               | Description                                | Example Usage                         |
|-----------------------|--------------------------------------------|-------------------------------------|
| `Eq(value)`           | Matches exactly equal to `value`.         | `EXPECT_CALL(mock, Foo(Eq(5)));`    |
| `Ne(value)`           | Matches not equal to `value`.              | `EXPECT_THAT(val, Ne(0));`           |
| `Lt(value)`           | Matches less than `value`.                  | `EXPECT_CALL(mock, Bar(Lt(10)));`   |
| `Le(value)`           | Matches less than or equal to `value`.     | `EXPECT_THAT(val, Le(20));`          |
| `Gt(value)`           | Matches greater than `value`.               | `EXPECT_CALL(mock, Baz(Gt(0)));`    |
| `Ge(value)`           | Matches greater than or equal to `value`.  | `EXPECT_THAT(val, Ge(42));`          |

> **Note:** These matchers are polymorphic over types that support the respective operators.

### Range and Logical Combinators

- `AllOf(m1, m2, ...)`
  - Matches if **all** sub-matchers match.
  - Example: `EXPECT_THAT(x, AllOf(Gt(0), Lt(10)));`

- `AnyOf(m1, m2, ...)`
  - Matches if **any** sub-matcher matches.
  - Example: `EXPECT_THAT(y, AnyOf(Eq(5), Eq(7)));`

- `Not(m)`
  - Matches if the sub-matcher does **not** match.
  - Example: `EXPECT_CALL(mock, Func(Not(Eq(0))));`

### String Matchers

| Matcher           | Description                                          | Example Usage                          |
|-------------------|------------------------------------------------------|--------------------------------------|
| `StrEq(str)`      | Matches string exactly equal to `str` (case-sensitive). | `EXPECT_THAT(s, StrEq("hello"));`  |
| `StrNe(str)`      | Matches string not equal to `str` (case-sensitive).       | `EXPECT_THAT(s, StrNe("bye"));`    |
| `StrCaseEq(str)`  | Matches string equal to `str` ignoring case.         | `EXPECT_THAT(s, StrCaseEq("Hi"));` |
| `StrCaseNe(str)`  | Matches string not equal to `str` ignoring case.     | `EXPECT_THAT(s, StrCaseNe("Hi"));` |
| `StartsWith(prefix)` | Matches strings starting with `prefix`.            | `EXPECT_THAT(s, StartsWith("pre"));`|
| `EndsWith(suffix)`   | Matches strings ending with `suffix`.               | `EXPECT_THAT(s, EndsWith("fix"));` |
| `HasSubstr(substr)`  | Matches strings that contain `substr`.              | `EXPECT_THAT(s, HasSubstr("bar"));`|

> These string matchers work on C strings, `std::string`, and wide strings (if available).

### Pointer Matchers

- `IsNull()`
  - Matches any null pointer (raw or smart).
  - `EXPECT_CALL(..., PtrParam(IsNull()));`

- `NotNull()`
  - Matches any non-null pointer.

- `Pointee(matcher)`
  - Matches a pointer whose pointee value matches `matcher`.
  - Safe against null pointers (null fails the match).
  - Works with raw and smart pointers.
  - Example: `EXPECT_CALL(foo, Func(Pointee(Eq(42))));`

- `Pointer(matcher)`
  - Matches pointer value itself with `matcher`. 
  - Checks pointer address, not pointee.

### Reference Matcher

- `Ref(variable)`
  - Matches any argument referencing the given variable.
  - Useful to verify arguments passed by reference.

### Container and Collection Matchers

- `IsEmpty()`
  - Matches empty containers or empty strings.

- `SizeIs(size_matcher)`
  - Matches containers whose size matches `size_matcher`.
  - Example: `EXPECT_THAT(vec, SizeIs(Ge(3)));`

- `ElementsAre(m1, m2, ...)`
  - Matches containers whose elements exactly match the given matchers in order.
  - Example: `EXPECT_CALL(mock, Func(ElementsAre(1, 2, 3)));`

- `UnorderedElementsAre(m1, m2, ...)`
  - Matches containers whose elements match the given matchers in any order.

- `Contains(matcher)`
  - Matches containers containing at least one element matching `matcher`.

- `Each(matcher)`
  - Matches containers whose **every** element matches `matcher`.

- `Key(matcher)`
  - Matches a map element whose **key** matches `matcher`.

- `Pair(key_matcher, value_matcher)`
  - Matches a `std::pair` where the first and second field match respective matchers.

- `Pointwise(tuple_matcher, rhs_container)`
  - Matches containers where elements form pairs with `rhs_container` and each pair matches `tuple_matcher`.

- `UnorderedPointwise(tuple_matcher, rhs_container)`
  - Like `Pointwise` but ignores element order.

---

## Writing Expectations with Matchers

Matchers are most commonly supplied in `EXPECT_CALL` macros to verify the arguments passed into mock method calls.

```cpp
using ::testing::_;    // Wildcard
using ::testing::Gt;   // Greater than
using ::testing::HasSubstr;

EXPECT_CALL(mock, DoSomething(Gt(5), HasSubstr("ok"))); // arg1 > 5, arg2 contains "ok"
```

Matchers can also be used with **`EXPECT_THAT`** and **`ASSERT_THAT`** for verifying values in non-mock code:

```cpp
EXPECT_THAT(value, StartsWith("prefix"));
ASSERT_THAT(name, Not(IsEmpty()));
```

---

## Tips and Best Practices

- Use `_` to ignore arguments you don't care about, instead of creating unnecessary specific matchers.
- Combine matchers with `AllOf()`, `AnyOf()`, and `Not()` for expressive conditions.
- Use container matchers to verify STL containers easily without writing complicated loops.
- When working with pointers, prefer `Pointee()` to verify the referent's value instead of the pointer address.
- For overloaded functions, cast matchers to correct types using `SafeMatcherCast<T>()` if needed.

---

## Common Pitfalls

- Avoid matching method calls with wrong argument types; gMock's static typing can catch these but explicit casts may be needed.
- Do not suppress warnings or errors on unexpected or uninteresting calls by adding redundant `EXPECT_CALL`s unless intentional.
- Be cautious when matching containers: use `ElementsAre` if order matters, or `UnorderedElementsAre` if not.
- Remember that string matchers like `StrEq` are case sensitive by default.

---

## Further Reading and References

- See the [Matchers Reference](https://google.github.io/googletest/reference/matchers.html) for a comprehensive list of available matchers.
- The [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#using-matchers) provides practical examples and recipes.
- For defining custom matchers, see [Creating Custom Matchers](../api-reference/matchers-and-customization/custom-matchers.md).
- For examples on mock usage with matchers, consult [Creating Mocks & Basic Expectations](../api-reference/mocking-apis/mocking-basics.md).

---

## Example: Using Built-in Matchers in an `EXPECT_CALL`

```cpp
using ::testing::Eq;
using ::testing::StartsWith;
using ::testing::_;

class MockFoo {
 public:
  MOCK_METHOD(void, Process, (int count, const std::string& name), ());
};

TEST(FooTest, ProcessesNamesCorrectly) {
  MockFoo mock;

  // Expect Process() to be called with count >= 1 and name starting with "Test"
  EXPECT_CALL(mock, Process(Gt(0), StartsWith("Test")));

  mock.Process(2, "TestFoo");  // matches
  mock.Process(0, "TestBar");  // fails
}
```

---

## Example: Combining Matchers

```cpp
EXPECT_CALL(mock, AddUser(
    AllOf(StartsWith("admin"), Not(HasSubstr("fail"))),
    Ge(18)));
```

This expects the first argument to start with "admin" but not contain "fail", and the second argument to be greater or equal to 18.

---