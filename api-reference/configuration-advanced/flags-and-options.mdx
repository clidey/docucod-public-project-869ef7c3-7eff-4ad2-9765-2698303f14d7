---
title: "Flags and Runtime Configuration"
description: "Explains available runtime flags, environment variables, and configuration options that control test and mock execution behavior—such as output formatting, threading, failure handling, and platform compatibility."
---

# Flags and Runtime Configuration

This page details the runtime flags, environment variables, and configuration options available in GoogleMock that influence the behavior of tests and mocks during execution. These controls allow you to customize output verbosity, mock behavior, failure handling, threading support, and platform compatibility to better suit your development and testing workflows.

---

## Overview

GoogleMock includes several runtime flags and configuration options that can be specified via command-line arguments or programmatically. These flags control various aspects of the framework, including logging verbosity, mock strictness, leak detection, and default mock behavior.

Most flags can be passed to the test executable using the prefix `--gmock_` and are automatically parsed by GoogleMock's initialization routines (`InitGoogleMock`). The flags can also be accessed or modified programmatically if needed.

---

## Key Runtime Flags

### 1. `--gmock_verbose`
Controls how much information GoogleMock prints during test execution.

- **Values**:
  - `info` — Prints all messages, including informational messages, warnings, errors, and stack traces for uninteresting calls.
  - `warning` — Prints warnings and errors without stack traces for uninteresting calls. This is the default level.
  - `error` — Prints only error messages.

**Example**:

```bash
./test_binary --gmock_verbose=info
```

**Programmatic Access:**

```cpp
std::string verbose_level = GMOCK_FLAG_GET(verbose);
GMOCK_FLAG_SET(verbose, "error");
```

### 2. `--gmock_catch_leaked_mocks`
Determines whether GoogleMock reports leaked mock objects (mocks that were created but never destroyed) as failures.

- **Default**: `true`

If set to false, mock leaks are silently ignored.

**Programmatic Access:**

```cpp
bool catch_leaks = GMOCK_FLAG_GET(catch_leaked_mocks);
GMOCK_FLAG_SET(catch_leaked_mocks, false);
```

### 3. `--gmock_default_mock_behavior`
Controls the default behavior for uninteresting calls on mock methods when no explicit expectation (`EXPECT_CALL`) is set.

- **Values:**
  - `0` — Mocks behave as **NiceMocks**, silently ignoring uninteresting calls.
  - `1` — Mocks behave as **NaggyMocks**, logging warnings on uninteresting calls. This is the default.
  - `2` — Mocks behave as **StrictMocks**, treating uninteresting calls as test failures.

**Usage:**

Set this flag to influence how strict mock objects are globally.

**Example:**

```bash
./test_binary --gmock_default_mock_behavior=2
```

---

## Setting Flags Programmatically

GoogleMock exposes macros for accessing and manipulating the above flags programmatically. This is useful if your test environment or framework requires changing flag values dynamically.

| Macro                         | Purpose                                     |
|------------------------------|---------------------------------------------|
| `GMOCK_DECLARE_bool_(name)`   | Declares a bool flag named `gmock_name`     |
| `GMOCK_DEFINE_bool_(name, default_val, doc)` | Defines and initializes a bool flag          |
| `GMOCK_FLAG_GET(name)`        | Reads the current value of a flag             |
| `GMOCK_FLAG_SET(name, value)` | Sets the value of a flag                       |

### Example Usage

```cpp
#include "gmock/gmock.h"

// Check current verbosity
auto verbosity = GMOCK_FLAG_GET(verbose);

// Change verbose level to error
GMOCK_FLAG_SET(verbose, "error");
```

---

## Initialization and Command-Line Flag Parsing

To make GoogleMock recognize and parse flags, be sure to call `InitGoogleMock` early in your test program, passing the command-line arguments.

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- GoogleMock will process any flags starting with `--gmock_`, alter the runtime behavior accordingly, and remove those flags from `argv` so that downstream code does not see them.
- Flags unrelated to GoogleMock remain untouched.

### Initialization Automatic Parsing

The flag parsing is case-sensitive and expects syntax in the form `--gmock_flag_name=value`. For boolean flags, the `=value` part can be optional and will default to `true`.

Example accepted flags:

- `--gmock_verbose=info`
- `--gmock_catch_leaked_mocks=false`
- `--gmock_default_mock_behavior=2`

### Validation and Parsing Behavior

- If the given flag is invalid or malformed, GoogleMock ignores it.
- Flags unknown to GoogleMock are not modified or removed from the arguments.

See also the comprehensive tests in `gmock_test.cc` for typical command-line flag parsing scenarios.

---

## Environment Variables

GoogleMock also supports reading some configuration from environment variables following the convention of the underlying GoogleTest framework, but flags are the recommended approach to control runtime settings.

For detailed environment variable configuration, refer to the GoogleTest documentation.

---

## Platform and Threading Configuration

GoogleMock inherits platform adaptability from GoogleTest through internal portability headers (such as `gmock-port.h` and `gtest-port.h`).

### Compiler and Platform Checks

- Minimum compiler versions are enforced, e.g., MS Visual C++ 2015 (version 14.0) or higher.
- Flags and macros set by GoogleTest indicate available platform features like threading support, exception handling, and filesystem availability.

### Thread-Safety

- GoogleMock is thread-safe when the underlying platform supports threading.
- Threading support is automatically detected or controlled using the internal configuration macro `GTEST_IS_THREADSAFE`.

### Controlling Logging and Output

GoogleMock respects platform capabilities to provide consistent logging and error message output, which can be controlled by runtime flags discussed above.

---

## Best Practices and Common Pitfalls

- Always call `InitGoogleMock()` before running tests to ensure flags are parsed correctly.
- Use `--gmock_verbose` to tune output during debugging; switch to `error` in CI to reduce noise.
- Beware of uninteresting calls in mocks when using NaggyMocks (default behavior); consider switching to NiceMock or StrictMock based on your needs.
- Use programmatic flag manipulation sparingly and preferably before running tests.
- Validate that your compiler version meets minimum requirements to avoid unexpected compile errors related to flag handling.

---

## Additional Resources

For more detailed information on mocking behavior, flag usage, and runtime configuration, refer to:

- **[Mocking Reference](../reference/mocking.md)** — Detailed API usage and best practices for mocks and expectations.
- **[gMock Cookbook](../gmock_cook_book.md)** — Practical examples including flag usage and mock behavior configuration.
- **[Mock Strictness Modes](../api-reference/mocking-framework/mock-strictness.mdx)** — Explains the differences between NiceMock, NaggyMock, and StrictMock.
- **`gmock_port.h`** — Defines the internal macro implementations and platform-specific flag utilities.
- **`gmock.cc`** — Contains flag parsing implementation details.

---

## Summary Diagram of Flag Usage Flow

```mermaid
flowchart TD
  Start([Start Test Program]) --> Init[Call InitGoogleMock(argc, argv)]
  Init --> ParseFlags{Flags passed?}
  ParseFlags -->|Yes| ProcessFlags[Parse and set gmock flags]
  ParseFlags -->|No| Continue[Continue with default flag values]
  ProcessFlags --> CleanArgs[Remove gmock flags from argv]
  CleanArgs --> RunTests[Run tests with updated flags]
  Continue --> RunTests
  RunTests --> End([End of Test Program])
```

---

## Source References

<Source url="https://github.com/google/googletest" branch="main" path="googlemock/src/gmock.cc" range="40-125" />
<Source url="https://github.com/google/googletest" branch="main" path="googlemock/include/gmock/internal/gmock-port.h" range="50-115" />

---

**Note:** All runtime flags provided by GoogleMock start with `gmock_` prefix and expose a consistent interface for both the command line and programmatic manipulation.