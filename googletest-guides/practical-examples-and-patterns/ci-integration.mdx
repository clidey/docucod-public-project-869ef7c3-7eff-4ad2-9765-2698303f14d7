---
title: "Integrating GoogleTest in Continuous Integration"
description: "Guide to integrating GoogleTest/GoogleMock into CI pipelines (e.g., GitHub Actions, Jenkins, internal Google infrastructure). Covers test automation, reporting, troubleshooting build failures, and platform considerations."
---

# Integrating GoogleTest in Continuous Integration

## 1. Overview

This guide helps you seamlessly integrate GoogleTest and GoogleMock into your Continuous Integration (CI) pipelines, including popular platforms like GitHub Actions, Jenkins, and Google's internal infrastructure. You will learn how to automate test execution, generate meaningful reports, troubleshoot common build failures, and understand platform-specific considerations.

### Prerequisites
- Working knowledge of GoogleTest and GoogleMock basics.
- A C++ project with GoogleTest/GoogleMock tests written and buildable.
- Access to your CI environment configuration.
- Basic familiarity with your CI tool’s configuration syntax (YAML for GitHub Actions, Jenkinsfile for Jenkins).

### Expected Outcome
- Automated execution of GoogleTest/GoogleMock tests on every code change.
- Test results and reporting integrated with CI tooling.
- Strategies to handle typical build or runtime failures in the CI environment.
- Awareness of platform-specific flags and environment setups that improve reliability.

### Time Estimate
Setting up basic integration typically takes 30-60 minutes if your tests build locally without issues.

### Difficulty Level
Intermediate — requires some experience with C++ build systems and CI platform configurations.

---

## 2. Step-by-Step Integration Guide

### Step 1: Prepare Your Test Executable

1. **Link to gtest_main or gmock_main**
   - GoogleTest provides a default `main()` implementation to simplify test execution.
   - Use `gtest_main` when only GoogleTest is involved.
   - Use `gmock_main` when using GoogleMock to ensure proper initialization, as detailed in `gmock_main.cc`.
   
2. **Build your test binary**
   - Incorporate GoogleTest and GoogleMock headers and libraries as per your build system (see the `googletest/README.md` for CMake instructions).
   - Verify the executable runs locally and all tests pass.

### Step 2: Automate Test Execution in CI

- **Configure your CI workflow to invoke your test executable.** Examples:

  - **GitHub Actions (YAML snippet):**

    ```yaml
    steps:
      - uses: actions/checkout@v3
      - name: Build
        run: |
          mkdir build && cd build
          cmake ..
          make
      - name: Run Tests
        run: ./build/your_test_executable
    ```

  - **Jenkins (Declarative Pipeline snippet):**

    ```groovy
    pipeline {
      agent any
      stages {
        stage('Build') {
          steps {
            sh 'mkdir -p build'
            sh 'cd build && cmake .. && make'
          }
        }
        stage('Test') {
          steps {
            sh './build/your_test_executable'
          }
        }
      }
    }
    ```

### Step 3: Generate Test Reports

GoogleTest supports outputting XML test reports that many CI tools can consume for test summaries and trend graphs.

- Add the flag `--gtest_output=xml:<path>` when invoking the test executable.
  
Example:

```bash
./your_test_executable --gtest_output=xml:report.xml
```

- Configure your CI tool to archive or parse the generated XML:
  - GitHub Actions can use `actions/upload-artifact` to save reports.
  - Jenkins can use the JUnit plugin to process GoogleTest XML reports.

### Step 4: Handle Test Flags and Verbosity

- You can control GoogleMock and GoogleTest behavior with flags.
- For GoogleMock, custom flags start with `--gmock_` as seen in the tests for `InitGoogleMock`.
- Common flags:
  - `--gtest_filter=<pattern>` to limit executed tests.
  - `--gmock_verbose=info|warning|error` to adjust mock-related logging.

Example:

```bash
./your_test_executable --gmock_verbose=info --gtest_filter=MyTestSuite.*
```

### Step 5: Troubleshooting Build and Test Failures

- **Common CI issues include:**
  - Missing dependencies or include paths.
  - Linker errors due to mismatched runtimes (Windows related).
  - Incomplete test initializations causing runtime crashes.

##### Tips:
- Verify locally that your test binary runs and all tests execute successfully before integrating into CI.
- Use `set -x` or equivalent in scripts to debug execution.
- Check CI environment supports the C++17 standard as required.
- If using Visual Studio, ensure runtime library linkage aligns for GoogleTest and your code.
- Capture standard output and error logs in your CI artifacts.

### Step 6: Platform Considerations

- On embedded or specialized platforms (e.g., ESP8266, ESP32), tests may require different entry points (`setup()`/`loop()`) instead of `main()`, as implemented in `gmock_main.cc` and `gtest_main.cc`.
- For standard desktop/server environments, `main()` with argc/argv is used.
- Always confirm your test framework initialization matches platform expectations.

---

## 3. Practical Example: GitHub Actions Workflow

```yaml
name: C++ GoogleTest CI

on: [push, pull_request]

jobs:
  build_and_test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install dependencies
        run: sudo apt-get update && sudo apt-get install -y cmake build-essential
      - name: Configure
        run: cmake -S . -B build
      - name: Build
        run: cmake --build build
      - name: Run tests
        run: |
          ./build/your_test_executable --gtest_output=xml:report.xml
      - name: Upload test results
        uses: actions/upload-artifact@v3
        with:
          name: googletest-report
          path: report.xml
```

---

## 4. Troubleshooting & Tips

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="Build Failures Due to Runtime Linkage Mismatch">
Ensure your Visual Studio project and GoogleTest libraries use the same runtime setting (static vs dynamic). Set the CMake option `gtest_force_shared_crt` when building GoogleTest to match your project’s settings.
</Accordion>
<Accordion title="Tests Not Running in CI or Always Passing">
Verify your test binary’s output. GoogleTest returns exit code 0 on success and 1 on failure—your CI should fail on non-zero exit codes. Make sure `RUN_ALL_TESTS()` is called exactly once in the `main()`.
</Accordion>
<Accordion title="Missing Test Reports in CI">
Confirm your test invocation uses `--gtest_output=xml:<filename>`. Also, configure your CI to upload or parse the XML test result files after the test step.
</Accordion>
<Accordion title="Flag Issues with GoogleMock">
Use `testing::InitGoogleMock(&argc, argv);` to parse GoogleMock-specific flags. Avoid manually removing gMock flags from argv.
See `googlemock/src/gmock_main.cc` and the `InitGoogleMock` tests for examples.
</Accordion>
</AccordionGroup>

<Info>
Pro Tip: Incrementally add CI functionality starting with build verification, then automated test execution, and finally test result reporting. This approach isolates issues and ensures smoother integration.
</Info>

---

## 5. Next Steps & Related Content

- Explore the [Writing Your First Test guide](../../googletest-guides/getting-started/primer-first-test) to learn how to create GoogleTest tests.
- Review [Basic Configuration](../../getting-started/initial-configuration-validation/basic-configuration) for detailed build setup.
- For advanced mocking in CI, see [Introduction to Mocking with GoogleMock](../../googletest-guides/advanced-mocking-patterns/intro-to-mocking).
- Consult the [Common Installation & Build Issues](../../getting-started/troubleshooting-support/common-issues) page if you encounter integration problems.

---

## Appendix: Minimal Sample main() for CI

If you create your own `main()` rather than linking with `gmock_main` or `gtest_main`:

```cpp
#include "gmock/gmock.h"
#include "gtest/gtest.h"

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes both GoogleMock and GoogleTest
  return RUN_ALL_TESTS();  // Runs all registered tests and returns 0 if all succeed
}
```

This ensures flags are parsed correctly and tests run properly in CI.

---
<br>
_This guide is tailored to integrate GoogleTest and GoogleMock into CI pipelines, providing actionable configuration, execution, reporting tips, and troubleshooting advice to enable a robust automated C++ testing workflow._