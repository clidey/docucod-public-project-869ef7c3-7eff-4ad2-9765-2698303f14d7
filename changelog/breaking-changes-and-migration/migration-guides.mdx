---
title: "Migration Guides"
description: "Step-by-step guides help developers transition codebases to new major versions, addressing deprecated functionality, required flag or build changes, and adoption of new APIs or behaviors."
---

# Migration Guides

This page provides comprehensive, step-by-step guides to assist developers in upgrading GoogleTest major versions smoothly. It focuses on the necessary codebase transitions, including handling deprecated functionality, updating required flags or build configurations, and adopting new APIs or behavioral changes.

---

## 1. Preparing for Upgrade

Before beginning the migration, ensure your development environment meets the minimum requirements for the target GoogleTest version. Since the 1.17.x release, GoogleTest requires at least C++17 support across supported platforms (Linux, Windows, Mac). Verify your compiler and build system are properly configured for this standard.

### Key Preparation Steps:

- Confirm your project is building with C++17 or higher.
- Review your build system (e.g., CMake) for compatibility with the new GoogleTest version.
- Backup your existing test code and configuration.

<Tip>
Starting the migration with a clean build environment prevents unexpected compatibility issues and helps isolate any migration-related changes.
</Tip>

---

## 2. Deprecated Functionality and API Changes

GoogleTest’s major version updates may deprecate previous APIs or alter behaviors. This section guides you through common breaking points and how to update your test code accordingly.

### 2.1 Test Suite Terminology Update

GoogleTest has shifted terminology from *Test Case* to *Test Suite* to align with contemporary standards (including ISTQB). APIs formerly named using `TestCase` are deprecated in favor of `TestSuite`.

**Migration actions:**

- Replace all instances of `TestCase` in test suite declarations with `TestSuite`.
- Switch from older deprecated macros towards the preferred API (e.g., preferential use of `TEST_SUITE` where applicable).

### 2.2 Assertion Macro Behavior

- `ASSERT_*` macros produce fatal failures and abort the current function immediately.
- `EXPECT_*` macros produce nonfatal failures allowing tests to continue.

Be aware that improper use of `ASSERT_*` might skip tear-down or clean-up code, potentially causing resource leaks.

**Tip:** Review your use of assertions to ensure critical failures use `ASSERT_*` while allowing non-critical verifications to use `EXPECT_*`, following modern best practices.

### 2.3 Handling of Parameterized Tests

With extensive enhancements to parameterized (`TEST_P`) and typed tests (`TYPED_TEST`), validate that all your parameterized tests are properly instantiated.

**Key checklist:**

- Ensure every `TEST_P` test suite has a matching `INSTANTIATE_TEST_SUITE_P`.
- If some parameterized suites are intentionally uninstantiated, explicitly annotate them with `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST`.

### 2.4 Main Function and Initialization Updates

- Use `testing::InitGoogleTest(&argc, argv)` to initialize before calling `RUN_ALL_TESTS()`.
- Prefer linking against the `gtest_main` library to avoid writing a custom `main()` unless specific customizations are needed.

### 2.5 Important Flag Changes

Some flags related to death tests and output formatting have changed between major versions. Review flag defaults and behavior:

- Verify that your use of death test styles (`--gtest_death_test_style`) matches either `fast` or `threadsafe` styles depending on your test requirements.
- Adjust filtering rules if needed to accommodate any changes in test name matching or filtering semantics.

---

## 3. Required Build and Configuration Adjustments

Major version changes may require updated build invocations and configuration to support new standard compliance and features.

### 3.1 Compiler Flags

Ensure your compiler flags include `-std=c++17` (or later). Modern GoogleTest versions will fail to build without this.

### 3.2 Dependency Updates

GoogleTest may now depend on newer versions of some tools and libraries:

- Check integration with `Abseil` if planned since it is a forthcoming dependency.
- Validate compatibility with your CI systems handling of test runners and output streams.

---

## 4. Migration Workflow

Follow the sequence below to migrate your test code safely:

<Steps>
<Step title="Backup Your Code">
Create a full backup of your current test code and environment before upgrading.
</Step>
<Step title="Update Build System">
Modify your build scripts (e.g., CMakeLists.txt) to require at least C++17.
</Step>
<Step title="Upgrade GoogleTest Library">
Download and integrate the new GoogleTest version, replacing older libraries.
</Step>
<Step title="Refactor Deprecated APIs">
Replace deprecated test framework APIs (e.g., `TestCase` to `TestSuite`).
</Step>
<Step title="Validate Parameterized Tests">
Ensure all `TEST_P` tests are properly instantiated, and add any missing macro or instantiation calls.
</Step>
<Step title="Adjust Assertion Usage">
Review `ASSERT_*` and `EXPECT_*` macros usage for proper failure handling.
</Step>
<Step title="Update Your main() Function">
If you provide a custom `main()`, use `InitGoogleTest()` and return `RUN_ALL_TESTS()`.
</Step>
<Step title="Run and Validate">
Build and run all tests, watching for deprecated usage warnings or test failures.
</Step>
<Step title="Fix Issues and Iterate">
Address compilation errors, runtime failures, or behavioral changes as needed.
</Step>
</Steps>

---

## 5. Handling Breaking Changes with Examples

### 5.1 Switching from TestCase to TestSuite

Old code:

```cpp
TEST_CASE(MyTestCase, TestName) {
  EXPECT_TRUE(SomeCondition());
}
```

New preferred approach:

```cpp
TEST(MyTestSuite, TestName) {
  EXPECT_TRUE(SomeCondition());
}
```

Or when using fixtures:

```cpp
class MyTestSuite : public testing::Test {};

TEST_F(MyTestSuite, TestName) {
  EXPECT_EQ(ActualValue(), ExpectedValue());
}
```

### 5.2 Proper Parameterized Test Instantiation

Ensure every `TEST_P` has an `INSTANTIATE_TEST_SUITE_P` call:

```cpp
TEST_P(MyParamTestSuite, DoesSomething) {
    EXPECT_TRUE(FunctionUnderTest(GetParam()));
}

INSTANTIATE_TEST_SUITE_P(MyInstantiation,
                         MyParamTestSuite,
                         testing::Values(1, 2, 3));
```

If no instantiation is needed, suppress warnings:

```cpp
GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST(MyParamTestSuite);
```

### 5.3 Writing main() Function Correctly

Use:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Avoid ignoring the return value of `RUN_ALL_TESTS()`.

<Tip>
Linking your test executable with `gtest_main` can omit the need for a custom `main()` function unless you need custom setup.
</Tip>

---

## 6. Troubleshooting Common Migration Issues

### 6.1 Build Failures Due to C++ Standard

Error messages referencing missing features or compilation errors typically indicate lacking C++17 support. Verify compiler version and flags.

### 6.2 Missing Test Discoveries

Confirm test naming conventions and ensure that all tests are correctly registered. Check that parameterized tests have instantiations.

### 6.3 Skipped or Disabled Tests

Check if tests are disabled via macros or filtering flags. Confirm `--gtest_also_run_disabled_tests` is set if you want to include disabled tests in your run.

### 6.4 Death Test Failures

Check that your death tests conform to the updated style and platform requirements. Review `--gtest_death_test_style` flag and update code accordingly.

<Tip>
Refer to the [Troubleshooting Guide](https://google.github.io/googletest/getting-started/first-steps-validation/troubleshooting-setup) for detailed help on these scenarios.
</Tip>

---

## 7. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) – Core basics for writing tests.
- [Testing Reference](https://google.github.io/googletest/reference/testing.html) – Detailed macros and API usage.
- [Breaking Changes](./breaking-changes) – Enumerates all breaking changes by version.
- [Release Notes](../version-history-and-release-notes/detailed-release-notes) – For complete change logs.

---

## 8. Summary

Migration to new major GoogleTest versions requires careful preparation, code refactoring for deprecated APIs, updating build configurations, and validating parameterized tests and assertions handling. Following these migration guides ensures a smooth transition and maintains test suite stability and reliability.

<Check>
Always test your upgrade in an isolated environment and incrementally migrate components.
</Check>

---

*For detailed migration workflows for each major release, consult the accompanying version-specific migration documents linked in the release notes.*

---

_This page is part of the Changelog section under Breaking Changes and Migration guidance._

