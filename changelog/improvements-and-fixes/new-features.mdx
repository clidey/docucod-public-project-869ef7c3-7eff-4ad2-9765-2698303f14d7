---
title: "New Features"
description: "An overview of recently introduced testing features and enhancements, including improvements to assertions, mocking, parameterized testing, and test discovery. Quickly find out what's possible in the latest versions."
---

# New Features

This page presents an overview of the latest additions and enhancements to GoogleTest and GoogleMock, focusing on recent improvements that empower you to write more expressive, flexible, and maintainable tests. Learn how advancements in assertions, mocking capabilities, parameterized tests, and test discovery streamline your testing workflows and help catch bugs earlier.

---

## 1. Enhanced Mocking Capabilities

GoogleMock continues to evolve with robust features that improve how you specify, control, and verify mock behavior. Recent enhancements include:

### a. Precise Mock Method Definitions with `MOCK_METHOD`
- Define mock methods clearly using the unified `MOCK_METHOD` macro supporting qualifiers like `const`, `override`, `noexcept`, and calling-convention specifiers (`Calltype`). This enables clean declaration of complex methods including overloaded and templated methods.
- Handle methods with arguments containing commas by wrapping argument types in parentheses or using type aliases for better compile-time reliability.

### b. Flexible Expectation Setup via `EXPECT_CALL`
- Build detailed expectations with clauses such as `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()`.
- New rules infer call cardinality automatically from the presence of `WillOnce()` and `WillRepeatedly()` clauses, simplifying your test code.
- Support for specifying ordered, unordered, and partially ordered expectations lets you express complex interaction protocols clearly.

### c. Advanced Call Behavior Controls
- Manage uninteresting calls flexibly by using `NiceMock`, `NaggyMock`, and `StrictMock` wrappers:
  - `NiceMock`: Suppresses warnings on unexpected calls.
  - `NaggyMock` (default): Emits warnings on unexpected calls.
  - `StrictMock`: Treats unexpected calls as test failures.
- Control when expectations retire to allow flexible matching of repeated calls using `.RetiresOnSaturation()` clause.

### d. Improved Handling of Special Cases
- Full support for methods with incomplete argument types, non-default-constructible return types, and move-only types like `std::unique_ptr`.
- Ability to delegate mock methods to fakes, real objects, or parent classes for greater test harness flexibility.
- Facilities to verify, clear, and manage mock expectations programmatically, such as `Mock::VerifyAndClearExpectations` and `Mock::AllowLeak`.

### e. Rich Diagnostic and Debugging Support
- The `--gmock_verbose` flag with levels `info`, `warning`, and `error` empowers you to control the verbosity of informative messages during mock execution, including stack traces on uninteresting calls.
- Detailed failure messages for unexpected, unsaturated, and excessive calls, complete with argument values and call origin locations, greatly speed up debugging.

### Example: Defining and Using a Mock Class
```cpp
#include <gmock/gmock.h>

class Foo {
 public:
  virtual ~Foo() {}
  virtual int Bar(int x) = 0;
  virtual void Baz() const = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, Bar, (int x), (override));
  MOCK_METHOD(void, Baz, (), (const, override));
};

TEST(FooTest, BarReturnsExpectedValue) {
  MockFoo mock;
  EXPECT_CALL(mock, Bar(::testing::Gt(0))).WillOnce(::testing::Return(42));
  EXPECT_EQ(42, mock.Bar(1));
}
```

---

## 2. Expanded Assertion and Matcher Improvements

- Leverage GoogleTest's powerful assertion macros like `EXPECT_THAT` supporting expressive matchers for complex scenarios.
- Utilize polymorphic and parameterized matchers to precisely validate test inputs and outputs.
- Craft custom assertions and matchers with the `MATCHER` and `MATCHER_P` macros, enabling domain-specific expressive conditions.

---

## 3. Parameterized and Typed Tests Improvements

- Extend testing coverage and reuse by writing tests that run across multiple types and inputs.
- Easily define typed test suites via GoogleTest macros, improving maintainability and reducing duplicated code.

---

## 4. Updated Test Discovery and Execution

- Test runner improvements allow smoother integration and execution control.
- Flexible initialization routines support diverse platforms and custom setups using `InitGoogleMock()` alongside `InitGoogleTest()`.

---

## 5. Practical Tips and Best Practices

- **Set expectations before exercising mocks:** Always call `EXPECT_CALL` prior to invoking mock methods to avoid undefined behavior.
- **Use `ON_CALL` for default behaviors:** Define behavior without enforcing expectations on calls, keeping tests flexible and focused.
- **Manage uninteresting calls appropriately:** Leverage `NiceMock` or explicit catch-all expectations to suppress spurious warnings.
- **Utilize `RetiresOnSaturation` for sequenced actions:** Cleanly transition between expectations for repeated calls.
- **Verify expectations early if needed:** Use `Mock::VerifyAndClearExpectations` to enforce expectations even if mocks are leaked or destructed late.

---

For detailed examples, recipes, and deeper coverage, refer to the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) and the [Mocking Reference](reference/mocking.md).

---

## References and Further Reading

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [Mocking Reference](reference/mocking.md)
- [Assertions Reference](reference/assertions.md)
- [Writing Your First Test Guide](/guides/getting-started/writing-first-test)
- [Using Assertions Effectively](/guides/core-workflows/using-assertions)
- [Introduction to Mocking](/guides/getting-started/introduction-to-mocking)

---

