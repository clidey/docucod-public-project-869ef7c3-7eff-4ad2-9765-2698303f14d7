---
title: "Breaking Changes"
description: "Documents breaking changes across versions, with clear explanations of the impact, affected workflows, and upgrade paths. Flags changes that require user attention, such as updated C++ standard requirements and API removals."
---

# Breaking Changes

This page documents critical breaking changes introduced across different versions of GoogleMock and GoogleTest. It clearly outlines their impact on users, affected workflows, and guides on upgrading and migration to ensure a smooth transition. This page alerts users to changes requiring immediate attention, including updated C++ standard requirements and the removal or alteration of APIs.

---

## Updated C++ Standard Requirements

Starting from recent releases of GoogleTest and GoogleMock, a minimum of C++17 standard support is required by your compiler and build environment. This change is fundamental and affects all users:

- **Impact:** Build failures occur if the compiler is not configured to use C++17 or newer.
- **Affected workflows:** All build and integration setups.
- **Upgrade path:**
  - Update the compiler to a version supporting C++17 fully.
  - Configure your build system (CMake, Bazel, or other) to enable C++17 or later.

<Tip>
Ensure your project respects the new minimum standard by explicitly setting the C++ standard flag in your build configuration, for example, `-std=c++17` with GCC/Clang or appropriate flags for MSVC.
</Tip>

## Removal of Legacy Mocking Macros

GoogleMock has deprecated the `MOCK_METHODn` family of macros in favor of the unified `MOCK_METHOD` macro.

- **Impact:** Code using `MOCK_METHOD0`, `MOCK_CONST_METHOD1`, or similar macros will no longer compile in future versions.
- **Affected workflows:** Writing or maintaining mock classes.
- **Upgrade path:** Replace legacy macros with the new syntax:

```cpp
// Old-style macro:
MOCK_METHOD1(Foo, bool(int));

// New-style macro:
MOCK_METHOD(bool, Foo, (int));
```

- This unified syntax also supports const, override, noexcept, and calling conventions modifiers.

<Note>
Refer to the `Mock Classes and Methods` documentation for detailed migration guidelines.
</Note>

## Changes in Default Mock Behavior Handling

GoogleMock's default behavior regarding uninteresting calls (calls to mock methods without explicit expectations) has evolved:

- Previously, all mock objects behaved as "naggy" mocks by default, printing warnings on uninteresting calls.
- Plans or ongoing updates move the default towards "nice" mocks that suppress such warnings.

- **Impact:** Tests relying on warning messages for uninteresting calls may observe fewer warnings.
- **Affected workflows:** Diagnosis of unexpected mock calls and test validation strategies.
- **Upgrade path:**
  - Use `NaggyMock<T>` explicitly if warnings on uninteresting calls are desired.
  - Use `NiceMock<T>` explicitly to suppress warnings.

<Check>
Explicitly select mock strictness to control warnings and test failures for uninteresting or unexpected calls.
</Check>

## Strict and Nice Mock Limitations

- `NiceMock<T>` and `StrictMock<T>` only influence mock methods declared directly in `T` and may have inconsistent behavior if:
  - Mock methods are inherited from base classes.
  - The destructor of `T` is not virtual.

- **Impact:** Some uninteresting calls in base classes may still trigger warnings or errors unexpectedly.
- **Upgrade path:** Ensure virtual destructors and review mock class inheritance.

## Removal of Support for Variadic Functions Mocking

- It remains impossible to mock variadic functions (`...` ellipsis) directly.
- Legacy workaround requires creating interfaces with overloaded functions.

- **Impact:** No change but reaffirms best practices.
- **Recommendation:** Refactor code to avoid variadic functions if mocking is needed.

## Changes in Mock Method Overload Resolution

- When mocking overloaded methods, it is essential to mock each overload explicitly.
- Omission causes compiler warnings about hidden base class methods.

- **Upgrade path:**
  - Bring base class functions into scope using `using BaseClass::Method;` in the mock class.

```cpp
class MockFoo : public Foo {
 public:
  using Foo::Add;  // Bring other overloads into scope
  MOCK_METHOD(int, Add, (int x), (override));
};
```

## Introduction of Support for Mocking Non-Virtual Methods

- GoogleMock added support for mocking non-virtual methods via type templates to enable high-performance dependency injection.
- **Impact:** New mocking patterns are enabled, no breaking changes.
- **Usage:** Use template-based mocks in tests where appropriate.

## Updated Default Values and Actions Handling

- `DefaultValue<T>` now supports factories producing fresh instances upon request, useful for types like `std::unique_ptr`.

- **Upgrade path:**
  - Use `SetFactory()` to specify default value factories.

## Changes in Matchers and Actions Behavior

- Matchers and actions maintain the rule of evaluating call arguments exactly once during expectation setup.
- Improper use of side effects (such as modifying variables in `Return(n++)`) can cause unexpected behavior.

- **User advice:** Use lambdas or callable objects when stateful or order-dependent actions are needed.

## Deprecations or Removals Related to Macros and Expectation Modifiers

- Certain deprecated macros or orderings (such as chaining `With` clauses multiple times in one expectation) are disallowed.
- Users must adapt their tests to the prescribed syntax and ordering for modifiers.

---

## Getting Help and Migration Resources

- For detailed migration instructions and best practices, please consult:
  - [Mocking Reference](https://google.github.io/googletest/reference/mocking.md)
  - [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html)
  - [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
  - [Detailed Release Notes](https://google.github.io/googletest/changelog/release-history/detailed-release-notes.html)

<Tip>
Regularly update your compiler environment, test your coverage of mock expectations, and adopt idiomatic `EXPECT_CALL` usage to avoid common pitfalls related to API changes.
</Tip>