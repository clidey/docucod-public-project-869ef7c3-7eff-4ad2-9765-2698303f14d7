---
title: "Breaking Changes & Migration Notes"
description: "Detailed explanations of changes that break backward compatibility, including rationale, impacted features, and concrete migration steps. Users will find before/after snippets, timelines for removals, and references to relevant core headers and test files illustrating usage transitions."
---

# Breaking Changes & Migration Notes

This page provides detailed explanations of breaking changes introduced in recent versions of GoogleTest and GoogleMock. It offers users clear guidance to understand the rationale, affected features, and concrete migration steps to update their code smoothly. Each breaking change is illustrated with before/after code snippets where applicable, timelines for deprecated features removal, and references to relevant core headers and test suite examples.

---

## Overview of Breaking Changes

Breaking changes affect users who maintain existing test suites built upon previous versions of GoogleTest or GoogleMock. This page focuses exclusively on those changes that can affect backwards compatibility, helping users:

- Identify if their existing code is impacted.
- Understand why changes were necessary.
- Follow step-by-step migration instructions with illustrative code.
- Prepare for features that have been or soon will be removed.

We strongly encourage integrating these migration steps as part of release upgrades to avoid runtime failures or compilation errors.

## Common Breaking Change Categories

Breaking changes in GoogleTest and GoogleMock typically fall into these categories:

- **API Signature Changes:** Modifications to existing APIs, such as method naming, parameters, or required qualifiers.
- **Behavioral Changes:** Changes in default behaviors that affect test execution or outcome.
- **Deprecations and Removals:** Phased removals of deprecated functions, macros, or flags.
- **Build and Compatibility Adjustments:** Changes to minimum compiler standards or platform supports.

## Detailed Breaking Changes and Migration Instructions

### Transition from Old Mock Method Macros to `MOCK_METHOD`

#### What Changed?
The older family of macros `MOCK_METHODn` and their variants (`MOCK_CONST_METHODn`, `MOCK_METHODn_T`, etc.) have been superseded by the generic `MOCK_METHOD` macro introduced since 2018.

#### Why?
The new `MOCK_METHOD` macro unifies mock method definitions, simplifies syntax, reduces the maintenance burden, and improves type safety.

#### Migration Steps:
- Replace occurrences of `MOCK_METHOD0`, `MOCK_METHOD1`, ..., `MOCK_CONST_METHOD1`, etc., with `MOCK_METHOD`.
- Change the syntax from `MOCK_METHODn(MethodName, ReturnType(Args))` to `MOCK_METHOD(ReturnType, MethodName, (Args))`.
- Pass qualifiers such as `(const, override)` as a fourth parameter in parentheses.

##### Example Before:
```cpp
class MockFoo {
 public:
  MOCK_CONST_METHOD1(Bar, int(int));
  MOCK_METHOD2(Baz, void(int, std::string));
};
```

##### Example After:
```cpp
class MockFoo {
 public:
  MOCK_METHOD(int, Bar, (int), (const, override));
  MOCK_METHOD(void, Baz, (int, std::string), (override));
};
```

#### Notes:
- The new macro requires moving mock method declarations into the `public` section regardless of the original method's access level.
- Refer to [Mocking Reference - MOCK_METHOD](docs/reference/mocking.md#MOCK_METHOD) and [gMock Cookbook](docs/gmock_cook_book.md#creating-mock-classes) for detailed usage.

---

### `EXPECT_CALL` and `ON_CALL` Modifier Clause Ordering

#### What Changed?
GoogleMock introduced stricter enforcement of the order in which chainable clauses such as `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()` are used when setting expectations.

#### Rationale:
To prevent confusion and errors stemming from unexpected orderings that change semantics, GoogleMock now flags usage errors if clauses appear out of order.

#### Migration Steps:
- Always use `.With()` as the first clause if specified.
- `.Times()` must appear before `.InSequence()` and `.After()`.
- `.InSequence()` can appear multiple times but only before `.After()`, `.WillOnce()`, and `.WillRepeatedly()`.
- `.After()` clauses must come before `.WillOnce()` and `.WillRepeatedly()`.
- `.WillOnce()` clauses can be repeated and must precede `.WillRepeatedly()`.
- `.WillRepeatedly()` can appear once and before `.RetiresOnSaturation()`.
- `.RetiresOnSaturation()` must be the last clause.

##### Example Correct Order:
```cpp
EXPECT_CALL(mock, Method(_))
    .With(_)
    .Times(Exactly(2))
    .InSequence(seq1)
    .InSequence(seq2)
    .After(expectation)
    .WillOnce(Return(1))
    .WillRepeatedly(Return(2))
    .RetiresOnSaturation();
```

#### Impact:
- Mismatched clause order raises runtime errors during setup.
- Review and reorder `.EXPECT_CALL()` and `.ON_CALL()` chains to comply.

---

### Removal of Legacy Action Macros

#### What Changed?
Older macros `ACTION`, `ACTION_P`, and their multi-parameter variants continue to exist but usage is discouraged. The preferred approach is defining actions using lambdas, function objects, or implementing the `ActionInterface`.

#### Why?
New C++ standards offer more expressive, readable, and type-safe ways to define actions.

#### Migration Recommendation:
- Replace macros-based actions with lambdas or functors.
- Use `Invoke()`, `InvokeWithoutArgs()`, or `DoAll()` compositors as needed.
- Consult the [Actions Reference](api-reference/gmock-apis/actions-reference.mdx) and [gMock Cookbook](docs/gmock_cook_book.md#using-functions-methods-functorslambdas-as-actions) for patterns.

---

### Minimum C++ Standard Raised to C++17

#### What Changed?
The `main` branch and subsequent releases require building with at least C++17 compiler support.

#### Why?
- Leverages modern C++ features for cleaner implementation and improved performance.
- Simplifies maintenance by dropping older standard support.

#### Migration Steps:
- Ensure toolchain and build scripts use at least C++17 standard.
- Adjust compilation flags (e.g. `-std=c++17` for GCC/Clang, `/std:c++17` for MSVC).

#### Impact:
- Older compilers (pre-C++17) will fail compilation.
- Libraries and third-party dependencies must be compatible.

Refer to the [Supported Platforms & Integrations](overview/introduction_and_value/supported_platforms_and_integration.md) and [System Requirements](getting-started/prerequisites-installation/system-requirements.md) for details.

---

### Changes to `NiceMock`, `NaggyMock`, and `StrictMock`

#### Clarifications
- These modifiers control how uninteresting calls are treated.
- All mock methods must be defined with `MOCK_METHOD` in the derived mock class for these to work reliably.

#### Limitations:
- `NiceMock<>` and `StrictMock<>` do not affect mock methods inherited from base classes.
- Nesting of these wrappers is not supported.
- Virtual destructors are required for correct behavior.

#### Migration Tips:
- Make sure mock methods are declared directly in custom mock classes with `MOCK_METHOD`.
- Avoid nesting multiple behavior modifiers.
- Use `NaggyMock<>` for default behavior warnings, `NiceMock<>` to suppress warnings, `StrictMock<>` to treat uninteresting calls as failures.

See [Nice, Naggy, and Strict](docs/gmock_cook_book.md#The-Nice-Strict-and-the-Naggy) for more detailed examples and guidelines.

---

### Mocking Non-Virtual Methods Requires Template or Interface-Based Adaptation

#### What Changed?
While it's not possible to mock non-virtual free functions directly, the recommended technique is either:

- Use template-based dependency injection.
- Wrap free functions behind interfaces that can be mocked.

#### Migration Steps:
- Refactor code to accept templates parameterized on concrete or mock implementations.
- Use `MockFunction` for mocking `std::function` callbacks.

See `docs/gmock_cook_book.md#mocking-non-virtual-methods` and related sections.

---

### Reporting and Logging Enhancements

#### What Changed?
- Added `--gmock_verbose=` flag with levels `info`, `warning`, and `error` to control GoogleMock's verbosity.
- At `info` level, detailed traces of mock calls and matching expectations are printed.
- At `warning` level (default), uninteresting call warnings are printed without stack trace.
- At `error` level, only errors are printed, suppressing info and warnings.

#### Migration Advice:
- Use `--gmock_verbose=info` to debug failure scenarios and understand matcher interactions.
- Use `--gmock_verbose=error` for quiet test runs.
- Adjust verbosity based on development and CI needs.

Refer to the [gmock_test.cc](googlemock/test/gmock_test.cc) for examples.

---

### Removal or Obsolescence Notices

| Feature                          | Status       | Removed Since | Migration Instructions                                            |
|---------------------------------|--------------|--------------|------------------------------------------------------------------|
| Old-style `MOCK_METHODn` macros | Deprecated   | Since 2018   | Use `MOCK_METHOD` macro throughout mock classes                   |
| Legacy ACTION macros             | Discouraged  | Ongoing      | Convert to lambdas or functors                                   |
| Support for C++ versions &lt;17 | Removed      | 1.17.x       | Upgrade compiler toolchains                                       |

---

## Timeline & Deprecation Schedule

| Change                                    | Deprecated Version | Removed Version (Planned) |
|-------------------------------------------|--------------------|---------------------------|
| Old mock method macros replacement        | 1.8.0 (2018)       | Complete in main branch    |
| C++17 minimum version requirement         | 1.17.x (Recent)     | Immediate                 |
| Strict enforcement of `EXPECT_CALL` order | 1.12.0             | Current                    |

---

## Additional Migration Tips

- Always migrate `MOCK_METHOD` macro declarations to the `public:` section.
- When overloading mock methods, ensure all overloads are declared to avoid hiding base methods.
- Use `ON_CALL()` for setting default behaviors without imposing call expectations; prefer `EXPECT_CALL()` only where call verification is needed.
- Avoid over-specifying expectations to reduce brittle tests.
- For debugging failing tests or unexpected behaviors, enable `--gmock_verbose=info`.

---

## Cross-References and Further Reading

- [Mocking Reference](docs/reference/mocking.md) — Comprehensive explanation of mock macros and modifiers.
- [gMock Cookbook](docs/gmock_cook_book.md) — Practical recipes and common mock usage patterns.
- [Matchers Reference](api-reference/gmock-apis/matchers-reference.mdx) — Complete list of matchers.
- [Actions Reference](api-reference/gmock-apis/actions-reference.mdx) — Actions used to define mock behaviors.
- [Nice, Naggy, and Strict Mocks](api-reference/gmock-apis/nice-strict-mocks) — Behavior modifiers for mocks.
- [System Requirements](getting-started/prerequisites-installation/system-requirements.md) — Platform and compiler support.

---

## Relevant Source Files for Examples and Validation

- `googlemock/test/gmock_spec_builders_test.cc` — Tests syntax and semantics of `EXPECT_CALL` and `ON_CALL` modifiers.
- `googlemock/test/gmock_test.cc` — Core behavioral tests illustrating changes in default behaviors and flags.
- `docs/reference/mocking.md` — Official macro and class references.
- `docs/gmock_cook_book.md` — Recipes for migrating mock class declarations and actions.

---

## Summary

This document serves as a comprehensive guide to handling breaking changes and migrations for GoogleTest and GoogleMock users. It emphasizes understanding API evolutions, correctly setting expectations and mock behaviors, compiler and standard compliance, and best practices to maintain effective and robust tests.

For a smooth and maintainable upgrade experience, carefully review these notes, adapt your test code accordingly, and leverage the extensive examples and recipes in the referenced documentation.