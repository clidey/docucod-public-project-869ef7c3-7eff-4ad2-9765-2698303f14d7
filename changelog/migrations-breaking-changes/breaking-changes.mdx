---
title: "Breaking Changes & Migration Guide"
description: "Documents any release that introduces breaking changes, explains the impact, and guides users on migrating their code. Highlights language standard updates, API removals, and major dependency shifts."
---

# Breaking Changes & Migration Guide

This guide focuses specifically on releases of GoogleTest and GoogleMock that introduce breaking changesâ€”modifications that can affect existing test code, usage of mocks, or integration setups. It not only documents what has changed but also guides you on understanding the impact and migrating your test suites and mocks smoothly.

---

## Understanding Breaking Changes

Breaking changes are updates that modify the behavior, interfaces, or dependencies of GoogleTest and GoogleMock in ways that require users to adjust their test code. These can include:

- Changes to supported C++ standards or compiler requirements.
- Removal or deprecation of APIs, macros, or language features.
- Alterations in default mock behaviors or expectations.
- Updates to dependencies that cause incompatibilities.

Being aware of breaking changes helps maintain your test code's compatibility and take advantage of new language features or improvements safely.


## Types of Breaking Changes Documented Here

### Language Standard Requirements

- GoogleTest and GoogleMock now require a minimum of **C++17**. Attempting to build or use them with older standards will result in compilation errors.
- All supported compilers must fully support C++17 features to work with the latest releases.

### API and Macro Changes

- The legacy `MOCK_METHODn` macros have been superseded by the unified `MOCK_METHOD` macro with enhanced capabilities.
- Macros like `MOCK_CONST_METHODn` and the specialized `MOCK_METHODn_WITH_CALLTYPE` have been replaced by the newer format using qualifiers such as `(const)` and `Calltype()`.
- If you used the old macros, you must migrate to the new style:

```cpp
// Old style
MOCK_CONST_METHOD1(Foo, int(int));

// New style
MOCK_METHOD(int, Foo, (int), (const));
```

- Overloaded and templated method mocking syntax has been unified under `MOCK_METHOD` but careful attention to qualifiers and overloads may be required.

---

### Mocking Behavior Changes

- By default, mock objects are **naggy** (warn on uninteresting calls). However, a future release plans to flip this to **nice** by default, suppressing warnings on uninteresting calls. Prepare to explicitly use `NaggyMock` or `NiceMock` if you depend on this behavior.
- The way expectations (`EXPECT_CALL`) override older ones has been clarified and reinforced: newer expectations take precedence, so order matters more than before.
- The `RetiresOnSaturation()` clause behavior is formalized: expectations with bounded cardinality may retire after saturation to allow fallback matching.
- When mocking methods with move-only types (e.g., `std::unique_ptr`), the newer releases offer solid support. Older workaround patterns involving forwarding methods may be deprecated; consider updating mocks accordingly.

---

### Dependency and Build System Changes

- Minimum required dependencies have been updated (e.g. Abseil versions), which may impact your build system or linkage.
- Support for certain platforms or compilers have been dropped; verify your environment complies with the updated compatibility matrix.

---

## Migration Strategies

### General Recommendations

- **Review your `MOCK_METHOD` usage:** Ensure you use the new macro format with appropriate qualifiers. See the [Mocking Reference](../reference/mocking.md) for exact syntax.
- **Adjust expectations order:** Place more general `EXPECT_CALL` statements earlier and specific ones later.
- **Handle uninteresting calls explicitly:** If your tests rely on warnings about uninteresting calls, migrate to using `NaggyMock` or explicitly add catch-all `EXPECT_CALL` with `Times(AnyNumber())`.
- **Update move-only mocks:** Refactor mocks that used legacy patterns for move-only arguments to the new direct mocking support.

### Example Migration of Mock Method Macros

Old:
```cpp
MOCK_CONST_METHOD1(GetValue, int(int key));
```
New:
```cpp
MOCK_METHOD(int, GetValue, (int key), (const));
```

Old:
```cpp
MOCK_METHOD1_WITH_CALLTYPE(STDMETHODCALLTYPE, DoStuff, bool(int flags));
```
New:
```cpp
MOCK_METHOD(bool, DoStuff, (int flags), (Calltype(STDMETHODCALLTYPE)));
```

### Handling Expectations Order

```cpp
using ::testing::_;
using ::testing::Return;

EXPECT_CALL(mock, Foo( _ ))          // general catch-all.
    .Times(AnyNumber())
    .WillRepeatedly(Return(false));
EXPECT_CALL(mock, Foo(5))             // more specific
    .Times(1)
    .WillOnce(Return(true));
```

In this setup, the call `Foo(5)` will match the second expectation due to reverse order precedence.

### Using NiceMock and StrictMock Explicitly

```cpp
using ::testing::NiceMock;
using ::testing::StrictMock;

NiceMock<MyMock> nice_mock;      // suppress warnings on uninteresting calls
StrictMock<MyMock> strict_mock;  // fail on uninteresting calls
```

Use these wrappers to control mock strictness explicitly as needed.

---

## Common Pitfalls

- Forgetting to add `(override)` or `(const, override)` qualifiers to `MOCK_METHOD` causes compilation errors or incorrect behavior.
- Misordering expectations leads to unexpected matches or failures; always structure `EXPECT_CALL`s with the general cases first, more specific later.
- Using deprecated `MOCK_METHODn` macros may cause breaks. Migrate all to `MOCK_METHOD`.
- Unintended uninteresting calls generate warnings or errors; manage these with explicit expectations or switch mock strictness.

---

## Troubleshooting

- Use `--gmock_verbose=info` to get detailed output about mock calls and matching expectations.
- Compile with `-Wall` and address warnings about mismatched qualifiers or deprecated macro usage.
- Consult the [Mocking Reference](../reference/mocking.md) and [gMock Cookbook](../gmock_cook_book.md) for examples and migration patterns.

---

## Additional Resources

- [Mocking Reference](../reference/mocking.md): detailed macro and class documentation.
- [gMock for Dummies](../gmock_for_dummies.md): beginner-friendly usage guide.
- [gMock Cookbook](../gmock_cook_book.md): recipes and advanced topics.
- [Expectations and Strictness Controls](../api-reference/mocking-api/strictness-controls.mdx)

## Summary

By aligning your code with the new requirements and conventions outlined in this guide, you will smoothly migrate to the latest GoogleTest and GoogleMock versions, benefiting from modern C++ features, improved maintainability, and enhanced mock behaviors.

---

For further detailed version-by-version changelogs and migration steps, see the [Release Notes & Version History](../release-notes-history/latest-release) and [Step-by-Step Upgrade Guide](../upgrade-support/upgrade-guide).

---

### Example Migration Checklist

1. Ensure your build environment uses **C++17 or later**.
2. Replace all legacy `MOCK_METHODn` macros with `MOCK_METHOD`.
3. Add required qualifiers `(const)`, `(override)`, `(noexcept)`, or `Calltype(...)`.
4. Reorder expectations to place specific matchers after general ones.
5. Use `NiceMock` or `StrictMock` wrappers explicitly when needed.
6. Validate tests using verbose logging to catch unexpected calls.
7. Adjust for any API removals or dependency updates.

---

You are now ready to tackle any breaking changes introduced in recent releases. Happy testing!
