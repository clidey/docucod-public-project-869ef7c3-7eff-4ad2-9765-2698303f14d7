---
title: "Upgrade Guide"
description: "Provides step-by-step recommendations and code migration patterns for users upgrading from earlier versions. Focuses on practical solutions, code samples, and troubleshooting advice for a smooth transition."
---

# Upgrade Guide

GoogleTest evolves to provide powerful testing capabilities while maintaining backward compatibility as much as possible. This Upgrade Guide is your step-by-step companion to smoothly transition from earlier versions of GoogleTest to the latest releases. It focuses on practical migration patterns, code samples, and troubleshooting to help you adapt your test code, build configurations, and usage to recent changes with confidence.

---

## 1. Preparing for Upgrade

### Verify Your Toolchain and Environment
- Ensure your compiler and build environment supports at least **C++17**, as starting with version 1.17.x, GoogleTest requires it.
- Confirm your build system (CMake, Bazel, etc.) has been updated accordingly. See [Supported Platforms & Requirements](/overview/adoption-and-integration/supported-platforms-and-requirements) for detailed compatibility.

### Back Up Your Tests
- Before proceeding, save a copy of your existing test code and build configuration.
- Run a full test suite to baseline current outcomes.

<Tip>
Upgrading generally does not require rewriting all tests, but you must adapt deprecated APIs, macros, and build flags.
</Tip>

## 2. Key Code and Macro Changes

### Replace Deprecated Macros
- **`TEST_CASE`** is deprecated; replace with **`TEST_SUITE`** if used.
- Use the preferred `TEST_SUITE` terminology for grouping related tests to align with current GoogleTest nomenclature.

### Adapting Test Fixture Setup and Teardown
- Replace older `SetUpTestCase` and `TearDownTestCase` methods inside fixtures with `SetUpTestSuite` and `TearDownTestSuite`.

```cpp
class MyTest : public testing::Test {
 protected:
  static void SetUpTestSuite() {
    // Setup shared resources across tests
  }

  static void TearDownTestSuite() {
    // Cleanup shared resources
  }
};
```

> This migration ensures future compatibility and clearer meaning of suite-wide setup.

### Assertion and Expectation Updates

- Review your use of assertion macros; deprecated legacy versions may generate warnings.
- Continue to use `ASSERT_*` for fatal, test-aborting assertions, and `EXPECT_*` for non-fatal assertions.
- If using `ASSERT_*` macros inside loops or multiple checks, consider impact on test control flow.

### Mitigate Naming Conflicts
- If defining your own macros or if you encounter macro clashes, use explicit GoogleTest-prefixed macros (e.g., `GTEST_TEST` instead of `TEST`) by defining `-DGTEST_DONT_DEFINE_TEST=1` in your build.

## 3. Build and Configuration Changes

### C++17 Requirement

GoogleTest 1.17.x requires C++17. You must update your build configuration accordingly:

- **CMake:** `set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)`

- **Bazel:** Ensure your `cc_toolchain` uses a C++17-compatible compiler.

<Tip>
If your project requires C++14 or earlier, stay on earlier GoogleTest branches until ready to upgrade.
</Tip>

### Updated Flags and Options

- Confirm any custom flags and environment configurations follow changes introduced in newer versions.
- Pay attention to the `also_run_disabled_tests`, `break_on_failure`, and `shuffle` flags as their behavior or defaults may have evolved.

## 4. Major Breaking Changes and Migration Patterns

### Mandatory C++17 Compliance
- Required from release 1.17.x onward.
- Refactor your test and build code to comply.

### Macro Refinements
- Some internal macro definitions have changed; review macro-based test registration code.

### Code Example: Migrating Test Fixture Setup

Before:
```cpp
class MyOldTest : public testing::Test {
 public:
  static void SetUpTestCase() {
    // Old-style setup
  }
  static void TearDownTestCase() {
    // Old-style teardown
  }
};
```

After:
```cpp
class MyTest : public testing::Test {
 public:
  static void SetUpTestSuite() {
    // New preferred setup
  }
  static void TearDownTestSuite() {
    // New preferred teardown
  }
};
```

### Handling Deprecated APIs
- If you use legacy APIs marked for deprecation, refactor to the new alternatives.
- The old `TestCase` API has been replaced by `TestSuite`—update test grouping.

## 5. Troubleshooting Common Issues

### Tests Not Running After Upgrade
- Check if your tests are properly registered with `RUN_ALL_TESTS()`.
- Verify test filters and sharding options.

### Build Errors Related to C++17
- Confirm your compiler supports C++17.
- Update build flags, toolchains, and environment variables.

### Unexpected Assertion Behavior
- Verify `ASSERT_` and `EXPECT_` usage follows proper fatal/non-fatal semantics.

### Macro Collision Errors
- Use namespaced GoogleTest macros or define overrides to avoid conflicts.

<Warning>
If you encounter issues after upgrading, reviewing the related [Breaking Changes](/changelog/breaking-changes-upgrade/breaking-changes) page is critical for stepwise restoration.
</Warning>

## 6. Practical Tips and Best Practices

- **Incremental Upgrade:** Upgrade one module or test suite at a time to isolate issues.
- **Automate Regression Testing:** Use CI to validate all tests on new GoogleTest versions.
- **Review Example Tests:** Look at [GoogleTest Primer](https://google.github.io/googletest/primer.html) for up-to-date test idioms.
- **Use Static Analysis:** Check your test code for deprecated patterns or macro misuse.
- **Leverage Default Test Environments:** Use `AddGlobalTestEnvironment()` to manage setup outside suites efficiently.

## 7. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — Quick learning path.
- [Breaking Changes Documentation](/changelog/breaking-changes-upgrade/breaking-changes) — Detailed migration details.
- [Supported Platforms & Requirements](/overview/adoption-and-integration/supported-platforms-and-requirements) — Verify environment compatibility.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — For migration involving mocks.
- [GitHub Release Notes](https://github.com/google/googletest/releases) — Official changelogs with fixes and features.

## 8. Example Upgrade Workflow

<Steps>
<Step title="Backup and Environment Check">
Ensure your current tests and environment are backed up and compatible with C++17.
</Step>
<Step title="Update Build System">
Modify CMakeLists or Bazel to require and enable C++17.
</Step>
<Step title="Adjust Test Code">
Replace deprecated macros and fixture methods with current API usage.
</Step>
<Step title="Run Existing Tests">
Compile and run tests, observe failures and target fixes.
</Step>
<Step title="Iterate and Refine">
Fix issues starting from build errors, then failing tests, to stabilize tests on the new version.
</Step>
<Step title="Integrate Continuous Testing">
Ensure upgrade success by running tests in CI for automated validation.
</Step>
</Steps>

---

For a smooth transition, carefully follow this Upgrade Guide in conjunction with detailed [Breaking Changes Documentation](/changelog/breaking-changes-upgrade/breaking-changes) and release notes. Embrace the improvements GoogleTest brings and gear your tests for reliability, speed, and modern C++ support.

<Check>
Always run `RUN_ALL_TESTS()` after upgrade to verify completeness of migration.
</Check>

---