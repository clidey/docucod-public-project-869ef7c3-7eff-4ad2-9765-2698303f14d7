---
title: "Breaking Changes"
description: "Highlights changes that may break existing tests or integrations, such as required compiler version updates, library API shifts, or major dependency changes. Information here helps developers assess the impact and schedule safe upgrades."
---

# Breaking Changes

This page highlights **breaking changes** in GoogleTest that may affect your existing tests or integrations. These include updates that require newer compiler versions, shifts in library APIs, or major dependency changes. Understanding these changes ensures you can plan your upgrades safely and minimize disruptions.

---

## Why Breaking Changes Matter

Breaking changes have a direct impact on your development workflow. They can cause tests to fail, compilation errors, or unexpected behavior if not addressed properly. This page serves as a checkpoint for developers to assess the risks and plan migrations accordingly.

---

## Key Categories of Breaking Changes

### 1. Compiler Version Requirements

- GoogleTest enforces a minimum compiler version, such as requiring **C++17 support or later**.
- Attempting to compile with unsupported compiler versions will result in errors.
- Be sure to verify your development environment's compliance before upgrading.

**Example:**

```cpp
// From gtest-port.h
#if !defined(GTEST_INTERNAL_CPLUSPLUS_LANG) || \
    GTEST_INTERNAL_CPLUSPLUS_LANG < 201703L
#error C++ versions less than C++17 are not supported.
#endif
```

**Action:** Upgrade your compiler to at least C++17 compatible version before integrating recent GoogleTest releases.

### 2. API Adjustments and Macro Changes

- Certain macros, APIs, or behaviors have changed which affect backward compatibility.
- Names, behaviors, or requirements around test fixtures, assertions, and death tests may have evolved.
- For instance, new rules about test suite and test name restrictions, or about how death tests function internally.

**Important:**

- Avoid underscores in test suite and test names as these can lead to ambiguous generated class names.
- Fatal assertions (`ASSERT_*`) inside constructors or destructors are disallowed.

### 3. Dependency and Platform Support

- Some platform or OS-specific changes may require updates.
- Usage of POSIX threads, clone semantics in Linux, and Windows-specific behavior may be adjusted.

### 4. Death Test Style and Behavior

- The default death test style remains "fast", but "threadsafe" style is strongly recommended in multi-threaded environments.
- Behavior of death tests now better handles multi-threaded programs and more accurately reports assertion failures and exit statuses.

**Tip:**

- Set death test style explicitly:

```cpp
GTEST_FLAG_SET(death_test_style, "threadsafe");
```


---

## Preparing for Breaking Changes

To ensure a smooth transition:

- **Review compiler versions:** Confirm your toolchain meets the minimum requirements.
- **Check test suite and test names:** Follow guidelines to avoid underscores and reserved patterns.
- **Adjust death tests:** Ensure death test usage adheres to recommended naming conventions and styles.
- **Validate mocks and matchers:** If using GoogleMock, check changes in expectations and behaviors.
- **Read upgrade guides:** Follow the official [Upgrade & Migration Guides](../breaking-changes-upgrade/upgrade-migration-guides).

---

## Common Breakage Scenarios

### Fatal Assertions in Non-void Functions

- Fatal assertions (`ASSERT_*`, `FAIL()`) **must only appear in void-returning functions.**
- Using them inside constructors or destructors will cause compile errors.

This rule prevents unexpected failures or aborted tests due to improper use of macros.

### Mixing TEST and TEST_F in the Same Test Suite

- All tests within a test suite must share the **same fixture class**.
- Mixing `TEST()` and `TEST_F()` in one suite causes runtime failures.

### Instantiating Parameterized Tests

- Each parameterized test defined with `TEST_P` must be instantiated using `INSTANTIATE_TEST_SUITE_P`.
- Failure to instantiate leads to zero tests being run and an error message.

### Stream Operator Overloads

For custom types used in assertions, ensure:
- `operator<<` is defined for output.
- Or implement `AbslStringify()` or `PrintTo()` correctly.

Lack of these may produce unintelligible output on assertion failures.

---

## Best Practices to Prevent Breakages

- **Upgrade compilers early** to the supported C++17 standard or higher.
- **Adhere to naming rules:** Avoid underscores that can confuse internal test class name generation.
- **Separate death tests:** Use suites ending with `DeathTest` suffix as advised.
- **Use typed or parameterized tests properly:** Actually instantiate all defined parameterized tests.
- **Avoid fatal assertions in constructors/destructors:** Use `SetUp()` and `TearDown()` for setup-related assertions.

---

## Troubleshooting

### Compilation Errors about C++ Versions

Ensure your compiler supports C++17 or later. Upgrade your build environment accordingly.

### Unexpected Test Failures Due to Fixture Mismatches

Verify your suites do not mix `TEST` and `TEST_F` or tests using different fixtures under the same suite name.

### Death Test Erratic Behavior

Make sure your test executables are invoked with paths containing separators
(such as `./my_test`), or configure death test style to "threadsafe".

### Parameterized Tests Not Running

Include matching `INSTANTIATE_TEST_SUITE_P` calls for each `TEST_P` to instantiate parameterized tests.

---

## Summary of Change Highlights

| Area                       | Change Summary                                                  |
|----------------------------|----------------------------------------------------------------|
| Compiler Support           | Requires C++17 or newer compilers.                             |
| Test Naming Restrictions    | Prohibits underscores in test suite and test names.            |
| Fixture Consistency         | All tests in a suite must use the same fixture class.          |
| Death Tests                 | Introduced "threadsafe" style for improved stability.         |
| Assertion Usage             | Fatal assertions disallowed in non-void functions and ctors.    |
| Parameterized Test Instantiation | Must instantiate all parameterized tests explicitly.             |

---

## Related Documentation

- [Installation Guide](../../getting-started/setup-installation/installation-guide): See prerequisites for compiler requirements.
- [FAQ on Assertion Failures](../../faq/general-faq/assertions-failures): Understand assertion error reports.
- [Death Tests Guide](../../guides/performance-and-specialized-use-cases/writing-and-using-death-tests): Best practices for death tests.
- [Upgrade & Migration Guides](../breaking-changes-upgrade/upgrade-migration-guides): Step-by-step instructions for upgrading.

---

## Practical Upgrade Workflow

1. **Backup your code and test data.**
2. **Upgrade your compiler/toolchain** to support C++17 (or latest recommended version).
3. **Rename test suites** to avoid underscores and ensure uniqueness.
4. **Separate death tests** into suites ending with `DeathTest`.
5. **Check all parameterized tests** have corresponding instantiations.
6. **Replace fatal assertions in constructors/destructors** with `SetUp()` methods.
7. **Run all tests** and address failures.
8. **Use logs and debug output** to pinpoint issues from breaking changes.
9. **Consult this page and related documentation** if unexpected errors occur.

---

<Tip>
Upgrading proactively avoids subtle runtime failures or compiler errors. Use `--gtest_filter` and other test filtering flags to gradually validate your test suites during migration.
</Tip>

---

_For detailed release notes and all changes, visit the [Detailed Release Notes](../release-history/detailed-release-notes) page._


---

### Example: Naming Restrictions

Consider the following invalid test suite names that must be fixed:

```cpp
// Avoid leading or trailing underscores.
TEST(_MySuite, MyTest) { ... }         // Invalid
TEST(MySuite_, MyTest) { ... }        // Invalid

// Avoid multiple consecutive underscores in combined generated names.
TEST(Time, Flies_Like_An_Arrow) { ... }
TEST(Time_Flies, Like_An_Arrow) { ... }

// Correct usage:
TEST(TimeFlies, LikeAnArrow) { ... }
```


### Example: Death Test Naming

```cpp
class FooTest : public testing::Test { ... };
using FooDeathTest = FooTest;

TEST_F(FooTest, RegularTest) {
  ...
}

TEST_F(FooDeathTest, DeathTest) {
  ASSERT_DEATH(SomeFunc(), "pattern");
}
```

---