---
title: "Breaking Changes"
description: "Documents all API or behavioral changes that require user attention during upgrades. Alerts developers to features removed, changed, or now requiring migration effort, ensuring stability and predictability."
---

# Breaking Changes

This page alerts developers to all API or behavioral changes in GoogleTest and GoogleMock that require user attention during upgrades. It documents features or behaviors that have been removed, significantly altered, or now require migration effort to maintain test stability and predictability.

---

## Purpose of This Page

As GoogleTest and GoogleMock evolve, some changes may break backward compatibility with existing test code. This page helps you:

- Quickly identify breaking changes introduced in new releases
- Understand the impact on your existing test suites
- Follow migration steps where applicable to update your code

Keeping aligned with this section ensures your tests continue to run smoothly on upgraded versions.

---

## What Constitutes a Breaking Change

A breaking change includes any alteration that could cause your existing test code or mocks to fail to compile or produce incorrect results without modification. Common types of breaking changes include:

- Removal or renaming of public APIs (functions, macros, classes, methods)
- Changes to the signatures or expected behaviors of mocked methods
- Modifications to default behaviors that affect test outcomes
- Changes in macro expansions or new mandatory qualifiers
- Alterations in configuration flags that change test execution or mocking behavior

GoogleTest headlines and documents such changes here with migration advice.

---

## Recent Breaking Changes

### Version 1.17.0 and onward

- **Mandatory C++17 support:** Minimum language standard is now C++17. Tests and mocks must be compiled with C++17 or higher.
- **Enhanced GoogleMock macros:** The primary `MOCK_METHOD` macro now mandates careful usage of parentheses when mocking methods with templated return or argument types to avoid parsing issues.
- **Thread safety updates:** Internal synchronization primitives are refined; user code should ensure C++17 compatible threading libraries.
- **Deprecation of legacy `MOCK_METHODn` macros**: Migration to the generic `MOCK_METHOD` macro is highly recommended to avoid incompatibilities.

Refer to the [Latest Release Details](https://github.com/google/googletest/releases/tag/v1.17.0) for complete change logs.

---

## Migration Guidelines

When upgrading to versions with breaking changes, follow these steps to minimize disruption:

1. **Verify compiler and standard support:** Confirm your build environment uses a compatible C++17 compiler.
2. **Refactor mocks to use `MOCK_METHOD` macro:** Replace any legacy `MOCK_METHODn` usage with the new syntax as documented.
3. **Check method declarations containing commas:** For methods returning types with commas (e.g., `std::pair<bool,int>`), ensure you wrap such types in parentheses when using `MOCK_METHOD`.

   ```cpp
   // WRONG:
   MOCK_METHOD(std::pair<bool, int>, GetPair, ());  // Will fail to compile

   // CORRECT - wrapping return type in parentheses:
   MOCK_METHOD((std::pair<bool, int>), GetPair, ());
   ```

4. **Review test logs after upgrade:** Pay attention to warnings or errors from GoogleMock about matchers, expectations, or deprecated usage.
5. **Update threading code as necessary:** Ensure your environment supports the threading primitives expected by GoogleTest's internals.

---

## Known Breaking Changes Examples

### Mock Method Macro Changes

The introduction of the generic `MOCK_METHOD` macro replaces the older `MOCK_METHODn` family. Its parameters must be carefully formulated:

- Return types or arguments with commas must be enclosed in extra parentheses.
- Qualifiers like `const`, `override`, or `noexcept` must be explicitly spelled out.

**Example:**

```cpp
class MockFoo {
 public:
  MOCK_METHOD((std::pair<bool, int>), GetPair, (), (const, override));
};
```

### Strict Enforcement on `EXPECT_CALL` Clause Ordering

`EXPECT_CALL` expects modifier clauses like `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()` in a defined order. Violations or multiple use of clauses that should appear only once now cause failures.

Ensure that `.With()` is the first clause and that `.WillByDefault()` appears exactly once in `ON_CALL`.

### Removal or Change in Legacy Features

Some older macros and helper constructs have been deprecated in favor of cleaner, more consistent APIs. Review any use of deprecated features and migrate accordingly.

---

## Troubleshooting Tips for Breaking Changes

- **Compilation errors related to `MOCK_METHOD`:** Double-check parentheses around complex types and ensure qualifiers conform to requirements.
- **Unexpected mock failures after upgrade:** Examine changes in the default behavior or cardinalities inferred by GoogleMock and specify explicit expectations where necessary.
- **Threading-related test issues:** Verify platform and build compatibility with C++17 threading support as required by recent GoogleTest versions.

If needed, consult the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) and [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) for best practices.

---

## Additional Resources

- [Upgrade Guide](https://google.github.io/googletest/changelog/breaking-changes-upgrade/upgrade-guide)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [Using GoogleMock Effectively Guide](https://google.github.io/googletest/guides/mocking.html)
- [Latest Release Notes on GitHub](https://github.com/google/googletest/releases)

---

## Summary

This page is your primary reference for understanding changes in GoogleTest and GoogleMock that could disrupt your existing tests when upgrading. It empowers you to anticipate impacts, plan migrations, and keep your test suite robust and maintainable.

<Tip>
Staying current with breaking changes ensures seamless continuous integration and avoids surprises during test runs. Regularly reviewing this page during upgrades saves time and frustration.
</Tip>

<Warning>
Always back up your test code and carefully test after upgrading the framework, especially if your mocks use complex signatures or threading.
</Warning>
