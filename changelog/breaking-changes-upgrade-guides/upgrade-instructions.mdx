---
title: "Upgrade Instructions and Best Practices"
description: "Guides users through upgrading framework versions smoothly — highlighting common pitfalls, manual steps, and testing strategies to ensure projects remain stable. Covers everything from syncing dependencies to updating build files."
---

# Upgrade Instructions and Best Practices

Upgrade Instructions and Best Practices is your essential guide to smoothly transition your projects to newer versions of the GoogleTest framework. This page walks you through critical upgrade workflows, highlights common pitfalls, and shares expert strategies for manual adjustments and validation testing to maintain stability and confidence in your tests.

---

## Understanding the Upgrade Journey

Upgrading a test framework like GoogleTest can feel daunting, especially in large or complex projects. This guide transforms that process into a structured series of steps, ensuring minimal disruption and empowering you to confidently adopt new features and improvements.

Your goal is to:

- Synchronize dependencies accurately.
- Update build configurations and files effectively.
- Verify your test code adapts smoothly without regressions.

By following the recommended flow, you avoid common stumbling blocks like broken mock implementations, mismatched macros, or unexpected behavior changes.

---

## Preparing for Upgrade

Before diving into code changes, take these preparatory actions to pave the way for a trouble-free upgrade:

1. **Backup Your Existing Setup**: Always keep a copy of your current build files and test code to compare and revert if necessary.

2. **Review Release Notes and Migration Guides**: Familiarize yourself with the relevant breaking changes and new features by checking the official release highlights and migration notes.

3. **Check Your Environment Compatibility**: Ensure your build environment meets the new version’s requirements, such as the minimum C++17 standard support in recent releases.

4. **Update Dependency Management Tools**: If you rely on package managers or submodules, update them to the supported versions reflecting the new GoogleTest release.

---

## Step-by-Step Upgrade Workflow

This section lays out a clear, user-focused procedure to safely upgrade your GoogleTest framework.

### Step 1: Sync Dependencies

- Pull the latest stable GoogleTest source or update your package manager references.
- For CMake projects, update your `find_package` commands or submodule references; for Bazel, adapt workspace and build files accordingly.

### Step 2: Update Build and Configuration Files

- Modify your build scripts to link against updated libraries.
- Adjust compiler flags to specify at least C++17 if upgrading to version 1.17.x or later.
- Check for and remove deprecated macros or flags.

### Step 3: Refactor Test Code for API Changes

- Replace any obsolete mock method macros (e.g., old `MOCK_METHODn` macros) with the unified `MOCK_METHOD` syntax.
- Adapt to changes in expectation handling behaviors, particularly how uninteresting and unexpected mock calls are reported.
- Verify that your mocks correctly use `override` and qualifiers aligned with the latest standards.

### Step 4: Run Incremental Tests

- Execute your test suite in a controlled environment.
- Identify failures or warnings signaling deprecated constructs or behavioral differences.

### Step 5: Address Common Pitfalls

- **Mock Method Signature Mismatches:** Ensure all mock methods fully match the signatures of the interfaces, including constness and noexcept specifications.
- **Uninteresting Call Warnings:** Consider using `NiceMock` or explicitly set expectations to reduce noisy warnings.
- **Test Flakiness Around Death Tests:** Due to execution model changes, rerun and validate death tests carefully.

### Step 6: Validate Comprehensive Stability

- After resolving any issues, run full regression tests.
- Thoroughly verify behavior remains consistent, particularly for mocks, expectations, and custom assertions.

### Step 7: Finalize and Document

- Document any manual changes and custom adaptations.
- Share upgrade notes with your team to align practices and future maintenance.

---

## Testing Strategies During Upgrade

Upgrading is not only about changing code but also about validating that your tests remain reliable. Here are key testing strategies to adopt:

- **Incremental Testing:** Gradually upgrade components and test frequently rather than all at once.

- **Use Extra Verbosity:** Run tests with verbose GoogleTest flags to spot subtle issues early.

- **Leverage Mocking Best Practices:** Adopt `ON_CALL` for default behaviors and `EXPECT_CALL` only where explicit verification is needed to reduce brittle tests.

- **Run Performance Benchmarks:** Ensure test suite performance is unaffected or improved.

- **Monitor Deprecation Warnings:** Track and resolve any deprecated API usage.

---

## Practical Tips and Best Practices

- When migrating mocks, prefer the modern `MOCK_METHOD` macro over legacy macros to benefit from improved clarity and compiler diagnostics.
- Annotate overridden mock methods with `override` to catch signature mismatches at compile time.
- Use `NiceMock` wrappers to silence warnings for calls you do not explicitly expect.
- Regularly consult the Breaking Changes & Migration Notes page during upgrade planning.
- Backup and version control build and test files independently before applying upgrade changes.

---

## Troubleshooting Common Issues

| Issue                                                                                      | Resolution                                                                                                                                              |
| ------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Test failures due to mock method signature changes                                         | Verify and update all mock methods to use consistent, correct signatures including constness and override.                                             |
| Excessive warnings about uninteresting mock calls                                          | Wrap mocks with `NiceMock` or explicitly state `.Times(AnyNumber())` expectations.                                                                         |
| Build errors related to C++ standard version                                              | Adjust your build scripts or compiler flags to enforce the required C++17 or higher standard.                                                           |
| Deprecated macro or API usage reports                                                     | Refactor legacy mock declarations to modern syntax; consult migration notes.                                                                            |
| Test flakiness, especially for death tests                                                | Confirm death test styles and execution environments; rerun tests individually to isolate issues.                                                       |

<Tip>
If you encounter an upgrade challenge not addressed here, consult the full [Breaking Changes & Migration Notes](https://github.com/google/googletest/blob/main/docs/changelog/breaking-changes-upgrade-guides/breaking-changes.md) and test your changes incrementally.
</Tip>

---

## Summary

Upgrading GoogleTest entails carefully synchronizing dependencies, adjusting build configurations, refactoring test code for API changes, and validating your tests in a stepwise, structured manner. By following these upgrade instructions and embracing the best practices outlined here, you ensure that your test suites remain stable, maintainable, and ready to leverage new framework features.

---

## Additional Resources

- [Breaking Changes & Migration Notes](https://google.github.io/googletest/changelog/breaking-changes-upgrade-guides/breaking-changes)
- [Mocking for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Assertions Reference](https://google.github.io/googletest/reference/assertions.html)
- [Integration with Build & CI Systems](https://google.github.io/googletest/overview/audience-usecases-integration/integration-points.html)
- [Full Release History](https://google.github.io/googletest/changelog/release-highlights/full-release-history)

For hands-on commands and examples to update your CMake or Bazel build files, see the [Build System Integration](https://google.github.io/googletest/guides/integration-scenarios/build-system-integration) guide.

---

_Last updated with instructions aligned to the latest GoogleTest releases on the [main branch](https://github.com/google/googletest/tree/main)._