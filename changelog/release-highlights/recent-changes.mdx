---
title: "Recent Changes"
description: "Provides a quick-glance list of notable additions, improvements, and bug fixes introduced in recent releases. Enables users to stay up-to-date and leverage new capabilities."
---

# Recent Changes

Stay current with the latest updates in GoogleTest and GoogleMock by reviewing this quick reference of notable improvements, feature additions, and bug fixes. This page helps you quickly understand the practical impact of recent releases, so you can leverage new capabilities effectively.

---

## 1. Key Updates and Improvements

### Enhanced Strictness Modifiers
- Introduction of convenient wrappers `NiceMock`, `NaggyMock`, and `StrictMock` that let you control warnings and failures for unexpected or uninteresting mock calls at the mock object level.
- These wrappers inherit constructors from your mock classes, simplifying usage.
- Usage tips and limitations documented to avoid common pitfalls with inheritance and destructors.

### Expanded Spec Builder Syntax Support
- Full support for chaining expectation modifiers like `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()`.
- Runtime enforcement of clause ordering and cardinality constraints to detect specification errors early.
- Improved flexibility for setting expectations that require complex argument matching, cardinalities, and call ordering.

### Robust Cardinality Management
- Built-in cardinalities such as `AnyNumber()`, `AtLeast()`, `AtMost()`, `Between()`, and `Exactly()` with precise semantic enforcement.
- Support for custom cardinalities through implementing `CardinalityInterface`.
- Detailed error reporting when expected call counts do not match actual calls, including upper-bound saturation and over-saturation.

### Improved Default Action Handling
- `ON_CALL` allows setting default behaviors for mock methods without setting expectations on call counts.
- Enforcement that each `ON_CALL` includes exactly one `.WillByDefault()` clause.
- Clear precedence rules between `EXPECT_CALL` and `ON_CALL` behaviors.

### Diagnostic and Logging Enhancements
- Google Mock's log messages provide precise location reporting with stack traces based on verbosity settings (`info`, `warning`, `error`).
- Uninteresting calls, unexpected calls, excessive calls, and unsatisfied expectations are reported with comprehensive diagnostics.
- Configurable verbosity flags allow tailoring the amount of diagnostic output.

### Thread Safety and Mock Lifecycle
- All mock method registration, invocation, and verification are protected with a global mutex ensuring thread safety.
- Automatic verification of expectations when mock objects are destructed with support for explicit verification and clearing via `Mock::VerifyAndClearExpectations()` and `Mock::VerifyAndClear()`.
- Leakage detection of mock objects at program exit, with options to allow leaks using `Mock::AllowLeak()`.

### New API Usability and Flow Improvements
- Seamless integration of implicit sequences via `InSequence` objects in test code, managing the order of expectations without manual sequence management.
- Support for partial order call expectations using multiple `Sequence` objects and `After()` clauses.
- Simplified macro-based expectation setting (`EXPECT_CALL`, `ON_CALL`) with enforcement of matching and ordering rules.

---

## 2. Common Use Case Scenarios

### Defining and Using Mocks
- Define mock classes using `MOCK_METHOD` macros within `public` sections.
- Use `EXPECT_CALL` to specify expected calls with argument matchers, call counts, and actions.
- Use `ON_CALL` to set default actions when you do not require call count expectations.

### Controlling Uninteresting Calls
- Choose between NiceMock, NaggyMock, and StrictMock wrappers to control treatment of uninteresting calls from silent acceptance to warning or failure.
- Apply these wrappers directly on mock class instances to simplify test setup.

### Sequencing and Ordering Expectations
- Use `InSequence` scopes or the `.InSequence()` clause to enforce order on calls.
- Specify complex call dependencies with `.After()` clauses or multiple sequences.

### Managing Cardinalities
- Select appropriate cardinality constraints (`Times`, `AtLeast`, `AtMost`, etc.) to flexibly define expected call counts.
- Interpret errors related to call count violations with detailed messaging.

### Diagnosing Expectation Failures
- Use `--gmock_verbose=info` for detailed call and expectation matching information.
- Inspect warning and error messages that include file locations and call stacks for effective troubleshooting.

### Verifying and Resetting Mocks
- Trigger explicit verification and clearing of expectations and default actions with `Mock::VerifyAndClearExpectations()` and `Mock::VerifyAndClear()`.
- Use `Mock::AllowLeak()` to intentionally exempt mock objects from leak detection.

---

## 3. Best Practices & Tips

- Always define mock methods in the `public:` section of your mock classes.
- Use `ON_CALL` to configure default behavior and reserve `EXPECT_CALL` for verification of expected calls.
- Chain expectation clauses in the correct order for clarity and correctness.
- Employ sequences and partial ordering to model required call order precisely.
- Handle move-only types in mock methods naturally using `MOCK_METHOD` with no workaround needed for modern compilers.
- Use verbosity flags to tune log output for debugging intermittent test failures.
- Avoid mixing expectation declarations and mock method calls in an intertwined manner; set expectations before exercising mocks.

---

## 4. Troubleshooting Common Issues

- **Unexpected Calls:** Occur when mock methods are called with arguments not matching any `EXPECT_CALL`. Inspect call arguments and expectations order.
- **Uninteresting Calls:** Calls to mock methods without expectations produce warnings or errors based on the strictness of the mock wrapper.
- **Excessive Calls:** Occur when the number of calls exceeds the specified cardinality.
- **Unsatisfied Calls:** When expected calls are not made before mock destruction or explicit verification.
- **Action Clause Errors:** Improper chaining or multiple clauses of `.Times()`, `.With()`, `.WillRepeatedly()` are detected and reported.
- **Mock Leak Detection:** Mock objects not destroyed before program exit trigger failure unless suppressed by `AllowLeak()`.

---

## 5. Examples and Usage Snippets

```cpp
// Define a mock class
class MockFoo {
 public:
  MOCK_METHOD(void, DoSomething, (int n), (override));
  MOCK_METHOD(int, GetValue, (), (const, override));
};

// Use NiceMock to suppress uninteresting call warnings
using ::testing::NiceMock;
NiceMock<MockFoo> mock_foo;

// Set expectation for DoSomething to be called twice
EXPECT_CALL(mock_foo, DoSomething(42)).Times(2).WillRepeatedly(Return());

// Provide default action for GetValue
ON_CALL(mock_foo, GetValue()).WillByDefault(Return(10));

// Call mock methods
mock_foo.DoSomething(42);
int val = mock_foo.GetValue();

// Verify expectations explicitly if needed
ASSERT_TRUE(Mock::VerifyAndClearExpectations(&mock_foo));
```

---

## 6. Related Documentation

- [Mocking Reference](../reference/mocking.md) — Properties of `EXPECT_CALL`, `ON_CALL`, matchers, actions, and cardinalities.
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md) — Quick syntax summary for defining mocks and expectations.
- [gMock Cookbook](docs/gmock_cook_book.md) — Recipes and best practices for practical mocking.
- [gMock for Dummies](docs/gmock_for_dummies.md) — Beginner-friendly guide to understanding mocks and expectations.
- [Strict, Nice, and Naggy Mocks](concepts/mocking-strategies-extensibility/strictness-and-behavior.mdx) — Details on differing mock behaviors.
- [Expectations and Sequences](api-reference/mocking-actions-matchers/expectations-and-sequences.mdx) — Reference for expectation order control.
- [Actions and Cardinalities](concepts/mocking-strategies-extensibility/actions-cardinalities.mdx) — In-depth guide to specifying call count and behaviors.

---

For a comprehensive overview of how these components fit together, see the [System Architecture Overview](/overview/architecture-concepts/system-architecture).

This page is part of the Changelog section in the documentation hierarchy, linked under [Release Highlights](/changelog/release-highlights/latest-release).

---

_Last updated with changes from the main branch of GoogleTest._
