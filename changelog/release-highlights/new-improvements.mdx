---
title: "What's New: Features & Improvements"
description: "Provides a focused list of new capabilities, enhancements, and user-facing improvements introduced in each release. Empowers users to discover new ways GoogleTest can streamline their testing workflow or unlock advanced scenarios."
---

# What's New: Features & Improvements

Welcome to the latest overview of GoogleTest's new capabilities and user-facing improvements. This page highlights enhancements designed to streamline your testing workflows, expand expressiveness, and unlock advanced scenarios previously difficult or impossible to achieve. Whether you're maintaining existing tests or exploring new testing techniques, these updates empower you to write more reliable, maintainable, and expressive tests.

---

## Recent Feature Additions and Enhancements

### Expanded Support for Mocking Move-Only Types
- GoogleMock now fully supports mocking methods that accept and return move-only types such as `std::unique_ptr<T>`. This simplifies testing modern C++ code using move semantics without resorting to workarounds.
- Example usage:

```cpp
class MockBuzzer : public Buzzer {
 public:
  MOCK_METHOD(std::unique_ptr<Buzz>, MakeBuzz, (StringPiece text), (override));
  MOCK_METHOD(bool, ShareBuzz, (std::unique_ptr<Buzz> buzz, int64_t timestamp), (override));
};

EXPECT_CALL(mock_buzzer_, MakeBuzz("hello"))
    .WillOnce(Return(std::make_unique<Buzz>(AccessLevel::kInternal)));
```

- Guidance: Use lambdas to generate fresh move-only return values on each call to avoid move semantics pitfalls.

### Improved Expectation Syntax and Flexibility
- `EXPECT_CALL` supports chaining multiple `WillOnce()` actions followed by a single `WillRepeatedly()`, with cardinalities inferred automatically, reducing verbosity.
- Ability to specify call order dependencies more expressively using `InSequence` scopes and `.After()` clauses.
- New `.RetiresOnSaturation()` allows expectations to automatically retire when their call limit is reached, reducing test flakiness and complexity.

### Enhanced Mock Strictness Controls
- Introduced `NiceMock<T>`, `NaggyMock<T>`, and `StrictMock<T>` wrappers for fine-grained control over mock behavior on uninteresting calls:
  - **NiceMock** suppresses warnings for uninteresting calls.
  - **NaggyMock** (default) warns on uninteresting calls.
  - **StrictMock** treats uninteresting calls as test failures.
- These wrappers are simple subclasses that inherit constructors and work seamlessly with existing mocks.

### Richer Matchers and Actions
- Expanded matcher capabilities, including:
  - Multi-argument matching via `.With()` clause supporting tuple matchers.
  - Built-in container element matchers like `ElementsAre()`, `UnorderedElementsAre()` for flexible STL container argument validation.
  - Custom predicates via `Truly()` and parameterized matchers through `MATCHER_P` macros.
- Action improvements:
  - `DoAll()` for combining multiple actions in one expectation.
  - Invocation of function pointers or callbacks passed into mock methods with `InvokeArgument<N>`.
  - Support for returning live values using `ReturnPointee()`.

### Default Action Customization
- Use `ON_CALL` to specify default behaviors without imposing expectations, enabling cleaner test fixtures.
- The last matching `ON_CALL` has precedence, allowing layered overrides.
- `::testing::DefaultValue<T>::Set()` lets you globally override default return values for mock methods returning type `T`.

### Concurrency and Threading Awareness
- Mock objects correctly handle method calls from multiple threads safely.
- Actions execute on the calling thread, and gMock manages internal synchronization for expectation verification.
- Guidance provided on thread-safe best practices for mocks in multithreaded tests.

### Diagnostic and Logging Improvements
- The `--gmock_verbose` flag supports `info`, `warning`, and `error` verbosity levels, to control the volume and detail of mock call tracing and warnings.
- When set to `info`, detailed traces of matching, arguments, stack traces, and expectation invocations aid debugging unfulfilled expectations and unexpected calls.
- By default, verbosity is set to `warning` to balance noise and usefulness.

### Performance and Compilation Optimizations
- Recommendations to move mock class constructors and destructors to `.cc` files to reduce compilation overhead.
- Support for delegating to real or fake implementations inside mocks using `ON_CALL` with lambdas to preserve behavior while validating interactions.

---

## Practical Examples

### Sequencing Mock Calls
```cpp
using ::testing::InSequence;
{
  InSequence seq;
  EXPECT_CALL(mock, Initialize());
  EXPECT_CALL(mock, Process(_));
  EXPECT_CALL(mock, Cleanup());
}
```
*Ensures methods are called strictly in sequence, improving test clarity and reducing false positives.*

### Suppressing Uninteresting Call Warnings
```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> mock_foo;
EXPECT_CALL(mock_foo, ImportantMethod()).Times(1);
// Calls to other methods will not produce warnings.
```

### Returning Different Values on Successive Calls
```cpp
EXPECT_CALL(mock, GetValue())
    .WillOnce(Return(10))
    .WillOnce(Return(20))
    .WillRepeatedly(Return(30));
```

### Mocking Methods with Move-Only Arguments
```cpp
EXPECT_CALL(mock, ProcessData(_)).WillOnce([](std::unique_ptr<Data> data) {
  EXPECT_NE(nullptr, data);
});
mock.ProcessData(std::make_unique<Data>());
```

---

## Troubleshooting Tips and Best Practices

- **Order of Expectation Setting:** Always use `EXPECT_CALL` before exercising the mock. Setting expectations after calls leads to undefined behavior.
- **Avoid Over-Specification:** Use `ON_CALL` to specify default behaviors and reserve `EXPECT_CALL` for calls you want to verify.
- **Use `RetiresOnSaturation` to avoid stuck expectations:** When multiple similar calls occur, preventing sticky expectations from causing unexpected errors.
- **Use sequences or `After()` to model expected call orders explicitly:** This prevents brittle tests due to implicit ordering assumptions.
- **Delegate to real or fake implementations when needed:** Use delegation inside mocks to reuse logic and simplify test setup.
- **Suppress noisy warnings with `NiceMock` where appropriate:** Especially helpful in large test suites to reduce noise.

---

## Additional Resources

- **GoogleMock Cheat Sheet:** A quick reference for mock class definition, expectation syntax, matchers, and actions.
- **gMock for Dummies:** Beginner-friendly introduction covering definitions and usage of mock classes.
- **gMock Cookbook:** Detailed recipes on advanced usage scenarios including custom matchers and actions.
- **Matchers Reference:** Comprehensive guide to built-in and user-defined matchers.
- **Actions and Cardinalities API:** Explanation of controlling mock method behavior and call counts.
- **Controlling Mock Strictness:** How to use `NiceMock`, `NaggyMock`, and `StrictMock` to tune test output and failure sensitivity.

---

## Navigation

This page complements the [Release Highlights](./version-history) by detailing what new features and improvements have been added recently. For upgrading your code, see our [Breaking Changes & Migration](../upgrading-and-migration/breaking-changes) guides. To deepen your mastery of mocking techniques and writing maintainable tests, explore the [Maintainable Test Suites Guide](../../guides/scenarios-and-best-practices/maintainable-test-suites) and the [Parameterized and Typed Tests Guide](../../guides/advanced-testing-patterns/parameterized-and-typed-tests).

<Note>
This changelog page is dedicated to user-impacting feature additions and improvements in GoogleTest and GoogleMock. It focuses on actionable information to help you leverage new capabilities effectively.
</Note>