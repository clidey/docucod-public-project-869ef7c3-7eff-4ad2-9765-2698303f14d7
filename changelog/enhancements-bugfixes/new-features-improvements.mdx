---
title: "New Features and Improvements"
description: "Spotlights recently introduced features, usability enhancements, and support for additional platforms or language standards. Users can quickly find functionality that may improve their productivity or unlock new use cases."
---

# New Features and Improvements

Welcome to the New Features and Improvements page where you'll find highlights of the most recent advancements in GoogleTest and GoogleMock. This documentation page is designed to quickly orient you to newly introduced capabilities, usability enhancements, and expanded platform or language standard support that empower you to write better, more maintainable tests faster.

---

## Unlocking Productivity with New Capabilities

Every release introduces features that allow you to write tests that are more expressive, flexible, or performant. We spotlight key improvements here to help you take advantage of them effortlessly.

### Modernized Mocking Syntax

GoogleMock now fully embraces the versatile and strongly typed `MOCK_METHOD` macro variant, encouraging consistent, safer mock declarations. This macro supports:

- Integration with `const`, `override`, and `noexcept` qualifiers
- Calling convention specifications via `Calltype`
- Method reference qualifiers with `ref`

**Example:**

```cpp
class MockFoo {
 public:
  MOCK_METHOD(bool, Compute, (int a, double b), (const, override));
  MOCK_METHOD(void, Update, (), (noexcept));
};
```

This syntax improves readability and aligns with modern C++ standards, reducing subtle bugs from mismatched declarations.

### Flexible Mock Strictness Levels with `NiceMock`, `NaggyMock`, and `StrictMock`

You can finely control the behavior of uninteresting calls—calls without explicit expectations—using these class templates:

- `NiceMock`: Silences warnings about uninteresting calls, ideal for reducing noise where calls are inconsequential.
- `NaggyMock`: Emits warnings for uninteresting calls (currently the default behavior).
- `StrictMock`: Treats uninteresting calls as failures, ensuring strict adherence to expected interactions.

These wrappers inherit all constructors of your mock classes, allowing seamless replacement without code changes:

```cpp
NiceMock<MockFoo> mock_foo;  // Suppresses uninteresting call warnings
StrictMock<MockFoo> strict_foo;  // Fails on uninteresting calls
```

Use these to strike the right balance between helpful feedback and test maintenance.

### Enhanced Control over Call Ordering and Expectations

New extensions to `EXPECT_CALL` now let you organize expectations with sequencing constructs and fine-grained ordering:

- **`InSequence`** groups expectations and mandates that calls occur sequentially as declared.
- **`After` clause** allows defining more complex DAG-based partial orders for call sequences.
- **`RetiresOnSaturation`** enables automatic expiration of expectations once saturated, letting more general expectations apply afterwards.

**Example usage:**

```cpp
Sequence s1, s2;
EXPECT_CALL(mock, FirstCall()).InSequence(s1, s2);
EXPECT_CALL(mock, SecondCall()).InSequence(s1);
EXPECT_CALL(mock, ThirdCall()).After({expectation1, expectation2});
```

These controls help reduce brittleness and clarify intent in tests that require temporal ordering.

### Improved Default Actions and Return Value Control

To deal with functions returning complex or move-only types (e.g., `std::unique_ptr<T>`), GoogleMock supports:

- Setting **default factories** for return types via `DefaultValue<T>::SetFactory()`.
- Delegating default mock behavior using `ON_CALL` with lambdas or functors to return fresh or contextual values.

Example:

```cpp
DefaultValue<std::unique_ptr<Buzz>>::SetFactory(
    [] { return std::make_unique<Buzz>(AccessLevel::kInternal); });
ON_CALL(mock_buzzer_, MakeBuzz(_)).WillByDefault(ReturnNew<Buzz>());
```

This enables fluent mocking of move-only return types without cumbersome manual stubs.

### Action Composition and Customizability

GoogleMock's action framework is richer than ever:

- Use `DoAll()` to combine multiple actions on a single call.
- `IgnoreResult()` gracefully discards action return values when adapting to `void` functions.
- `Invoke()`, `InvokeWithoutArgs()`, and `InvokeArgument<N>()` facilitate calling functions, functors, callbacks, or method pointers flexibly.
- `SetArgPointee<N>(value)` and `SetArrayArgument<N>(first, last)` empower mocking side effects on output parameters.

Example:

```cpp
EXPECT_CALL(mock, Mutate(_)).WillOnce(DoAll(SetArgPointee<0>(5), Return(true)));
```

This lets you simulate functions that both modify outputs and return results seamlessly.

### Usability Enhancements and Platform Support

- Constructors for mock classes that require non-default or multiple arguments are now fully supported in `NiceMock`, `NaggyMock`, and `StrictMock` wrappers.
- Compatibility and enhancement improvements continue across supported platforms and toolchains following updates summarized in related documentation.

---

## Practical Tips and Best Practices

- **Set expectations before test execution:** Always define `EXPECT_CALL` or `ON_CALL` before invoking the mock methods to avoid undefined behavior.

- **Use `ON_CALL` for default behaviors:** Reserve `EXPECT_CALL` to verify that calls actually happen; use `ON_CALL` for setting behavior without enforcing calls.

- **Avoid excessive strictness:** Employ `NiceMock` for general development to suppress benign warnings, falling back to `StrictMock` selectively when you want dense validation.

- **Leverage sequences and partial orders:** When call ordering matters, explicitly use `InSequence` or `After` to document your temporal expectations.

- **Clear expectations responsibly:** Use `Mock::VerifyAndClearExpectations()` or `Mock::VerifyAndClear()` to verify mocks early and reset for reuse.

- **Delegate to real or fake implementations:** When practical, delegate default mock behavior to concrete implementations or fakes to minimize duplication and increase realism.

---

## Troubleshooting Common Scenarios

- **Uninteresting call warnings:** If you see these and want to silence them globally for a mock, prefer `NiceMock` over suppressing warnings individually.
- **Multiple expectations for overloaded methods:** Use matcher syntax carefully to disambiguate and avoid hiding overloads.
- **Move-only types:** Use lambdas or `ON_CALL` with factories to generate fresh instances for every invocation.
- **Unexpected call failures:** Verify that your expectations accurately represent calls your code will perform. Use `--gmock_verbose=info` for detailed tracing.

---

## Next Steps

To fully exploit these new features:

- Explore the detailed [Mocking Reference](docs/reference/mocking.md) for comprehensive syntax and semantic details.
- Review the [gMock Cookbook](docs/gmock_cook_book.md) for practical scenarios, examples, and recipes.
- Check the [Actions Reference](docs/reference/actions.md) to master advanced action definitions and behaviors.
- For environment integration and platform specifics, consult related platform support and build instructions.

Unlock efficient, readable, and maintainable testing workflows by incorporating these improvements into your development practice.

---