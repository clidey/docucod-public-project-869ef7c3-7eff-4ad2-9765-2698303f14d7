---
title: "Breaking Changes & Migration Notes"
description: "Documents changes that require user action or code modification when upgrading. Clearly flags removals, major behavioral shifts, or platform requirement increases, and provides guidance on adapting existing tests."
---

# Breaking Changes & Migration Notes

This page details all critical changes in GoogleTest that require user action or code modification when upgrading between versions. It highlights removals of features, major behavioral shifts, increases in platform requirements, and provides practical guidance on adapting existing tests to maintain compatibility and correctness.

---

## Understanding Breaking Changes

Breaking changes are modifications in the framework that may cause existing tests to fail or behave differently without changes to test code. These may include deprecated functionality removals, API contract changes, enhancements that alter default behaviors, or raised minimum platform or compiler requirements.

This page flags these changes clearly and provides actionable migration instructions to help users adapt seamlessly.

---

## Minimum C++ Standard Requirement Increase

- **C++17 Minimum:** GoogleTest now requires a minimum of the **C++17 standard** for compilation and usage. Attempts to compile with older C++ versions will fail.

### Migration Tips:
- Ensure your build environment and compiler toolchain support C++17.
- Update your build files (e.g., CMakeLists.txt, Bazel BUILD files) to specify `-std=c++17` or equivalent.
- Confirm third-party dependencies are compatible with C++17.

<Note>
Failing to comply with this requirement will result in compilation errors such as those originating in `gtest-port.h` where static assertions enforce this minimum standard.
</Note>

---

## Documentation Migration

- Documentation moved and improved for better accessibility:
  - User-facing documentation is now hosted primarily on **GitHub Pages**.
  - Legacy formats transitioned to Markdown and reorganized for coherence.
  - Continuous integration of GoogleMock documentation ongoing alongside GoogleTest.

### User Impact:
- For the latest and most detailed docs, visit the official GitHub pages:
  - [GoogleTest](https://google.github.io/googletest/)
  - [GoogleMock](https://google.github.io/googletest/gmock_for_dummies.html)

<Info>
Users should update local bookmarks and references to point to new documentation URLs and consult updated guides for installation and usage.
</Info>

---

## Notable Behavioral Changes & API Adjustments

### 1. Strict Enforcement of Virtual Destructors for Mocked Interfaces

- Classes intended for mocking **must** have a virtual destructor to avoid undefined behaviors such as memory leaks.
- Mock classes inheriting from interfaces without virtual destructors now produce heap check failures.

### Migration Guidance:
- Verify all interfaces used for mocking declare destructors as `virtual`.
- Update legacy interfaces and mocks where necessary.

### 2. Expectations (`EXPECT_CALL`) Precedence and Matching Behavior

- Expectations are matched in **reverse order**; newer expectations override older ones.
- This change encourages:
  - Setting generic default expectations early (e.g., in mock constructors),
  - Overriding with more specific expectations later in tests.

### Migration Guidance:
- Arrange `EXPECT_CALL` statements such that more specific expectations come after general ones.
- Use `InSequence` or ordered expectations to enforce call order where necessary.

### 3. Retiring Expectations Upon Saturation

- Introduced the `.RetiresOnSaturation()` clause to allow expectations to retire when their call count upper bound is reached.
- Prevents unexpected match errors when calls exceed the expected count but are sensible to allow under fallback expectations.

### Migration Guidance:
- Consider adding `.RetiresOnSaturation()` to expectations where you want them to retire gracefully.

---

## Test Adaptation: Migrating Existing Tests

To migrate existing test code to the current GoogleTest version with breaking changes:

### Step 1: Update Build Configuration

- Confirm compilation uses C++17.
- Adjust build toolchain flags accordingly.

### Step 2: Review and Modify Mock Usage

- Check interfaces for virtual destructors.
- Reorder or consolidate `EXPECT_CALL`s for correctness under new precedence rules.
- Use `.RetiresOnSaturation()` where applicable.
- Review usage of `ON_CALL` for default behaviors.

### Step 3: Update Naming and Test Structure If Required

- Adjust test suite and test names to comply with new naming guidelines if any.

### Step 4: Run Tests with Verbose Logging for Diagnostics

- Use `--gmock_verbose=info` to trace mock call matches.
- Identify and fix failing expectations or misused mocks.

<Tip>
If tests fail unexpectedly after upgrade, stepping through verbose logs and reviewing ordering and count of expectations often helps identify adjustment points.
</Tip>

---

## Common Pitfalls and Troubleshooting Tips

- **Missing or Non-virtual Destructors:** Leads to heap corruption and memory leak reports.
- **Incorrect Ordering of `EXPECT_CALL` Statements:** May cause unexpected call match failures.
- **Old C++ Standard:** Will cause compile errors, notably from static assertions enforcing C++17.
- **Unintended Over-Mocking:** Overuse of strict mocks or unnecessary `EXPECT_CALL`s may cause brittle tests.

---

## Additional Resources

- Refer to the [Breaking Changes & Migration Notes](https://google.github.io/googletest/changelog/upgrade-migration/breaking-changes)
- Consult the [Getting Started Setup & Prerequisites](../getting-started/setup-prerequisites/system-requirements) for environment readiness
- Explore the [Mocking Reference](../api-reference/mocking-framework/reference) for comprehensive guidance on mocks
- Review the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for practical mocking patterns

---

## Summary of Key Breaking Changes

| Change                         | Impact                                      | Migration Action                      |
| ------------------------------ | -------------------------------------------- | ----------------------------------- |
| C++17 Minimum Requirement      | Compile failures on older compilers          | Update compiler flags to C++17       |
| Virtual Destructor Enforcement | Test failures on mocks without virtual dtors | Add `virtual` destructors            |
| `EXPECT_CALL` Matching Order   | Different matching expectations precedence   | Reorder expectations properly       |
| Retiring Expectations Added    | New `.RetiresOnSaturation()` clause           | Adapt expectations to retire early  |
| Documentation URL Changes      | Broken links to old docs                      | Update bookmarks to GitHub Pages     |

---

By carefully following this migration guidance, users will ensure their tests continue running reliably with the newest GoogleTest releases.

---

## Frequently Asked Questions

<AccordionGroup title="FAQs on Breaking Changes & Migration">
<Accordion title="Why does GoogleTest now require C++17?">
GoogleTest has modernized its codebase to leverage C++17 features for better safety, performance, and maintainability. Users must update their toolchains accordingly.
</Accordion>
<Accordion title="My existing tests fail due to virtual destructor issues. What now?">
Ensure all interfaces you mock have virtual destructors. Non-virtual destructors cause undefined behavior and leaks. Adding the `virtual` keyword to destructors and recompiling fixes this.
</Accordion>
<Accordion title="How to manage change in expectation precedence?">
Always place generic expectations before more specific ones. Use sequences to enforce order where necessary. Employ `.RetiresOnSaturation()` to retire expectations to avoid conflicts.
</Accordion>
<Accordion title="Where can I find updated documentation?">
All current documentation and guides are hosted on GitHub Pages under the official project sites for GoogleTest and GoogleMock.
</Accordion>
</AccordionGroup>
