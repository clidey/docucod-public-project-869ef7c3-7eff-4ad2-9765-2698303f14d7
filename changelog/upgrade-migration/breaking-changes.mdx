---
title: "Breaking Changes & Deprecations"
description: "A curated overview of breaking API changes, removed features, and deprecated functionality. It includes migration steps, impact analysis, and recommendations for updating codebases."
---

# Breaking Changes & Deprecations

This page provides a focused, curated overview of breaking API changes, removed features, and deprecated functionality within the GoogleMock project. It guides you on how to identify these changes, understand their impact, and execute migration steps to update your codebase safely and efficiently.

---

## Understanding Breaking Changes and Deprecations

GoogleMock evolves to improve functionality, reliability, and maintainability. Occasionally, this involves removing old features or introducing changes that break backward compatibility. To keep your tests functional and up to date, you need to understand these changes early and adapt accordingly.

**Why this page matters:** Instead of sifting through general release notes, this centralized documentation focuses solely on critical changes that require your direct attention.

---

## Categories of Breaking Changes

Breaking changes and deprecations typically fall into the following groups:

- **Removed Macros or Functions:** Some mocking macros or utilities might be removed.
- **API Signature Changes:** Changes in method signatures, including qualifiers like `const` or calling conventions.
- **Behavioral Changes:** Modifications in default mock behavior or how certain expectations are processed.
- **Strictness Controls:** Updates or alterations in how mocks treat uninteresting calls (e.g., changes around NaggyMock, NiceMock, StrictMock).

Each category impacts your existing tests differently and demands specific migration approaches.

---

## Migration Guidance

### 1. Identifying the Impact

Start by scanning your codebases for usage of features or APIs listed below as removed or deprecated.

Check for:

- Usage of legacy `MOCK_METHODn` macros instead of the unified `MOCK_METHOD`.
- Macro qualifiers that have changed semantics (e.g., `const`, `override`, `Calltype`).
- Inheritance of strictness wrappers like `NiceMock`, `NaggyMock`, or `StrictMock` around mock classes.

### 2. Updating Mock Method Definitions

GoogleMock recommends the use of the new `MOCK_METHOD` macro, which unifies the old family of `MOCK_METHODn` macros. If your code uses the old macros:

```cpp
// Old style - deprecated
MOCK_METHOD1(Foo, bool(int));

// New recommended style
MOCK_METHOD(bool, Foo, (int), (override));
```

**Tip:** When mocking const, noexcept, or special calling conventions, use the fourth parameter specifiers explicitly. Example:

```cpp
MOCK_METHOD(bool, Foo, (int), (const, override, noexcept));
MOCK_METHOD(void, Bar, (), (Calltype(STDMETHODCALLTYPE), override));
```

### 3. Handling Strictness Wrappers

GoogleMock provides wrappers to control mock strictness: `NiceMock<T>`, `NaggyMock<T>`, and `StrictMock<T>`. 

**Important update:** The default mock behavior will move from Naggy (warning on uninteresting calls) to Nice (silently ignoring them).

Migration recommendations:

- Prefer using `NiceMock<T>` to suppress warnings on uninteresting calls if your tests currently rely on naggy mocks.
- Use `StrictMock<T>` only when you want to enforce strict verification of all mock interactions.
- Avoid nesting strictness wrappers; each mock class hierarchy should have at most one.

Example:

```cpp
using ::testing::NiceMock;

NiceMock<MockSomeClass> mock;
EXPECT_CALL(mock, SomeMethod());
```

### 4. Deprecated or Removed Features

If you encounter errors related to deprecated or removed APIs:

- **Delegation Calls:** Delegating calls to fakes or real objects continues to be supported, but ensure your usage matches the latest recommended patterns.
- **Mocking Non-Virtual Functions:** No breaking changes here, but be sure to apply the compile-time binding patterns correctly.

For detailed migration steps, always consult updated guides and the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) Chapter on mock strictness and mock method macros.

---

## Impact Analysis

Changes described here can produce compilation errors, runtime warnings, or unexpected test failures if not addressed:

- **Compilation Failures:** Due to signature or macro syntax changes.
- **Test Flakiness:** Arising from altered default mock behaviors regarding uninteresting method calls.
- **Silent Behavior Shifts:** If you rely on gMockâ€™s naggy behavior but the default switches to nice, you might miss unexpected calls.

By proactively updating your mock code and test expectations, you preserve test reliability and maintainability.

---

## Recommendations

- **Audit Existing Mocks:** Identify old macros and strictness wrappers.
- **Adopt Modern Macros:** Transition to the unified `MOCK_METHOD` with explicit qualifiers.
- **Standardize Strictness Level:** Choose `NiceMock` as the general default, escalate to `StrictMock` only when necessary.
- **Run Tests with Verbose Logs:** Use `--gmock_verbose=info` to monitor uninteresting calls and find unexpected mock invocations.
- **Follow Migration Guides:** Always reference official upgrade paths as GoogleMock evolves.

---

## Troubleshooting Common Migration Issues

<AccordionGroup title="Common Migration Challenges">
<Accordion title="Compilation Errors with MOCK_METHOD">
Check that all `MOCK_METHODn` macros are replaced properly and that arguments with commas are correctly parenthesized or use type aliases.

Example:

```cpp
// Wrap types with commas
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
// Or
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());
```
</Accordion>

<Accordion title="Unexpected Behavior After Strictness Changes">
Uninteresting mock calls might no longer warn or might fail tests depending on the strictness wrapper applied. Adjust mock types accordingly:

- Use `NiceMock<T>` to suppress warnings
- Use `StrictMock<T>` to enforce strict call verification

</Accordion>

<Accordion title="Failing Tests After Signature Changes">
Review mocked method signatures for qualifier changes (`const`, `noexcept`, `override`, calling conventions). Ensure mock declarations mirror production interfaces exactly.

</Accordion>
</AccordionGroup>

---

## Additional Resources

- [gMock Cookbook - Nice, Naggy, Strict Mocks](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [gMock Reference - MOCK_METHOD](https://google.github.io/googletest/reference/mocking.html#MOCK_METHOD)
- [Migration Guide (when available)](/changelog/upgrade-migration/upgrade-guide)

---

## Summary

This page serves as a vital resource for developers maintaining GoogleMock-based test suites. By highlighting breaking changes, deprecations, and upgrade pathways, it facilitates smooth transitions across major releases and prevents integration bottlenecks or test outages.

Regularly consult this page during upgrades to ensure your mocks and tests are aligned with the latest, most supported APIs and idioms.

---

Last updated in branch `main`.