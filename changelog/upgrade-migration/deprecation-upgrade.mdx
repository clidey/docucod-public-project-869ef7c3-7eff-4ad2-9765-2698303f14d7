---
title: "Deprecation Notices & Upgrade Strategies"
description: "Lists features, APIs, or behaviors scheduled for removal or recently deprecated, along with recommended alternatives. Equips users with actionable information to future-proof their code and optimize adoption of the latest best practices."
---

# Deprecation Notices & Upgrade Strategies

This page provides authoritative guidance on features, APIs, and behaviors in GoogleTest and GoogleMock that have been recently deprecated or are scheduled for removal. It delivers clear recommendations for alternatives and upgrade paths, empowering you to future-proof your test code, leverage the latest best practices, and avoid pitfalls during migrations.

---

## 1. Overview of Deprecated Features

GoogleTest and GoogleMock evolve constantly to improve reliability, performance, and usability. As part of this process, certain legacy features are deprecated with plans for removal in upcoming releases. This page helps you identify these features explicitly related to mocking support and guides you on how to adapt and migrate.

Deprecated features generally fall into the following categories:

- Legacy macros and syntax superseded by new versions
- Behavioral changes requiring explicit handling
- Structural requirements such as virtual destructors in mocked interfaces


## 2. Key Deprecations in Mocking Framework

### 2.1 Legacy `MOCK_METHODn` Macros

The older `MOCK_METHOD0`, `MOCK_METHOD1`, ..., and their variants for const, templated, or calltype methods are deprecated in favor of the new `MOCK_METHOD` macro. The new macro:

- Offers a uniform and clearer syntax
- Accepts method qualifiers like `const`, `override`, `noexcept`, `Calltype(...)`, and `ref(...)`
- Handles unprotected commas in return types or arguments with explicit parentheses or type aliases

**Upgrade Recommendations:**

- Refactor all legacy `MOCK_METHODn` usages to use `MOCK_METHOD` as described in the [Mocking Reference](docs/reference/mocking.md#MOCK_METHOD) and [gMock Cheat Sheet](docs/gmock_cheat_sheet.md).
- For const methods, ensure you add `(const)` qualifier.
- For calltype or ref-qualified methods, specify qualifiers as `(Calltype(STDMETHODCALLTYPE))` or `(ref(&))` accordingly.


### 2.2 Mock Classes Must Have Virtual Destructors

Mocks must adhere to the rule that their base interfaces provide **virtual destructors**. Failing to do so leads to undefined behavior, including potential memory leaks or heap corruption.

**What This Means for You:**

- If you mock an interface without a virtual destructor, you must update that interface to add one before mocking.
- This requirement ensures safe destruction and proper cleanup of mock objects, especially when deleted via base pointers.

Refer to the guidance in the [Legacy gMock FAQ](docs/gmock_faq.md#virtual-destructors) highlighting this requirement.


### 2.3 Changes in Expectation Matching Order

GoogleMock changed its matching logic to scan `EXPECT_CALL` statements from newest to oldest. This rule is aligned with the philosophy that newer expectations override older ones.

**Implications:**

- When migrating older tests, be aware that the order of `EXPECT_CALL` statements matters.
- To avoid unexpected failures, reorder or combine expectations thoughtfully.
- Use explicit sequences or the `.RetiresOnSaturation()` clause to model invocation order and lifetime correctly.

For detailed examples, see [Setting Expectations and Actions](api-reference/mocking-framework/expectations-actions.mdx) and the discussion in the [Legacy gMock FAQ](docs/gmock_faq.md#expectation-order).


### 2.4 Introduction of `.RetiresOnSaturation()` Clause

To control when an expectation should retire (stop matching after saturation), the `.RetiresOnSaturation()` clause was introduced.

- This prevents sticky expectations from generating upper bound violations by deactivating them immediately after their expected calls complete.
- It's especially useful when expectations overlap and can otherwise cause ambiguous or brittle tests.

**Migration Tip:** Update expectations with strict call counts to add `.RetiresOnSaturation()` if you previously encountered invocation limit violations.

See full details in [EXPECT_CALL RetiresOnSaturation](docs/reference/mocking.md#EXPECT_CALL.RetiresOnSaturation).


### 2.5 Strict, Nice, and Naggy Mocks

The distinctions between `StrictMock`, `NiceMock`, and the default (naggy) mock behavior have been clarified with stronger enforcement:

- `StrictMock<T>` now fails on any uninteresting calls.
- `NiceMock<T>` suppresses warnings on uninteresting calls.
- The default mock behavior is naggy, generating warnings.

If you previously relied on implicit behaviors, explicitly switch to the preferred wrapper to avoid surprises.

See [Nice, Naggy, and Strict Mocks](api-reference/mocking-framework/nice-strict-mocks.mdx) for a detailed explanation.


## 3. Migration Path and Best Practices

### Step-by-Step Upgrade Workflow

1. **Audit your mock classes:** Check for legacy macros (`MOCK_METHODn`, `MOCK_CONST_METHODn`, etc.) and refactor them to use the modern `MOCK_METHOD` macro.
2. **Verify all base interfaces:** Ensure they have virtual destructors to prevent memory errors.
3. **Review expectation definitions:** Reorder or combine multiple `EXPECT_CALL` statements, and consider using `.RetiresOnSaturation()` or sequences where appropriate.
4. **Adopt mock wrappers:** Wrap your mocks in `NiceMock` or `StrictMock` explicitly according to your desired uninteresting call policy.
5. **Test thoroughly:** Run your test suite with verbose output (`--gmock_verbose=info`) to detect uninteresting or unexpected calls early.
6. **Refer to examples:** Check updated mocks in the [gMock Cheat Sheet](docs/gmock_cheat_sheet.md) and guides like [Using Mocks Effectively](guides/advanced-and-mocking-guides/using-mocks-effectively).


### Common Pitfalls and Troubleshooting

- **Missing virtual destructors:** Leads to subtle runtime failures. Always add a virtual destructor to interfaces you mock.
- **Incorrect `MOCK_METHOD` usage:** Parenthesize complex return types or argument types with commas.
- **Sticky expectations:** If you get "called more times than expected" errors unexpectedly, apply `.RetiresOnSaturation()`.
- **Uninteresting call warnings:** Suppress them with `NiceMock` or add broad `EXPECT_CALL(...).Times(AnyNumber())` to those methods.
- **Order sensitive expectations:** Use `InSequence` or `After` clauses explicitly to enforce call ordering.


## 4. References and Related Documentation

### Core Documents to Consult

- [Mocking Reference](docs/reference/mocking.md): Detailed explanation of mocking APIs including `MOCK_METHOD` and `EXPECT_CALL`.
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md): Quick recipes to define mocks and set expectations.
- [Legacy gMock FAQ](docs/gmock_faq.md): Addresses common migration questions and pitfalls.
- [Using Mocks Effectively](guides/advanced-and-mocking-guides/using-mocks-effectively): Best practices for working with mocks.
- [Nice, Naggy, and Strict Mocks](api-reference/mocking-framework/nice-strict-mocks.mdx): Behavior of mock wrappers for uninteresting calls.

### Upgrade Assistance

- Refer to the [Breaking Changes & Migration Notes](changelog/upgrade-migration/breaking-changes.mdx) for comprehensive upgrade instructions including non-mocking related changes.
- Review the latest code examples in [Latest Release Notes](changelog/version-history/latest-release.mdx) to understand modern usage.
- Use the [Troubleshooting Common Installation Issues](getting-started/first-test-run-validation/troubleshooting-common-issues.mdx) to identify common upgrade problems.


---

<Tip>
Upgrading test code to the current GoogleMock idioms improves test robustness and reduces future maintenance efforts. Applying these deprecations proactively avoids surprises in upcoming releases and keeps your test suite aligned with the latest framework internals.
</Tip>

<Note>
This page strictly documents deprecations and upgrade strategies relating to mocking support and does not cover other GoogleTest product areas. For comprehensive upgrade guidance, see linked changelog and breaking change pages.
</Note>

---

### Sample Migration Example for MOCK_METHOD

```cpp
// Legacy style
MOCK_METHOD1(Foo, bool(int));              // Old macro with argument count

// Modern style
MOCK_METHOD(bool, Foo, (int), (override)); // New macro with qualifiers
```

### Applying `.RetiresOnSaturation()`

```cpp
EXPECT_CALL(mock, SomeMethod())
    .Times(2)
    .RetiresOnSaturation();
```

Use when your expectation should deactivate immediately after the allowed number of calls.


### Wrapping a Mock in a Strict or Nice Mock

```cpp
using ::testing::StrictMock;
StrictMock<MockFoo> strict_mock;  // Fails on uninteresting calls

using ::testing::NiceMock;
NiceMock<MockFoo> nice_mock;      // Suppresses warnings on uninteresting calls
```


---

## 5. Summary

Keep this page bookmarked as your authoritative upgrade companion when adapting or creating mocks with GoogleMock in modern GoogleTest environments. Robust test suites depend on addressing deprecation notices promptly and following the upgrade strategies outlined herein.
