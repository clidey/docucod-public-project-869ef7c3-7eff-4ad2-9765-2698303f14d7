---
title: "Deprecated & Removed Features"
description: "Lists APIs, options, or workflows slated for removal or already removed, complete with timelines, alternatives, and suggested migration paths. Keeps projects out of technical debt."
---

# Deprecated & Removed Features

The Deprecated & Removed Features page serves as your essential guide to understanding APIs, options, workflows, and features that have been marked for removal or have already been deprecated or eliminated from GoogleTest and GoogleMock. Staying informed here is vital for keeping your projects free of technical debt and aligned with the framework's evolution.

---

## 1. Overview of Deprecated Features

GoogleTest and GoogleMock evolve rapidly to provide more robust, maintainable, and efficient testing capabilities. As part of this evolutionary process, some features become obsolete or superseded by more reliable options. This page catalogs those endpoints to help you identify and phase out deprecated usages.

### Key Points

- **Deprecations include:** APIs, macros, compiler flags, mock behaviors, and configuration options slated for removal.
- **Removal timelines:** Each deprecated feature is associated with a timeline detailing when support ended or will end.
- **Alternatives:** Suggestions on modern replacements or migration strategies are provided.

---

## 2. Deprecation Principles and User Impact

This section focuses on what deprecated features mean for users and project maintainers, emphasizing proactive upgrades and migration paths.

### Why Deprecations Happen

- **Improve consistency and clarity:** Simplify the API by removing confusing or redundant features.
- **Maintain modern C++ standards:** Drop support for legacy constructs or patterns incompatible with C++17.
- **Enhance maintainability:** Remove rarely used or problematic features to reduce surface area.

### User Impact

If your code uses a feature listed here, you should plan to update your tests and mocks to the recommended alternatives. Continuing to use deprecated features risks brittle tests and future incompatibilities.

<Tip>
Always consult the migration guidance linked in each deprecated item. Early migration saves significant maintenance effort.
</Tip>

---

## 3. Deprecated Mock Macros and Methods

### Transition from `MOCK_METHODn` to `MOCK_METHOD`

The old `MOCK_METHODn` macros, where `n` corresponds to the number of arguments, have been deprecated in favor of the more flexible and unified `MOCK_METHOD` macro introduced in 2018.

```cpp
// Deprecated style:
MOCK_METHOD1(Foo, bool(int));

// Recommended style:
MOCK_METHOD(bool, Foo, (int));
```

#### Migration Tips

- Replace `MOCK_METHODn` with `MOCK_METHOD` in all mock class definitions.
- Wrap return or argument types containing unprotected commas inside an extra pair of parentheses or use type aliases.

### Qualified Mock Methods

Qualifiers such as `const`, `override`, `noexcept`, and `Calltype(...)` should be supplied in the fourth macro parameter list.

```cpp
MOCK_METHOD(void, Foo, (int x), (const, override));
```

### Common Pitfalls

- Neglecting to make the mock method declaration public even for protected or private base methods breaks expectations.
- Unprotected commas in argument or return types lead to compilation errors.

---

## 4. Removed Features and Their Alternatives

### Mocking Free Functions Directly

Direct mocking of free functions (C-style functions or static methods) is removed. Instead, use an interface abstraction for such functions, then mock the interface.

Example migration:
```cpp
class FileInterface {
 public:
  virtual bool Open(const char* path, const char* mode) = 0;
};

class File : public FileInterface {
 public:
  bool Open(const char* path, const char* mode) override {
    return OpenFile(path, mode);
  }
};
```

### Old-Style `MOCK_METHODn` Variants

These macros are no longer recommended, though still supported for backward compatibility. Migrating to the generic `MOCK_METHOD` macro improves clarity and maintainability.

---

## 5. Strictness Wrappers: Changes

The classes `NiceMock`, `NaggyMock`, and `StrictMock` play a significant role in controlling how uninteresting and unexpected calls are handled.

- **`NaggyMock`** is now the default mock behavior but can be avoided by explicit use of `NiceMock` or `StrictMock`.
- Use `NiceMock<T>` to suppress warnings on uninteresting calls, and `StrictMock<T>` to convert uninteresting calls into failing test errors.

**Note:**

- `NiceMock` and `StrictMock` only affect methods defined directly in the mock class, not in base classes.
- Virtual destructors are mandatory for proper behavior with these wrappers.

---

## 6. Default Value Behavior and Changes

Default return values for mock methods are governed via `::testing::DefaultValue<T>`. This feature allows you to set a default return if no specific action is provided.

Modern GoogleMock versions have refined this mechanism to avoid silent failures and provide better diagnostics.

---

## 7. Migration Paths

### Recommended Upgrade Sequence

1. Transition to `MOCK_METHOD` from `MOCK_METHODn` macros.
2. Replace deprecated ON_CALL / EXPECT_CALL clauses using replaced method signatures.
3. Refactor code that mocks free or static functions to use interface abstractions.
4. Adopt strictness wrappers thoughtfully to control test strictness.
5. Update default value settings and remove deprecated default behaviors.

### Helpful Tips

- Use the verbose flag `--gmock_verbose=info` during test runs to trace call matching and diagnose deprecated usage.
- Regularly consult the [gMock Cookbook](gmock_cook_book.md) for practical recipes on modernization.

---

## 8. Deprecated Command-line Flags and Build Options

Some old compiler flags and build settings are deprecated.

- `-DGTEST_HAS_PTHREAD` settings: The build system now auto-detects properly; manual overrides should be used only for specialized environments.
- Reconsider use of `/clr` in Visual Studio due to excessive compilation resource usage.

---

## 9. Related References and Further Reading

- [gMock Cookbook](docs/gmock_cook_book.md): For recipes on mock creation and usage, including migration scenarios.
- [Mocking Reference](docs/reference/mocking.md): Detailed coverage of mocking facilities and expectations.
- [Breaking Changes](changelog/upgrade-guidance/breaking-changes.mdx): In-depth details on breaking changes and migration instructions.
- [Upgrade Instructions](changelog/upgrade-guidance/upgrade-instructions.mdx): Stepwise guidance for upgrading GoogleTest and GoogleMock.
- [Using Mocks for Dependency Isolation](guides/core-workflows/using-mocks.mdx): Practical user workflows referencing current recommended APIs.

---

## 10. Troubleshooting and Common Pitfalls

<Tip>
When migrating, start with compiling your tests with warnings enabled and `--gmock_verbose=info` to identify deprecated usages.
</Tip>

<Tip>
Avoid mixing old and new mock macros within the same codebase to reduce confusion and compile-time errors.
</Tip>

### Summary

This page focuses exclusively on deprecated and removed mock-related features and workflows, framing them in user terms and with best practices. Follow the migration paths to future-proof your tests and limit technical debt.

---

For additional context regarding test execution, assertions, and mocking concepts, consult the broader [GoogleTest Core Testing APIs](api-reference/core-testing-apis/assertions-and-expectations-api.mdx) and [GoogleMock Mocking Basics](api-reference/mocking-framework-apis/mocking-basics-api.mdx) documentation.

---

## 11. Sample Migration Code Snippet

```cpp
// Old-style deprecated mock method:
class MockFoo {
 public:
  MOCK_METHOD1(Foo, int(int));
};

// Modern recommended style:
class MockFoo {
 public:
  MOCK_METHOD(int, Foo, (int), (override));
};
```

---

In the next GoogleTest/GoogleMock iterations, expect further cleanup of legacy interfaces and improved defaults.

Continue monitoring this page for upcoming removals and migration assistance.

---

# End of Deprecated & Removed Features Documentation
