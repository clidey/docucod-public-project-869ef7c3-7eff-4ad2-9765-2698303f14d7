---
title: "Noteworthy Improvements"
description: "Aggregates the most impactful and user-visible enhancements—such as assertion upgrades, new matcher patterns, or build system improvements—across recent versions. Helps users discover new capabilities that may prompt them to upgrade."
---

# Noteworthy Improvements

This page provides a focused overview of impactful GoogleTest and GoogleMock enhancements across recent versions. It summarizes user-facing improvements such as enhanced assertions, new matcher patterns, refined mocking behaviors, and optimizations in the build system. Users can leverage these highlights to quickly identify valuable capabilities that can improve their testing practices and encourage timely upgrades.

---

## Assertion and Matcher Enhancements

Recent updates have substantially expanded the expressiveness and ease of writing assertions and matchers, enabling users to specify complex test conditions more naturally.

- **Expanded Matcher Compositions:** Users now benefit from more sophisticated matcher combinators, including enhanced support for multi-argument matching and tuple-based conditions. This allows verification of cross-parameter relationships in mock calls, e.g., asserting that one argument is less than another within a single expectation.

- **Custom Matcher Support:** Custom matcher creation is streamlined with `MATCHER` macros and matcher classes supporting both monomorphic and polymorphic designs. This empowers users to encapsulate intricate validation logic with clear, reusable predicates backed by rich diagnostic messages.

- **Improved Matchers for Containers and Pointers:** New matchers simplify the verification of STL containers (vectors, maps) by allowing partial or unordered element checks. Pointer-related matchers now robustly handle null checks and dereferenced value assertions, accommodating raw and smart pointers.

- **Better Predicate Integration:** Matchers can be used as predicates in STL algorithms via `Matches()`, enhancing test assertion flexibility and the expressive power of GoogleTest expectations.

### Code Example: Multi-Argument Matching with `.With()` Clause

```cpp
EXPECT_CALL(my_mock, SetPosition(_, _))
    .With(Lt());  // Asserts first arg less than second
```

## Mocking API and Behavior Improvements

GoogleMock’s mocking facilities have evolved to make mock objects easier to define, configure, and utilize reliably.

- **`MOCK_METHOD` Macro Enhancements:** The unified `MOCK_METHOD` macro supports all combinations of method qualifiers (const, noexcept, override, reference qualifiers) and calling conventions, enabling precise mocking across diverse C++ codebases.

- **Handling Complex Signatures:** Solution patterns for mocking methods with complicated argument lists containing commas—via type aliasing or wrapping argument types in parentheses—are clearly documented to prevent compilation issues.

- **Mock Strictness Controls:** Users can specify mock strictness levels through wrappers like `NiceMock`, `NaggyMock`, and `StrictMock`. This empowers users to suppress uninteresting call warnings or turn them into errors, finely controlling the noise and rigor of their test suites.

- **Call Ordering and Cardinality Clauses:** Expectations can specify ordered or partially ordered call sequences using `InSequence`, `After`, and `Sequence` objects. Cardinalities (`Times`) support exact, ranged, or unbounded invocation counts with informative errors on mismatch.

- **Default Behavior and Delegation:** The `ON_CALL` macro allows setting default mock method behaviors separately from expectations, reducing brittle tests. Delegation patterns to real or fake objects ensure mocks reflect real behavior where desired.

- **Move-Only Type Support:** GoogleMock now robustly supports mocking methods with move-only arguments and return types, using lambdas and callable objects to define behaviors for such cases.

### Usage Tip: Suppressing Unwanted Mock Call Warnings

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> mock_foo;
EXPECT_CALL(mock_foo, DoThis());  // Suppresses warnings on other calls
```

## Build System and Integration Updates

- **C++17 Compliance:** Starting with release 1.17.x, GoogleTest requires a minimum of C++17, ensuring modern language features and improved performance.

- **Build Configuration:** Enhanced CMake support with package configuration files (`gmock.pc.in`) simplifies integration. The build system handles pthread detection and library inclusion seamlessly.

- **Continuous Integration:** Google uses internal continuous integration systems providing rigorous automated testing of the GoogleTest suite, ensuring stability and early detection of regressions.

## Practical Recommendations

- Upgrade to the latest GoogleTest versions to leverage improved matcher expressiveness and mocking capabilities that reduce test code complexity and increase maintainability.

- Use the `.With()` matcher clause to express inter-argument relationships elegantly within `EXPECT_CALL` setups.

- Adopt `NiceMock` or `StrictMock` wrappers as appropriate to balance test strictness and noise.

- Define default mock behaviors via `ON_CALL` to make tests resilient and focused only on meaningful interactions.

- Refer to detailed recipes in the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) and the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for advanced usage patterns.

## Troubleshooting and Pitfalls

- Remember that unprotected commas in argument lists to `MOCK_METHOD` cause compilation errors; use type aliases or parentheses to avoid this.

- Setting expectations after the mock method has been called leads to undefined behavior - always define them before exercising the mock.

- When mocking overloaded methods, ensure all variants are mocked or use `using` declarations to avoid hiding base class methods.

- Use `--gmock_verbose=info` command-line flag during test runs to get detailed call traces and expectation matches, invaluable for debugging mismatches.

---

## References and Further Reading

- [GoogleMock Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [GoogleTest Releases on GitHub](https://github.com/google/googletest/releases)

---

## Source Code & Contribution

GoogleMock is part of the GoogleTest repository, a consolidated project to maintain both testing and mocking frameworks together. Contributions and extensions are welcomed under guidelines provided in [`CONTRIBUTING.md`](https://github.com/google/googletest/blob/main/CONTRIBUTING.md), emphasizing code quality, backward compatibility, and addressing real user needs.

To inspect or explore the codebase relevant to mocking and matcher enhancements, visit the repository on GitHub:

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/gmock_cook_book.md", "range": "1-700"},{"path": "docs/reference/mocking.md", "range": "1-450"},{"path": "docs/gmock_cheat_sheet.md", "range": "1-550"},{"path": "googlemock/cmake/gmock.pc.in", "range": "1-15"}]} />

---

This documentation aggregates the most user-visible improvements to guide practitioners in optimizing their use of GoogleTest and GoogleMock.
