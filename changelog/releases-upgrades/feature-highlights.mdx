---
title: "What's New & Feature Highlights"
description: "Summarizes major new capabilities, enhancements, and additions in the latest and recent releases. Learn at a glance about the most impactful updatesâ€”allowing you to quickly leverage new productivity features or testing tools within your project."
---

# What's New & Feature Highlights

Stay ahead with a clear view of the latest and most impactful changes in GoogleTest and GoogleMock. This page offers a high-level summary of new capabilities, improvements, and additions that enhance your productivity and testing power. Quickly grasp new features and understand how to leverage them effectively in your projects.

---

## 1. Enhancements in Mocking Syntax and Behavior

### Expanded Flexibility in Mock Method Definitions
- Support for advanced qualifiers in `MOCK_METHOD`: including `const`, `override`, `noexcept`, calling convention specifiers (`Calltype`), and reference qualifiers (`ref(&)`, `ref(&&)`).
- Improved handling of complex argument types that involve commas by allowing parentheses wrapping or type aliases to circumvent parsing issues.
- Enhanced mocking of overloaded methods and class templates with seamless support for multiple versions, enabling precise control over each overload.

### Increased Control in Setting Expectations
- `EXPECT_CALL` now supports richer chains including ordering (`InSequence`), dependencies (`After`), and more precise argument matching with matchers and `With` clauses.
- Smart cardinality inference: if `Times()` is omitted, the system infers the expected number of calls based on the presence of `WillOnce()` and `WillRepeatedly()`, leading to less boilerplate.
- Introduction of the `.RetiresOnSaturation()` clause allows expectations to automatically become inactive once satisfied, helping avoid sticky expectations that may cause test brittleness.

### Improved Default Action and Behavior Management
- Use of `ON_CALL` for setting default behaviors for mock methods without setting strict expectations, streamlining test setup.
- Default return actions smartly handle built-in types, pointers, and default-constructible C++11 types.
- Facility to customize default return values globally with `DefaultValue<T>::Set()` and `SetFactory()`.

---

## 2. Strictness and Mock Object Modes

### NiceMock, NaggyMock, and StrictMock Wrappers
- `NiceMock<T>`: suppresses warnings on uninteresting calls, making tests cleaner when extraneous calls are permissible.
- `NaggyMock<T>`: current default behavior, warns on uninteresting calls to keep users informed.
- `StrictMock<T>`: converts warnings on uninteresting calls into test errors to enforce tight control over expected calls.
- These wrappers inherit constructors from their base mocks, allowing easy substitution with minimal code changes.

### Strategizing Strictness for Test Stability
- Guidance on using these wrappers: favor `NiceMock` for less brittle tests, use `NaggyMock` for development and debugging, and apply `StrictMock` only when you desire strict enforcement.
- Known limitations specified around mock methods inherited from base classes, and handling of destructors.

---

## 3. Advanced Call Ordering and Dependencies

### Sequences and Partial Ordering
- Expectations can be grouped into `Sequence` objects, ensuring calls occur in a specified order.
- `InSequence` scope helper allows easy definition of sequences in test code with natural syntax.

### Flexible Partial Orders with `After` and `ExpectationSet`
- `After()` clause lets you express dependencies on multiple prior expectations, forming directed acyclic graphs (DAGs) of call ordering.
- Supports complex workflows where some calls must precede others without enforcing total order.

### Retirement and Saturation Behavior
- Expectations can retire automatically when saturated, especially within sequences or when `.RetiresOnSaturation()` is specified, preventing further matching and avoiding unexpected failures.

---

## 4. Robust Error Reporting and Debugging Aids

### Verbosity Flags and Diagnostic Information
- The `--gmock_verbose` flag controls the verbosity level of mock call output:
  - `info`: prints detailed info including stack traces for expected and uninteresting calls.
  - `warning` (default): prints warnings and errors, no stack traces for uninteresting calls.
  - `error`: prints errors only.

### Comprehensive Messages for Call Mismatches
- Detailed reports generated for unexpected calls including failed expectations and argument mismatches.
- For uninteresting calls, clear warnings are shown unless using `NiceMock`.
- Facilities to trace exact matches and how calls correspond to expectations with stack trace snippet to guide debugging.

### Tools for Complex Tests
- Checkpoints using mocks with `MockFunction` to segment phases of execution.
- Forced verification capabilities with `Mock::VerifyAndClearExpectations()` to test mocks before destruction, preventing silent test passes due to leaked mocks.

---

## 5. Mocking Modern C++ Types and Patterns

### Move-Only Types Support
- Native support for mocking methods that take or return move-only types like `std::unique_ptr` using `MOCK_METHOD`.
- Guidance on working with move-only arguments in actions and expectations.
- Legacy workarounds provided for older codebases if needed.

### Mocking Non-Virtual Methods and Free Functions
- Techniques for mocking non-virtual methods through templates for high-performance dependency injection.
- Interfaces recommended for mocking free (non-member) functions by wrapping them and mocking through abstract classes.

### Delegation Patterns
- Delegating mock behavior to fakes or real objects via `ON_CALL` with custom `WillByDefault` actions.
- Calling real or parent class implementations to combine mock validation with real functionality.

---

## 6. Extending GoogleMock

### Custom Matchers and Actions
- Use of `MATCHER` macros and template classes to define expressive, reusable argument matchers.
- Parameterized matchers (`MATCHER_P`, `MATCHER_P2`, etc.) allow matchers with arguments for flexible validation.
- Writing new actions via lambdas, functors, or implementing `ActionInterface` for custom call handling.

### Composite Matchers and Sharing
- Combining smaller matchers into composite ones using `AllOf()`, `AnyOf()`, and others.
- Efficient sharing and reuse of matcher and action objects across multiple expectations.

---

## 7. Best Practices and Tips for Effective Use

- Set expectations (`EXPECT_CALL`) before exercising mocks to avoid undefined behavior.
- Prefer expressing call order explicitly using sequences or `After` to prevent brittle tests.
- Use `ON_CALL` for default behaviors and minimize constraints to avoid over-specification.
- Manage mock strictness appropriately to balance test failure sensitivity with maintainability.
- Take advantage of verbosity flags to gain insight during development and debugging.
- Use `RetiresOnSaturation()` to avoid sticky expectations and failures from repeated calls.

---

## Code Snippet: Sample Mock Class with Advanced Features

```cpp
#include <gmock/gmock.h>

class Foo {
 public:
  virtual ~Foo() = default;
  virtual int GetValue() const = 0;
  virtual std::string Process(const std::string& input) = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
  MOCK_METHOD(std::string, Process, (const std::string& input), (override));
};

using ::testing::Return;
using ::testing::InSequence;

TEST(FooTest, UsageExample) {
  MockFoo mock;
  ON_CALL(mock, GetValue()).WillByDefault(Return(42));

  {
    InSequence s;
    EXPECT_CALL(mock, Process("start")).WillOnce(Return("ok"));
    EXPECT_CALL(mock, Process("end")).WillOnce(Return("done"));
  }

  // Use mock in tested code
}
```

---

## Related Documentation

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [Matchers Reference](https://google.github.io/googletest/reference/matchers.html)
- [Actions Reference](https://google.github.io/googletest/reference/actions.html)
- [Strict, Nice, and Naggy Mocks](https://google.github.io/googletest/reference/mock_strictness.html)
- Flags: `--gmock_verbose` for controlling diagnostic output

---

## Troubleshooting Tips

- Use `--gmock_verbose=info` during test development to trace exact mock calls and matching expectations.
- Verify mock strictness settings match your test goals (use `NiceMock` to suppress warnings if calls are expected but not strictly checked).
- Always set your expectations before running test code that calls mocks to avoid undefined behavior.
- Leverage `RetiresOnSaturation()` and sequences to avoid test brittleness caused by sticky or unordered expectations.
- For runtime errors or unexpected behavior related to move-only types or complex call patterns, consult the delegation examples and legacy workarounds.
- Use `Mock::VerifyAndClearExpectations()` if mocks live beyond test scope to ensure proper verification.

---

This page gives you a powerful overview of new features and best practices to maximize your use of GoogleTest and GoogleMock. Dive into the sections most relevant to your work and explore linked detailed documents for deeper mastery.
