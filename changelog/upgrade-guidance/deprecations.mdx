---
title: "Deprecations & Removals"
description: "Highlights features, flags, or APIs marked as deprecated or removed, starting from which version, and recommended alternatives. Prevents surprises during upgrades and lets users proactively refactor code."
---

# Deprecations & Removals

This page informs users about features, flags, APIs, or behaviors in GoogleTest and GoogleMock that have been deprecated or removed. It aims to prepare you for upgrades by clearly indicating from which version certain changes took place, what alternatives are available, and how to adapt your code to avoid surprises.

---

## Understanding Deprecations

Over time, GoogleTest evolves to improve usability, maintainability, and performance. Some features are phased out when they are superseded by better alternatives or no longer fit the direction of the project. Knowing what has been deprecated helps you write future-proof tests and maintain clean, up-to-date code.

Typically, a deprecated feature:

- Is still available in the current version but will be removed in a future release.
- Produces compiler warnings or runtime notices when used.
- Has a recommended replacement or alternative approach.

**Action Tip:** Address deprecations promptly by refactoring your test code according to the provided migration advice.

## Recognizing Removals

Removals occur when deprecated features are eliminated from the codebase, often after giving sufficient notice in earlier versions.

When upgrading to a version where a feature is removed:

- Your code relying on the removed feature will fail to compile or run.
- You must follow the migration path provided to update your tests.

**Best Practice:** Always review the deprecation notices in recent versions before upgrading to anticipate necessary changes.

## Key Deprecated and Removed Features

Below is a curated list highlighting major deprecated or removed elements relevant specifically to mocking and test doubles within GoogleMock.

### 1. Old-Style Mock Macros (`MOCK_METHODn` family)

- **Status:** Deprecated since 2018; removal planned in a future release.
- **Replaced by:** The generic `MOCK_METHOD` macro.
- **Why:** The new `MOCK_METHOD` macro offers better clarity, supports qualifiers (like `const`, `override`, `noexcept`), and simplifies mocking of complex types.

**Migration:**
Replace usages of `MOCK_METHODn`, `MOCK_CONST_METHODn`, and related macros with `MOCK_METHOD` syntax. For example:

```cpp
// Old style
MOCK_METHOD1(Foo, bool(int));

// New style
MOCK_METHOD(bool, Foo, (int));
```

Refer to the [Mock Object Construction](../docs/reference/mocking.md#Old-Style-MOCK_METHODn-Macros) section for detailed conversion.

---

### 2. Direct Mocking of Destructors with `MOCK_METHOD`

- **Status:** Direct mocking of destructors via `MOCK_METHOD` does not compile.
- **Replacement Pattern:** Add a mock method such as `Die()` that is called from the destructor.

**Example:**

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, Die, ());

  ~MockFoo() override { Die(); }
};
```

This approach allows expectations on destruction timing using the `Die()` method.

---

### 3. Strictness Modifiers for Mocks

- **Current Practice:**
  - `NaggyMock` is the default behavior which warns on uninteresting calls.
  - `NiceMock` suppresses warnings on uninteresting calls.
  - `StrictMock` treats uninteresting calls as test failures.

- **Changes:**
  - Users are encouraged to prefer `NiceMock` or explicit expectations to manage warnings.
  - Overuse of `StrictMock` can lead to brittle tests and is recommended only when necessary.

Refer to the [Mock Strictness and Behavioral Control](concepts/advanced-mechanisms/mock-strictness.mdx) guide.

---

### 4. Flag Changes and Deprecations

- The command-line flag `--gmock_verbose` controls the verbosity of mock diagnostics.

| Flag Value | Effect                   | Status                    |
| ---------- | ------------------------ | ------------------------- |
| `info`     | Most verbose, logs all calls including stack traces | Supported              |
| `warning`  | Default, shows warnings and errors without stack traces | Supported          |
| `error`    | Errors only, less verbose   | Supported                |

- **Deprecated Flags:** Flags which conflict or have been superseded are documented in release notes and should be avoided.

**Tip:** Use `GMOCK_FLAG_SET(verbose, "value")` within tests to control output verbosity.

---

## Migration and Upgrade Guidance

### How to Prepare Your Code

1. **Identify Deprecated Features:** Scan test code for use of old mock macros, deprecated flags, and patterns.
2. **Refactor to Supported APIs:** Replace deprecated macros with `MOCK_METHOD` and update test expectations accordingly.
3. **Adjust Verbosity Flags:** Use supported flag values only, and consider suppressing overly verbose output in routine test runs.
4. **Test Thoroughly:** After migrating, run your full test suite to catch unexpected failures or behavioral differences.

### Resources for Migration

- [Mock Object Construction Reference](../docs/reference/mocking.md#Old-Style-MOCK_METHODn-Macros)
- [gMock Cookbook](../docs/gmock_cook_book.md)
- [Breaking Changes & Migrations Guide](breaking-changes.mdx)
- Release Notes highlighting deprecated/removed features

---

## Troubleshooting Deprecations and Removals

**Problem:** Compilation fails due to use of removed macros like `MOCK_METHODn`.

**Solution:** Switch to the modern `MOCK_METHOD` syntax. Review and update method qualifiers.

**Problem:** Tests unexpectedly fail when upgrading to a newer version.

**Solution:** Check for deprecated or removed features in the changelog. Increase verbosity with `--gmock_verbose=info` to trace mock call matching.

**Problem:** Excess warnings on uninteresting mock calls.

**Solution:** Use `NiceMock<>` wrappers for mock objects or explicitly add `EXPECT_CALL(...).Times(AnyNumber())` for those methods.

---

## Summary

Keeping abreast of deprecations and removals in GoogleTest and GoogleMock is essential for maintaining healthy, future-proof test suites. This page equips you to recognize deprecated features, understand alternatives, and navigate upgrade steps confidently.

For comprehensive upgrade strategies and details on deprecated APIs and flags, please consult the linked references and guides.


---

❯ [Back to Breaking Changes & Migrations](breaking-changes.mdx)

❯ [Mocking Reference](../docs/reference/mocking.md)

❯ [gMock Cookbook](../docs/gmock_cook_book.md)

❯ [GoogleTest Release Notes](release-notes.mdx)

❯ [Strictness Levels and Behaviors in Mocking](concepts/advanced-mechanisms/mock-strictness.mdx)

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/reference/mocking.md", "range": "1-522"},{"path": "docs/gmock_cook_book.md", "range": "1-1456"}]} />