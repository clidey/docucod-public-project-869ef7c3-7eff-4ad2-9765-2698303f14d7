---
title: "Upgrade Checklist & Best Practices"
description: "A step-by-step guide for upgrading between major and minor versions of GoogleTest/GoogleMock. Includes preparation steps, code migration strategies, and validation tips to ensure a smooth and low-risk update process for both individuals and teams."
---

# Upgrade Checklist & Best Practices

Upgrading GoogleTest and GoogleMock between versions—whether major or minor—can introduce changes that impact your existing tests and build configurations. This guide provides a structured, step-by-step workflow to prepare, execute, and validate your upgrade, ensuring minimal disruption and smooth transition. It is tailored to help both individuals maintaining small projects and teams managing large, complex testing infrastructures.

---

## 1. Preparation and Assessment

Before beginning the upgrade process, thoroughly assess your current setup, project dependencies, and testing coverage.

### 1.1 Review Current Version
- Identify the exact GoogleTest/GoogleMock version currently in use.
- Note any customized patches or forked changes in your existing test environment.

### 1.2 Check Compatibility and Prerequisites
- Confirm your compiler supports the minimum C++ standard required by the target version (e.g., C++17 for 1.17.x).
- Review [System Requirements & Supported Platforms](../getting-started/prerequisites-installation/system-requirements) for updated compiler, OS, and tooling compatibility.

### 1.3 Review Release Notes and Breaking Changes
- Read detailed [Release Notes by Version](../changelog/version-history/release-notes) for the target GoogleTest version.
- Check the [Breaking Changes & Deprecations](../changelog/upgrade-guidance/breaking-changes) for API and behavior modifications that may affect your tests.

### 1.4 Audit Your Tests and Build
- Inventory your test suites and mock usage patterns.
- Identify deprecated macros or APIs now marked for removal.
- Check for any direct use of internal headers or non-public APIs.

<Note>
Ensure your build system (especially if using CMake or Bazel) is compatible with the new version’s build requirements. GoogleMock's CMakeLists.txt has changed in recent versions—consult [Installing with CMake](../getting-started/prerequisites-installation/installation-cmake) for guidance.
</Note>

---

## 2. Upgrade Strategy and Migration

Follow a disciplined approach to apply the upgrade incrementally and verify at each stage.

### 2.1 Backup and Branching
- Create a backup or a dedicated Git branch for the upgrade work.
- Ensure tests pass on the current version before beginning.

### 2.2 Update Dependencies
- Replace old GoogleTest/GoogleMock sources or update package versions.
- For CMake builds, update submodules or FetchContent declarations to the new release commit or tag.
- Adjust the `CMakeLists.txt` and build flags as necessary following new build scripts (see googlemock/CMakeLists.txt).

### 2.3 Resolve API Changes
- Replace deprecated macros or methods with preferred alternatives. For example, migrate `TEST_CASE` to `TEST_SUITE` where applicable.
- Review [Test Macros and Test Registration](../api-reference/core-apis/test-macros) and [Mock Class APIs and Expectations](../api-reference/core-apis/mocking-basics) for updated usage.

### 2.4 Adapt to Behavioral Changes
- Check for updated default mock behaviors—default actions, strictness, and warnings have evolved.
- Refactor `EXPECT_CALL` and `ON_CALL` usage to accommodate new cardinality or action constraints (see [Mocking Reference](../docs/reference/mocking.md)).

### 2.5 Update Test Initialization
- Transition any custom `main()` functions to leverage `gtest_main` or `gmock_main` libraries for easier maintenance.
- Initialize GoogleMock properly in `main()` using `InitGoogleMock()` as recommended.

---

## 3. Validation and Testing

Once the upgrade changes are applied, thorough validation is critical to verify correctness and stability.

### 3.1 Run All Tests
- Build your test binaries with the new GoogleTest/GoogleMock libraries.
- Execute `RUN_ALL_TESTS()` from your test runner.
- Ensure no new failures or warnings appear related to testing framework changes.

### 3.2 Diagnose Failures
- Inspect failures carefully. Many may be caused by stricter assertions or changed mock invocation behaviors.
- Use [Troubleshooting Common Setup Issues](../getting-started/troubleshooting-help/common-errors) and [Test Failures & Debugging](../faq/troubleshooting-and-integration/test-failures-debugging) guides.

### 3.3 Validate Mock Behavior
- Verify that mocks behave as expected, particularly concerning call counts, sequences, and default actions.
- Use diagnostic macros and increase verbosity if needed, for example, `--gmock_verbose=info`.

### 3.4 Regression Checklist
- Run your tests under various configurations (different OS, debug/release builds).
- For parameterized tests, confirm all parameter sets are still covered.

<Info>
GoogleTest’s [Mocking Reference](../docs/reference/mocking.md) and the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) are valuable resources to understand mock behaviors and resolve common compatibility challenges.
</Info>

---

## 4. Best Practices for a Smooth Upgrade

Adopting the following practices will help you maintain test reliability when upgrading:

### 4.1 Make Incremental Changes
- Avoid big-bang upgrades in large projects.
- Upgrade GoogleTest in small parts of your system before a full rollout.

### 4.2 Keep Tests Isolated
- Ensure your tests do not have fragile dependencies that could be invalidated by framework updates.
- Use fixtures correctly to manage test state.

### 4.3 Leverage Parameterized Tests
- Convert repetitive tests to parameterized versions for better maintenance and easier verification after upgrades.

### 4.4 Document Your Upgrades
- Record changes to test code and build dependencies.
- Annotate commits with references to GoogleTest version changes and any migration steps applied.

### 4.5 Automate Regression Testing
- Integrate upgraded tests into continuous integration (CI).
- Use GoogleTest’s rich filtering and test selection for running a subset of critical tests during early validation.

<Check>
Ensure version control and continuous testing pipelines incorporate your upgrade branch and approval processes.
</Check>

---

## 5. Practical Upgrade Example

Here is a simplified upgrade workflow example using CMake:

```bash
# 1. Clone fresh repository or create a new branch
git checkout -b upgrade-googletest-1.17

# 2. Update FetchContent or git submodule reference for googletest
#    In your project's CMakeLists.txt:
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/v1.17.0.tar.gz
)
FetchContent_MakeAvailable(googletest)

# 3. Modify build scripts accordingly
#    Update link libraries from old gtest to new targets (e.g., GTest::gtest, GTest::gmock)

# 4. Modify any test code deprecated usage (from release notes)

# 5. Rebuild your test binaries
cmake -S . -B build
cmake --build build

# 6. Run tests and inspect
ctest --output-on-failure
```

---

## 6. Troubleshooting Tips

- **Linker errors or missing symbols:** Verify your build links against the right versions of `gtest` and `gmock` libraries.
- **Test failures due to stricter warnings:** Check for tests relying on deprecated or undefined behavior.
- **Unexpected mock call failures:** Review expectation counts and call orders, especially if you upgraded between 1.10.x and newer versions with changed default behaviors.
- **Multiple main() definitions:** Ensure you either link with `gtest_main` or provide exactly one `main()` implementation.

See [Build Integration FAQ](../faq/troubleshooting-and-integration/build-integration-faq) and [Troubleshooting Common Setup Issues](../getting-started/troubleshooting-help/common-errors) for focused help.

---

## 7. Additional Resources

- [GoogleTest Primer](../docs/primer.md) — Essential introduction to writing tests.
- [Mocking Basics Guide](../guides/getting-started-testing/mocking-basics) — Learn to use mocks effectively.
- [Parametered & Typed Tests](../guides/core-testing-workflows/parameterized-tests) — Strategies for reusable tests.
- [Release Notes & Breaking Changes](../changelog/version-history/release-notes) — Stay informed on upgrade implications.
- [Mocking Reference](../docs/reference/mocking.md) — Deep dive into mock classes and macros.

---

Upgrading GoogleTest and GoogleMock can unlock new capabilities and improve your testing infrastructure's robustness. By following this checklist and best practices, you ensure your test suites stay reliable and maintainable across versions, empowering your C++ development with cutting-edge test tooling.