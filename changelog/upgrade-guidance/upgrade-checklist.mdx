---
title: "Upgrade Checklist"
description: "A step-by-step checklist guiding users through a safe and efficient upgrade, from reading release notes to testing project compatibility and updating dependencies. This practical tool minimizes risks and reduces upgrade friction."
---

# Upgrade Checklist

Navigating a seamless upgrade is essential to leveraging the latest improvements in GoogleTest and GoogleMock without disruption. This Upgrade Checklist guides you through each critical step — from carefully reading release notes to validating compatibility, testing behaviors, and updating dependencies — so you can confidently adopt new versions with minimal friction and risk.

---

## 1. Review Release Notes Thoroughly

Begin your upgrade journey by carefully examining the release notes for the new version. Look specifically for:

- **Breaking changes:** Note any incompatible API shifts or behavioral modifications.
- **Deprecations and removals:** Identify any features or macros that are deprecated or removed.
- **New features:** Understand enhancements that could benefit your tests.
- **Bug fixes:** Recognize known issues that have been resolved.

Release notes provide invaluable context for what adaptations your codebase and tests may require.

## 2. Verify Compatibility with Your Environment

Make sure your build environment meets the updated requirements:

- Confirm **compiler version** support; GoogleTest requires at least C++17 compatible compilers.
- Check dependency compatibility, particularly if you use **GoogleMock** or integrate with complex build tools (e.g., CMake, Bazel).
- Validate that your **test framework setup** aligns with any new or modified initialization steps.

These verifications prevent unexpected failures on upgrade.

## 3. Update Mock Classes and Methods

GoogleMock upgrades may introduce changes that affect how you define mocks and expectations:

- Migrate from any deprecated macros (e.g., old `MOCK_METHODn` macros) to the current `MOCK_METHOD` syntax.
- Review your mock classes to ensure all virtual methods are properly mocked, including handling const, override, noexcept, and calltype qualifiers.
- Verify usage of **matchers**, **actions**, and **cardinalities** aligns with any updated guidelines or new features.

## 4. Adjust Expectations and Actions

Work through your test suites to update EXPECT_CALL and ON_CALL usages:

- Pay attention to the chaining order of clauses like `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()`.
- Consider refining expectations for better test resilience by minimizing over-specification.
- Use **NiceMock**, **NaggyMock**, or **StrictMock** wrappers appropriately to manage warnings and failures related to uninteresting calls.

## 5. Test All Mock Usage Scenarios

Run your entire test suite observing:

- Tests where mock methods are expected to be called, including order and frequency.
- Tests verifying behavior on uninteresting or unexpected calls, confirming warnings or failures occur as intended.
- Scenarios involving sequences (`InSequence`), partial orders (`After`), and complex interaction patterns.

Be aware that upgrading may reveal previously undetected issues or require test updates.

## 6. Update Default Actions and Return Value Handling

- Where your mocks rely on default return values, ensure these are still appropriate; update or use `DefaultValue<T>` as needed.
- Confirm use of default actions via `ON_CALL` and verify they reflect the correct behavior post-upgrade.
- Check proper use of actions such as `Return()`, `ReturnRef()`, `Invoke()`, and chained actions `DoAll()`.

## 7. Validate Concurrency and Thread Safety

If your tests involve multi-threaded code:

- Confirm that mock interactions behave correctly when called from multiple threads.
- Use provided synchronization constructs or adjust test logic if timing or ordering issues arise due to changes in mock behavior.

## 8. Clean Up and Remove Deprecated Features

After confirming your tests run smoothly:

- Remove any workaround code for deprecated features.
- Refactor mocks and test helpers to use modern syntax and practices.
- Take advantage of new APIs or functionality introduced in the upgrade.

## 9. Verify Leak Detection and Verification Calls

- Ensure mock objects are deleted properly to trigger verification.
- If you intentionally leak mocks, use `Mock::AllowLeak()` judiciously.
- If needed, call `Mock::VerifyAndClearExpectations()` or `Mock::VerifyAndClear()` explicitly for early verification.

## 10. Document and Communicate Changes

Maintain clear upgrade notes within your team or project documentation:

- Highlight any test changes or new policies on mock usage.
- Point to new best practices as outlined in the gMock Cookbook and Cheat Sheet.
- Share relevant FAQs and troubleshooting tips from the official resources.

---

## Practical Tips & Common Pitfalls

- Avoid mixing setting expectations and exercising mocks; always call `EXPECT_CALL` prior to mock usage.
- Use `EXPECT_CALL(...).RetiresOnSaturation()` when setting multiple expectations on the same mock method to avoid brittleness.
- Suppress unwanted warnings about uninteresting calls by wrapping mocks with `NiceMock` or specifying `EXPECT_CALL(...).Times(AnyNumber())`.
- Be explicit about call order when dependencies exist, leveraging `InSequence` and `After` clauses.
- Periodically run tests with `--gmock_verbose=info` for enhanced diagnostics during upgrade troubleshooting.

## Troubleshooting Section

If you encounter test failures or unexpected mock behavior:

- Verify the order and matching of your EXPECT_CALL clauses; newer expectations override older ones.
- Look for mismatches between the actual calls and the expectations' matchers or `.With()` conditions.
- Check whether an expectation has been retired prematurely or whether unsatisfied prerequisites exist.
- Investigate default actions set by ON_CALL; unexpected default behaviors may mask missing expectations.
- Use `--gmock_verbose=info` to trace all mock call matches and expectation invocations to diagnose misalignments.

---

## Additional Resources

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html): Beginner-friendly tutorial on mock definitions and usage.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html): Detailed recipes for advanced mocking techniques.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html): Definitive API reference for mocking constructs.
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html): Quick reference to commonly used features.
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html): Answers to common confusion and migration questions.
- [Upgrade Guidance and Breaking Changes](https://google.github.io/googletest/changelog/upgrade-guidance/breaking-changes-migration.html): Detailed upgrade instructions.

---

With this checklist, your upgrade path to newer versions of GoogleTest and GoogleMock will be structured, efficient, and low-risk. Take advantage of community-tested practices, leverage extensive official guides, and maintain your testing codebase’s health and accuracy throughout the upgrade.
