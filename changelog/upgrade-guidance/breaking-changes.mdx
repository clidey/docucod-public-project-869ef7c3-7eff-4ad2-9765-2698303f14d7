---
title: "Breaking Changes and Deprecations"
description: "Details significant changes that may require user action, such as API removals, behavioral modifications, or minimum toolchain requirements (e.g., move to C++17). Includes a list of deprecated features and timelines for their removal."
---

# Breaking Changes and Deprecations

This page details significant changes in GoogleTest and GoogleMock that may impact your existing tests and build setups. It highlights API removals, behavioral modifications, and new minimum requirements that require your attention. Additionally, this page lists deprecated features along with timelines for their removal, empowering you to plan and execute smooth upgrades.

---

## 1. Introduction

Upgrading GoogleTest or GoogleMock occasionally involves adapting your code due to breaking changes or deprecated features. This documentation focuses specifically on:

- Changes that **require user action** or code modification.
- Behavioral changes that might alter test outcomes or mock expectations.
- Minimum compiler and language standard requirements that affect build configurations.
- Features that are deprecated, with clear timelines and recommended migration paths.

Understanding these changes will help maintain the correctness, compatibility, and performance of your test suites.

## 2. Minimum Toolchain Requirements

Starting from recent versions, GoogleTest and GoogleMock have tightened build requirements to leverage modern C++ features and improve cross-platform behavior.

- **C++ Standard:** Requires at least **C++17** support. Compilers or build systems that only support earlier standards (e.g., C++11 or C++14) are no longer supported.

  > This change enables the use of newer language features that improve code safety, expressiveness, and performance.

- **Compiler Versions:** Ensure the compiler version you use supports C++17 fully. Commonly used modern compilers such as GCC (8+), Clang (7+), and MSVC (2017 update 3 and later) satisfy this requirement.

- **Thread Safety and Platform Support:** Builds assume platforms support standard threading, exception handling, and file system features. Embedded or constrained environments without these capabilities may face build or runtime issues.

<Tip>
If you encounter build errors related to compiler versions or language standard support, verify your toolchain configuration to comply with C++17 or later.
</Tip>

## 3. Behavioral Changes Affecting Tests

### 3.1 Expectation Matching Order

GoogleMock follows a strict rule that **later expectations override older ones** for matching calls. This change, fully enforced in recent versions, affects how multiple expectations on the same mock method interact.

- In the case of multiple `EXPECT_CALL` statements matching the same method and argument patterns, the most recently defined expectation takes precedence.
- This ordering influences which action or return value is taken on the call.

<Note>
Understanding this precedence is critical to avoid unexpected test failures or surprises when mocking.
</Note>

### 3.2 Stickiness of Expectations

Expectations remain "sticky" by default, meaning they continue matching calls even after their specified invocation counts are reached (unless `RetiresOnSaturation()` is used). This change enforces consistency with gMock's design philosophy.

- To retire an expectation after it's fulfilled, explicitly use `.RetiresOnSaturation()`.
- Expectations included in sequences retire automatically when the next expectation in the sequence is used.

<Tip>
When writing tests expecting sequential calls with different results, combine the expectation sequence with `RetiresOnSaturation()` to prevent overlapping matches.
</Tip>

### 3.3 Default Actions for Mock Methods

- Mock functions with return types supporting default construction now return default-constructed values by default if no explicit action is specified.
- This was introduced to improve usability but may affect legacy tests that rely on different return values.

### 3.4 Changes in Uninteresting Call Warnings

- By default, gMock now warns on uninteresting calls (calls to mock methods with no expectations).
- Use `NiceMock` wrappers to suppress these warnings if your tests do not require strict call validation.
- For stricter validation, use `StrictMock` which treats uninteresting calls as failures.

## 4. Deprecated Features and Removal Timeline

### 4.1 Legacy MOCK_METHOD Macros

The older family of mock method macros (`MOCK_METHODn`, `MOCK_CONST_METHODn`, etc.) is deprecated in favor of the generic `MOCK_METHOD` macro.

**Action:**

- Migrate to `MOCK_METHOD` which has a clearer syntax and supports all method qualifiers.
- Avoid introducing new mocks with old macros.

### 4.2 Compiler Support for C++14 and Earlier

Support for compilers that lack C++17 capability has been dropped.

### 4.3 Deprecated Mock Behavior Modes

- The underlying implementations of mock behavior modifiers are being refined.
- `NaggyMock` remains the default but may change in future versions.

### 4.4 Heap Checker and Leak Detection Changes

- The heap checker integration with mocks is now more robust but relies on proper virtual destructors in mock classes.

### 4.5 Support for Variadic Function Mocking

- Mocking of variadic functions is still not supported and marked for deprecation where workarounds exist.

## 5. Migration Recommendations

### 5.1 Review Your Mock Expectations

- Explicitly specify the order of expectations when call ordering matters using sequences or `InSequence`.

### 5.2 Use New `MOCK_METHOD` Macro

- Refactor mock methods to use the new macro for better compatibility and future-proofing.

### 5.3 Confirm C++17 Compliance

- Update build configurations in CMake, Bazel, or other build systems to target C++17 or later.

### 5.4 Adjust Mock Behavior Modes

- Switch to `NiceMock` or `StrictMock` as appropriate to manage warnings and errors on unexpected calls.

### 5.5 Use `.RetiresOnSaturation()` Explicitly

- To avoid sticky expectations causing unexpected failures, especially in sequences, apply `.RetiresOnSaturation()`.

## 6. Troubleshooting Common Issues

### 6.1 Unexpected Call Failures

- Typically caused by overlapping expectations or order mismatches.
- Investigate using `--gmock_verbose=info` for detailed tracing.

### 6.2 Compilation Errors Related to MOCK_METHOD

- Check for commas in parameter types that require extra parentheses or type aliases.
- Verify all mocked methods are virtual.

### 6.3 Heap Checker Warnings

- Ensure all base classes have virtual destructors when mocking.

### 6.4 Build Failures Due to Language Standard

- Confirm your compiler and build settings enforce C++17 or later.

## 7. Additional Resources

- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) – Beginner-friendly introduction to GoogleMock.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) – Advanced usage recipes and patterns.
- [Mocking Reference](../api-reference/mocking-api/mock-creation.md) – Detailed API of mocks.
- [Breaking Changes Documentation](../changelog/upgrade-guidance/breaking-changes.md) – Detailed changelog and migration notes.
- [Upgrade Guide](../changelog/upgrade-guidance/upgrade-guide.md) – Step-by-step guide to upgrade.

---

### Quick links from this document:
- [Minimum Toolchain Requirements](#1-minimum-toolchain-requirements)
- [Behavioral Changes Affecting Tests](#3-behavioral-changes-affecting-tests)
- [Deprecated Features and Removal Timeline](#4-deprecated-features-and-removal-timeline)
- [Migration Recommendations](#5-migration-recommendations)
- [Troubleshooting](#6-troubleshooting-common-issues)

---

Ensure your tests and build systems align to these guidelines to fully benefit from GoogleTest and GoogleMock's latest improvements while minimizing upgrade disruptions.
