---
title: "Upgrade Tips & Best Practices"
description: "Practical advice for planning and executing successful upgrades. Covers common pitfalls, testing strategies, CI considerations, and links to external resources for more in-depth troubleshooting during migration."
---

# Upgrade Tips & Best Practices

This guide provides practical advice tailored for planning and executing successful upgrades of GoogleTest. It covers common pitfalls you should avoid, reliable testing strategies to verify your upgrade, considerations for continuous integration (CI) pipelines, and essential external resources to help troubleshoot during migration.

---

## Why Upgrade GoogleTest?

Upgrading GoogleTest ensures your test suite benefits from the latest features, performance improvements, security patches, and bug fixes. However, upgrading can introduce compatibility challenges or subtle behavioral changes that may affect your existing tests and build environment. This guide helps you bring clarity and confidence to your upgrade process.

## Common Pitfalls and How to Avoid Them

- **Skipping Environment Validation**: Before upgrading, verify that the target environment supports the GoogleTest requirements—especially C++17. Check your compiler version, OS, and build tools against the [Supported Platforms](../docs/platforms.md).

- **Ignoring Build System Integration**: Ensure your build system fully incorporates new GoogleTest source and header files correctly. For CMake users, integrating GoogleTest reliably involves either installing GoogleTest system-wide, using `find_package(GTest CONFIG REQUIRED)` for installed libs, or embedding GoogleTest as a subdirectory with `FetchContent` for source builds. See detailed instructions at [googletest/README.md](../googletest/README.md).

- **Overlooking Runtime Flag Changes**: GoogleTest flags and command-line options might evolve. Review your usage of flags such as `--gtest_filter`, `--gtest_repeat`, or `--gtest_break_on_failure` to confirm they maintain the desired effect after upgrading.

- **Not Monitoring Deprecated APIs**: Some older macros and features may be deprecated or removed over time, such as legacy `MOCK_METHODn` macros or old-style test case APIs. Consult the [Deprecations & Removals](../changelog/upgrade-guidance/deprecations.mdx) page for details.

## Testing Strategies During Upgrade

1. **Run Existing Tests First**: Execute your current GoogleTest suite on the new version without modifications to establish a baseline.

2. **Use `--gtest_list_tests`**: Use this flag to confirm all expected tests are detected and registered under the new version.

3. **Run with Verbose Output**: Enable verbose logging (`--gtest_color=yes` and related flags) to spot unexpected warnings and failures.

4. **Test Disabled and Parameterized Tests**: Verify tests disabled previously (`DISABLED_` prefix) and parameterized tests (`TEST_P`, `INSTANTIATE_TEST_SUITE_P`) remain recognized and operational.

5. **Integrate Gradual Rollout in CI**: Run the upgraded GoogleTest with a limited scope initially, gradually increasing coverage to catch issues early.

6. **Leverage Event Listeners**: For advanced test event monitoring, employ [custom event listeners](../guides/core-testing-workflows/advanced-assertions-and-matchers.md#extending-google-test-by-handling-test-events).

## Continuous Integration (CI) Considerations

- **C++17 Compliance**: Ensure your CI environment’s compiler and build tools support C++17, as required from GoogleTest 1.17.0 onward. Specify `set(CMAKE_CXX_STANDARD 17)` in your CMake projects.

- **Build Cache and Dependencies**: Clear or refresh caches if build failures occur due to stale binaries or mismatched dependencies.

- **Fail Fast Configuration**: Use `--gtest_fail_fast` to abort runs upon first failure during iterative upgrade testing.

- **Test Repetition and Shuffling**: Utilize `--gtest_repeat` and `--gtest_shuffle` to identify flaky tests that may be sensitive to upgrade side effects.

- **Parallel Execution**: Confirm thread safety and compatibility if you use sharding or parallel test execution in your pipelines. Review [Performance and Scalability](../concepts/integration-and-performance/performance-scalability.mdx) for best practices.


## Links to Essential Resources

- [Supported Platforms](../docs/platforms.md): Verify your platform compatibility.
- [Building and Integration Instructions](../googletest/README.md): Guide for integrating GoogleTest with your build system.
- [Deprecations & Removals](../changelog/upgrade-guidance/deprecations.mdx): Track obsolete features before upgrading.
- [Troubleshooting Installation & Setup](../getting-started/troubleshooting-and-help/troubleshooting-installation.mdx): Fix common setup problems.
- [Release Notes and Changelog Overview](../changelog/releases-overview/release-notes.mdx): Review new features and fixes in each version.
- [Breaking Changes & Migration Guidance](../changelog/upgrade-guidance/breaking-changes.mdx): Step-by-step upgrade instructions.


## Summary Checklist for Smooth Upgrade

- ✅ Verify environment and compiler support
- ✅ Validate build integration method (installed vs embedded source)
- ✅ Run all tests with the new version and compare results
- ✅ Review and apply any required code changes for deprecations
- ✅ Update CI configurations to use new GoogleTest flags and standards
- ✅ Monitor tests for flakiness using repetition and shuffling
- ✅ Leverage event listeners or XML/JSON reports to diagnose failures

<Tip>
Upgrading GoogleTest is an opportunity to improve your testing practices. Take advantage of newer features such as advanced assertions, event listeners, and parameterized tests to make your suite more robust and maintainable.
</Tip>

<Tip>
When integrating GoogleTest as a subdirectory with CMake, use the `FetchContent` module for reliable version management and compatibility across multiple platforms and CI environments.
</Tip>

---

## Troubleshooting Common Upgrade Issues

<AccordionGroup title="Common Upgrade Issues and Troubleshooting">
<Accordion title="Build Errors after Upgrading">
If your build fails after upgrading:
- Confirm your compiler and linker use consistent runtimes (static vs dynamic), especially on Visual Studio. Use the `gtest_force_shared_crt` CMake option if necessary.
- Check if you need to clear build caches or regenerate your build files.
- Ensure your project is using a C++17 compatible toolchain.
- For CMake, verify the `add_subdirectory()` or `find_package()` usage for GoogleTest.
</Accordion>

<Accordion title="Test Discovery Problems">
If some tests are missing:
- Verify that all test sources are correctly compiled and linked.
- Ensure that disabled tests are appropriately enabled if you expect them to run.
- Use the `--gtest_list_tests` flag to confirm discovered tests.
</Accordion>

<Accordion title="Runtime Failures or Unexpected Behavior">
- Some behavior might be affected by changes to assertion macros or test lifecycle management.
- Verify use of allowed `ASSERT_*` and `EXPECT_*` macros in your tests.
- Check for any deprecated APIs or macros removed during the upgrade.
- Run with `%--gtest_break_on_failure%` to catch failures under a debugger.
</Accordion>
</AccordionGroup>

---

## Example: Typical Upgrade Workflow

```bash
# Clone the repository and check out the target version
git clone https://github.com/google/googletest.git
cd googletest
# For example, upgrade to version v1.17.0
git checkout v1.17.0

# Clean your build directory
rm -rf build
mkdir build && cd build

# Configure
cmake .. -DBUILD_GMOCK=ON

# Build
cmake --build .

# Run tests with detailed output
./googletest-all-tests --gtest_color=yes --gtest_output=xml:result.xml

# Review XML report for diagnostics

# Integrate new GoogleTest with your own project's CMake configuration
# For example, add FetchContent declaration with required version
```

---

## Next Steps

- Consult the [Breaking Changes & Migration Guidance](../changelog/upgrade-guidance/breaking-changes.mdx) for detailed migration paths.
- Explore [Advanced Testing Patterns](../guides/advanced-testing-patterns/parameterized-tests.md) to modernize your test suites.
- Review [Performance and Scalability Tips](../guides/advanced-testing-patterns/performance-testing-tips.mdx) to optimize large test suites.
- If extending GoogleTest, refer to [Extending and Contributing](../overview/integration-adoption/extending-googletest.mdx).

---

**By carefully following this guide, you can upgrade your GoogleTest version with minimized disruption and maximal confidence, ensuring your tests remain a trusted pillar of your development lifecycle.**
