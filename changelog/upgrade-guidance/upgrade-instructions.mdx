---
title: "Upgrade Guides and Best Practices"
description: "Pragmatic, step-by-step upgrade guides for moving between major releases, including toolchain updates (such as requiring newer C++ standards), environment shifts, and dependency changes (e.g., introduction of new third-party dependencies)."
---

# Upgrade Guides and Best Practices

GoogleTest evolves alongside advancements in C++ standards, build systems, and testing workflows. This page provides pragmatic, step-by-step instructions to assist you in smoothly upgrading between major GoogleTest releases. It focuses on key upgrade tasks such as addressing toolchain requirements, environment changes, and adjustments to dependencies.

---

## 1. Preparing for Upgrade

Before initiating any upgrade, ensure you understand the scope of changes introduced in the target version and its compatibility with your project environment.

- **Review Release Notes:** Always begin by carefully reading the [official release notes](https://github.com/google/googletest/releases) for the version you plan to upgrade to, noting breaking changes, new features, and deprecated elements.
- **Verify Toolchain Compatibility:** Starting **from version 1.17.0**, GoogleTest requires **at least C++17**. Confirm your compiler and build system are configured accordingly.
- **Backup Existing Tests and Configurations:** Preserve current test sources and build scripts in case rollback is necessary.

<Tip>
Upgrade preparation prevents disruption by aligning your development environment with GoogleTest's new requirements.
</Tip>

---

## 2. Toolchain and Environment Updates

### 2.1 C++ Standard Requirements

GoogleTest now mandates compiling with **C++17** or later. This affects your build configuration:

- Update your `CMakeLists.txt` or equivalent build scripts to include:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- For custom build scripts, add appropriate compiler flags (e.g., `-std=c++17` for GCC/Clang).

### 2.2 Build System Integration

**If you use CMake:**

- Prefer building GoogleTest as a subdirectory using CMake’s `FetchContent` module for seamless integration and consistent build settings.

- Example addition to your project’s `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests gtest_main)
add_test(NAME my_tests COMMAND my_tests)
```

**If you use Bazel or other build systems:**

- Ensure your build rules accommodate the new minimum C++ standard and link dependencies accordingly.

<Tip>
Consistent toolchain settings across your tests and main projects avoid subtle incompatibilities.
</Tip>

---

## 3. Dependency Changes and New Third-Party Requirements

- **Abseil Dependency:** A future GoogleTest release plans to introduce a dependency on [Abseil](https://github.com/abseil/abseil-cpp). Be prepared to update dependency management accordingly.

- Currently, there are no direct dependency changes in version 1.17.0, but stay aware of notification channels.

---

## 4. API and Behavioral Adjustments

While GoogleTest strives for backward compatibility, some breaking changes and deprecated patterns require your attention.

### 4.1 Migration of Macros and Naming Conventions

- Avoid test suite and test names containing underscores (`_`) due to potential naming conflicts in generated classes. Use alphanumeric names without leading or trailing underscores.

- Deprecated macros or patterns may be removed in future. Check release notes for updates on any macros marked for deprecation.

### 4.2 Handling Fatal and Non-fatal Failures

- Recommended use of `EXPECT_` vs. `ASSERT_` macros should be reviewed and updated to best practices, ensuring tests continue logically where appropriate.

### 4.3 Death Tests

- If your tests use death assertions (`EXPECT_DEATH`, `ASSERT_DEATH`), verify these run correctly under the new version, especially in multithreaded scenarios.

<Tip>
Review your test suite for dead test constructs or macros sensitive to changes for seamless transition.
</Tip>

---

## 5. Step-By-Step Upgrade Workflow

Follow these actionable steps to upgrade your project tests with minimum friction:

<Steps>
<Step title="Assess Current Environment">
Check your compiler version, build tools, and C++ standard compliance.
</Step>
<Step title="Backup and Branch">
Create a separate branch or backup to isolate work-in-progress during upgrade.
</Step>
<Step title="Update Build Files">
Modify build scripts to enforce C++17 standard and integrate GoogleTest 1.17.0 using CMake's `FetchContent` or your preferred dependency management.
</Step>
<Step title="Compile and Fix Errors">
Compile your tests and resolve any compiler errors related to C++17 or API changes.
</Step>
<Step title="Run Full Test Suite">
Run all tests, paying attention to failures due to API or behavior changes. Refactor tests if necessary.
</Step>
<Step title="Check Death Tests and Multi-threaded Tests">
Validate all death tests and concurrency-related tests run reliably.
</Step>
<Step title="Monitor Warnings and Deprecated Usages">
Fix warnings about deprecated macros or features to future-proof your tests.
</Step>
<Step title="Finalize and Merge">
Once stable, merge back into your mainline branch and update dependencies.
</Step>
</Steps>

---

## 6. Troubleshooting Common Upgrade Issues

### Compilation Fails Due to C++ Standard

- Ensure your compiler supports C++17 fully.
- Verify that the compiler flags are correctly set in all build configurations.

### Linker Errors Related to Runtime Library Mismatch

- For Visual Studio users, consider setting `gtest_force_shared_crt` to ON:

```cmake
-Dgtest_force_shared_crt=ON
```

to align runtimes between GoogleTest and your project.

### Unexpected Test Failures After Upgrade

- Revisit tests that may rely on undefined behavior or deprecated macros.
- Run tests with verbose output to identify failure points.

<Tip>
Always consult the release notes and upgrade-related documentation linked from the official repository for specific issues reported by the community or resolved bugs.
</Tip>

---

## 7. Best Practices Post-Upgrade

- **Adopt Parameterized and Typed Tests:** Enhance scalability and maintainability by using value-parameterized (`TEST_P`) and type-parameterized tests.

- **Use Test Fixtures Prudently:** Share common setup and teardown code with derived fixtures.

- **Leverage Mocking with GoogleMock:** Integrate mocking for dependencies within tests to improve isolation.

- **Review and Refactor Test Names:** Avoid underscores and reserved patterns to prevent linker and runtime errors.

- **Automate Tests in CI Pipelines:** Utilize GoogleTest’s XML output and command-line options to integrate with continuous integration environments.

- **Stay Updated:** Regularly check for new releases and upgrade instructions.

---

## 8. Resources and Further Reading

- [GoogleTest Releases on GitHub](https://github.com/google/googletest/releases)
- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [GoogleTest C++ Standard Policy](https://opensource.google/documentation/policies/cplusplus-support#c_language_standard)
- [Using GoogleTest with CMake](https://google.github.io/googletest/quickstart-cmake.html)
- [Breaking Changes and Migration Notes](https://google.github.io/googletest/changelog/upgrade-guidance/breaking-changes.html)
- [Parameterized Tests Guide](https://google.github.io/googletest/guides/core-workflows/value-and-type-param-tests.html)


<Tip>
Stay engaged with the community via GitHub issues and discussion forums to receive timely assistance and share upgrade experiences.
</Tip>