---
title: "How to Upgrade"
description: "Step-by-step instructions for upgrading GoogleTest, including dependency, platform, and build considerations. Designed to help both newcomers and existing users navigate upgrades with confidence."
---

# How to Upgrade GoogleTest

This guide provides clear, step-by-step instructions for upgrading your GoogleTest installation. It covers essential considerations related to dependencies, platform compatibility, and build configuration to ensure a smooth transition. Whether you’re new to GoogleTest or upgrading an existing setup, this documentation helps you navigate changes confidently and avoid common pitfalls.

---

## 1. Understand the Upgrade Scope

Before starting the upgrade process, familiarize yourself with the following:

- **Version Compatibility:** GoogleTest 1.17.x and later requires a C++17-compatible compiler and standard library.
- **Dependency Changes:** Build and linking requirements, especially around pthreads and runtime libraries, may differ from previous versions.
- **Breaking Changes:** Review any deprecations or changes in mocking syntax or behavior that could impact your existing tests.

Refer to the [Breaking Changes & Deprecations](https://github.com/google/googletest/tree/main/changelog/upgrade-guidance/breaking-changes-deprecations.md) document for a detailed list.


## 2. Update Your Build Environment

To meet GoogleTest's updated requirements and leverage improvements:

- **Ensure C++17 Support:** Confirm your compiler and build system support C++17. In CMake, set this explicitly:

  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```

- **Synchronize Runtime Libraries (Windows):** 

  If you use Visual Studio, verify that your project’s runtime library linkage matches GoogleTest’s. Use the `gtest_force_shared_crt` option to align dynamic runtime linkage:

  ```bash
  cmake .. -Dgtest_force_shared_crt=ON
  ```

  Without this, you may encounter linker errors due to mismatched C runtime linkage.

- **Pthreads Dependency:**

  On POSIX systems, GoogleTest uses pthread for thread safety. Verify your environment supports pthread, or force it explicitly with compiler flags:

  ```bash
  -DGTEST_HAS_PTHREAD=1
  ```

  When using CMake, pthread linking is handled automatically.


## 3. Choose Your Integration Method

GoogleTest can be upgraded and incorporated in your projects via various methods:

### 3.1 Standalone Upgrade

Replace your local GoogleTest source with the latest from the repository, and rebuild using your existing build scripts or CMake as a standalone library:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build
cmake ..
make
sudo make install
```

If you want only GoogleTest (excluding GoogleMock), disable the latter with:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

### 3.2 Integrate with Existing CMake Projects

To avoid compatibility issues, integrate the updated GoogleTest sources directly in your project:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(your_test your_test.cpp)
target_link_libraries(your_test GTest::gtest_main)
add_test(NAME your_test COMMAND your_test)
```

This approach ensures matching compiler and linker flags across your code and the GoogleTest framework.


## 4. Adjust to Mocking and API Changes

- **Check Mock Syntax:** If you use `MOCK_METHODn` macros from older releases, consider migrating to the new `MOCK_METHOD` macro syntax introduced in recent versions.
- **Consider Strictness Modes:** If warnings or failures related to uninteresting mock calls arise, review your use of `NiceMock`, `NaggyMock`, or `StrictMock` wrappers to control mock behavior.
- **Review Expectations and Matchers:** Upgrades might impact how matchers and actions behave; test your mocks thoroughly after upgrading.

Refer to the [Mocking Reference](https://github.com/google/googletest/tree/main/api-reference/mocking-framework/setting-expectations.md) and [gMock Cookbook](https://github.com/google/googletest/tree/main/docs/gmock_cook_book.md) for detailed migration and usage patterns.


## 5. Validate and Test the Upgrade

- After rebuilding and integrating, run your full test suite to verify that all tests execute as expected without regressions.
- Use the `--gmock_verbose` flag to control how much mock call information is printed during test runs. This is helpful for debugging newly surfaced issues:

```bash
./your_test --gmock_verbose=info
```

- If you face linker or runtime errors, refer to the [Troubleshooting Common Setup Issues](https://github.com/google/googletest/tree/main/getting-started/troubleshooting-help/common-issues.md) guide.


## 6. Troubleshooting Common Upgrade Issues

### 6.1 Linker Errors on Windows

- Often caused by mismatched runtime libraries. Ensure `gtest_force_shared_crt` is properly set.
- Verify that all parts of your project and GoogleTest use the same debug/release configurations.

### 6.2 Missing Pthread on Unix-like Systems

- Confirm pthread is installed and available.
- If using custom build scripts, add pthread link flags (`-pthread`).

### 6.3 Unexpected Mock Behavior

- Check for any deprecated `MOCK_METHODn` usage and update to `MOCK_METHOD`.
- Verify your use of `EXPECT_CALL` and `ON_CALL` aligns with the new strictness semantics.


## 7. Best Practices During Upgrade

- **Backup your existing tests and build configurations before changing GoogleTest versions.**
- **Incrementally test and upgrade** — upgrade GoogleTest in isolation before integrating it with other dependencies.
- **Leverage GoogleTest’s CMake facilities** to minimize compatibility risks.
- **Review release notes and breaking changes** to anticipate necessary code modifications.


## 8. Additional Resources

- [GoogleTest User Guide](https://google.github.io/googletest/)
- [Mocking Reference - Defining Mocks & Expectations](https://google.github.io/googletest/reference/mocking.html)
- [Breaking Changes & Deprecations](https://github.com/google/googletest/tree/main/changelog/upgrade-guidance/breaking-changes-deprecations.md)
- [Troubleshooting Common Setup Issues](https://github.com/google/googletest/tree/main/getting-started/troubleshooting-help/common-issues.md)
- [GoogleTest on GitHub](https://github.com/google/googletest)


---

For detailed upgrade paths, migration strategies, and complete changelogs, please consult the GoogleTest release pages and official CHANGELOG documents.


---

<Tip>
Always run your full suite of tests after upgrading GoogleTest to confirm compatibility and catch any silent issues early.
</Tip>

<Check>
Ensure your build environment matches the new requirements for compiler standards and runtime libraries before proceeding with upgrades.
</Check>