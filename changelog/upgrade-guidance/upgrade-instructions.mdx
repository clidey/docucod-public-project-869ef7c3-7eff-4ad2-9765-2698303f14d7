---
title: "Upgrade Instructions & Migration Tips"
description: "Outlines recommended upgrade paths, common migration issues, and configuration changes needed when moving between major releases. Provides actionable steps and best practices for a successful upgrade experience."
---

# Upgrade Instructions & Migration Tips

GoogleTest continually evolves to improve usability, fix bugs, and add features. This page focuses specifically on the essential upgrade paths, common migration challenges, and configuration adjustments you need to be aware of when moving between major releases. By following these recommendations and best practices, your transition will be smooth and your test suites will remain stable and functional.

---

## 1. Preparing for an Upgrade

Before beginning an upgrade, ensure you have:

- **Backed up your existing test code and configurations.** This allows rollback if necessary.
- **Reviewed the release notes and breaking changes pages** to identify incompatibilities.
- **Validated your current test suite** runs successfully and all dependencies are clearly documented.

Taking these preparatory steps minimizes surprises and facilitates a controlled upgrade.

---

## 2. Recommended Upgrade Paths

GoogleTest recommends upgrading sequentially through major releases rather than skipping versions. This approach avoids compounding migration issues.

### Step-by-step Upgrade Flow:

1. **Incremental Version Bumps:** Move from your current version to the next major release (e.g., v1.9 â†’ v1.10).
2. **Run Migration Tests:** Validate your entire test suite with each incremental upgrade.
3. **Apply Deprecation Fixes:** Address any deprecated APIs or behaviors as noted for each version.
4. **Next Major Version:** Proceed to the subsequent major release following the same workflow.

This ensures that any incompatibilities are addressed progressively.

---

## 3. Common Migration Issues

Upgrading GoogleTest can introduce changes that may break existing tests or build configurations. The most frequently encountered issues include:

### 3.1 Mock Method Macro Updates

- **From Old-Style Macros to New `MOCK_METHOD` Macro:**
  - Previous `MOCK_METHODn` macros are still supported but should be replaced with the unified, more expressive `MOCK_METHOD` macro.
  - Make sure to wrap complex argument types with parentheses or aliases to avoid template parsing errors.

Example:
```cpp
// Old-style (not recommended):
MOCK_CONST_METHOD1(foo, bool(int));

// New-style (recommended):
MOCK_METHOD(bool, foo, (int), (const, override));
```

- **Mock Methods Must Be Declared Public:** Regardless of base class accessibility, `MOCK_METHOD` declarations should always be in the `public:` section.

### 3.2 Strictness Wrappers

- Understand how to use `NiceMock`, `NaggyMock` (default), and `StrictMock` to control warnings and failures on uninteresting/mock calls.
- When upgrading, ensure any reliance on these behaviors is updated as some defaults or behaviors may have shifted.

### 3.3 Default Actions (`ON_CALL`) and Expectations (`EXPECT_CALL`)

- The introduction and refinement of default actions may affect tests that rely on implicit default behaviors.
- Explicitly use `ON_CALL` to set default behaviors.
- Avoid overusing `EXPECT_CALL` for non-verifiable calls; instead use `ON_CALL` where verification is unnecessary.

### 3.4 Overloaded and Template Mocking

- Mocking overloaded methods requires explicitly mocking each overload to avoid compilation warnings.
- Template-based mock classes should follow the updated macro usage and test expectations clearly.

### 3.5 C++ Standards and Compiler Requirements

- GoogleTest now mandates C++17 standard compliance and modern compiler versions.
- Confirm your build environment matches the minimum requirements listed in System Requirements.

---

## 4. Configuration Changes

### 4.1 Build System Updates

- Review your Bazel or CMake configurations for any changes in dependency references or library linking.
- Use the latest GoogleTest integration patterns for build platforms as described in [Integrating with Bazel and CMake](/guides/integration-solutions/build-integration).

### 4.2 Command-Line Flags

- Familiarize yourself with the updated flag syntax, especially flags controlling mock behavior verbosity and leak detection:
  - `--gmock_verbose` with options `info`, `warning`, or `error`.
  - `--gmock_catch_leaked_mocks` for runtime detection of leaked mocks.

- Configure these in your testing environments to reduce log noise while preserving essential diagnostics.

### 4.3 Portability and Platform-Specific Changes

- Consult the [Supported Platforms & Integrations](/overview/architecture-features-integration/supported-platforms-integration) to verify any platform-specific considerations.
- Use platform guides for Windows, Linux, and macOS for integration and runtime adjustments.

---

## 5. Best Practices for a Successful Upgrade

- **Run Tests Frequently:** Execute your tests after small migration steps to catch compatibility issues early.

- **Incremental Refactoring:** Apply deprecation fixes progressively rather than all at once.

- **Use Verbose Mock Output:** Increase verbosity during migration to understand unexpected mock failures.

- **Employ Sequences and Expectations Correctly:** Use `InSequence` and proper ordering to maintain test intent.

- **Leverage Community Resources:** GoogleTest's GitHub issues and community discussions often provide solutions to common upgrade questions.

---

## 6. Troubleshooting Common Upgrade Failures

### Symptom 1: Compilation Errors Involving `MOCK_METHOD`
- **Cause:** Improper argument type parsing due to unprotected commas
- **Solution:** Wrap complex argument types in parentheses or typedefs.

### Symptom 2: Unexpected Mock Failures or Warnings about Uninteresting Calls
- **Cause:** Missing or misconfigured `EXPECT_CALL` or `ON_CALL` behaviors.
- **Solution:** Explicitly add expectations or switch to `NiceMock` to suppress warnings where appropriate.

### Symptom 3: Linking Issues After Build System Changes
- **Cause:** Outdated CMake or Bazel file configurations.
- **Solution:** Follow the latest build integration guides and ensure correct dependency references.

### Symptom 4: Test Failures Due to StrictMock Behaviors
- **Cause:** Upgraded strictness in mock call verification.
- **Solution:** Review and adjust mock strictness modes; consider switching from `StrictMock` to `NiceMock` if appropriate.

---

## 7. Additional Resources

- [Breaking Changes and Upgrade Guidance](/changelog/upgrade-guidance/breaking-changes): Detailed info on incompatible changes.
- [Full Version History](/changelog/release-history/full-version-history): Complete log of all releases.
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md): Recipes for advanced mocking patterns.
- [gMock FAQ](https://github.com/google/googletest/blob/main/docs/gmock_faq.md): Troubleshooting common mocking questions.

---

By following this guide, you'll align your test code with GoogleTest's latest capabilities, avoid common pitfalls, and maintain robust, maintainable test suites throughout your upgrade journey.
