---
title: "Migration Tips"
description: "Offers step-by-step guidance and checklists for updating projects between major releases, covering required code changes, C++ standard compatibility, and key configuration updates."
---

# Migration Tips

GoogleTest has evolved significantly over time, requiring users to update their projects when moving between major releases. This page offers you clear, practical guidance to smoothly navigate such migrations, emphasizing code changes, configuration updates, and evolving C++ compatibility requirements.

---

## 1. Overview of Migration Needs

When upgrading GoogleTest to a new major version, keep in mind:

- **Required C++ Standards**: Newer versions often require more recent C++ language standards (for example, C++17 compatibility starting with version 1.17.0).
- **Macro and API Updates**: Legacy macros may be deprecated in favor of modern alternatives.
- **Configuration Changes**: Adjust your build files and flags as necessary to align with new expectations.
- **Deprecation Awareness**: Some APIs or behaviors may be removed entirely or replaced.

Understanding these points upfront will prevent integration issues and enable you to leverage the latest framework improvements.

## 2. Step-by-Step Migration Guidance

To efficiently update your projects, follow this recommended workflow:

### Step 1: Upgrade Your Compiler and Build Environment

- Ensure your C++ compiler supports the minimum required C++ standard:
  - For versions >= 1.17.0, your project must compile with at least **C++17**.
- Update your build tools (CMake, Bazel, etc.) to correctly specify this standard.

### Step 2: Replace Deprecated Macros and APIs

- Switch from older mocking macros to the new `MOCK_METHOD` macro for mock definitions.
- Review your use of test suite and test case naming, avoiding underscores (`_`) in test and suite names as recommended in the [FAQ](../faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore).
- Update or remove use of deprecated behaviors especially related to mock strictness modes and expectations.

### Step 3: Adjust Configuration and Initialization

- Inspect your test runner initialization code.
- Confirm that the usage of `::testing::InitGoogleTest()` correctly matches new expectations.
- Update any command-line flags or environment variables in your test environment as described in [Test Runner Configuration](../api-reference/core-testing-api/test-runner-configuration.md).

### Step 4: Validate Tests and Mock Behavior

- Run your entire test suite with enhanced verbosity or under the `--gmock_verbose=info` flag to identify mismatches or uninteresting calls.
- Transition mock classes to use recommended patterns for expectations (`EXPECT_CALL`) and default behaviors (`ON_CALL`) as detailed in [Setup Expectations and Actions](../guides/mocking-and-advanced-scenarios/setup-expectations-actions.md).

### Step 5: Update and Restructure Test Fixtures as Needed

- If your project uses derived test fixtures, check for compatibility with changes in lifecycle behavior outlined in the [Test Macros and Fixtures API Reference](../api-reference/core-testing-api/test-macros-fixtures.md).

## 3. Key Topics in Migration

| Area                         | Considerations                                             |
|------------------------------|------------------------------------------------------------|
| C++ Standard Version          | Move to C++17 if your current compiler is older.           |
| Mock Macros                  | Use `MOCK_METHOD` uniformly, ditch old macros like `MOCK_METHODn`.
| Test Suite Naming             | Avoid underscores per GoogleTest naming constraints.        |
| Strictness and Mock Behavior  | Understand new strictness wrappers: `NiceMock`, `StrictMock`, and their impact.
| Initialization and Flags      | Verify flags, including death test styles and verbosity.    |

## 4. Practical Example: Updating a Mock Class

Here's how to modernize a mock class using the recommended `MOCK_METHOD` macro:

```cpp
#include <gmock/gmock.h>

class Foo {
 public:
  virtual ~Foo() {}
  virtual int Bar(int x) = 0;
  virtual void Baz() const = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, Bar, (int x), (override));
  MOCK_METHOD(void, Baz, (), (const, override));
};
```

Tips:
- Never use the older `MOCK_METHODn` macros.
- Specify `const` and `override` explicitly.
- Define destructors as virtual in base classes and ensure mocks match.

## 5. C++ Standard Migration Reminder

GoogleTest 1.17.0 and later require C++17 support. This means:

- **Compiler support:** Use GCC 7+, Clang 5+, MSVC 2017 Update 3+, or newer.
- **Build system:** Ensure your build scripts specify `-std=c++17` or equivalent flags.

If not using compatible compilers, you will encounter build errors and missing features.

## 6. Checklist for a Smooth Migration

- [ ] Confirm your compiler version supports C++17.
- [ ] Update build configuration files to use C++17.
- [ ] Replace deprecated mock macros with `MOCK_METHOD`.
- [ ] Audit test names to remove unsupported underscore usage.
- [ ] Revise `EXPECT_CALL` and `ON_CALL` usage following best practices.
- [ ] Update initialization and test runner command flags.
- [ ] Test all suites fully with verbose logging to spot issues early.

## 7. Troubleshooting Common Migration Issues

### Problem: Tests fail due to naming rules

- **Cause:** Test suite or test names containing underscores `_`.
- **Solution:** Rename suites/tests to avoid leading, trailing, or consecutive underscores.

### Problem: Mock methods don't override correctly

- **Cause:** Using outdated mocking macros or missing override qualifiers.
- **Solution:** Update all mocks to use `MOCK_METHOD(return_type, method_name, (args), (qualifiers))`.

### Problem: Compiler errors due to outdated C++ standard

- **Cause:** Compiler toolchain version does not support C++17.
- **Solution:** Upgrade compiler or configure build scripts for required standard.

## 8. Additional Resources

- [GoogleTest FAQ](../faq.md) — For naming conventions, assertion usage, and compiler errors.
- [Mocking and Advanced Scenarios](../guides/mocking-and-advanced-scenarios) — Deep dive into mocks usage and expectations.
- [Test Runner Configuration](../api-reference/core-testing-api/test-runner-configuration.md) — Adjust test execution setup.
- [Recent Releases](../changelog/release-history-highlights/recent-releases.md) — Follow latest release notes on new requirements.

---

By following this migration checklist and guidance, you will preserve the integrity of your tests and make the most of GoogleTest's latest capabilities.

---

_Generated from the GoogleTest documentation and FAQs._

<Source url="https://github.com/google/googletest" paths={[{"path": "docs/migration-and-upgrade-guides/migration-tips.md", "range": "FULL"}]} />