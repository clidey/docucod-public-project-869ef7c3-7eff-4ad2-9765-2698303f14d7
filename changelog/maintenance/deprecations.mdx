---
title: "Deprecations and End-of-Life Notices"
description: "Tracks features or APIs that are slated for deprecation or have reached end of support. Offers actionable advice on migrating away from deprecated patterns before they are removed in future releases."
---

# Deprecations and End-of-Life Notices

This page tracks features, APIs, and practices within GoogleTest and GoogleMock that are slated for deprecation or have reached their end of support. It provides actionable guidance to help users migrate away from deprecated functionality, ensuring smooth upgrade paths and maintaining test code health before these features are removed in future releases.

---

## 1. Overview of Deprecation Policy

GoogleTest and GoogleMock maintain a clear and predictable deprecation policy to minimize disruption for users. Deprecations are announced well in advance, with detailed migration instructions and recommended alternatives. Users are encouraged to regularly consult this document to stay ahead of changes.

- **Advance Notices:** Deprecations are indicated in documentation and release notes.
- **Migration Support:** Guides and examples assist in moving away from deprecated features.
- **Removal Timeline:** Deprecated features are maintained for at least one major release cycle before removal.

---

## 2. Deprecated APIs and Features

### 2.1. Old-Style `MOCK_METHODn` Macros

The legacy macros named `MOCK_METHODn`, `MOCK_CONST_METHODn`, and their variants remain supported for backward compatibility. However, migration to the modern, more flexible, and type-safe `MOCK_METHOD` macro is strongly recommended.

**Status:** Deprecated but supported.

**Migration:** Replace instances of `MOCK_METHODn` macros with the generic `MOCK_METHOD` syntax.

```cpp
// Old style
MOCK_METHOD1(Foo, bool(int));

// New style preferred
MOCK_METHOD(bool, Foo, (int));
```

Refer to the [gMock Cookbook](gmock_cook_book.md#Old-Style-`MOCK_METHODn`-Macros) for a detailed migration guide.

---

### 2.2. `NaggyMock` Usage

`NaggyMock` was previously the default mock strictness level, warning on uninteresting calls. The current recommendation is to prefer `NiceMock` to suppress such warnings and improve test maintainability.

**Status:** Deprecated as best practice; still supported.

**Recommendation:** Transition to using `NiceMock<T>` for mocks where you want to suppress uninteresting call warnings.

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> mock_foo;
EXPECT_CALL(mock_foo, DoThis());
```

For details, see [Nice, Naggy, and Strict Mocks](api-reference/mocking-api/nice-naggy-strict-mocks.md).

---

### 2.3. `MOCK_METHOD` in Non-Public Sections

Placing `MOCK_METHOD` macros in `protected` or `private` sections is unsupported and can lead to unexpected behavior. The recommended practice is to always declare `MOCK_METHOD` in the `public:` section of the mock class, regardless of the original method's access level.

**Status:** Deprecated and discouraged.

**Migration:** Move all `MOCK_METHOD` macros to `public:` sections.

```cpp
class MockFoo : public Foo {
public:
  MOCK_METHOD(bool, Transform, (Gadget* g), (override));
  MOCK_METHOD(void, Resume, (), (override));
};
```

See the [Creating Mock Classes](gmock_cook_book.md#Creating-Mock-Classes) section for full guidance.

---

### 2.4. Mocking Free Functions

Direct mocking of free (non-member) functions is not supported. Instead, your design should abstract free functions behind interfaces. This pattern remains the recommended technique to enable mocking.

**Status:** Deprecated to attempt mocking free functions directly.

**Migration:** Refactor to interface-based design and mock the interface.

```cpp
class FileInterface {
 public:
  virtual bool Open(const char* path, const char* mode) = 0;
};

class File : public FileInterface {
 public:
  bool Open(const char* path, const char* mode) override {
    return OpenFile(path, mode);
  }
};
```

Refer to [gMock Cookbook - Mocking Free Functions](gmock_cook_book.md#Mocking-Free-Functions) for a comprehensive explanation.

---

## 3. Deprecated Practices and Patterns

### 3.1. Using `const` on By-Value Parameters in `MOCK_METHOD`

Specifying top-level `const` for by-value parameters in `MOCK_METHOD` declarations can cause compiler warnings or errors, especially with certain MSVC versions. This is because top-level `const` on parameters passed by value is ignored by C++ and can confuse some compilers.

**Status:** Deprecated practice.

**Migration:** Remove `const` qualifiers on by-value parameters in mock method signatures.

Example:

```cpp
// Instead of this:
MOCK_METHOD(void, Func, (const int x), (override));  // May warn on MSVC

// Use this:
MOCK_METHOD(void, Func, (int x), (override));
```

Detailed explanation is in the [Legacy gMock FAQ](gmock_faq.md#MSVC-gives-me-warning-C4301-or-C4373-when-I-define-a-mock-method-with-a-const-parameter.-Why).

---

### 3.2. Mocking Non-Virtual Methods Via Inheritance

Directly making non-virtual methods `virtual` solely for mocking purposes is discouraged, as this weakens class invariants and couples the code tightly to the tests.

**Status:** Deprecated as a design choice.

**Recommendation:** Use interfaces or mock non-virtual methods separately with high-perf dependency injection patterns.

For alternatives, see the recipe on [Mocking Non-virtual Methods](gmock_cook_book.md#Mocking-Non-virtual-Methods).

---

### 3.3. Default Old-Style Actions Without `ON_CALL`

Relying on the default action behavior for mock methods without explicitly specifying default behavior via `ON_CALL` can cause uninteresting call warnings.

**Status:** Discouraged practice.

**Recommendation:** Set suitable default actions explicitly in test fixtures or mock constructors using `ON_CALL`. For example:

```cpp
ON_CALL(mock_obj, Method(_)).WillByDefault(Return(default_value));
```

See [Setting Expectations](api-reference/mocking-api/setting-expectations.md#UseOnCall) for best practices.

---

## 4. Planned Removals and Upcoming Breaking Changes

### 4.1. Removal of `MOCK_METHODn` Macros

Future major releases will remove the legacy `MOCK_METHODn` macro family. Users should complete migration to the single `MOCK_METHOD` macro now to avoid build breaks.

### 4.2. Strict Enforcement of `MOCK_METHOD` Public Section Declaration

Future releases will enforce that all `MOCK_METHOD` macros must appear in the public section of mock classes to ensure proper external access.

### 4.3. Discontinuation of `NaggyMock` as Default

`NaggyMock` usage will be phased out in favor of `NiceMock` and `StrictMock` for clarity in expectation handling.

### 4.4. Removal of Deprecated Matchers

Occasionally, rarely used or superseded matchers may be removed in future releases. Users should refer to the Matchers Reference for current supported matchers and migrate accordingly.

---

## 5. Migration Support and Best Practices

- **Audit Your Code:** Regularly check for deprecated macro uses like `MOCK_METHODn` or discouraged mock class designs.
- **Use Public `MOCK_METHOD`s:** Always declare mock methods publicly regardless of base access levels.
- **Switch to `NiceMock`:** Suppress uninteresting call warnings by adopting `NiceMock` instead of the older `NaggyMock`.
- **Specify Default Actions:** Use `ON_CALL` in your test fixtures to declare default mock behaviors explicitly.
- **Avoid Mocking Free Functions:** Move free functions behind abstract interfaces for easy mockability.

For detailed migration recipes, consult the [gMock Cookbook](gmock_cook_book.md), [Mocking Reference](reference/mocking.md), and [Legacy gMock FAQ](gmock_faq.md).

---

## 6. Troubleshooting Deprecated Usage

If you encounter warnings or errors related to deprecated features:

1. **Review your `MOCK_METHOD` macros:** Ensure none are old-style `MOCK_METHODn` variants.
2. **Check Access Specifiers:** Confirm all `MOCK_METHOD` macros are in `public` sections.
3. **Examine Mock Strictness Wrappers:** Prefer `NiceMock` or `StrictMock` over `NaggyMock`.
4. **Refactor Free Function Mocks:** Use interface patterns instead of trying to mock free functions.

---

## 7. Additional Information

- Deprecations align with GoogleTest's mission to provide robust, maintainable, and modern C++ testing support.
- GoogleTest follows semantic versioning; pay attention to major version changes for deprecation enforcement.
- Stay updated with release notes and the [GoogleTest Changelog](changelog/release-history/version-timeline.md).

---

## 8. References

- [gMock Cookbook](gmock_cook_book.md)
- [Legacy gMock FAQ](gmock_faq.md)
- [Mocking Reference](reference/mocking.md)
- [Nice, Naggy, and Strict Mocks](api-reference/mocking-api/nice-naggy-strict-mocks.md)
- [Setting Expectations](api-reference/mocking-api/setting-expectations.md)
- [Matchers Reference](api-reference/assertions-and-matchers/builtin-matchers.md)
- [Changelog: Version Timeline](changelog/release-history/version-timeline.md)

---

**Note:** Always backup your test code before performing bulk migrations. Automated tools or IDE refactoring features can help safely update your mock usage patterns.
