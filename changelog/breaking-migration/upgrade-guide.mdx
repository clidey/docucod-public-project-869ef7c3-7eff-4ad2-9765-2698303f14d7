---
title: "Upgrade Guide"
description: "Step-by-step guidance for migrating across major and minor versions, including tips for handling C++ standard upgrades and integrating with external dependencies like Abseil. Ensures users have a clear path to successful upgrades."
---

# Upgrade Guide

This Upgrade Guide provides comprehensive, step-by-step instructions to help users migrate smoothly across GoogleTest major and minor versions. It covers crucial considerations such as adopting newer C++ standards, integrating external dependencies like Abseil, adapting to API changes, and leveraging new features effectively.

---

## 1. Preparing for Upgrade

### 1.1 Review Release Notes and Breaking Changes
Before upgrading, thoroughly review the [Release Notes](https://github.com/google/googletest/releases) and the breaking changes documentation. Pay close attention to API deprecations, removals, and modifications to ensure your tests and mocks remain compatible.

### 1.2 Verify C++ Standard Compatibility
Starting from version 1.17.0, GoogleTest requires at least **C++17** standard support. Confirm your build environment and tooling support C++17 or later. Adjust your compiler flags accordingly (e.g., `-std=c++17` for GCC and Clang).

<Tip>
Upgrading the C++ standard can enhance compatibility and unlock modern language features. However, verify that the rest of your codebase and dependencies support this standard to avoid build issues.
</Tip>

### 1.3 Update External Dependencies
GoogleTest plans to depend on [Abseil (absl)](https://github.com/abseil/abseil-cpp). If your project uses Abseil, prepare to integrate the new dependency by fetching the compatible Abseil version and updating your build scripts.

<Note>
Dependency updates may affect linkage and runtime behavior. Test thoroughly to confirm no regressions occur.
</Note>

---

## 2. Migration Steps

### 2.1 Upgrade Build Configuration

- **CMake:** Ensure your `CMakeLists.txt` sets the minimum C++ standard to 17 or above:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- **Other Build Systems:** Adjust compiler options similarly to enable C++17.

- **Dependencies:** Update any package references to GoogleTest 1.17.x or later.

### 2.2 Adjust Test and Mock Code

- Replace any deprecated macros, methods, or behaviors following the breaking changes.

- For mock classes, verify that `MOCK_METHOD` macros conform to the updated API. Use the newer, typed `MOCK_METHOD` syntax if migrating from outdated macro forms.

- Update test fixtures and parameterized tests to align with new requirements or improvements.

### 2.3 Validate C++17 Requirements

- Remove any conflicting compiler flags that might disable C++17.

- Check for usage of deprecated or removed features that may conflict with C++17.

---

## 3. Leveraging New Features

### 3.1 Unified GoogleTest and GoogleMock
The library now merges GoogleTest and GoogleMock projects for tighter integration. Use the combined framework to write tests and mocks seamlessly.

### 3.2 Richer Assertion and Matcher Support
Explore enhanced assertions, including predicate and parameterized matchers, through updated APIs in `gtest/gtest.h` and `gmock/gmock.h`.

### 3.3 Improved Mocking APIs
Utilize refined mocking constructs such as `NiceMock`, `StrictMock`, and `NaggyMock` to control mock behavior regarding uninteresting and unexpected calls for more precise test outcomes.

### 3.4 Enhanced Test Lifecycle Controls
Use advanced test lifecycle methods (`SetUpTestSuite()`, `TearDownTestSuite()`), value and type-parameterized tests (`TEST_P`, `TYPED_TEST_SUITE`), and improved event listeners to build more maintainable tests.

---

## 4. Troubleshooting Common Issues

### 4.1 Compiler Errors Related to C++17
If you receive errors regarding language features or standard compatibility, double-check your compiler version and C++ standard flags. GoogleTest 1.17.x requires compilers supporting C++17:

- GCC 7+
- Clang 3.4.1+
- MSVC 2017 Update 3+

### 4.2 Linking Problems
Ensure your build links against the updated GoogleTest and GoogleMock libraries. If migrating to shared libraries, update `CMakeLists.txt` or linker settings accordingly.

### 4.3 Mock Macro Complaints
If legacy mocking macros (`MOCK_METHODn`) cause errors, migrate to the generic `MOCK_METHOD` macro with the updated signature format.

### 4.4 Handling Dependency Conflicts
When adopting Abseil, manage version conflicts carefully between GoogleTest and your project dependencies.

---

## 5. Best Practices for Smooth Migration

- **Incremental Migration:** Upgrade one project module at a time and run tests frequently to isolate issues.

- **Use Continuous Integration:** Automate tests to catch regressions early on after the upgrade.

- **Consult Updated Guides:** Refer to the latest GoogleTest Primer and Mocking Cookbook for updated usage patterns.

- **Keep Backups:** Maintain working versions of your code to allow fallback if needed.


tip
Take advantage of enhanced `ON_CALL` and `EXPECT_CALL` features to improve test clarity and resilience to implementation detail changes.
endtip

---

## 6. Resources

- [GoogleTest Releases](https://github.com/google/googletest/releases)
- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [Testing Reference](https://google.github.io/googletest/reference/testing.html)
- [System Requirements](https://github.com/google/googletest/blob/main/getting-started/prerequisites-installation/system-requirements.md)

---

## 7. Summary

Upgrading to GoogleTest 1.17.x and later is a strategic move to harness modern C++17 features, unified mocking and testing frameworks, enhanced macros, and external dependency integration (like Abseil). This guide supports a smooth transition with practical steps, key considerations, and troubleshooting advice. Following best practices and leveraging official resources will ensure a successful upgrade and evolve your projectâ€™s testing capabilities.


---

## Appendix: Sample Upgrade Commands for CMake

```sh
# Configure with C++17 standard
cmake -DCMAKE_CXX_STANDARD=17 ..

# Build GoogleTest
cmake --build . --target all

# Run tests
ctest --output-on-failure
```

---

## Appendix: Handling Expected Breaking Changes

### Name Restrictions
Test suite and test names must not contain underscores (`_`). Rename accordingly.

### Fixture Usage
Avoid deprecated fixture patterns. Use `SetUpTestSuite()` and `TearDownTestSuite()` instead of legacy `SetUpTestCase()`.

### Return Type and Mocking
Update mock method syntax, especially for methods returning move-only types or references. Use `MOCK_METHOD` with proper qualifiers.

---

## Appendix: Example Migration of a Mock Class

**Before:**
```cpp
class MockFoo {
 public:
  MOCK_CONST_METHOD1(Foo, bool(int));
  MOCK_METHOD1(Bar, void(double));
};
```

**After:**
```cpp
class MockFoo {
 public:
  MOCK_METHOD(bool, Foo, (int), (const));
  MOCK_METHOD(void, Bar, (double));
};
```

This modernizes your mock declarations to align with the updated GoogleMock macros.

---

## Conclusion

This guide equips users with the essential knowledge to confidently upgrade GoogleTest and GoogleMock, adapt to evolving C++ standards, and integrate new capabilities. By following these recommendations, you will maintain robust tests with minimal disruptions.