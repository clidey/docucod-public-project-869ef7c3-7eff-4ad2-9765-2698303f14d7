---
title: "Breaking Changes"
description: "Review a curated list of breaking changes that may impact existing projects, including language standard requirements, removed APIs, and significant behavioral modifications. Each entry offers upgrade guidance and practical migration tips."
---

# Breaking Changes

Welcome to the Breaking Changes documentation page. Here you will find a carefully curated list of significant changes within GoogleMock that may impact your existing projects. This page highlights alterations to language standards, removed APIs, and major behavioral modifications that require your attention when upgrading.

Our goal is to empower you with clear upgrade guidance and practical migration tips, so you can smoothly adapt your tests and mocks to the newest versions.

---

## Understanding Breaking Changes

Breaking changes are modifications that may cause your existing test code or mocks to fail to compile or behave differently if not updated accordingly. We provide detailed descriptions of each breaking change below, along with actionable steps to help you successfully migrate your code.

---

## Key Categories of Breaking Changes

### 1. Language Standard Requirements

Starting from version 1.17.x, GoogleTest and GoogleMock require a minimum of C++17 support. This means:

- Ensure your compiler and build system are configured to use at least the C++17 standard.
- Code that relies on earlier standards might fail to compile or produce unexpected behaviors.

**Migration Tip:** Update your build flags (e.g., `-std=c++17` for GCC/Clang or `/std:c++17` for MSVC). Confirm your environment supports C++17 before upgrading.

---

### 2. Removal of Legacy `MOCK_METHODn` Macros

The older `MOCK_METHODn` and `MOCK_CONST_METHODn` macros have been deprecated and removed in favor of the new unified `MOCK_METHOD` macro syntax.

**Impact:**

- Existing mock classes using `MOCK_METHODn` will no longer compile.

**Action Steps:**

- Replace:

  ```cpp
  MOCK_METHOD1(Foo, bool(int));
  MOCK_CONST_METHOD1(Bar, int(const std::string&));
  ```

  with:

  ```cpp
  MOCK_METHOD(bool, Foo, (int));
  MOCK_METHOD(int, Bar, (const std::string&), (const));
  ```

- For functions with complex argument types containing commas, wrap the argument types with extra parentheses or use type aliases to keep the macro syntax valid.

For example:

```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
// or
using BoolIntPair = std::pair<bool, int>;
MOCK_METHOD(BoolIntPair, GetPair, ());
```

---

### 3. Changes in Mock Method Qualifiers

Some methods that were previously mocked with certain qualifiers now require explicit specification.

For example:

- If you override a const method, you must specify `(const, override)` as the last argument to `MOCK_METHOD`.

- Similarly, for `noexcept` or other qualifiers like `Calltype(...)`, use the fourth parameter to declare them.

**Example:**

```cpp
MOCK_METHOD(int, GetValue, (), (const, noexcept, override));
```

**Migration Tip:** Review your mock class declarations for such qualifier usage and update accordingly.

---

### 4. Default Behavior and Warning Policies

By default, calls to mock methods without explicit `EXPECT_CALL`s generate warnings. To adjust this behavior:

- Use `NiceMock<T>` to suppress warnings on uninteresting calls.
- Use `StrictMock<T>` to treat uninteresting calls as errors.

**Note:**

In version 1.17.x and later, the default mock behavior aligns with `NaggyMock`, which issues warnings.

**Tips:**

- Prefer using `ON_CALL()` to define default behaviors without setting strict expectations.
- Use `EXPECT_CALL()` with `.Times(AnyNumber())` for excluding warnings on specific methods.

---

### 5. Enhanced Support for Move-Only Types

GoogleMock now fully supports mocking methods that accept or return move-only types such as `std::unique_ptr`. This change may affect existing mocking strategies.

**Migration Advice:**

- Use the standard `MOCK_METHOD` macro for such methods.
- When returning move-only types, use lambdas or callable objects in `.WillOnce()` or `.WillRepeatedly()` to generate fresh instances each call.

For example:

```cpp
EXPECT_CALL(mock, MakeBuzz(_))
    .WillRepeatedly([](StringPiece text) {
      return std::make_unique<Buzz>(AccessLevel::kInternal);
    });
```

---

## Practical Migration Recommendations

- Update your project to compile with C++17 or newer.
- Replace all deprecated `MOCK_METHODn` macro usages with the modern `MOCK_METHOD` syntax.
- Review mocked method qualifiers and specify `const`, `override`, `noexcept`, and `Calltype(...)` correctly.
- Adjust your test mocks with `NiceMock` or `StrictMock` to handle uninteresting calls as desired.
- Refactor mocks involving move-only types to use lambdas or appropriate callable actions.
- Verify expectations precede any code execution that calls mocks to avoid undefined behavior.

---

## Common Pitfalls and Troubleshooting

- **Missing C++17 support:** Tests may fail to compile; verify compiler flags.
- **Incorrect macro syntax:** Commas in argument or return types can cause compilation errors; wrap these types in parentheses or use type aliases.
- **Unspecified qualifiers:** Mock methods must specify qualifiers (`const`, `override`) matching the base class.
- **Unexpected warnings or errors on uninteresting calls:** Use `NiceMock` or add catch-all `EXPECT_CALL`s.

---

## Additional Resources

For comprehensive guidance on using mocks, setting expectations, and leveraging GoogleMock effectively, please refer to:

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html): Recipes and best practices for using mocks.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html): Detailed API references for mocks and expectations.
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html): Introduction and beginner-friendly tutorial.
- [Matchers Reference](https://google.github.io/googletest/reference/matchers.html): Built-in matchers for flexible argument matching.
- [GoogleTest Primer](https://google.github.io/googletest/primer.html): Introduction to basic usage.

---

By carefully following the recommendations above, your migration to the latest GoogleMock versions will be smooth and your tests remain robust and maintainable.

If you encounter any issues, please consult the [Common Troubleshooting page](../getting-started/troubleshooting-support/common-troubleshooting), or reach out through community forums and issue trackers.

Happy Testing!

---