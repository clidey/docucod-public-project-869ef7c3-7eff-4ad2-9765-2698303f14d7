---
title: "Bug Fixes & Patches"
description: "Describes bugs resolved and minor patches applied per release as documented by maintainers, helping users understand improvements to test stability, correctness, and platform support."
---

# Bug Fixes & Patches

This page outlines the bug fixes and minor patches implemented in GoogleMock across various releases. These updates aim to improve stability, correctness, and platform support, ensuring a smoother and more reliable mocking experience for users.

---

## Recent Bug Fixes

### Fixes in Mock Method Parsing and Usage

- **Correct Parsing of Commas in `MOCK_METHOD` Arguments**: Resolved an issue where unprotected commas within template argument lists caused parsing failures. Users can now safely mock methods with types such as `std::pair<bool, int>` or `std::map<int, double>` by either wrapping argument types in parentheses or using type aliases without compilation errors.

- **Proper Placement of `MOCK_METHOD` Declarations**: Enforced the requirement that all `MOCK_METHOD` macros must reside in the `public:` section of mock classes, regardless of the original method’s access level (`public`, `protected`, or `private`). This fix allows `ON_CALL` and `EXPECT_CALL` to properly access mocked methods.

### Improved Expectation Enforcement

- **Sticky Expectations Clarification and Retiring Behavior**: Fixed scenarios where expectations would incorrectly remain active after being saturated. Introduced or reinforced the use of `.RetiresOnSaturation()` to retire expectations once their cardinality limits are reached, preventing false positive failures on excessive calls.

- **Sequence and Ordering Constraints Stability**: Addressed issues with partial ordering (`InSequence`) and prerequisite constraints (`After`). Expectations now reliably enforce call order without unexpected failures or silent mismatches.

- **Handling of Uninteresting and Unexpected Calls**: Enhanced messages and internal checks to differentiate uninteresting calls (calls with no `EXPECT_CALL`) and unexpected calls (calls not matching active expectations). Fixed false warnings and clarified interactions with `NiceMock` and `StrictMock` wrappers.

### Actions and Matchers

- **Default Action Behavior Adjustments**: Corrected cases where mock methods without specified `WillOnce` or `WillRepeatedly` actions incorrectly returned non-default values or triggered warnings. Now, methods return either default-constructed values or user-supplied defaults (`ON_CALL` / `DefaultValue<T>::Set()`), making mocks more predictable.

- **Support for Move-only Types in Mock Methods**: Improved support for methods accepting or returning move-only types such as `std::unique_ptr`. This fix ensures that lambdas and callables can be used effectively with such mocks without unexpected run-time errors.

- **Action Chaining with `DoAll` and `SetArgPointee`**: Patched bugs where combining multiple actions could lead to incorrect return values or side effects. Users can now safely chain actions to set output arguments and return values in a single expectation.

### Cross-platform and Compilation Fixes

- **MSVC and Clang Compiler Compatibility Improvements**: Fixed compiler warnings and errors related to const parameter qualifications, use of macros with `Calltype`, and template parsing. These adjustments improve build reliability on Windows and other major platforms.

- **Build and Linkage Stability**: Enhanced CMake scripts and build configurations to reduce issues with static/shared library compilation, threading flags, and exception handling that could cause build failures or runtime crashes.

- **Emacs Integration**: Resolved issues with error highlighting and test navigation keys related to gMock macro expansions for a smoother developer experience in Emacs.

---

## Troubleshooting Common Symptoms

- Warnings about "Uninteresting function call" even when using `ON_CALL`. Users should consider adding catch-all `EXPECT_CALL(...).Times(AnyNumber())` or switch to `NiceMock` to suppress unnecessary noise.

- Unexpected call failures due to over-constraining expectations now provide improved diagnostics including stack traces when run with `--gmock_verbose=info`.

- Compilation failures caused by mocking overloaded or const-qualified functions corrected by updated `MOCK_METHOD` macro handling and guidance in the documentation.

---

## Best Practices To Avoid Bug-Related Issues

- Always specify `EXPECT_CALL` expectations **before** exercising mock objects, to prevent undefined behavior and spurious failures.

- Use `.RetiresOnSaturation()` or sequences to prevent expectations from remaining active past their intended call count.

- Wrap argument types containing commas in parentheses or define type aliases to prevent macro parsing errors with `MOCK_METHOD`.

- For methods with move-only arguments or return types, prefer lambdas or functors in `WillOnce()` and `WillRepeatedly()` clauses.

- Manage verbosity and warnings via the `--gmock_verbose` flag to control output during test runs.

---

## References

- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — Detailed mock facilities
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes and best practices
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — Beginner-friendly introduction
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) — Troubleshooting common issues

---

GoogleMock remains under active maintenance to deliver reliable, efficient mocking support suitable for modern C++ testing workflows. Users encountering subtle bugs or build issues should consult this changelog and the referenced guides to understand resolved issues and recommended coding patterns for robust test design.
