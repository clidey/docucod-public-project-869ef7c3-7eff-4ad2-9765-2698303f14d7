---
title: "Upgrading Between Versions"
description: "Step-by-step guidance for upgrading your test suite across major and minor releases. Includes checklists, migration tips, and advice for handling compatibility issues."
---

# Upgrading Between Versions

This page provides clear, step-by-step guidance for smoothly upgrading your test suite using GoogleTest and GoogleMock across major and minor releases. It covers practical checklists, migration tips, and advice to handle compatibility issues effectively, ensuring your tests continue to run reliably after an upgrade.

---

## Why Upgrade? Understanding the Value

Software testing frameworks evolve to fix issues, improve performance, and add features. Upgrading to newer versions of GoogleTest and GoogleMock means benefiting from improved diagnostics, more powerful mocking capabilities, better integration, and increased maintainability of your test suite.

However, changes between versions may also introduce compatibility considerations. This guide helps you plan the transition to avoid disruptions.

---

## Upgrade Workflow

Successful upgrades happen in stages. We recommend the following workflow to achieve a seamless transition:

### 1. Review the Release Notes

- Check the detailed changelog for the versions between your current and target upgrade.
- Pay special attention to breaking changes, deprecated features, and behavioral differences.

### 2. Prepare Your Environment

- Verify your build environment meets the prerequisites (see [System Requirements](overview/integration-and-ecosystem/platforms-environments.md)).
- Ensure your compiler supports the required C++ standard (C++17 or later).

### 3. Update GoogleTest and GoogleMock Libraries

- Follow official installation or integration guides for your build system ([Setup and Configuration](guides/getting-started/setup-and-configuration.md)).
- Update include paths and linkage as needed.

### 4. Analyze and Migrate Your Tests

- Use provided checklists and migration tips below to identify necessary code changes.
- Adjust your mock definitions, expectations, and usages according to updated APIs.

### 5. Verify Test Execution

- Run your full test suite.
- Utilize increased verbosity flags (`--gmock_verbose=info`) to troubleshoot failing or unexpected behaviors.

### 6. Iterate and Refine

- Address any failures or warnings.
- Consult additional troubleshooting guidance as needed.

---

## Upgrade Checklists

### Checklist for Minor Releases (Backward Compatible Changes)

- [ ] Confirm that your current compiler and environment meet the updated requirements.
- [ ] Pull the latest source or binaries for GoogleTest and GoogleMock.
- [ ] Rebuild your test suite against the new version.
- [ ] Run tests at default verbosity; verify all pass.
- [ ] Optionally, enable verbose logging with `--gmock_verbose=info` to catch hidden warnings.

These releases typically add new features and improvements without breaking existing tests.

### Checklist for Major Releases (Potential Breaking Changes)

- [ ] Perform all steps for minor releases.
- [ ] Review [Breaking Changes & Deprecations](changelog/detailed-changelog/breaking-changes.md) in detail.
- [ ] Update mock class definitions if method signatures or macro usages have changed.
- [ ] Examine usage of `EXPECT_CALL`, `ON_CALL`, and verify compliance with new cardinality or ordering rules.
- [ ] Replace deprecated flags or options with recommended alternatives.
- [ ] Adjust for changes in default behaviors (e.g., default mock object behavior or verbosity).
- [ ] Run test suites with increased verbosity for detailed diagnostics.
- [ ] If tests fail or warnings appear, consult [Debugging and Troubleshooting Test Failures](guides/best-practices-integration/debugging-and-troubleshooting.md).

---

## Migration Tips and Common Compatibility Issues

### Mock Method Changes

- Ensure all `MOCK_METHOD` macros conform to the latest syntax.
  - Use the new unified `MOCK_METHOD(return_type, method_name, (args), (specifiers));` macro.
  - Wrap template arguments or types with commas in parentheses or use type aliases.
- Confirm all overridden virtual methods have proper `override` and `const` qualifiers.

### Expectation Ordering and Cardinality

- Verify ordering constraints are still valid; reorder expectations or use `InSequence` and `After` clauses as needed.
- For chained `WillOnce` / `WillRepeatedly` calls, ensure cardinality matches expected call counts.
- Use `.RetiresOnSaturation()` on expectations intended to be non-sticky.

### Default Actions and Behaviors

- Verify that `ON_CALL` default behaviors are explicitly set where necessary.
- Remember that uninteresting calls produce warnings by default; to suppress, use `NiceMock`.
- Adjust the `--gmock_verbose` flag to `info` or `warning` during debugging.

### Compiler Compatibility

- Confirm your compiler supports required C++17 features and behaves according to system requirements.
- Note that Microsoft Visual C++ users may need to address warnings about const parameters.

---

## Troubleshooting Upgrade Issues

### Tests Failing With Unclear Errors

- Run tests with `--gmock_verbose=info` to get detailed function call traces.
- Check the logs for mismatches on argument expectations, ordering violations, or unmet cardinalities.
- Review customized matchers or actions for correct behavior with new gMock versions.

### Unexpected Warnings About Uninteresting Calls

- Determine if these calls should be expected and add appropriate `EXPECT_CALL(...).Times(AnyNumber())` if so.
- Consider switching to `NiceMock` to suppress benign warnings.
- Review usage of `ON_CALL` to set default actions explicitly.

### Breaks in Mock Class Behavior

- Audit mock class definitions, particularly for template changes or newly required method qualifiers.
- Ensure destructors are virtual to avoid heap check failures.
- Check for changes in the treatment of non-virtual methods.

### Deprecated or Removed Features

- Replace deprecated macros, flags, or APIs with current alternatives as noted in the Breaking Changes documentation.

---

## Practical Example: Migrating Mock Methods

Suppose your existing mock class uses old macros:

```cpp
MOCK_CONST_METHOD1(DoSomething, int(int));
```

Upgrade to the modern syntax:

```cpp
MOCK_METHOD(int, DoSomething, (int), (const, override));
```

Wrap complex return or argument types in parentheses or define an alias:

```cpp
using IntStringPair = std::pair<int, std::string>;
MOCK_METHOD(IntStringPair, GetPair, ());
```

---

## Proactive Tips for Upgrading

* Always incrementally upgrade; avoid skipping major stable versions.
* Backup your working test suite before starting the upgrade.
* Take advantage of the verbose mock logging to detect subtle expectation mismatches early.
* Use sequences to maintain call order where strict ordering is required.
* Regularly consult the official changelogs and upgrade guides.

---

## Additional Resources

- [Breaking Changes & Deprecations](changelog/detailed-changelog/breaking-changes.md) — Detailed list of potential breaking changes.
- [New Features & Improvements](changelog/detailed-changelog/new-features-improvements.md) — To understand new capabilities.
- [Bug Fixes & Stability Updates](changelog/detailed-changelog/bug-fixes-patches.md) — Stability fixes that might affect your tests.
- [Using GoogleMock](docs/gmock_for_dummies.md), [gMock Cookbook](docs/gmock_cook_book.md) — Guidance on mocking syntax and patterns that might change across versions.
- [Debugging and Troubleshooting Test Failures](guides/best-practices-integration/debugging-and-troubleshooting.md) — For resolving issues during upgrade verification.

---

## Summary

Upgrading GoogleTest and GoogleMock requires careful preparation and adherence to best practices to maintain test stability. Follow the upgrade workflow, utilize the checklists and migration tips above, and leverage verbose diagnostics to smooth the process. Ensuring your mock definitions and expectations are compliant with the latest API is critical to avoiding surprises. Stay in touch with official releases and leverage community resources for ongoing support.

---

## Contact and Support

For community support during upgrades:

- Visit the [Community Forums and Support Channels](faq/community-support-faq/finding-help.md).
- Report issues or ask questions on the official [GoogleTest GitHub Discussions](https://github.com/google/googletest/discussions).

Together, these resources will help ensure a confident, successful upgrade of your testing framework.
