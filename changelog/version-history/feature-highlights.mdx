---
title: "Feature Highlights"
description: "Discover the most impactful features introduced across recent releases, such as advances in test discovery, rich assertion sets, or new mock behaviors. Easily spot additions that offer immediate value or unlock powerful new testing workflows."
---

# Feature Highlights

Discover the most impactful features introduced across recent releases, such as advances in test discovery, rich assertion sets, or new mock behaviors. This page highlights additions that offer immediate value or unlock powerful new testing workflows, helping you quickly adapt to enhancements improving your testing experience.

---

## 1. Enhanced Mocking Capabilities

Testing complex C++ code requires flexible and precise mocking tools. Recent improvements enrich GoogleMockâ€™s ability to model intricate behaviors and interactions.

- **Mocking Non-Virtual Methods**: You can now mock non-virtual functions to support high-performance dependency injection. This empowers testing of classes that do not use virtual methods by templatizing the code and substituting mock implementations at compile time.

- **Advanced Mocking Syntax**: `MOCK_METHOD` macro extensions accommodate:
  - Overloaded methods without ambiguity
  - Template class methods
  - Methods with calling convention specifiers (like `STDMETHODCALLTYPE` on Windows)
  - Support for modern C++ move-only types such as `std::unique_ptr` enabling mocks to handle move semantics transparently.

- **Strictness Wrappers**: New types `NiceMock`, `NaggyMock`, and `StrictMock` provide fine-grained control over uninteresting calls (calls without explicit expectations). This gives you flexibility to suppress warnings, treat unexpected calls as errors, or maintain default warning behaviors, fitted to diverse test needs.

## 2. Rich Assertion and Matcher Sets

Strong assertions reduce test brittleness and improve diagnostics.

- **Advanced Matchers**: GoogleMock provides an extensive set of built-in matchers, including container matchers (`ElementsAre`, `UnorderedElementsAre`), combinators (`AllOf`, `AnyOf`, `Not`), member validation (`Field`, `Property`), and pointer dereferencing (`Pointee`).

- **Custom Matchers and Actions**: You can create your own matchers and actions for specialized validation or behavior injection:
  - Use `MATCHER`, `MATCHER_P`, and class-based polymorphic matchers for expressive, reusable predicates.
  - Define custom actions using lambdas, functors, or implement action interfaces for complex side effects.

- **Predicate and Composite Matchers**: Instead of rigid equality, predicates and combinations of matchers allow concise expression of conditions on arguments, supporting powerful verification scenarios.

## 3. Flexible Control Over Expectations

Managing the number, order, and dependencies of mock calls is critical to effective testing.

- **Expectation Cardinalities**: Use expressive cardinalities such as `AnyNumber()`, `AtLeast()`, and `Between()` to specify call expectations without overconstraining your tests.

- **Call Order Control**:
  - `InSequence` and `Sequence` enforce strict or partial ordering on expected calls.
  - `.After()` clause lets you specify complex dependency graphs between expectations, ensuring tests align precisely with intended interactions.

- **Sticky Expectations and Retirement**: Expectations remain active until saturated, reducing brittleness. Use `.RetiresOnSaturation()` when you want automatic retirement to enable fallback expectations.

## 4. Default Behavior and Actions

Customization of mock method behaviors ensures tests remain robust and meaningful.

- **ON_CALL for Defaults**: Use `ON_CALL` to set default actions without imposing call expectations, a powerful way to define fallback behaviors.

- **Action Sequencing**: Chain multiple actions using `WillOnce` and `WillRepeatedly` to produce deterministic responses and side effects across multiple invocations.

- **Live Values and Side Effects**: Actions such as `ReturnPointee` return up-to-date values; side effect actions like `SetArgPointee` modify output parameters seamlessly.

## 5. Improved Diagnostics and Debugging Support

Better insight leads to faster debugging and more maintainable tests.

- **Verbose Logging**: The `--gmock_verbose` flag enables logging of all mock calls, including arguments and matched expectations, supporting deep inspection.

- **Detailed Failure Messages**: When calls differ from expectations, error messages include argument mismatches, call counts, and prerequisite failures.

- **Support for IDE Integration**: Enhanced output formatting facilitates easy navigation from failures to relevant source code lines, including Emacs integration support.

## 6. Robustness and Thread Safety

GoogleMock handles multi-threading scenarios gracefully with clear guidelines.

- Actions run in the thread invoking the mock, and the framework manages internal synchronization.

- Verification and expectation-setting must happen without concurrent calls for thread safety; test execution itself may be multi-threaded.

## Practical Tips and Best Practices

- Always define mock methods with `MOCK_METHOD` in the `public:` section for accessibility.

- Matchers should be pure functions without side effects.

- Use `NiceMock` to suppress warnings on uninteresting calls when appropriate.

- Use sequences and `.After()` to assert call order clearly, avoiding brittle tests.

- Avoid mocking concrete classes directly; prefer coding to interfaces.

- Use `ON_CALL` for common default behavior; reserve `EXPECT_CALL` for calls you want to verify strictly.

- In tests, prefer setting expectations before exercising mock objects to ensure reliable and clear failure reports.

---

For full details, recipes, and examples, refer to the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) and the [Mocking Reference](reference/mocking.md).

---

### Additional Resources

- [gMock for Dummies](docs/gmock_for_dummies.md): Beginner-friendly introduction to mock objects and usage patterns.
- [Mocking Reference](docs/reference/mocking.md): Full API description of expectations, matchers, actions, and default values.
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md): Quick syntax guide and common idioms.
- [Strictness Wrappers](api-reference/mocking-framework/mock-strictness-wrappers.md): Control mock object strictness and uninteresting call behavior.
- [Matchers Reference](api-reference/matchers-and-actions/matchers-reference.md): Comprehensive list and description of matchers.

---

### Example: Using `NiceMock` to Suppress Warnings

```cpp
using ::testing::NiceMock;
using ::testing::_;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
};

TEST(FooTest, DoesThisOnce) {
  NiceMock<MockFoo> mock_foo;
  EXPECT_CALL(mock_foo, DoThis());  // Only this call is expected.

  mock_foo.DoThis();  // No warning.
  mock_foo.DoThis();  // No warning, but test will fail if expectation is violated.
}
```

### Example: Enforcing Call Order with `Sequence`

```cpp
using ::testing::Sequence;
using ::testing::Return;

MockTurtle turtle;
Sequence s;

EXPECT_CALL(turtle, PenDown()).InSequence(s);
EXPECT_CALL(turtle, Forward(100)).InSequence(s);
EXPECT_CALL(turtle, PenUp()).InSequence(s);

// Calls must occur in above order.
```

---