---
title: "Upgrade Guides"
description: "Step-by-step instructions for upgrading GoogleTest or GoogleMock versions safely. Outlines strategies, update checks, and compatibility notes tailored for common integration methods (e.g., CMake, Bazel)."
---

# Upgrade Guides

Step-by-step instructions for upgrading GoogleTest and GoogleMock versions safely, focusing on strategies, update checks, and compatibility notes tailored for common integration methods such as CMake and Bazel.

---

## Understanding the Upgrade Landscape

Upgrading GoogleTest or GoogleMock involves more than just swapping library versions; it requires a careful approach to ensure test integrity and compatibility with your build environment. This guide leads you through safe upgrade flows based on typical user integration methods.

GoogleTest and GoogleMock evolve constantly — new APIs, fixes, and sometimes breaking changes are introduced. Following a systematic upgrade strategy will help you avoid common pitfalls, maintain stable test suites, and leverage new features effectively.

---

## Upgrade Preparation Checklist

Before beginning your upgrade, verify the following:

- **Review Release Notes:** Always consult the latest [Release Notes](https://github.com/google/googletest/releases) for GoogleTest and GoogleMock. They summarize new features, bug fixes, and crucially, any breaking changes.

- **Identify Your Integration Method:** Know whether your project integrates GoogleTest via:
  - CMake (installed as a library or embedded as source)
  - Bazel (with WORKSPACE dependencies)
  - Manual builds or other build systems

- **Check Minimum Requirements:** Confirm your toolchain and platform meet the minimum requirements of the new version (e.g., C++ standard support, compiler versions). See [Supported Platforms & Compatibility](../overview/integration-ecosystem/supported-platforms.md) for details.

- **Backup Current Environment:** Save your current GoogleTest/GMock installation, build files, and test binaries so you can revert if needed.

---

## Upgrade Strategies

### 1. CMake-Based Integrations

GoogleTest is typically integrated via CMake either as an installed package or embedded within your repository.

#### Installed GoogleTest

If you use an installed GoogleTest version, upgrading involves replacing the installed files with new ones:

- Download the new GoogleTest release tarball or clone the repository at the desired version.
- Build and install with CMake following standard build instructions.
- Confirm that your CMakeLists.txt uses `find_package(GTest REQUIRED)` and links against `GTest::gtest` and `GTest::gmock` appropriately.
- Verify the tests build and run as expected.

##### CMake Upgrade Tips:

- Update your CMakeLists.txt if the new version introduces changes in how the targets are imported or linked.
- Double-check platform-specific or Visual Studio CRT linkage notes (see Configuring Your Project).

#### Embedded GoogleTest Source

When embedding GoogleTest source directly:

- Replace the source folders (`googletest` and `googlemock`) with the new version.
- Carefully merge any local modifications you may have.
- Rebuild your test targets.
- Run test suites to verify behavior.

##### Common Pitfalls:

- Failing to update submodules or embedded dependencies can cause version mismatches.
- Build cache or intermediate files might need cleaning (`cmake --build . --target clean` or manually removing `CMakeCache.txt`).

### 2. Bazel Integration

For Bazel-based projects, GoogleTest and GoogleMock are usually declared as external dependencies in the `WORKSPACE` file.

#### Steps to Upgrade:

- Update the repository commit or version tag in your WORKSPACE to the desired GoogleTest version.
- Run `bazel sync` to fetch the updated sources.
- Adjust any Bazel build rules if there are API or build changes noted in the release.
- Verify your tests build and pass using `bazel test`.

##### Bazel Notes:

- Consult the Bazel integration guide in `Configuring Your Project` for any platform-specific adjustments.

- Keep an eye on potential breaking changes in BUILD files or dependencies.

### 3. Manual and Other Build Systems

If you manually download and build GoogleTest or use other build systems:

- Replace the source and headers with the new version.
- Follow the updated build instructions applicable to your system.
- Verify linkage with your test executables.


---

## Update and Compatibility Checks

### Verifying API Compatibility

- Look out for deprecated or changed APIs, particularly involving mock classes and macros such as `MOCK_METHOD`. Review the [Breaking Changes](../changelog/breaking-changes-migrations-upgrade-guides/breaking-changes.md) page for the latest migrating instructions.
- If you rely heavily on mocks, confirm that your mock method declarations align with any updated signatures.

### Build and Linker Checks

- Confirm test executables link successfully against the updated GoogleTest/GoogleMock libraries.
- Address any linker errors that commonly arise post-upgrade by:
  - Ensuring correct usage of `GMock` and `GTest` targets.
  - Checking for static/dynamic library mismatches.
  - Following platform-specific notes for MSVC or others in your configuration.

### Runtime and Test Execution Verification

- Run a full suite of your tests.
- Use verbose logging or the `--gmock_verbose=info` flag to trace unexpected behaviors or failures arising due to the upgrade.

- Pay special attention to any warnings regarding mock expectations, especially "uninteresting calls" or failures related to method call orders.

---

## Best Practices for Smooth Upgrades

- **Incremental Upgrading:** Upgrade one major version at a time where possible. This approach simplifies issue isolation.
- **Use ON_CALL Wisely:** When upgrading mock behavior, prefer using `ON_CALL` over `EXPECT_CALL` unless you intend to verify the call frequency and arguments strictly.
- **Check for Default Behavior Changes:** Updated GoogleMock default actions and strictness (e.g., transitions from naggy to nice mocks) may affect test outcomes.
- **Automate Verification:** Integrate your test suite with CI pipelines that run with the new GoogleTest version early.

---

## Troubleshooting Common Upgrade Issues

### Build Errors After Upgrade

- Clean build caches to avoid stale objects.
- Verify that your build system invokes initialization code (`::testing::InitGoogleTest(&argc, argv);`) correctly.
- For CMake, ensure that `find_package` calls match the new GoogleTest config files generated by the new install.

### Broken Mock Expectations

- Review messages about uninteresting or unexpected calls.
- Use `--gmock_verbose=info` to trace expectations and mock behavior.
- Adjust mocks if API changes cause signature mismatches.

### Linker Errors

- Confirm consistency in building GoogleTest/GoogleMock as static or shared.
- On Windows, watch for MSVC runtime library mismatches; see platform-specific guidance.

---

## Additional Resources

- [Configuring Your Project](../getting-started/setup-prerequisites-installation/configuring-your-project.md) — Deep dive on build integrations
- [Breaking Changes & Migrations](../changelog/breaking-changes-migrations-upgrade-guides/breaking-changes.md) — Details of breaking changes and required migrations
- [Supported Platforms & Compatibility](../overview/integration-ecosystem/supported-platforms.md) — Verify your build environment compatibility

---

Following these upgrade guides will help keep your test infrastructure robust, maintainable, and capable of leveraging the latest improvements in GoogleTest and GoogleMock.

---

<Check>
Ensure to keep backups and verify tests immediately post-upgrade to avoid hidden issues affecting production.
</Check>

---

## Example Upgrade Flow for CMake Users

<Steps>
<Step title="Backup Existing GoogleTest Installation">
Create an archive or copy of your current GoogleTest directory and build outputs.
</Step>
<Step title="Download and Extract New Release">
Obtain the latest GoogleTest from the official GitHub releases.
</Step>
<Step title="Build and Install New Version">
Build via CMake using instructions in the official README.
</Step>
<Step title="Update Project’s CMakeLists.txt if Needed">
Adjust any references or target names per new release documentation.
</Step>
<Step title="Clean and Rebuild Your Tests">
Perform a clean build and link against the new version.
</Step>
<Step title="Run Test Suite with Verbose Logging">
Use `--gtest_verbose` and `--gmock_verbose` flags to detect issues early.
</Step>
</Steps>