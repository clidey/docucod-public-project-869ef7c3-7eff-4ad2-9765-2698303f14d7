---
title: "Upgrade Instructions"
description: "Provides actionable, step-by-step upgrade guidance for moving between significant versions, including cross-version compatibility notes, manual intervention requirements, and known pitfalls. This ensures users can confidently transition to newer releases."
---

# Upgrade Instructions

GoogleTest and GoogleMock regularly evolve to provide better features, improved stability, and enhanced compatibility. This page offers focused, step-by-step upgrade guidance for users moving between significant versions of the framework. By following these instructions carefully, you can transition smoothly, avoid common pitfalls, and leverage new capabilities effectively.

---

## 1. Preparation Before Upgrading

Before beginning the upgrade process, ensure you:

- **Review Release Notes and Breaking Changes:** Consult detailed release notes and upgrade guides to understand what changes affect your codebase. Key documents include:
  - [Detailed Release Notes](../release-history/detailed-release-notes)
  - [Breaking Changes](../upgrade-guides/breaking-changes)
  - [Deprecations and Removals](../upgrade-guides/deprecations-and-removals)

- **Backup Existing Code and Tests:** Preserve your current working state before applying any updates.

- **Verify System Requirements:** Confirm that your build environment supports the updated minimum requirements, such as C++17 support for recent versions (see [System Requirements](../../getting-started/prerequisites-installation/system-requirements)).

- **Check Build System Compatibility:** Make sure your build scripts (CMake, Bazel, etc.) are aligned with the new version’s conventions and flags.

---

## 2. Upgrade Workflow

The upgrade experience is generally designed to be incremental and backward-compatible within major versions. Here is a best practice workflow:

<Steps>
<Step title="Update GoogleTest and GoogleMock Sources">
Pull the newest source code or update your package manager dependency to the desired version. For example, to get the latest v1.17.x release:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
```

If you already have the repo, pull and checkout the appropriate tag or branch.
</Step>

<Step title="Adjust Your Build Configuration">
Ensure your CMakeLists.txt or Bazel BUILD files reflect any new dependency or build flags introduced, particularly around:
- Linking against `gmock_main` if using the provided main entry point.
- Enforcing the minimum C++17 standard.
- Handling any new or deprecated compiler macros.

Refer to the [Basic Configuration](../../getting-started/initial-configuration-validation/basic-configuration) guide for updated integration instructions.
</Step>

<Step title="Address Deprecated or Removed Features">
Review deprecation notices and replace APIs or macros flagged as obsolete. This includes:
- Migrating away from legacy MOCK macros to `MOCK_METHOD`.
- Updating flag usage as per new normalized behavior.
- Resolving any clause order enforcement in expectations.

See the [Deprecations and Removals](../upgrade-guides/deprecations-and-removals) page for detailed recommendations.
</Step>

<Step title="Modify Test Code for Breaking Changes">
Apply necessary code changes to adapt to breaking changes such as:
- The mandatory presence of default actions on `ON_CALL`.
- Changes to when argument expressions are evaluated.
- Updated verbosity flag normalization.

Test suites may need adjustments to ordering of expectation clauses and verification of uninteresting versus unexpected calls. Consult the [Breaking Changes](../upgrade-guides/breaking-changes) documentation for examples and migration steps.
</Step>

<Step title="Rebuild and Run Tests">
Clean and rebuild your project to ensure new sources and configurations are applied. Then execute tests with the updated framework:

```bash
./your_test_binary
```

Observe changes in output, warnings, or errors and address any issues.
</Step>

<Step title="Monitor Runtime Behavior and Logging">
Pay close attention to test output verbosity, particularly if you leverage GoogleMock’s `--gmock_verbose` flag for detailed logs. Adjust your invocation flags as needed to maintain expected feedback during test runs.
</Step>
</Steps>

---

## 3. Special Considerations

### 3.1 Default Main Entry Point

GoogleMock provides a convenient main function implementation in `gmock_main` to simplify initialization. If your project uses this:

- Replace any custom main with linking to `gmock_main`.
- Initialization of GoogleMock and GoogleTest is handled automatically via `testing::InitGoogleMock()`.

Refer to the [Main Entry Point & Test Execution](../../concepts/core-architecture/main-entry-and-execution) documentation for detailed behavior and platform-specific notes.

### 3.2 Command-Line Flags Parsing

Flags prefixed with `--gmock_` are specially parsed and removed from `argv` by `InitGoogleMock()` before tests run. This behavior may affect test runners or CI systems.

- Ensure any command-line options for verbosity, default mock behaviors, or leakage detection conform to new syntax.
- Unrecognized flags not prefixed with `--gmock_` remain intact.

See test coverage in `gmock_test.cc` for examples of flag parsing behavior.

### 3.3 Compiler and Platform Support

Recent versions require:

- Minimum C++17 standard support.
- Compatible threading support (e.g., pthreads or equivalent).
- Supported compiler versions (e.g., Visual C++ 2015 or later).

Review [System Requirements](../../getting-started/prerequisites-installation/system-requirements) and platform utilities for specific details.

---

## 4. Troubleshooting Common Upgrade Issues

<Tip>
If you encounter linker errors such as unresolved `main` symbols, confirm that:
- You are linking against the correct GoogleTest or GoogleMock main libraries (`gtest_main` or `gmock_main`).
- Build configuration flags are consistent across dependencies.
</Tip>

<Warning>
Test failures related to unexpected mock method calls after upgrade often stem from changes in strictness models or default ON_CALL behaviors. Review your mock expectations and consider applying explicit `ON_CALL` default actions if needed.
</Warning>

<Check>
Verify that your compiler and linker flags correctly specify the C++17 standard, and your environment matches the supported platforms as per updated requirements.
</Check>

---

## 5. Final Validation and Best Practices

- Run the full test suite with relaxed verbosity first to observe baseline pass/fail outcomes.
- Incrementally enable verbose logging to detect silent mock call issues.
- Use the [gMock Cookbook](../../googletest-guides/advanced-mocking-patterns/actionable-mock-expectations) and [Mocking Reference](../../api-reference/mocking-apis/creating-mocks) as guides for adopting improved mocking practices.
- Keep your upgrade samples, CI scripts, and documentation aligned with the new framework version.

---

## 6. Additional Resources

- [Breaking Changes and Migration Examples](../upgrade-guides/breaking-changes)
- [Deprecated Features and Removals](../upgrade-guides/deprecations-and-removals)
- [Basic Configuration Guide](../../getting-started/initial-configuration-validation/basic-configuration)
- [Main Entry Point & Execution Flow](../../concepts/core-architecture/main-entry-and-execution)
- [Flag Usage and Initialization Tests](https://github.com/google/googletest/blob/main/googlemock/test/gmock_test.cc)
- [Official GitHub Releases](https://github.com/google/googletest/releases)

---

By following these upgrade instructions attentively, you will maintain a stable and modern GoogleTest environment that maximizes your testing efficiency and leverage the latest improvements with confidence.
