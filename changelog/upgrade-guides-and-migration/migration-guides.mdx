---
title: "Migration & Upgrade Guides"
description: "Step-by-step instructions for migrating from older GoogleTest/GoogleMock versions to the latest. Highlight deprecations, removals, and practical code change examples to ensure a seamless transition for maintaining and modernizing test suites."
---

# Migration & Upgrade Guides

This page offers clear, step-by-step instructions for migrating your existing test suites from older versions of GoogleTest and GoogleMock to the latest release. It highlights deprecated features, removed APIs, and practical code change examples to ensure your upgrade is smooth and maintains test stability.

---

## 1. Preparing for Migration

Before beginning your migration, it's essential to understand the scope of changes introduced in recent versions and plan your update process accordingly.

- **Review Breaking Changes:** Familiarize yourself with any breaking API or behavioral changes documented in the [Breaking Changes Guide](https://github.com/google/googletest/blob/main/docs/changelog/upgrade-guides-and-migration/breaking-changes.md). These changes may require direct code modifications.
- **Ensure C++17 Compliance:** The latest GoogleTest versions require your project to compile with at least C++17 support.
- **Backup Existing Tests:** Always back up your existing test code before applying migration updates.

---

## 2. Deprecated and Removed Features

### Deprecated APIs

Some previously existing macros, methods, or behaviors are now deprecated and will be removed in future releases. Key deprecated items include:

- Certain legacy mock macros that have improved replacements.
- Deprecated flag or configuration options.
- Old-style EXPECT_CALL behaviors that no longer conform to best practices.

### Removed Features

Features fully removed in the latest version are outlined with migration pathways when available.

---

## 3. Common Migration Scenarios

This section guides you through typical changes you are likely to encounter, with concrete before-and-after code snippets.

### 3.1. Updating Mock Method Declarations

**Old style:**
```cpp
MOCK_METHOD0(Foo, int());
MOCK_METHOD1(Bar, void(int x));
```

**New style:**
```cpp
MOCK_METHOD(int, Foo, (), ());
MOCK_METHOD(void, Bar, (int x), ());
```

- The new syntax clearly separates return type, method name, parameter list, and qualifiers.
- This modernization supports advanced features such as ref-qualifiers and noexcept specifications.

### 3.2. Using Strictness Wrappers

If your tests relied on the default behavior of mock strictness, be aware of changes:

- `NiceMock` and `StrictMock` wrappers now better control uninteresting call handling.
- Transition your mocks to explicitly use these wrappers for clearer intent and improved test diagnostics.

### 3.3. Call Order and Cardinalities

Verify that your expectationsâ€™ call counts and ordering constraints conform to the latest enforcement rules.

- Use cardinalities like `Exactly()`, `AtLeast()`, `AnyNumber()` explicitly to avoid ambiguities.
- Adjust sequences and ordering macros as some call order enforcement rules have tightened.

### 3.4. Removing Unsupported Macros

If you use macros or features identified as removed, replace them per migration notes or remove the code if no alternative exists.

---

## 4. Step-by-Step Migration Workflow

<Steps>
<Step title="Audit your Test Code">
Review your test files to identify deprecated or removed API usage, focusing on mock declarations, expectation setup, and configuration flags.
</Step>
<Step title="Update Mock Method Syntax">
Rewrite all `MOCK_METHOD` macros using the new syntax for clarity and compatibility.
</Step>
<Step title="Apply Strictness Wrappers Explicitly">
Wrap mock classes with `NiceMock`, `StrictMock`, or `NaggyMock` according to desired call-checking behavior.
</Step>
<Step title="Validate Call Cardinalities and Sequences">
Ensure that all expectations have appropriate call count specifications and sequences comply with latest requirements.
</Step>
<Step title="Recompile and Run Tests">
Compile your tests and verify all tests pass, paying special attention to warnings or errors related to mock expectations.
</Step>
<Step title="Address Remaining Issues">
Use verbose mock output flags (e.g., `--gmock_verbose=info`) to diagnose and fix unexpected behaviors or failures.
</Step>
</Steps>

---

## 5. Troubleshooting Common Migration Issues

<AccordionGroup title="Migration Troubleshooting">
<Accordion title="Compiler Errors on MOCK_METHOD">
Ensure your compiler uses at least C++17. Modify your build system accordingly (e.g., `-std=c++17` flag).
</Accordion>
<Accordion title="Unexpected Test Failures After Upgrade">
Verify strictness mode usage and correct expectation ordering. Use verbose logging to understand unexpected mock interactions.
</Accordion>
<Accordion title="Linking Issues After Migration">
Check library linking order and ensure updated GoogleTest and GoogleMock binaries are linked. Rebuild dependencies if needed.
</Accordion>
</AccordionGroup>

---

## 6. Best Practices During Migration

- **Incremental Changes:** Migrate tests in batches to isolate problems.
- **Automated Scripts:** Use code-mod tools or regex replacements for macro syntax changes.
- **Test on CI:** Integrate migration validation into Continuous Integration to catch issues early.
- **Consult Official Guides:** Leverage migration guides and breaking change docs regularly updated by the GoogleTest team.

---

## 7. Additional Resources

- [Breaking Changes Guide](https://github.com/google/googletest/blob/main/docs/changelog/upgrade-guides-and-migration/breaking-changes.md): Detailed list of all breaking API updates.
- [Mocking Basics](https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md): Learn new mocking syntax and concepts.
- [Advanced Mocking Patterns](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md): Understand best practices for flexible mocks.
- [Build System Integration](https://github.com/google/googletest/blob/main/docs/concepts/integration-and-scalability/build-system-integration.md): Update build tools for the latest GoogleTest.
- [Troubleshooting Common Issues](https://github.com/google/googletest/blob/main/docs/getting-started/first-test-validation/troubleshooting-common-issues.md): Common setup challenges.

---

For convenience, you can find the migration and upgrade guides linked within the GoogleTest User's Guide under the Changelog section.

---

## 8. Summary

Migrating to the latest GoogleTest and GoogleMock versions involves understanding deprecated and removed features, updating mock method declarations to the new syntax, explicitly controlling mock strictness, and refining expectation cardinalities. Follow the outlined step-by-step workflow to systematically upgrade your test suites with minimal disruption.

Use verbose diagnostics and continuous integration to maintain test reliability through the transition. The official breaking changes and mocking basics guides provide essential support for a smooth migration.

---

For further assistance, consider the community and support channels listed in the Getting Started documentation.

---

<Source url="https://github.com/google/googletest" />