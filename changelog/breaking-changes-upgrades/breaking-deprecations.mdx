---
title: "Breaking Changes & Deprecations"
description: "A curated list of API or behavioral changes that may impact compatibility, along with notices on deprecated features. Users can consult this page to anticipate and mitigate potential disruptions when upgrading."
---

# Breaking Changes & Deprecations

This page catalogues significant API or behavioral changes and deprecated features within GoogleTest and GoogleMock. It serves as an essential resource for users planning upgrades or integrating new versions, enabling them to identify potential compatibility impacts and necessary migration steps.

---

## Understanding Breaking Changes

Breaking changes are modifications to the APIs, behaviors, or interfaces that are not backward compatible. They can cause existing test code or mock setups to fail compilation or runtime.

When a breaking change occurs, it is clearly documented here with guidance on how to update your codebase to work correctly with the latest version.

### Common Types of Breaking Changes
- Changes to macro definitions or usage requirements
- Modifications in mock method declaration or usage
- Altered behaviors of EXPECT_CALL and ON_CALL macros
- Updated semantics for mock strictness modes (e.g., changes in NiceMock, StrictMock)
- Changes in default actions or cardinality inference rules
- Adjustments in the lifecycle of mock objects and their verification

### How to Mitigate
- Review all updated or deprecated macros your tests employ
- Adjust mock method declarations using `MOCK_METHOD` per new syntax requirements
- Verify mock expectations’ ordering and cardinality follow the updated semantics
- Use recommended forwarding techniques when dealing with move-only types
- Pay attention to changes in default mock behaviors concerning uninteresting calls

<Tip>
Always back up your current tests and run incremental testing after upgrading GoogleTest to quickly identify and fix breakages introduced by updated APIs.
</Tip>

---

## Deprecated Features

Certain features within GoogleTest and GoogleMock have been deprecated to improve the framework’s clarity, usability, or to remove outdated patterns. Deprecated features may still work but will be removed in future releases.

### Notable Deprecated Features
- Old-style mock macros such as `MOCK_METHODn` and `MOCK_CONST_METHODn` are deprecated. Use the generic `MOCK_METHOD` macro instead.
- Deprecation of non-`override` qualified mock method declarations. It is now recommended to specify `(override)` for all mocked virtual methods.
- Legacy actions defined via old `ACTION*` macros are discouraged in favor of lambdas and callable objects.

<Warning>
Continue using deprecated features at your own risk. They may cause warnings during compilation and will eventually be removed in a future major release.
</Warning>

---

## Important Behavioral Changes by Version

Please always check the official changelog for the exact version history and detail.

### Mock Method Declaration
- The older `MOCK_METHODn` macros have been superseded by the more flexible and consistent `MOCK_METHOD` macro which allows specifying qualifiers like `const`, `override`, `noexcept`, and call types.
- Commas within types must be enclosed in parentheses or type aliases to ensure proper parsing.

### Expectation Ordering and Semantics
- Expectations set by `EXPECT_CALL` should be placed before exercising code that triggers them. Setting expectations afterward leads to undefined behavior.
- Default cardinality inference rules for expectations have been refined. Missing explicit `Times()` may be inferred differently depending on `WillOnce()` and `WillRepeatedly()` usage.

### Strictness and Uninteresting Calls
- `NiceMock` suppresses warnings on uninteresting calls, `NaggyMock` (default) issues warnings, and `StrictMock` treats uninteresting calls as errors.
- Applying `NiceMock` or `StrictMock` to mocks inheriting mock methods (declared in base classes) may be inconsistent due to compiler limitations.

### Move-Only Types in Mock Methods
- Native support for mocking methods with move-only parameters and return types has been added.
- Using lambdas or callable objects with `WillOnce()` or `WillRepeatedly()` are recommended over `Return(std::move(...))` for move-only returns.
- Older patterns delegating methods to mock methods with pointer parameters (`DoShareBuzz` style) are deprecated.

### Verification and Leak Detection
- Calls to `Mock::VerifyAndClearExpectations()` and `Mock::AllowLeak()` should be used carefully to force verification or suppress leaks, especially in death tests.

---

## Common Pitfalls & Troubleshooting

### Expectation Violations After Upgrading
- Ensure all your `EXPECT_CALL` macros precede each exercise of the mock.
- Verify any changes in cardinality inference or action sequencing.

### Compile Errors on Mock Method Declarations
- Update old `MOCK_METHODn` to the new `MOCK_METHOD` syntax.
- Shield type arguments with commas inside parentheses or aliases.
- Use correct specifiers like `(const, override)` when overriding virtuals.

### Warnings About Uninteresting Calls
- Use `NiceMock` or add catch-all expectations (`EXPECT_CALL(mock, Method(_)).Times(AnyNumber());`) to suppress warnings.
- Review if your tests unintentionally neglect to specify expectations.

### Problems with Move-only Types
- Avoid `Return(std::move(...))` in repeated calls; prefer lambdas that create new instances.
- Refactor older patterns delegating to non-move-aware mock methods.

---

## Migration Guidance

When upgrading across major versions of GoogleTest, ensure you:

1. Replace old mock macros (`MOCK_METHODn`) with the new `MOCK_METHOD` macro syntax.
2. Annotate all overridden mock methods with `override` specifiers.
3. Adjust for new cardinality inference rules in your `EXPECT_CALL` statements.
4. Review and adjust for changes around mock strictness (`NiceMock`, `StrictMock`, `NaggyMock`).
5. Use lambdas and callable objects to specify mock responses instead of old-style `ACTION*` macros.
6. Test thoroughly under `--gmock_verbose=info` to expose subtle behavioral mismatches.

See the official Upgrade Guides for detailed per-release instructions.

---

## Resources & Related Documentation

- [GoogleMock Mocking Reference](../api-reference/mocking-apis/mock-class-macros)
- [Mocking Techniques & Best Practices](../guides/mocking-techniques/mock-classes-expectations)
- [Advanced Actions and Matchers](../guides/mocking-techniques/working-with-actions-matchers)
- [Breaking Changes and Upgrade Guidance](./breaking-changes-upgrades/upgrade-guides)
- [All Releases and Changelog](./version-history/all-releases)

---

## Practical Tips

- Prefer the latest mock declaration macros and always specify `(override)`.
- Use `ON_CALL` to set default mock behaviors and `EXPECT_CALL` only to verify interactions.
- Suppress uninteresting call warnings sensibly, leveraging `NiceMock` or catch-alls.
- Write and test expectations before exercising mocks.
- When working with move-only types, prefer lambdas returning new instances on every call.

<Tip>
Keeping your mocks simple and expectations explicit will reduce breakages and improve test maintainability, especially during upgrades.
</Tip>

---

For detailed examples and comprehensive changelogs, please refer to the [All Releases changelog page](./version-history/all-releases).


---

<AccordionGroup title="Frequently Asked Questions & Troubleshooting">
<Accordion title="Why do I get warnings about 'uninteresting mock function calls'?">
This warning indicates that a mock method was called without any `EXPECT_CALL` matching it, which by default is allowed but logged as a warning to catch potential oversights. To suppress the warning:

- Use `NiceMock` to make the mock object less chatty.
- Add a catch-all expectation with `.Times(AnyNumber())`.

Avoid suppressing by adding `EXPECT_CALL` without meaning, as this makes tests brittle.
</Accordion>
<Accordion title="How do I handle move-only types in mocks after upgrading?">
Use `MOCK_METHOD` normally. For return values, use lambdas to return a new instance on each call:

```cpp
EXPECT_CALL(mock, Method())
    .WillRepeatedly([]() { return std::make_unique<Type>(); });
```

Avoid `Return(std::move(...))` in repeated calls, as it's only safe for one-time returns.
</Accordion>
<Accordion title="What do I do if my tests break because of changed cardinality rules?">
Review your calls to `EXPECT_CALL`. Cardinality inference has become stricter. You may need to explicitly specify `.Times()` clauses or adjust `WillOnce()` and `WillRepeatedly()` usages to align with expected call counts.
</Accordion>
</AccordionGroup>

---

**For the latest best practices and migration assistance, consult the GoogleTest GitHub repository and community forums.**

<Check>
Be proactive about reading changelogs and upgrade notes before moving to a new GoogleTest version.
</Check>

---

_Source: [GoogleTest GitHub Repository - main branch](https://github.com/google/googletest)_


---



