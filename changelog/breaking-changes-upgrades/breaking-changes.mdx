---
title: "Breaking Changes & Deprecations"
description: "All breaking changes, deprecated APIs, and removals are cataloged with concise explanations and examples of impact. This helps users assess migration effort and ensures early warning for required code or build adjustments."
---

# Breaking Changes & Deprecations

This page serves as your central catalog of all breaking changes, deprecated APIs, and removed features within GoogleTest and GoogleMock. It provides clear explanations, illustrative examples, and guidance on migration to help you assess the impact on your codebase and prepare for necessary adjustments efficiently.

---

## Understanding Breaking Changes

Breaking changes are modifications that may cause existing test code or builds to fail or behave differently. This includes changes to mock APIs, test macros, class interfaces, or behavior semantics.

### What to Look For

- API signatures that have changed
- Removed or renamed functions or macros
- Behavioral changes that affect test expectations
- Changes in default behaviors or mock object handling

### Assessing Impact

Identify which parts of your test code use the affected APIs. Consider the severity such as:

- Immediate failure upon upgrade
- Potential silent behavioral differences
- Build or runtime errors

### Example

```cpp
// Old usage (Deprecated or removed)
MOCK_METHOD1(MockFoo, bool(Bar));

// New recommended usage
MOCK_METHOD(bool, MockFoo, (Bar), (override));
```

The above shows the migration from the old `MOCK_METHODn` macros to the unified `MOCK_METHOD` macro.

---

## Deprecated APIs

APIs or features marked as deprecated remain functional for now but will be removed in a future release. It's important to start migrating away from these to avoid unexpected breakage.

### Common Deprecated Elements

- Legacy `MOCK_METHODn` macros in GoogleMock have been superseded by `MOCK_METHOD`.
- Non-virtual mocking techniques that were recommended as workarounds.

### Migration Recommendations

- Replace all `MOCK_METHODn` (e.g., `MOCK_METHOD1`, `MOCK_CONST_METHOD1`) with the modern `MOCK_METHOD` pattern.
- Update override specifications and qualifiers (e.g., `const`, `override`, `noexcept`) in your mock method declarations.

### Example Migration

```cpp
// Deprecated
MOCK_METHOD1(Foo, bool(int n));

// Updated
MOCK_METHOD(bool, Foo, (int n), (override));
```

---

## Removals and Retirements

Features or APIs that have been removed no longer exist in the current GoogleTest version. Code using them will fail to compile or link.

### Notable Removals

- Old-style mock macros (`MOCK_METHODn`) without the explicit override specifier when the new style is used exclusively.
- Certain deprecated matchers or actions that have better replacements.

### Handling Removals

- Audit your codebase and replace any removed APIs with supported alternatives.
- Consult the migration guides for detailed instructions on rewriting failing tests.

---

## Migration Examples and Patterns

### From Legacy Mock Definitions

```cpp
// Legacy mock method
MOCK_METHOD2(Foo, bool(int x, int y));

// Modern equivalent
MOCK_METHOD(bool, Foo, (int x, int y), (override));
```

### Delegating to Real or Fake Objects

When you previously relied on old mocking workarounds, consider delegating calls in the new style:

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(bool, DoWork, (int x), (override));

  void DelegateToFake() {
    ON_CALL(*this, DoWork)
        .WillByDefault([this](int x) { return fake_.DoWork(x); });
  }

 private:
  FakeFoo fake_;
};
```

### Using NiceMock and StrictMock

Deprecated behaviors around uninteresting calls have been refined. Use `NiceMock<MockFoo>` to suppress warnings and `StrictMock<MockFoo>` to enforce strict call expectations.

```cpp
using ::testing::NiceMock;
using ::testing::StrictMock;

NiceMock<MockFoo> nice_mock;
StrictMock<MockFoo> strict_mock;
```

Be aware that these wrappers only affect *uninteresting* calls—calls to mock methods with no expectations—and not *unexpected* calls.

---

## Key Changes in Mocking APIs

### Unified `MOCK_METHOD` Macro

The new `MOCK_METHOD` macro consolidates all previous mock definitions into a single, more flexible macro supporting:

- Methods with arbitrary signatures and qualifiers.
- Explicit `override`, `const`, `noexcept` and calling conventions (e.g., `Calltype(STDMETHODCALLTYPE)` on Windows).
- Proper overload resolution with clear syntax.

Example:

```cpp
MOCK_METHOD(ReturnType, MethodName, (Args...), (qualifiers));
```

### Better Overload Support

Use `Const()` wrapper and explicit qualifiers to resolve ambiguous overloaded methods:

```cpp
EXPECT_CALL(Const(mock), Overloaded(5)).WillOnce(Return(3));
```

### Default Actions and Expectation Behavior

- Use `ON_CALL` to define default behavior without setting expectations.
- Use `EXPECT_CALL` to set expectations and optionally specify behaviors.
- When multiple `ON_CALL` or `EXPECT_CALL` statements exist for the same method, the most recent one matching the argument signature takes precedence.

### Common Pitfalls

- Always set expectations before exercising code that calls mocks.
- Avoid mixing `EXPECT_CALL` and mock usage in unintended orders.
- When using move-only types (`std::unique_ptr`), prefer lambdas or callable objects for actions rather than `Return()`.

---

## Troubleshooting

### Compilation Errors Due to Deprecated Macros

If your build breaks due to missing `MOCK_METHODn` macros, replace them with the new `MOCK_METHOD` form.

### Uninteresting Call Warnings

Switch between `NiceMock` and `StrictMock` wrappers to tune test strictness relative to uninteresting calls.

### Overloaded Method Ambiguity

Explicitly use `Const()` or specify exact matchers for overloaded methods.

### Move-only Types

Review use of move-only return values and arguments in mocks and ensure compliant action lambdas or `WillOnce()` handlers.

---

## Useful References

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html): Recipes for mocking and expectations.
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html): Common issues and their solutions.
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html): Quick syntax reference.
- [Mock Object Definition and Usage](/api-reference/gmock-mocking-apis/mock-object-definition): API details.

---

> <Callout>
> 
> **Tip:** Prefer the modern mock API (`MOCK_METHOD`) for maintainability and compatibility with future GoogleTest versions. Use `ON_CALL` for setting up default mock behaviors and `EXPECT_CALL` only when verifying interactions.
> 
> </Callout>

---