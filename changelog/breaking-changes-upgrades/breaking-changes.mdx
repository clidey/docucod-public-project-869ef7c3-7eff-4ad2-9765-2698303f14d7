---
title: "Breaking Changes"
description: "Details all breaking changes introduced in recent releases, outlining the impact on existing codebases and providing context for why certain changes were necessary. This enables users to quickly identify and address incompatibilities."
---

# Breaking Changes

This page details all breaking changes introduced in recent releases of GoogleTest and GoogleMock. It outlines how these changes may impact your existing codebases, provides the context behind each change, and offers guidance for addressing compatibility issues swiftly and effectively.

By understanding these breaking changes, you can better plan upgrades and maintain robust, compatible test suites.

---

## What Are Breaking Changes?

Breaking changes are modifications or removals of existing features, behaviors, or interfaces that may cause your code to fail to compile, break runtime expectations, or behave differently after upgrading. They are necessary to improve the framework, fix critical issues, or remove unsupported patterns but require careful attention when upgrading.

---

## How to Use This Page

- Quickly identify changes impacting your code.
- Understand why a change was made.
- Find best practices and tips to migrate or adapt your tests.

---

## Recent Breaking Changes

### 1. MOCK_METHOD Macro Syntax Updates

GoogleMock fully replaced the old `MOCK_METHODn` family of macros with the generic `MOCK_METHOD` macro. This change affects how mock methods are declared.

**Impacts:**
- Using old `MOCK_METHODn` macros will continue to work for now but is deprecated.
- Code using the old macros should update to the new `MOCK_METHOD` syntax for full compatibility and future-proofing.

**Migration Tips:**
- Replace `MOCK_METHOD1(MethodName, ReturnType(Args))` with `MOCK_METHOD(ReturnType, MethodName, (Args))`.
- Add necessary qualifiers such as `(const, override)` in the fourth macro parameter.

For details, see the [Mocking Reference: MOCK_METHOD](../api-reference/mocking-framework-api/defining-mocks.md#MOCK_METHOD).

---

### 2. Default Mock Behavior and Strictness Modes

The default behavior for uninteresting calls and how `NiceMock`, `NaggyMock`, and `StrictMock` work has been clarified and tightened.

**Impacts:**
- Uninteresting calls emit warnings by default (naggy behavior).
- Switching to `StrictMock` will cause uninteresting calls to be treated as failures.
- `NiceMock` suppresses such warnings to reduce noise.

**Migration Tips:**
- Review usages where the default mock behavior matters, especially when tests rely on uninteresting calls.
- Use `NiceMock` or `StrictMock` deliberately to control verbosity and strictness.

Refer to the [Nice, Strict, and Naggy Mock Classes](../api-reference/mocking-framework-api/mock-class-behavior-modes.md) for comprehensive guidance.

---

### 3. Expectation Ordering and Sticky Expectations

The way `EXPECT_CALL`s search and match calls is from most recent to earliest, allowing newer expectations to override older ones.

**Impacts:**
- Expectation matching order may change behaviors if older expectations are shadowed.
- Expectations are "sticky" by default, remaining active even after saturation unless marked with `.RetiresOnSaturation()`.

**Migration Tips:**
- Use `.RetiresOnSaturation()` to make expectations deactivate immediately after being satisfied.
- For call sequences requiring strict ordering, use `::testing::Sequence` or `IN_SEQUENCE` blocks.

See [Expectation Ordering](../docs/gmock_cook_book.md#MultiExpectations) and [Ordered Calls](../docs/gmock_cook_book.md#OrderedCalls) for expanded explanation.

---

### 4. Removal of Support for Variadic Function Mocks

gMock cannot mock variadic (ellipsis `...`) functions directly.

**Impacts:**
- If you mock variadic functions, you must adapt your code by overloading functions or rewriting interface abstractions.

**Migration Tips:**
- Refactor such APIs to use fixed-argument overloads or interface methods.

Further explanation is in the [Legacy gMock FAQ](../docs/gmock_faq.md#can-i-mock-a-variadic-function). 

---

### 5. Virtual Destructors Requirement

A class requires a virtual destructor in order to safely mock it.

**Impacts:**
- Mocking a class without a virtual destructor can yield undefined behavior and heap leaks.

**Migration Tips:**
- Ensure any interface or base class intended for mocking has a public virtual destructor.

See the explanations in [Legacy gMock FAQ: I get a heapcheck failure when using a mock object](../docs/gmock_faq.md#i-get-a-heapcheck-failure-when-using-a-mock-object).

---

### 6. Strict Enforcement of EXPECT_CALL Before Use

Expectations must be set with `EXPECT_CALL` before the mock methods are invoked.

**Impacts:**
- Setting `EXPECT_CALL` after calls results in undefined behavior and failed tests.

**Migration Tips:**
- Refactor tests to declare expectations prior to exercising code.

More at [Legacy gMock FAQ: The "newer expectations override older ones" rule](../docs/gmock_faq.md#the-newer-expectations-override-older-ones-rule-makes-writing-expectations-awkward-why-does-gmock-do-that).

---

### 7. Matchers and Argument Matching Improvements

GoogleMock requires that matchers are pure and side-effect-free. Certain matcher behaviors and API usages have been tightened.

**Impacts:**
- Using stateful or impure matchers may produce unexpected failures.

**Migration Tips:**
- Verify your custom matchers comply with purity and statelessness.
- Update usages of deprecated or legacy matcher macros.

Refer to [Matchers Reference](../docs/api-reference/mocking-framework-api/built-in-actions-matchers.md) and [gMock Cookbook: Writing New Matchers Quickly](../docs/gmock_cook_book.md#NewMatchers).

---

### 8. Move-Only Types Handling in Mocks

Support for mocking methods with move-only types like `std::unique_ptr` has been standardised and improved.

**Impacts:**
- Older workaround patterns using delegating mock methods may still work but migrating is recommended.

**Migration Tips:**
- Use `MOCK_METHOD` with move-only arguments and returns directly.
- Use lambdas in actions to generate fresh move-only instances each time.

See [gMock Cookbook: Mocking Methods That Use Move-Only Types](../docs/gmock_cook_book.md#mocking-methods-that-use-move-only-types).

---

## Best Practices for Handling Breaking Changes

To smoothly upgrade:

- Review all your mock class definitions and usages for deprecated macros or patterns.
- Check for virtual destructor compliance.
- Audit test code to set expectations before exercising mocks.
- Use sequences and `.RetiresOnSaturation()` where strict ordering or non-sticky expectations are needed.
- Use behavior control classes (`NiceMock`, `StrictMock`) consciously.
- Adjust code for matcher purity and statefulness.
- Test behavior of move-only type usage patterns.

---

## Troubleshooting and Support

If breaking changes cause test failures or compilation errors, try:

- Running tests with `--gmock_verbose=info` to see detailed call and expectation matching traces.
- Consulting [Legacy gMock FAQ](../docs/gmock_faq.md) and [Mocking Reference](../docs/api-reference/mocking-framework-api.md) for common pitfalls
- Using provided migration tips to update expectations and mocks

If issues persist, seek help from the [GoogleTest community support channels](../faq/community-support/support-channels.md).

---

## Related Documentation

- [gMock Cheat Sheet](../docs/gmock_cheat_sheet.md) — Quick syntax summary
- [gMock Cookbook](../docs/gmock_cook_book.md) — Practical recipes for common testing scenarios
- [Mocking Reference](../docs/api-reference/mocking-framework-api.md) — Complete API reference
- [Legacy gMock FAQ](../docs/gmock_faq.md) — Frequently asked questions about GoogleMock
- [Nice, Strict, and Naggy Mock Classes](../api-reference/mocking-framework-api/mock-class-behavior-modes.md) — Behavior modes

For complete version history and upgrade guides, visit the [Full Version History](../changelog/release-history/version-history.md) and [Upgrade Guides and Migration Tips](../changelog/breaking-changes-upgrades/upgrade-guides.md).

---

## Summary
This page serves as a central reference for breaking changes introduced in GoogleTest and GoogleMock. It helps users quickly understand modifications that affect backward compatibility, provides rationale for these changes, and guides users through the necessary upgrades and code revisions to maintain test suite stability.

By carefully reviewing this changelog and related resources, users can ensure seamless adoption of new releases, leverage improvements, and avoid common pitfalls caused by changed behaviors or deprecated features.


<Check>
Always back up your test code before upgrading. Incremental upgrades with thorough testing minimize disruption.
</Check>

<Info>
GoogleMock is evolving; following recommended migration patterns will improve maintainability and test reliability.
</Info>

---