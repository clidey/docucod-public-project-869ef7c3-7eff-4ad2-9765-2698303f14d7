---
title: "Deprecations, Removals, and Abseil Integration Plans"
description: "Lists any deprecated features or behaviors, timelines for removal, and emerging dependencies (like upcoming Abseil integration). Users discover how to future-proof their usage and avoid deprecated patterns."
---

# Deprecations, Removals, and Abseil Integration Plans

## Overview

This page outlines the current and upcoming deprecations within GoogleTest and GoogleMock, details their timelines for removal, and describes the plans for integrating with Abseil. As GoogleTest evolves, some legacy features and behaviors are phased out to improve maintainability, modernize the codebase, and prepare for new dependencies. Users of GoogleTest and GoogleMock will find guidance here on how to future-proof their test code, avoid deprecated patterns, and smoothly transition to the latest supported APIs and integrations.

---

## 1. Deprecated Features and Behaviors

As part of ongoing improvements, several older APIs and constructs are deprecated. These deprecations are announced in advance to provide users time to migrate.

### 1.1 Legacy Mocking Macros

The old family of `MOCK_METHODn` macros (e.g., `MOCK_METHOD1`, `MOCK_CONST_METHOD1`, etc.) have been deprecated in favor of the unified `MOCK_METHOD` macro. The newer macro:

- Uses a consistent, clearer syntax.
- Supports `override`, `const`, `noexcept`, and call type qualifiers in a unified manner.
- Handles template and overloaded methods more robustly.

**Migration Advice:**

Transition mock classes to use `MOCK_METHOD(ReturnType, MethodName, (Args...), (Specs...))` syntax. This applies whether mocking virtual or non-virtual methods (see [gMock Cookbook: Creating Mock Classes](https://google.github.io/googletest/gmock_cook_book.html#creating-mock-classes)).

### 1.2 C++17 Minimum Version Requirement

GoogleTest and GoogleMock now require a baseline of C++17 support. Users targeting older standards must upgrade their toolchains.

### 1.3 Refined Expectation and Action APIs

Expectations (`EXPECT_CALL`) now enforce stricter rules on use order and modifiers:

- Clauses like `.With()` must appear first.
- `.Times()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()` follow a set order.

Warnings and error messages have improved for unexpected, uninteresting, and excessive calls.

---

## 2. Removal Timelines

Deprecated APIs and behaviors are scheduled for permanent removal at major releases. Users should monitor release notes and the migration guide to avoid disruptions.

- **Legacy `MOCK_METHODn` macros:** Deprecated since 2018, removal planned within the next major version cycle.
- **Non-C++17 fallback support:** Support for pre-C++17 will be discontinued soon.

Refer to the [Breaking Changes & Migration Guidance](https://google.github.io/googletest/changelog/upgrade-and-migration/breaking-changes.md) for step-by-step instructions.

---

## 3. Abseil Integration Plans

GoogleTest is actively integrating with Abseil to leverage its robust utilities and improve consistency across Google’s C++ projects. Notable integration aspects include:

- **Regular Expression Handling:** Switch to RE2 library (used by Abseil) for regex support, replacing platform-dependent or simple regex engines.
- **Flag and Configuration Management:** Adopt Abseil Flags for complex command-line and runtime configuration options.
- **Synchronization and Threading Primitives:** Utilize Abseil synchronization utilities for mutexes, thread local storage, and notifications.

### 3.1 Impact on Users

As a result of this integration:

- Certain internal dependencies will shift, requiring compatible build environments.
- Flags and environment variables could transition to Abseil equivalents.
- Some internal behavior may improve in performance and reliability but without changing user-facing APIs.

### 3.2 Migration Guidance

Users should:

- Prepare build configurations to include Abseil.
- Prefer newer APIs that align with Abseil usage.
- Monitor release notes for any deprecation of non-Abseil-aligned behaviors.

More information on Abseil integration can be found in [Platform Configuration and Internals API](https://google.github.io/googletest/api-reference/platform-configuration-and-internals/portability-and-configuration-api.html).

---

## 4. Future-Proofing Your Tests

To ensure your GoogleTest-based tests remain robust and forward-compatible:

- **Avoid deprecated macros and APIs.** Switch from legacy mocking macros to the `MOCK_METHOD` macro with qualifiers.
- **Use `ON_CALL` by default and `EXPECT_CALL` only to set call expectations you intend to verify.** This limits brittleness caused by over-specification.
- **Manage mock behavior strictness consciously:** Use `NiceMock`, `NaggyMock`, or `StrictMock` depending on need.
- **Regularly test under C++17 or later standards** to catch any compliance issues early.
- **Watch for flags or API changes related to Abseil and update your build and invocation scripts accordingly.**

---

## 5. Troubleshooting Common Deprecation Issues

### Problem: Compiler Errors From Legacy `MOCK_METHODn` Usage

**Solution:** Convert existing mocks to use the new `MOCK_METHOD` syntax. See [Mock Class API](https://google.github.io/googletest/api-reference/mocking-and-matcher-api/mock-class-api.html).

### Problem: Tests Fail Under C++17 or When Upgrading GoogleTest

**Solution:**
- Verify that your compiler supports C++17.
- Check for overriding issues, especially with qualifiers like `const` or `noexcept`.
- Adjust code to comply with the latest API requirements, particularly expectation chaining order.

### Problem: Unexpected Mock Failures Related to Strictness

**Solution:** Use `NiceMock` when uninteresting calls are safe to ignore or `StrictMock` when you want to catch all unplanned interactions. See [Mocking Patterns Guide](https://google.github.io/googletest/guides/mocking-and-mocking-patterns/mocking-patterns.html) for best practices.

---

## 6. Related Documentation & Resources

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — Beginner-friendly introduction to mocking
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes for advanced mocking scenarios
- [Breaking Changes & Migration Guidance](https://google.github.io/googletest/changelog/upgrade-and-migration/breaking-changes.html) — Details on migrating deprecated APIs
- [GoogleTest Portability and Configuration API](https://google.github.io/googletest/api-reference/platform-configuration-and-internals/portability-and-configuration-api.html) — Abseil integration overview
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) — Answers common questions on legacy issues

---

## 7. Summary

This page is essential for developers maintaining GoogleTest or GoogleMock-based test suites, providing critical insight into deprecated features, removal timelines, and the ongoing integration with Abseil. Following the guidance ensures your tests remain stable, maintainable, and benefit from modern C++ features and dependencies.

---

<Info>
Always ensure you refer to the latest release notes and migration guides during upgrade cycles to address deprecations efficiently and leverage new GoogleTest capabilities.
</Info>

<Check>
To identify deprecated usage in your codebase, enable warnings and test under the latest GoogleTest version with `--gtest_death_test_style=threadsafe` and appropriate verbose mocking flags.
</Check>

---

### Appendix: Example Migration from Legacy MOCK_METHODn to MOCK_METHOD

```cpp
// Legacy usage (deprecated):
class MockFoo : public Foo {
 public:
  MOCK_METHOD1(FooFunc, void(int));
  MOCK_CONST_METHOD0(GetValue, int());
};

// Modern preferred syntax:
class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, FooFunc, (int), (override));
  MOCK_METHOD(int, GetValue, (), (const, override));
};
```

---

### Appendix: Timeline for Abseil Integration

- Initial dependency on Abseil for core utilities introduced in recent releases.
- Plan for full migration of internal regex and flags to Abseil.
- Expected to require users to have compatible Abseil versions in upcoming major releases.

More detailed integration status available in the internal build documentation and upcoming release notes.

---

### Appendix: Using `ON_CALL` and `EXPECT_CALL` Correctly

```cpp
// Setting default behavior without enforcing a call expectation.
ON_CALL(mock_obj, Method(_)).WillByDefault(Return(default_value));

// Enforcing that a method is expected to be called once.
EXPECT_CALL(mock_obj, Method(42)).Times(1).WillOnce(Return(specific_value));
```

Refer to the [Expectations and Call Sequences](https://google.github.io/googletest/api-reference/mocking-and-matcher-api/expectation-api.html) for full details about chaining expectations and actions.

---

### Appendix: Controlling Mock Strictness

- `NaggyMock` (default): Warns on uninteresting calls.
- `NiceMock`: Silences warnings on uninteresting calls.
- `StrictMock`: Treats uninteresting calls as errors.

Choose based on desired test strictness level and maintainability goals (see [Nice, Strict, and Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)).
