---
title: "Deprecation Notices"
description: "Review features, macros, or APIs marked for deprecation and planned for eventual removal. Details include schedules, suggested alternatives, and practical examples, enabling users to phase out outdated constructs smoothly."
---

# Deprecation Notices

This page provides critical information about features, macros, and APIs that are marked for deprecation in the GoogleTest and GoogleMock frameworks. Users will find detailed schedules for their removal, suggested alternatives, and practical examples to facilitate a smooth transition away from outdated constructs. Understanding these deprecation notices is essential to maintaining compatibility and adopting better practices within your testing code.

---

## Understanding Deprecation in GoogleTest and GoogleMock

Deprecation signals that a feature, macro, or API is no longer recommended for use and will be removed in a future release. It is an important part of the framework’s evolution, allowing the maintainers to improve design and usability without forcing abrupt breaking changes.

### Why Pay Attention to Deprecations?

Ignoring deprecation notices can lead to:

- Compilation warnings that clutter build output.
- Future breakage when deprecated features are removed.
- Missing out on improved or safer alternatives.

By planning upgrades according to deprecation schedules, you maintain clean, maintainable, and forward-compatible test code.

---

## Commonly Deprecated Features

While specific features flagged for deprecation vary by release, certain patterns recur. The framework tends to deprecate:

- Old mock macros replaced by more expressive or safer variants.
- APIs that have safer or more idiomatic replacements (e.g., macro-based actions replaced by function objects or lambdas).
- Legacy constructions that complicate migration or slow compilation.

For example, old-style mock method macros like `MOCK_METHODn`, which have been superseded by the more versatile `MOCK_METHOD`, are deprecated in favor of the latter to improve clarity and conciseness.

---

## Transitioning Away from Deprecated APIs

### Example: Migrating from `MOCK_METHODn` to `MOCK_METHOD`

The generic `MOCK_METHOD` macro introduced in recent versions simplifies mock class declarations by allowing specification of return types, method names, arguments, and qualifiers in a clear, consistent format:

```cpp
// Deprecated style:
MOCK_METHOD1(Foo, bool(int));

// Preferred style:
MOCK_METHOD(bool, Foo, (int), (override));
```

**Tips for Migration:**

- Wrap complex argument types with parentheses or use type aliases to avoid parsing issues.
- Always place `MOCK_METHOD` declarations in the `public:` section of mock classes regardless of the original method’s access level.
- Use the additional qualifiers like `const`, `override`, and `noexcept` to accurately match the original method signature.

### Example: Replacing Deprecated Actions Macros

Legacy action macros like `ACTION()` and `ACTION_P()` have been largely replaced by using lambdas or function objects to express mock behavior. For better type safety and easier expression of side effects:

```cpp
// Deprecated style:
ACTION(IncrementArg1) { return ++(*arg1); }

// Preferred style:
EXPECT_CALL(mock, Foo()).WillOnce([](int* p) { return ++(*p); });
```

**Best Practices:**

- Prefer lambdas that capture local state or context explicitly.
- Use `Invoke()` with std::function, callables, or methods when passing complex behavior.

---

## Deprecation Schedule and Notices

### Scheduled Removal Timeline

Deprecations are announced in advance and removal typically occurs after several major releases to provide ample time for migration. Users are encouraged to refer to the version notes and the specific changelog entries for exact schedules.

### How to Track Deprecation Status

- Monitor compiler warnings about deprecated features.
- Review release-specific changelogs and deprecation notice pages.
- Use static analysis or build tools to identify usage of deprecated APIs in your codebase.

---

## Suggested Alternatives and Migration Guidance

### Use `MOCK_METHOD` over old `MOCK_METHODn` Macros

Adopt the new generic `MOCK_METHOD` macro for all mock declarations. It supports method qualifiers and complex argument types more gracefully.

### Favor Lambdas and Standard Callable Types instead of Legacy Actions

Replace old-style macro-defined actions with lambda expressions or functors, which provide better readability, maintainability, and compiler diagnostics.

### Avoid Using Deprecated `NiceMock`/`StrictMock` Patterns That Don’t Work With Inherited Methods

While `NiceMock` and `StrictMock` assist in managing uninteresting mock calls, be aware they only apply directly to methods declared with `MOCK_METHOD` in the immediate mock class. For inherited mocks, alternative strategies may be needed.

---

## Practical Examples Showing Migration Paths

### Migrating Mock Method Declarations

```cpp
// Old-style mock method
MOCK_CONST_METHOD1(GetValue, int(int));

// New style equivalent
MOCK_METHOD(int, GetValue, (int), (const, override));
```

When migrating, review method signatures carefully for const correctness and qualifiers.

### Replacing Deprecated Action Macros With Lambdas

```cpp
// Old-style
ACTION(ReturnFive) { return 5; }
EXPECT_CALL(mock, GetValue()).WillOnce(ReturnFive());

// New-style
EXPECT_CALL(mock, GetValue()).WillOnce([] { return 5; });
```

---

## Troubleshooting Common Issues During Migration

### Compilation Errors Due to Argument Parsing

If `MOCK_METHOD` complains about unprotected commas in arguments, wrap types with parentheses or use type aliases to clarify macro parsing.

### Unexpected Warnings on Mock Overrides

Ensure method qualifiers match the base class to prevent warnings, especially on MSVC where `const` top-level qualifiers on parameters can cause spurious messages.

### Unbinding or Ignoring Uninteresting Calls

Use `NiceMock<>` where appropriate to suppress warnings on uninteresting calls. Avoid suppressing warnings by adding spurious expectations.

---

## Best Practices and Recommendations

- **Plan migrations early:** Adopt new macros and idioms at the earliest possible release to avoid accumulating technical debt.
- **Read changelogs closely:** They include important deprecation notes and usage examples.
- **Incremental refactoring:** Use `ON_CALL` and `EXPECT_CALL` effectively to isolate parts of your tests requiring migration.
- **Leverage compiler warnings:** Enable warnings as errors to catch deprecated API usage.

---

## Additional Resources

- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) – Recipes and examples for mocking techniques, including migration tips.
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) – Answers to common questions about deprecated patterns.
- [Mock Method Macros Reference](/api_reference/mocking_core/mock_method_macros) – Detailed syntax and usage of `MOCK_METHOD`.
- [EXPECT_CALL and ON_CALL Reference](/api_reference/mocking_core/expect_call_on_call) – Guidance on setting expectations and behaviors for mock methods.

---

## Summary

This page outlines deprecation notices relevant to GoogleTest and GoogleMock users, focusing on migrating away from legacy macros and patterns toward modern, supported constructs. It guides users through common migration scenarios, practical examples, and best practices to maintain and improve test code quality and compatibility.
