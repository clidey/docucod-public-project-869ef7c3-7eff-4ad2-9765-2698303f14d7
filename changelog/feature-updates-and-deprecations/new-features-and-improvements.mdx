---
title: "New Features and Improvements"
description: "Highlight of significant new features and quality-of-life improvements delivered in recent releases. Includes pointers to new APIs, enhancements, and workflow optimizations aimed at making testing easier and more robust."
---

# New Features and Improvements

Welcome to the highlight page where we explore the significant new features and quality-of-life improvements introduced in recent GoogleTest releases. This page focuses specifically on updates that enhance your testing experience by expanding APIs, refining mock and expectation capabilities, and streamlining workflows for more effective, maintainable, and robust tests.

---

## Overview of Enhancements

### Expanding Mocking Flexibility and Usability
GoogleTest continues to evolve its mocking framework (gMock) to better serve the diverse needs of C++ developers. Recent improvements deliver more expressive and flexible ways to:

- Define mock classes and methods with enhanced syntax and extended qualifiers.
- Specify expectations with more nuanced control through new modifiers on `EXPECT_CALL` and `ON_CALL`.
- Manage call order and cardinality with increased granularity using sequences, partial orders, and richer cardinality specifications.

These improvements empower you to precisely verify interactions in your tests without incurring unwanted brittleness.

### New and Enhanced API Clauses

- **With Clause Enhancements**: The `.With()` clause on expectations now supports multi-argument matchers, allowing you to validate the relationship between arguments as a whole rather than individually. This facilitates sophisticated predicates, such as enforcing argument ordering or combined properties.

- **RetiresOnSaturation Clause**: You can now specify that an expectation 'retires' once its call limit is reached. This is crucial to defining expectations that should no longer match after being satisfied, reducing false positives in over-constrained tests.

- **Default Action Customization**: `ON_CALL` has become more powerful with constraints like `.With()` for targeted default behaviors and `.WillByDefault()` to set those behaviors explicitly.

### Move-Only Types Now Fully Supported
Mocking methods with move-only types (e.g., `std::unique_ptr`) is now seamlessly supported. This enables modern C++11 and beyond idioms to be fully integrated into your mocking setup, avoiding workarounds and ensuring your tests stay idiomatic and efficient.

### Strictness Mode Improvements
GoogleTest enhances the mocking strictness modes by making it easier to manage warnings and errors arising from uninteresting calls:

- **NiceMock** suppresses uninteresting call warnings.
- **NaggyMock** (default) emits warnings for uninteresting calls.
- **StrictMock** treats uninteresting calls as errors, enforcing stricter mock usage.

These options help you select the appropriate level of enforcement aligned with your testing phase — from rapid development to rigorous production-quality verification.

### Simplified Overloaded and Template Mocking
The `MOCK_METHOD` macro now elegantly handles overloaded methods and template classes, including necessary qualifiers (`const`, `override`, `noexcept`, reference qualifiers) for precise mocking matching the production declarations. This improvement alleviates common pain points in complex interfaces.

---

## User Workflow Enhancements

### Defining Mocks More Naturally
Craft mock classes by inheriting from your interfaces, then apply `MOCK_METHOD` with clear, consistent syntax. You can now use type aliases or parentheses smartly to handle complex types with commas in argument lists safely.

### Setting Expectations with Clarity
Set your expectations before exercising the code under test following this flow:

1. Use `ON_CALL` to establish default behaviors for mock methods without requiring call expectations.
2. Use `EXPECT_CALL` to specify explicit expectations including call count and call order.
3. Leverage `.Times()`, `.WillOnce()`, `.WillRepeatedly()`, `.InSequence()`, `.After()`, and `.RetiresOnSaturation()` to express call frequency and ordering precisely.

The framework enforces that expectations should be set prior to mock calls to ensure accurate verification and helpful diagnostics.

### Matching Arguments and Call Ordering
Use built-in and custom matchers with the enhanced `With` clause to validate intricate call parameters and relations. Control call sequences with sequences, `InSequence` objects, and partial orderings (`After` clauses).

### Managing Default Actions
Set well-defined fallback behaviors with `ON_CALL` to avoid unexpected side effects or warnings when uninteresting calls occur. Balance flexibility and strictness by choosing between nice, naggy, or strict mocks.

### Advanced Actions and Lambdas
Harness lambda functions or functors for your mock actions where canned responses with `Return()` or `ReturnRef()` are insufficient. This flexibility enables mock methods to simulate complex behaviors or state-dependent responses.

---

## Practical Tips and Best Practices

- Always declare `MOCK_METHOD` macros in the `public:` section of your mock class, even if the base class method is protected or private, to allow the mocking framework to access the method properly.

- Use type aliases or extra parentheses when mocking methods with argument or return types that include commas for unambiguous parsing.

- Prefer setting default behaviors with `ON_CALL` and assert expected mock interactions explicitly using `EXPECT_CALL` for clear, maintainable test specifications.

- Use `RetiresOnSaturation()` in sequences or repeated calls to prevent sticky expectations leading to errors when call limits are reached.

- Use `NiceMock` for suppressing noisy warnings during initial development; switch to `StrictMock` for strict enforcement before shipping your code.

- When mocking overloaded or templated methods, specify complete qualifier lists `(const, override)` or `(noexcept, override)` to match the production code signatures exactly.

- Avoid mock methods that are non-virtual; instead, use dependency injection with interfaces to enable effective mocking.

- To customize error verbosity, control the `--gmock_verbose` flag, ranging from `info` (most detailed) to `error` (least verbose).

---

## Troubleshooting

- If you see warnings about uninteresting calls, consider whether your tests need catching all calls explicitly or if you should use a `NiceMock`.

- If compile errors occur with move-only types in mocks, ensure you are using the latest GoogleTest version where move-only support is implemented.

- To debug failed expectations, run tests with `--gmock_verbose=info` to see detailed traces of mock method calls and matched expectations.

- If mock destructors are not called properly, verify base class destructors are virtual to avoid leaks and undefined behavior.

- When unexpected calls occur, consult the warning messages and stack trace output for clues on mismatched arguments or ordering.

---

## Additional Resources

For a deeper dive into GoogleTest mocking features, workflows, and concepts, explore these authoritative resources:

- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md) — Complete API and macros documentation
- [gMock Cheat Sheet](https://github.com/google/googletest/blob/main/docs/gmock_cheat_sheet.md) — Quick guide with examples
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md) — Practical recipes and advanced techniques
- [gMock for Dummies](https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md) — Beginner friendly introduction
- [Strictness and Mock Behavior](https://github.com/google/googletest/blob/main/api-reference/gmock-api/strictness-and-mock-behavior.md) — Understanding NiceMock, NaggyMock, and StrictMock

---

Use this page as your go-to reference to understand how GoogleTest's recent releases have enhanced the mocking capabilities and test workflow, helping you write better tests with less effort and more precision.

---