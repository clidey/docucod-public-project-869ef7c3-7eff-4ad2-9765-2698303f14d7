---
title: "Deprecations & Removals"
description: "Lists features, APIs, or options slated for removal or already deprecated, with recommended alternatives and timelines so users can phase out legacy patterns proactively."
---

# Deprecations & Removals

This page outlines features, APIs, and options within GoogleTest and GoogleMock that are deprecated or slated for removal. It guides users on phasing out legacy patterns proactively by providing recommended alternatives, deprecation timelines, and migration guidance.

---

## Overview

As GoogleTest evolves, certain older constructs, macros, and behaviors become deprecated to streamline the framework and improve reliability. This page helps you identify such deprecated features related specifically to mocking and testing macros, understand their impact on current and future versions, and adopt best practices to transition smoothly.

The focus here is on APIs and options that are:

- Planned for removal in future releases
- Already deprecated but still temporarily supported

Using this information ensures your tests remain maintainable, forward-compatible, and aligned with the latest framework conventions.

---

## Common Deprecated Features

### Legacy Mock Macro Family (`MOCK_METHODn`)

- The older family of macros like `MOCK_METHOD0`, `MOCK_METHOD1`, `MOCK_CONST_METHODn`, etc., are deprecated.
- **Recommended Replacement:** Use the new generic `MOCK_METHOD` macro instead.
  - Example:

```cpp
// Old-style (deprecated)
MOCK_METHOD1(Foo, bool(int));

// New-style (preferred)
MOCK_METHOD(bool, Foo, (int));
```

- Benefits of migration:
  - Simplifies macro usage
  - Better support for qualifiers like `const`, `override`, `noexcept`,
  - Improved handling of complex argument types and qualifiers

Refer to [Mocking Reference - MOCK_METHOD](https://github.com/google/googletest/blob/main/docs/reference/mocking.md#MOCK_METHOD) for detailed usage.

---

### Uninteresting Call Handling

- Default behavior generating warnings on uninteresting calls (mock methods without `EXPECT_CALL` matching the call) remains the default but is planned for refinement.
- **Alternatives:**
  - Use `NiceMock<T>` to suppress warnings on uninteresting calls.
  - Use `StrictMock<T>` to treat uninteresting calls as errors.

- It is strongly advised **not** to suppress uninteresting call warnings by adding indiscriminate `EXPECT_CALL` statements without proper intent, as this leads to brittle tests.

Detailed guidelines can be found under [The Nice, the Strict, and the Naggy](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#NiceStrictNaggy).

---

### Overloaded Methods: Explicit Disambiguation

- Implicit matching of overloaded mock methods can lead to ambiguities and warnings.
- **Deprecated Pattern:** Relying on the compilerâ€™s default overload resolution without specifying.
- **Recommended Pattern:** Explicitly disambiguate method overloads using `Const()` wrapper or explicit matcher casts.

Example:

```cpp
// Disambiguate const and non-const versions
EXPECT_CALL(mock, GetBar())  // Non-const
EXPECT_CALL(Const(mock), GetBar())  // Const
```

---

### Mocking Destructors

- `MOCK_METHOD` **does not support** mocking destructors.
- **Deprecated Pattern:** Trying to mock destructors directly.
- **Recommended Pattern:** Use a separate mock method called explicitly from the destructor to verify destruction order.

Example:

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, Die, ());
  ~MockFoo() override { Die(); }
};
```

This technique remains the standard for tracking destructor calls.

---

### Returning Move-Only Types in Mocks

- Legacy workarounds for mocking methods with move-only types (such as `std::unique_ptr`) by delegating to alternate mock methods with pointers are deprecated.
- **Recommended Pattern:** Use the new `MOCK_METHOD` macro directly with move-only types.

Example:

```cpp
class MockBuzzer : public Buzzer {
 public:
  MOCK_METHOD(std::unique_ptr<Buzz>, MakeBuzz, (StringPiece text), (override));
};
```

Newer GoogleMock versions support move-only types naturally, eliminating the need for workaround methods.

---

### Deprecated or Removed Flags and Macros

- Some older macros used for test registration and assertions are deprecated in favor of newer, more robust APIs.
- Deprecated macros related to test suite and test naming, e.g., usage of underscores in test suite or test names, should be avoided. Test suite and test names must not start or end with underscores and should avoid consecutive underscores to prevent naming conflicts.
- Deprecated internal implementation macros should not be used in user code.

For detailed rules, see the [GoogleTest FAQ](https://github.com/google/googletest/blob/main/docs/faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore).

---

## Deprecation Timelines and Migration Guidance

### Migration Workflow

- Adopt the new generic `MOCK_METHOD` macro for all new and existing mock methods.
- Refactor tests to replace deprecated macros and patterns with the latest APIs.
- Use `ON_CALL` for setting default behaviors and minimize `EXPECT_CALL` usages to reduce brittleness.
- When encountering uninteresting call warnings, prefer using `NiceMock` or explicit `EXPECT_CALL` with `Times(AnyNumber())` for methods that must allow calls with any arguments.
- When mocking destructors, use the recommended `Die()` method pattern.

### Verification

- Pay attention to compiler warnings about deprecated macros.
- When upgrading GoogleTest versions, review release notes for breaking changes related to mocking APIs.
- Use provided migration guides in the [Breaking & Migration](https://github.com/google/googletest/tree/main/docs/changelog/breaking-migrations) section for detailed upgrade instructions.

---

## Best Practices Moving Forward

- Always prefer the modern, flexible `MOCK_METHOD` syntax with qualifiers.
- Reserve `EXPECT_CALL` for expectations you explicitly want to verify.
- Use `ON_CALL` to define default mock behaviors without overconstraining tests.
- Avoid legacy mocking patterns that rely on old macros or delegate mock methods unless absolutely necessary.
- Keep test suite and test names simple and conform to naming conventions to avoid ambiguous or undefined behavior.

---

## Troubleshooting Deprecations

If your tests fail to compile or run due to deprecated features:

- Identify usage of `MOCK_METHODn` macros or deprecated expectations.
- Replace with the new `MOCK_METHOD` macro form.
- Check for unintentional usage of disallowed test suite or test names with underscores.
- Audit mocks to ensure destructor mocking is done via `Die()` method.
- For move-only argument or return types, verify your mock method signatures comply with modern patterns.
- Consult the [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md) and migration guides for specific details.

---

## Additional Resources

- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md)
- [Migration & Upgrade Guides](https://github.com/google/googletest/blob/main/docs/changelog/breaking-migrations/migration-upgrade.md)
- [Breaking Changes](https://github.com/google/googletest/blob/main/docs/changelog/breaking-migrations/breaking-changes.md)
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md)
- [GoogleTest FAQ](https://github.com/google/googletest/blob/main/docs/faq.md)

---