---
title: "Migration & Upgrade Guides"
description: "Step-by-step instructions and best practices for transitioning codebases when upgrading GoogleTest or GoogleMock. Includes tips on updating code, handling deprecated features, and verifying migration success."
---

# Migration & Upgrade Guides

Navigate your transition with confidence using these detailed, step-by-step instructions tailored for upgrading GoogleTest and GoogleMock codebases. This guide empowers you to update existing test suites smoothly while maintaining stability and harnessing improvements in newer versions.

---

## 1. Preparing for an Upgrade

Before diving into an upgrade, it’s essential to understand what you need to prepare. This foundation reduces errors and accelerates your migration process.

### 1.1 Review Current Version Compatibility
- Identify your current GoogleTest/GoogleMock version.
- Check the minimum C++ standard required by the target version (e.g., 1.17.x requires at least C++17).
- Confirm platform compatibility against the supported platforms list to avoid environment conflicts. Refer to [Supported Platforms](../docs/platforms.md).

### 1.2 Backup and Isolate Your Test Code
- Create backups of existing test directories and setup.
- Use version control branches for migration to isolate changes and enable rollback.

### 1.3 Assess Deprecated Features
- Review your code for deprecated APIs and macros.
- Consult the breaking changes and deprecation notices in the changelog to identify affected code.

---

## 2. Step-by-Step Migration Workflow

This section outlines a practical, user-centric workflow designed to manage upgrades effectively.

### Step 1: Update Dependencies and Build Configuration

- Upgrade your project’s build files (CMakeLists.txt, Bazel BUILD files, etc.) to refer to the desired GoogleTest/GoogleMock version.
- Ensure your compiler meets the updated version’s C++ standard requirements.
- Rebuild and verify that your build configuration completes without errors.

### Step 2: Update Test Code to New Mock Syntax

- Replace any legacy mock method macros (such as `MOCK_METHODx`) with the modern `MOCK_METHOD` syntax.
- If you use partial or hybrid mocks, carefully update to the recommended patterns.
- Unambiguous resolution for overloaded mock methods is required; explicitly specify type signatures where necessary.

### Step 3: Address Behavioral Changes in Mocks and Expectations

- Review use of `NiceMock`, `NaggyMock`, and `StrictMock` to adjust to the new strictness defaults.
- Update calls to use the latest default actions and handling for uninteresting calls.
- Confirm expectations' cardinalities align with new semantics, especially if migrating from older versions.

### Step 4: Replace Deprecated or Removed Features

- Identify and refactor code relying on deprecated GoogleTest features.
- Substitute any removed macros or functions with suggested alternatives.
-
### Step 5: Run and Validate Tests

- Execute your full test suite.
- Review test failures closely; read output to distinguish between genuine issues and migration artifacts.
- Fix errors that arise due to API changes or stricter mocking rules.

---

## 3. Best Practices for a Smooth Migration

### Use Incremental Updates
- Migrate in smaller increments rather than a full jump to avoid overwhelming complexity.

### Maintain Test Suite Stability
- Prioritize passing tests during migration for confidence.
- Keep CI pipelines running to catch regressions early.

### Leverage GoogleMock Tools
- Utilize verbose mocking logs to diagnose expectation mismatches.
- Explore mock verification utilities for insights.

### Document Your Changes
- Maintain clear records of update steps and code changes for future reference and team knowledge sharing.

---

## 4. Common Pitfalls and Troubleshooting

### Frequent Errors
- **Compile Errors Due to API Changes:** Usually caused by outdated mock macros or signatures.
- **Unexpected Test Failures:** Often relate to stricter mock expectations or deprecated behavior.
- **Linker Issues:** Stemming from improper upgrade of library references or incomplete rebuilds.

### Troubleshooting Tips
- Double-check mock definitions for correctness against the new macro syntax.
- Use the verbose output mode to pinpoint failing mock expectations.
- Clean build artifacts fully before rebuilding.
- Validate environment variables and flags, adapting to any changes in configuration requirements.

### Getting Help
- Consult the official migration changelog and breaking change pages.
- Review community issues on GitHub for similar upgrade experiences.
- Reach out to the community at googletestframework@googlegroups.com for advice.

---

## 5. Verifying Successful Migration

### Confirm Test Suite Completeness
- All tests should compile and link.
- Verified that all prior passing tests continue to pass.
- Investigate skipped or disabled tests to ensure none were inadvertently affected.

### Validate Behavioral Expectations
- Mock calls perform as intended with correct cardinalities and sequences.
- No unexpected warnings or errors related to mocking strictness.

### Regression Testing
- Run testing with extended coverage if possible.
- Perform manual validation on complex test cases that rely heavily on mocking.

---

## 6. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — Foundation for test writing.
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — Guide for mocking usage.
- [Changelog Breaking Changes](../breaking-changes.md) — Details on API changes and removals.
- [Mocking Best Practices](../../guides/advanced-patterns/mocking-pitfalls-best-practices.mdx) — Enhance mock usage.
- [Supported Platforms](../docs/platforms.md) — Confirm environment compatibility.

---

## Appendix: Quick Migration Checklist

- [ ] Verify compiler and platform version compatibility.
- [ ] Update build system dependency versions.
- [ ] Replace legacy mock macros with `MOCK_METHOD`.
- [ ] Review and fix expected call cardinalities and sequences.
- [ ] Remove or replace deprecated GoogleTest features.
- [ ] Fully rebuild the test suite.
- [ ] Run all tests and fix failures.
- [ ] Engage robust logging and verbose mocks to debug.
- [ ] Update documentation with migration notes.

---

By following these guides, your migration will not only be a technical upgrade but also an opportunity to improve test quality, maintainability, and future-proof your testing framework integration.