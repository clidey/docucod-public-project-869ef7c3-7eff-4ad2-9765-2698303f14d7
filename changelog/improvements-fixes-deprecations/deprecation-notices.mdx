---
title: "Deprecation Notices"
description: "Announcements regarding deprecated features, APIs or build flags, with timelines and migration advice. Helps users avoid deprecated patterns and future-proof their code."
---

# Deprecation Notices

This document outlines features, APIs, build flags, and behaviors in GoogleTest and GoogleMock that are deprecated or scheduled for removal. It aims to guide you through the timelines, migration paths, and best practices to keep your tests and mocks up to date with the latest stable GoogleTest releases.

---

## Understanding Deprecation

Deprecation signals that a feature or API is discouraged and may be removed or significantly changed in future releases. Continuing to use deprecated elements can result in compatibility issues, test failures, or unexpected behavior down the line.

GoogleTest and GoogleMock maintain backward compatibility carefully but encourage users to migrate away from deprecated functionality proactively.

---

## Key Deprecations and Migration Advice

### 1. Migration from Old `MOCK_METHODn` Macros

The legacy mocking macros `MOCK_METHODn`, `MOCK_CONST_METHODn`, and their variations have been deprecated in favor of the unified `MOCK_METHOD` macro introduced in 2018. The new macro supports function mocking with clearer syntax and better support for move-only types and qualifiers.

#### Why Migrate?
- Improved compiler error messages.
- Enhanced handling of method qualifiers (`const`, `override`, `noexcept`, etc).
- Cleaner syntax helps in reducing mock-related compile errors.

#### How to Migrate
- Replace
  ```cpp
  MOCK_METHOD1(Foo, bool(int));
  ```
  with
  ```cpp
  MOCK_METHOD(bool, Foo, (int));
  ```
- For const methods:
  ```cpp
  MOCK_CONST_METHOD1(Foo, bool(int));
  ```
  becomes
  ```cpp
  MOCK_METHOD(bool, Foo, (int), (const));
  ```
- For class templates or methods with call types, adapt similarly as documented in the [Mocking Reference](reference/mocking.md#MOCK_METHOD).

---

### 2. Strict Ordering of Modifier Clauses in `EXPECT_CALL` and `ON_CALL`

`EXPECT_CALL` and `ON_CALL` now enforce a strict order for modifier clauses such as `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()`.

#### Enforcement Details
- `.With()` must be the first clause and can appear only once.
- `.Times()` can only appear once and must be before `.WillOnce()` or `.WillRepeatedly()`.
- `.WillByDefault()` in `ON_CALL` must appear exactly once.
- `.RetiresOnSaturation()` can appear at most once and must be the last clause.

Violating these orders can result in compilation errors or runtime failures.

#### Migration
Review your `EXPECT_CALL` and `ON_CALL` specifications and reorder clauses accordingly. For example:

```cpp
// Correct order
EXPECT_CALL(mock, Func(_))
    .With(_)
    .Times(3)
    .WillOnce(Return(1))
    .WillRepeatedly(Return(2))
    .RetiresOnSaturation();
```

---

### 3. Uninteresting Calls Behavior and Strictness Wrappers

By default, GoogleMock mock objects emit warnings on uninteresting calls, i.e., calls that have no matching `EXPECT_CALL` expectations. This default 'naggy' behavior may be deprecated or adjusted in future releases.

#### Recommended Usage
- Use `::testing::NiceMock<T>` to suppress warnings on uninteresting calls when these are expected or harmless.
- Use `::testing::StrictMock<T>` when you want uninteresting calls to cause test failures.

#### Migration
Avoid relying on the default naggy behavior. Prefer explicit application of `NiceMock` or `StrictMock` wrappers.

---

### 4. Removal of Support for Variadic Function Mocking

Direct mocking of variadic functions (functions taking `...`) is unsupported and planned for removal. Alternative approaches include:
- Overloading the function to fixed-arity versions.
- Wrapping the variadic function behind an interface with mockable methods.

See the [Legacy gMock FAQ](docs/gmock_faq.md) for guidance.

---

### 5. Deprecation of `MOCK_METHOD` Usage Outside `public:`

`MOCK_METHOD` declarations must be inside the `public:` section of your mock classes regardless of the original method's access level. Failure to comply may cause undefined behavior or access compilation issues.

Audit your mock classes to ensure all mock method macros are under the public access specifier.

---

## Timeline for Deprecation and Removal

GoogleTest follows semver principles and deprecates features ahead of removal by at least one minor version cycle. Monitor release notes and the migration guides page for specific version numbers.

---

## Additional Best Practices to Avoid Deprecated Patterns

- Use the unified `MOCK_METHOD` macro with correct qualifiers.
- Set default actions using `ON_CALL`, and only use `EXPECT_CALL` when you need to verify that the method is called.
- Prefer `NiceMock` over default mocks to avoid uninteresting call warnings if those calls are expected.
- Establish clear expectations early in your test code, before invoking mocks.
- Avoid mixing old and new mocking macros or expect/call modifiers in inconsistent orders.

---

## Troubleshooting and References

If you encounter warnings or errors from deprecated features:

- Consult the [Migration Guides & Upgrade Tips](changelog/breaking-changes-migration/migration-guides.mdx).
- Review the [Mocking Reference](reference/mocking.md) for updated macro usage.
- Check the [Legacy gMock FAQ](docs/gmock_faq.md) for common legacy issues.
- Use `--gmock_verbose=info` for diagnostic messages related to mocks.

---

## Summary

This page helps maintain your test code by highlighting deprecated GoogleTest and GoogleMock features, providing detailed migration advice, and clarifying behavioral expectations. Staying informed ensures your test suite remains robust, efficient, and forward-compatible.


---

_For further details and examples, explore related documentation sections on [Mocking Reference](reference/mocking.md), [gMock Cookbook](docs/gmock_cook_book.md), [Breaking Changes & Migration](changelog/breaking-changes-migration/breaking-changes.mdx), and [Legacy gMock FAQ](docs/gmock_faq.md)._