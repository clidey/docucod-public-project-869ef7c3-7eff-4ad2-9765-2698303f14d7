---
title: "Breaking Changes & Migrations"
description: "Lists all backward-incompatible updates, changes in API behavior, or usage patterns that may require code modifications. Each item includes a clear description and practical migration advice, helping reduce upgrade effort and surprises."
---

# Breaking Changes & Migrations

This documentation page provides a comprehensive list of backward-incompatible updates, API behavior changes, and usage pattern modifications introduced in GoogleTest. It guides users through understanding potential impact on existing test code and offers practical migration advice to ensure smooth upgrades.

---

## 1. Introduction to Breaking Changes

Before upgrading to a newer GoogleTest version, it is crucial to review breaking changes to anticipate code modifications needed for continued compatibility. This page focuses exclusively on such changes relevant to writing and maintaining tests using GoogleTest and GoogleMock.

Most breaking changes are accompanied by detailed rationale, impact analysis, and step-by-step migration instructions to minimize disruption.

---

## 2. Notable Breaking Changes by Version

### Version 1.17.0: Mandatory C++17 Upgrade

- **Change**: Starting with version 1.17.0, GoogleTest requires compiling with at least the C++17 standard.
- **Impact**: Projects using older C++ standards will fail to build.
- **Migration Guidance**:
  - Update your build configuration (e.g., compiler flags in CMake or Bazel) to use C++17 or higher.
  - Verify that all dependencies and toolchains are compatible with C++17.
  - Review deprecated language constructs and update code as needed to conform to C++17.

### Test Suite and Test Names Restrictions

- **Change**: Underscores (`_`) in test suite or test names are disallowed to avoid conflicts and ensure uniqueness of generated class names.
- **Impact**: Existing tests with underscores in suite or test names may cause compilation or runtime errors.
- **Migration Guidance**:
  - Rename test suites and test names to remove or replace underscores.
  - Avoid leading or trailing underscores, and underscores adjacent to name boundaries.
  - Prefer descriptive names using camelCase or PascalCase instead.
  - See [GoogleTest FAQ - Naming Restrictions](../faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore) for detailed reasoning.

### Assertion Macros Strictness and Overloads

- **Change**: Certain `EXPECT_*` and `ASSERT_*` macros no longer support ambiguous overloads, particularly with `NULL` vs `nullptr` usage. For example, `EXPECT_NE(NULL, ptr)` is not supported.
- **Impact**: Tests using `NULL` in certain assertion macros may get compilation errors or undesired behaviors.
- **Migration Guidance**:
  - Replace all `NULL` in assertions with `nullptr` for pointer comparisons.
  - Use proper string comparison macros (`EXPECT_STREQ`, `EXPECT_STRNE`) instead of pointer-equality operators.
  - Prefer `EXPECT_THAT()` with matchers for complex conditions.
  - Review FAQ section on [NULL vs nullptr in assertions](../faq.md#why-does-googletest-support-expect_eqnull-but-not-expect_nenull) for detailed explanation.

### Default Death Test Style Change

- **Change**: The default death test style changed from "fast" to "threadsafe".
- **Impact**: Death tests may run slower but are less prone to thread-related flakiness.
- **Migration Guidance**:
  - For legacy behavior, set the flag explicitly:

    ```cpp
    GTEST_FLAG_SET(death_test_style, "fast");
    ```

  - For maximum safety and reproducibility, use the "threadsafe" default.
  - Ensure death tests create and clean up threads properly.
  - Name test suites containing death tests with the suffix `DeathTest`.
  - See [Death Tests Guide](../guides/scenarios-and-best-practices/death-tests-outcomes.md) for best practices.

### Fatal Assertions Usage Restrictions

- **Change**: Fatal assertions (`ASSERT_*`, `FAIL()`) can only be used in functions returning `void`.
- **Impact**: Using fatal assertions inside functions that return non-void types causes compilation errors.
- **Migration Guidance**:
  - Refactor such functions to be `void` returning if they contain fatal assertions.
  - Alternatively, replace fatal assertions with non-fatal ones (`EXPECT_*`) if function result must be meaningful.
  - Use `SetUp()` and `TearDown()` methods in test fixtures instead of constructors and destructors for code containing fatal assertions.
  - See [Advanced Topics - Assertion Placement](../advanced.md#assertion-placement) and FAQ on [constructor/destructor vs SetUp/TearDown](../faq.md#CtorVsSetUp).

### Test Fixture Hierarchy and Default Constructor Requirements

- **Change**: GoogleTest requires test fixtures to have accessible default constructors.
- **Impact**: Fixture classes without default constructors will fail when instantiated in tests.
- **Migration Guidance**:
  - Provide explicit default constructors for your test fixtures.
  - Ensure `DISALLOW_EVIL_CONSTRUCTORS()` or similar macros do not block default constructor creation.
  - Initialize `const` or non-default-constructible members properly in the constructor initializer list.
  - See [FAQ - Missing default constructor errors](../faq.md#i-have-a-fixture-class-but-test-fails-with-no-matching-constructor).

### Mixing TEST and TEST_F in Same Test Suite Disallowed

- **Change**: Tests inside the same test suite must all use the same fixture type (`TEST_F`) or be plain `TEST`; mixing the two is forbidden.
- **Impact**: Compiling or running suites mixing `TEST` and `TEST_F` with the same suite name will cause errors.
- **Migration Guidance**:
  - Make sure all tests in a suite use the same macro: either `TEST` or `TEST_F`.
  - Rename test suites or fixtures to disambiguate and separate tests as needed.
  - See FAQ for examples under [Mixing TEST and TEST_F](../faq.md#can-i-derive-a-test-fixture-from-another).

### Deprecated Macros and APIs

- **Change**: Some older macros like `INSTANTIATE_TEST_CASE_P` and `TYPED_TEST_CASE` have been deprecated in favor of `INSTANTIATE_TEST_SUITE_P` and `TYPED_TEST_SUITE`.
- **Impact**: Use of deprecated macros may cause warnings.
- **Migration Guidance**:
  - Replace deprecated macro invocations with their newer equivalents.
  - Adapt test code accordingly if naming or behavior slightly changed.
  - See [Advanced Topics - Value-Parameterized and Typed Tests](../advanced.md#typed-tests) for up-to-date usage.

### Test Parameter Names Must Avoid Underscores

- **Change**: Parameterized test name suffix generators should avoid underscores to prevent naming clashes.
- **Impact**: Using underscores in instance names or generated test names can lead to duplicate symbol errors.
- **Migration Guidance**:
  - Use only alphanumeric characters in parameter names.
  - Prefer camelCase or PascalCase for test names and instantiation prefixes.
  - Use custom name generators if needed to sanitize test parameter names.

### Mocking API Updates

- **Change**: Starting in recent versions, mocking APIs (`MOCK_METHOD`) require clearer usage of qualifiers and support for move-only types, and older `MOCK_METHODn` macros are deprecated.
- **Impact**: Legacy mocks may not compile or behave unexpectedly.
- **Migration Guidance**:
  - Replace old `MOCK_METHODn` macros with new `MOCK_METHOD` syntax.
  - Explicitly specify qualifiers like `(const, override)` as appropriate.
  - Use lambda-based actions for mocking methods with move-only argument or return types.
  - See the [gMock Cookbook](../docs/gmock_cook_book.md) for detailed transition examples.

### Matchers and Assertions Syntax Changes

- **Change**: Increased emphasis on using `EXPECT_THAT()` with matchers instead of traditional macros for richer, extensible assertions.
- **Impact**: Tests using simple `EXPECT_EQ` or `EXPECT_TRUE` with complex expressions may become harder to read and maintain.
- **Migration Guidance**:
  - Replace complex boolean checks with matcher-based assertions.
  - Write custom matchers for domain-specific predicates.
  - See [Matchers Reference](../reference/gmock-api/matchers-reference.md) and [Advanced Topics - Custom Assertions](../guides/advanced-testing-patterns/custom-assertions-and-matchers.md).

### Event Listener API Changes

- **Change**: Modifications in listener API to prevent recursive failures and improve ordering.
- **Impact**: Custom listeners that generate failures in `OnTestPartResult()` may cause unintended recursion or error.
- **Migration Guidance**:
  - Avoid generating failures in `OnTestPartResult()`.
  - Place failure-generating listeners after listeners that handle result reporting.
  - See [Advanced Topics - Event Listeners](../advanced.md#extending-googletest-by-handling-test-events).

---

## 3. Migration Checklist

To facilitate smooth migration, here are the practical steps to take:

- **Switch to C++17 or later** for your test projects.
- **Remove or replace underscore characters** in test suite and test names.
- **Replace usage of `NULL` pointers** in assertions with `nullptr`.
- **Ensure all test fixtures have a public default constructor**.
- **Use consistent test macros (`TEST` vs `TEST_F`) within the same suite**.
- **Update deprecated macros to modern equivalents** for parameterized and typed tests.
- **Adopt matcher-based assertions (`EXPECT_THAT`)** for expressive, maintainable tests.
- **Review and update mocking syntax** to use `MOCK_METHOD` and support move-only types.
- **Check death test naming and styles** and use appropriate death test flags.
- **Refactor any non-void functions with fatal assertions** to use void return type or non-fatal assertions.
- **Confirm event listener implementations follow new guidelines**.

Testing and CI processes should verify functionality after each migration step.

---

## 4. Common Pitfalls and Troubleshooting

### Compilation Errors Due to Deleted or Missing Constructors

Occurs when fixtures lack default constructors. Fix by explicitly adding them.

### Unexpected Test Failures After Name Changes

Ensure no conflicts or duplicated test suite names caused by renaming.

### Death Test Failures or Slowdowns

Check death test style flags and thread usage; prefer "threadsafe" style.

### Assertion Macro Misuse in Constructors or Non-void Functions

Refactor tests to comply with valid assertion placement rules.

### Mocking Failures with Old Syntax

Update to the latest `MOCK_METHOD` syntax; consult gMock Cookbook for examples.

### Underscore Name Collisions

Rename test parameters and suites to avoid underscores in problematic positions.

---

## 5. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [Assertions Reference](../reference/assertions.md)
- [Matchers Reference](../reference/gmock-api/matchers-reference.md)
- [gMock Cookbook](../docs/gmock_cook_book.md)
- [Advanced Testing Patterns Guide](../guides/advanced-testing-patterns/parameterized-and-typed-tests.md)
- [Death Tests Best Practices](../guides/scenarios-and-best-practices/death-tests-outcomes.md)
- [FAQ on Breaking Changes](../faq/advanced-usage/parameterized-and-death-tests-faq.md)

---

## 6. Summary

Upgrading GoogleTest requires attention to language standards, test naming conventions, assertion usage, and mocking syntax. Following the provided migration steps and consulting related guides ensures a smooth transition with minimal test disruptions.

---

<Tip>
Always back up your test code before applying major migrations, and incrementally verify after each change.
</Tip>

<Note>
Disabling or ignoring deprecation warnings temporarily can ease migration but plan to address them promptly to stay current.
</Note>

<Warning>
Failing to comply with fatal assertion placement rules may lead to unstable or undefined test behavior.
</Warning>

---

## 7. Example Migration Snippet

Before:

```cpp
class FooTest : public ::testing::Test {
 public:
  FooTest(int value) : value_(value) {}  // No default constructor

  int value_;
};

TEST_F(FooTest, TestWithUnderscore_Name) {
  ASSERT_EQ(NULL, ptr);
}
```

After:

```cpp
class FooTest : public ::testing::Test {
 public:
  FooTest() : value_(0) {}  // Added default constructor

  int value_;
};

TEST_F(FooTest, TestWithUnderscoreName) {  // Removed underscore in name
  ASSERT_EQ(nullptr, ptr);  // Use nullptr instead of NULL
}
```

---

## 8. Contact and Support

For questions about migrations or reporting issues, consult the [GoogleTest GitHub Issues](https://github.com/google/googletest/issues) page or community forums. Always include test code snippets and error logs to expedite resolution.

---

<Source url="https://github.com/google/googletest" />
