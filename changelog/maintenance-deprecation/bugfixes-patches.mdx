---
title: "Bug Fixes & Patch Releases"
description: "Chronicles known issues addressed, bugs resolved, and small refinements implemented in patch-level releases. Provides transparency around maintenance work and gives users the information needed to determine when minor upgrades are beneficial."
---

# Bug Fixes & Patch Releases

This page documents the maintenance releases of GoogleTest and GoogleMock focusing on bug fixes, resolved issues, and small refinements introduced in patch-level updates. It is intended to provide clear insights into corrective and incremental improvements that users can apply without major version upgrades.

---

## Overview

Patch releases primarily address user-reported bugs, regressions, compiler issues, and minor behavioral inconsistencies. These updates ensure reliability, compatibility, and smoother developer experience without altering core APIs or introducing breaking changes.

## Recent Bug Fixes and Improvements

### Fixed Issues in Recent Patch Releases

- **Uninteresting Call Warning Improvements**:修正了当mock对象中某些方法未设置期望（`EXPECT_CALL`）而被调用时的警告消息提示逻辑，使得用户更容易追踪潜在误用或漏设的期望。

- **Correct Evaluation Count in `ON_CALL` and `EXPECT_CALL` Macros**:确保 `ON_CALL` 和 `EXPECT_CALL` 宏中参数准确地只被求值一次，防止了因多次求值可能导致的副作用或性能问题。

- **Const Parameter Handling on MSVC**:解决微软编译器对`const`参数方法mock的警告提示问题，推荐用户移除顶级`const`修饰符以避免虚方法覆盖警告。

- **Move-Only Type Support Enhancements**:在mock方法接受或返回只可移动类型(`std::unique_ptr`, C++11 move-only)时优化其兼容性，允许直接使用标准`MOCK_METHOD`语法模拟，而无需复杂代理。

- **Proper Destructor Virtualization Check**:增强调试体验，提醒用户确保mock类基类的虚析构函数，以避免潜在资源泄漏和heap check失败。

- **Default Actions and Expectations Reset on `VerifyAndClear` Calls**:增强了`Mock::VerifyAndClearExpectations()` 和 `Mock::VerifyAndClear()`方法，确保调用后默认行为和期望被正确清除，不影响后续测试逻辑。

- **Thread-Safe Behavior Verification**:积累并改善了多线程环境下mock对象的线程安全性，确保mock动作调用在调用线程中执行，并避免死锁情况。

- **Strict, Nice, and Naggy Mock Mode Stability**:提升了`NiceMock`, `StrictMock`, `NaggyMock`的行为一致性和警告报告逻辑，帮助用户更好地控制mock警告和失败情况。

- **Sequence and Call Ordering Reliability**:加强了`InSequence`和`.After()`调用顺序约束的准确性和错误诊断提示能力，帮助用户定义和调试期望调用序列。

### Minor Refinements and Usability Fixes

- 参数匹配和复合匹配器逻辑的健壮性增强，如`.With()`多参数匹配器支持和右值捕获的改良。
- 自定义matcher、action和expectation可读性和错误消息输出改进，包含更清晰、上下文丰富的断言失败提示。
- 改进了对过多或过少定义动作时的提示警告，帮助用户识别配置失误。
- 修正了对重载方法、模板方法和带有调用约定修饰符的mock方法声明的处理，提升跨平台兼容性尤其是Windows平台。
- 简化使用模版定义的mock类生成，提高编译速度，减少代码膨胀。

## Best Practices When Updating

- **Incremental Upgrades Are Safe:** Patch releases do not introduce breaking changes.
- **Verify Virtual Destructors:** Always ensure base virtual destructors on mocked classes.
- **Use `VerifyAndClearExpectations()`:** When mock objects may outlive test scope or involved with asynchronous teardown.
- **Control Mock Verbosity:** Adjust `--gmock_verbose` flags to manage info, warning, and error output according to debugging needs.
- **Leverage `NiceMock` for Suppressing Uninteresting Call Warnings:** Avoid clutter unless you want strict checking with `StrictMock`.

## Troubleshooting Common Problems Addressed

<AccordionGroup title="Common Issue Fixes in Patch Releases">
<Accordion title="Uninteresting Call Warnings">
When you see spurious warnings for calls without matching `EXPECT_CALL`, review if you appropriately used `NiceMock` to suppress irrelevant warnings or added catch-all expectations using `.Times(AnyNumber())`.
</Accordion>
<Accordion title="Mock Method Const Parameter Warnings on MSVC">
If MSVC emits warnings for mock methods declared with `const` parameters, remove the redundant `const` from the parameter declarations, as C++ ignores top-level const for parameters and MSVC treats this differently.
</Accordion>
<Accordion title="Move-Only Type Mocking Errors">
Older code lacking support for mocking methods with move-only parameters should migrate to using the generic `MOCK_METHOD` macro syntax and leverage lambdas in `WillOnce` or `WillRepeatedly` to construct or handle move-only objects dynamically.
</Accordion>
<Accordion title="Expectation Ordering and Sticky Expectations">
Unexpected failures caused by expectations matching out-of-order or exceeding expected call counts can be resolved by using `.RetiresOnSaturation()` or grouping expectations with `InSequence` to enforce call order and expiration of expectations.
</Accordion>
</AccordionGroup>

## How to Access Patch Release Details

Detailed changelogs for each patch are maintained in the [GoogleTest GitHub releases](https://github.com/google/googletest/releases) including commit references and issue links. Users are encouraged to review these notes when deciding to adopt patches.

---

## Additional Resources

- For comprehensive guidance on mock creation and usage, see the [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md).
- To understand mock expectations and behaviors, consult the [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md).
- Troubleshooting tips on common issues and warnings are available in the [gMock FAQ](https://github.com/google/googletest/blob/main/docs/gmock_faq.md).
- Learn advanced features like sequences and action compositions in the [Mocking Advanced Guides](https://github.com/google/googletest/blob/main/docs/guides/mocking-advanced/getting-started-mocking.md).

---

By staying current with patch updates and aware of the fixes available, users can maintain stable, efficient, and predictable test suites using GoogleTest and GoogleMock.