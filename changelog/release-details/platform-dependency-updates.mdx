---
title: "Platform & Dependency Updates"
description: "Details dependencies (such as C++ standards or external libraries like Abseil), and notes changes in platform or toolchain support. Ensures users can plan for environment and configuration modifications when upgrading."
---

# Platform & Dependency Updates

This document details the platform and dependency requirements, updates, and compatibility considerations essential when upgrading or configuring GoogleTest and GoogleMock. It ensures you understand the necessary system environments, compiler toolchains, C++ standards, threading support, and third-party dependencies such as Abseil and RE2. By following this guide, you can anticipate and smoothly adapt to environment changes that impact build and runtime behavior of the testing frameworks.

---

## 1. C++ Standard Requirement

- GoogleTest and GoogleMock require a minimum of **C++17** support to build and run correctly.
- To enforce this, ensure your build system specifies:
  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```
- Older C++ standards are not supported and will produce compile-time errors.

<Check>
Confirm your compiler supports C++17 or later before building GoogleTest.
</Check>

## 2. Supported Platforms and Systems

GoogleTest and GoogleMock actively detect and adjust to a wide range of platforms. The frameworks define macros for platform detection internally to adapt to different environments:

- Windows (Desktop, MinGW, Mobile, Store Apps, Phone, RT, Games)
- Linux and Linux Android
- macOS and iOS
- FreeBSD, OpenBSD, NetBSD, DragonFlyBSD
- Solaris, AIX, HP-UX, z/OS
- Cygwin, GNU Hurd, Fuchsia
- Embedded platforms like ESP8266, ESP32, NRF52, Xtensa, NXP QN9090

The platform detection is automatic but can be overridden via compiler definitions.

See platform-specific macro definitions in the `gtest-port-arch.h` header.

<Info>
Refer to the Supported Platforms documentation for the complete list and supported versions.
</Info>

## 3. Threading Support and Synchronization

- GoogleTest supports multi-threaded tests if your system provides **pthread** support or native threading (Windows API).
- The build system tries to detect pthread availability automatically. You can override it with compiler flags `-DGTEST_HAS_PTHREAD=1` or `-DGTEST_HAS_PTHREAD=0` if detection fails.
- When pthread is enabled, the CMake scripts link with the appropriate thread libraries.
- On Windows, synchronization primitives rely on native Windows constructs.

<Tip>
If you encounter linking errors related to pthreads, verify your build configuration includes the right thread libraries and flags.
</Tip>

## 4. External Dependencies

### Abseil (Absl)

- When built with Abseil support (`GTEST_HAS_ABSL=1`), GoogleTest uses Abseil for string views, flags, and advanced regular expressions (RE2).
- If Abseil is enabled, the following dependencies are linked in:
  - `absl/flags`
  - `absl/strings`
  - `re2`
- Abseil integration enhances flexibility and feature support but requires the appropriate libraries and headers.

### Regular Expression Libraries

- GoogleTest supports multiple regex engines depending on platform and build options:
  - **RE2** (high-performance, used when Abseil is enabled)
  - POSIX Extended Regular Expressions (on most Unix-like platforms)
  - A simple built-in regex engine as fallback

<Note>
Using Abseil flags and RE2 requires additional linking and include paths. Consult your build system documentation to ensure proper setup.
</Note>

## 5. Build and Compiler Flags

- Compiler and linker flags are adjusted automatically via CMake macros defined in internal build utilities.
- On MSVC and Clang, flags for strict warnings, exception handling, and runtime linkage are tuned:
  - Static runtimes preferred unless overridden by `gtest_force_shared_crt` option
  - Warnings elevated to level 4 or higher
- On GCC and other compilers, warnings like `-Wall`, `-Wshadow`, and conversions are enabled by default.
- Exception handling and RTTI support detection occurs at build time to accommodate different compiler settings.

<Check>
If you have strict compiler policies, verify the exceptions and RTTI options, as GoogleTest relies on those in most builds.
</Check>

## 6. Shared Library (DLL) Support

- GoogleTest and GoogleMock can be built as either static libraries or shared libraries.
- To build as shared libraries, define the compile flag `-DGTEST_CREATE_SHARED_LIBRARY=1` and configure the linker accordingly.
- Tests that link to shared GoogleTest libraries must define `-DGTEST_LINKED_AS_SHARED_LIBRARY=1`.
- It is recommended to always define these flags appropriately to avoid future compatibility issues.

## 7. Flag Macros and Command-Line Flags

- Both GoogleTest and GoogleMock use macros to manage compiler flags and runtime flags.
- When built with Abseil support, flag definitions leverage Abseil's flag system.
- Without Abseil, flags are defined and referenced via macros such as `GTEST_DEFINE_bool_` and `GMOCK_DEFINE_bool_`.
- This ensures consistent configuration and ease of flag manipulation across platforms.

## 8. Platform-Specific Notes

- On embedded platforms such as ESP8266, ESP32, and NRF52, GoogleMockâ€™s main() integration differs and is adapted for Arduino style setup and loop functions.
- Windows Mobile and legacy platforms may have limitations, such as lack of certain filesystem or I/O features.
- Stream redirection is disabled on certain mobile and embedded platforms for robustness.

## 9. Build System Integration

- GoogleTest supports CMake and Bazel build systems with dedicated files and macros to set up platform-dependent flags.
- Package configuration files (`.pc` files) are generated and installed with necessary flags and paths.
- For CMake:
  - Pthread detection is automatic.
  - Runtime and shared/static linkage options are configurable.
  - Compiler flags are adjusted per detected compiler.
- For Bazel:
  - Platform constraints determine optional dependencies and compiler options.
  - Abseil and RE2 dependencies included conditionally.

## 10. Planning Your Upgrade or Build Environment

To ensure a smooth transition or setup:

- Verify your build tools support C++17.
- Confirm your platform is listed among supported platforms or has the necessary overrides.
- Check if you need to enable or disable pthread support explicitly.
- Consider whether you want Abseil integration and prepare dependencies accordingly.
- Decide on shared vs static linkage based on your project needs.

---

## Example: Specifying C++17 and Pthreads in CMake

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTestProject LANGUAGES CXX)

# Ensure C++17 is used
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Enable pthreads if available
find_package(Threads REQUIRED)

add_subdirectory(googletest) # or add your GoogleTest source

target_link_libraries(my_tests PRIVATE gtest_main Threads::Threads)

# Add shared library option
option(BUILD_SHARED_LIBS "Build using shared libraries" OFF)

# Force dynamic CRT in MSVC if desired
set(gtest_force_shared_crt ON CACHE BOOL "Force dynamic CRT")
```

## Troubleshooting Common Platform & Dependency Issues

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="Compiler version too old">
Ensure your compiler supports C++17. Update your compiler or switch to a newer version if errors indicate missing language features.
</Accordion>
<Accordion title="Threading detection failed">
Override pthread detection by defining `-DGTEST_HAS_PTHREAD=1` or `-DGTEST_HAS_PTHREAD=0` manually.
Check your linker flags to include `-pthread` or equivalent.
</Accordion>
<Accordion title="Linker errors with shared libraries">
Verify that both the GoogleTest library and your test code define the shared library flags consistently.
Ensure the runtime library linkage matches (static vs dynamic).
</Accordion>
<Accordion title="Platform macro conflicts or misdetections">
If building on a new or uncommon platform, you may need to define or adjust platform macros like `GTEST_OS_LINUX` manually.
Refer to `gtest-port-arch.h` for expected macros.
</Accordion>
</AccordionGroup>

---

## References & Additional Resources

- [GoogleTest Supported Platforms & Compatibility](../overview/introduction-getting-started/supported-platforms)
- [GoogleTest Build Configuration Guide](../getting-started/preparation-installation/build-configuration)
- [Platform Detection Header (`gtest-port-arch.h`)](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port-arch.h)
- [GoogleTest Portability Utilities (`gtest-port.h`)](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h)
- [GoogleMock Portability Utilities (`gmock-port.h`)](https://github.com/google/googletest/blob/main/googlemock/include/gmock/internal/gmock-port.h)
- [Abseil Flags Integration](https://abseil.io/docs/cpp/guides/flags)
- [RE2 Regular Expression Library](https://github.com/google/re2)

---

For detailed release notes about platform and dependency changes, see the [Platform & Dependency Updates changelog page](/changelog/release-details/platform-dependency-updates).

<Check>
Always consult the changelog before upgrading your build environment to anticipate breaking changes or new requirements.
</Check>

---

*This page ensures you are fully equipped to plan and execute upgrades or fresh builds with correct platform dependencies and configurations.*
