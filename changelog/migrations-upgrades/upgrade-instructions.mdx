---
title: "Upgrade Instructions & Migration Steps"
description: "Step-by-step guides to upgrading to recent versions, including handling of language standard requirements, configuration updates, and test adaptation strategies. Ensures upgrades are as smooth and predictable as possible."
---

# Upgrade Instructions & Migration Steps

GoogleTest continuously evolves to improve functionality, maintain compatibility with modern C++ standards, and refine testing capabilities. This guide provides clear, step-by-step instructions to upgrade your existing GoogleTest projects to recent versions smoothly. It addresses language standard requirements, configuration changes, and test code adaptations to make your migration predictable and low-risk.

---

## 1. Language Standard Requirements

### C++17 Minimum Requirement

Starting with recent versions, GoogleTest mandates C++17 or higher for compilation. This ensures compatibility with modern language features and improvements in standard libraries.

- **Action:** Ensure your build system sets the C++ standard to C++17 or later.
- **CMake example:**
  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```
- **Manual build:** Pass `-std=c++17` or equivalent compiler flag.

<Tip>
Building with a language standard lower than C++17 leads to compilation errors and undefined behavior. Upgrading your compiler and build system appropriately is essential before migration.
</Tip>

## 2. Configuration and Build System Updates

### Updated CMake Options

GoogleTestâ€™s CMake build system introduces refined options affecting features such as GoogleMock inclusion and shared/static library builds.

- Verify your CMake configuration includes the necessary options, e.g.:  
  - `-DBUILD_GMOCK=ON` to include GoogleMock.
  - `-DGTEST_CREATE_SHARED_LIBRARY=1` if building shared libraries.

### Compiler and Linker Flags

- Review custom compiler flags to align with GoogleTest's recommendations, especially ensuring:
  - Correct handling of runtime libraries (for example, MSVC `gtest_force_shared_crt` flag).
  - Support for C++17 features and disabling conflicting flags.

### Dependency Updates

- Confirm all submodules or external dependencies like GoogleMock and Abseil are updated and consistent with the GoogleTest version.

<Warning>
Build failures during upgrade often stem from inconsistent compiler settings or missing dependencies. Use the provided troubleshooting guides to diagnose these issues.
</Warning>

## 3. Migrating Test Code

### Updating Test Macros

- **Parameterized Tests:**
  - Replace deprecated macros `MOCK_METHODn` with the new unified `MOCK_METHOD` syntax.
  - Ensure parameterized and typed tests use the current macros like `TEST_P`, `INSTANTIATE_TEST_SUITE_P`.

### Handling Deprecated Features

- Review breaking change notices, as some macros and APIs might be deprecated or removed.
- Replace deprecated assertions and test fixtures following migration instructions.

### Adjusting for UTF-8 Handling

- New versions enforce strict UTF-8 compliance in test names and data.
- Update test identifiers and string literals to UTF-8 where necessary.

<Tip>
Always consult the [Breaking Changes & Deprecations](https://github.com/google/googletest/blob/main/docs/changelog/migrations-upgrades/breaking-changes.md) page for the current deprecations and recommended replacements before migrating.
</Tip>

## 4. Integration & Extension Adjustments

### GoogleMock APIs

- Verify that mock classes use the updated `MOCK_METHOD` macro with proper qualifiers.
- Transition from old-style mocks to the new syntax for better compatibility and maintainability.

### Build Integration

- If your project integrates GoogleTest into CI/CD pipelines, validate that test executables and runners handle new command-line flags and environment variables properly.

- Update any custom event listeners or reporters using the Test Fixtures and Reporting APIs as per current documentation.

## 5. Migration Workflow

### Step-by-Step Upgrade Flow

<Steps>
<Step title="Prepare Your Environment">
- Update compiler to support C++17 or higher.
- Upgrade your build tools (e.g., CMake 3.14+).
</Step>
<Step title="Update GoogleTest Sources">
- Pull the latest GoogleTest repository or download the release tarball.
- Update submodules for GoogleMock and other dependencies.
</Step>
<Step title="Configure Build System">
- Adjust CMake lists or build scripts to target C++17.
- Enable or disable GoogleMock as needed.
</Step>
<Step title="Refactor Test Code">
- Replace deprecated macros and APIs.
- Convert parameterized tests to use modern macros.
- Ensure test names and data comply with UTF-8.
</Step>
<Step title="Rebuild and Run Tests">
- Compile your test suite.
- Fix compilation errors or warnings.
- Run tests and verify all pass.
</Step>
<Step title="Review Logs and Output">
- Enable verbose mock logging (`--gmock_verbose=info`) if debugging.
- Ensure no deprecated features warnings or unrecognized flags errors.
</Step>
</Steps>

<Tip>
Establish a dedicated upgrade branch or clone to avoid interrupting ongoing development. This also facilitates rollback in case challenges arise.
</Tip>

## 6. Troubleshooting & Common Pitfalls

### Missing Symbols or Link Errors

- Check for consistent linkage of GoogleTest and GoogleMock libraries across your build.
- Confirm thread-related library flags (`-lpthread` or equivalent) especially on Linux/macOS.

### Compilation Failures Due to Language Standards

- Verify that all targets compile with C++17 or above.
- Check for `MOCK_METHOD` parsing errors; wrap complex template types in parentheses or typedef them.

### Unhandled Deprecated API Usage

- Refer to deprecation notices to revise your test code.
- Avoid using removed macros and switch to the recommended updated counterparts.

<Note>
The [Common Installation & Setup Issues](https://github.com/google/googletest/blob/main/docs/getting-started/troubleshooting-common-issues/common-installation-issues.md) and [Compilation & Linking Errors FAQ](https://github.com/google/googletest/blob/main/docs/faq/troubleshooting-optimization/compilation-linking-errors-faq.md) are valuable resources during upgrade troubleshooting.
</Note>

## 7. Additional Resources

To make migration effective and understand the impact of changes, consult the following documentation:

- [Breaking Changes & Deprecations](../migrations-upgrades/breaking-changes.md)
- [Upgrade Instructions & Migration Steps](../migrations-upgrades/upgrade-instructions.md)
- [Feature Additions & Improvements](../release-history/feature-additions.md)
- [Bug Fixes and Patches](../release-history/bug-fixes-patches.md)
- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Integration & Extensibility Overview](../../overview/features-and-integration/integration-overview.md)


---

## Summary

This page provides a practical, user-focused guide covering upgrade prerequisites, migration best practices, and stepwise workflows for adapting your GoogleTest projects to the latest versions. Emphasis is placed on C++17 support, modern macro usage, and handling deprecations to ensure seamless transitions without disruption.

---

<Callouts>
<Tip>
Commit to reviewing the related breaking changes and migration notes before upgrading to avoid surprises.
</Tip>
<Warning>
Avoid mixing old and new API styles in the same test codebase to prevent maintenance complexity.
</Warning>
</Callouts>

---

For more on topics covered in this guide, see also:

- [Core Testing API](../../api-reference/core-testing-api/test-macros-framework.md)
- [Mocking Framework API](../../api-reference/mocking-framework-api/mock-classes-methods.md)
- [Assertion Models and Test Outcomes](../../core-concepts/test-foundations/assertion-models.md)

---

*Last updated with GoogleTest version 1.17.0 and GoogleMock corresponding changes.*

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/changelog/migrations-upgrades/upgrade-instructions.md", "range": "1-100"}]} />
