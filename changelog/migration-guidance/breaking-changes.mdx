---
title: "Breaking Changes"
description: "A summary of non-backward-compatible changes, with clear migration steps and code examples illustrating new patterns. Ensures a smooth transition when updating across major versions."
---

# Breaking Changes

This page compiles all non-backward-compatible changes in GoogleTest's major releases, providing you with clear migration paths, insights into new API patterns, and practical code examples to ensure a seamless upgrade experience. Whether you are updating across major versions or integrating new features, this guide is your essential companion to avoid disruptions and harness improvements effectively.

---

## Understanding Breaking Changes

Breaking changes represent modifications that may cause existing code or tests to fail or behave differently after upgrading GoogleTest. These often include:

- **API removals or renames**
- **Changed behavior of macros or functions**
- **Modifications to class structures or interfaces**
- **Deprecated functionality replaced by new patterns**

Upgrading without acknowledging breaking changes can lead to compilation errors or subtle test failures.


## How This Page Helps You

- Provides a curated list of breaking changes affecting test development and mocking.
- Offers **step-by-step migration instructions** that prioritize your code correctness and maintainability.
- Supplies concrete **code snippets illustrating new usage patterns** replacing deprecated or removed APIs.
- Highlights common pitfalls encountered during migration and solutions to avoid them.


## Recent Breaking Changes

### Version 1.17.0 — C++17 Requirement and API updates

- **C++17 Baseline:** The 1.17.0 release requires a compiler supporting C++17 or later. Ensure your build environment is updated accordingly.

- **Test Suite Terminology Change:**
  - The older `TestCase` concept is replaced with `TestSuite` to better align with contemporary nomenclature.
  - The previously used `TEST_CASE` APIs are deprecated in favor of `TEST_SUITE` variants.
  
- **Macro Renaming:**
  - The use of `TEST_F()` remains but the recommendation is to favor `TEST_SUITE`-aligned naming conventions where applicable.

- **Mocking Macro Update:**
  - The generalized `MOCK_METHOD` macro replaces older `MOCK_METHODn` variants, using a cleaner, more intuitive syntax:

```cpp
// Old style:
MOCK_METHOD1(Foo, bool(int));

// New style:
MOCK_METHOD(bool, Foo, (int));
```

Migration entails adapting your mock classes to use the new `MOCK_METHOD` format.


### Migration Example: Updating MOCK_METHOD Usage

Before (old macro style):
```cpp
class MockFoo {
 public:
  MOCK_METHOD1(Foo, bool(int)); // Deprecated
};
```

After (new macro style):
```cpp
class MockFoo {
 public:
  MOCK_METHOD(bool, Foo, (int));
};
```


### Changed Behavior of Assertion Macros

- **ASSERT_* vs EXPECT_*:**
  - GoogleTest continues to differentiate between fatal (`ASSERT_*`) and non-fatal (`EXPECT_*`) assertions.
  - Ensure that if your tests previously relied on early returns from `ASSERT_*`, your upgrade keeps the correct control flow.


### Removal of Deprecated APIs

- Certain deprecated APIs and macros have been **removed** to simplify the codebase and promote standard usage.
- Refer to the [Primer](https://google.github.io/googletest/primer.html) for updated, best-practice ways to write tests and assertions.


## Migration Steps

Follow these practical steps to upgrade your GoogleTest usage safely:

<Steps>
<Step title="Prepare Your Environment">
Ensure your compiler supports C++17 or later. Update your build system accordingly, such as adjusting CMake settings to use `set(CMAKE_CXX_STANDARD 17)`.
</Step>
<Step title="Update Test Suite Syntax">
Replace deprecated `TEST_CASE` and `TEST_CASE_F` usages with `TEST_SUITE` or continue with `TEST()` and `TEST_F()` as appropriate.
</Step>
<Step title="Revise Mocks to Use New MOCK_METHOD Syntax">
Systematically update all mock classes from the old `MOCK_METHODn` macros to the newer, clearer `MOCK_METHOD` macro as shown in examples.
</Step>
<Step title="Review Assertion Usages">
Verify that fatal and non-fatal assertion macros (`ASSERT_` and `EXPECT_`) are used correctly to maintain test control flows after migration.
</Step>
<Step title="Test and Debug">
Run your test suite with increased verbosity (`--gtest_verbose=info`) to identify any unexpected behaviors or failures introduced during migration.
Use `SCOPED_TRACE` or other diagnostics to isolate and fix issues promptly.
</Step>
</Steps>


## Common Pitfalls and Tips

- **Ignoring RUN_ALL_TESTS() Return Value:**
  - Always ensure that your `main()` function returns the result of `RUN_ALL_TESTS()`. This is critical for correct CI integration and detecting test failures.

- **Naming Conventions:**
  - Avoid underscores in test suite or test names to align with style guidance.
  - Consistently name your test suites and fixtures to reflect the structure of tested components.

- **Handling Mock Method Overloads:**
  - When mocking overloaded methods, use explicit disambiguation techniques to avoid compilation errors.

- **Using ON_CALL vs. EXPECT_CALL:**
  - Define default behaviors with `ON_CALL`, and only use `EXPECT_CALL` when verifying calls; this approach leads to more resilient and maintainable tests.


## Code Example: Updated Test Fixture and Test

```cpp
#include <gtest/gtest.h>

class QueueTest : public ::testing::Test {
 protected:
  void SetUp() override {
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

This code matches the updated API expectations in the latest GoogleTest versions.


## Troubleshooting Migration

<AccordionGroup title="Breaking Changes Troubleshooting">
<Accordion title="Compilation Errors After Updating MOCK_METHOD">
If you encounter errors related to `MOCK_METHOD`:

- Confirm you replaced all old-style `MOCK_METHODn` macros with the new `MOCK_METHOD` syntax.
- Wrap complex argument types containing commas in extra parentheses or use `using` aliases.
</Accordion>
<Accordion title="Test Failures Due to Assertion Changes">
Review your test cases for correct use of `ASSERT_*` and `EXPECT_*` macros.
Remember that `ASSERT_*` aborts the current function immediately, affecting control flow.
</Accordion>
<Accordion title="Unexpected Behavior in Test Suites">
Check for lingering deprecated TestCase usages and update them to TestSuite patterns.
Verify your fixture setup and teardown align with the new lifecycle.
</Accordion>
</AccordionGroup>


## Additional Resources and References

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — Understand core concepts and APIs.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Guidance for mocking best practices and advanced usage.
- [Assertions Reference](../reference/assertions.md) — Detailed list of assertion macros.
- [Mocking Reference](../reference/mocking.md) — Details on mock classes and expectations.
- [Release Notes on GitHub](https://github.com/google/googletest/releases) — Official changelogs.


---

Ready your upgrade with confidence by following this guide, and enjoy the robust features and improvements of the latest GoogleTest releases.


---

*Last updated: GoogleTest v1.17.0 and later*