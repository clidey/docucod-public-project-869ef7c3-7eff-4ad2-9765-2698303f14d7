---
title: "Deprecations"
description: "List features, APIs, or behaviors marked for deprecation, including their removal timelines and recommended alternatives. This page assists users in proactively refactoring tests before deprecations turn into removals."
---

# Deprecations

This page provides a comprehensive overview of features, APIs, and behaviors in GoogleTest and GoogleMock that have been marked for deprecation. It is designed to help users proactively adapt their tests and mocking strategies before deprecated elements are removed in future releases.

## Purpose of Deprecations

Deprecations signal that certain components are planned to be phased out. They often include replacement recommendations or migration paths, ensuring you can maintain robust and future-proof tests.

By reviewing this page, you can anticipate upcoming removals, prevent sudden disruptions, and align your code base with current best practices.

---

## Deprecated Features and Behaviors

### 1. Legacy MOCK_METHODn Macros

- **What is deprecated?**
  - The old family of macros named `MOCK_METHOD0`, `MOCK_METHOD1`, ..., `MOCK_CONST_METHODn`, and their variations that were used before the introduction of the new `MOCK_METHOD` macro.

- **Why is this deprecated?**
  - The unified `MOCK_METHOD` macro introduced in 2018 simplifies mock method declarations and supports more features like qualifiers, constness, noexcept, and reference qualifiers.

- **Recommended alternative:**
  - Use the modern `MOCK_METHOD` macro with the improved syntax for defining mock methods.

- **Effect on users:**
  - Existing codebases using legacy macros should migrate to the new macro for better maintainability and compatibility with new GoogleTest versions.


### 2. Unprotected Commas in MOCK_METHOD Arguments

- **What is deprecated?**
  - Usage of `MOCK_METHOD` with argument or return types containing unprotected commas (e.g., template types like `std::pair<bool, int>` directly, without enclosing parentheses).

- **Why is this deprecated?**
  - It causes parsing errors or undefined behavior during macro expansion.

- **Recommended alternative:**
  - Enclose such types in parentheses or use type aliases to avoid comma-related parsing issues.

- **Example:**

  ```cpp
  // Deprecated (causes errors):
  MOCK_METHOD(std::pair<bool, int>, GetPair, ());

  // Correct approach:
  MOCK_METHOD((std::pair<bool, int>), GetPair, ());
  // Or
  using BoolIntPair = std::pair<bool, int>;
  MOCK_METHOD(BoolIntPair, GetPair, ());
  ```


### 3. Using Macros Without `override`, `const`, or Other Qualifiers

- **What is deprecated?**
  - Omitting method qualifiers when overriding virtual methods in mock classes.

- **Why is this discouraged?**
  - Qualifiers like `override` improve code correctness by enabling the compiler to catch mismatches. GoogleTest mandates explicit qualifier usage in `MOCK_METHOD` macros.

- **Recommended approach:**
  - Always specify the correct qualifiers such as `(const, override)` or `(override)` as the last parameter list to `MOCK_METHOD`.


### 4. Expectation Clause Ordering

- **What changed?**
  - GoogleTest now enforces runtime checking of the order in which clauses appear in `EXPECT_CALL()` statements.

- **What is deprecated?**
  - Writing expectations with clauses out of the prescribed order.

- **Clause order to follow:**
  - `.With()`, `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, `.RetiresOnSaturation()`

- **Effect on users:**
  - Ensure your expectations follow this order to avoid runtime errors or undefined behavior.


### 5. Behaviour of Uninteresting Calls and Mock Wrappers

- **What is deprecated?**
  - The old default behavior where uninteresting calls (calls to mock methods without expectations) produced warnings or silent passes without user control.

- **What to use now?**
  - Use `NiceMock` to suppress warnings on uninteresting calls.
  - Use `StrictMock` to treat uninteresting calls as failures.

- **Note:**
  - The `NaggyMock` default behavior emits warnings on uninteresting calls; usage of `NiceMock` or `StrictMock` is now recommended for clearer test behavior control.


### 6. Mocking Non-Virtual Functions by Changing Them to Virtual

- **Why deprecated?**
  - Making non-virtual methods virtual solely for mocking breaks design principles, decreases performance, and couples tests tightly to implementation.

- **Recommended alternative:**
  - Use gMock's support for mocking non-virtual methods via templates where appropriate.
  - Refactor code to introduce interfaces and mock those instead.


### 7. Specific Deprecated Practices in GoogleTest/Wide Usage

- Avoid using underscores in test suite and test names due to reserved identifiers and risk of name collisions. Instead, use CamelCase or other naming schemes.
- Deprecated use of `NULL` in pointer assertions with `EXPECT_EQ` and `ASSERT_EQ`; prefer `nullptr` to avoid subtle type-related issues.


### 8. Deprecated Default Exception Handling

- GoogleTest historically did not support exceptions in assertions.
- Platforms that enable exceptions recommend using `ASSERT_THROW` / `EXPECT_THROW` macros explicitly.


## Removal Timelines and Migration Paths

Where possible, GoogleTest communicates the expected version where deprecated features will be removed. Users should monitor release notes and upgrade guides for detailed timelines.

- **Legacy MOCK_METHODn Macros:** Migration recommended as soon as possible. Removal may occur in upcoming major releases.
- **Clause Ordering:** Starting with recent releases, runtime enforcement is active. Fix existing violations before upgrade.
- **Uninteresting Calls Behavior:** Usage of `NiceMock` or `StrictMock` should be adopted to manage warnings/errors explicitly.

For extensive migration guidance, consult the [Breaking Changes](breaking-changes.html) and [Upgrade Guides](upgrade-paths.html) pages.

## Practical Tips and Best Practices

- Begin all mock method declarations with the new `MOCK_METHOD` macro including qualifiers.
- Wrap complex return or argument types with parentheses or type aliases to avoid parsing issues.
- Use `nullptr` instead of `NULL` in assertions involving pointers.
- Use clear naming conventions that avoid underscores in test and test suite names to prevent reserved identifier conflicts.
- Leverage `NiceMock` to maintain quiet tests when you do not want to assert strict call counts.
- Employ `StrictMock` when you want to catch all unexpected calls immediately.
- Follow the documented order for clauses in `EXPECT_CALL` to ensure your tests behave correctly.
- Avoid mocking concrete implementations when possible; code to interfaces and mock those.

## Troubleshooting Deprecated-Related Issues

If you encounter warnings or errors related to deprecations:

1. **Verify usage of deprecated macros:** Replace old `MOCK_METHODn` with new `MOCK_METHOD`.
2. **Check clause ordering:** Ensure `.Times()`, `.WillOnce()`, etc., appear in the proper order.
3. **Address warnings about uninteresting calls:** Wrap mocks in `NiceMock` or add catch-all `EXPECT_CALL` patterns.
4. **Inspect test and suite naming:** Avoid underscores to prevent internal naming conflicts.
5. **Replace `NULL` with `nullptr`:** Modernize pointer assertions.

If needed, consult the [Mocking Reference](reference/mocking.md), [Using Mocks Correctly](guides/core-workflows/using-mocks-correctly.md), and [gMock Cookbook](gmock_cook_book.md) for examples and detailed advice.

---

## Related Documentation

- [Breaking Changes](breaking-changes.html): Details on breaking API and behavior changes.
- [Upgrade Guides](upgrade-paths.html): Step-by-step instructions for migrating across versions.
- [Mocking Reference](reference/mocking.md): Full reference of mocking APIs.
- [Using Mocks Correctly](guides/core-workflows/using-mocks-correctly.md): Best practices for mocking workflows.
- [gMock Cookbook](gmock_cook_book.md): Practical recipes for using GoogleMock.
- [Assertions Reference](reference/assertions.md): Guide to assertion macros.

For developer insights, see the [Legacy gMock FAQ](docs/gmock_faq.md) and [GoogleTest FAQ](docs/faq.md).

---

For direct source and examples, visit the GoogleTest GitHub repository at [https://github.com/google/googletest](https://github.com/google/googletest).

---

_Last updated: Please check the latest official release notes for updated deprecation statuses._