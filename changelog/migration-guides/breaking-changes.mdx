---
title: "Breaking Changes & Required Migrations"
description: "Detailed explanations of changes that may affect existing code, such as required minimum C++ standards, API revisions, default behavior changes, and removed functionality. Includes before/after code examples where relevant and points to migration resources."
---

# Breaking Changes & Required Migrations

This page provides detailed explanations of breaking changes that may impact your existing codebases when upgrading GoogleTest and GoogleMock. It addresses requirements such as newly enforced minimum C++ standards, revisions to public APIs, changes in default behaviors, and removal of previously supported features. This documentation includes before-and-after code snippets where applicable and points you to additional migration resources to ensure your transition is as smooth as possible.

---

## 1. Minimum C++ Standard Requirement

GoogleTest and GoogleMock now **require C++17** as the minimum standard to compile successfully. Attempts to build with earlier C++ standards will result in a compilation error.

### What This Means for You:

- Ensure your compiler and build configuration use at least C++17 features.
- For example, when using `g++` or `clang++`, add `-std=c++17` or higher to your compiler flags.
- MSVC users should confirm that the project is targeting VS2017 Update 3 or later with C++17 enabled.

### Migration Example:

**Before (may compile with C++14):**
```bash
g++ -std=c++14 my_test.cc -lgtest -lgmock
```

**After (required):**
```bash
g++ -std=c++17 my_test.cc -lgtest -lgmock
```

### Failure Message Example:

```plaintext
#error C++ versions less than C++17 are not supported.
```

This enforcement improves compatibility, modernizes the codebase, and leverages C++17 language features.

<Note>
If you maintain a project that supports earlier standards, you will need to isolate or version GoogleTest/GoogleMock usage or upgrade your code accordingly.
</Note>

---

## 2. API Revisions & Deprecated Functions

Certain internal macros and APIs, particularly those in namespaces or files marked as internal (e.g., `internal::` namespaces or headers like `gtest-port.h`), may have changed or be removed. These are *not* part of the public API and should not be used directly.

### Key Points:

- GoogleTest and GoogleMock have clarified and restricted usage of internal macros and classes.
- Code relying on APIs inside `testing::internal` or those with trailing underscores (e.g., `GTEST_HAS_*`) must be reviewed and updated.
- Public testing APIs (those without trailing underscores and not in internal namespaces) remain stable.

### Recommended Action:

Audit your code and ensure it only depends on public GoogleTest and GoogleMock APIs documented officially.

---

## 3. Default Behavior Changes

### 3.1 Death Test Style Default

The default death test style has been updated from **`fast`** to **`threadsafe`** for improved reliability in multi-threaded environments.

- This affects test executions involving death tests (`EXPECT_DEATH`, `ASSERT_DEATH`).
- You can override the death test style programmatically or via flags:

```cpp
GTEST_FLAG_SET(death_test_style, "threadsafe");  // Set in main or test
```

or via command line:

```
--gtest_death_test_style=threadsafe
```

The `threadsafe` style may run tests slower due to added process isolation but avoids common hangs and deadlocks in complex multi-threaded test environments.

### 3.2 Verbosity Flag Behavior

The verbosity flag for GoogleMock (`--gmock_verbose`) now clearly distinguishes three levels:

| Level    | Description                                  |
| -------- | -------------------------------------------- |
| info     | Prints all informational messages, warnings, and errors including stacks.
| warning  | Prints warnings and errors (default level), no stack traces.
| error    | Prints errors only, suppresses warnings.

This change enables better control over diagnostic outputs during test runs.

---

## 4. Removed or Deprecated Functionality

- Certain rarely-used internal macros or flags with low adoption may be removed in future versions.
- Consult the [Deprecations & Removal Notices](../migration-guides/deprecations) page for specific details.

---

## 5. Migration Tips & Resources

To handle breaking changes effectively and update your code:

- Start by upgrading your build environment to require C++17.
- Remove or replace any direct use of internal-only GoogleTest/GoogleMock APIs.
- Review your death tests and consider explicitly setting death test style for stability.
- Control verbosity settings using the updated `--gmock_verbose` values.

### Helpful Links:

- [GoogleTest Primer](../getting-started/configuration-and-first-use/writing-first-test)
- [GoogleMock for Dummies](../getting-started/configuration-and-first-use/using-googlemock-basics)
- [Expectations and Actions](../api-reference/mocking-api/expectations-actions)
- [Core Concepts and Terminology](../overview/intro-concepts/core-concepts-terminology)
- [Deprecations & Removal Notices](../changelog/migration-guides/deprecations)

---

## 6. Example: Updating Your Test Setup

If your tests fail to compile due to C++ standard version:

```diff
- g++ -std=c++14 test.cpp -lgtest -lgmock
+ g++ -std=c++17 test.cpp -lgtest -lgmock
```

If your code uses internal macros:

```cpp
- #if GTEST_HAS_PTHREAD
+ #if defined(GTEST_HAS_PTHREAD) && GTEST_HAS_PTHREAD
```

If you want to explicitly set the death test style:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
+  GTEST_FLAG_SET(death_test_style, "threadsafe");
  return RUN_ALL_TESTS();
}
```

---

## 7. Troubleshooting Common Issues

### Compilation Fails with C++ Version Error

- Confirm compiler supports C++17 (`__cplusplus >= 201703L`).
- Adjust your build toolchain accordingly.

### Unexpected Behavior in Death Tests

- Set `--gtest_death_test_style` explicitly if you see hangs.
- Check for multi-threading conflicts outside death tests.

### Unrecognized Macros or Flags

- Verify you are not using internal or removed definitions.
- Replace deprecated flags according to migration guides.

---

If further assistance is needed, consult the [Getting Help and Reporting Issues](../../faq/help-community/faq-getting-help) page for community resources and official supports.

---

*This concludes the documented breaking changes and required migrations for GoogleTest and GoogleMock. For comprehensive upgrade guidance, always refer to the latest release notes and migration guides linked throughout our documentation.*
