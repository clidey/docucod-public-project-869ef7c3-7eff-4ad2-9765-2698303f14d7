---
title: "Upgrade Guides"
description: "Step-by-step instructions and practical advice for migrating to recent releases, especially across major version boundaries. Covers C++ standard updates, integration notes, and tooling considerations."
---

# Upgrade Guides

Welcome to the Upgrade Guides page. Here, you'll find clear, step-by-step instructions and practical advice to help you smoothly migrate your projects to recent releases of GoogleMock and GoogleTest. This guide focuses especially on transitions that cross major version boundaries, ensuring you understand key changes including updates to the C++ standards support, integration notes, and tooling considerations.

---

## Why Upgrade?

As GoogleMock evolves, we introduce improvements that leverage modern C++ standards, refine mocking behaviors, and enhance tooling support. Upgrading ensures that you benefit from the latest features, improved reliability, and maintain compatibility with evolving build environments.

---

## What to Expect in This Guide

- **Step-by-step migration instructions** for upgrading your test code and build configurations.
- **Details on C++ standard updates**, including implications when moving to C++17 and later.
- **Integration notes** relevant to common build systems and project setups.
- **Tooling considerations** to streamline your upgrade process.

This guidance is targeted specifically at users maintaining or migrating their GoogleMock-based mocks and tests.

---

## Upgrading Across Major Version Boundaries

When moving between major versions of GoogleMock, some changes might cause incompatibilities if not addressed. Below is a structured approach to ensure you navigate these efficiently.

### Step 1: Review Breaking Changes

Consult the [Breaking Changes documentation](https://github.com/google/googletest/blob/main/docs/changelog/migration-upgrade/breaking-changes.md). Key areas often involve:

- Transition to the unified `MOCK_METHOD` macro replacing older macro variants.
- Changes in expectation stickiness behavior requiring adjustment in test expectations.
- Requirements for mock methods being publicly accessible.

### Step 2: Adopt C++17 or Later

Recent releases have updated minimum C++ standards compliance. GoogleMock now fully assumes C++17 support. Take note:

- Ensure your compiler and build tools are compatible with C++17 or newer.
- Update your build configurations accordingly (e.g., `-std=c++17` for GCC/Clang).

Refer to the [System Requirements](https://github.com/google/googletest/blob/main/docs/getting-started/requirements-installation/system-requirements.md) for full compatibility information.

### Step 3: Update Mock Class Definitions

- Replace old-style `MOCK_METHODn` macros with the new, generic `MOCK_METHOD` macro.
- Ensure mocks follow the recommended patterns, including use of qualifiers like `(override)`, `(const)`, and others where applicable.
- Leverage helpers like `NiceMock`, `NaggyMock`, and `StrictMock` to control uninteresting call behavior (see [Nice, Strict, and Naggy Mocks](https://github.com/google/googletest/blob/main/docs/api-reference/mocking-apis/nice-strict-mocks.md)).

### Step 4: Update Test Expectations

New versions enforce expectations and call order more strictly by default.

- Verify that `EXPECT_CALL()` usages correctly specify expectations before mock method invocation.
- Use sequencing tools such as `InSequence` and `Sequence` for ordered calls.
- Utilize `.RetiresOnSaturation()` on expectations when needed to control expectation lifetime.

See [Specifying Expectations and Actions](https://github.com/google/googletest/blob/main/docs/guides/mocking-and-behavior-verification/specifying-expectations-and-actions.md) for best practices.

### Step 5: Adjust Tooling and Build Settings

- Update your build scripts to include the latest GoogleTest/GoogleMock headers and libraries.
- Initialize GoogleMock appropriately in your test runner (e.g., call `InitGoogleMock` before running tests).
- Manage flags like `--gmock_verbose` for debugging and test output verbosity.

For initialization details, visit [Test Runner Initialization and Main Entrypoints](https://github.com/google/googletest/blob/main/docs/api-reference/infrastructure-and-internals/test-runner-entrypoint.md).

---

## Tips and Best Practices for a Successful Upgrade

- **Run your existing test suite frequently** during migration to catch regressions early.
- **Incrementally migrate mocks and tests**, focusing on critical paths first.
- **Use diagnostic flags** such as `--gmock_verbose=info` to gain insight into call matching and expectation verification.
- **Consult the gMock Cookbook** for real-world recipes that help address common mocking patterns and scenarios.

---

## Common Pitfalls and Troubleshooting

- **Unvirtualized destructors:** Ensure all mocked interfaces have virtual destructors to prevent undefined behavior.
- **Overly strict expectations:** Over-constraining tests can lead to brittle failures; use `ON_CALL` and `EXPECT_CALL` appropriately.
- **Compiler compatibility:** Confirm that your compiler fully supports C++17 features to avoid compilation errors.
- **Mixing legacy and modern APIs:** Avoid mixing old macros with the new `MOCK_METHOD` macro to maintain consistency.

For further troubleshooting, see [Troubleshooting Common Issues](https://github.com/google/googletest/blob/main/docs/getting-started/validation-troubleshooting/common-issues.md).

---

## Practical Example: Migrating a Mock Class

Before (Legacy):

```cpp
class MockFoo : public Foo {
 public:
  MOCK_CONST_METHOD1_T(GetData, int(int key));
  MOCK_METHOD2_T(SetData, void(int key, int value));
};
```

After (Modern):

```cpp
#include <gmock/gmock.h>

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetData, (int key), (const, override));
  MOCK_METHOD(void, SetData, (int key, int value), (override));
};
```

Usage of `NiceMock` to suppress uninteresting call warnings:

```cpp
using ::testing::NiceMock;

NiceMock<MockFoo> mock_foo;
EXPECT_CALL(mock_foo, SetData).Times(1);
// ... test code ...
```

---

## Additional Resources and References

- [Breaking Changes](https://github.com/google/googletest/blob/main/docs/changelog/migration-upgrade/breaking-changes.md)
- [Deprecations & Sunset Notices](https://github.com/google/googletest/blob/main/docs/changelog/migration-upgrade/deprecations.md)
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md)
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/api-reference/mocking-apis/defining-mocks.md)
- [Specifying Expectations and Actions](https://github.com/google/googletest/blob/main/docs/guides/mocking-and-behavior-verification/specifying-expectations-and-actions.md)
- [System Requirements](https://github.com/google/googletest/blob/main/docs/getting-started/requirements-installation/system-requirements.md)

---

Upgrade your GoogleMock tests confidently with this guide to ensure your testing harness remains robust, maintainable, and aligned with the latest GoogleTest ecosystem capabilities.


<Call>
For in-depth migration help, see our [Breaking Changes Guide](https://github.com/google/googletest/blob/main/docs/changelog/migration-upgrade/breaking-changes.md) and the [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md).
</Call>
