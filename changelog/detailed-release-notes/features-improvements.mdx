---
title: "Features & Improvements"
description: "Summarize all new capabilities, enhancements, and usability improvements introduced in each release, with references to related files and implementation details where possible. Helps users leverage the latest advancements."
---

# Features & Improvements Changelog

Welcome to the Features & Improvements changelog page. Here, you will find detailed, user-centric summaries of all new capabilities, enhancements, and usability improvements introduced in every release of GoogleTest and GoogleMock. This documentation is crafted to help you understand what has changed, why these changes matter, and how to leverage the latest advancements effectively in your testing workflows.

---

## Overview of Features & Improvements

GoogleTest and GoogleMock evolve continuously to serve C++ developers with a robust, flexible, and efficient test and mocking framework. Each release brings new features that improve test expressiveness, ease of mock definition, better control of behavior and expectations, and enhanced diagnostics.

This page focuses specifically on these feature additions and enhancements, rather than bug fixes or platform compatibility notes, enabling you to stay updated on the powerful new tools at your disposal.

---

## Recent Releases Highlights

### Version 1.17.0 and Later
- **C++17 Minimum Standard:** Starting from release 1.17.x, GoogleTest and GoogleMock require at least C++17, allowing adoption of modern language features improving both framework internals and user-facing APIs.
- **Improved Mocking Syntax and Flexibility:** New improvements to the `MOCK_METHOD` macro increase expressiveness and usability, especially with complex types and qualifiers.
- **Enhanced Action and Matcher Support:** Users can now compose more intricate mock behaviors by leveraging expanded built-in actions and matchers, including support for move-only types and richer return value models.
- **Default Behavior Customization:** The `ON_CALL` and `EXPECT_CALL` macros have received syntax improvements ensuring stricter and clearer semantics about call expectations and default actions.

### Domain-Specific Language Enhancements
- Assertions and expectations can now be expressed more naturally, with clearer rules around cardinality inference and method overload disambiguation.
- Retiring expectations with `.RetiresOnSaturation()` become more intuitive, allowing expectations to cleanly retire once saturated, preventing spurious failures in complex mock scenarios.

### Advanced Mocking Patterns Support
- Full support for mocking templated classes, overloaded functions, and methods with complex calling conventions.
- Introduction of flexible sequencing models using `Sequence` and `InSequence` to enforce call order and partial ordering via the `After` clause.
- Ability to delegate default actions to real or fake objects, letting users mix mocked and real behaviors gracefully.

### Concurrency and Thread Safety Improvements
- Explicit guidance and synchronization behavior ensure safe and predictable mock behavior in multi-threaded tests.
- Actions and expectations execute in the calling thread context, preserving thread safety invariants.

### Diagnostics and Debugging
- Enhanced verbosity levels (`--gmock_verbose=info|warning|error`) give users finer control over mock call logging.
- Detailed failure reports include matched expectations, call ordering issues, and argument mismatch explanations.

---

## Key Features and Enhancements Details

### MOCK_METHOD Macro Enhancements
- Simplified syntax supports method qualifiers such as `const`, `override`, `noexcept`, and reference qualifiers through a unified 4th parameter.
- Improved handling of method signatures with commas (e.g., template types or pairs) via wrapping with parentheses or aliasing.
- Supports mocking of all virtual methods, including private or protected ones (via placing `MOCK_METHOD` in the public section).
- Clear guidance on mocking overloaded methods using `Const()` and matcher type disambiguations.

### Expectation Syntax and Semantics
- `EXPECT_CALL` allows chaining of clauses like `With()`, `Times()`, `InSequence()`, `After()`, `WillOnce()`, `WillRepeatedly()`, and `RetiresOnSaturation()`.
- Cardinalities are automatically inferred to simplify common scenarios.
- Multiple expectations on the same method are resolved with the rule 'last declared matching expectation takes precedence.'
- Sticky expectations by default, with options to retire explicitly or via sequencing.

### Default Actions and ON_CALL
- `ON_CALL` specifies default behavior without imposing call count expectations.
- Supports `WillByDefault` and optional `With` clauses.
- Latest matching `ON_CALL` action takes precedence.

### Mock Class Modifiers
- Support for `NiceMock`, `NaggyMock`, and `StrictMock` to control handling of uninteresting calls.
- These modifiers adjust whether warnings are printed or whether uninteresting calls cause test failures, improving test noise control.

### Advanced Mocking Constructs

- **Delegating to Fakes and Real Objects:** Mocks can delegate method calls to real or fake implementations, allowing retention of existing logic with validation of interaction.
- **Mocking Move-Only Types:** Methods can mock functions involving `std::unique_ptr` and other move-only objects by use of lambdas or action factories.
- **Custom Actions and Matchers:** Users can define new matchers with `MATCHER` macros or full matcher classes and create custom actions using lambdas, functors, or by implementing the action interface.

### Ordering and Dependency Management
- Call expectations can be strictly ordered with sequences or conditionally ordered via `.After` clauses.
- Expectation sets (`ExpectationSet`) allow grouping and composition of interdependent calls.

### Diagnostics and Test Assistance
- Running tests with `--gmock_verbose=info` provides a detailed trace of all expectations and calls, facilitating troubleshooting.
- Complex failures include exact expectation and call stack details helping users pinpoint broken interactions.

### Performance and Build Improvements
- Compilation speed enhancements by moving mock class constructors and destructors out of headers.
- Less template bloat and clearer diagnostics reduce build bottlenecks.

---

## Practical Tips for Users

- Use `ON_CALL` to define the default behavior shared by many tests, reserving `EXPECT_CALL` for assertions to avoid brittle tests.
- Use `.RetiresOnSaturation()` to avoid sticky expectations causing unexpected failures when call counts reach their limits.
- Prefer `NiceMock` for general-purpose mocks to reduce noisy warnings.
- For strict validation of mock calls, use `StrictMock`.
- When mocking overloaded methods, disambiguate using `Const()` or explicit matcher types.
- Use sequences wisely to specify order constraints that matter, avoiding brittle overly-constrained tests.
- Remember to give your mock classes a virtual destructor to avoid runtime issues.

---

## Troubleshooting Common Pitfalls and Guidance

- Avoid setting expectations after mock method calls; set `EXPECT_CALL`s upfront.
- Beware of side-effects in mock actions; expressions in `WillOnce(Return(n++))` are evaluated once when expectation is set, not on every call.
- Use `ReturnPointee` to return live (evaluated at call time) values instead of cached copies.
- Beware that `NiceMock` and `StrictMock` apply only to mock methods declared directly in the mock class.
- Avoid mocking non-virtual methods directly; instead, consider the high-perf dependency injection pattern or introduce interfaces.

---

## Additional Resources and Links

- [Mock Method Macros Reference](../api_reference/mocking_core/mock_method_macros) for comprehensive macro usage.
- [EXPECT_CALL and ON_CALL Reference](../api_reference/mocking_core/expect_call_on_call) for detailed expectation syntax and semantics.
- [NiceMock, NaggyMock, StrictMock Reference](../api_reference/mocking_core/nice_naggy_strict_mocks) for controlling mock behavior on uninteresting calls.
- [Matchers Reference](../api_reference/matchers_assertions/builtin_matchers) for rich argument matching capabilities.
- [Actions Reference](../api_reference/actions_and_advanced/standard_actions) for built-in and custom mock method behaviors.
- [gMock for Dummies Guide](../docs/gmock_for_dummies.md) for a beginner-friendly understanding of mocking.
- [gMock Cookbook](../docs/gmock_cook_book.md) for advanced recipes and patterns.
- [Understanding Mock Expectations and Sequences](../concepts/core-models/mock-expectations) for conceptual mastery.

---

## Source Code and Reference Implementation

For detailed reference, see the [gmock-spec-builders_test.cc](../googlemock/test/gmock-spec-builders_test.cc) which tests the spec builder syntax of `EXPECT_CALL` and `ON_CALL`. It provides concrete examples of usage, error conditions, and edge cases.

---

We recommend regularly checking this page and related release notes to stay informed on new enhancements that can make your tests more expressive, maintainable, and robust.

Happy testing with GoogleTest and GoogleMock!
