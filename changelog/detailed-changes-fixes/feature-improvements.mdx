---
title: "Feature and Performance Improvements"
description: "Enumerates enhancements to core framework capabilities, optimizations, and smaller feature additions, allowing users to exploit new options for better test ergonomics and speed."
---

# Feature and Performance Improvements

This page details significant improvements and additions to GoogleTestâ€™s core framework features, performance optimizations, and smaller enhancements. These updates empower users with new capabilities to write tests more ergonomically and to execute tests more efficiently, enabling scalable and robust C++ testing.

---

## 1. Enhanced Assertion Capabilities

GoogleTest has expanded its assertion macros and helper functions to provide richer diagnostics and flexibility when writing tests.

- **Improved Floating-Point Comparisons:** Introduced a robust template-based floating point comparison (FloatingPoint class) that tolerates tiny differences using ULPs (Units in the Last Place). This replaces naive equality checking in assertions like `EXPECT_FLOAT_EQ` and `EXPECT_DOUBLE_EQ`.

- **Rich String Comparison:** Failed string assertions now generate detailed diffs using unified diff representations to clarify exact differences in expected vs actual values.

- **Boolean Assertion Failure Messages:** New utilities provide clearer failure messaging for boolean assertions, aiding in root cause diagnosis.

- **User Message Appending:** Assertions support appending user-supplied messages seamlessly, making failures more descriptive and actionable.

## 2. Advanced Parameterized and Typed Testing

Significant extension of support for parameterized and typed tests to reduce test code duplication and improve coverage:

- **Value-Parameterized Tests:** Macros like `TEST_P`, `INSTANTIATE_TEST_SUITE_P`, and parameter generators have been enhanced to support complex parameter combinations including custom name generators.

- **Type-Parameterized Tests:** Rich API support for defining typed test suites (`TYPED_TEST_SUITE`) and type-parameterized test suites (`TYPED_TEST_SUITE_P`), with compile-time and runtime registration helpers. Users can define type lists and generate test fixtures instantiated across these types easily.

- **Name Generation Flexibility:** Ability to provide custom name generators for parameterized tests, allowing meaningful test names based on test parameters.

- **Dynamic Registration:** Template-based utilities facilitate dynamic test registration, bringing runtime flexibility to test suite composition.

## 3. Thread Safety and Concurrency Improvements

GoogleTest has improved its thread safety guarantees, especially on POSIX and Windows platforms:

- **Mutex and Synchronization:** Platform-specific mutex implementations ensure safe test execution in multi-threaded scenarios. Google Test automatically uses appropriate synchronization primitives based on platform capabilities.

- **Thread-Local Storage:** Template-based `ThreadLocal<T>` supports per-thread storage for test fixtures and internal data, preventing race conditions.

- **Scoped Trace in Multithreading:** `SCOPED_TRACE` supports concurrent threads, maintaining separate trace stacks per thread to give detailed, thread-specific failure traces.

## 4. Streamlined Test Registration and Execution

- **Test Factory Abstractions:** Introduction of abstract factory classes for creating test instances dynamically improves extensibility and enables advanced test registration patterns.

- **SuiteApiResolver:** Mechanism to manage legacy and new test suite setup/teardown functions, ensuring compatibility and correctness during test lifecycle.

- **Improved Test Result Handling:** More detailed per-test and per-suite result tracking allows users to query granular test outcomes, execution times, and properties.

- **Automatic Test Discovery:** Enhancements to automatic test registration reduce boilerplate code. Template metaprogramming supports recursive registration of typed test suites.

## 5. Utilities and Helper Enhancements

- **Edit Distance Algorithms:** Internal `edit_distance` namespace provides algorithms to compute optimal string edits, used for better diff-based failure messages.

- **Native Array and Container Support:** Adaptors for native arrays facilitate container matcher support in GoogleMock.

- **Random Number Generator:** A simple Linear Congruential Generator (LCG) for internal randomized features, avoiding dependencies on global state.

- **AssertHelper Class:** Enables seamless streaming of failure messages into assertion macros, improving developer ergonomics when reporting test failures.

- **Platform Portability Macros:** Extensible macros detect operating system and compiler features to adapt GoogleTest behavior accordingly.

## 6. Recommended Best Practices and Tips

- Always use `TEST_P` and `INSTANTIATE_TEST_SUITE_P` together to fully utilize value-parameterized tests.
- Use typed tests (`TYPED_TEST_SUITE`) when you need to validate code over a range of types.
- Leverage `SCOPED_TRACE` especially in multi-threaded tests to clarify assertion failure context.
- Provide custom name generators for parameterized tests to improve test result readability.
- Use `ASSERT_*` macros when asserting preconditions critical to test execution to fail fast.
- Avoid mixing legacy `SetUpTestCase`/`TearDownTestCase` methods; migrate to `SetUpTestSuite`/`TearDownTestSuite` for modern compatibility.

## 7. Common Pitfalls and Troubleshooting

- Trying to use `GetParam()` outside `TEST_P` or `TestWithParam` derived classes leads to runtime errors; ensure proper fixture inheritance.
- Mixing test fixture classes in tests within the same suite may cause test registration failures.
- Using parameter generators without instantiation (`INSTANTIATE_TEST_SUITE_P`) results in no tests running; use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` to suppress warnings if intentional.
- Beware of dangling references when using `ConvertGenerator` with lambdas capturing string references.

## 8. Example: Writing a Value-Parameterized Test

```cpp
class FactorialTest : public ::testing::TestWithParam<int> {};

TEST_P(FactorialTest, HandlesPositiveInput) {
  int n = GetParam();
  EXPECT_GT(Factorial(n), 0);
}

INSTANTIATE_TEST_SUITE_P(VariousValues, FactorialTest, ::testing::Values(1, 2, 3, 4, 5));
```

This example shows how to run the same test with multiple parameter values, verifying the factorial function for a sequence of inputs.

## 9. Additional Resources

For further details and expanded examples, see:

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) for basic concepts and getting started
- [Testing Reference](docs/reference/testing.md) for comprehensive API details
- [Parameterized and Typed Tests Guide](api-reference/core-testing-apis/parameterized-tests.mdx)
- [Assertions Reference](api-reference/core-testing-apis/assertions.mdx) for full assertion details
- [SCOPED_TRACE Documentation](docs/reference/testing.md#SCOPED_TRACE)

To stay updated on new improvements, monitor the [Changelog Releases](changelog/release-highlights/full-release-history.mdx).

---

*Last updated on the `main` branch.*

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googletest/include/gtest/internal/gtest-internal.h", "range": "1-566"},{"path": "googletest/include/gtest/internal/gtest-port.h", "range": "1-490"}]} />