---
title: "Deprecations & Removals"
description: "Catalogs features and APIs scheduled for removal, including timelines and recommended alternatives. Empowers proactive code maintenance and long-term stability for downstream projects."
---

# Deprecations & Removals

This page catalogs all features and APIs within GoogleTest and GoogleMock that are scheduled for removal. It provides clear timelines and prescribes recommended alternative practices or replacements to empower proactive maintenance of your codebase, ensuring long-term stability and compatibility for downstream projects relying on GoogleTest.

---

## Overview

Managing deprecated features is crucial to keep your tests robust and compatible with future releases of GoogleTest. This document lists APIs and features planned for removal, details their deprecation timelines, and suggests modern alternatives. By regularly reviewing this page, you can adjust your code proactively and avoid sudden breakages.

### Why Care About Deprecations?

- **Avoid sudden breakage**: Deprecated APIs will be removed in future versions, causing build or runtime errors if not addressed.
- **Benefit from improvements**: Alternatives often provide enhanced performance, better safety, or improved usability.
- **Maintain clarity**: Refactoring away deprecated constructs yields cleaner, more maintainable test code.

## Scheduled Removals

Though GoogleTest has a conservative policy on removing features, the following highlights indicate known deprecations and removals (details may be updated as the project evolves):

### Old-Style `MOCK_METHODn` Macros

- The legacy family of macros `MOCK_METHODn` and `MOCK_CONST_METHODn` are deprecated in favor of the unified `MOCK_METHOD` macro introduced in 2018.
- Migration is recommended since future versions of GoogleMock may remove these older macros.
- **Recommended Alternative:** Transition your mocks to use `MOCK_METHOD(ReturnType, MethodName, (Args...), (Specs...));` which offers more robust and flexible mocking syntax.

#### Example Migration
```cpp
// Deprecated style
MOCK_CONST_METHOD1(Foo, bool(int));

// Recommended style
MOCK_METHOD(bool, Foo, (int), (const));
```

### Strict, Naggy, and Nice Mock Wrappers

- The default mock behavior is currently **NaggyMock**, which emits warnings upon uninteresting calls.
- Usage of **NiceMock** (which suppresses warnings) and **StrictMock** (which makes uninteresting calls errors) is recommended based on test goals.
- No immediate removal is planned, but be aware that strictness modifiers only work reliably on mock methods directly declared in the mock class using `MOCK_METHOD`.

### Mocking Non-Virtual Methods

- Direct mocking of non-virtual methods is supported via defining unrelated mock classes with matching signatures but is discouraged.
- For better design and maintainability, it is recommended to prefer interface-based mocking.

### Free Functions and Static Methods

- Direct mocking of free functions (C-style or static methods) is not supported.
- The suggested approach is to abstract such functions behind interfaces that can be mocked.

## Deprecation Timelines & Migration

GoogleTest communicates deprecations well in advance, allowing ample time for migration. Here is a typical user journey:

1. **Announcement & Documentation:** New releases document deprecated features with migration guides.
2. **Warnings:** Compiler warnings or runtime warnings signal deprecated APIs in use.
3. **Removal:** Deprecated APIs are finally removed, as per the indicated release schedule.

Make sure to read the migration guides linked below to update your tests appropriately.

## Recommended Migration Practices

- **Use `MOCK_METHOD` instead of old macros:** This modern macro supports qualifiers (`const`, `override`, `noexcept`, etc.) and solves parsing issues with complex types.
- **Embrace interfaces for mocking external or concrete classes:** Instead of mocking concrete classes directly or non-virtual methods, design mockable interfaces to decouple your tests.
- **Employ NiceMock or StrictMock wisely:** Use `NiceMock` to suppress noise from uninteresting calls during development, and `StrictMock` selectively to enforce strict call expectations.
- **Leverage ON_CALL and EXPECT_CALL correctly:** Define default behavior with `ON_CALL` and expectations with `EXPECT_CALL` to maintain less brittle tests.

## Common Pitfalls to Avoid

- **Ignoring deprecation warnings:** May lead to build failures upon upgrading.
- **Suppressing uninteresting call warnings by adding expectations indiscriminately:** Leads to brittle tests that break easily on refactoring.
- **Mocking methods in base classes without redeclaring in derived mocks:** Strictness wrappers may fail to work as expected.
- **Mocking non-virtual or free functions directly:** You cannot; instead, refactor to interfaces.

## Tools for Migration

- **Migration Guides:** Detailed step-by-step instructions to revamp old mock macros to new APIs.
- **Static Analysis:** Tools to detect deprecated usages in your test code.
- **Sample Refactorings:** Code examples illustrating transitions from deprecated to recommended patterns.

## Troubleshooting Deprecation Issues

### Deprecated `MOCK_METHODn` failing to compile
- Error: Parsing errors due to unprotected commas in template arguments.
- Solution: Wrap complex types in parentheses or use type aliases when using the new `MOCK_METHOD` macro.

### Unexpected call warnings despite use of `NiceMock`
- Possibly due to mocking methods inherited from base classes; consider redeclaring with `MOCK_METHOD` in derived mock class.

### Difficulty mocking free or static functions
- Refactor by introducing interfaces that encapsulate such functions.

---

## Additional Resources

- [Mocking Reference](../docs/reference/mocking.md) — Comprehensive guide to mocking with GoogleTest.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes with examples for using GoogleMock.
- [Deprecated `MOCK_METHODn` migration notes](../docs/reference/mocking.md#MOCK_METHOD) — Instructions on switching to new mocking macros.
- [Nice, Naggy & Strict Mocks](../api-reference/googlemock-api/nice-strict-mocks.mdx) — Understanding mock strictness wrappers.
- [Using Assertions Effectively](../guides/core-testing-workflows/using-assertions-effectively.mdx) — Best practices for assertions.

---

## Summary

Keep your GoogleTest usage future-proof by progressively eliminating deprecated APIs, especially the old-style `MOCK_METHODn` macros, and adopting `MOCK_METHOD`. Embrace interface-based mocking design and leverage provided mock strictness wrappers for clearer intent and improved test maintenance. Regularly consult this page and linked resources to track changes, plan migrations, and troubleshoot deprecated feature issues.

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/reference/mocking.md", "range": "48-300"}]} />
<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googlemock/include/gmock/gmock-matchers.h", "range": "0-650"}]} />

