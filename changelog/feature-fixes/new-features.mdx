---
title: "New Features"
description: "Explore newly introduced capabilities—such as new assertions, matchers, or integration methods—in each release. See how each update expands the utility or usability of the framework."
---

# New Features in GoogleMock

Explore newly introduced capabilities, enhancements, and expansions in GoogleMock with each release. These updates enhance the utility, expressiveness, and usability of the framework to help you write better tests with more powerful mock behaviors.

---

## 1. Enhanced Mock Method Declaration

- Introduction of a standardized `MOCK_METHOD` macro replacing older `MOCK_METHODn` variants, simplifying mock method definitions.
- Support for various method qualifiers including `const`, `override`, `noexcept`, `Calltype`, and reference qualifiers directly in `MOCK_METHOD`.
- Improved parsing to handle complex argument types containing commas by allowing parentheses wrapping or type aliasing.

### Example
```cpp
class MyMock {
 public:
  MOCK_METHOD(int, Calculate, (int x, int y), (const, override));
  MOCK_METHOD((std::pair<int, int>), GetPair, ());
};
```

## 2. New Mock Strictness Modes

GoogleMock now provides three primary strictness wrapper classes around mocks:

- **NiceMock<T>**: Suppresses warnings on uninteresting calls, making mocks "nice" by default.
- **NaggyMock<T>**: Emits warnings on uninteresting calls; current default behavior.
- **StrictMock<T>**: Treats uninteresting calls as test failures, enforcing strict adherence.

These wrappers are subclasses of your mock class and inherit constructors, allowing seamless substitution.

### Example
```cpp
NiceMock<MockFoo> nice_foo;    // Uninteresting calls suppressed
NaggyMock<MockFoo> naggy_foo;  // Warnings on uninteresting calls
StrictMock<MockFoo> strict_foo; // Failures on uninteresting calls
```

## 3. Advanced Expectation Matching

- Introduced `.With()` clauses for both `EXPECT_CALL` and `ON_CALL` to allow holistic multi-argument matching via tuple-based matchers.
- Support for lexer-safe chainable clauses in expectations: `.Times()`, `.InSequence()`, `.After()`, `.WillOnce()`, `.WillRepeatedly()`, and `.RetiresOnSaturation()`.

### Example Usage
```cpp
EXPECT_CALL(mock_obj, Func(_, _))
    .With(Lt())                      // Match calls where first arg < second arg
    .Times(3)
    .WillRepeatedly(Return(true));
```

## 4. Comprehensive Mock Behavior Control

- Ability to define default behaviors using `ON_CALL` separately from expectations, to provide default stub behavior without requiring call count constraints.
- Rich set of built-in actions enabling returning values, side effects (like `SetArgPointee`), invoking functions, or throwing exceptions.
- Ability to use callables (functions, lambdas, functors) directly as actions.

### Example
```cpp
ON_CALL(mock_obj, GetValue(_)).WillByDefault(Return(42));
EXPECT_CALL(mock_obj, GetValue(5))
    .WillOnce([](int x) { return x * 2; });
```

## 5. Support for Mocking Complex and Overloaded Functions

- Easy mocking of overloaded methods with no special syntax beyond defining all overloads using `MOCK_METHOD`, including const-overloaded versions.
- Support for mocking template class methods.
- Patterns to mock non-virtual methods and delegating to fakes or real implementations.

### Example
```cpp
MOCK_METHOD(int, Add, (int x), (override));
MOCK_METHOD(int, Add, (int times, int x), (override));
```

## 6. Move-Only Types Support

- Native support for mocking methods that accept or return move-only types (e.g., `std::unique_ptr`).
- Lambdas and callables can create new move-only instances on each call for flexible test setups.

### Example
```cpp
MOCK_METHOD(std::unique_ptr<Buzz>, MakeBuzz, (const std::string& text), (override));
EXPECT_CALL(mock_buzzer_, MakeBuzz("hello"))
    .WillRepeatedly([](const std::string&) { return std::make_unique<Buzz>(); });
```

## 7. Simplified Ways to Combine or Chain Actions

- Introduced `DoAll()` to perform multiple actions sequentially for a call, returning the result of the last one.
- `IgnoreResult()` wraps actions to suppress return value errors when the return type is void.
- Argument-selecting adaptors like `WithArg<N>()`, `WithArgs<N1, N2,...>()`, and `WithoutArgs()` simplify calling actions with selected arguments.

### Example
```cpp
EXPECT_CALL(mock, Process(_))
    .WillOnce(DoAll(SetArgPointee<0>(5), Return(true)));
```

## 8. Expanded Matchers and Custom Matcher Support

- Ability to compose matchers using logical combinators such as `AllOf()`, `AnyOf()`, `Not()`.
- Facility to define custom matchers using `MATCHER` macros or by implementing matcher classes.

### Example
```cpp
MATCHER(IsEven, "is even") { return (arg % 2) == 0; }
EXPECT_CALL(mock, Func(IsEven()));
```

## 9. Semantic Expectation Order Control

- Expectations can be ordered strictly using `InSequence` or partially using `After()` and `Sequence` objects.
- `RetiresOnSaturation()` marks expectations inactive after they reach their call limit.

### Example
```cpp
Sequence seq;
EXPECT_CALL(mock, FuncA()).InSequence(seq);
EXPECT_CALL(mock, FuncB()).InSequence(seq);
```

---

## Practical Tips

- Use `ON_CALL` for default behaviors to keep tests flexible and less brittle.
- Prefer `NiceMock` for suppressing noise in tests and use `StrictMock` when you want enforce exact call behavior.
- Leverage compound matchers and actions to write expressive expectations.
- Avoid over-specifying arguments to make your tests resilient to implementation changes.

---

## Troubleshooting & Common Pitfalls

- Ensure mock methods override virtual functions and place `MOCK_METHOD` declarations in `public:` section to access from test code.
- Use `RetiresOnSaturation()` or sequences to avoid sticky expectations causing unexpected failures.
- When mocking overloaded functions, mock all overloads or use `using BaseClass::Method` to bring them into scope.

---

## Additional Resources

- [Mocking Reference](reference/mocking.md): In-depth API documentation.
- [gMock Cookbook](gmock_cook_book.md): Recipes and usage patterns.
- [gMock for Dummies](gmock_for_dummies.md): Beginner-friendly introduction.
- [Actions Reference](reference/actions.md): Detailed list of available actions.
- [Matchers Reference](reference/matchers.md): Comprehensive matcher descriptions.

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/gmock_cook_book.md", "range": "1-1000"},{"path": "docs/reference/mocking.md", "range": "1-1000"},{"path": "docs/reference/actions.md", "range": "1-500"}]} />