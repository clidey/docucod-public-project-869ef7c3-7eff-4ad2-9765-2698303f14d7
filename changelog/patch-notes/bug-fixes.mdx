---
title: "Bug Fixes"
description: "Comprehensive list of bugs addressed in each release, including root causes, affected components, and user-facing impacts. Aim to assist troubleshooting and confirm whether known issues are resolved in a given version."
---

# Bug Fixes

This page details the comprehensive list of bug fixes addressed across various GoogleTest and GoogleMock releases. It aims to assist users in troubleshooting, understanding root causes, and confirming whether known issues have been resolved in their current version.

---

## 1. Runtime and Assertion Reliability

- **Fatal vs. Nonfatal Failure Handling**: Resolved intermittent issues where fatal assertions (`ASSERT_*`) inside subroutines did not abort the test function as expected, potentially causing undefined behavior or crashes.

- **Predicate Assertion Evaluation**: Fixed cases where predicate assertions such as `EXPECT_PRED*` and `ASSERT_PRED*` were evaluating their predicate arguments multiple times, which could lead to unexpected side effects.

- **Streaming Assertions**: Corrected problems with streaming user-defined types into assertion failure messages to ensure accurate and user-friendly diagnostics.

- **Wide String Comparisons and Printing**: Addressed issues with `EXPECT_STREQ` and related string assertions for wide strings (`wchar_t*` and `std::wstring`), improving comparison correctness and output encoding.

- **Floating-Point Comparisons**: Fixed precision and corner cases in `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, and `EXPECT_NEAR` to handle infinities, NaNs, and near-zero values correctly.


## 2. Death Tests and Multi-threading

- **Death Test Stability**: Resolved reliability issues when running death tests (`EXPECT_DEATH`, `ASSERT_DEATH`) in multi-threaded environments, particularly ensuring `clone()`-based spawning on Linux avoids hangs or deadlocks.

- **Death Test Flag Handling**: Improved the interaction of death test command line flags and test environment setup, preventing subtle failures when mixing death tests and non-death tests in the same test suite.

- **Leak Detection in Death Tests**: Ensured that mock objects created in death tests can be optionally leaked using `Mock::AllowLeak`, preventing false positive leak reports when the process is killed.


## 3. Test Registration and Discovery

- **Dynamic and Parameterized Test Registration**: Fixed issues with tests registered dynamically via `RegisterTest` and parameterized test suites where incomplete or missing instantiations would incorrectly cause silent failures or misleading error messages.

- **Disabled Tests Handling**: Corrected improper execution or reporting of tests and test suites prefixed with `DISABLED_`, ensuring that disabled tests are never run but still compiled and reported correctly.

- **Test Suite Name Collisions**: Improved error detection and messaging when multiple test fixtures or tests share the same suite names but differ in their fixture classes, preventing confusing runtime errors.


## 4. Flag Parsing and Command Line Behavior

- **Command Line Flag Parsing**: Fixed bugs where duplicated flags or unrecognized flags were not properly removed from the argument list after parsing, causing interference with downstream argument processing.

- **Help and Usage Flag Behavior**: Corrected cases where `--gtest_help` and related flags caused unexpected printing or incomplete flag processing.

- **Flag File (`--gtest_flagfile`) Handling**: Fixed parsing errors and improper merging of flagfile options with command line flags.


## 5. Synchronization and Thread-Local Storage

- **Thread Local Storage Edge Cases**: Resolved issues with the `ThreadLocal` implementation on platforms with or without pthreads where the lifecycle of per-thread values was not properly managed.

- **Mutex and Locking Primitives**: Addressed rare deadlocks and race conditions in `Mutex` and `MutexLock` classes on Windows and POSIX systems.


## 6. Output and Logging Improvements

- **Test Output Encoding**: Fixed bugs in UTF-8 encoding and representation of wide string messages and streamed logs.

- **XML and JSON Report Generation**: Resolved serialization errors in generated XML and JSON test reports, including correct recording of test properties and failure messages.

- **Event Listener API**: Improved robustness in handling nested or recursive events in test listeners to avoid crashes and infinite loops.


## 7. Mocking and Mock Object Behavior

- **Default Action and Expectation Rules**: Fixed warnings and unexpected behaviors when mock functions have no default actions or when `ON_CALL` and `EXPECT_CALL` are mixed improperly.

- **Strictness Modes**: Addressed subtle logic errors in `NaggyMock`, `NiceMock`, and `StrictMock` modes, ensuring accurate reporting of uninteresting and unexpected calls.

- **Const and Overloaded Method Mocking**: Fixed compiler warnings and runtime issues when mocking methods with `const` parameters or overloaded signatures on certain compilers (e.g., MSVC).

- **Mock Argument Deletion and Actions**: Resolved cases where actions such as `DeleteArg<N>()` did not safely delete pointer arguments without causing leaks or crashes.


## 8. Build and Platform Portability

- **C++17 Compatibility Enforcement**: Added stricter checks to fail compilation early if the compiler does not support C++17 or later, preventing obscure build errors.

- **Platform Feature Detection**: Fixed misdetection or incomplete detection of platform features such as exceptions, RTTI, pthread availability, and file system status, which affected the compilation and runtime behavior.

- **Cross-platform POSIX Wrappers**: Corrected implementations of POSIX wrapper functions to better handle platform-specific edge cases (Windows CE, Android, QURT).


## 9. Miscellaneous Fixes

- **Test Property Management**: Fixed property recording in tests and test suites to properly overwrite duplicate keys and generate correct non-fatal warnings for reserved keys.

- **Random Number Generation**: Fixed `Random` class to avoid out-of-range generation and ensure reproducible number sequences after reseeding.

- **Regular Expression Support**: Improved selection and usage of the internal regex engine, handling POSIX and RE2 syntax better on relevant platforms.

- **Clean Shutdown and Resource Cleanup**: Addressed resource leaks in destructors related to test suite tear down and test fixture lifecycles.

---

### Practical Tips to Troubleshoot Known Bugs

- Consult the [FAQ](../faq/general-usage-faqs/getting-started-common-issues) for common issues related to test discovery and compilation.

- Run your tests with increased verbosity using `--gtest_verbose=info` to trace flag parsing and test case execution.

- When encountering death test failures, ensure the environment matches thread safety requirements and consider setting `--gtest_death_test_style=threadsafe`.

- For mock-related issues, review your use of `EXPECT_CALL` vs `ON_CALL` and confirm that all virtual methods have proper signatures.

- Use the `SCOPED_TRACE` macro to add context to assertions within subroutines for easier diagnosis.


## References

- Assertion Macros: [Assertions Reference](../reference/assertions.md)
- Death Tests Guide: [Advanced GoogleTest Topics - Death Tests](../advanced.md#death-tests)
- Mocking Overview: [Mocking Workflows](../guides/advanced-testing-patterns/mocking-workflows.mdx)
- Flag Parsing and Command Line: [Test Runner Initialization and Main](../api-reference/configuration-runtime/initialization-main.md)
- Threading Support and Synchronization: [Portability and Configuration](../api-reference/configuration-runtime/portability-config.md)

---

This changelog entry complements the full [Version History](./version-history) and [Breaking Changes](../breaking-changes/breaking-changes-summary) documentation pages for a comprehensive understanding of GoogleTest's evolution.
