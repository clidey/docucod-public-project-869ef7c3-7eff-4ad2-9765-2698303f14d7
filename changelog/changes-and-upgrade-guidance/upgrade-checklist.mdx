---
title: "Upgrade Checklist"
description: "Provides a step-by-step guide for upgrading from previous major versions, including best practices to test compatibility and update configuration files. Includes practical advice for both GoogleTest and GoogleMock users."
---

# Upgrade Checklist

This guide provides a clear, actionable checklist to assist users in upgrading from previous major versions of GoogleTest and GoogleMock. It delivers step-by-step advice focused on ensuring compatibility, updating configuration files, and testing your code after upgrade. Whether you use purely GoogleTest or integrate GoogleMock for mocking in your C++ tests, this checklist helps make your upgrade process smooth, reliable, and efficient.

---

## 1. Preparation Before Upgrading

### Review Breaking Changes
Before starting the upgrade, thoroughly review the documented [Breaking Changes](https://github.com/google/googletest/blob/main/docs/changelog/changes-and-upgrade-guidance/breaking-changes.md) for your current and target versions. This helps identify API modifications, removed features, or changed behaviors that may affect your tests.

### Backup Your Code and Test Suites
Make a backup of your entire project and test code. This ensures you have a safe rollback point in case the upgrade process requires refinements or fixes.

### Verify Tooling Compatibility
- Ensure your build system (CMake, Bazel, etc.) is updated to support the target GoogleTest version.
- Verify that your compiler meets the minimum requirements (C++17 capable compiler is mandatory).

<Tip>
A clean build environment avoids intermittent build or linkage failures and is ideal for catching upgrade issues early.
</Tip>

## 2. Update Your Build Configuration

### CMake Users
- Replace references to old GoogleTest packages or source trees with the latest version.
- If you use FetchContent or ExternalProject, update the version or commit hash accordingly.
- Follow guidance in [Installation with CMake](../getting-started/prerequisites-installation/installation-cmake.md).

### Bazel Users
- Update your `MODULE.bazel` or dependency declarations to the latest GoogleTest and GoogleMock versions.
- Update BUILD files if API or macro usage changed.
- Follow steps in [Installation with Bazel](../getting-started/prerequisites-installation/installation-bazel.md).

<Note>
Make sure to also update submodules or dependency references if GoogleTest is embedded as a git submodule.
</Note>

## 3. Modify Code for Deprecated or Removed APIs

### Replace Deprecated Macros and Methods
- Move away from old-style macros such as `MOCK_METHODn` to the generic `MOCK_METHOD` macro.
- Review [Deprecations and Removals](../changelog/changes-and-upgrade-guidance/deprecations-and-removals.md) for specifics.

### Review Mock Behavior Wrappers
- Check whether you are using `NiceMock`, `NaggyMock`, or `StrictMock` correctly.
- Understand that `NaggyMock` is the default behavior but may cause warnings for uninteresting calls.

### Update Initialization Procedures
- Ensure that your test initialization uses the latest recommended APIs for GoogleTest and GoogleMock.
- Confirm that `InitGoogleTest` and `InitGoogleMock` are invoked correctly.

## 4. Test and Validate Upgrade

### Run the Full Test Suite
- Execute all your existing GoogleTest and GoogleMock tests.
- Pay particular attention to warnings and failures that did not occur before.

### Checking Mock Expectations
- Make sure `EXPECT_CALL` and `ON_CALL` usages align with updated syntax and behavior.
- Note that gMock expectations are checked automatically upon mock object destruction. Use `Mock::VerifyAndClearExpectations()` in complex cases.

### Verify Flag Changes
- Confirm any changed GoogleMock flags, such as `--gmock_verbose`, behave as expected.
- Review your test environment and update command-line flags accordingly.

### Troubleshoot Common Failures
- Unexpected mock function calls often indicate missing or misconfigured expectations.
- Use `--gmock_verbose=info` to get detailed traces of mock calls and expectation matches.
- Check for sequence and order constraints on expectations, especially with `.InSequence()` and `.After()` clauses.

<Tip>
Employ the [Troubleshooting Common Setup Issues](../getting-started/troubleshooting-validation/common-setup-issues.md) guide for diagnosing build and runtime problems post-upgrade.
</Tip>

## 5. Upgrade Best Practices

- **Incremental Migration:** Upgrade dependency versions incrementally. Test after each step.
- **Isolate Breaking Changes:** Refactor code in small, manageable batches to adapt to API changes.
- **Use `RetiresOnSaturation()` Smartly:** This prevents “sticky” expectations from causing false failures.
- **Leverage the Latest Matcher Features:** New polymorphic and composite matchers can make your tests cleaner and more expressive.
- **Avoid Over-Specification:** Use `ON_CALL` for default behaviors and `EXPECT_CALL` for critical verification.

## 6. Update Documentation and Dependencies

- Update your project documentation to reflect the upgraded GoogleTest and GoogleMock versions.
- Pin dependency versions explicitly to avoid unintentional upgrades.

## 7. Additional Resources

### Essential Reference Links
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) – Beginner friendly guide for GoogleMock usage.
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) – For resolving common migration issues.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) – Practical recipes for advanced mocking.
- [Breaking Changes Documentation](../changelog/changes-and-upgrade-guidance/breaking-changes.md) – Details on backward incompatible changes.
- [Deprecations and Removals](../changelog/changes-and-upgrade-guidance/deprecations-and-removals.md) – Deprecated features and upgrade tips.

<Tip>
Consult the [Integration and Best Practices](../guides/integration_and_best_practices/cmake_and_bazel_integration.md) guide to streamline integration post-upgrade.
</Tip>

---

### Summary
Following this checklist ensures your transition to newer major GoogleTest/GoogleMock versions is predictable and safe. Prepare by understanding changing APIs, update your build setup carefully, adapt code for deprecated features, and thoroughly validate tests. Utilize provided references and best practices to maximize test reliability and maintainability during and after the upgrade.

---

## Example Upgrade Scenario

Suppose upgrading from GoogleTest 1.x to 2.x involves replacing all old-style `MOCK_METHODn` macros with the new unified `MOCK_METHOD` macro:

```cpp
// Old style
MOCK_METHOD1(Foo, bool(int));

// New style
MOCK_METHOD(bool, Foo, (int));
```

Also, change any calls to `EXPECT_CALL` or `ON_CALL` macros that do not follow the updated syntax to avoid ambiguous overloads.

Run your test suite. If any failures arise from missing expectations, add or correct `EXPECT_CALL` clauses. Review warnings about uninteresting calls, deciding whether to suppress them with `NiceMock` or treat them as failures with `StrictMock` based on your testing philosophy.

For further guidance, consult the [Upgrade Checklist](../changelog/changes-and-upgrade-guidance/upgrade-checklist.md) and related changelog pages.

---