---
title: "Deprecations and Removals"
description: "Lists features or APIs that have been deprecated or scheduled for removal, along with suggested replacements or mitigations. Helps teams plan future-proof code and anticipate necessary updates."
---

# Deprecations and Removals

This document outlines features of GoogleTest and GoogleMock that have been deprecated or scheduled for removal. It guides users on migrating away from obsolete APIs and practices, suggesting replacements and mitigating breaking changes. Staying informed allows your test code to remain future-proof and maintainable.

---

## 1. Overview

GoogleTest and GoogleMock evolve continuously to improve usability, performance, and maintainability. Some features, APIs, or behaviors may become obsolete and are either deprecated or fully removed in future releases. This page highlights such elements related to the testing and mocking frameworks.

Use this page when:

- Preparing for upgrades between major and minor versions.
- Reviewing the impact of deprecated APIs in your test code.
- Planning refactorings to eliminate usage of soon-to-be-removed features.

---

## 2. Deprecated Features and APIs

### MOCK_METHODn Macros

Before the generic `MOCK_METHOD` macro introduced in 2018, GoogleMock offered a family of macros named `MOCK_METHOD0`, `MOCK_METHOD1`, ..., `MOCK_CONST_METHOD1`, and variants for templated classes and calltypes.

These legacy macros differ in syntax and usage:

- Use: `MOCK_METHODn(MethodName, ReturnType(Args...))` instead of the more flexible `MOCK_METHOD(ReturnType, MethodName, (Args...))`.
- Require specifying the number of arguments in the macro name.
- Have different variants for const methods and methods with call types.

**Deprecation Status:**

- The `MOCK_METHODn` macros are deprecated and will be removed in future versions.
- Users should migrate to the modern `MOCK_METHOD` macro, which supports all previous use cases more cleanly.

**Migration Tip:**

```cpp
// Old style:
MOCK_METHOD1(Foo, bool(int));
MOCK_CONST_METHOD2(Bar, void(int, const string&));

// New style:
MOCK_METHOD(bool, Foo, (int), (override));
MOCK_METHOD(void, Bar, (int, const std::string&), (const, override));
```

### Use of `MOCK_METHOD` with Unprotected Commas

When mocking methods with return types or arguments containing commas (e.g., `std::pair<int, int>`), wrapping these types with parentheses or using type aliases is a recommended practice. The older approach without wrapping causes parsing errors with `MOCK_METHOD`.

**Recommendation:** Always wrap complex types with parentheses or use type aliases to avoid parsing errors, and to ensure portability and forward compatibility.

---

## 3. Deprecated Mock Behavior Modes

Though not strictly deprecated, GoogleMock historically provides mock wrappers called `NiceMock<>`, `NaggyMock<>`, and `StrictMock<>` that alter the behavior on uninteresting calls:

- `NiceMock<>`: suppresses warnings on uninteresting calls.
- `NaggyMock<>` (default): warns on uninteresting calls.
- `StrictMock<>`: fails immediately on uninteresting calls.

**Best Practice:** Favor use of `NiceMock<>` and `StrictMock<>` as intended, but be aware their behavior and support is limited to mock methods declared with `MOCK_METHOD` in the direct mock class. Use carefully as these wrappers may be removed or changed in the future.

---

## 4. Deprecated Flag Access Macros

In the header `googlemock/include/gmock/internal/gmock-port.h`, macros prefixed with `GMOCK_DECLARE_bool_`, `GMOCK_DEFINE_bool_`, and similar were introduced for internal and user flag definitions.

**Guidance:**

- Modern GoogleMock flags are managed and accessed through these macros but are not intended for direct user modification.
- For user code, prefer the documented flag interfaces and functions.
- These macros and flag mechanisms may be adjusted or replaced in future releases; avoid depending on their internal details.

---

## 5. Deprecated Customization Points

Custom user-defined macros or configurations located in `googlemock/include/gmock/internal/custom/` should be minimized or migrated to supported extension points as defined by GoogleMock. Unsupported or legacy customizations may be removed without notice.

---

## 6. Removed Platform Macros and Compatibility

GoogleTest determines platform capabilities and features via macros such as `GTEST_HAS_EXCEPTIONS`, `GTEST_HAS_RTTI`, `GTEST_HAS_PTHREAD`, etc.

Some older platform macros and feature flags are deprecated, consolidated, or removed to simplify detection and compatibility.

Users are encouraged to rely on default automatic detection unless explicitly overriding for special circumstances. Old manual macro definitions should be reviewed and updated accordingly.

---

## 7. Removed Support for Pre-C++17 Compilers

GoogleTest has required C++17 or newer since version updates prior to main development branches, reflected by:

```cpp
#if !defined(GTEST_INTERNAL_CPLUSPLUS_LANG) || \
    GTEST_INTERNAL_CPLUSPLUS_LANG < 201703L
#error C++ versions less than C++17 are not supported.
#endif
```

**Action:** Ensure your compiler and build environment use C++17 or newer standards. Earlier versions are unsupported and may fail to compile or run.

---

## 8. Deprecated Logging and Output Behavior

- The `gmock_verbose` flag controls how much gMock logs about mock calls.
- Deprecated logging levels or mechanisms should be replaced with current flag values: "info", "warning", and "error".

Prefer setting verbosity through documented flags or command-line options rather than environment variables or undocumented API usages.

---

## 9. Deprecated Use of GoogleMock Initialization Functions

The function `InitGoogleMock()` replaces older `ParseGUnitFlags()`. Use `InitGoogleMock()` to parse flags and initialize GoogleMock properly:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Older initialization functions or methods are deprecated and may be removed.

---

## 10. Migrating Away from Deprecated Features

- Refactor usages of `MOCK_METHODn` macros to the generic `MOCK_METHOD` macro.
- Adopt new mock behavior wrappers and avoid legacy patterns conflicting with them.
- Use `ON_CALL` and `EXPECT_CALL` as prescribed, avoid deprecated chaining or usage patterns.
- Update your build scripts to enforce C++17 and above.
- Prefer the modern flag management mechanisms.

Test your code thoroughly after applying migrations to catch subtle behavior changes.

---

## 11. Additional Resources

- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — for mock class and method definitions.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — practical recipes for mocking usage.
- [API Reference: Mock Object APIs](https://google.github.io/googletest/api/reference/mocking-and-matchers/mock-object-apis.html)
- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — to get started with tests and mocks.
- [Breaking Changes & Upgrade Guidance](https://google.github.io/googletest/changelog/changes-and-upgrade-guidance/breaking-changes.html) — detailed guidance when upgrading.

---

## 12. Troubleshooting and Support

If you encounter warnings or errors related to deprecated features:

- Verify your code against latest API reference.
- Use migration guides and upgrade checklist to identify usages of deprecated features.
- Reach out to community support or file issues on the official GitHub repository if you find missing documentation or have migration questions.

---

## 13. Summary

This page is integral to planning your migration and maintaining up-to-date GoogleTest and GoogleMock codebases. It fits within the "Changelog" section as part of upgrade guidance. For a complete upgrade experience, review the [Breaking Changes](https://google.github.io/googletest/changelog/changes-and-upgrade-guidance/breaking-changes.html) and the [Upgrade Checklist](https://google.github.io/googletest/changelog/changes-and-upgrade-guidance/upgrade-checklist.html).


---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googlemock/include/gmock/internal/gmock-port.h", "range": "10-130"}]} />