---
title: "Breaking Changes & Migrations"
description: "Clear explanations of breaking changes introduced in major or minor releases, including impact analysis and code examples. Provides migration strategies to adapt existing test code, ensuring users can maintain compatibility and reliability with minimal disruption."
---

# Breaking Changes & Migrations

This page provides clear explanations of breaking changes introduced in major or minor releases of GoogleTest and GoogleMock. It offers detailed impact analyses and practical migration strategies, including code examples, to help users adapt existing test code with minimal disruption while maintaining compatibility and reliability.

---

## Understanding Breaking Changes

When upgrading to a new version, especially major or minor releases, some changes may be incompatible with previous code. This section aids users in identifying such breaking changes specifically related to GoogleMock mocking APIs and behaviors.

### User-Impact Focus

Breaking changes documented here focus on what users need to update in their test code, rather than internal implementation changes. This enables smooth transitions and continuous test correctness.

---

## Common Categories of Breaking Changes

- **Mocking API modifications:** Changes to macros like `MOCK_METHOD` or mock class structures that require updates to mock definitions.
- **Strictness mode updates:** Alterations in `NiceMock`, `NaggyMock`, or `StrictMock` behaviors affecting uninteresting call handling.
- **Matcher and Action adjustments:** Updates influencing how matchers are composed or how actions are specified in expectations.
- **Deprecations:** Features or patterns deprecated and removed in newer versions that require migration.

---

## Breaking Changes Impact Analysis

Whenever a breaking change is introduced, it is important to understand:

- Which aspect of your tests it affects.
- How it changes the behavior, syntax, or semantics.
- Whether it imposes new constraints or removes previous functionality.

---

## Migration Strategies

To minimize disruption, follow these migration steps when adapting your existing test code:

<Steps>
<Step title="Review Release Notes for Breaking Changes">
Always read the official release notes accompanying the new version to identify breaking changes relevant to your usage.
</Step>
<Step title="Identify Affected Mock Classes and Methods">
Examine your test code for use of any deprecated or changed mock methods or macros.
</Step>
<Step title="Update MOCK_METHOD Macros and Signatures">
Modify declarations using `MOCK_METHOD` to match the new syntax or qualifiers as needed. For example, adding or removing qualifiers like `const`, `override`, or `noexcept`.
</Step>
<Step title="Adjust Usage of Strictness Wrappers">
Check if your code uses `NiceMock`, `NaggyMock`, or `StrictMock`. Adapt to any changes in their semantics or inheritance requirements.
</Step>
<Step title="Modify Expectations and Actions">
Update `EXPECT_CALL` and `ON_CALL` chains, especially if matcher or action APIs have tightened or altered.
</Step>
<Step title="Run Tests and Fix Failures">
Compile and run your tests, paying close attention to any unexpected failures or warnings indicating changes required.
</Step>
</Steps>

<Tip>
Maintain a branch with your existing tests before migration to enable easy comparison and rollback if needed.
</Tip>

---

## Example Migration Scenario: Updating `MOCK_METHOD` Usage

A common breaking change can be updates in the `MOCK_METHOD` macro signature. For instance, adapting to new parameter arrangements or qualifiers.

### Old Style Usage:
```cpp
class MyMock {
 public:
  MOCK_METHOD1(Foo, bool(int));
  MOCK_CONST_METHOD1(Bar, int(int));
};
```

### New Style Usage:
```cpp
class MyMock {
 public:
  MOCK_METHOD(bool, Foo, (int));
  MOCK_METHOD(int, Bar, (int), (const));
};
```

This change standardizes `MOCK_METHOD` usage and encourages explicit qualifiers.

<KeyMigrationTips>
- Wrap complex types with parentheses when they contain commas.
- Ensure mocked methods that override `const` or `noexcept` methods specify those qualifiers.
- Always declare `MOCK_METHOD` macros in `public:` scope regardless of base class visibility.
</KeyMigrationTips>

---

## Handling Changes in Strictness Modes

GoogleMock features `NiceMock`, `NaggyMock`, and `StrictMock` wrappers to control behavior on uninteresting calls. Breaking changes here might alter default behaviors or inheritance restrictions.

### Guidance:

- Avoid nesting strictness wrappers like `NiceMock<StrictMock<...>>`, which is not supported.
- Confirm that your mock classes have virtual destructors to ensure proper strictness enforcement.
- If upgrading causes unexpected call warnings or failures, adjust the strictness wrapper or expectations accordingly.

---

## Code Example: Migrating to `NiceMock` Usage

```cpp
using ::testing::NiceMock;

// Before migration:
MockClass mock;
EXPECT_CALL(mock, DoSomething());

// After migration for suppressing warnings on uninteresting calls:
NiceMock<MockClass> nice_mock;
EXPECT_CALL(nice_mock, DoSomething());
```

This change improves test resilience against unexpected but tolerated calls.

---

## Troubleshooting Common Migration Issues

<AccordionGroup title="Common Pitfalls and Solutions">
<Accordion title="Compilation Failures Due to MOCK_METHOD Syntax">
Review the macro usage closely; ensure that argument lists are correctly parenthesized and qualifiers match overridden base methods.
</Accordion>
<Accordion title="Uninteresting Call Warnings After Upgrading">
Verify your use of strictness modifiers. Switch from default (naggy) mocks to `NiceMock` where warnings are undesired.
</Accordion>
<Accordion title="Unexpected Behavior Changes in Mocks">
Check whether your tests rely on deprecated or changed action sequences. Adapt `EXPECT_CALL` chains and use `RetiresOnSaturation()` where applicable.
</Accordion>
</AccordionGroup>

---

## Best Practices for Migration

- **Incremental Upgrade:** Migrate small test components separately to isolate impacts.
- **Keep Tests Readable:** Adjust mocks for clearer intentions using explicit qualifiers.
- **Use Verbosity for Debugging:** Enable `--gmock_verbose=info` during migration to trace unexpected calls.
- **Leverage Migration Guides:** Follow online migration notes and community examples.

---

## Related Documentation

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes and practical tips for mock usage.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — Detailed API and macro explanations.
- [Strictness Modes Guide](https://google.github.io/googletest/api/reference/mocking-apis/strictness-modes.html) — In-depth discussion on `NiceMock`, `NaggyMock`, `StrictMock`.
- [Matchers Reference](https://google.github.io/googletest/reference/matchers.html) — Compound matchers and custom matcher creation.
- [Actions Reference](https://google.github.io/googletest/reference/actions.html) — Specifying mock method behaviors.

---

For effective migration, also review the [Version History](./version-history) and [Deprecation Notices](./deprecations) pages to fully understand the upgrade path and deprecated features.