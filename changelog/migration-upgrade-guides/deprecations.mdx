---
title: "Deprecation Notices"
description: "Lists features, APIs, or behaviors that are deprecated, with timelines for removal and recommended alternatives. Equips users to proactively refactor their tests to avoid future maintenance issues."
---

# Deprecation Notices

This page details the features, APIs, or behaviors within GoogleMock that have been officially deprecated. The purpose is to inform you of upcoming removals and guide you on how to update your tests proactively to avoid future maintenance issues.

---

## What is Deprecation?

Deprecation means a feature or API is marked for removal in a future release. While it currently continues to function, relying on it is discouraged and may lead to compilation or runtime errors when upgrading.

GoogleMock follows a deliberate deprecation policy with clear timelines and recommendations to ease migration.

## Importance of Heeding Deprecation Notices

Ignoring deprecation notices can lead to:

- Broken tests when updating GoogleMock to newer versions.
- Increased maintenance overhead.
- Loss of access to improvements and bug fixes introduced in replacement APIs.

We strongly advise reviewing deprecation notices regularly and refactoring your tests accordingly.

---

## Deprecated Features and APIs

### 1. Old-Style `MOCK_METHODn` Macros

**Status:** Deprecated in favor of the generic `MOCK_METHOD` macro introduced in 2018.

**Details:**

GoogleMock previously offered `MOCK_METHODn` family macros (e.g., `MOCK_METHOD1`, `MOCK_CONST_METHOD2`, etc.) to define mock methods. These macros required specifying the number of arguments explicitly and were more rigid.

**Recommendation:**

Switch to the modern `MOCK_METHOD` macro, which supports arbitrary argument lists, qualifiers (const, override, noexcept, ref qualifiers), and is more maintainable. 

Example transition:

```cpp
// Old way (deprecated):
MOCK_METHOD1(Foo, bool(int));

// New way (preferred):
MOCK_METHOD(bool, Foo, (int), ());
```

### 2. Using `EXPECT_CALL` Without Proper Property

**Status:** Some `EXPECT_CALL` usage patterns that rely on internal sticky expectations without `.RetiresOnSaturation()` can cause brittle tests and are discouraged.

**Details:**

Expectations in GoogleMock remain "sticky" by default, meaning they stay active after saturation unless explicitly stated otherwise. While this is not a direct API deprecation, it often leads to test failures unexpectedly.

**Recommendation:**

Use `.RetiresOnSaturation()` to explicitly retire expectations after they are saturated for clearer test semantics. Alternatively, consider expressing call ordering with sequences for predictable behavior.

```cpp
EXPECT_CALL(mock, Method())
    .Times(2)
    .RetiresOnSaturation();
```

### 3. Legacy Macro-Based Actions and Matchers

**Status:** Macro-based actions (`ACTION`, `ACTION_P`, etc.) and matchers (`MATCHER`, `MATCHER_P`, etc.) are still supported but for complex scenarios, custom matcher classes and polymorphic matchers are encouraged.

**Details:**

Though not deprecated immediately, reliance solely on these macros can limit expressiveness and compiler error clarity.

**Recommendation:**

Prefer implementing matcher interfaces or using polymorphic matcher factories (`MakePolymorphicMatcher`) for reusable and type-safe matchers in complex scenarios.

---

## Deprecation Timeline and Removal Plans

| Feature                  | Deprecated Since | Planned Removal Release | Recommended Replacement         |
|--------------------------|------------------|-------------------------|--------------------------------|
| `MOCK_METHODn` macros    | 2018 (approx.)   | 2025 (tentative)       | `MOCK_METHOD` macro            |
| Sticky expectations without explicit retirement | Ongoing behavior | N/A (behavior recommended updated) | Use `.RetiresOnSaturation()`    |
| Legacy actions and matchers | Not deprecated but discouraged | TBD         | Polymorphic matcher classes   |

---

## Migrating Your Tests

### Migrating from `MOCK_METHODn` to `MOCK_METHOD`

1. Update your mock class declarations to use `MOCK_METHOD`.
2. Wrap complex types with commas in parentheses, or create type aliases to avoid macro parsing issues.
3. Add appropriate qualifiers such as `(const, override)` or `(override)`.

Example:

```cpp
using BoolAndInt = std::pair<bool, int>;

class MockFoo : public Foo {
public:
  MOCK_METHOD(BoolAndInt, GetPair, (), (override));
  MOCK_METHOD(bool, CheckMap, ((std::map<int, double>), bool), (override));
};
```

### Refining Expectations for Clarity

For expectations meant to be used a fixed number of times, use `.RetiresOnSaturation()` to clearly mark when an expectation is no longer active.

### Transitioning From Macro-Based Matchers and Actions

For heavy usage scenarios, implement polymorphic matcher classes with `MakePolymorphicMatcher()` and action templates with `MakePolymorphicAction()`.

See [Writing New Matchers Quickly](https://google.github.io/googletest/gmock_cook_book.html#NewMatchers) and [Writing New Actions](https://google.github.io/googletest/gmock_cook_book.html#NewActions) in the gMock Cookbook.

---

## How to Check for Deprecated Usage

- Enable compilation diagnostics and run static analysis to detect use of deprecated macros or patterns.
- Run existing tests under the latest GoogleMock version and address warnings and errors.
- Review your mocking interfaces and update signature macros to current standards.

---

## Additional Resources

- [GoogleMock Cookbook - Migration Section](https://google.github.io/googletest/gmock_cook_book.html#migration-upgrade-guides)
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock API Docs](https://google.github.io/googletest/reference/mocking.html)

---

For more on expectations, matchers, actions, and best practices, see related documentation in the Mocking and Assertions sections of GoogleTest.

---

_Last updated: 2024-06_

