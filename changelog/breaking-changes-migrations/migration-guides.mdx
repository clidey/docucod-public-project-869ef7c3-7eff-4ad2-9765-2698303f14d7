---
title: "Migration Guides"
description: "Step-by-step instructions and best practices for migrating your test code and build files to the current version. Covers common pitfalls, essential file changes, and links to community resources."
---

# Migration Guides

Welcome to the GoogleTest Migration Guide. This page supports your transition by providing step-by-step instructions and best practices for migrating your test code and build files to the current version of GoogleTest and GoogleMock. As your tests evolve alongside the framework, this guide aims to simplify the update process, focusing on the actionable changes you need to make.

---

## Migration Overview

Upgrading to the latest GoogleTest requires awareness of essential file and code adjustments to ensure your test suites continue to integrate smoothly and run successfully. This guide covers the most common transitions users experience, outline crucial renamings, structural edits, and highlights pitfalls to watch out for.

Whether you are upgrading from an older release or realigning your builds to the latest standards, these instructions will help you save time and avoid common migration errors.

---

## Essential Migration Steps

### 1. Adopt C++17 as Minimum Language Standard

GoogleTest version 1.17.0 and later require compiling code with at least the C++17 language standard. Update your build configurations and compiler flags accordingly to meet this prerequisite.

**Example:**

- For CMake, add or update:

  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```

- For command-line builds, include:
  ```
  -std=c++17
  ```

Ensure all dependencies and your own code base support C++17 to prevent build failures.

### 2. Transition to the Unified MOCK_METHOD Macro

GoogleMock historically supported several legacy macros for mocking methods (e.g., `MOCK_METHOD0`, `MOCK_METHOD1`, `MOCK_CONST_METHOD1`, etc.). These have been **deprecated and removed** in favor of the new generic `MOCK_METHOD` macro. This macro unifies mocking into a single syntax and simplifies declarations.

**Migration example:**

Before:
```cpp
MOCK_METHOD1(Foo, bool(int));
MOCK_CONST_METHOD2(Bar, int(int, double));
```

After:
```cpp
MOCK_METHOD(bool, Foo, (int));
MOCK_METHOD(int, Bar, (int, double), (const));
```

**Key changes:**

- The return type comes first,
- The method name second,
- Followed by argument types wrapped in parentheses,
- Optional method qualifiers (e.g., `const`, `override`) as a fourth argument.

This migration improves clarity and consistency across mock definitions.

### 3. Mock Methods Must Be Declared `public`

All mock method declarations (`MOCK_METHOD`) must reside in the `public` section of your mock class, regardless of the corresponding method's access level in the base class. This is necessary so that mocking frameworks can correctly intercept and verify calls.

Example:
```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, ProtectedMethod, (), (override));  // even if underlying method is protected
};
```

### 4. Use StrictMock and NiceMock Wrappers Judiciously

The behavior of mock strictness wrappers changed and should be revisited. The new recommended practice is:

- Use `NiceMock` to suppress warnings from uninteresting calls when you don't want to verify every call.
- Use `StrictMock` only when you want to enforce that **all** calls are expected and matched.

This avoids brittle tests and makes test intentions clearer.

### 5. Update Build and Linking Practices

Verify that your build configurations link against the current GoogleTest and GoogleMock libraries (or unified combined library). If you were linking separately or using older build variants, consult the latest `CMake` or `Bazel` build examples to align your setup.

---

## Common Pitfalls And How To Avoid Them

- **Compilation Errors due to Missing Default Constructors:** Ensure your test fixture classes have accessible default constructors to work with the GoogleTest macros.

- **Access Violations When Mocking Non-Public Methods:** Always place mock methods in the `public` section.

- **Undefined References to Legacy Macros:** Remove usage of any `MOCK_METHODn` or other deprecated macros.

- **Runtime Warnings About Uninteresting Calls:** Use `NiceMock` or refine your expectations to clarify intended calls.

- **Inconsistent `main()` Functions:** Ensure you use `testing::InitGoogleTest(&argc, argv);` before running tests, and return the result of `RUN_ALL_TESTS()`.

---

## Practical Migration Example

Suppose your old mock class looks like this:

```cpp
class OldMock : public Base {
 protected:
  MOCK_METHOD1_T(Foo, bool(int));
  MOCK_CONST_METHOD0(Bar, int());
};
```

**Update it to:**

```cpp
class NewMock : public Base {
 public:
  MOCK_METHOD(bool, Foo, (int), (override));
  MOCK_METHOD(int, Bar, (), (const, override));
};
```

Also ensure `NewMock`'s mock methods are in the `public` section.

---

## Links to Community Migration Resources

If you encounter unique migration challenges, consider consulting the following resources:

- [GoogleTest Official Migration Guide](https://google.github.io/googletest/migration.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for updated mocking syntax and patterns
- [Migration discussions in GitHub Issues](https://github.com/google/googletest/issues?q=is%3Aissue+label%3Amigration)
- [Community Shared Insights](https://github.com/ElectricRCAircraftGuy/eRCaGuy_dotfiles/blob/master/googletest/insights.md)

---

## Summary

Migrating your tests to the current GoogleTest release involves:

- Updating your compiler standard to C++17 or newer
- Replacing all legacy `MOCK_METHODn` macros with the unified `MOCK_METHOD`
- Making mock methods public
- Applying strictness wrappers (`NiceMock`, `StrictMock`) thoughtfully
- Updating your build linking and initialization

With these steps, your tests will remain robust, maintainable, and fully compatible with GoogleTestâ€™s latest features.

---

## Additional Help and Next Steps

After completing migration:

- Review the [GoogleTest Primer](primer.md) to refresh on test writing practices
- Consult the [Mock Methods API](api-reference/mocking-and-matcher-api/mock-methods-api.mdx) for detailed mock usage
- For advanced scenarios, explore [Mocking Best Practices](guides/testing-patterns/mocking-best-practices.mdx)
- Refer to [Breaking Changes](breaking-changes.mdx) and [Deprecations](deprecations.mdx) for more detailed upgrade considerations

Ensure to fully test your migrated suites to catch any discrepancies early.

---

This page evolves as GoogleTest advances. Stay tuned to official releases and community discussions for the latest migration tips.
