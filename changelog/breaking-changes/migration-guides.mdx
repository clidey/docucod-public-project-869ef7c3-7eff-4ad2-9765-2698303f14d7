---
title: "Migration & Upgrade Guides"
description: "Practical, step-by-step instructions for transitioning between notable releases, addressing both general migration and specific challenges (such as adapting to new C++ standards or changes in test discovery)."
---

# Migration & Upgrade Guides

Upgrade smoothly and confidently with detailed, step-by-step guidance for transitioning between major GoogleTest and GoogleMock releases. This page equips you to handle general migration paths as well as specific challenges such as adapting to new C++ standards or changes in test discovery mechanisms.

---

## 1. Introduction

This page focuses exclusively on migration and upgrade instructions for GoogleTest and GoogleMock. Whether you are moving from a legacy version or adapting to changes introduced in recent updates, this guide offers practical guidance framed around how you, as a user, perform the upgrade without needing to dive into internal implementation.

Upgrades can involve:

- Changes in C++ standard requirements (e.g., moving from C++11 to C++17)
- Modifications in test discovery or registration
- Updates to mocking macro usages or behavior
- Adjustments needed for third-party dependencies

This guide is organized to help you assess, adapt, and verify your migration at each stage.

---

## 2. Preparing to Migrate

Before beginning any migration:

- **Review Release Notes Carefully:** Understand which versions introduce breaking changes or deprecated features.
- **Check Your Current Environment:** Verify your compiler and platform support for the target version’s requirements (e.g., minimum C++ standard, dependencies). The [Supported Platforms & Dependencies](/overview/feature-architecture-and-integration/supported-platforms-and-dependencies) guide helps here.
- **Analyze Your Test Suite:** Identify custom configurations, usage of deprecated APIs, or patterns sensitive to internal changes.

<Tip>
Ensure that your development environment fully supports at least the minimum C++ standard required by the new release, commonly C++17 or higher.
</Tip>

---

## 3. General Migration Workflow

The recommended approach to performing migrations or upgrades involves the following steps:

<Steps>
<Step title="Backup Your Current Codebase">
Create a snapshot of your current test code and build environment to enable rollback if needed.
</Step>
<Step title="Upgrade Incrementally">
If migrating across multiple major releases, upgrade one major or minor release at a time to isolate issues easily.
</Step>
<Step title="Update Dependencies">
Adjust build files, package references, and compiler flags to align with the new GoogleTest/GoogleMock version’s requirements.
</Step>
<Step title="Modify Test Code">
Address API changes, deprecated methods, and syntactical updates as detailed for your target version.
</Step>
<Step title="Verify Test Discovery">
Ensure your test executables correctly discover and run all tests, especially if the migration includes changes in test registration or discovery logic.
</Step>
<Step title="Run Comprehensive Test Suite">
Check that all tests pass or behave as expected, fixing any that fail due to migration-related changes.
</Step>
<Step title="Leverage New Features or Improvements">
After a successful migration, consider updating your test suites to utilize new features or improved APIs for enhanced productivity.
</Step>
</Steps>

---

## 4. Key Migration Topics

### 4.1 Adapting to New C++ Standards

GoogleTest and GoogleMock have progressively increased their minimum C++ standard requirements, recently mandating support for C++17 or later. When upgrading:

- Update your compiler and build system to enable the required C++ standard.
- Modify source code that uses deprecated or removed C++ features.
- Verify compatibility of custom matcher or action implementations.

<Tip>
If using older compilers, upgrade to supported versions that fully implement C++17 or newer to avoid subtle compilation or runtime issues.
</Tip>

### 4.2 Changes in Test Discovery and Registration

Some versions introduce improvements or breaking changes in how tests are registered and discovered at runtime:

- Transition from static test registration to dynamic or improved lifetimes may require build or linker changes.
- If tests suddenly do not appear or run after an upgrade, consult troubleshooting related to test discovery (see [Troubleshooting & Common Setup Issues](/getting-started/first-steps-validation/troubleshooting)).

### 4.3 Mocking API Changes

Upgrades may introduce changes to mocking macros or usage recommendations, such as transitioning from legacy `MOCK_METHODn` macros to the newer variadic `MOCK_METHOD` macro.

- Review your mock class declarations and update macro usage accordingly.
- Adjust any custom mocking patterns relying on deprecated APIs.
- Utilize improved strictness modifiers (`NiceMock`, `StrictMock`) to better control expectation behaviors.

### 4.4 Handling Deprecated or Removed Features

Check for features marked as deprecated or removed in the release notes. Update your code:

- Remove usages of deprecated APIs promptly.
- Replace with recommended alternatives or new patterns.

### 4.5 Build System and Dependency Updates

- Update CMake, Bazel, or other build files to reflect new GoogleTest and GoogleMock library targets and flags.
- Adjust for any newly required compiler flags or warning suppressions.

---

## 5. Troubleshooting Common Migration Issues

<AccordionGroup title="Common Migration Challenges and Solutions">
<Accordion title="Tests Not Discovering After Upgrade">
- Verify that your executable links with correct test libraries (e.g., `gtest_main`, `gmock_main`).
- Check for missing `GTEST_` or `GMOCK_` macros required for registration.
- Confirm that your test binaries are rebuilt fully without stale artifacts.
</Accordion>
<Accordion title="Mocked Methods Not Behaving As Expected">
- Review your mock method declarations for macro usage correctness.
- Check if `MOCK_METHODn` macros need migration to `MOCK_METHOD`.
- Inspect whether default actions and expectations are properly set and that `ON_CALL` and `EXPECT_CALL` usages conform to new recommendations.
</Accordion>
<Accordion title="Build Errors Related to C++ Versions">
- Confirm your compiler version and build are configured for at least C++17.
- Fix any outdated language extensions or non-standard compiler flags.
- Review code for deprecated C++ constructs.
</Accordion>
</AccordionGroup>

---

## 6. Practical Examples

Here are snippets demonstrating common migration adaptations.

### Updating Mock Declarations from Old Style to New Style

**Before:**
```cpp
MOCK_METHOD1(Foo, bool(int));
MOCK_CONST_METHOD1(Bar, int(const string&));
```

**After:**
```cpp
MOCK_METHOD(bool, Foo, (int), (override));
MOCK_METHOD(int, Bar, (const std::string&), (const, override));
```

### Enabling Modern C++ Standard in CMake

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### Setting Up Ordered Expectations with Sequences

```cpp
using ::testing::InSequence;
{
  InSequence s;

  EXPECT_CALL(mock, Action1()).Times(1);
  EXPECT_CALL(mock, Action2(_, _)).Times(2);
}
```

---

## 7. Additional Resources

Complement your migration with these related documentation pages:

- [Supported Platforms & Dependencies](/overview/feature-architecture-and-integration/supported-platforms-and-dependencies): Confirm environment compatibility.
- [Troubleshooting & Common Setup Issues](/getting-started/first-steps-validation/troubleshooting): Resolve common upgrade issues.
- [Mocking Cookbook](gmock_cook_book.md): Learn practical mocking patterns, useful after upgrading mocking APIs.
- [Legacy gMock FAQ](gmock_faq.md): Addresses common pitfalls during migrating mock code.
- [Setting Up and Building Tests](/guides/getting-started/setup-build-integration): Incorporate dependency and build updates.

---

## 8. Summary and Best Practices

- Always backup and upgrade incrementally when possible.
- Check your C++ standard and compiler compatibility before upgrading.
- Transition deprecated macros and patterns to modern replacements.
- Verify complete and correct test discovery after migration.
- Utilize verbose logging and diagnostic flags if unexpected behaviors arise.
- Leverage new features gradually once stable on the upgraded version.

<Tip>
Keep your build system, compiler, and dependencies aligned with the latest GoogleTest and GoogleMock version requirements to minimize future migration effort.
</Tip>

---

By following the practical guidance in this page, your migration to newer GoogleTest releases will be structured, predictable, and successful, empowering you to maintain robust and efficient C++ testing workflows.