---
title: "Breaking Changes Summary"
description: "A clear listing of all breaking changes across versions, including signature modifications, deprecated APIs, and platform requirement updates (like C++17 enforcement). Designed to help users quickly assess upgrade impact."
---

# Breaking Changes Summary

This document provides a comprehensive catalog of all breaking changes introduced across various versions of GoogleTest and GoogleMock. It is designed to help users quickly identify modifications that may affect their tests, including changes to API signatures, deprecated components, and new platform requirements such as C++17 enforcement.

---

## Overview of Breaking Changes

Breaking changes are modifications that require users to adjust their test code or environment to ensure continued functionality with newer versions of GoogleTest and GoogleMock. These may include:

- Changes in mock method declarations or macro usage.
- Removal or alteration of deprecated APIs.
- Updates to platform support or compiler standards.

This summary focuses specifically on impactful changes to mocking interfaces and core functionality relevant to the mocking framework.

---

## Key Breaking Changes by Version

### Changes Affecting Mock Method Declaration

- **Transition to `MOCK_METHOD` Macro**: The older family of macros `MOCK_METHODn` (e.g., `MOCK_METHOD1`, `MOCK_CONST_METHOD1`) are superseded by the more versatile `MOCK_METHOD` macro.
  - The new `MOCK_METHOD` takes explicit return type, method name, argument types (wrapped in parentheses), and an optional fourth specifier parameter.
  - User code mocking classes should update their mock methods accordingly.

- **Handling Commas in Template Arguments**:
  - When mocking methods with return types or argument types containing commas (e.g., `std::pair<bool, int>` or templates like `std::map<int, double>`), you must wrap these types in an extra set of parentheses or define type aliases for them.

- **Specifiers and Qualifiers**:
  - The optional fourth parameter allows for `const`, `override`, `noexcept`, `Calltype(...)`, and `ref(...)` qualifiers.
  - Users overriding virtual methods need to ensure correct qualifiers to maintain compatibility.

**Example Migration:**

```cpp
// Old style:
MOCK_CONST_METHOD1(Foo, bool(int));

// New style:
MOCK_METHOD(bool, Foo, (int), (const, override));
```

### Mock Strictness Wrappers

- Wrappers `NiceMock<T>`, `NaggyMock<T>`, and `StrictMock<T>` control the behavior of uninteresting calls:
  - `NiceMock<T>` suppresses warnings on uninteresting calls.
  - `NaggyMock<T>` (default behavior) warns on uninteresting calls.
  - `StrictMock<T>` makes uninteresting calls failures.
- **Caveats:**
  - These wrappers only apply to mock methods declared *directly* in the mock class using `MOCK_METHOD`. Inherited mock methods may not respect strictness.
  - Nesting multiple wrappers (e.g., `NiceMock<StrictMock<T>>`) is not supported.

### Expectations Setup Syntax Change

- The chainable clauses on `EXPECT_CALL` must be used in a specific order:
  1. `.With()` - optional and must be first if used.
  2. `.Times()` - at most once and before `.InSequence()`.
  3. `.InSequence()` - any number of times but before `.After()`.
  4. `.After()` - any number of times but before `.WillOnce()`.
  5. `.WillOnce()` - any number of times, must precede `.WillRepeatedly()`.
  6. `.WillRepeatedly()` - at most once.
  7. `.RetiresOnSaturation()` - at most once, must be last.

- Violating this order will cause runtime errors or warnings.

### Platform and Compiler Requirements

- GoogleTest and GoogleMock now **require C++17** compilers.
- Minimum compiler support includes versions compatible with C++17 features.
- This enforcement affects project build configurations and environments.

### Removal of Deprecated Features

- Old `MOCK_METHODn` macros are deprecated and will be eventually removed. Migration to the modern `MOCK_METHOD` macro is strongly advised.
- Legacy actions macros (`ACTION`, `ACTION_P`, etc.) remain supported but users are encouraged to adopt newer lambda or functor-based actions for cleaner syntax and better type safety.

### Changes in Default Behavior

- Uninteresting calls on mock methods without `EXPECT_CALL` generate warnings by default.
- Users can switch verbosity or change default behavior through:
  - Wrapping mocks with `NiceMock` or `StrictMock`.
  - Using the `--gmock_verbose` flag (`info`, `warning`, `error`).

### Important Notes on Mock Destructors

- Mock classes require virtual destructors to prevent memory leaks and undefined behavior.
- Testing destruction order can be done using a mock method pattern (e.g., mocking a `Die()` method called from the destructor).

### Migration Guidance

- Review all mock classes and update `MOCK_METHODn` macros to the `MOCK_METHOD` macro.
- Handle template-type arguments with commas by wrapping in extra parentheses or type aliases.
- Add or adjust qualifiers in mock method declarations as necessary.
- Adjust expectations chaining order following the prescribed clause sequence.
- Ensure builds are configured with C++17 or later standards.

---

## Tips and Best Practices

- Prefer the `MOCK_METHOD` macro for future-proof mock classes.
- Use `NiceMock` for suppressing warnings on uninteresting calls when tests are stable.
- Use `StrictMock` for stricter verification during debugging or writing new tests.
- Use `ON_CALL` to set default behaviors where expectations (`EXPECT_CALL`) are not required.
- Take advantage of lambda-based actions for concise, expressive behavior stubs.
- Do not ignore the order of chained clauses in `EXPECT_CALL` or `ON_CALL`; follow the documented template to avoid silent errors.
- Always declare destructors `virtual` in mocked interfaces to ensure proper cleanup.

---

## References and Further Reading

- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — Detailed documentation of the `MOCK_METHOD` macro and mocking features.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes for common mocking patterns and usage tips.
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html) — Quick reference for mocking syntax.
- [Strict, Naggy, and Nice Mocks](https://google.github.io/googletest/api/gmock-nice-strict-naggy-mocks.html) — Controlling mock strictness.
- [Setup and Build Integration](https://google.github.io/googletest/guides/getting-started/setup-build-integration.html) — To configure project build with correct compiler standards.

---

<Note>
If you encounter issues after upgrading, please review the migration notes and ensure your build environment is updated to support C++17. Improper use of old macros or unexpected chaining order of expectation clauses are the most common sources of breakage.
</Note>

---

_Last updated with GoogleTest version compatibility as of the current release._
