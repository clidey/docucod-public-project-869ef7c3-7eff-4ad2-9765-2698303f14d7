---
title: "Deprecations"
description: "List of deprecated features, APIs, and patterns, with recommended alternatives and timelines for removal. This page helps developers proactively update their codebases and avoid future issues."
---

# Deprecations

Keeping your codebase current is vital for long-term stability and compatibility. This page provides a clear, actionable list of deprecated features, APIs, and usage patterns within GoogleTest and GoogleMock. It equips developers to proactively identify and replace outdated components with recommended alternatives before they are removed.

---

## Understanding Deprecations

Deprecation is a formal notification that certain features or APIs are no longer recommended for use and will be removed in future releases. Continuing to rely on deprecated components may lead to compilation errors or runtime failures as the project evolves.

This page:

- Lists deprecated items in detail.
- Suggests modern alternatives to adopt.
- Provides timelines and migration guidance.

By regularly consulting this page, developers can minimize technical debt and avoid sudden breaking changes.

---

## Key Deprecated Elements

### 1. Old `MOCK_METHODn` Macros

The previous family of macros — `MOCK_METHODn`, `MOCK_CONST_METHODn`, and their variants — have been superseded by the generic `MOCK_METHOD` macro introduced in 2018. While they continue to work, they are officially deprecated and may be removed in a future release.

#### What to do:

- Replace all `MOCK_METHODn` macros with `MOCK_METHOD` which supports:
  - Variadic argument lists
  - Qualifiers like `const`, `override`, and `noexcept`
  - Calltype and reference qualifiers

#### Example migration:
```cpp
// Old
MOCK_METHOD1(Foo, bool(int));

// New
MOCK_METHOD(bool, Foo, (int));
```

### 2. Legacy `ACTION` and `ACTION_P` Macros

Legacy macros for defining custom actions can be cumbersome and generate cryptic errors. The preferred approach is to use callable objects, lambdas, or implement `ActionInterface<F>` for greater clarity and type safety.

#### What to do:

- Migrate `ACTION` macros to the modern action syntax using lambdas or classes with call operators.

- Use `MakePolymorphicAction` for polymorphic actions.

#### Example migration:
```cpp
// Old
ACTION(IncrementArg1) { return ++(*arg1); }

// New
auto IncrementArg1 = [](int* arg1) { return ++(*arg1); };
```

### 3. Deprecated Macros for Flags and Configuration

Some macros related to defining or declaring flags have new variants or have shifted towards Abseil flags integration. For custom flag declarations, prefer the recommended `GMOCK_DEFINE_*` and `GMOCK_DECLARE_*` macros compatible with Abseil flags.

---

## Migration and Removal Timeline

| Deprecated Feature            | Status                    | Recommended Action                    | Removal Timeline         |
|------------------------------|---------------------------|-------------------------------------|--------------------------|
| Old-style `MOCK_METHODn`    | Supported but deprecated  | Replace with `MOCK_METHOD` macro    | Future major release     |
| Legacy `ACTION` macros      | Supported but deprecated  | Switch to lambdas or `ActionInterface` | Future major release     |
| Custom flag macros (pre-Absl) | Supported but moving towards Abseil macros | Use `GMOCK_DEFINE_*` and `GMOCK_DECLARE_*` | Ongoing Modernization    |

Maintaining your code using current best practices ensures compatibility with future versions and access to new features.

---

## How to Identify Deprecated Usage

- Compiler warnings: Enabling verbose compiler flags will highlight deprecated macro usage.
- Static analysis tools: Many tools can detect legacy macro usage.
- Review build logs for deprecation notes.

---

## Recommended Practices and Tips

- Prefer the generic `MOCK_METHOD` macro for mocking methods. It handles all qualifiers and is more expressive.
- Use lambdas or functor objects for custom actions instead of legacy `ACTION` macros for better readability and error diagnostics.
- Always verify your mock classes compile successfully without warnings related to deprecated macros.
- Regularly consult this page along with the [Mocking API Reference](../../api-reference/mocking-apis/defining-mocks) and [gMock Cookbook](../../docs/gmock_cook_book) for the latest recommended patterns.

---

## Common Pitfalls and Troubleshooting

<AccordionGroup title="Common Issues with Deprecated Features">
<Accordion title="Errors When Mixing Old and New MOCK_METHOD Macros">
If some mock methods in a class still use old macros while others use the new, you may face confusing compiler errors or warnings. Always update all mock methods consistently.
</Accordion>
<Accordion title="Unexpected Behavior with Legacy ACTION Macros">
Legacy ACTION macros can have subtle type deductions and side effects. If you see strange test failures, consider rewriting the action with a lambda or a callable class.
</Accordion>
<Accordion title="Silent Failures Due to Deprecated Flags">
Flag macros defined outside the recommended methods may not interact correctly with the flag parsing system, leading to unexpected flag values.
</Accordion>
</AccordionGroup>

---

## Troubleshooting Deprecated Macro Issues

<Steps>
<Step title="Update MOCK_METHODn to MOCK_METHOD">
Identify all instances of old-style mock macros and replace them systematically with the modern `MOCK_METHOD` macro.
</Step>
<Step title="Replace ACTION Macros with Lambdas or Functors">
Rewrite custom actions using lambda expressions or classes with call operators for cleaner, safer code.
</Step>
<Step title="Check Flag Macro Definitions">
Ensure you use `GMOCK_DEFINE_*` and `GMOCK_DECLARE_*` macros for flag definitions to integrate cleanly with Google Mock and Abseil.
</Step>
<Step title="Rebuild and Validate">
Compile your tests with warnings enabled and run them to verify correctness and absence of deprecated usage warnings.
</Step>
</Steps>

---

## Additional Resources

- [Mocking API Reference: Defining and Using Mocks](../../api-reference/mocking-apis/defining-mocks)
- [gMock Cookbook](../../docs/gmock_cook_book)
- [Matchers, Actions, and Customization Reference](../../api-reference/mocking-apis/matchers-actions)
- [Nice, Naggy, and Strict Mocks](../../api-reference/mocking-apis/nice-strict-mocks)
- [Setting up Your Testing Environment](../../guides/getting-started/setup-environment)

---

For a deeper understanding of mocking techniques, and to ensure your test infrastructure remains robust and maintainable, regularly consult the [gMock Cookbook](../../docs/gmock_cook_book) and keep up with the [Version History and Notable Features](../release-highlights/version-history).
