---
title: "Step-by-Step Upgrade Guide"
description: "Direct instructions for upgrading GoogleTest, detailing steps to move between major versions safely. Covers best practices, integration notes, and tips for catching regressions."
---

# Step-by-Step Upgrade Guide

This guide provides clear, actionable instructions to upgrade your GoogleTest installation safely and effectively. It focuses on guiding users through major version upgrades, ensuring compatibility, and minimizing disruption.

---

## 1. Preparation Before Upgrade

- **Check Current Version**: Determine your current GoogleTest version to understand the changes that apply.
- **Review Compatibility**: Confirm that your development environment supports the minimum C++ standard required for the target version (e.g., C++17 for 1.17.x).
- **Backup Existing Setup**: Save current GoogleTest directories, build files, and test binaries.
- **Read Release Notes**: Study the release notes and breaking changes for your target version to identify potential code impacts.


## 2. Upgrade Steps

### 2.1 Acquire New Version

- **Download the Latest Release**: Get the source from the official GitHub repository [GoogleTest Releases](https://github.com/google/googletest/releases).
- **Use Package Managers**: If preferred, update via your package manager or build system integrations (e.g., CMake FetchContent).

### 2.2 Build and Installation

- **Build with C++17 or Later**: Ensure your compiler is set to C++17 or above. Adjust your build system accordingly.
- **Use Recommended Build Options**: When using CMake, enable/disable components such as `BUILD_GMOCK` or `BUILD_GTEST` as per your project needs.
- **Install Libraries and Headers**: Replace or update the installed GoogleTest libraries and headers.

### 2.3 Integration Changes

- **Verify Linkage**: Adjust linking flags if needed to match the new versionâ€™s requirements, especially regarding threading libraries.
- **Update Includes**: Confirm your test code includes `gtest/gtest.h` and `gmock/gmock.h` correctly.
- **Initialize Framework Properly**: Use `testing::InitGoogleTest()` and `testing::InitGoogleMock()` appropriately in your test runner.

### 2.4 Code Adjustments

- **Address Deprecated Features**: Refactor any deprecated APIs or usage patterns noted in the deprecation and breaking change notices.
- **Update Mock Definitions**: Migrate legacy macros such as `MOCK_METHODn` to the modern `MOCK_METHOD` syntax for better compatibility and maintainability.
- **Handle Mock Strictness Changes**: Review usages of `NiceMock`, `NaggyMock`, and `StrictMock` per new semantics.
- **Adapt to C++17 Features**: Leverage and comply with C++17 language features, which may affect certain mock behaviors and compiler diagnostics.


## 3. Validating the Upgrade

- **Run All Existing Tests**: Ensure no regressions have been introduced by rerunning your full test suite.
- **Leverage Verbose Logging**: Use `--gmock_verbose=info` during tests to trace mock interactions and verify expectations.
- **Check for Warnings and Errors**: Address any warnings about uninteresting calls or unexpected behavior.


## 4. Best Practices and Tips

- **Gradual Migration**: If upgrading across multiple major versions, consider incremental upgrades to better isolate issues.
- **Use ON_CALL vs EXPECT_CALL Judiciously**: Avoid over-specifying expectations to keep tests robust.
- **Maintain Virtual Destructors**: Ensure all base classes for mocks have virtual destructors to prevent memory and object lifecycle issues.
- **Use Modern Mocking APIs**: Prefer modern mocking features like action lambdas, matchers, and sequence controls to write clear and maintainable tests.


## 5. Troubleshooting

### Common Issues

- **Linker Errors**: Verify all required GoogleTest and GoogleMock libraries are linked properly.
- **Compilation Failures**: Ensure C++17 standard is set and legacy macro usage is updated.
- **Uninteresting Call Warnings**: Use `NiceMock` or provide wildcard expectations to suppress unwanted warnings.
- **Failing Expectations**: Use verbose test output to diagnose mismatched calls and update tests or mocks accordingly.

### Resources

- Refer to the [Mocking Reference](reference/mocking.md) for details on macros and constructs.
- Consult the [gMock Cookbook](guides/core-testing-workflows/using-mocks-in-tests.md) for practical mocking recipes and patterns.
- Use the [Legacy gMock FAQ](faq/troubleshooting/mocking-misuse-errors.md) for problem-solving guidance.


## 6. Additional References

- [Latest Release Overview](../release-notes-history/latest-release.md) for up-to-date release details.
- [Breaking Changes & Migration Guide](../migrations-breaking-changes/breaking-changes.md) for a deeper look at incompatible changes.
- [Configuring Your Project](../../getting-started/first-steps/configure-project.md) for build integration.
- [Setting Expectations and Mock Behavior](../api-reference/mocking-api/call-expectations.md) for advanced expectation control.


---

This guide is designed to empower you to upgrade GoogleTest with confidence, ensuring your tests remain effective and maintainable as you adopt the latest improvements.
