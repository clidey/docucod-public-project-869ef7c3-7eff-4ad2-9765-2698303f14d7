---
title: "New Features and Improvements"
description: "Detailed descriptions of major new features and usability enhancements introduced in each release. Understand how new testing capabilities and upgraded tooling can benefit your development process."
---

# New Features and Improvements

Detailed descriptions of major new features and usability enhancements introduced in each release. Understand how new testing capabilities and upgraded tooling can benefit your development process.

---

## Overview

This page focuses exclusively on the major new features and significant usability enhancements introduced in each GoogleTest release. It aims to provide users with actionable insights on how new testing capabilities and tooling improvements can help streamline development and testing workflows.

Unlike general release notes or bug fix summaries, this documentation highlights changes that improve testing expressiveness, efficiency, and maintainability — enabling developers to write better tests faster.

## Key Enhancement Areas

The content is organized around core areas of impact:

### 1. Enhanced Mocking Features
- **Expanded macro and qualifier support**: New options for `MOCK_METHOD` allow mocking a broader variety of function signatures, including improved handling of const, noexcept, call types, and reference qualifiers.
- **Improved behavior control**: Greater control and clarity around setting default behaviors (`ON_CALL`) versus strict expectations (`EXPECT_CALL`), reducing common user errors and enabling more natural test writing.
- **Advanced expectation sequencing**: New capabilities for imposing call order constraints, supporting both full sequences (`InSequence`) and partial ordering (`After` clauses or sequences with multiple sequence objects).
- **Support for move-only types**: Mocking methods that accept or return move-only types (e.g. `std::unique_ptr`) has become fully supported and simpler to use.

### 2. Matcher and Action Improvements
- **Richer built-in matchers and combinators**: Additional matchers for multi-argument tuples, nested containers, and pointer dereferencing allow more expressive argument validation.
- **Custom matcher and action enhancements**: Streamlined macros and interfaces for writing custom polymorphic and parameterized matchers and actions increase flexibility.
- **Conditional and stateful actions**: Enhanced support for complex behaviors, including chaining multiple actions (`DoAll`), ignoring return values (`IgnoreResult`), and interacting with test state.

### 3. Improved Test Diagnostics and Output
- **Informative failure messages**: More detailed and context-rich explanations for failures, including argument mismatch descriptions, stack traces, and failure location annotations.
- **Adjustable verbosity**: Ability to fine-tune the verbosity of mock invocation warnings, enabling users to toggle between info, warning, and error levels for uninteresting calls.

### 4. Strictness Modifiers and Test Robustness
- **NiceMock, NaggyMock, StrictMock classes**: Explicit support and explanations for controlling how mocks treat uninteresting calls, helping developers harden or relax tests as they evolve.
- **Sticky vs retiring expectations**: Clarifications and new clauses like `.RetiresOnSaturation()` help control the lifecycle of expectations to avoid brittle tests.

### 5. Integration and Build Improvements
- **Faster compilation strategies**: Tips and improved patterns for mocking that reduce compilation overhead by moving constructors/destructors out of headers.
- **Multi-threading and deadlock avoidance**: Guarantees about thread safety and action invocation contexts provide confidence when running tests in parallel.

## Walkthrough of User Workflow Improvements

### Defining Mocks

Users can define mock classes using `MOCK_METHOD`, now enhanced with expanded qualifiers and template-friendly syntax. This empowers creation of mocks for more complex real-world interfaces without boilerplate.

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(std::unique_ptr<Buzz>, MakeBuzz, (StringPiece text), (override));
  MOCK_METHOD(bool, ShareBuzz, (std::unique_ptr<Buzz> buzz, int64_t timestamp), (override));
};
```

### Setting Default and Expected Behaviors

Default behaviors separated from expectations via `ON_CALL` and `EXPECT_CALL` constructs empower users to specify baseline mock behavior while precisely verifying calls where necessary.

```cpp
ON_CALL(foo, GetSize()).WillByDefault(Return(1));
EXPECT_CALL(foo, Describe(5)).Times(3).WillRepeatedly(Return("Category 5"));
```

### Controlling Call Order and Expectations

Explicit ordering with `InSequence` ensures calls happen in defined order, with the flexibility of partial orders via `After()` and multiple `Sequence` objects. Expectations can be chained to retire automatically upon saturation.

```cpp
Sequence s;
EXPECT_CALL(foo, DoA(1)).InSequence(s);
EXPECT_CALL(foo, DoA(2)).InSequence(s).RetiresOnSaturation();
EXPECT_CALL(foo, DoA(3)).InSequence(s);
```

### Using Strictness Modifiers

Switch between `NiceMock`, `NaggyMock`, and `StrictMock` to control how unexpected or uninteresting calls are handled, guiding tests from permissive to strictly verified states.

```cpp
NiceMock<MockFoo> mock_foo;   // Suppresses warnings for uninteresting calls
NaggyMock<MockFoo> mock_foo;  // Default: warns
StrictMock<MockFoo> mock_foo; // Fails test on uninteresting calls
```

### Assertions and Diagnostics

Enhanced output verbosity settings enable users to receive detailed insights into mock calls and failures during test runs. This integrated feedback improves debugging efficiency with clearer error messages and dedicated explanatory notes.

### Common Pitfalls and Remedies

- Avoid multiple `.With()` or `.Times()` clauses on the same expectation; the system enforces correct usage.
- Ensure expectations are set before exercising mocks to avoid undefined behavior.
- Use `.RetiresOnSaturation()` to avoid upper-bound violations with sticky expectations.

## Tips and Best Practices

- When mocking methods with move-only types, prefer lambdas for actions that generate fresh objects.
- Use catch-all expectations (`EXPECT_CALL(foo, Bar(_)).Times(AnyNumber())`) cautiously to avoid masking errors.
- Leverage `DefaultValue<T>::Set()` to customize default return values globally for your domain types.
- Use `Invoke()` and `InvokeWithoutArgs()` to integrate real or complex behaviors into mocks.

## Troubleshooting

- In multithreaded scenarios, make sure test code sets expectations serially and that mock locks are respected.
- If you encounter warnings about uninteresting calls, consider converting your mocks to `NiceMock` unless strictness is needed.
- Use `Mock::VerifyAndClearExpectations()` to manually verify mocks when lifetimes exceed automatic scope destruction.

## Summary

This page documents all significant new features and usability enhancements for mocking and test writing in GoogleTest, designed to empower developers with better control, expressiveness, and diagnostics. Whether you are creating mocks, configuring behavior, imposing call order, or tuning test strictness, these improvements deliver a modern, robust testing experience.

---

## See Also

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes optimized for productive mocking
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html) — Quick reference for mocking syntax
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — Detailed API documentation
- [Strict, Naggy, and Nice Mocks](https://google.github.io/googletest/reference/mocking_and_matchers/strictness_and_nice_mocks.html) — Understanding mock strictness modifiers
- [Argument Matching](https://google.github.io/googletest/reference/mocking_and_matchers/argument_matching.html) — Techniques and examples for argument matchers
- [Actions Reference](https://google.github.io/googletest/reference/actions.html) — Builtin actions to control mock behavior

---

## Additional Resources

- GoogleMock GitHub repository: [https://github.com/google/googletest](https://github.com/google/googletest)
- GoogleTest Primer: [https://google.github.io/googletest/primer.html](https://google.github.io/googletest/primer.html)
- Testing and Mocking Best Practices Guide

----

<Callout>
**Note:** Always set expectations before code execution to avoid undefined behavior in tests. Use strictness modifiers to progressively harden your tests and suppress unwanted noise.
</Callout>

---

## Revision History and Contribution

For detailed version-wise release notes, refer to the [Version Release Notes](https://github.com/google/googletest/blob/main/changelog/release-history/version-release-notes.md) page.

Contributions and feature proposals can be made through the official GoogleTest GitHub repository and following the community guidelines.

---

<Info>
This documentation page focuses on new features and improvements as part of the GoogleTest and GoogleMock ecosystem. For complete release history, security notices, and migration details, consult the dedicated release notes and upgrade guides.
</Info>
