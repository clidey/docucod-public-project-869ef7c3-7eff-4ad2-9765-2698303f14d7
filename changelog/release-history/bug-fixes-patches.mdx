---
title: "Bug Fixes and Patches"
description: "Documents reliability improvements, resolved issues, and small patches. Enables teams to assess project stability and identify when issues they've encountered have been addressed."
---

# Bug Fixes and Patches

This page documents the collection of fixes made to improve the reliability, stability, and correctness of GoogleTest. Tracking these resolved issues helps users understand when key bugs have been addressed and ensures confidence in upgrading to newer versions.

---

## 1. Stability and Reliability Improvements

### Handling Fatal and Non-Fatal Failures Uniformly

- Enhanced distinctions between fatal (`ASSERT_` macros) and non-fatal (`EXPECT_` macros) assertions to ensure tests behave as expected.
- Added safeguards so that fatal failures abort the current function cleanly without leaving partial state or causing undefined behavior.
- Example: The fix ensures that `ASSERT_*` inside void-returning functions properly abort execution without cascading failures.

### Improved Stack Trace Collection

- Refined how stack traces are captured and displayed for assertion failures, especially avoiding including internal GoogleTest frames unless explicitly enabled.
- Addresses issues where stack traces could be incomplete or misleading under multi-threaded executions.

### Thread Safety and Concurrency Fixes

- Fixes to allow concurrent calls to assertions and trace macros (`SCOPED_TRACE`) from multiple threads.
- Preservation of scoped trace points per-thread to prevent interference across threads, ensuring failure messages accurately reflect the test context.
- Improved synchronization of property recording to prevent corruption or inconsistent test metadata.

## 2. Assertion Accuracy and Output Clarity

### Enhanced Assertion Error Messages

- Fixes to assertion macros to better print expected and actual values, especially for complex types and streamable types.
- Improved message formatting for floating-point comparisons to include precision details.
- Corrected handling and display of string comparison failures including C strings and wide strings.

### Assertions in Subroutines and Helper Functions

- Resolved issues where fatal assertions in helper functions would not terminate tests as expected.
- Provided guidance and internal fixes to enable `HasFatalFailure()` to be reliably used to check test state after subroutine assertions.

### Proper Reporting of Disabled Tests and Skipped Tests

- Ensured disabled tests marked with the `DISABLED_` prefix are counted correctly and emit warnings appropriately.
- Fixed handling of `GTEST_SKIP()` to reflect skipped status in reports and prevent test execution downstream.

## 3. Death Tests and Exception Handling

### Correct Exception Interception

- Resolved scenarios where exceptions thrown within death test macros were not caught properly, causing test runners to unexpectedly terminate.
- Adjusted output messages to include exception information clearly in death test failure reports.

### Death Test Styles Stability

- Improved robustness for the two death test execution styles (`fast` and `threadsafe`), including management of test forks and subprocesses.
- Fixed leaks and resource mismanagement during death test runs.

## 4. Test Environment and Fixture Management

### Global Environment Setup and Tear-Down Bug Fixes

- Fixed ordering issues and failure reporting in global test environment setup and teardown.
- Correct propagation and recording of failures occurring in `SetUp()` and `TearDown()` phase of environments and test fixtures.

### Test Parameterization and Instantiation

- Corrected issues with parameterized tests that had missing instantiations, preventing silent test omissions.
- Added warnings for test suites defined with `TEST_P` but missing `INSTANTIATE_TEST_SUITE_P`.

## 5. Miscellaneous Fixes

### Improved Flag and Environment Variable Processing

- Reliability fixes for command-line flag parsing and environment variables, ensuring repeat, shuffle, and filter flags operate consistently.

### Output Formats and Reporting

- Corrected formatting of XML and JSON reports to include proper test properties and failure details.
- Fixed filename and line number reporting in failure messages generated by macros like `ADD_FAILURE_AT` and `GTEST_FAIL_AT`.

---

## Practical Tips

- Utilize `SCOPED_TRACE` macros within loops or subroutines to maintain contextual failure information, especially valuable after these fixes to trace visibility.
- When using death tests, prefer naming suites with `*DeathTest` suffix to ensure correct run order and isolation.
- Use `HasFatalFailure()` after calls to helpers with assertions to detect test failures properly.
- If you encounter strange failures due to mixed test fixtures within a test suite, refactor to maintain fixture consistency.

## Troubleshooting Common Failure Scenarios

<AccordionGroup title="Troubleshooting Common Issues">  
<Accordion title="Fatal Failures Not Aborting Execution">  
Ensure that fatal assertions are used inside void-returning functions. Using `ASSERT_*` in non-void functions triggers compilation errors or unexpected behavior. Use non-fatal assertions if function returns a value.
</Accordion>  
<Accordion title="Unexpected Exceptions Escaping Death Tests">  
Verify that `catch_exceptions` flag is enabled. Exceptions thrown inside death tests must not propagate; otherwise, the test framework may abort prematurely.
</Accordion>  
<Accordion title="Missing Parameterized Tests">  
Always provide corresponding `INSTANTIATE_TEST_SUITE_P` for every `TEST_P` definition unless deliberately suppressed. Missing instantiation causes tests to be skipped silently, now warned explicitly.
</Accordion>  
<Accordion title="Disabled Tests Still Executing">  
Confirm that disabled tests start with the `DISABLED_` prefix. Use `--gtest_also_run_disabled_tests` flag to run them when needed.
</Accordion>  
</AccordionGroup>

---

## Examples of Fixed Failure Outputs

```none
Value of: expected_value
  Actual: 5
Expected: 10

File: example_test.cc:42

Google Test trace:
example_test.cc:36: Loop iteration 3

Stack trace: ...
```

```none
Death test failed: statement did not cause process to terminate.

Expected exit code: 1
Expected stderr to match: "Error.*"

If exceptions thrown, ensure catch_exceptions flag is set.
```

---

## Credits

These fixes are the result of extensive user feedback, internal testing, and collaboration from the GoogleTest developer community. For contribution guidelines and details, please see CONTRIBUTING.md in the repository.

---

_For full details about release history and major changes, please see the [Version Overview](version-overview) and [Feature Additions](feature-additions) pages._