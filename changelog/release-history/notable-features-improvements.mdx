---
title: "Notable Features & Improvements"
description: "Detailed summaries of key feature additions and enhancements per release cycle, highlighting how these changes benefit users and impact daily testing workflows."
---

# Notable Features & Improvements

This page provides a detailed summary of significant features and enhancements added to GoogleTest and GoogleMock during recent release cycles. It emphasizes how these updates improve the user experience, streamline testing workflows, and enrich mocking capabilities.

---

## Feature Highlights by Release

### Enhanced Mocking Syntax and Usability
- **MOCK_METHOD Macro Improvements**: Introduced a modernized, flexible `MOCK_METHOD` macro to streamline mock method declarations, supporting various qualifiers such as `const`, `override`, `noexcept`, and calling conventions. This enables cleaner mock classes and better compatibility with complex method signatures.

- **Overload Mocking Support**: Enhanced support for mocking overloaded methods, enabling developers to mock different method signatures clearly and effectively using the updated macro syntax.

- **Mocking Class Templates**: Users can now mock templated classes naturally, without complex workarounds, leading to greater coverage of templated interfaces.

### Sophisticated Expectation Control
- **Flexible `EXPECT_CALL` Modifiers**: Added richer modifiers to the `EXPECT_CALL` macro enabling fine-grained control over mock invocation counts (`Times()`, `AtLeast()`, `AtMost()`, etc.), call ordering (`InSequence`, `After`), and method behavior (`WillOnce()`, `WillRepeatedly()`, `RetiresOnSaturation()`).

- **Multi-Argument Matchers with `.With()`**: Allowed matching multiple arguments collectively via tuple matchers, enabling assertions on complex parameter relationships in a single expectation.

- **Cardinality Inference**: Simplified expectation setup with the automatic inference of call counts based on `WillOnce` and `WillRepeatedly` clauses, reducing boilerplate while maintaining precise control.

### Default Behavior Management
- **ON_CALL Enhancements**: Introduced the `ON_CALL` macro to specify default mock method behaviors without establishing call expectations, promoting cleaner tests and better separation of behavior defaults and explicit expectations.

- **Default Value Configuration**: `::testing::DefaultValue<T>` allows users to specify default return values for mock methods for arbitrary types, supporting types beyond built-ins, including unique pointers to improve seamless mocking.

### Mock Strictness Wrappers
- **NiceMock, NaggyMock, and StrictMock Classes**: Introduced these wrapper classes to control handling of uninteresting calls. Users can suppress warnings (`NiceMock`), display warnings (`NaggyMock`), or treat uninteresting calls as errors (`StrictMock`), providing greater flexibility and test robustness.

- **Constructor Inheritance and Compatibility**: These wrappers seamlessly inherit constructors from the underlying mock class, supporting mocks with complex constructors, including those with multiple or move-only arguments.

### Advanced Mocking Patterns and Utilities
- **Delegating Mocks**: Support for delegating calls within mocks, either to a fake implementation or to the real object, enabling incremental adoption of mocks and maintaining behavioral consistency.

- **Support for Move-Only Types**: Added explicit support for mocking methods returning or accepting move-only types (like `std::unique_ptr`), allowing modern C++ idioms in test doubles.

- **Custom Matchers and Actions**: Extended mechanisms for writing custom polymorphic and monomorphic matchers, parameterized matchers, and action templates, empowering users to tailor mock behaviors and verifications precisely.

- **Sequence and Partial Ordering Controls**: Users can impose strict or partial order constraints on mock calls using `Sequence` objects, `InSequence` scopes, and `After()` clauses, allowing complex interaction modeling.

### Testing and Debugging Aids
- **Verbose Mock Output**: Added a `--gmock_verbose=LEVEL` flag to control logging detail, where `info` level reveals every mock interaction, including stack traces; `warning` level logs warnings only; `error` level suppresses informational messages.

- **Leak Detection and Verification Control**: Automatically detects leaked mocks causing test failures, with support for allowing mocks to be leaked intentionally and verifying and clearing expectations explicitly at any point.

- **Test Suite Integration**: Improved compatibility and integration with multiple platforms, build systems, and continuous integration environments to ensure robust test discovery and execution.

---

## Practical User Benefits

- **Reduced Boilerplate**: Simplified syntax using updated macros and automatic cardinality inference means writing mocks and expectations is easier and less error-prone.

- **More Expressive and Readable Tests**: Chaining of expectation modifiers and support for complex argument matching allows expressing test intentions clearly and robustly.

- **Greater Control Over Call Behavior**: With strictness wrappers and sequence controls, users can tailor the test's sensitivity to mock interactions, balancing strict validation and test maintenance needs.

- **Modern C++ Compatibility**: Support for move-only types and calling conventions ensures GoogleMock keeps pace with modern C++ development practices.

- **Better Debugging Insight**: Detailed logs with stack traces and traceable mock method calls aid rapid diagnosis and resolution of test failures.

---

## Code Examples

### Defining a Mock Class With MOCK_METHOD
```cpp
#include <gmock/gmock.h>

class Foo {
 public:
  virtual ~Foo() = default;
  virtual int GetSize() const = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
};
```

### Setting Expectations and Default Actions
```cpp
#include <gmock/gmock.h>
using ::testing::Return;
using ::testing::_;

MockFoo mock;

ON_CALL(mock, GetSize())
    .WillByDefault(Return(10));  // default behavior

EXPECT_CALL(mock, GetSize())
    .Times(3)
    .WillOnce(Return(1))
    .WillRepeatedly(Return(2));  // expected calls and return values

int size1 = mock.GetSize();  // returns 1
int size2 = mock.GetSize();  // returns 2
```

### Using StrictMock to Enforce Calls
```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_mock;
EXPECT_CALL(strict_mock, GetSize()).Times(1);

// Any calls besides the expected one will cause test failure
```

### Sequencing Calls
```cpp
using ::testing::InSequence;

{
  InSequence s;
  EXPECT_CALL(mock, Initialize());
  EXPECT_CALL(mock, Execute());
  EXPECT_CALL(mock, Cleanup());
}
```

This enforces the order: `Initialize()` → `Execute()` → `Cleanup()`.

---

## Troubleshooting and Best Practices

- Always declare expectations *before* calling the mock method to avoid undefined behavior.
- Use `NiceMock` when tests should ignore uninteresting calls silently.
- Use `StrictMock` when you want tests to fail on unexpected calls, ensuring strict verification.
- Employ `ON_CALL` for default method behaviors to reduce expectation clutter.
- Leverage verbose logging (`--gmock_verbose=info`) to diagnose why certain expectations may not be matched.

---

## Additional Resources
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md) for quick reference on mocking syntax.
- [gMock Cookbook](docs/gmock_cook_book.md) for recipes and advanced use cases.
- [Mocking Reference](docs/reference/mocking.md) for detailed API descriptions.
- [GoogleMock for Dummies](docs/gmock_for_dummies.md) for beginner-friendly introduction.
- [Strictness Wrappers Documentation](api-reference/mocking-apis/strictness-wrappers.md) for controlling mock strictness.

---

## Summary
This page highlights key feature additions and improvements in GoogleTest and GoogleMock that empower users to write clearer, more maintainable, and more powerful unit tests. The enhancements enable precise control of mock behaviors and expectations, provide richer mocking idioms aligned with modern C++, and offer tools to diagnose test failures more effectively.

For a detailed understanding of each feature and how to adopt it in your tests, please consult the associated guides and references listed above.

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/reference/mocking.md", "range": "1-600"}, {"path": "docs/gmock_cheat_sheet.md", "range": "1-350"}, {"path": "docs/gmock_for_dummies.md", "range": "1-350"}, {"path": "docs/gmock_cook_book.md", "range": "1-1150"}, {"path": "googlemock/include/gmock/gmock-nice-strict.h", "range": "1-330"}]} />