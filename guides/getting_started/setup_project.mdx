---
title: "Setting Up Your Test Project"
description: "Learn how to set up a GoogleTest/GoogleMock project from scratch, including obtaining dependencies, configuring your build system (CMake/Bazel), and structuring your first test files. Ideal for developers new to the frameworks, this guide ensures you can start writing tests quickly."
---

# Setting Up Your Test Project

## Overview

This guide walks you through setting up a new testing project using GoogleTest and GoogleMock from scratch. Whether you are starting a fresh C++ project or integrating testing into an existing one, this document helps you obtain the dependencies, configure your build environment using popular build systems like CMake or Bazel, and structure your first test files effectively.

GoogleTest (`googletest`) and GoogleMock (`googlemock`) are designed to be flexible and easy to integrate with your project’s workflow. This guide emphasizes actionable steps to get you testing quickly.

---

## Prerequisites

Before setting up your test project, ensure you have:

- A C++17 compliant compiler (e.g., GCC 7+, Clang 5+, MSVC 2017+).
- CMake 3.14 or later installed, if using CMake as your build system.
- (Optional) Bazel installed if you prefer Bazel builds.
- Basic familiarity with your chosen build tool.
- Internet access to download dependencies from GitHub unless you prefer manual downloads.


## Step 1: Obtaining GoogleTest and GoogleMock

GoogleTest and GoogleMock are distributed together and can be obtained from the [GoogleTest GitHub repository](https://github.com/google/googletest).

### Option 1: Clone the Repository Directly

```bash
# Clone the googletest repository
$ git clone https://github.com/google/googletest.git -b main
$ cd googletest
```

### Option 2: Add as a Git Submodule

If you have an existing Git project, consider adding GoogleTest as a submodule:

```bash
$ git submodule add https://github.com/google/googletest.git third_party/googletest
$ git submodule update --init --recursive
```

### Option 3: Use CMake FetchContent to Download at Configure Time

This method automatically fetches GoogleTest during your build configuration (recommended for easy dependency management - see "Incorporating Into An Existing CMake Project" section below).

---

## Step 2: Configuring Your Build System with CMake

This section explains two ways to set up GoogleTest/GoogleMock with CMake: as a standalone project or embedded into your own CMake project.

### Building GoogleTest/GoogleMock as a Standalone Project

If you want to build and install GoogleTest separately, you can treat it as an independent project:

```bash
# From the googletest directory
mkdir build && cd build
cmake ..             # Default builds both GoogleTest and GoogleMock
# To build only GoogleTest, disable GoogleMock
# cmake .. -DBUILD_GMOCK=OFF
make                 # Build the project (on Unix-like systems)
sudo make install    # (Optional) Installs libraries and headers to /usr/local
```

- On Windows with Visual Studio, the `cmake` step generates a Visual Studio solution file (`gtest.sln`) for building.
- On MacOS with Xcode, an `.xcodeproj` file is generated.

<Tip>
If you build only GoogleTest by setting `-DBUILD_GMOCK=OFF`, you save build time and link dependencies but lose GoogleMock features.
</Tip>

### Incorporating GoogleTest into Your Existing CMake Project

Integrate GoogleTest seamlessly by adding it to your project’s `CMakeLists.txt`.

#### Recommended: Use FetchContent to Download GoogleTest

```cmake
cmake_minimum_required(VERSION 3.14)
project(your_project)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # On Windows: align runtime library
FetchContent_MakeAvailable(googletest)

add_executable(your_test your_test.cc)
target_link_libraries(your_test gtest_main gmock_main)
include(GoogleTest)
gtest_discover_tests(your_test)
```

This ensures:

- The GoogleTest source is fetched automatically during your project's configure step.
- Compiler and linker settings are consistent.

#### Alternative: Add Subdirectory

If you have GoogleTest source available locally (via cloning or submodule), you can include it directly:

```cmake
add_subdirectory(path/to/googletest)

add_executable(your_test your_test.cc)
target_link_libraries(your_test gtest_main gmock_main)
include(GoogleTest)
gtest_discover_tests(your_test)
```

#### Important Notes

- Use `gtest_main` and `gmock_main` to get a pre-built `main()` function that initializes GoogleTest/GoogleMock.
- On Windows, to avoid runtime library mismatch errors, set `gtest_force_shared_crt` to `ON`.

---

## Step 3: Organizing Your Test Files

Start by creating your test source files alongside your project source files or in a dedicated `test` directory.

### Writing Your First Test File

Create `example_test.cc`:

```cpp
#include <gtest/gtest.h>

// Simple test case example
TEST(SimpleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
  EXPECT_NE(1 + 1, 3);
}
```

<Caution>
Name test suites and tests using valid C++ identifiers without underscores or special characters to avoid problems with test filtering.
</Caution>

### Using Test Fixtures for Shared Setup

To reuse common test data or setup:

```cpp
class MyTestFixture : public testing::Test {
 protected:
  void SetUp() override {
    // Code here will be called before each test.
  }

  void TearDown() override {
    // Code here will be called after each test.
  }

  // Shared objects for tests
};

TEST_F(MyTestFixture, Test1) {
  EXPECT_TRUE(true);
}

TEST_F(MyTestFixture, Test2) {
  EXPECT_FALSE(false);
}
```

---

## Step 4: Building and Running Your Tests

Once your tests are ready, build them via your build tool.

### Using CMake Command Line

```bash
cmake -S . -B build
cmake --build build
ctest --output-on-failure
```

Or run directly:

```bash
./build/your_test
```

Your tests will run, and output will display test progress and results.

### Using Visual Studio or Xcode

Open the generated solution/project and build/run tests within the IDE.

---

## Troubleshooting Common Issues

### Compiler Support

- GoogleTest requires C++17.
- Set `set(CMAKE_CXX_STANDARD 17)` in your `CMakeLists.txt`.

### Runtime Library Mismatch on Windows

- Set `gtest_force_shared_crt` to `ON` in CMake when fetching GoogleTest to align CRT linkage.

### Linking Errors

- Ensure you link against `gtest`, `gtest_main`, `gmock`, or `gmock_main` as appropriate.
- Verify that your build system includes Googletest include and lib directories.

### Multithreaded Tests

- GoogleTest supports multithreaded tests if your environment supports pthreads.
- You may need to define `-DGTEST_HAS_PTHREAD=1` and link pthread explicitly if not using CMake.

---

## Best Practices

- Prefer using `gtest_main` or `gmock_main` to avoid writing your own `main()` unless you need custom initialization.
- Organize tests into suites corresponding to tested components.
- Use `TEST_F` for tests that share fixture setup.
- Keep tests independent and repeatable.

---

## Next Steps

- Explore [Writing Your First Tests and Mocks](/guides/getting_started/first_tests) for creating test and mock classes.
- Learn more about [Parameterized and Typed Tests](/guides/core_testing_patterns/parameterized_tests) to test with multiple inputs.
- Review [Running and Interpreting Test Results](/getting-started/first-steps/running-tests) for understanding test outputs.

---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Primer](docs/primer.md)
- [Quickstart: Building with CMake](docs/quickstart-cmake.md)
- [GoogleTest Advanced Topics](docs/advanced.md)

---

Congratulations! Your GoogleTest/GoogleMock test project is now set up and ready for test development.

---

## Example Minimal `CMakeLists.txt` for a Test Project

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTestProject)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_test example_test.cc)
target_link_libraries(my_test gtest_main gmock_main)

include(GoogleTest)
gtest_discover_tests(my_test)
```

## Sample `example_test.cc`

```cpp
#include <gtest/gtest.h>

TEST(ExampleTest, Addition) {
  EXPECT_EQ(2 + 2, 4);
}
```

Building and running this will exercise your first test with GoogleTest and GoogleMock.