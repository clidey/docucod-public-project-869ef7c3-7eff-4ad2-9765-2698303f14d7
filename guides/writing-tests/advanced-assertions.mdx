---
title: "Using Assertions Effectively"
description: "Explore the rich set of assertions available in GoogleTest. This guide demonstrates their use for comparing values, checking exceptions, and testing error conditions. Includes advice on best practices for clear and maintainable tests."
---

# Using Assertions Effectively

Explore the rich set of assertions available in GoogleTest. This guide demonstrates their use for comparing values, checking exceptions, and testing error conditions. Includes advice on best practices for clear and maintainable tests.

---

## 1. Understanding Assertion Types and Their Purpose

GoogleTest provides assertions to verify conditions in test code. Choose assertions based on whether you want to continue test execution upon failure or abort immediately.

- **EXPECT_ Macros**: Generate *nonfatal* failures. Tests continue after failure.
- **ASSERT_ Macros**: Generate *fatal* failures. Abort the current function immediately.

**Tip:** Use `ASSERT_` macros in situations where subsequent test steps depend on conditions being true, and use `EXPECT_` macros to check multiple independent conditions in the same test.

---

## 2. Basic Assertions for Boolean and Binary Comparisons

### Boolean Assertions

- `EXPECT_TRUE(condition) / ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition) / ASSERT_FALSE(condition)`

Use these when you want to verify that a condition or expression evaluates to true or false.

### Binary Comparison Assertions

Use these for direct comparisons between two values:

- Equality: `EXPECT_EQ(val1, val2) / ASSERT_EQ(val1, val2)`
- Inequality: `EXPECT_NE(val1, val2) / ASSERT_NE(val1, val2)`
- Less than: `EXPECT_LT(val1, val2) / ASSERT_LT(val1, val2)`
- Less or equal: `EXPECT_LE(val1, val2) / ASSERT_LE(val1, val2)`
- Greater than: `EXPECT_GT(val1, val2) / ASSERT_GT(val1, val2)`
- Greater or equal: `EXPECT_GE(val1, val2) / ASSERT_GE(val1, val2)`

**Note:** Pointers compared by `EXPECT_EQ` or `EXPECT_NE` compare memory addresses, not contents; use string-specific assertions for C strings.

---

## 3. String Assertions

For comparing C-style strings (`const char*`), use:

- `EXPECT_STREQ(str1, str2) / ASSERT_STREQ(str1, str2)` — check string equality
- `EXPECT_STRNE(str1, str2) / ASSERT_STRNE(str1, str2)` — check string inequality
- `EXPECT_STRCASEEQ(str1, str2) / ASSERT_STRCASEEQ(str1, str2)` — case-insensitive equality
- `EXPECT_STRCASENE(str1, str2) / ASSERT_STRCASENE(str1, str2)` — case-insensitive inequality

**Tip:** For `std::string` objects, use `EXPECT_EQ`.

---

## 4. Floating-Point Number Comparisons

Floating-point comparisons require tolerance due to rounding errors. GoogleTest provides:

- `EXPECT_FLOAT_EQ(val1, val2) / ASSERT_FLOAT_EQ(val1, val2)`
- `EXPECT_DOUBLE_EQ(val1, val2) / ASSERT_DOUBLE_EQ(val1, val2)`
- `EXPECT_NEAR(val1, val2, abs_error) / ASSERT_NEAR(val1, val2, abs_error)` for approximate equality within absolute error

**Example:**
```cpp
EXPECT_NEAR(computed_value, expected_value, 0.001);
```

---

## 5. Exception Assertions

If your build environment supports exceptions, use these to check exception throwing behavior:

- `EXPECT_THROW(statement, ExceptionType) / ASSERT_THROW(statement, ExceptionType)` — expects that `statement` throws the given type
- `EXPECT_ANY_THROW(statement) / ASSERT_ANY_THROW(statement)` — expects that `statement` throws any exception
- `EXPECT_NO_THROW(statement) / ASSERT_NO_THROW(statement)` — expects that `statement` does not throw any exception

Example:
```cpp
EXPECT_THROW({ MyFunc(); }, std::runtime_error);
```

---

## 6. Predicate Assertions for Complex Logic

When simple assertions don’t suffice, predicate assertions provide clearer failure messages.

- **Using Predicate Functions:** You can write functions returning `bool` or `testing::AssertionResult` that encapsulate your condition.

- **EXPECT_PREDx Macros:**
  - `EXPECT_PRED1(predicate, val1)`
  - `EXPECT_PRED2(predicate, val1, val2)`, etc., for predicates with multiple arguments.

- **Predicate with AssertionResult:** Provides informative messages showing actual values when predicate fails.

**Example:**
```cpp
testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0)
    return testing::AssertionSuccess();
  else
    return testing::AssertionFailure() << n << " is odd";
}

EXPECT_TRUE(IsEven(value));
```

Leads to output:
```
Value of: IsEven(value)
  Actual: false (3 is odd)
Expected: true
```

- **Predicate-Formatter Assertions:** For full customization of failure messages, use `EXPECT_PRED_FORMATx`.

---

## 7. Using Matchers with Assertions

GoogleTest integrates with GoogleMock matchers for expressive assertions:

- Use `EXPECT_THAT(value, matcher)` to assert complex conditions.

**Examples:**
```cpp
EXPECT_THAT(my_string, ::testing::StartsWith("Hello"));
EXPECT_THAT(my_number, ::testing::AllOf(::testing::Gt(5), ::testing::Lt(10)));
```

---

## 8. Assertion Macros for Explicit Results and Skipping

- `SUCCEED()` — Generates a success explicitly (typically for control flow).
- `FAIL()` — Generates a fatal failure immediately.
- `ADD_FAILURE()` — Generates a nonfatal failure.
- `GTEST_SKIP()` — Skips the current test or tests in a fixture with an optional message.

Example:
```cpp
TEST(MyTest, SkipIfSkipCondition) {
  if (!IsFeatureAvailable()) {
    GTEST_SKIP() << "Feature not available";
  }
  // Test code here
}
```

---

## 9. Best Practices

- Always use the appropriate severity of assertion based on whether test continuation is safe or not.
- Use predicate assertions or matchers to make failure messages clear and informative.
- Avoid relying on side effects in assertions; GoogleTest evaluates arguments exactly once but order is undefined.
- Use `SCOPED_TRACE` to add context information when calling helper functions with assertions inside.
- For assertions inside sub-functions, understand that fatal assertions abort only those functions, consider propagating failures or using `ASSERT_NO_FATAL_FAILURE` macros.

---

## 10. Troubleshooting Common Assertion Issues

- **Silent test failures:** Ensure you are using `EXPECT_` for nonfatal checks that won’t abort before subsequent code.
- **Unreadable failure output:** Use predicate assertions or custom matchers to enhance messages.
- **Fatal assertion in constructor or destructor:** Fatal assertions are not allowed there; use `SetUp` or `TearDown` methods instead.
- **Assertion in non-void function with fatal check:** Fatal assertions only allowed in void-returning functions.

---

## 11. Additional Resources

- [GoogleTest Assertions Reference](https://google.github.io/googletest/reference/assertions.html)
- [Advanced GoogleTest Topics](docs/advanced.md#assertions)
- [Matchers Reference](reference/matchers.md)
- [GoogleMock Tutorial and Recipes](docs/gmock_cook_book.md)

---

## Summary
This guide walks you through using the full range of GoogleTest assertions to write clear, robust tests. You’ll learn to select appropriate assertion types, express complex conditions via predicates and matchers, and apply best practices to make your testing reliable and maintainable.

---

### Example Snippet: Using Assertions
```cpp
TEST(FactorialTest, PositiveNumber) {
  int result = Factorial(4);
  EXPECT_EQ(result, 24) << "Factorial(4) should be 24";

  EXPECT_TRUE(result > 0) << "Result must be positive";

  // Custom predicate
  EXPECT_TRUE(IsEven(result));
}
```

### Using EXPECT_THAT with Matchers
```cpp
#include <gmock/gmock.h>
using ::testing::StartsWith;
using ::testing::HasSubstr;

TEST(StringTest, ContainsSubstrings) {
  std::string actual = "GoogleTest is awesome!";
  EXPECT_THAT(actual, StartsWith("Google"));
  EXPECT_THAT(actual, HasSubstr("awesome"));
}
```

### Skipping Tests
```cpp
TEST(FeatureTest, SkipUnlessSupported) {
  if (!IsSupported()) {
    GTEST_SKIP() << "Skipping test because it is not supported";
  }
  // Test logic here
}
```

---