---
title: "Assertions & Best Practices"
description: "Master the various assertion macros available in GoogleTest—such as equality, exception, and fatal/non-fatal checks—to write clear and meaningful tests. This guide includes best practices for choosing the right assertion for a given scenario and helps you create readable and reliable tests."
---

# Assertions & Best Practices

Master the various assertion macros available in GoogleTest—such as equality, exception, and fatal/non-fatal checks—to write clear and meaningful tests. This guide includes best practices for choosing the right assertion for a given scenario and helps you create readable and reliable tests.

---

## 1. Understanding GoogleTest Assertions

GoogleTest provides a rich set of assertion macros for verifying program correctness within tests. These assertions help validate expected conditions and produce clear diagnostic messages when tests fail.

### Key Concepts:
- **EXPECT_ vs ASSERT_**: 
  - `EXPECT_` macros generate *non-fatal failures* allowing the test to continue.
  - `ASSERT_` macros generate *fatal failures* and abort the current function immediately.
- All assertion macros support streaming additional messages using `<<` to enhance failure explanations.

### Practical Tip
Always prefer `EXPECT_` assertions unless continuing the test after failure doesn't make sense for your scenario, in which case use `ASSERT_`.

---

## 2. Types of Assertions and When to Use Them

### Boolean Assertions
- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` — Verify condition is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` — Verify condition is false.

**Example:**
```cpp
EXPECT_TRUE(user.IsLoggedIn()) << "User should be logged in.";
```

### Equality and Relational Assertions
- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — Checks equality.
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — Checks inequality.
- `EXPECT_LT(val1, val2)`, `EXPECT_LE(val1, val2)`, `EXPECT_GT(val1, val2)`, `EXPECT_GE(val1, val2)` — Relational comparisons.

**Important:**
- For comparing **C strings**, use `EXPECT_STREQ` and `EXPECT_STRNE`, not `EXPECT_EQ`, as the latter compares pointers rather than string contents.

**Example:**
```cpp
ASSERT_EQ(expected_value, actual_value) << "Failure in computing the result.";
EXPECT_LT(score, 100);
```

### String Comparisons
- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` — Equal C strings.
- `EXPECT_STRNE`, `EXPECT_STRCASEEQ`, `EXPECT_STRCASENE` — Various string comparisons including case-insensitive variants.

### Floating Point Comparisons
Due to floating-point rounding, use fuzzy comparisons rather than `EXPECT_EQ`.
- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ` — Compares floats within 4 ULPs.
- `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ` — Compares doubles similarly.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR` — Compares within absolute error bounds.

### Exception Assertions
Require exceptions enabled in build.
- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW` — Verify statement throws specified exception.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW` — Verify statement throws any exception.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW` — Verify statement does not throw.

**Example:**
```cpp
EXPECT_THROW(CallFunc(), std::runtime_error);
EXPECT_NO_THROW(InitDatabase());
```

### Predicate Assertions
For complex conditions where a simple assert is not descriptive:
- `EXPECT_PRED*` family — Use for predicates that return bool.
- `EXPECT_PRED_FORMAT*` family — Use for predicates returning `AssertionResult` with detailed messages.

**Example:**
```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, value);

// Custom message example.
AssertionResult IsEvenDetailed(int n) {
  if (n % 2 == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << n << " is odd";
}
EXPECT_PRED_FORMAT1(IsEvenDetailed, value);
```

---

## 3. Best Practices for Choosing Assertions

### Match Assertion Type with Test Logic
- Use `ASSERT_` when the test cannot proceed sensibly after a failure (e.g., null pointer dereference).
- Use `EXPECT_` when it is safe to continue and check further assertions.

### Avoid Comparing C Strings with `EXPECT_EQ`
To compare string *contents*, always use `EXPECT_STREQ` or `EXPECT_STRCASEEQ`.
Using equality checks on pointers leads to misleading success or failure.

### Use Exception Assertions for Exception Testing
Wrap code blocks in `EXPECT_THROW` rather than using `EXPECT_TRUE` on exception predicates.

### Use Predicate Assertions for Clarity
When you have complex conditions, use predicate or predicate-format assertions to produce meaningful messages with values printed.

### Streaming Messages
All assertions accept streaming via `<<` to append meaningful messages. Use this to provide context.

```cpp
ASSERT_EQ(x, y) << "Mismatched x and y for user id: " << user_id;
```

### Naming and Grouping
- Keep test suite and test names descriptive, without underscores (_), for compatibility.
- Use test suite setup/teardown (`SetUpTestSuite`, `TearDownTestSuite`) for shared expensive resources.

### Skipping Tests
Use `GTEST_SKIP() << "reason";` inside tests or fixtures to conditionally skip.

### Use `SCOPED_TRACE` to Add Context
Add trace messages to failures inside helper functions to help identify failure sources.

### Record Additional Properties
Use `RecordProperty("key", "value")` inside tests to add metadata.
Avoid using reserved XML attribute names.

---

## 4. Practical Examples

### Equality Assertion
```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}
```

### Expected Exception
```cpp
TEST(DatabaseTest, ThrowsOnInvalidQuery) {
  EXPECT_THROW(RunQuery("INVALID SQL"), DatabaseException);
}
```

### Predicate Assertion
```cpp
bool IsPositive(int x) { return x > 0; }

TEST(MathTest, PositiveNumber) {
  EXPECT_PRED1(IsPositive, value);
}
```

### Skipping a Test
```cpp
TEST(HardwareDependentTest, SkippedIfNoHardware) {
  if (!HardwareAvailable()) {
    GTEST_SKIP() << "No hardware available";
  }
  // Test implementation ...
}
```

---

## 5. Troubleshooting & Tips

### Common Issues
- **Using ASSERT_ in Non-void Functions**: Fatal assertions must be in void functions.
- **Comparing C Strings with Expect_EQ**: Use `EXPECT_STREQ` instead.
- **Multiple Death Tests in One Suite**: Name test suites with `DeathTest` suffix to ensure correct order.

### Tips
- Use streaming `<<` with assertions for detailed failure context.
- Use `SCOPED_TRACE` for adding contextual trace messages inside helper functions.
- Use `EXPECT_NO_FATAL_FAILURE(statement)` when calling subroutines with assertions, to verify they don't cause fatal failures.
- Use XML or JSON output (`--gtest_output=xml:...` or `json:...`) for integration with CI systems.

### Performance Considerations
- Avoid expensive setup inside frequently run tests—use test suite setup.
- Use `--gtest_repeat` with `--gtest_break_on_failure` to identify flaky tests.
- Use `--gtest_shuffle` to uncover test order dependencies.

### Alternative Approaches
- Use custom predicate-formatters to create detailed error messages.
- When complex predicates are needed, consider writing custom GMock matchers to increase readability.

---

## 6. Next Steps & Related Documentation

- **Core Feature Overview:** [Core Features at a Glance](../overview/product-introduction-and-value/core-features-at-a-glance)
- **Writing & Running Tests:** [Your First Test](../guides/getting-started/your-first-test)
- **Advanced Assertions:** [Assertions Reference](../docs/reference/assertions.md)
- **Using Mocking:** [Mocking Reference](../docs/reference/mocking.md)
- **Test Execution Flags & Options:** [Advanced GoogleTest Topics](../docs/advanced.md)

Explore these guides to deepen your mastery of assertions and testing in GoogleTest.

---

For detailed examples and explanations of less-common assertions like death tests, floating-point comparisons, and predicate-format assertions, see the linked references above.
