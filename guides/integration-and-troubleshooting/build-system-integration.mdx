---
title: "Integrating with Build Systems and IDEs"
description: "Practical tutorials for integrating GoogleTest and GoogleMock into different build systems, IDEs, and CI environments, with configuration examples and troubleshooting tips."
---

# Integrating with Build Systems and IDEs

## Overview

This guide provides practical tutorials to seamlessly integrate GoogleTest and GoogleMock into various build systems, integrated development environments (IDEs), and continuous integration (CI) environments. You will find step-by-step configuration examples, best practices, and troubleshooting tips to ensure smooth builds and test workflows.

Whether you are creating new projects or incorporating tests into existing build infrastructures, this guide will help you achieve reliable and scalable test automation.

---

## 1. Preparing Your Environment

Before integrating GoogleTest and GoogleMock, verify these prerequisites:

- Your build system supports C++17 or higher.
- You have a supported compiler installed (e.g., GCC, Clang, MSVC).
- Your development environment includes the relevant build tools (CMake, Bazel, Make, or native IDE project systems).
- Optional but recommended: have CTest or an equivalent test runner integration.

<Tip>
Ensure your build system is up-to-date and supports modern C++ standards, as GoogleTest and GoogleMock require C++17 features.
</Tip>

---

## 2. Integrating with CMake

### 2.1. Adding GoogleTest and GoogleMock as Dependencies

The recommended modern approach is to use CMake's `FetchContent` module to declare and download GoogleTest and GoogleMock during your build configuration:

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# Force dynamic runtimes on Windows to avoid linker conflicts
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp my_other_tests.cpp)
target_link_libraries(my_tests gtest_main gmock_main)
add_test(NAME MyTests COMMAND my_tests)
```

**Outcome:** Your test executable compiles with GoogleTest and GoogleMock, links properly, and tests can be run via `ctest` or directly.

### 2.2. Incorporating GoogleTest as a Subdirectory

Alternatively, if you have downloaded GoogleTest source manually or via Git submodules, add it to your build with:

```cmake
add_subdirectory(path/to/googletest)

target_link_libraries(my_tests gtest_main gmock_main)
```

This keeps compile and link flags consistent, particularly on Windows where mismatched runtimes are problematic.


### 2.3. Handling Visual Studio Runtime Conflicts

Visual Studio projects link the C runtime library dynamically by default, but GoogleTest links it statically. To avoid errors:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This ensures GoogleTest uses the same dynamic CRT as your application.

<Tip>
Use this setting early in your CMakeLists.txt before calling `FetchContent_MakeAvailable()`.
</Tip>

### 2.4. Building and Running with CMake

Typical workflow after configuration:

```bash
mkdir build
cd build
cmake ..
cmake --build .
ctest
```

or directly run your test executable:

```bash
./my_tests
```

---

## 3. Integrating with Bazel

If using Bazel, declare dependencies in your WORKSPACE and BUILD files:

```python
# WORKSPACE
load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.11.0.tar.gz"],
    strip_prefix = "googletest-release-1.11.0",
)

# BUILD file
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main", "@com_google_googletest//:gmock"],
)
```

This automatically handles fetching and building GoogleTest and GoogleMock.

<Tip>
Check for the latest GoogleTest release and update URLs accordingly.
</Tip>

---

## 4. Integrating with IDEs

### 4.1. Visual Studio

- Use CMake projects or manually add GoogleTest source and headers.
- Use the provided `gtest.sln` and `.vcproj` files if building GoogleTest standalone.
- Link test projects against `gtest.lib` and `gmock.lib`.
- Use Debug and Release configurations carefully; keep runtime libraries consistent.

### 4.2. Xcode

- Use the CMake generated `.xcodeproj` or import sources manually.
- Set the C++ standard to C++17.
- Link against the GoogleTest and GoogleMock libraries.

### 4.3. CLion and Others

- Import your CMake project directly.
- Use the `ctest` integration for running tests.

---

## 5. Continuous Integration (CI) Setup

1. **Include Build Setup Steps:** Install build tools (CMake or Bazel), compilers, and dependencies.

2. **Build and Test Command:** Use `cmake` and `ctest` or `bazel test` commands in scripts.

3. **Test Reporting:** Configure CI system to collect test results via `CTest` XML output or `bazel` reports.

4. **Cache Dependencies:** Cache downloaded GoogleTest to speed up builds.

<Tip>
Integrate code coverage tools alongside GoogleTest for enhanced CI insight.
</Tip>

---

## 6. Troubleshooting Common Integration Issues

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="Linker Errors Due to Runtime Mismatches">
Make sure to enable `gtest_force_shared_crt` on Windows to avoid linking errors like 'mismatch detected for RuntimeLibrary'.
</Accordion>
<Accordion title="Tests Not Being Discovered or Run">
Verify you linked test executables against `gtest_main` or provide your own `main()` that calls `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="Build Fails Due to Missing pthread on Unix"
>
Add `-pthread` compiler and linker flags if your build system or environment does not add them automatically.
</Accordion>
<Accordion title="Compiler Does Not Support C++17">
Upgrade your compiler or explicitly set `CMAKE_CXX_STANDARD 17` in your CMakeLists.txt.
</Accordion>
</AccordionGroup>

---

## 7. Best Practices

- **Use `gtest_main` or `gmock_main` libraries:** Avoid writing your own `main()` unless customization is needed.
- **Consistent Compiler Flags:** Build GoogleTest and your tests with identical flags, especially regarding runtime linkage.
- **Isolate Test Dependencies:** Use FetchContent or Git submodules to keep test dependencies managed within your project.
- **Run Tests with `ctest`:** Integrate easily with CI and IDEs.
- **Leverage CMake options:** Control build settings such as shared/static library builds and thread support.

---

## 8. Next Steps

- Explore detailed guides on [Authoring Basic Unit Tests](../../guides/writing-and-running-tests/basic-unit-tests) and [Using Mock Objects Effectively](../../guides/writing-and-running-tests/using-mock-objects).
- Review [Test Project Structure and Initialization](../../guides/getting-started/test-project-structure) for organizing your test code.
- Consult [Troubleshooting Common Test Issues](../../guides/integration-and-troubleshooting/troubleshooting-common-issues) for advanced debugging.

---

## Resources

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [CMake Official Website](https://cmake.org/)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [GoogleTest Primer](../../docs/primer.md)

---

## Summary

This guide provides clear, actionable steps for integrating GoogleTest and GoogleMock into your build systems and IDEs, ensuring that your C++ testing infrastructure is robust and maintainable. From configuring CMake and Bazel builds to setting runtime consistency on Windows, to tips for IDE and CI integration, you have the roadmap for smooth test automation.

For complex projects, leverage the recommended best practices and explore next-step guides to master effective test authoring and execution.