---
title: "Quickstart: Testing with CMake"
description: "Learn how to set up GoogleTest in a CMake-based C++ project and write your first test suite. This guide walks through adding GoogleTest as a dependency, integrating with your build, and executing sample tests."
---

# Quickstart: Testing with CMake

Learn how to set up GoogleTest in a CMake-based C++ project and write your first test suite. This guide walks you through adding GoogleTest as a dependency, integrating it with your build system, and running sample tests successfully.

---

### 1. Overview and Prerequisites

#### What This Guide Helps You Accomplish
This quickstart tutorial gets you up and running with GoogleTest in a C++ project built using CMake. You'll learn how to declare GoogleTest as a dependency within your project, write a basic test, build the test binary, and run your first tests.

#### Prerequisites
- A compatible operating system: Linux, macOS, or Windows
- A C++ compiler supporting at least C++17
- [CMake](https://cmake.org/) installed (version 3.14 or higher recommended)
- A compatible build tool such as Make, Ninja, or Visual Studio

> **Note:** Commands shown use a Unix shell prompt but are compatible with Windows command line as well.

#### Expected Outcome
After following this guide, you will have:
- Configured a CMake project that downloads and links GoogleTest automatically
- Written and compiled a test source file using GoogleTest macros
- Ran your test suite and seen tests pass successfully

#### Time Estimate
Approximately 10-20 minutes depending on your familiarity with CMake and C++ build systems.

#### Difficulty Level
Beginner to Intermediate (assumes basic familiarity with C++ and command line usage)

---

### 2. Step-by-Step Instructions

<Steps>
<Step title="Create a Project Directory">
Organize your test project by creating and entering a new directory:

```bash
mkdir my_project && cd my_project
```

You will place your CMake configuration and source files here.
</Step>

<Step title="Create Your CMakeLists.txt File">
Create a file named `CMakeLists.txt` in the project directory with the following content:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Use C++17 standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
# For Windows: prevent overriding parent project's compiler/linker settings
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)
```

This configuration uses CMake's `FetchContent` module to automatically fetch GoogleTest's source at build time, locking it to a specific commit hash for consistency.

> **Tip:** Update the commit hash periodically to get the latest fixes and features.

</Step>

<Step title="Write a Sample Test Source File">
Create a file named `hello_test.cc` in `my_project`:

```cpp
#include <gtest/gtest.h>

// A simple test case demonstrating GoogleTest assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Ensure strings are not equal
  EXPECT_EQ(7 * 6, 42);               // Check numerical equality
}
```

This test uses basic GoogleTest `EXPECT_*` macros to verify string inequality and numeric equality.

</Step>

<Step title="Extend CMakeLists.txt to Build and Run Tests">
Add the following lines at the end of your `CMakeLists.txt` file:

```cmake
enable_testing()

add_executable(
  hello_test
  hello_test.cc
)
target_link_libraries(
  hello_test
  GTest::gtest_main
)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

Explanation:
- `enable_testing()` activates the CTest testing framework in CMake.
- `add_executable()` defines the test binary.
- `target_link_libraries()` links the test binary with GoogleTest's main library.
- `gtest_discover_tests()` enables automatic test discovery and integration with CTest.

</Step>

<Step title="Configure and Build Your Project">
Run CMake to configure and generate build files:

```bash
cmake -S . -B build
```

Then build your tests:

```bash
cmake --build build
```

You should see output reporting successful compilation of GoogleTest and your test target.

</Step>

<Step title="Run Your Tests">
Move into the build directory and run tests using CTest:

```bash
cd build && ctest
```

Expected output:

```
Test project /path/to/my_project/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1

Total Test time (real) =   0.01 sec
```

This confirms your test ran successfully.

</Step>
</Steps>

---

### 3. Practical Examples

#### Example CMakeLists.txt (Complete)
```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

enable_testing()

add_executable(
  hello_test
  hello_test.cc
)
target_link_libraries(hello_test GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

#### Example Test Source File: hello_test.cc
```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

This simple test verifies the GoogleTest framework is working and shows basic test case construction.

---

### 4. Troubleshooting & Tips

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="GoogleTest Not Found or Fetch Fails">
- Ensure you have an active internet connection to download GoogleTest source during the build.
- Verify CMake version is 3.14 or higher to support `FetchContent_MakeAvailable`.
- If behind a proxy, configure your system environment accordingly.
</Accordion>
<Accordion title="C++17 Support Errors">
- Confirm your compiler supports C++17.
- Add `set(CMAKE_CXX_STANDARD 17)` and `set(CMAKE_CXX_STANDARD_REQUIRED ON)` to your `CMakeLists.txt`.
- On command line, you can also pass flags like `-DCMAKE_CXX_STANDARD=17`.
</Accordion>
<Accordion title="Test Executable Link or Build Errors">
- Make sure to link your test executable with `GTest::gtest_main` or `gtest` and `gtest_main`.
- `gtest_main` provides the `main()` function for running tests.
- Verify that `enable_testing()` is present before `gtest_discover_tests()`.
</Accordion>
</AccordionGroup>

<Tip>
For Windows users, setting `gtest_force_shared_crt ON` prevents runtime conflicts between GoogleTest and your project.
</Tip>

<Tip>
Run `ctest --verbose` for detailed output when tests fail or do not run.
</Tip>

<Tip>
Keep your GoogleTest version up to date by changing the commit hash in `FetchContent_Declare` periodically.
</Tip>

---

### 5. Next Steps & Related Resources

- Explore the [GoogleTest Primer](primer.md) to learn writing more detailed tests and assertions.
- See the [GoogleTest Samples](samples.md) for example test suites covering various use cases.
- For mocking dependencies, refer to the [gMock for Dummies](gmock_for_dummies.md) guide.
- Learn how to integrate GoogleTest into other build systems via [Quickstart: Testing with Bazel](quickstart-bazel.md).
- Troubleshoot issues with [Common Troubleshooting](../../getting-started/troubleshooting-support/common-troubleshooting.md).

---

Congratulations on setting up your first GoogleTest project with CMake! You're now ready to start writing comprehensive tests to improve your C++ application's quality.
