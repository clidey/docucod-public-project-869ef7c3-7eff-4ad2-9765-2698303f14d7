---
title: "Setup and Installation"
description: "Learn how to install GoogleTest and GoogleMock using popular build systems like CMake and Bazel, integrate the framework into your project, and verify your environment is ready for testing. Includes tips for troubleshooting common setup issues."
---

# Setup and Installation

## Overview

This guide walks you through installing **GoogleTest** and **GoogleMock** using popular C++ build systems like **CMake** and **Bazel**. It covers how to integrate these testing frameworks into your projects properly and verify your environment is correctly configured for testing. Whether you're beginning or adding GoogleTest/GoogleMock to an existing project, this guide ensures you understand installation steps, integration tips, and how to troubleshoot common setup issues.

---

## Prerequisites

Before beginning installation, ensure the following prerequisites:

- You have a supported **C++17** compatible compiler (e.g., GCC, Clang, MSVC).
- Your operating system supports GoogleTest (Linux, Windows, Mac).
- For **CMake** builds, you have **CMake 3.14+** installed.
- You have a working build environment (make, Visual Studio, etc.).
- (Optional) For Bazel, you have Bazel installed and configured.

Refer to the [Prerequisites & System Requirements](../getting-started/setup-and-installation/prerequisites-system-requirements) page for detailed system compatibility and compiler requirements.

---

## Installation Options

### 1. Installing with CMake

You can build GoogleTest and GoogleMock either as a standalone project or incorporate them into your existing CMake-based project.

#### A. Standalone Build

1. Clone the GoogleTest repository:

    ```bash
    git clone https://github.com/google/googletest.git -b main
    cd googletest
    mkdir build && cd build
    ```

2. Configure the build with CMake:

    - To build GoogleTest **with GoogleMock** (default):

      ```bash
      cmake ..
      ```

    - To build **only GoogleTest** (disable GoogleMock):

      ```bash
      cmake .. -DBUILD_GMOCK=OFF
      ```

3. Build the libraries:

    ```bash
    make    # or using your platform's native build command
    ```

4. (Optional) Install globally:

    ```bash
    sudo make install
    ```

#### B. Integrating into Existing CMake Project

Add GoogleTest as a subdirectory in your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/main.zip
)
# For Windows compatibility
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(your_test your_test.cpp)
target_link_libraries(your_test gtest_main)
add_test(NAME your_test COMMAND your_test)
```

This method ensures your project and GoogleTest share the same compiler/linker settings.

---

### 2. Installing with Bazel

GoogleTest and GoogleMock support Bazel builds. To add GoogleTest to your Bazel project:

1. Add GoogleTest as an external dependency in your `WORKSPACE` file:

```python
http_archive(
    name = "com_google_googletest",
    url = "https://github.com/google/googletest/archive/main.zip",
    strip_prefix = "googletest-main",
)
```

2. In your `BUILD` files, depend on GoogleTest targets, for example:

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

3. Build and run tests with Bazel commands:

```bash
bazel build //path/to:my_test
bazel test //path/to:my_test
```

Refer to Bazel documentation for more advanced usage.

---

## Configuration and Verification

Once GoogleTest and GoogleMock are installed into your project, you must integrate and verify the setup:

### Include Directories

Add include paths to your compiler options, e.g.,

```cmake
target_include_directories(your_test PRIVATE path/to/googletest/include)
```

### Linking Libraries

Link against `gtest`, `gmock`, and their `main` variants (which contain default `main()` implementations):

- Use `gtest_main` or `gmock_main` to avoid writing your own `main()`.
- If providing your own `main()`, link to `gtest` and `gmock` instead.

Example:

```cmake
target_link_libraries(your_test gtest_main gmock)
```

### Verifying Installation

Write and compile a basic test to ensure the frameworks are ready:

```c++
#include <gtest/gtest.h>

TEST(SanityCheck, TestTrue) {
    EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}
```

Build and run this; success indicates proper installation.

Refer to [Configuration & Verification](../getting-started/setup-and-installation/configuration-verification) for detailed instructions.

---

## Troubleshooting Common Setup Issues

### Common Problems

| Issue                        | Solution                                                                                 |
|------------------------------|-----------------------------------------------------------------------------------------|
| Compilation errors            | Confirm compiler supports C++17; verify include and library paths; check macro usage.  |
| Linking errors                | Ensure correct libraries linked (`gtest`, `gmock`, `pthread` on Unix systems).          |
| `main()` multiple definitions | Link with either `gtest_main`/`gmock_main` or supply your own `main()`, but not both.   |
| Build system incompatibilities| Check build script matches GoogleTest build instructions; update CMake/Bazel versions. |
| Platform-specific issues      | Review system prerequisites; apply required flags as per [Prerequisites](../getting-started/setup-and-installation/prerequisites-system-requirements).|

### Tips

- Use `testing::InitGoogleTest()` or `testing::InitGoogleMock()` properly to initialize testing frameworks.
- Check for CMake variable conflicts or outdated configurations.
- When upgrading GoogleTest, clean build directories to avoid stale artifacts.

If problems persist, consult the [Troubleshooting & Common Issues](../getting-started/first-test-experience/troubleshooting-and-common-issues) guide.

---

## Best Practices & Tips

- Prefer linking to `gtest_main` or `gmock_main` to avoid writing boilerplate `main()`.
- Use CMake `FetchContent` or git submodules to keep GoogleTest sources updated.
- Lock your GoogleTest dependency to a specific version or commit hash to control changes.
- Verify that your build environment matches GoogleTest system requirements.
- Suppress compiler/linker warnings by enabling recommended flags.

---

## Summary

By following this guide, you will install GoogleTest and GoogleMock using CMake or Bazel, integrate them into your C++ projects, and validate the setup with a sample test. You will also learn to troubleshoot common installation and configuration issues effectively.

---

## Additional Resources

- [Prerequisites & System Requirements](../getting-started/setup-and-installation/prerequisites-system-requirements)
- [Configuration & Verification](../getting-started/setup-and-installation/configuration-verification)
- [Writing Your First Test](../getting-started/first-test-experience/writing-your-first-test)
- [Troubleshooting & Common Issues](../getting-started/first-test-experience/troubleshooting-and-common-issues)
- [GoogleTest on GitHub](https://github.com/google/googletest)
- [GoogleTest Documentation Home](../index.md)

---

## Example: Minimal CMakeLists.txt Integrating GoogleTest

```cmake
cmake_minimum_required(VERSION 3.14)
project(ExampleTestProject CXX)

# Enable FetchContent module
include(FetchContent)

# Declare and fetch GoogleTest
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/heads/main.zip
)
FetchContent_MakeAvailable(googletest)

# Add test executable
add_executable(my_test test.cpp)

# Link with GoogleTest and GoogleMock
target_link_libraries(my_test gtest_main gmock)

# Enable testing and add test
enable_testing()
add_test(NAME my_test COMMAND my_test)
```

---

## Example: Minimal Test Source (test.cpp)

```c++
#include <gtest/gtest.h>

TEST(SimpleTest, AlwaysPasses) {
    EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
}
```

Build and run this simple test to confirm your setup.

---