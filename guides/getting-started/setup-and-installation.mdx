---
title: "Setup & Installation"
description: "Learn how to set up GoogleTest and GoogleMock in your C++ project. This guide covers supported platforms, initial configuration, using CMake, Bazel, and integrating with your build system, so you can start writing and running tests without delay."
---

# Setup & Installation

Learn how to set up GoogleTest and GoogleMock in your C++ project. This guide covers supported platforms, initial configuration, using CMake, Bazel, and integrating with your build system so you can start writing and running tests without delay.

---

## 1. Overview of Setup & Installation

### What this Guide Helps You Accomplish
This guide takes you step-by-step through the process of setting up GoogleTest and GoogleMock in your C++ environment. Whether you are starting a fresh project or integrating into an existing one, you will learn the supported platforms, how to obtain the source, and how to configure your build system using CMake or Bazel to compile, link, and run tests efficiently.

### Prerequisites
- A C++17-compatible development environment (compiler and standard library).
- Basic familiarity with your chosen build system (CMake or Bazel).
- Access to a supported platform (Linux, macOS, Windows).
- (Optional) Administrative privileges for system-wide installation.

### Expected Outcome
By the end of this guide, you will have GoogleTest and GoogleMock built and integrated into your C++ project. You'll be able to compile test binaries, run tests, and begin writing your own test cases.

### Time Estimate
Approximately 15-30 minutes depending on your environment and experience.

### Difficulty Level
Beginner to Intermediate.

---

## 2. Setup and Installation Steps

### Step 1: Download GoogleTest and GoogleMock

GoogleMock is bundled with GoogleTest. Clone the repository with the desired version tag:

```bash
   git clone https://github.com/google/googletest.git -b v1.17.0
   cd googletest
```

This command fetches the source code for both GoogleTest and GoogleMock.

---

### Step 2: Building with CMake (Standalone Project)

CMake is widely supported and generates native build scripts:

1. Create a build directory inside the `googletest` folder:

```bash
   mkdir build
   cd build
```

2. Generate build scripts:

```bash
   cmake ..
```

These build scripts include GoogleMock by default, so no extra configuration is necessary.

3. Build the libraries:

```bash
   make
```

4. (Optional) Install the libraries system-wide:

```bash
   sudo make install
```

*On Windows*, Visual Studio project files (`.sln`) will be generated; open them and build within Visual Studio. On MacOS with Xcode, an `.xcodeproj` file will be created.

---

### Step 3: Building GoogleTest Only (Optional)

If you want to build only GoogleTest without GoogleMock, pass this flag when running `cmake`:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

---

### Step 4: Integrating GoogleTest/GoogleMock into an Existing CMake Project

You have two main ways:

1. **Use Installed Libraries**
   - If GoogleTest is installed, use

```cmake
find_package(GTest CONFIG REQUIRED)
```

   - Link against `GTest::gtest` and `GTest::gmock` in your target.

2. **Embed GoogleTest Source**
   - Add GoogleTest as a git submodule or download and place it at a known path.
   - Use CMake's `add_subdirectory()` to include GoogleTest's source in your build:

```cmake
add_subdirectory(path/to/googletest)
```

*This approach ensures compilation and linker flags are consistent between your tests and GoogleTest.*

#### Using FetchContent for automatic download during configure

For CMake 3.14+, you can download at configure time:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Windows runtime matching
FetchContent_MakeAvailable(googletest)

add_executable(my_test example.cpp)
target_link_libraries(my_test gtest_main)
add_test(NAME my_test COMMAND my_test)
```

---

### Step 5: Building and Running Tests

After linking GoogleTest/GoogleMock, write your tests and build your test binary. Typical workflow:

1. Write test cases using `TEST()`, `TEST_F()`, or `TEST_P()` macros.
2. Compile your test executable linking against `gtest_main` or `gmock_main` to get a ready-made `main()`.
3. Run your test executable:

```bash
   ./my_test
```

The test runner will output test results, indicating passed and failed tests.

---

### Step 6: Optional Bazel Integration

If you prefer Bazel, add GoogleTest and GoogleMock as external dependencies in your `WORKSPACE` file, and declare targets in your `BUILD` files accordingly.

Refer to Bazel-specific integration guides for detailed setup.

---

## 3. Configuration Tips & Best Practices

- **Compiler Settings:** Ensure your compiler supports at least C++17 and that the C++ standard is set in your `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- **Shared vs Static Libraries:** By default, GoogleTest builds static libs. To build shared libraries (DLLs), use:

```cmake
-DBUILD_SHARED_LIBS=ON
```

- **Visual Studio Runtime Compatibility:** To prevent runtime library mismatch errors on Windows with Visual Studio, enable `gtest_force_shared_crt`:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

- **Building GoogleMock Tests:** GoogleMock's own tests are not built by default. To build, set the CMake option:

```cmake
-Dgmock_build_tests=ON
```

Build and run GoogleMock's self-tests to confirm integrity.

- **Include Paths:** When linking manually, include GoogleTest/GoogleMock header paths:

```cmake
include_directories(
  ${gmock_SOURCE_DIR}/include
  ${gmock_SOURCE_DIR}
  ${gtest_include_dirs}
)
```

- **Linking:** Link your test targets with `gmock_main` to include the provided main() function, or write your own main() and link with `gmock` alone.

---

## 4. Troubleshooting

### Common Issues

- **Missing Default Constructor Error**
  - Ensure your test fixture has a public default constructor.

- **Linker Errors**
  - Verify correct order of linked libraries, including `pthread` on Unix-like platforms.
  - On Windows, check runtime library compatibility.

- **CMake Can't Find GoogleTest**
  - Confirm the path to the GoogleTest source or installed package is correct.
  - Use `FetchContent` or submodule integration to simplify this.

- **Tests Not Running / No Tests Found**
  - Confirm that tests are registered correctly (`TEST()` or `TEST_F()` macros).
  - Make sure `RUN_ALL_TESTS()` is called in `main()`.

- **Build Failures on Unsupported Compiler Versions**
  - Use a modern compiler with C++17 support.

### Pro Tips

- Always call `testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS();` in your `main()`.
- Do not ignore the return value of `RUN_ALL_TESTS()`. Return it from `main()`.
- Use the provided `gmock_main` or `gtest_main` libraries to avoid writing your own `main()` unless custom behavior is required.

---

## 5. Reference Examples

### Example: Basic Standalone Build with CMake

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build
cmake ..
make
sudo make install
```

### Example: Embedding GoogleTest in Your Project’s CMake

```cmake
add_subdirectory(${CMAKE_CURRENT_SOURCE_DIR}/googletest)

add_executable(my_tests my_tests.cpp)
target_link_libraries(my_tests gtest_main gmock_main)

add_test(NAME my_tests COMMAND my_tests)
```

### Example: Using FetchContent in CMake

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main gmock_main)
add_test(NAME example_test COMMAND example)
```

### Example: Minimal `main()` Using GoogleMock

```c++
#include "gmock/gmock.h"
#include "gtest/gtest.h"

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## 6. Next Steps & Related Documentation

- Explore [Project Setup & Configuration](/getting-started/first-test-experience/project-setup) for linking GoogleTest in your build system.
- Try writing your first tests with [Writing & Running Your First Test](/getting-started/first-test-experience/writing-your-first-test).
- Validate your setup using [Quick Validation Guide](/getting-started/first-test-experience/quick-validation).
- Consult the detailed [Installation Overview](/getting-started/setup-requirements/installation-overview) for alternate installation methods.
- Review platform-specific guides:
  - [Installing on Linux/macOS](/getting-started/installation-guides/linux-macos-install)
  - [Installing on Windows](/getting-started/installation-guides/windows-install)
  - [Using Bazel for Build & Test](/getting-started/installation-guides/bazel-integration)


---

## References

- Official Repository: https://github.com/google/googletest
- CMake Documentation: https://cmake.org/cmake/help/latest/
- Bazel Documentation: https://bazel.build/


---

If you encounter any issues during setup, consult the troubleshooting tips in relevant installation and project setup guides or seek help on the community support channels.


<Check>
Don’t forget to verify that your compiler is compatible with C++17 before proceeding.
</Check>

<Info>
Building GoogleTest and GoogleMock from source allows you to customize build options, such as enabling shared libraries or tests.
</Info>

<Warning>
If you skip calling `testing::InitGoogleTest()` or `testing::InitGoogleMock()` in your `main()`, tests might not register properly, leading to zero tests run.
</Warning>

### Full support for the latest platforms and compilers is continuously evolving. Keep your GoogleTest sources updated.

---

*End of Setup & Installation Guide for GoogleTest and GoogleMock.*
