---
title: "Setup and Installation"
description: "A step-by-step walkthrough for installing and configuring GoogleTest/GoogleMock in your development environment. Covers integrating with popular build systems like CMake and Bazel."
---

# Setup and Installation Guide for GoogleTest and GoogleMock

Welcome to the step-by-step walkthrough for installing and configuring GoogleTest and GoogleMock in your development environment. This guide covers standalone and integrated builds with popular build systems, focusing on practical, actionable instructions to get you up and running quickly.

---

## 1. Overview

### What This Guide Helps You Accomplish
- Clone and build GoogleTest and GoogleMock
- Integrate GoogleTest/GoogleMock into CMake-based projects, both standalone and embedded
- Understand how to link and run tests
- Get tips on managing runtime linking options

### Prerequisites
- C++17 compatible compiler installed and configured
- Basic understanding of C++ build systems, especially CMake
- Git installed for cloning repositories
- Familiarity with terminal/command line interface

### Expected Outcome
- Successfully built and installed GoogleTest and GoogleMock libraries
- Configured your project to include and link against these libraries
- Ready to write and run unit and mock tests

### Time Estimate
Approximately 15-30 minutes, depending on your familiarity with build systems and environment setup.

### Difficulty Level
Intermediate—basic knowledge of C++ and CMake recommended.

---

## 2. Step-by-Step Instructions

### 2.1 Cloning the Repository

Start by cloning the official GoogleTest repository, which includes GoogleMock by default.

```bash
# Clone the repository at tagged stable version
git clone https://github.com/google/googletest.git -b v1.17.0
db googletest
```

### 2.2 Building with Standalone CMake

Create and enter a build directory within the cloned repo to keep build artifacts separate.

```bash
mkdir build
cd build
```

Generate native build files for your platform.

```bash
# To build both GoogleTest and GoogleMock (default)
cmake ..

# Alternatively, build only GoogleTest if you don’t need GoogleMock
cmake .. -DBUILD_GMOCK=OFF
```

Build the libraries:

```bash
make   # On Unix-like systems
# or build via your IDE on Windows or Mac after running cmake
```

(Optional) Install system-wide if you have admin rights:

```bash
sudo make install
```

### 2.3 Integrating GoogleTest/GoogleMock into Your Existing CMake Project

You have two main methods to incorporate GoogleTest/GoogleMock into your project:

#### Method A: Use Installed Libraries via `find_package`
After installing GoogleTest/GoogleMock, add to your `CMakeLists.txt`:

```cmake
find_package(GTest CONFIG REQUIRED)
# or find_package(GMock CONFIG REQUIRED)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests GTest::gtest_main GMock::gmock)
add_test(NAME my_tests COMMAND my_tests)
```

This method is straightforward and uses system-installed libraries for convenience and stability.

#### Method B: Build GoogleTest/GoogleMock as Part of Your Project

Add the GoogleTest source as a subdirectory:

```cmake
# Download or have googletest source at 'external/googletest'
add_subdirectory(external/googletest)

add_executable(my_tests test_main.cpp)
# Link with gtest_main or gmock_main for main() implementation
target_link_libraries(my_tests gtest_main gmock_main)
add_test(NAME my_tests COMMAND my_tests)
```

This ensures library settings and compiler flags are consistent across your project and tests.

### 2.4 Confirming the Main Entry Point

When linking your tests, you can either:

- Link against `gtest_main` or `gmock_main` libraries to automatically provide the `main()` function.
- Write your own `main()` calling `testing::InitGoogleMock(&argc, argv);` or `testing::InitGoogleTest(&argc, argv);` followed by `RUN_ALL_TESTS();`.

The files `gmock_main.cc` and `gtest_main.cc` in the source provide example implementations for this.

### 2.5 Running Tests

Once built, run your test executable:

```bash
./my_tests
```

All registered tests will execute, and results will be output to the console.

---

## 3. Practical Examples

### Example: Standalone Build and Run

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build && cd build
cmake ..
make
./googletest/gtest/gtest # Run the internal test suite
```

### Example: Integrating GoogleMock into CMake Project (`CMakeLists.txt` snippet)

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTestProject)

# Add googletest as a subdirectory
add_subdirectory(path/to/googletest)

add_executable(my_test_exe my_tests.cpp)
target_link_libraries(my_test_exe gmock_main)

enable_testing()
add_test(NAME MyTests COMMAND my_test_exe)
```

---

## 4. Troubleshooting & Tips

### Common Issues

- **Linker errors related to `main()`**: Make sure to link with `gtest_main` or `gmock_main` unless you provide your own `main`.
- **Runtime errors on Windows about mismatched runtimes**: Use the `gtest_force_shared_crt` CMake option to align runtime linkage.
- **Tests not discovered or executed**: Verify that tests are properly registered with `TEST()` or `TEST_F()`, and that `RUN_ALL_TESTS()` is called once.
- **Compiler complaining about C++ standard**: Confirm you have configured your project for at least C++17.

### Best Practices

- **Use `gmock_main` when using GoogleMock** to avoid writing boilerplate main code.
- **Keep test binaries separate from production binaries** to avoid linking conflicts.
- **Embed GoogleTest/GoogleMock sources in your build if you want consistent compiler settings.**

### Performance Considerations

- GoogleTest is thread-safe on pthread-supported platforms. Add appropriate pthread flags if compiling manually.

### Alternative Approaches

- Use Bazel or other build systems as preferred; this guide focuses on CMake.

---

## 5. Next Steps & Related Content

- Proceed to **Writing Your First Test** guide to learn test authoring.
- Explore **Mocking Best Practices** for advanced mock usage.
- Review the **Build Options and Configuration** for optimizing builds and using shared libraries.
- For troubleshooting, consult the **Common Build & Runtime Errors** FAQ.

---

## References

- Official GitHub Repository: [https://github.com/google/googletest](https://github.com/google/googletest)
- CMake Documentation: [https://cmake.org/cmake/help/latest/](https://cmake.org/cmake/help/latest/)
- GoogleTest Primer: /getting_started/initial_usage_and_validation/your_first_test

---

Feel confident integrating GoogleTest/GoogleMock into your project with this streamlined process. Your test environment will be robust, maintainable, and ready for growth.
