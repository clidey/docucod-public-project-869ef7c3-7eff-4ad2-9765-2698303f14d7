---
title: "Setup and Installation"
description: "Walkthrough for installing GoogleTest and GoogleMock using common build systems (like CMake and Bazel), configuring your project, and verifying your environment. Empowers users to integrate the frameworks rapidly into existing or new C++ codebases."
---

# Setup and Installation

## Overview

This guide walks you through installing GoogleTest and GoogleMock frameworks using popular build systems such as CMake and Bazel. It also covers how to configure your project and verify your installation so you can start writing tests for your C++ codebase effectively and quickly.

GoogleTest and GoogleMock empower C++ developers by providing comprehensive, industry-proven support for unit testing and mocking. Proper setup is essential for integrating these frameworks seamlessly into new or existing projects.

---

## Prerequisites

Before beginning installation, ensure the following prerequisites are met:

- **Supported Platform and Compiler:** Your development environment must support C++17 or later.
- **Installed Build Tools:** Have CMake (version 3.14 or higher) or Bazel installed depending on your build preferences.
- **Network Access:** Required to clone the official GitHub repository or download releases.
- **Compiler & Linker Configuration:** Ensure your compiler tooling can handle multithreading and link with pthreads if applicable.

Refer to the [Prerequisites & System Requirements](https://github.com/google/googletest/blob/main/docs/getting-started/setup-installation/prerequisites-and-requirements.md) page for detailed platform and compiler support.

---

## Installation with CMake

### Step 1: Clone the Repository

Open your terminal and run:

```bash
git clone https://github.com/google/googletest.git -b main
cd googletest
```

This command clones the latest main branch of the GoogleTest repository, which includes GoogleMock.

### Step 2: Create and Enter a Build Directory

```bash
mkdir build
cd build
```

This keeps build artifacts isolated from source files.

### Step 3: Configure the Build

To build both GoogleTest and GoogleMock (default behavior):

```bash
cmake ..
```

If you want to build **only GoogleTest** (excluding GoogleMock), run:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

> **Tip:** You can customize the CMake configuration further depending on your platform or project needs.

### Step 4: Build the Library

- On Linux/macOS:

```bash
make
```

- On Windows (Visual Studio):

Open the generated `.sln` file inside the `build` directory and build the project.

### Step 5: Optional Installation

If you have administrator privileges, you can install the libraries and headers system-wide:

```bash
sudo make install
```

By default, this installs to `/usr/local/`.

### Step 6: Integrate in Your Project

You can either link to the installed libraries or include the GoogleTest source directly in your project via:

- `find_package(GTest REQUIRED)` in CMake,
- or `add_subdirectory()` to add GoogleTest as part of your build tree.

See the CMake integration example below.

---

### Incorporating GoogleTest into an Existing CMake Project

Below is a sample minimal setup for your `CMakeLists.txt`:

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject LANGUAGES CXX)

# Download and add GoogleTest
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For MSVC runtime compatibility
FetchContent_MakeAvailable(googletest)

# Add your test executable
add_executable(my_tests test_main.cpp)

target_link_libraries(my_tests gtest_main gmock)
add_test(NAME my_tests COMMAND my_tests)
```

This method ensures consistent compiler and linker settings across your project and GoogleTest.

---

## Installation with Bazel

GoogleTest provides Bazel build rules to integrate with your Bazel workspace.

### Step 1: Add GoogleTest as a Third-Party Dependency

Add the following to your `WORKSPACE` file:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/main.zip"],
    strip_prefix = "googletest-main",
)
```

### Step 2: Reference in Your BUILD Files

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//googletest:googletest", "@com_google_googletest//googlemock:googlemock"],
)
```

This will compile and link tests against GoogleTest and GoogleMock.

---

## Configuration

### Initializing GoogleTest and GoogleMock

After installing, you need to initialize the framework in your test executable.

In your test `main()` function, initialize GoogleMock (which also initializes GoogleTest) with:

```cpp
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

If you use `gtest_main` or `gmock_main` libraries that provide main entry points, this step can be omitted.

### Using `gmock_main` Library

If you link your tests with the `gmock_main` library, it already supplies a `main()` function that initializes GoogleMock and runs all tests, enabling simplified test entry points.

---

## Verification

### Build and Run the Sample Tests

Once installed, compile and run the included sample tests to verify your setup:

```bash
cd googletest/build
make
./googlemock/gtest/gtest_main
```

Or run your test executable that links to GoogleTest/GoogleMock:

```bash
./my_tests
```

You should see output indicating the number of tests run, and that they passed.

### Troubleshooting

If tests don't run or fail to build:

- Check compiler flags and C++17 compliance.
- Verify paths to GoogleTest headers and libraries.
- Confirm linking to `gtest`, `gmock`, and `gtest_main` or `gmock_main`.
- Consult [Troubleshooting Setup](https://github.com/google/googletest/blob/main/docs/getting-started/first-steps-validation/troubleshooting-setup.md).

---

## Best Practices & Tips

- **Consistent Compiler Settings:** Build GoogleTest/GoogleMock and your tests with the same compiler options to avoid linker errors.
- **Use `FetchContent` for Dependency Management:** Let CMake handle GoogleTest fetching and update automatically.
- **Leverage Pre-built Libraries:** If available, install GoogleTest system-wide for reuse across projects.
- **Visual Studio Runtime:** Use `gtest_force_shared_crt` option on Windows to match runtime linkage.
- **Custom Flags:** Pass compile-time macros (e.g., `-DGTEST_HAS_PTHREAD=1`) when needed.

---

## Summary

By following this guide, you will have installed and configured GoogleTest and GoogleMock libraries within your build system, enabling a robust test infrastructure for your C++ projects. Start by running sample tests, then integrate your codebase and write your first unit tests to verify functionality.


---

## References & Next Steps

- [Installing GoogleTest & GoogleMock (Multi-platform)](https://github.com/google/googletest/blob/main/docs/getting-started/setup-installation/installation-multiplatform.md)
- [Initial Configuration Setup](https://github.com/google/googletest/blob/main/docs/getting-started/setup-installation/configuration-setup.md)
- [Writing and Running Your First Test](https://github.com/google/googletest/blob/main/docs/guides/getting-started/writing-your-first-test.md)
- [Troubleshooting Installation & Setup](https://github.com/google/googletest/blob/main/docs/getting-started/first-steps-validation/troubleshooting-setup.md)

These resources guide you through advanced configuration, writing tests, and resolving common issue patterns.


---

<AccordionGroup title="CMake Installation Example">  
<Accordion title="Standalone Build">  
```bash  
git clone https://github.com/google/googletest.git -b main  
cd googletest  
mkdir build  
cd build  
cmake ..  
make  
sudo make install # optional  
```  
</Accordion>  
<Accordion title="Integration in Existing CMake Project">  
```cmake  
include(FetchContent)  
FetchContent_Declare(  
  googletest  
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip  
)  
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  
FetchContent_MakeAvailable(googletest)  
add_executable(my_tests test_main.cpp)  
target_link_libraries(my_tests gtest_main gmock)  
add_test(NAME my_tests COMMAND my_tests)  
```  
</Accordion>  
</AccordionGroup>

<AccordionGroup title="Bazel Installation Example">  
<Accordion title="WORKSPACE File">  
```python  
http_archive(  
    name = "com_google_googletest",  
    urls = ["https://github.com/google/googletest/archive/main.zip"],  
    strip_prefix = "googletest-main",  
)  
```  
</Accordion>  
<Accordion title="BUILD File">  
```python  
cc_test(  
    name = "my_test",  
    srcs = ["my_test.cc"],  
    deps = ["@com_google_googletest//googletest:googletest", "@com_google_googletest//googlemock:googlemock"],  
)  
```  
</Accordion>  
</AccordionGroup>

<Callout>
Note: When using GoogleMock, always call `testing::InitGoogleMock(&argc, argv);` in your test main to properly initialize the framework.
</Callout>