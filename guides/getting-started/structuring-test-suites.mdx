---
title: "Structuring Test Suites"
description: "Learn how to organize your tests and leverage test fixtures for reusable code. This guide demonstrates best practices for grouping related tests, handling setup/teardown, and employing test discovery for maintainable, scalable testing."
---

# Structuring Test Suites

## Workflow Overview

GoogleTest encourages organizing your tests into well-structured, maintainable groups called *test suites*. This guide focuses on how to effectively organize your tests using test suites and test fixtures for code reuse, clear setup and teardown processes, and scalable testing.

### What You Will Learn
- How to group related tests logically into test suites.
- How to use test fixtures to share setup and teardown code.
- The difference between `TEST()` and `TEST_F()` macros.
- Best practices for naming and structuring tests.
- How GoogleTest discovers and runs tests automatically.

### Prerequisites
- Basic understanding of C++ programming.
- Familiarity with the GoogleTest framework's basic concepts such as assertions.

### Expected Outcome
By following this guide, you will create well-organized test suites that clearly reflect your code's structure and improve test readability, maintainability, and correctness.

#### Time Estimate
About 20-30 minutes to absorb and apply the concepts.

#### Difficulty Level
Beginner to Intermediate

---

## Organizing Tests into Test Suites

Group related tests using **test suites** to reflect the structure of the code under test. This improves readability and helps manage your testing codebase.

### Creating a Test Suite

Use the `TEST()` macro to define a test function inside a named test suite:

```cpp
TEST(MyClassTest, DoesThis) {
  // Test body goes here.
}
```

- The first argument (`MyClassTest`) is the suite name, grouping multiple tests.
- The second argument (`DoesThis`) is the individual test name.


### Naming Conventions

- Use descriptive, PascalCase names without underscores for both suite and test names.
- The suite name often matches the class or module you are testing.

---

## Writing Multiple Tests in a Suite

Multiple tests that share a common theme should be added under the same test suite name:

```cpp
TEST(MyClassTest, HandlesZeroInput) {
  // test code
}

TEST(MyClassTest, HandlesPositiveInput) {
  // test code
}
```

This grouping helps logically organize tests and produces clustered, readable output.

---

## Sharing Setup and Teardown with Test Fixtures

If multiple tests require the same setup or cleanup code, define a *test fixture* using a test class derived from `testing::Test`. This reduces duplication and centralizes test configuration.

### Defining a Test Fixture

```cpp
class MyClassTest : public testing::Test {
 protected:
  void SetUp() override {
    // Code here is run immediately before each test
  }

  void TearDown() override {
    // Code here is run immediately after each test
  }

  // Shared resources for tests go here
  MyClass object_;
};
```

- `SetUp()` prepares the environment for every test.
- `TearDown()` cleans up after every test.

### Writing Tests with Fixtures

Use the `TEST_F()` macro, which associates tests with the fixture class:

```cpp
TEST_F(MyClassTest, HandlesEmptyInput) {
  EXPECT_TRUE(object_.IsEmpty());
}

TEST_F(MyClassTest, HandlesNonEmptyInput) {
  object_.AddItem(5);
  EXPECT_EQ(object_.GetSize(), 1);
}
```

Inside these tests, you can directly access fixture members.

---

## How GoogleTest Executes Test Suites and Fixtures

1. For each `TEST_F`, GoogleTest:
   - Constructs a fresh fixture object
   - Calls `SetUp()`
   - Runs the test body
   - Calls `TearDown()`
   - Destroys the fixture object
2. Each test runs independently, ensuring isolation and repeatability.

---

## Best Practices for Structuring Tests

- **Group logically related tests**: Tests for the same class or functionality belong in one suite.
- **Avoid overly large suites**: Consider splitting complex suites into smaller ones focused on sub-modules or features.
- **Use fixtures for shared resources**: Minimize duplication and setup overhead.
- **Name tests descriptively**: Each test name should communicate what it verifies.
- **Keep tests small and focused**: Typically, a test checks one behavior or case.
- **Prefer `EXPECT_*` over `ASSERT_*` when possible**: So tests can check multiple failures.

---

## Example: Structuring Tests for a Queue Class

```cpp
// Define the fixture
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Setup data
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;  // empty
  Queue<int> q1_;  // one element
  Queue<int> q2_;  // two elements
};

// Tests
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

The fixture `QueueTest` provides shared queues, while the two tests verify behaviors independently.

---

## Tips and Common Pitfalls

- **Never share fixture objects between tests:** Each test runs with a freshly constructed fixture for isolation.
- **Do not call test fixture methods manually:** Test execution is managed by GoogleTest.
- **Use SetUp/TearDown over constructor/destructor:** GoogleTest expects the overrides for lifecycle management.
- **Avoid complex logic in fixtures:** Keep fixtures simple to not mask test failures.
- **Be explicit with resource ownership:** If using pointers in fixtures, manage lifetimes carefully.

---

## Troubleshooting

### Tests Not Being Discovered
- Ensure your test functions use `TEST()` or `TEST_F()` macros correctly.
- Confirm test executables call `RUN_ALL_TESTS()` from `main()`.

### Setup or Teardown Not Called
- Verify your fixture overrides `SetUp()` and `TearDown()` exactly (case sensitive).
- Use `override` specifier to catch override mistakes.

### Tests Fail Unexpectedly
- Check that tests are truly independent; use fresh fixtures.
- Avoid side effects in fixtures that persist across tests.

---

## Next Steps & Related Content

- Explore [Writing Your First Test](https://google.github.io/googletest/guides/getting-started.html) to learn how to write working test functions.
- Advance to [Mocking with GoogleMock](https://google.github.io/googletest/guides/advanced.html) to learn mocking techniques.
- Dive deeper into [Test Fixtures and Parameterized Tests](https://google.github.io/googletest/reference/testing.html#test-fixtures-and-parameterized-tests).

---