---
title: "Assertions and Test Outcomes"
description: "Explore the rich suite of assertions provided by GoogleTest, including equality, exception, fatal/non-fatal, and custom assertions. Learn best practices for structuring assertions for clarity and actionable results."
---

# Assertions and Test Outcomes

Explore the rich suite of assertions provided by GoogleTest to validate your C++ code behavior. This guide focuses on how to effectively use assertion macros for equality checks, exception testing, fatal and non-fatal outcomes, and custom assertions to structure tests that produce clear and actionable results.

---

## Overview

GoogleTest assertions are central to verifying the correctness of your code within tests. They evaluate conditions and produce successes, failures, or fatal failures that influence test execution. Assertions come in two main types:

- **`EXPECT_` assertions:** Non-fatal failures, test continues after failure.
- **`ASSERT_` assertions:** Fatal failures, immediately abort the current test function.

Understanding and selecting the right assertions empower you to write robust and informative tests.

---

## Prerequisites

- Familiarity with basic C++ programming
- GoogleTest installed and configured in your development environment
- Basic understanding of test structures (`TEST()`, `TEST_F()`) in GoogleTest

---

## What You Will Learn

- How to use standard assertion macros to verify conditions
- Differences between fatal and non-fatal assertions and when to use each
- Specialized assertions for strings, floating-point values, and exception handling
- Customizing assertions with failure messages for clarity
- Best practices for structuring assertions to aid debugging

---

## Detailed Assertion Types and Usage

### 1. Explicit Success and Failure

- `SUCCEED()`
  - Generates a success record explicitly.
  - Useful for marking a point in code reached intentionally.

- `FAIL()`
  - Generates a fatal failure, aborting the current test function.
  - Only usable in void-returning functions.

- `ADD_FAILURE()` and `ADD_FAILURE_AT(file, line)`
  - Generate non-fatal failures allowing test continuation.

### 2. Boolean Condition Assertions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
  - Passes if the condition evaluates to true.

- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`
  - Passes if the condition evaluates to false.

### 3. Binary Comparison Assertions

Used to compare two values with operators like `==`, `!=`, `<`, etc. Examples:

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — verifies `val1 == val2`
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — verifies `val1 != val2`
- Similar macros exist for `<, <=, >, >=`

**Note:**

- `EXPECT_EQ` on C strings compares pointers, not contents. Use `EXPECT_STREQ` for C-string content comparison.
- When comparing pointers to nullptr, prefer use of `nullptr` over `NULL`.

### 4. String Comparison Assertions

Designed specifically for C-style and wide C strings:

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)`
  - Verifies that two C strings have identical contents.

- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)`
  - Verifies that two C strings have different contents.

- Case-insensitive counterparts: `EXPECT_STRCASEEQ`, `EXPECT_STRCASENE`

### 5. Floating-Point Assertions

Floating-point comparisons require tolerance to rounding errors.

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`
  - Checks approximate equality of `float` types within 4 ULPs.

- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`
  - Checks approximate equality of `double` types within 4 ULPs.

- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)`
  - Truth of: absolute difference `<= abs_error`.

### 6. Exception Assertions (requires exceptions enabled)

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`
  - Expect `statement` to throw an exception of the specified type.

- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`
  - Expect `statement` to throw any exception.

- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`
  - Expect `statement` not to throw any exception.

Example:

```cpp
EXPECT_NO_THROW({ ProcessItem(item); });
```

### 7. Predicate Assertions for Complex Conditions

- `EXPECT_PREDn(pred, vals...)` and `ASSERT_PREDn(pred, vals...)`
  - Use boolean predicates with arguments and print detailed failure messages.

- `EXPECT_PRED_FORMATn(pred_formatter, vals...)` / `ASSERT_PRED_FORMATn`
  - Extends predicate assertions allowing custom failure message formatting.

Example:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, value);
```

### 8. Windows HRESULT Assertions

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED(expression)`
- `EXPECT_HRESULT_FAILED(expression)` / `ASSERT_HRESULT_FAILED(expression)`

Checks whether a COM HRESULT indicates success or failure.

### 9. Death Assertions

Verify that code terminates the process as expected.

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH` for termination with nonzero exit and matching stderr.
- `EXPECT_EXIT(statement, predicate, matcher)` / `ASSERT_EXIT` for verifying specific exit code or signal and matching stderr.

Example:

```cpp
EXPECT_DEATH({ CrashFunction(); }, "segmentation fault");
EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "done");
```

### 10. Generalized Assertions Using Matchers

- `EXPECT_THAT(value, matcher)` / `ASSERT_THAT(value, matcher)`
  - Assert `value` satisfies complex `matcher` (from GoogleMock).

Matchers read like English and provide clear failure messages:

```cpp
EXPECT_THAT(result, AllOf(Gt(5), Lt(10)));
EXPECT_THAT(string_value, StartsWith("Hello"));
```

---

## Best Practices for Structuring Assertions

- Prefer `EXPECT_` assertions unless the failure prevents meaningful continuation.
- Stream custom failure messages into assertions using `<<` to clarify why a check failed.
- When comparing strings, use the appropriate C-string or object-string assertions.
- For floating-point checks, use the dedicated floating-point assertions rather than `EXPECT_EQ`.
- Use predicate-format assertions for complex conditions needing detailed diagnostics.
- When testing code that must terminate, use death assertions explicitly.

Example of using custom failure messages:

```cpp
ASSERT_EQ(results.size(), expected_size) << "Result count mismatch";
for (int i = 0; i < results.size(); ++i) {
  EXPECT_EQ(results[i], expected[i]) << "failed at index " << i;
}
```

---

## Troubleshooting Common Issues

### Assertion Failure but Test Continues

Check if you used `EXPECT_` assertions instead of `ASSERT_`. Use `ASSERT_` when proceeding after failure is unsafe.

### Comparing C Strings but Getting Wrong Results

Remember that `EXPECT_EQ` compares pointers, not string contents. Use `EXPECT_STREQ` for contents.

### Floating-point checks fail unexpectedly

Use `EXPECT_FLOAT_EQ` or `EXPECT_NEAR` to accommodate rounding errors.

### Death test failures

- Ensure your death test code runs in a separate process.
- Verify the regular expression in the death matcher matches stderr output.
- Use the correct death test style for your platform.

### Predicate assertion syntax errors

- When using overloaded predicates, specify explicit function pointer cast.
- Use `EXPECT_PRED_FORMAT` for custom formatted failures.

---

## Summary

By mastering the suite of GoogleTest assertion macros, you can craft tests that validate your code precisely while maintaining readability and diagnostic power. Careful use of fatal vs non-fatal assertions, leveraging GoogleMock matchers, and adding custom failure messages transform tests from simple verifications into powerful documentation of code correctness.

---

## Related Documentation and Resources

- [Assertions Reference](../reference/assertions.md) — Complete list of assertions.
- [Matchers Reference](../reference/matchers.md) — Rich set of matchers used with `EXPECT_THAT`.
- [GoogleTest Primer](../docs/primer.md) — Fundamentals of test writing.
- [gMock Cookbook](../docs/gmock_cook_book.md) — Using matchers and expectations in detail.
- [Exception Assertions](../reference/assertions.md#exceptions) — For exception-related tests.
- [Death Tests](../docs/advanced.md#death-tests) — Writing and understanding death tests.

---

<Callout type="tip">
For detailed mismatch diagnostics on complex test conditions, pair `EXPECT_THAT` with suitable matchers. Prefer non-fatal `EXPECT_` variants for assertions that allow continued test execution and broader error visibility.
</Callout>

---

## Example: Testing a Factorial Function with Assertions

```cpp
// Function to test
int Factorial(int n) {
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}

// Tests
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  ASSERT_GT(Factorial(3), 0) << "Factorial must be positive";
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320) << "Unexpected factorial value";
}
```

---

## Example: Using a Predicate Assertion

```cpp
// Checks if two integers are mutually prime
bool MutuallyPrime(int m, int n) {
  // Implementation omitted
  return true; // placeholder
}

EXPECT_PRED2(MutuallyPrime, 3, 4);  // Passes if 3 and 4 are mutually prime
EXPECT_PRED2(MutuallyPrime, 4, 10); // Fails if 4 and 10 share factor
```

This allows for detailed error messages including argument values upon failure.

---

## Example: Using Exception Assertions

```cpp
EXPECT_THROW({ ThrowError(); }, std::runtime_error);
EXPECT_NO_THROW({ SafeFunction(); });
```

---

## Example: Death Test

```cpp
TEST(MyDeathTest, CrashOnBadInput) {
  ASSERT_DEATH({ Process(null_ptr); }, "Null pointer");
}
```

---

## Summary Table of Key Assertion Types

| Assertion Type             | Macro Example                | Behavior on Failure    | Use Case                             |
|---------------------------|------------------------------|-----------------------|-------------------------------------|
| Non-Fatal Boolean Check   | `EXPECT_TRUE(condition)`     | Test continues         | Check condition, continue testing   |
| Fatal Boolean Check       | `ASSERT_TRUE(condition)`     | Abort current function | Stop if error critical              |
| Equality Check           | `EXPECT_EQ(val1, val2)`       | Non-fatal or fatal variant | Check values equality             |
| String Content Check     | `EXPECT_STREQ(str1, str2)`    | Non-fatal or fatal variant | Compare C-string values           |
| Floating Point Approx.   | `EXPECT_FLOAT_EQ(val1, val2)` | Non-fatal or fatal variant | Tolerant floating-point equality  |
| Exception Check          | `EXPECT_THROW(stmt, ExceptionType)` | Non-fatal or fatal variant | Verify exceptions thrown          |
| Death Test               | `EXPECT_DEATH(stmt, matcher)` | Non-fatal or fatal variant | Verify process termination         |
| Predicate Check          | `EXPECT_PRED2(pred, val1, val2)` | Non-fatal or fatal variant | Complex Boolean function test      |
| Generalized Matcher Check | `EXPECT_THAT(val, matcher)`  | Non-fatal or fatal variant | Use flexible matchers             |

---

## Final Tips

- Use `ASSERT_` assertions when subsequent operations depend critically on prior conditions.
- Always provide meaningful failure messages to help identify the root causes.
- Utilize `EXPECT_THAT` with GoogleMock matchers for the richest assertion semantics.
- Be mindful of assertion placement — fatal assertions cannot be used in non-void functions.

---

## Navigation

- Back to [Writing Basic and Parameterized Tests](../guides/getting-started/writing-tests.md)
- Next: [Mocking Patterns and Mock Workflows](../guides/mocking-patterns/defining-using-mocks.md)
- Reference: [GoogleTest Assertions Reference](../reference/assertions.md)

---

<Check>
Master these assertions to uncover, isolate, and fix bugs faster with clear test execution flows and informative diagnostics.
</Check>
