---
title: "Setting Up Your Project"
description: "A step-by-step guide to integrating GoogleTest into your C++ project. Covers project initialization, build configurations, and linking GoogleTest with CMake or Bazel. By the end, you'll have GoogleTest up and running in your development environment."
---

# Setting Up Your Project with GoogleTest

## Overview

This guide provides you with a clear, actionable path to integrate GoogleTest into your existing C++ project. You will learn how to initialize your project environment, configure builds using CMake or Bazel, and correctly link GoogleTest libraries. By following these steps, you will have GoogleTest ready to run automated tests in your development workflow.

---

## Prerequisites

- A C++ project ready for integration.
- C++17 compatible compiler and build environment.
- CMake (version 3.14 or later) installed for CMake builds.
- Git installed for cloning repositories (optional but recommended).
- Basic understanding of C++ build systems and commands.


## Expected Outcome

- GoogleTest source is incorporated in your project build.
- Your project build links correctly against GoogleTest libraries.
- You can compile and run GoogleTest-based tests.


## Time Estimate

Approximately 15–30 minutes depending on your familiarity with build systems and environment setup.

---

## Step-by-Step Instructions

### 1. Obtain GoogleTest Source

You have two main options:

- Clone the GoogleTest repository manually:
  ```bash
  git clone https://github.com/google/googletest.git -b v1.17.0
  ```
- Use automated FetchContent in CMake to download during build (preferred for seamless integration).


### 2. Building GoogleTest as a Standalone Project with CMake (Optional)

If you want to build GoogleTest separately before integrating:

```bash
cd googletest
mkdir build
cd build
cmake ..
make
sudo make install  # (if you have privileges and want to install system-wide)
```

To omit GoogleMock and build only GoogleTest:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

Expected result:
- GoogleTest and GoogleMock libraries are built.
- Installation places headers and libraries for global use.


### 3. Integrating GoogleTest into Your Existing CMake Project

Using GoogleTest as a subdirectory within your build ensures consistent compiler and linker settings.

Add the following to your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# For Windows only: link CRT dynamically to avoid runtime conflicts
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

# Example: your test executable
add_executable(your_test_executable test_file.cpp)

# Link GoogleTest libraries
# Use gtest_main to link with GoogleTest's default main() function
# or gtest if you want to provide your own main()
target_link_libraries(your_test_executable gtest_main)

# Enable test running with CTest
include(GoogleTest)
gtest_discover_tests(your_test_executable)
```

This method:
- Downloads GoogleTest automatically during configuration
- Compiles with your project's compiler settings
- Avoids version mismatches


### 4. Configuring Bazel to Use GoogleTest

For Bazel, add GoogleTest as a dependency in your workspace and create BUILD files.

Refer to the [Installation with Bazel guide](/getting-started/requirements-installation/installation-bazel) for detailed steps including workspace setup, BUILD file content, and test targets.


### 5. Customizing Compiler and Linker Settings

- Ensure your project uses **C++17** or later.
- For Windows Visual Studio builds, you may need to set:
  ```cmake
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
  ```
  to avoid runtime library mismatches.

- To build GoogleTest as a shared library (DLL), add the compiler flag:
  ```
  -DGTEST_CREATE_SHARED_LIBRARY=1
  ```

- When compiling test binaries against shared GoogleTest library, add:
  ```
  -DGTEST_LINKED_AS_SHARED_LIBRARY=1
  ```


### 6. Using Provided `main()` Functions

GoogleTest provides default `main()` implementations (in gtest_main) that initialize testing and run all tests.

**Recommendation:** When you link with `gtest_main`, you should not provide your own `main()` to avoid conflicts.

To link your test executable with the default main:

```cmake
target_link_libraries(your_test_executable gtest_main)
```

If you need custom test setup, link against `gtest` and provide a custom `main()` function.


### 7. Build and Run Your Tests

Once integrated, build your project:

```bash
cmake --build .
ctest    # to run tests if you configured tests with CTest
# or run your test executable directly
./your_test_executable
```

Your test output will indicate success or failure along with detailed assertion messages.

---

## Practical Tips & Best Practices

- **FetchContent Approach:** Best for most CMake-based projects; keeps GoogleTest in sync automatically.
- **Static vs Dynamic CRT on Windows:** Ensuring `gtest_force_shared_crt` is ON avoids linker errors.
- **Consistent Compiler Flags:** GoogleTest must be built with the same compiler and flags as your project.
- **Use `gtest_main`:** Simplifies setup by using GoogleTest’s default test runner.

---

## Troubleshooting Common Issues

<AccordionGroup title="Common Setup Problems">
<Accordion title="Linker Errors Related to CRT mismatch on Windows">
&lt;Warning&gt;
Linker errors such as `mismatch detected for 'RuntimeLibrary'` indicate CRT mismatches.

**Solution:** Set CMake option `gtest_force_shared_crt` to ON before including GoogleTest in your build.

Example:
```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```
&lt;/Warning&gt;
</Accordion>
<Accordion title="C++ Standard Version Errors">
&lt;Warning&gt;
Errors indicating unsupported features usually mean your compiler doesn’t support C++17.

**Solution:** Ensure your toolchain supports C++17 and specify it in your `CMakeLists.txt`:
```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```
&lt;/Warning&gt;
</Accordion>
<Accordion title="GoogleTest Not Found During Build">
&lt;Warning&gt;
If `find_package(GTest CONFIG REQUIRED)` fails:
- GoogleTest may not be installed or discoverable.
- Prefer using `FetchContent` or manually add GoogleTest sources in your build tree.

Check your `CMAKE_PREFIX_PATH` or installation paths.
&lt;/Warning&gt;
</Accordion>
</AccordionGroup>

---

## Summary

By following this guide, you will successfully integrate GoogleTest into your C++ development environment, leveraging its powerful testing capabilities with minimal configuration. Building GoogleTest simultaneously with your project ensures compatibility and ease of maintenance.

---

## Next Steps

- Write your first tests using GoogleTest primitives (`TEST()`, `TEST_F()`). See [Writing Your First Tests](/guides/getting-started/writing-basic-tests).
- Learn about test lifecycles and assertions in the Primer: https://github.com/google/googletest/blob/main/docs/primer.md
- Explore GoogleMock integration if you need mocking capabilities: see the [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md).
- Troubleshoot and validate your setup via the [Validation & Troubleshooting guide](/getting-started/configuration-validation/validation-troubleshooting).

---

## Useful References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [CMake Installation Instructions](https://cmake.org/install/)
- [GoogleTest README - Build instructions](https://github.com/google/googletest/blob/main/googletest/README.md)
- [Primer on Writing Tests](https://github.com/google/googletest/blob/main/docs/primer.md)

---

## Diagram: GoogleTest Integration Workflow

```mermaid
flowchart TD

  A[Start: Existing C++ Project] --> B[Choose Integration Method]
  B -->|Manual Clone| C[Clone GoogleTest repository]
  B -->|CMake FetchContent| D[Add FetchContent declaration in CMakeLists.txt]

  C --> E[Build GoogleTest standalone (optional)]
  E --> F[Install or keep local]
  F --> G[Configure project to find GoogleTest]
  D --> G[Configure project to find GoogleTest]

  G --> H[Link GoogleTest libraries (gtest or gtest_main)]
  H --> I[Add test executables with GoogleTest linkage]
  I --> J[Write test code using GoogleTest macros]
  J --> K[Build project with tests]
  K --> L[Run tests with ctest or directly]
  L --> M[Review test results]

  M --> N[Success?]
  N -->|Yes| O[Continue writing more tests]
  N -->|No| P[Troubleshoot setup]
  P --> G

  classDef startend fill:#f96,stroke:#333,stroke-width:2px;
  classDef process fill:#bbf,stroke:#333,stroke-width:1.5px;

  class A,N,O startend;
  class B,C,D,E,F,G,H,I,J,K,L,M,P process;
```

---

## Code Example: Minimal `CMakeLists.txt` Integration

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp)

target_link_libraries(my_tests gtest_main)

include(GoogleTest)
gtest_discover_tests(my_tests)
```

Replace `test_main.cpp` with your test source files.

---