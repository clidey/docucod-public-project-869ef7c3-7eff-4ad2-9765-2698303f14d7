---
title: "Assertions and Fundamental Test Patterns"
description: "Explore the full breadth of assertion macros available in GoogleTest. This guide details best practices for checking values, handling fatal/non-fatal failures, writing expressive checks, and using custom assertions for domain-specific needs."
---

# Assertions and Fundamental Test Patterns

Explore the full breadth of assertion macros available in GoogleTest. This guide details best practices for checking values, handling fatal/non-fatal failures, writing expressive checks, and using custom assertions for domain-specific needs.

---

## 1. Understanding GoogleTest Assertions

GoogleTest provides a rich set of assertion macros for validating your code's behavior during testing. These assertions help you confirm that your code produces expected results and handles error conditions appropriately.

### Key Concepts

- **Fatal vs Non-Fatal Failures**: There are two primary variants of most assertions:
  - `ASSERT_` macros generate fatal failures, immediately aborting the current test function.
  - `EXPECT_` macros generate non-fatal failures, allowing the test to continue.

- **Custom Failure Messages**: You can add a message to any assertion to provide more context about failures.

Example:

```cpp
EXPECT_TRUE(value > 0) << "Value must be positive, but got " << value;
```

---

## 2. Core Assertion Categories and Usage Patterns

### 2.1 Explicit Success and Failure

Sometimes you want to explicitly mark a point in your test as succeeded or failed.

- `SUCCEED()`: Marks a point of successful execution (mainly documentation).
- `FAIL()`: Generates a fatal failure and aborts the current function.
- `ADD_FAILURE()`: Generates a non-fatal failure and continues.

Example using `FAIL()`:

```cpp
if (some_unexpected_case) {
  FAIL() << "Unexpected case encountered";
}
```

### 2.2 Boolean Condition Checks

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` — Checks condition is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` — Checks condition is false.

Use these for verifying predicates or simple boolean expressions.

### 2.3 Binary Comparisons

Compare two values with operators:

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — Checks equality.
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — Checks inequality.
- `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE` — Less than, less or equal, greater than, greater or equal.

**Important:**

- For C strings, use string specialized macros (e.g., `EXPECT_STREQ`) because `EXPECT_EQ` compares pointers, not contents.

Example:

```cpp
EXPECT_EQ(result, expected_value) << "Result did not match expected!";
```

### 2.4 String Comparison

GoogleTest provides assertions for C string content comparison:

- `EXPECT_STREQ`, `ASSERT_STREQ` — Compare C strings for equality.
- `EXPECT_STRNE`, `ASSERT_STRNE` — Check C strings are not equal.
- `EXPECT_STRCASEEQ`, `ASSERT_STRCASEEQ` — Case-insensitive string equality.
- `EXPECT_STRCASENE`, `ASSERT_STRCASENE` — Case-insensitive string inequality.

### 2.5 Floating-Point Comparisons

Due to rounding errors, floating-point comparisons require approximate checks:

- `EXPECT_FLOAT_EQ`, `ASSERT_FLOAT_EQ` — Approximate equality for floats (returns true if within 4 ULPs).
- `EXPECT_DOUBLE_EQ`, `ASSERT_DOUBLE_EQ` — The same for doubles.
- `EXPECT_NEAR(val1, val2, abs_error)`, `ASSERT_NEAR` — Checks values are within an absolute error bound.

### 2.6 Exception Assertions

Verify if code throws or does not throw exceptions. Requires exceptions support enabled.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW` — Specify exact exception.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW` — Any exception.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW` — Verify no exception thrown.

Example:

```cpp
EXPECT_THROW(SomeFunctionThatThrows(), std::runtime_error);
```

### 2.7 Predicate Assertions

To write expressive checks on complex conditions or multiple arguments:

- `EXPECT_PRED*` and `ASSERT_PRED*`: Accept predicates with 1 to 5 parameters.
- `EXPECT_PRED_FORMAT*` and `ASSERT_PRED_FORMAT*`: Use predicate-formatters that return detailed failure messages.

Example:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, x);
```

### 2.8 Matchers Integration

Use `EXPECT_THAT(value, matcher)` to leverage GoogleMock matchers with GoogleTest assertions for richer semantics and failure messages.

Example:

```cpp
EXPECT_THAT(my_string, StartsWith("Hello"));
EXPECT_THAT(value, AllOf(Gt(5), Lt(10)));
```

---

## 3. Writing Expressive and Robust Assertions

### Best Practices

- Use `EXPECT_` variants when you want tests to continue after failure for multiple assertions.
- Use `ASSERT_` variants to stop test execution on critical failures affecting further checks.
- Prefer matchers and predicate assertions for clearer, more maintainable tests.
- Add informative custom messages to all assertions to aid debugging.

### Handling Special Types

- For pointer comparisons, consider the semantics — use `EXPECT_EQ(ptr, nullptr)` rather than comparing to `NULL`.
- Use string assertions for C strings, not pointer equality checks.
- For floating-point numbers, avoid direct equality checks due to rounding precision.

### Floating-Point Comparison Tips

- Prefer `EXPECT_NEAR` when you want to specify a custom tolerance.
- Use `EXPECT_FLOAT_EQ` and `EXPECT_DOUBLE_EQ` when the tolerance based on ULP makes sense.

### Custom Assertion Examples

```cpp
EXPECT_PRED_FORMAT2(IsWithinRange, value, low, high);
```

You can define your own `IsWithinRange` predicate formatter to print detailed messages.

---

## 4. Special Assertion Types

### HRESULT Assertions (Windows only)

Check success or failure of Windows `HRESULT` values.

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED`
- `EXPECT_HRESULT_FAILED(expression)` / `ASSERT_HRESULT_FAILED`

These display human-readable error messages with the HRESULT code.

### Death Assertions

Check that a statement causes program termination with expected output.
These spawn a child process and verify termination and stderr content.

- `EXPECT_DEATH(statement, matcher)` / `ASSERT_DEATH`
- `EXPECT_DEATH_IF_SUPPORTED` / `ASSERT_DEATH_IF_SUPPORTED`
- `EXPECT_DEBUG_DEATH` / `ASSERT_DEBUG_DEATH`
- `EXPECT_EXIT(statement, predicate, matcher)` / `ASSERT_EXIT`

Example:

```cpp
EXPECT_DEATH(MyFunctionThatCrashes(), "Error \d+");
```

---

## 5. Practical Examples

### Example 1: Basic Equality Check

```cpp
TEST(MyTestSuite, BasicEquality) {
  int a = 5;
  int b = 5;
  EXPECT_EQ(a, b) << "a and b should be equal";
}
```

### Example 2: Floating Point Comparison with Tolerance

```cpp
TEST(MyTestSuite, FloatComparison) {
  float result = ComputeValue();
  EXPECT_NEAR(result, 3.14f, 0.01f) << "Result is outside the tolerance";
}
```

### Example 3: Testing Exception Throwing

```cpp
TEST(MyTestSuite, ThrowsException) {
  EXPECT_THROW(DoRiskyThing(), std::runtime_error);
}
```

### Example 4: Using Matcher for String Pattern

```cpp
TEST(MyTestSuite, StringPattern) {
  std::string output = GenerateOutput();
  EXPECT_THAT(output, StartsWith("Hello"));
}
```

---

## 6. Troubleshooting Assertions

### Common Issues

- **Mixing fatal and non-fatal assertions:** Use ASSERT if failure should stop test function.
- **Comparing pointers instead of string contents:** Use string-specific assertions like `EXPECT_STREQ`.
- **Floating point exact equality failure:** Use `EXPECT_NEAR` instead.
- **Unclear failure messages:** Add custom message using `<<` operator.
- **Exception tests don't catch expected exceptions:** Ensure exceptions are enabled and correct type specified.

### Debugging Tips

- Run tests with verbose output to get detailed failure information.
- Break down compound predicates into simpler assertions.
- Use predicate formatters to get more descriptive failure messages.

---

## 7. Next Steps and Related Information

- Explore [GoogleTest Matchers Reference](matchers.md) for advanced comparison techniques.
- Learn about [Parameterized and Typed Tests](concepts/testing-foundations/test-parameterization) to write reusable test patterns.
- Review [Mocking Fundamentals](api-reference/core-apis/mocking-core-api) for integrating assertions with mocks.
- Practice writing custom matchers for domain-specific assertions.


---

# Additional Resources

- [GoogleTest Assertions Reference](https://google.github.io/googletest/reference/assertions.html)
- [GoogleMock Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [GoogleTest Primer (Getting Started)](/guides/getting-started/setup-first-test)

---

**Tip:** Use assertions to clearly express what your tests expect and to get the most actionable, human-friendly feedback on failures.

---