---
title: "Test Discovery and Execution Workflow"
description: "Explains how GoogleTest automatically discovers all your tests, strategies for organizing test files, and practical tips for running tests individually or in bulk. Covers command-line usage and integration with main() entry points."
---

# Test Discovery and Execution Workflow

## Overview

This guide explains how GoogleTest automatically discovers all your tests, strategies for organizing your test files, and practical tips for running tests individually or in bulk. It covers both command-line usage and integration approaches with the `main()` entry points you typically define or link against.

GoogleTest is designed to find and run every test you define with minimal setup, letting you focus on test content instead of registration or execution mechanics.

---

## 1. Understanding Test Discovery

### How GoogleTest Finds Tests Automatically

GoogleTest leverages the test registration macros (`TEST()`, `TEST_F()`, `TEST_P()`, etc.) that you use in your code to *automatically register* tests at static initialization time. When your test binary starts, GoogleTest discovers all these registrations and organizes them into test suites.

You do not need to manually register tests anywhere; the framework tracks them all for you.

### Organizing Test Files and Suites

- **Test Suites** group related test cases logically.
- Your test suite name typically reflects the class or module under test.
- Tests within each suite are scoped by their individual names.

**Best Practices:**
- Name test suites to reflect your production classes or modules (e.g., `FactorialTest`).
- Keep related tests together in files, maintaining clean separation by feature or component.
- Avoid underscores (`_`) in test suite or test names — GoogleTest uses underscores internally and underscores in names can cause conflicts or unpredictable results.
  
> See the [GoogleTest FAQ](../faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore) for detailed restrictions.

---

## 2. Execution Workflow and Running Tests

The typical usage flow looks like this:

### Step 1: Initialize GoogleTest

Include `gtest/gtest.h` and invoke `testing::InitGoogleTest(&argc, argv);` in your `main()` function. This step parses the command line arguments and configures test execution flags.

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Step 2: Running All or a Subset of Tests

Use `RUN_ALL_TESTS()` to execute all discovered tests.

- By default, all tests are run sequentially.
- You can filter which tests to run using the command-line `--gtest_filter` flag or the environment variable `GTEST_FILTER`.

#### Filtering Tests

Filter syntax allows specifying positive patterns and, optionally, negative patterns separated by a hyphen (`-`). Patterns are separated by colon (`:`). Wildcards `*` (match any string) and `?` (match any single character) are supported.

Examples:

```shell
# Run all tests in suite FactorialTest
./my_test --gtest_filter=FactorialTest.*

# Run all tests containing 'Zero' or 'Positive'
./my_test --gtest_filter=*Zero*:*Positive*

# Run all tests except those in DeathTests
./my_test --gtest_filter=-*DeathTest.*
```

### Step 3: Running Individual Tests

Run a single test by specifying its full name:

```shell
./my_test --gtest_filter=QueueTest.DequeueWorks
```

### Step 4: Listing Available Tests

Before running tests, you might want to see the tests available:

```shell
./my_test --gtest_list_tests
```

GoogleTest prints all test suites and their contained tests without running any.

---

## 3. Test Suite and Test Lifecycle

Each test suite and test execution follows a well-defined lifecycle managed by GoogleTest.

- **Test Suite Setup and Teardown:**
  - Use `static void SetUpTestSuite()` and `static void TearDownTestSuite()` within your test fixture class to manage resources shared across all tests in the suite.
  - Called once before the first test starts and after the last test finishes.

- **Test Fixture Setup and Teardown:**
  - `SetUp()` and `TearDown()` are called before and after each individual test in the suite.

GoogleTest creates a *fresh* instance of your test fixture class for each test to ensure isolation.

---

## 4. Practical Tips for Running Tests

### Running Tests Via Command Line Arguments

| Flag / Env Variable | Purpose                                  | Example                                        |
|---------------------|------------------------------------------|------------------------------------------------|
| `--gtest_filter`     | Run specific tests or suites             | `--gtest_filter=MySuite.MyTest`                 |
| `--gtest_list_tests` | List all available tests                  | `--gtest_list_tests`                             |
| `--gtest_repeat`     | Repeat tests multiple times               | `--gtest_repeat=10` repeats all tests 10 times |
| `--gtest_shuffle`    | Randomize test order                      | `--gtest_shuffle`                               |
| `--gtest_fail_fast`  | Stop on first test failure                | `--gtest_fail_fast`                             |

### Running Disabled Tests

To run disabled tests (tests prefixed with `DISABLED_`), specify:

```shell
./my_test --gtest_also_run_disabled_tests
```

### Fail Fast Mode

Stop running tests after the first failure with:

```shell
./my_test --gtest_fail_fast
```

### Test Sharding (Parallelization)

Distribute tests across multiple machines or processes using sharding variables `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX` environment variables. See the [Advanced Guide](advanced.md#running-test-programs-advanced-options) for details.

---

## 5. Integrating with your `main()` Entry Point

### Default `main()` from gtest_main

For convenience, GoogleTest provides the `gtest_main` library, which contains a default main function that does initialization and runs all tests.

You only need to link against `gtest_main` if you don't want to write your own `main()`.

### Writing a Custom `main()`

If you need custom setup or teardown logic, write your own `main()`. Always:

1. Call `testing::InitGoogleTest(&argc, argv);` early in `main()`.
2. Call `RUN_ALL_TESTS()` and return its result.

Example:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  // custom pre-test setup ...
  int result = RUN_ALL_TESTS();
  // custom post-test teardown ...
  return result;
}
```

---

## 6. Running Tests Individually or in Bulk

### Run All Tests

Simply execute your test binary with no filtering:

```shell
./my_tests
```

Runs every test discovered.

### Run Specific Tests

Use filtering with full test names or patterns:

```shell
./my_tests --gtest_filter=SuiteName.TestName
./my_tests --gtest_filter=SuiteName.*
./my_tests --gtest_filter=*.TestNamePrefix*
```

### Bulk Execution with Repeat and Shuffle

- For stress-testing flaky failures:

  ```shell
  ./my_tests --gtest_repeat=100 --gtest_shuffle
  ```

- Analyze test order-dependent failures by randomizing test order.

### Use Batch Scripts or CI Pipelines

Integrate test runs into your continuous integration pipelines by invoking test binaries with filters or repeat/shuffle parameters.

---

## 7. Common Pitfalls & Considerations

- **Ignoring RUN_ALL_TESTS return value:**
  Always use `return RUN_ALL_TESTS();` in `main()`. GoogleTest determines success from this return code.

- **Naming constraints:**
  Avoid underscores in test suite and test names to prevent name collisions.

- **Shared fixtures:**
  Avoid state sharing between tests unless managed via `SetUpTestSuite` / `TearDownTestSuite` static methods.

- **Disabled tests:**
  Remember disabled tests are compiled but not run unless explicitly enabled.

- **Filtering syntax:**
  Confirm patterns use `*`, `?`, and `:` with correct syntax to target tests effectively.

- **Death tests:**
  Death tests must be placed in test suites with `DeathTest` suffix for correct ordering and behavior.

---

## 8. Summary

GoogleTest provides a seamless, automatic test discovery and execution framework with command-line driven flexibility. Tests are organized into suites with fine-grained filtering, supporting everything from running one test to repeated or shuffled executions.

By following this guide, you will master running your tests efficiently, understand how GoogleTest organizes and executes them, and be prepared to scale your test strategy confidently.

---

## See Also

- [GoogleTest Primer](../primer.md) - Learn how to write simple tests
- [Advanced GoogleTest Topics](../advanced.md) - Deep dive into advanced testing strategies
- [Test Fixture Usage](../primer.md#same-data-multiple-tests) - Write reusable test logic
- [GoogleTest FAQ](../faq.md) - Common questions about test execution and naming
- [Command Line Usage](../advanced.md#running-test-programs-advanced-options) - Additional flags and options


---

<Tip>
Keep your test suite and test names clean and consistent. Use the command-line `--gtest_filter` flag extensively to run focused tests during development, and rely on full runs in your CI pipelines.
</Tip>

<Note>
GoogleTest’s organization of tests into suites and its automatic discovery eliminates the need for manual test registration or build-time code generation. Use it to simplify your testing workflow.
</Note>

<Warning>
Never ignore the return value of `RUN_ALL_TESTS()`. Failing to do so can result in test failures being missed in automated systems.
</Warning>