---
title: "Setting Up and Running Your First Test"
description: "Learn how to set up GoogleTest and GoogleMock in your project, integrate with CMake or Bazel, and write and run your inaugural test case. This page walks you through installation, configuration, and executing your initial tests, providing a solid starting point for all test-driven work."
---

# Setting Up and Running Your First Test

## Workflow Overview

### Task Description
This guide leads you through setting up GoogleTest and GoogleMock in your C++ project, integrating them with popular build systems, and writing and running your inaugural test case. By completing this workflow, you will prepare your development environment to leverage automated testing, enabling higher quality and more maintainable code.

### Prerequisites
- A working C++ development environment supporting C++17.
- Basic familiarity with C++ projects and build systems like CMake or Bazel.
- Access to the GoogleTest and GoogleMock source code or installed binaries.

### Expected Outcome
- Successfully build and link GoogleTest and GoogleMock into your project.
- Create and run a simple test using the GoogleTest framework.
- Understand how to write a test fixture and run it.

### Time Estimate
Approximately 20-45 minutes, depending on familiarity with build tools.

### Difficulty Level
Beginner to Intermediate.

---

## Step-by-Step Instructions

### 1. Obtaining GoogleTest and GoogleMock

- Clone the GoogleTest repository with the desired version (e.g., v1.17.0):
  ```bash
  git clone https://github.com/google/googletest.git -b v1.17.0
  cd googletest
  ```
- By default, the repository contains both GoogleTest and GoogleMock source code.

### 2. Building GoogleTest and GoogleMock with CMake

#### Standalone Build

1. Create a build directory inside the source:
   ```bash
   mkdir build
   cd build
   ```
2. Generate build scripts. To include GoogleMock (default):
   ```bash
   cmake ..
   ```
   To build GoogleTest only (no GoogleMock):
   ```bash
   cmake .. -DBUILD_GMOCK=OFF
   ```
3. Build the libraries:
   ```bash
   make
   ```
4. (Optional) Install the libraries system-wide:
   ```bash
   sudo make install
   ```

#### Integration Into an Existing CMake Project

- Use `find_package(GTest REQUIRED)` if GoogleTest is installed.
- Alternatively, add GoogleTest as a subdirectory to your project to ensure consistent compiler/linker flags:
  ```cmake
  include(FetchContent)
  FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
  )
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Windows dynamic runtime
  FetchContent_MakeAvailable(googletest)

  add_executable(example example.cpp)
  target_link_libraries(example gtest_main gmock_main)
  add_test(NAME example_test COMMAND example)
  ```
  This approach requires CMake 3.14 or later.

### 3. Considerations for Compiler and Runtime Settings

- GoogleTest requires C++17; make sure to specify `-std=c++17` or equivalent.
- When using Visual Studio, address runtime library mismatches with `gtest_force_shared_crt` option.

### 4. Writing Your First Test

- Create a C++ source file for tests, e.g., `example_test.cpp`.
- Include the GoogleTest header:
  ```c++
  #include <gtest/gtest.h>
  ```
- Define a simple test using the `TEST()` macro:
  ```c++
  int Factorial(int n) {
    return (n <= 1) ? 1 : n * Factorial(n - 1);
  }

  TEST(FactorialTest, HandlesZeroInput) {
    EXPECT_EQ(Factorial(0), 1);
  }

  TEST(FactorialTest, HandlesPositiveInput) {
    EXPECT_EQ(Factorial(1), 1);
    EXPECT_EQ(Factorial(3), 6);
  }
  ```

### 5. Writing a Test Fixture (Optional but Recommended)

- For multiple tests sharing setup, define a fixture class derived from `testing::Test`:
  ```c++
  class QueueTest : public testing::Test {
   protected:
    QueueTest() {
      q1_.Enqueue(1);
      q2_.Enqueue(2);
      q2_.Enqueue(3);
    }
    Queue<int> q0_;
    Queue<int> q1_;
    Queue<int> q2_;
  };

  TEST_F(QueueTest, IsEmptyInitially) {
    EXPECT_EQ(q0_.size(), 0);
  }

  TEST_F(QueueTest, DequeueWorks) {
    int* n = q1_.Dequeue();
    ASSERT_NE(n, nullptr);
    EXPECT_EQ(*n, 1);
    delete n;
  }
  ```

### 6. Writing the `main()` Function (If Not Using Prebuilt `gtest_main`)

- Usually, link against `gtest_main` or `gmock_main`, which provide a predefined `main()`.
- If custom setup is required, define:
  ```c++
  #include <gtest/gtest.h>

  int main(int argc, char** argv) {
    testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
  }
  ```

### 7. Building and Running Your Tests

- Compile your test program by linking with `gtest`, `gmock`, and/or `gtest_main`, `gmock_main` depending on your setup.
- Run the test executable. It will automatically discover and run all registered tests.

### 8. Interpreting Results

- Success is indicated by `RUN_ALL_TESTS()` returning 0.
- Failed tests output detailed assertion failure messages with file, line number, and expected vs actual values.

---

## Practical Examples

### Minimal CMakeLists.txt to Build a Test
```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTests CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Windows
FetchContent_MakeAvailable(googletest)

add_executable(example_test example_test.cpp)
target_link_libraries(example_test gtest_main gmock_main)
add_test(NAME example_test COMMAND example_test)
```

### Running the Tests
```bash
./example_test
```
Output snippet when tests succeed:
```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput
[----------] 2 tests from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

---

## Troubleshooting & Tips

<AccordionGroup title="Common Issues and Resolutions">
<Accordion title="Build Errors due to Runtime Mismatches on Windows">
Ensure `gtest_force_shared_crt` is set to ON in your CMakeLists.txt to match your project's runtime linkage.
</Accordion>
<Accordion title="Linker Errors: Undefined Symbols for GoogleTest">
Verify that your test target links against `gtest`, `gtest_main`, or `gmock_main` libraries correctly.
</Accordion>
<Accordion title="Test Not Running or Detected">
Make sure tests are registered automatically (using `TEST()` or `TEST_F()` macros). Avoid manually needing to list tests.
</Accordion>
</AccordionGroup>

### Best Practices
- Prefer linking with `gtest_main` or `gmock_main` to avoid writing boilerplate `main()`.
- Use `ASSERT_*` assertions when subsequent test code depends on their success; otherwise, prefer `EXPECT_*`.
- Keep your tests isolated; do not share state between tests except through fixtures.
- Leverage `FetchContent` or submodule integration for seamless updates and consistency.

### Performance Considerations
- Run tests in parallel when supported by your build system.
- Reuse fixtures to avoid expensive setup where practical.

---

## Next Steps & Related Content

- After running your first tests, explore [Writing and Discovering Tests](guides/getting-started/writing-and-discovering-tests) to write more complex tests.
- Learn about [Mocking with GoogleMock](getting-started/gs-configuration-first-test/gs-mock-first-steps) to create mock objects and establish expectations.
- For project build automation, see [Integrating GoogleTest/GoogleMock with Your Build System](guides/integration-advanced/integrating-build-systems).
- Consult [System Requirements & Supported Platforms](getting-started/gs-prerequisites-installation/gs-system-requirements) to ensure your build environment is compatible.

---

<Info>
This guide focuses on setting up your environment and running initial tests. For extensive configuration options, macros, and frameworks, review the [GoogleTest Primer](overview/introduction-getting-started/what-is-googletest) and [GoogleTest Advanced](advanced.md).
</Info>
