---
title: "GoogleTest Primer"
description: "A hands-on introduction to writing unit tests in C++ using GoogleTest and GoogleMock. Covers creating test cases, assertions, and running tests for your first project."
---

# GoogleTest Primer

## Introduction

Welcome to your first hands-on guide to writing unit tests in C++ with GoogleTest and GoogleMock. This primer is designed to get you quickly up to speed in creating test cases, writing assertions, and running tests for your initial project. By the end of this guide, you will have successfully written and run your first test suite and gained insight into GoogleTest's testing capabilities.

## What You Will Learn

- How to write a basic GoogleTest test case
- Organizing tests with fixtures
- Using GoogleMock to create mock objects
- Running tests and interpreting the output

---

## Prerequisites

Before getting started, ensure:

- You have a working C++ development environment with C++17 support.
- GoogleTest and GoogleMock are installed and integrated into your build system.
- Basic understanding of C++ programming.

If you haven’t set up yet, consult the [Prerequisites & System Requirements](../getting-started/setup-basics/prerequisites-requirements.md) and [Installation](../getting-started/setup-basics/installation-platforms.md) guides.

---

## Writing Your First Test

### Step 1: Include GoogleTest Headers

Start by including the GoogleTest header in your test source file.

```cpp
#include <gtest/gtest.h>
```

### Step 2: Write a Basic Test Case

A test case consists of the `TEST` macro, which defines test name and test code blocks. Here’s a simple example that tests a simple function:

```cpp
// Function to be tested
int Add(int x, int y) {
  return x + y;
}

// Test case
TEST(AdditionTest, SimpleAdd) {
  EXPECT_EQ(Add(1, 2), 3);  // Asserts that Add(1, 2) == 3
  EXPECT_NE(Add(1, 2), 4);  // Asserts inequality
}
```

### Expected Results

- `EXPECT_EQ` passes if actual and expected values are equal.
- `EXPECT_NE` passes if they are not equal.
- On failure, GoogleTest provides detailed error messages with file location.

---

## Organizing Tests with Fixtures

If your tests share common setup or teardown code, use test fixtures.

### Step 1: Define a Test Fixture Class

```cpp
class FooTest : public testing::Test {
 protected:
  void SetUp() override {
    // Code here runs before each test
    value_ = 42;
  }

  void TearDown() override {
    // Code here runs after each test
  }

  int value_;
};
```

### Step 2: Use Fixture in Tests

```cpp
TEST_F(FooTest, CanAccessValue) {
  EXPECT_EQ(value_, 42);
}

TEST_F(FooTest, CanModifyValue) {
  value_ = 100;
  EXPECT_EQ(value_, 100);
}
```

`TEST_F` sets up tests that use the fixture `FooTest`. Setup and teardown are automatically handled.

---

## Using GoogleMock for Mock Objects

GoogleMock allows you to mock interfaces and verify interactions.

### Step 1: Define a Mock Class

Suppose you have an interface:

```cpp
class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenDown() = 0;
  virtual void PenUp() = 0;
  virtual void Forward(int distance) = 0;
  virtual int GetX() const = 0;
};
```

Define a mock class:

```cpp
#include <gmock/gmock.h>

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

### Step 2: Set Expectations and Use Mock

```cpp
using ::testing::AtLeast;
using ::testing::_;
using ::testing::Return;

TEST(TurtleTest, MovesForward) {
  MockTurtle turtle;

  // Expect PenDown() will be called at least once
  EXPECT_CALL(turtle, PenDown()).Times(AtLeast(1));

  // When GetX is called, return 100
  ON_CALL(turtle, GetX()).WillByDefault(Return(100));

  // Your code exercising turtle...
  turtle.PenDown();
  EXPECT_EQ(turtle.GetX(), 100);
}
```

Key points:
- Use `EXPECT_CALL` to specify expected calls and behavior.
- Use `ON_CALL` to specify default behavior without requiring the call.

---

## Running Your Tests

Compile your tests using your build system.

For example, with CMake, you can:

```bash
cmake --build .
ctest
```

Or simply run the test executable directly:

```bash
./my_test_executable
```

You should see output indicating all tests passed or failed, with details and locations for any failures.

---

## Tips and Best Practices

- **Set expectations before the code under test exercises the mock.** GoogleMock expects this to work correctly.
- **Use matchers wisely.** The matcher `_` means "any value" and prevents over-specifying arguments.
- **Use sequences** to enforce call orders with `InSequence`.
- **Suppress uninteresting call warnings** with `NiceMock` if you do not want warnings on allowable ignored calls.
- **Use `WillOnce()` and `WillRepeatedly()`** to control return behavior.
- **Avoid mocking methods you don’t own**. If you must, place mock classes near the source or in a dedicated testing namespace.

See the [gMock for Dummies](../guides/core-testing-workflows/mocking-and-expectations.md) and [gMock Cheat Sheet](../guides/core-testing-workflows/using-matchers-and-actions.md) for more.

---

## Troubleshooting

- **No tests run?** - Check if you defined the main test entry (`RUN_ALL_TESTS()`), and that tests are correctly registered.
- **Compilation errors with mocks?** - Make sure all mocked methods are `virtual` and that `MOCK_METHOD` usage is syntactically correct.
- **Test failures with unexpected calls?** - Verify that `EXPECT_CALL` matches your usage and in expected order.

If you need help, run tests with the flag `--gmock_verbose=info` to get detailed mock call trace.

---

## Next Steps

- Explore [Writing Effective Assertions](../guides/core-testing-workflows/writing-assertions.md) to deepen your testing skills.
- Learn about advanced mocking with [Using Matchers and Actions](../guides/core-testing-workflows/using-matchers-and-actions.md).
- Review the [gMock Cookbook](../guides/advanced-usage-and-optimization/using-actions-and-custom-behaviors.md) for tips on custom matchers and actions.

---

## Additional Resources

- Google's official [gMock GitHub Repository](https://github.com/google/googletest/tree/main/googlemock)
- Detailed API reference: [GoogleMock Mocking APIs](../api-reference/gmock-mocking-apis/mock-object-definition.md)
- Community and discussions on Google Test [Google Groups](https://groups.google.com/g/googletestframework)

---

With this foundation, you’re equipped to write robust unit tests with GoogleTest and GoogleMock. Begin with simple tests, then gradually introduce mocks and more advanced features to maintain a solid, maintainable test base for your C++ projects.

Happy testing!
