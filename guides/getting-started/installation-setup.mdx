---
title: "Installation and Setup"
description: "Learn how to install GoogleTest and GoogleMock, configure your environment, and confirm that your setup works using build systems like CMake or Bazel. Covers initial project configuration and dependency management."
---

# Installation and Setup

## Overview

This guide walks you through installing GoogleTest and GoogleMock, configuring your development environment, and validating your setup using popular build systems such as **CMake** and **Bazel**. It covers initial project setup, dependency management, and best practices to get your testing framework operational securely and efficiently.

---

## 1. Preparing Your Environment

### Prerequisites
- A system with **C++17** support and a compatible compiler.
- Installed **CMake** (minimum version recommended is 3.14).
- Installed **Bazel** if using Bazel as the build system.
- Access to the GoogleTest source code repository or its release tarballs.

### Expected Outcome
You will have GoogleTest and GoogleMock compiled, installed (optionally), and configured for use in your projects.

### Estimated Time
Approximately 10-20 minutes, depending on your familiarity with build tools.

### Difficulty Level
Beginner to Intermediate.

---

## 2. Cloning and Initial Setup

The first step is obtaining the GoogleTest sources, which include GoogleMock by default.

<Steps>
<Step title="Clone the Repository">
Run:
```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
```
This fetches version 1.17.0 with all subcomponents.
</Step>
<Step title="Create Build Directory">
Create a separate build directory to keep your source tree clean:
```bash
mkdir build
cd build
```
</Step>
</Steps>

---

## 3. Building with CMake

GoogleTest offers robust CMake support for both standalone builds and integration into your projects.

### Standalone Build

By default, GoogleMock is included; if you want only GoogleTest, disable GoogleMock explicitly.

<Steps>
<Step title="Generate Build Files">
Run:
```bash
cmake .. \
  -DCMAKE_CXX_STANDARD=17 \
  -Dgtest_build_samples=ON \
  -Dgtest_build_tests=ON \
  -Dgmock_build_tests=ON
```
This ensures samples and tests are built with proper C++17 flags.
</Step>
<Step title="Build the Library and Tests">
Execute:
```bash
make -j$(nproc)
```
This compiles GoogleTest and GoogleMock along with their tests and samples.
</Step>
<Step title="Run Tests to Confirm Setup">
Run tests:
```bash
ctest -j$(nproc) --output-on-failure
```
Confirms the build is successful and all tests pass.
</Step>
</Steps>

### Alternative: Building GoogleTest Only

If you want only GoogleTest and not GoogleMock, modify the generate step:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

---

## 4. Integrating GoogleTest into Your CMake Project

You can incorporate GoogleTest by either installing it system-wide or building it alongside your project.

### Using Installed GoogleTest

1. Install GoogleTest (typically requires system administrator privileges):

```bash
sudo make install
```

2. In your project CMakeLists.txt, import with pkg-config or find_package:

```cmake
find_package(PkgConfig REQUIRED)
pkg_search_module(GTEST REQUIRED gtest_main)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests PRIVATE ${GTEST_LDFLAGS})
target_compile_options(my_tests PRIVATE ${GTEST_CFLAGS})

enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

> For pkg-config guidance and troubleshooting, see the [Using GoogleTest from various build systems](docs/pkgconfig.md) documentation.

### Building Inline with Your Project

Add GoogleTest source as a subdirectory:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/v1.17.0.tar.gz
)
FetchContent_MakeAvailable(googletest)

add_executable(your_test your_test.cc)
target_link_libraries(your_test gtest_main)
add_test(NAME your_test COMMAND your_test)
```

This keeps compiler flags consistent and simplifies dependency management.

---

## 5. Building with Bazel

GoogleTest also supports Bazel build integration, which is commonly used in large CI environments.

<Steps>
<Step title="Choose Bazel Binary">
If running on Kokoro or a versioned environment, locate the Bazel binary, otherwise use the default:

```bash
BAZEL_BIN=bazel
```
</Step>
<Step title="Run Bazel Tests">
Execute the tests with example options:

```bash
${BAZEL_BIN} test ... \
  --copt="-Wall" \
  --copt="-Werror" \
  --copt="-Wundef" \
  --cxxopt="-std=c++17" \
  --enable_bzlmod=true \
  --keep_going \
  --show_timestamps \
  --test_output=errors
```
</Step>
</Steps>

> Bazel automatically manages dependencies and build correctness for GoogleTest and GoogleMock.

---

## 6. Configuration Options

### Control Compiler Flags

When using CMake, GoogleTest applies sane default flags for popular compilers like MSVC, GCC, and Clang. For example:

- On MSVC, warnings are set to `/W4`, `/WX` enabled.
- On GCC/Clang, warnings like `-Wall -Wshadow -Wundef` are enabled.
- Exception handling and RTTI flags are configurable via `cxx_exception_flags` and `cxx_no_rtti_flags`.

You may override the default flags during your build configuration by customizing options like `cxx_no_exception` or `cxx_no_rtti`.

### Shared vs Static Libraries

By setting `BUILD_SHARED_LIBS` or `-DBUILD_SHARED_LIBS=ON` you can choose shared or static linkage for the GoogleTest libraries. When building shared libraries, the macro `GTEST_CREATE_SHARED_LIBRARY=1` is defined to support proper linkage.

### Important Flags

- `gtest_force_shared_crt`: Ensures GoogleTest uses the shared runtime on MSVC to avoid multiple runtime copies.

---

## 7. Verifying Your Installation

Once built, confirm the following:

- All tests pass successfully with no failures.
- GoogleTest and GoogleMock libraries and headers are in expected locations if installed.
- Your project can link to GoogleTest libraries without compiler or linker errors.

You can test basic integration by compiling sample tests and running them as shown in the CMake integration step.

---

## 8. Troubleshooting and Tips

<AccordionGroup title="Common Setup Issues">
<Accordion title="Missing Headers or Linker Errors">
Ensure include paths and link libraries are correctly specified. Validate that GoogleTest was installed or built in your environment, and the correct versions of dependencies (e.g., pthreads) are available.
</Accordion>
<Accordion title="Compiler Compatibility">
Make sure your compiler supports C++17. Older compilers may fail to build GoogleTest.
</Accordion>
<Accordion title="Runtime Library Mismatches on Windows">
Use the `gtest_force_shared_crt` option in CMake if encountering multiple CRT runtime errors.
</Accordion>
</AccordionGroup>

<Tip>
If you are using pkg-config, and it can't find GoogleTest, set the `PKG_CONFIG_PATH` environment variable to the directory containing your `.pc` files. For cross-compilation, configure sysroot variables to ensure correct paths.
</Tip>

---

## 9. Next Steps

- After installation, proceed to [Writing Your First Test](/guides/getting-started/your-first-test) to start authoring tests.
- For build system integration beyond standalone setup, consult [Integrating with Build Systems and CI](/guides/advanced-practices/integration-build-systems).
- If you face issues, visit [Troubleshooting Common Setup Issues](/getting-started/troubleshooting/common-errors).

---

## Appendix: Example CMake Build Commands

```bash
# Clone the repository
 git clone https://github.com/google/googletest.git -b v1.17.0
 cd googletest

# Create build directory
 mkdir build && cd build

# Configure with GoogleMock enabled
 cmake .. -DCMAKE_CXX_STANDARD=17 -Dgtest_build_samples=ON -Dgtest_build_tests=ON -Dgmock_build_tests=ON

# Or configure to disable GoogleMock
 cmake .. -DBUILD_GMOCK=OFF

# Build
 make -j$(nproc)

# Run tests
 ctest -j$(nproc) --output-on-failure
```

---

## Appendix: Example Bazel Test Command

```bash
bazel test ... \
  --copt="-Wall" \
  --copt="-Werror" \
  --copt="-Wundef" \
  --cxxopt="-std=c++17" \
  --enable_bzlmod=true \
  --keep_going \
  --show_timestamps \
  --test_output=errors
```

---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Official GoogleTest README](https://github.com/google/googletest/blob/main/README.md)
- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [Pkg-config Integration](docs/pkgconfig.md)
- [GoogleMock Documentation](https://github.com/google/googletest/tree/main/googlemock)

---

## Frequently Asked Questions

For questions about installation and system compatibility, please see the FAQ section on [Installation and Setup Questions](/faq/general-usage-faq/installation-setup-questions).


