---
title: "Installation and Setup"
description: "A hands-on walkthrough of setting up GoogleTest and GoogleMock in a new or existing C++ project. Covers supported platforms, dependency management, and integration using common build systems such as CMake and Bazel."
---

# Installation and Setup

A hands-on walkthrough of setting up GoogleTest and GoogleMock in a new or existing C++ project. This guide covers supported platforms, dependency management, and integration using common build tools such as CMake and Bazel.

---

## 1. Overview

### What You Will Accomplish
This guide will help you set up GoogleTest and GoogleMock libraries correctly in your development environment, whether starting fresh or integrating into an existing C++ project. By following the instructions, you will enable writing and running tests with GoogleTest and using mocks with GoogleMock for comprehensive test coverage.

### Prerequisites
- Familiarity with C++ development.
- A supported platform (Linux, Windows, macOS).
- Build tools: CMake (recommended) or Bazel.
- A C++17-compliant compiler.
- Basic knowledge of your project's build system.

### Expected Outcome
- GoogleTest and GoogleMock successfully built or integrated.
- Your project configured to include and link against GoogleTest and GoogleMock.
- Ready to write and execute test cases and mocks.

### Time Estimate
15-30 minutes depending on environment setup and build system familiarity.

### Difficulty Level
Beginner to Intermediate.

---

## 2. Supported Platforms and Requirements

GoogleTest and GoogleMock support the following platforms:

- Linux distributions
- Windows (including Windows Mobile with some considerations)
- macOS

Your development environment must support **C++17** as the minimum language standard.

Ensure you have these development tools installed:

- **CMake (version 3.13 or newer)** for build configuration
- Compatible C++ compiler (e.g., gcc, clang, MSVC)

Refer to the [Prerequisites & System Requirements](../setup-installation/prerequisites-requirements) guide for detailed environment checks.

---

## 3. Installation Modes

You can install GoogleTest and GoogleMock using one of three main approaches:

### A. Using CMake Standalone Project

1. Clone the repository:

   ```bash
   git clone https://github.com/google/googletest.git -b main
   cd googletest
   mkdir build
   cd build
   ```

2. Configure the build:

   - To build both GoogleTest and GoogleMock (default):

     ```bash
     cmake ..
     ```

   - To build **only** GoogleTest:

     ```bash
     cmake .. -DBUILD_GMOCK=OFF
     ```

3. Build the libraries:

   ```bash
   make    # or use 'cmake --build .' on Windows and other platforms
   ```

4. Optionally install the libraries system-wide:

   ```bash
   sudo make install
   ```

### B. Integrating into an Existing CMake Project

For most flexibility and compatibility, add GoogleTest as a subdirectory in your project:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/<commit>.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Visual Studio runtime matching
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)
target_link_libraries(my_test gtest_main gmock_main)
add_test(NAME my_test COMMAND my_test)
```

Replace `<commit>` with the specific commit hash or tag you want to track.

### C. Using Bazel

Set up the `WORKSPACE` file with the googletest repository and configure targets as per Bazel documentation. This method is suitable if your project already uses Bazel.

Refer to the [Installation Modes](../setup-installation/installation-modes) guide for detailed Bazel instructions.

---

## 4. Setting Up Your Project

### 4.1 Configure Include Paths

Ensure your project can find the headers for GoogleTest and GoogleMock in your build system. Typically:

- Include directories:
  - `googletest/include`
  - `googlemock/include`

Example in CMake if you added GoogleTest as a subdirectory:

```cmake
target_include_directories(my_test PRIVATE ${gtest_SOURCE_DIR}/include ${gmock_SOURCE_DIR}/include)
```

### 4.2 Link with Libraries

Link your test executables against:

- `gtest` and `gtest_main` for GoogleTest
- `gmock` and `gmock_main` for GoogleMock

If you want the built-in `main()` function, link against `gtest_main` or `gmock_main`. Otherwise, you must provide your own `main`.

Example:

```cmake
target_link_libraries(my_test gmock_main)
```

This automatically links necessary dependencies including threads library.

### 4.3 Initialize the Framework in Your Code

Include the headers:

```c++
#include "gtest/gtest.h"
#include "gmock/gmock.h"  // If you use mocks
```

If you did **not** link with `gmock_main` or `gtest_main`, you must write your own `main()`:

```c++
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes GoogleMock and GoogleTest
  return RUN_ALL_TESTS();
}
```

If you only use GoogleTest:

```c++
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## 5. Verifying Your Setup

After installation and setup, verify your environment:

1. Write a minimal test:

```c++
#include "gtest/gtest.h"

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1, 1);
}
```

2. Build your test executable.
3. Run the executable. You should see output similar to:

```
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SampleTest
[ RUN      ] SampleTest.BasicAssertions
[       OK ] SampleTest.BasicAssertions (0 ms)
[----------] 1 test from SampleTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

Refer to the [Quick Validation Checklist](../first-steps-usage/validate-installation) for a detailed checklist and common troubleshooting guidance.

---

## 6. Common Pitfalls and Troubleshooting

### Missing Headers or Libraries
- Confirm include directories are correctly set.
- Confirm libraries are built and linked.
- Check for typos in include paths and library names.

### Mismatched Runtime Libraries (Windows)
- On Visual Studio, mismatches between dynamic and static runtime linking cause link errors.
- Use `-Dgtest_force_shared_crt=ON` when configuring with CMake to align runtimes.

### Compiler Version or Standard Issues
- Verify your compiler supports C++17.
- Set `CMAKE_CXX_STANDARD` to 17 explicitly if needed.

### Threading Support
- Enable pthread support on Unix-like systems if you get linking errors related to threads.

### Missing `main()` Function
- Link with `gtest_main` or `gmock_main` to get the default `main()`.
- Provide your own `main()` if needed and call the correct `InitGoogleTest()` or `InitGoogleMock()`.

### Build System Integration
- If embedding GoogleTest source code in your project, ensure consistent compiler flags.
- For CMake, using `add_subdirectory()` is recommended to avoid mismatch issues.

Refer to the [Basic Configuration & Setup](../setup-installation/configuration-basics) for troubleshooting tips.

---

## 7. Best Practices

- Prefer linking with `gtest_main` or `gmock_main` for simplicity and consistency.
- Use submodules or FetchContent in CMake to keep GoogleTest version controlled within your project.
- Maintain consistency in compiler flags between your tests and your project code.
- Verify your environment supports threads to leverage GoogleTest’s thread safety.

---

## 8. Additional Resources

- [GoogleTest Primer](../../primer.md) — To learn how to write simple tests.
- [Installation Modes Detailed](../setup-installation/installation-modes) — Covers CMake, Bazel, and manual integration.
- [Configuration Basics](../setup-installation/configuration-basics) — Guidance on compiler flags, linking, and initialization.
- [GoogleMock README](../../googlemock/README.md) — Learn more about mocks and usage.

---

## 9. Summary Diagram

```mermaid
flowchart TD
  A[Start: New or Existing C++ Project] --> B[Check Platform & Compiler Support]
  B --> C{Choose Build System}
  C -->|CMake| D[Clone googletest repo]
  C -->|Bazel| E[Configure Bazel Workspace]
  C -->|Manual Integration| F[Download & Add Source Files]

  D --> G[Create Build Directory & Run cmake]
  G --> H[Build Libraries]
  H --> I[Link Libraries & Setup Include Paths]

  E --> I
  F --> I

  I --> J[Write or Link main()]
  J --> K[Write minimal test case]
  K --> L[Build and Run Tests]
  L --> M{Tests Passed?}

  M -->|Yes| N[GoogleTest & GoogleMock Setup Complete]
  M -->|No| O[Troubleshoot setup issues]
  O --> M

```

---

This step-by-step flow ensures that users start with verifying their environment, choose appropriate build system integration, configure their projects, and validate their installation with functional tests.
