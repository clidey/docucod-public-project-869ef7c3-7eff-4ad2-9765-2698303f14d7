---
title: "Installation and Setup"
description: "Learn how to install GoogleTest/GoogleMock and configure your project using CMake or other build systems. This page walks you through cloning the repository, linking the libraries, and ensuring your environment is ready for testing."
---

# Installation and Setup

Welcome to the Installation and Setup guide for GoogleTest and GoogleMock. This page helps you quickly install, build, and configure GoogleTest and GoogleMock in your C++ project, focusing on the most common workflows using CMake and other build tools. Whether you want to build GoogleTest standalone or incorporate it into an existing project, this guide walks you through the essential steps to have your environment ready for writing, building, and running tests effectively.

---

## Workflow Overview

### What You Will Achieve
- Clone the GoogleTest repository including GoogleMock.
- Build and install GoogleTest and GoogleMock using CMake or your existing build system.
- Configure your project to link against GoogleTest/GoogleMock libraries.
- Understand key build options and environment prerequisites.

### Prerequisites
- Git installed to clone the repository.
- CMake (version 3.14 or later recommended).
- A compatible C++17 environment supported by your compiler.
- Build tools such as `make` on Unix-like systems or Visual Studio on Windows.

### Expected Outcome
By following this guide, you will have GoogleTest and GoogleMock built and installed, with your project correctly configured to link against them for test compilation and execution.

### Time Estimate
Approximately 10-20 minutes, depending on your platform and familiarity with CMake.

### Difficulty Level
Beginner to Intermediate.

---

## Step-by-Step Installation and Setup

### 1. Clone the GoogleTest Repository

Begin by cloning the official GoogleTest repository, which includes GoogleMock by default.

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
googletest/  # Directory will contain sources for GoogleTest and GoogleMock
```

Navigate into the clone:

```bash
cd googletest
```

### 2. Build GoogleTest Using CMake

You have two choices: build as a standalone project or integrate with your existing CMake project.

---

#### Standalone Build

1. Create a build directory and generate build files:

```bash
mkdir build
cd build
cmake ..
```

_This step downloads and configures GoogleTest and GoogleMock together by default._

If you want to build only GoogleTest, disable GoogleMock explicitly:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

2. Build the libraries:

- On Linux/macOS:

```bash
make
```

- On Windows with Visual Studio:

Open the generated `gtest.sln` solution and build in your preferred configuration.

3. (Optional) Install GoogleTest to the system (requires admin privileges):

```bash
sudo make install
```

This installs headers and libraries to default locations, typically `/usr/local/`.

---

#### Incorporate GoogleTest into an Existing CMake Project

You have multiple options to integrate GoogleTest sources with your project build.

##### Method 1: Find the Installed Package

If GoogleTest is installed system-wide or in a known location, add the following to your `CMakeLists.txt`:

```cmake
find_package(GTest CONFIG REQUIRED)
# Link libraries into your target
target_link_libraries(your_test_target PRIVATE GTest::gtest GTest::gmock)
```

##### Method 2: Add GoogleTest as a Subdirectory

Keep GoogleTest's source alongside your project and add in your `CMakeLists.txt`:

```cmake
add_subdirectory(path/to/googletest)
# Then use the gtest and gmock targets
target_link_libraries(your_test_target PRIVATE gtest gmock)
```

##### Method 3: Use CMake's FetchContent to Download at Configure Time

This is the most flexible way and integrates with your build seamlessly:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

_Requires CMake 3.14 or later._

### 3. Set C++ Standard and Build Flags

GoogleTest requires C++17 or later. Specify this explicitly in your top-level `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### 4. Handling Visual Studio Runtime (Windows Only)

By default, Visual Studio linkers use dynamic runtimes, but GoogleTest uses static runtimes, which can cause linkage errors like `LNK2038`.

To match your project’s runtime with GoogleTest, enable the option:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This forces GoogleTest to link against the dynamic runtime library, resolving conflicts.

### 5. Build Your Tests

Write your test code, linking it to `gtest_main` or `gmock_main` to get a ready-made `main()` function.

Example for building and running tests:

```bash
mkdir -p build
cd build
cmake ..
cmake --build .
ctest  # or ./your_test_binary directly
```

---

## Tips, Best Practices, and Common Pitfalls

- **Build Directory**: Always use an out-of-source build (separate build directory) to keep the source tree clean.
- **Keep GoogleTest Updated**: Use specific versions/tags when cloning or via FetchContent to ensure build stability.
- **Runtime Library Consistency on Windows**: Mismatched runtimes cause build/link errors; synchronize runtimes with `gtest_force_shared_crt`.
- **C++17 Requirement**: Non-compliant environments will fail at compile-time; ensure your compiler and build use C++17.
- **Multi-threaded Tests**: GoogleTest supports thread safety when pthread is available.
If automatic detection fails, enable/disable it manually with `-DGTEST_HAS_PTHREAD=1` or `0`.
- **Shared Library Usage**: GoogleTest can be built as a shared library with flags `-DGTEST_CREATE_SHARED_LIBRARY=1` and should be linked with `-DGTEST_LINKED_AS_SHARED_LIBRARY=1` in your tests.

---

## Summary of Key Commands

```bash
# Clone GoogleTest
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest

# Prepare build directory
mkdir build
cd build

# Generate build scripts with GoogleMock enabled
cmake ..

# Build
make

# Install (optional, requires admin)
sudo make install
```

For building only GoogleTest without GoogleMock:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

---

## Troubleshooting Common Issues

<AccordionGroup title="Common Build and Setup Issues">
<Accordion title="CMake Not Found or Version Too Low">
Ensure CMake is installed and updated to version 3.14 or later to support `FetchContent_MakeAvailable`. Update via https://cmake.org/ if needed.
</Accordion>
<Accordion title="Compiler Does Not Support C++17">
Verify your compiler version and build settings include `-std=c++17` or equivalent. Set `CMAKE_CXX_STANDARD` as shown earlier.
</Accordion>
<Accordion title="Visual Studio Runtime Mismatch Errors">
Add `set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)` before fetching or adding GoogleTest to align runtimes.
</Accordion>
<Accordion title="Build Failures Related to Threads">
If your environment does not detect pthread support, add `-DGTEST_HAS_PTHREAD=1` or `0` manually to compiler flags.
</Accordion>
<Accordion title="Link Errors on GoogleMock Symbols">
Check if GoogleMock was built with GoogleTest and linked properly. Use `gmock_main` or `gmock` targets in your link libraries.
</Accordion>
</AccordionGroup>

---

## Next Steps & Related Reading

- [Writing and Running Your First Test](../first-test-and-validation/writing-and-running-your-first-test) — Learn how to create and execute your initial tests.
- [GoogleTest Primer](../first-test-and-validation/quickstart-primer) — Understand key testing concepts and API basics.
- [Mocking with GoogleMock](../guides/core-testing-workflows/mocking-with-googlemock) — Explore how to write mocks and expectations.
- [Platform-Specific Setup](../getting-started/installation-and-configuration/platform-specific-setup) — Follow detailed instructions tailored to Windows, Linux, or macOS.
- [Troubleshooting Common Issues](../getting-started/first-test-and-validation/troubleshooting) — Straightforward advice for common installation and runtime problems.

---

## Additional Resources

- Official GoogleTest GitHub repository: [https://github.com/google/googletest](https://github.com/google/googletest)
- CMake official site: [https://cmake.org/](https://cmake.org/)
- GoogleMock documentation and cookbooks: [gmock_for_dummies.html](https://google.github.io/googletest/gmock_for_dummies.html)


---

With this guide, installing and setting up GoogleTest and GoogleMock should be straightforward, letting you focus on writing robust and maintainable tests for your projects.
