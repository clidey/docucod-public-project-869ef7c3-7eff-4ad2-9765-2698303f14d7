---
title: "Installing and Setting Up GoogleTest & GoogleMock"
description: "Learn how to install and configure GoogleTest and GoogleMock in your C++ development environment. This guide covers acquisition, integration with common build systems like CMake and Bazel, and basic verification of your setup."
---

# Installing and Setting Up GoogleTest & GoogleMock

Welcome to the essential guide for installing and configuring GoogleTest and GoogleMock in your C++ development environment. This guide walks you through acquiring the libraries, integrating them with popular build systems like CMake and Bazel, and verifying that your setup is ready for writing robust unit and mock tests.

---

## 1. What You Will Achieve

- Install GoogleTest and GoogleMock libraries correctly in your local environment.
- Integrate GoogleTest and GoogleMock into your C++ projects using CMake or Bazel.
- Verify the installation with a simple test execution.

This guide assumes you want a solid baseline installation and setup for immediate testing productivity.

---

## 2. Prerequisites

Before beginning, ensure you have:

- A C++17 capable compiler installed.
- CMake version 3.14 or higher for CMake-based builds.
- Git (optional, for cloning the repository).
- Access to internet to clone repositories or download releases.
- Your preferred build system setup if using Bazel or alternative.


---

## 3. Installing GoogleTest and GoogleMock

GoogleMock is bundled as part of GoogleTest's repository since version 1.7.0. When you acquire the GoogleTest source, GoogleMock is included by default.

### 3.1 Acquire the Source

Clone the release branch or download a stable zip archive from GitHub:

```bash
# Clone the repository
$ git clone https://github.com/google/googletest.git -b v1.17.0
$ cd googletest
```

### 3.2 Build Using CMake

GoogleTest and GoogleMock support standalone as well as integrated builds with your existing projects.

#### 3.2.1 Standalone Build

1. Create a build directory and enter it:

   ```bash
   $ mkdir build
   $ cd build
   ```

2. Generate build files with GoogleMock included (default):

   ```bash
   $ cmake ..
   ```

   To build only GoogleTest (excluding GoogleMock), run:

   ```bash
   $ cmake .. -DBUILD_GMOCK=OFF
   ```

3. Build the libraries:

   ```bash
   $ make
   ```

4. Optionally, install GoogleTest and GoogleMock onto your system (requires admin rights):

   ```bash
   $ sudo make install
   ```

##### Notes:
- On Windows, CMake generates Visual Studio projects; build using Visual Studio IDE.
- On macOS, a Xcode project will be generated similarly.
- GoogleTest requires C++17 â€” ensure your compiler and project enforce this.

#### 3.2.2 Integrate into Existing CMake Project

For seamless integration into your own project, consider one of these approaches:

- **Find installed GoogleTest:** Use `find_package(GTest CONFIG REQUIRED)` in your `CMakeLists.txt`.
- **Add GoogleTest as Subdirectory:** Download or add GoogleTest as a git submodule and include with:

  ```cmake
  add_subdirectory(path/to/googletest)
  target_link_libraries(your_target GTest::gtest GTest::gtest_main)
  ```

- **FetchContent for automatic download:**

  ```cmake
  include(FetchContent)
  FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/refs/tags/v1.17.0.zip
  )
  FetchContent_MakeAvailable(googletest)

  add_executable(your_test your_test.cpp)
  target_link_libraries(your_test gtest_main gmock_main)
  add_test(NAME your_test COMMAND your_test)
  ```

This approach ensures consistent compiler flags and simplifies dependency management.

---

## 4. Setting Up GoogleMock

Since GoogleMock depends on GoogleTest, it is included automatically if you build GoogleTest with GoogleMock enabled (the default).

To use GoogleMock, include its headers in your test files:

```cpp
#include "gmock/gmock.h"
```

### 4.1 Linking with GoogleMock

Link your tests against `gmock` or `gmock_main`:

- `gmock` provides the mocking features without a main function.
- `gmock_main` includes a `main()` to drive your test executable.

Example linking with CMake:

```cmake
target_link_libraries(your_test gmock_main)
```

### 4.2 Init Function

GoogleMock requires initialization via `InitGoogleMock()`:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

If using `gmock_main`, this is provided for you.

---

## 5. Using Bazel or Other Build Systems

GoogleTest and GoogleMock can be integrated with alternative build systems like Bazel.

### 5.1 Bazel Setup

Declare `@com_google_googletest` dependency in your `WORKSPACE`:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.17.0.zip"],
    strip_prefix = "googletest-release-1.17.0",
)
```

Then in your `BUILD` files, depend on `@com_google_googletest//:gtest_main` or `@com_google_googletest//:gmock_main`.

Refer to Bazel official documentation for detailed integration.

---

## 6. Verifying Your Installation

To ensure GoogleTest and GoogleMock are installed and working correctly:

### 6.1 Build and Run Sample Tests

Create a sample test file, for example `sample_test.cpp`:

```cpp
#include "gtest/gtest.h"

TEST(SampleTest, SimpleAssert) {
  EXPECT_EQ(1 + 1, 2);
}

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build this using your build system linking to `gtest_main`:

```bash
# Example CMake command
cmake ..
make
./sample_test
```

You should see output indicating the tests ran successfully.

### 6.2 Running GoogleMock Tests

Use similar steps for GoogleMock, adding mock definitions and linking to `gmock_main`. Verify the test runs without errors.

---

## 7. Troubleshooting Tips

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="Runtime Library Mismatch on Windows">
If you encounter linker errors related to runtime libraries such as `MTd_StaticDebug` vs `MDd_DynamicDebug`, enable the option `gtest_force_shared_crt` by passing:

```cmake
-Dgtest_force_shared_crt=ON
```

This aligns GoogleTest with the shared runtime used by your project.
</Accordion>
<Accordion title="Missing pthread on Unix">
Ensure pthread support is available and linked by your compiler; for custom build scripts, add `-pthread` flags.

GoogleTest detects pthread automatically when using CMake.
</Accordion>
<Accordion title="C++17 Support Errors">
GoogleTest requires C++17. Set your project's C++ standard explicitly:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

</Accordion>
<Accordion title="GoogleMock Macro Conflicts">
If GoogleMock macros conflict with other libraries, disable macro definition with compiler flags like:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

and use fully qualified macros such as `GTEST_TEST` instead of `TEST`.
</Accordion>
</AccordionGroup>

---

## 8. Best Practices and Recommendations

- Build GoogleTest and your project with consistent compiler and linker settings.
- Prefer integrating GoogleTest as a subdirectory or using FetchContent in CMake for simplified dependency management.
- Keep GoogleMock updated regularly to leverage improvements and fixes.
- Use `gmock_main` library for simplified test executable setup when you want the default main function.
- Enable verbose flag `--gmock_verbose=info` at runtime to diagnose mocking issues.

---

## 9. Next Steps

After you have successfully installed and verified GoogleTest and GoogleMock:

- Explore the [Writing Your First Test](https://yourdocs.com/guides/getting-started/writing-your-first-test) guide to create meaningful tests.
- Learn [Mocking Basics with GoogleMock](https://yourdocs.com/guides/getting-started/mocking-basics) for advanced test design.
- Consult the troubleshooting guides if you encounter issues:
  - [Troubleshooting Setup Issues](https://yourdocs.com/getting-started/troubleshooting-faq/troubleshooting-setup-issues)
  - [Common Errors and How to Fix Them](https://yourdocs.com/getting-started/troubleshooting-faq/common-errors-and-solutions)

---

## Appendix: Example CMakeLists.txt For GoogleMock

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTestProject)

# Enable FetchContent module
include(FetchContent)

# Declare and fetch GoogleTest (includes GoogleMock)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/v1.17.0.zip
)

FetchContent_MakeAvailable(googletest)

# Declare your test executable
add_executable(my_tests test/sample_test.cpp)

# Link with GoogleMock main library
target_link_libraries(my_tests gmock_main)

# C++17 standard enforcement
set_target_properties(my_tests PROPERTIES
  CXX_STANDARD 17
  CXX_STANDARD_REQUIRED YES
)

# Add the test to CMake testing targets
enable_testing()
add_test(NAME MyTest COMMAND my_tests)
```

This example will automatically download GoogleTest and GoogleMock on configure, build your tests, and integrate them with CTest.

---

Your development environment is now prepared to harness the full power of GoogleTest and GoogleMock for effective unit and mock testing in C++.


---

### References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleMock Official Documentation](https://google.github.io/googletest/gmock_for_dummies.html)
- [CMake Official Site](https://cmake.org/)
- [Bazel Official Documentation](https://docs.bazel.build/)

---

*This document is part of the GoogleTest and GoogleMock comprehensive documentation suite. For foundational concepts, installation variations, and advanced usage, please refer to the respective linked guides.*