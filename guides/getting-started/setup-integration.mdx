---
title: "Setting Up and Integrating GoogleTest"
description: "Learn how to install GoogleTest and GoogleMock, integrate them into your C++ project (using CMake or Bazel), and run your first suite of automated tests. This guide ensures your environment is ready for robust testing from day one."
---

# Setting Up and Integrating GoogleTest

Ensure your C++ project is fully equipped with the power of GoogleTest and GoogleMock through a clear, step-by-step integration process. This guide walks you through installing the frameworks, integrating them into popular build systems like CMake and Bazel, and running your first automated test suite to verify your environment is ready.

---

## 1. Workflow Overview

### What You'll Accomplish
- Install GoogleTest and GoogleMock libraries on your development system.
- Integrate GoogleTest and GoogleMock into your C++ projects using common build tools.
- Configure your environment to build and run automated tests.
- Execute your first test suite to validate correct setup.

### Prerequisites
- A C++17-compliant compiler installed.
- Basic familiarity with C++ development workflows and build systems.
- Installed build tools – at least one of:
  - CMake (version 3.13 or newer recommended)
  - Bazel (if applicable to your project)
- Network access to clone or download GoogleTest source (or access to your workspace with it).

### Expected Outcome
- GoogleTest and GoogleMock libraries are installed and built successfully.
- Your C++ project is configured to compile and link with these libraries.
- You can run automated tests and see the test results output.

### Time Estimate
20–40 minutes depending on experience and environment setup.

### Difficulty Level
Beginner to Intermediate — appropriate even for users new to GoogleTest integration.

---

## 2. Step-by-Step Instructions

### Step 1: Download and Prepare GoogleTest and GoogleMock

GoogleMock is included as part of the GoogleTest repository.

**Action:**
1. Clone or download the GoogleTest repository:

```bash
git clone https://github.com/google/googletest.git -b main
cd googletest
```

2. (Optional) Alternatively, download a release archive from the official [GitHub releases page](https://github.com/google/googletest/releases).

**Result:**
You now have the GoogleTest source code, including GoogleMock, ready for building and integration.

---

### Step 2: Build GoogleTest and GoogleMock with CMake (Standalone)

This is the recommended and most straightforward method.

**Action:**
1. Create and enter a build directory:

```bash
mkdir build && cd build
```

2. Generate build scripts with CMake (default: build both GoogleTest and GoogleMock):

```bash
cmake ..
```

To build only GoogleTest (without GoogleMock), use:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

3. Build the libraries using your system’s build tool (make, ninja, MSBuild):

```bash
make
# or on Windows
# cmake --build . --config Release
```

4. (Optional) Install libraries system-wide:

```bash
sudo make install
```

---

### Step 3: Integrate GoogleTest/GoogleMock into Your CMake Project

There are two primary approaches:

#### Option 3.1: Link to Installed Libraries

If you installed GoogleTest, you can find and link using `find_package`:

```cmake
find_package(GTest CONFIG REQUIRED)

add_executable(my_tests test_main.cpp test_foo.cpp)
target_link_libraries(my_tests GTest::gtest_main GTest::gmock)

add_test(NAME MyTests COMMAND my_tests)
```

- Use `GTest::gtest_main` to link the main() function automatically.
- Replace `my_tests` and source files appropriately.

#### Option 3.2: Build GoogleTest as a Subdirectory

Add GoogleTest directly to your project source tree or refer to it:

```cmake
add_subdirectory(path/to/googletest)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests gtest_main gmock)
```

- Ensures matched compiler flags and ABI compatibility.
- Useful for continuous integration and reproducible builds.

---

### Step 4: Using GoogleTest and GoogleMock in Bazel

If your build system is Bazel:

- Add GoogleTest as a dependency by referencing its workspace in your `WORKSPACE` file.
- Use existing Bazel rules for GoogleTest and GoogleMock.
- Create `cc_test` targets that link against `@com_google_googletest//:gmock_main`.

Consult the [GoogleTest Bazel Integration Guide](https://github.com/google/googletest/blob/main/googletest/README.md) for detailed usage.

---

### Step 5: Writing and Running Your First Test

Using the installed or integrated libraries, write simple C++ tests using GoogleTest macros: 

```c++
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile your test executable linking to GoogleTest and GoogleMock.

**Run the tests:**
```bash
./my_tests
```
You should see GoogleTest's test runner output indicating status of your tests.

---

## 3. Practical Tips and Best Practices

- Prefer linking with `gtest_main` or `gmock_main` to avoid writing your own `main()` unless customization is needed.
- Use `add_subdirectory` integration to avoid issues with ABI mismatches on Windows and other platforms.
- Always set your C++ standard to at least `C++17` in your CMake project (`set(CMAKE_CXX_STANDARD 17)`).
- Enable verbose mode for debugging test discovery with the flag `--gtest_verbose=info`.
- When building on Windows, consider configuring `gtest_force_shared_crt` if you encounter runtime linkage conflicts.

---

## 4. Troubleshooting Common Issues

<AccordionGroup title="Common Integration Issues">
<Accordion title="Test Binary Fails to Link due to Missing main()">

This usually happens if you link only `gtest`/`gmock` instead of `gtest_main` or `gmock_main`.

**Solution:** Link with `gtest_main` or `gmock_main` instead to get the default `main()` implementation.

</Accordion>
<Accordion title="Build Fails Because of C++ Standard Version">

GoogleTest requires C++17 or later.

**Solution:** Set `CMAKE_CXX_STANDARD` to at least 17 in your `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

</Accordion>
<Accordion title="Linker Errors on Windows (Runtime Mismatch)">

Errors like `mismatch detected for 'RuntimeLibrary'` happen when GoogleTest and your code use different runtime linkage.

**Solution:** Use the `gtest_force_shared_crt` option with CMake:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

Or adjust your project settings to unify runtime linkage.

</Accordion>
</AccordionGroup>

---

## 5. Next Steps & Related Content

- Explore [Writing Your First Unit Test](/guides/getting-started/writing-first-test) to understand test creation in detail.
- Learn [Running Tests Manually and in CI](/getting-started/first-run-validation/running-tests) to automate your test workflows.
- Dive into [Advanced Mocking Techniques](/guides/mocking-and-advanced-techniques/creating-and-using-mocks) to enhance your testing with mocks.
- Review [Installation Troubleshooting](/getting-started/first-run-validation/installation-troubleshooting) for resolution of frequent setup issues.

<Tip>
Start with simple test cases and gradually integrate mocks and more complex suite organizations to build confidence and expand your test coverage effectively.
</Tip>

---

For official updates and source, visit the [GoogleTest GitHub repository](https://github.com/google/googletest).

---

## Visual Overview of Common Integration Flow

```mermaid
flowchart TD
  A[Clone or Download GoogleTest Repo] --> B{Choose Build Method}
  B -->|Standalone Build| C[CMake Configure & Build]
  B -->|Integrate into Project| D[Add_subdirectory or Find_package]
  C --> E[Build GoogleTest & GoogleMock]
  D --> F[Link gtest_main / gmock_main]
  E --> G[Compile Your Tests]
  F --> G
  G --> H[Run Tests with RUN_ALL_TESTS()]
  H --> I{Tests Pass?}
  I -->|Yes| J[Start Writing More Tests]
  I -->|No| K[Troubleshoot & Fix Build or Link Issues]
```
