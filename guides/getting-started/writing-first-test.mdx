---
title: "Writing and Running Your First Test"
description: "A hands-on guide covering the basics of creating, compiling, and running a test case. Explains the anatomy of a test, linking to the test runner, and interpreting test output."
---

# Writing and Running Your First Test

This hands-on guide walks you through the essentials of creating, compiling, and running your first test case with GoogleTest. You will learn the anatomy of a test, how to link it to the test runner, and how to interpret the output from test executions.

---

## 1. Understanding the Test Workflow

### What You Will Achieve
- Write a simple test using the `TEST` macro.
- Compile the test code to create a test executable.
- Run the executable and interpret the test results.

### Prerequisites
- A working GoogleTest installation integrated into your build environment.
- Basic knowledge of C++ programming.
- Access to a command line interface to build and run tests.

### Estimated Time
Approximately 15–30 minutes.

### Difficulty Level
Beginner

---

## 2. Anatomy of a Basic Test

GoogleTest uses macros to declare tests succinctly. The simplest form is `TEST(test_suite_name, test_name)`, which defines an individual test.

```cpp
#include <gtest/gtest.h>

// Defines a test in the test suite "FactorialTest".
TEST(FactorialTest, HandlesZeroInput) {
    EXPECT_EQ(Factorial(0), 1);  // Checks that Factorial(0) returns 1.
}
```

- **Test Suite Name** groups related tests logically.
- **Test Name** uniquely identifies the test within the suite.
- Inside the test body, use assertions (such as `EXPECT_EQ`) to verify conditions.

> Both names must be valid C++ identifiers and should avoid underscores `_` for consistency.

### Writing Multiple Tests
You can define multiple tests under the same suite to cover different scenarios.

```cpp
TEST(FactorialTest, HandlesPositiveInput) {
    EXPECT_EQ(Factorial(1), 1);
    EXPECT_EQ(Factorial(2), 2);
    EXPECT_EQ(Factorial(3), 6);
}
```

---

## 3. Using Test Fixtures for Shared Setups

For tests that share a common setup or data, use test fixtures. A test fixture is a class derived from `testing::Test`.

### Creating a Fixture

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Initialize queues
    q0_.Enqueue(1);
    q1_.Enqueue(2);
    q1_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
};
```

### Writing Tests with Fixtures
Use `TEST_F` instead of `TEST`, passing the fixture class name. The fixture instance is freshly created for each test.

```cpp
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 1);  // From fixture data
}

TEST_F(QueueTest, DequeueWorks) {
  int* value = q0_.Dequeue();
  ASSERT_NE(value, nullptr);  
  EXPECT_EQ(*value, 1);
  delete value;
}
```

---

## 4. Preparing and Building Your Test

### Including GoogleTest Headers
Ensure your test code includes the main GoogleTest header:

```cpp
#include <gtest/gtest.h>
```

### Writing the `main()` Function (Optional)
If you do not link with `gtest_main` (provides a default main), you need to write your own:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- `InitGoogleTest` initializes the testing environment and processes command-line flags.
- `RUN_ALL_TESTS` runs all tests in the executable.

<Note>
Linking to `gtest_main` is recommended to avoid having to write `main()`.
</Note>

### Building Your Tests
Compile and link your test source files with GoogleTest libraries.

If you use CMake, typically your `CMakeLists.txt` includes:

```cmake
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})

add_executable(MyTest test_file.cc)
target_link_libraries(MyTest ${GTEST_LIBRARIES} pthread)
```

In manual setups, ensure `gtest` and `gtest_main` libraries are linked.

---

## 5. Running Tests and Reading Output

Run the generated test executable from the command line:

```bash
./MyTest
```

### Understanding the Output
GoogleTest outputs a detailed report of tests:

- `[ RUN      ]` indicates a test is starting.
- `[       OK ]` indicates the test passed.
- `[  FAILED  ]` indicates the test failed and shows the failure message and location.

Example output:

```text
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
/path/to/test_file.cc:16: Failure
Expected equality of these values:
  Factorial(3)
    Which is: 5
  6
[  FAILED  ] FactorialTest.HandlesPositiveInput (0 ms)

[----------] 2 tests from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] FactorialTest.HandlesPositiveInput

 1 FAILED TEST
```

### Interpreting Failures
- Look for the failing test name.
- Check the file name and line number.
- Read the assertion failure message for clues.

---

## 6. Practical Example: Writing Your First Test

Here's a complete example illustrating the steps:

```cpp
#include <gtest/gtest.h>

// Simple function to test
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Test suite: FactorialTest
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(5), 120);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run your test executable. You should see the test results as described.

---

## 7. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Tips">
<Accordion title="Test Not Running or Not Discovered">
Make sure your test files and symbols follow the naming and signature conventions. Your test must:
- Use the `TEST` or `TEST_F` macros.
- Have valid C++ identifiers for suite and test names.
- Be linked properly into the executable.

Compile-time or linking errors often cause no tests to run.
</Accordion>
<Accordion title="Linker Errors Related to `main()`">
If you receive multiple definitions of `main` or missing `main`, verify:
- You are linking either with `gtest_main` to get a default main,
  or provide your own main as per section 4.
- Do not link twice with multiple mains.
</Accordion>
<Accordion title="Test Fails to Run or Segfaults">
Check your test code for:
- Proper usage of GoogleTest assertions.
- No undefined behavior in tested code.
- Correct initialization in fixtures if used.

Use debugging tools to trace crashes.
</Accordion>
<Accordion title="Assertions Not Triggering Failures">
Confirm that your assertions expressions are valid and failures are not caught unexpectedly.
- Use `EXPECT_` for nonfatal failures,
- Use `ASSERT_` for fatal failures when subsequent operations depend on the assertion.
</Accordion>
</AccordionGroup>

---

## 8. Next Steps

- Explore [Essential Assertions and Failure Handling](/guides/getting-started/essential-assertions) to deepen your understanding of assertions.
- Learn to write [Test Fixtures, Parameterized, and Typed Tests](/guides/advanced-testing-patterns/test-fixtures-parameterization) for more complex testing scenarios.
- Integrate GoogleTest with your build and CI pipelines using [Integrating into Real-World Projects](/guides/integration-best-practices/integrating-into-projects).

---

## Additional References

- [GoogleTest Primer](../../docs/primer.md) — Broader introduction to GoogleTest concepts.
- [Writing and Organizing Tests (API Reference)](/api-reference/core-testing-apis/writing-tests) — Detailed API documentation.
- [Assertions and Matchers Reference](/api-reference/core-testing-apis/assertions) — Comprehensive assertion macros.
- [Installing GoogleTest](../../getting_started/installation_integration/install_cmake) — Setup guides.

---

This guide empowers you to create your first reliable GoogleTest unit tests that integrate smoothly into your development workflow, unlocking robust, repeatable, and maintainable automated testing for your C++ codebase.
