---
title: "Writing Your First Test"
description: "Step through the process of defining and running your initial unit tests with GoogleTest. This guide quickly brings users from codebase import to a passing (or failing) test, illustrating the test lifecycle and basic syntax."
---

# Writing Your First Test

## Workflow Overview

This guide walks you through the process of writing and executing your initial unit test using GoogleTest, including integration with GoogleMock for mocking if needed. By following these steps, you will gain familiarity with test structure, test macros, writing basic assertions, and running your tests.

### Prerequisites

- GoogleTest and GoogleMock installed and configured correctly in your build environment.
- Basic understanding of C++ syntax.
- A project with source files where you want to add tests.

### Expected Outcome

You will create a simple test case that compiles and runs, demonstrating how to verify code behavior with assertions. You will see test results on the console indicating success or failure.

### Time Estimate

Approximately 10-15 minutes to write, compile, and run a basic test.

### Difficulty Level

Beginner

---

## Step-by-Step Instructions

<Steps>
<Step title="Include GoogleTest Headers">
Add the following includes at the top of your test source file. These bring in GoogleTest and GoogleMock features you'll need:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>  // Only if you intend to create mocks
```

<Check>
Including `<gtest/gtest.h>` is sufficient if you only want to write simple tests. Include `<gmock/gmock.h>` when you also want to use mocking.
</Check>
</Step>

<Step title="Write a Test Fixture or Test Case">
Create a test case using the `TEST` macro with the following structure:

```cpp
TEST(TestCaseName, TestName) {
  // Your test code here
}
```

Example:

```cpp
TEST(PainterTest, CanDrawCircle) {
  // Setup and exercise the code you want to test
  // Perform assertions
  EXPECT_TRUE(true);  // Dummy assertion
}
```

<Info>
A TestCase groups related tests. Each TestName should be descriptive and unique within the TestCase.
</Info>
</Step>

<Step title="Write Assertions">
Inside your test, write assertions to check conditions. Common macros include:

- `EXPECT_EQ(val1, val2)` checks equality but continues on failure.
- `ASSERT_TRUE(condition)` checks a boolean condition but aborts the test on failure.
- `EXPECT_NE(val1, val2)` checks inequality.

Example:

```cpp
int result = Add(2, 3);
EXPECT_EQ(result, 5);
```

<Note>
Use `ASSERT_` macros if further test steps depend on the assertion succeeding.
</Note>
</Step>

<Step title="Build and Run Your Test">
Compile your test source alongside your code and the GoogleTest/GoogleMock libraries according to your build system.

Run the resulting test executable from the command line or through your IDE.

Example terminal command:

```shell
./my_tests --gtest_filter=PainterTest.*
```

You should see output indicating tests passed or failed.

<Warning>
Make sure to initialize GoogleTest in your main if you provide a custom main function. Commonly, `RUN_ALL_TESTS()` will be used after `testing::InitGoogleTest(&argc, argv);`.
</Warning>
</Step>

<Step title="Add Mock Classes (Optional)">
If your tests depend on interactions with other components, define mock classes using `MOCK_METHOD` macros.

Example:

```cpp
class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
};
```

Then set expectations and behaviors in your tests:

```cpp
MockTurtle turtle;
EXPECT_CALL(turtle, PenDown()).Times(1);
EXPECT_CALL(turtle, Forward(100)).Times(1);
```

<Info>
Refer to the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for detailed mocking techniques and best practices.
</Info>
</Step>
</Steps>

---

## Examples & Code Samples

### Simple GoogleTest

```cpp
#include <gtest/gtest.h>

// Function to be tested.
int Add(int a, int b) {
  return a + b;
}

TEST(MathTest, AddsTwoNumbers) {
  int result = Add(2, 3);
  EXPECT_EQ(result, 5);  // Test will pass
  EXPECT_NE(result, 4);  // Test will pass
}
```

### Using GoogleMock to Mock a Turtle Interface

```cpp
#include <gmock/gmock.h>

class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
};

TEST(PainterTest, DrawsCircle) {
  MockTurtle turtle;
  EXPECT_CALL(turtle, PenDown()).Times(1);
  EXPECT_CALL(turtle, Forward(100)).Times(1);

  // Code under test would use turtle
  turtle.PenDown();
  turtle.Forward(100);
}
```

---

## Troubleshooting & Tips

### Common Issues

- **Test not running:** Check your build links properly to GoogleTest and GoogleMock, and your test is linked to the test runner main or uses `GTEST_MAIN`.
- **Expectations not verified:** Mocks verify expectations upon destruction. If mocks are leaked or live beyond test scope, verification may not occur as expected.
- **Ambiguous overloaded methods:** When mocking overloaded methods, use full signatures in `MOCK_METHOD` and specify the constness and qualifiers explicitly.
- **Uninteresting calls warning:** Use `NiceMock<>` wrapper or set expectations with `Times(AnyNumber())` to suppress warnings.

### Best Practices

- Write one test case per logical behavior to keep tests maintainable.
- Use clear descriptive names for test cases and tests.
- Use `EXPECT_CALL` for setting expectations (behavior + call verification) and `ON_CALL` to specify default behavior without strict expectations.
- Initialize GoogleTest properly before running tests.
- Use sequences (`InSequence`) to enforce order when needed.

### Performance Considerations

Avoid overly complex mock setups; simplify by creating concise mock classes or use fakes if appropriate for faster compilation and clearer tests.

---

## Next Steps & Related Content

### Whatâ€™s Next

- Explore [Mocking Basics with GoogleMock](https://google.github.io/googletest/guides/getting-started/mocking-basics.html) to deepen your understanding of mocking.
- Learn about [Writing Effective Assertions](https://google.github.io/googletest/guides/writing-and-structuring-tests/effective-assertions.html) to improve test robustness.
- Review [Building and Running Tests](https://google.github.io/googletest/getting-started/first-test-workflow/building-and-running-tests.html) to streamline your workflow.

### Related Guides

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for advanced mocking patterns.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for detailed API.
- [GoogleTest Primer](https://google.github.io/googletest/primer.html) for comprehensive foundational knowledge.

### Resources

- [GoogleTest Official Documentation](https://google.github.io/googletest/)
- [GoogleMock GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Sample Tests](https://github.com/google/googletest/tree/main/googletest/test)

---