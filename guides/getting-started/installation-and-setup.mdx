---
title: "Installation and Setup"
description: "Discover how to install GoogleTest and GoogleMock in your C++ project using various build systems. Includes step-by-step instructions for both Bazel and CMake environments and highlights key configuration considerations."
---

# Installation and Setup

GoogleTest and GoogleMock are powerful C++ testing frameworks that help you write reliable, maintainable, and efficient tests. This guide walks you through the process of installing and integrating GoogleTest and GoogleMock into your C++ project, focusing on two primary build environments: **CMake** and **Bazel**. You will find clear, sequential steps to get up and running, along with important configuration tips to align with your development workflow.

---

## Workflow Overview

- **Task Description**: Install and set up GoogleTest and GoogleMock in your C++ project using popular build systems.
- **Prerequisites**:
  - Basic familiarity with C++ development and build concepts
  - Installed CMake (minimum version 3.14 recommended) or Bazel build system
  - A functioning C++ compiler with C++17 support
  - Access to the Internet to clone the GitHub repository if building from source
- **Expected Outcome**: You will successfully build and link GoogleTest/GoogleMock libraries, compile your test code, and run tests without configuration issues.
- **Time Estimate**: Approximately 15–30 minutes depending on environment and network speed.
- **Difficulty Level**: Beginner to Intermediate

---

## Step-by-Step Instructions

### 1. Installing GoogleTest and GoogleMock Using CMake

GoogleTest provides robust CMake support, allowing standalone builds or direct embedding into your existing projects.

#### a. Clone the Repository

```bash
# Clone the latest stable release or desired version
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
```

#### b. Create a Build Directory

```bash
mkdir build
cd build
```

#### c. Configure the Build

Run CMake to generate build files:

```bash
cmake ..
```

- To build **only GoogleTest** (skip GoogleMock), use:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

This step respects your platform's native build system and compiler.

#### d. Build the Libraries

On Unix-like systems:

```bash
make
```

On Windows with Visual Studio:

- Open the generated `.sln` file and build from the IDE.

#### e. Install GoogleTest and GoogleMock (Optional)

You may install the built libraries system-wide (may require admin rights):

```bash
sudo make install
```

This installs headers and libraries (by default into `/usr/local/`).

#### f. Using GoogleTest in Your CMake Project

**Option 1: Link against installed libraries**

```cmake
find_package(GTest CONFIG REQUIRED)
add_executable(your_test_exe test_file.cpp)
target_link_libraries(your_test_exe PRIVATE GTest::gtest_main)
enable_testing()
add_test(NAME your_test COMMAND your_test_exe)
```

**Option 2: Build GoogleTest as part of your project**

Add to your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Visual Studio CRT compatibility
FetchContent_MakeAvailable(googletest)

add_executable(your_test_exe your_test.cpp)
target_link_libraries(your_test_exe PRIVATE gtest_main)
enable_testing()
add_test(NAME your_test COMMAND your_test_exe)
```

#### g. Important CMake Configuration Notes

- C++17 or later is **required** for GoogleTest.
- On Visual Studio, if you encounter runtime library incompatibility errors, enable `gtest_force_shared_crt` to enforce consistent linkage.
- You can tweak compiler flags to enable features like pthread support or tweak warnings (consult the CMake scripts).

### 2. Installing GoogleTest and GoogleMock Using Bazel

Bazel users can integrate GoogleTest/GoogleMock as dependencies within their workspace.

#### a. Workspace Setup

Add the googletest repository in your `WORKSPACE` file:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.17.0.tar.gz"],
    strip_prefix = "googletest-release-1.17.0",
)
```

#### b. Define Dependencies in BUILD Files

In your Bazel `BUILD` file for tests, add:

```python
cc_test(
    name = "your_test",
    srcs = ["your_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

#### c. Build and Run Your Tests

```bash
bazel test //path/to:your_test
```

This automatically builds GoogleTest and GoogleMock dependencies.

### 3. Validate Your Installation

Once built and linked, create a minimal test to verify everything is configured correctly.

Example minimal test (`sample_test.cpp`):

```c++
#include <gtest/gtest.h>

TEST(SampleTest, AssertionTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile and run — you should see output indicating that the test passed.


---

## Best Practices and Tips

- Always use `gtest_main` library when linking tests to avoid writing your own `main()` unless you need custom initialization.
- Keep GoogleTest and GoogleMock versions in sync to avoid compatibility issues.
- When integrating with CMake, prefer the `FetchContent` module for reproducible builds.
- On Windows, match the CRT linkage between your project and GoogleTest using `gtest_force_shared_crt`.
- If you need to disable threads (for rare embedded use cases), disable pthreads explicitly using `-DGTEST_HAS_PTHREAD=0`.
- To avoid macro clashes with other libraries, use GoogleTest's macro renaming options (`-DGTEST_DONT_DEFINE_TEST=1`) and prefix macros.

---

## Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Common Installation Issues">
<Accordion title="CMake build fails due to missing C++17 support">
Ensure your compiler supports C++17 and specify this in your `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Older compilers or toolchains may not work.
</Accordion>
<Accordion title="Linker errors on Windows related to runtime libraries">
Enable `gtest_force_shared_crt` in your CMake configuration:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

This enforces consistent use of dynamic CRT and avoids conflicts.
</Accordion>
<Accordion title="pkg-config can't find GoogleTest">
This usually means pkg-config files are not installed or not located in searched paths.

- Check if `.pc` files exist under your library path (e.g., `/usr/local/lib/pkgconfig`).
- Set the `PKG_CONFIG_PATH` environment variable to include the directory where `.pc` files are installed:

```bash
export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
```
</Accordion>
<Accordion title="Tests not running or no tests detected">
- Confirm that test files are linked with `gtest_main` or that your `main()` calls `RUN_ALL_TESTS()`.
- Make sure the tests are compiled and included in the build.
- Don't call `RUN_ALL_TESTS()` more than once; it only should run once per test program.
</Accordion>
</AccordionGroup>

---

## Next Steps & Related Content

- **Writing and Running Your First Tests**: Learn how to author test cases with GoogleTest in [Writing and Running Your First Tests](/guides/getting-started/first-tests).
- **Basic Mocking with GoogleMock**: Extend your tests with mocks by following [Basic Mocking with GoogleMock](/guides/getting-started/basic-mocking).
- **Integration with Build Tools and CI**: Once tests are running locally, integrate with CI systems via [Integration with Build Tools and CI](/overview/integration-ecosystem/integration-with-build-and-ci).
- **Troubleshooting Common Setup Issues**: For deeper troubleshooting, refer to [Troubleshooting Common Setup Issues](/getting-started/validation-troubleshooting/common-issues).

---

## References and Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [Official GitHub Repository](https://github.com/google/googletest)
- [GoogleTest API Reference](https://google.github.io/googletest/reference/assertions.html)

---

## Summary

This guide empowers you to install and configure GoogleTest and GoogleMock in your C++ projects through CMake and Bazel, delivering actionable instructions to build, link, and validate your testing environment. By following clear workflows and addressing common pitfalls, you ensure a smooth onboarding experience to harness GoogleTest's full potential.


---