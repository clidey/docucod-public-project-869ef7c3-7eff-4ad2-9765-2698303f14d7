---
title: "Installation and Setup"
description: "Learn how to install and configure GoogleTest and GoogleMock for your project using CMake or Bazel. Follow step-by-step instructions to add dependencies, configure your build system, and verify your installation."
---

# Installation and Setup

## Workflow Overview

This guide walks you through installing and configuring **GoogleTest** and **GoogleMock** for your C++ project using two popular build systems: **CMake** and **Bazel**. It focuses on adding the necessary dependencies, properly configuring your build environment, and verifying that the installation is successful.

### Prerequisites

- A supported C++17 development environment (compiler and standard library).
- Familiarity with your project's build system (CMake or Bazel).
- Access to the [GoogleTest GitHub repository](https://github.com/google/googletest) or local source code.
- Basic command-line skills and a C++ IDE or text editor.

### Expected Outcome

By completing this workflow, you will have GoogleTest and GoogleMock integrated into your C++ project. You will be able to write, build, and run unit tests with the framework seamlessly.

### Time Estimate

Setup typically takes between **10 to 30 minutes** depending on your environment and experience with the build system.

### Difficulty Level

Beginner to Intermediate; no advanced C++ knowledge beyond basic project building is required.

---

## Detailed Step-by-Step Instructions

### 1. Install GoogleTest and GoogleMock with CMake

GoogleTest provides built-in CMake support for easy integration.

#### Step 1.1: Clone the Repository

```bash
git clone https://github.com/google/googletest.git -b main
cd googletest
```

#### Step 1.2: Create a Build Directory

This keeps build files separate from source files:

```bash
mkdir build
cd build
```

#### Step 1.3: Configure the Build

To build both GoogleTest and GoogleMock (default):

```bash
cmake ..
```

To build **only GoogleTest** without GoogleMock:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

#### Step 1.4: Build the Libraries

On Linux/macOS:

```bash
make
```

On Windows, open the generated Visual Studio solution and build from there.

#### Step 1.5: Install (Optional)

Install GoogleTest and GoogleMock system-wide (requires admin privileges):

```bash
sudo make install
```

#### Step 1.6: Integrate in Your CMake Project

##### Option 1: Use Installed Libraries

In your `CMakeLists.txt`:

```cmake
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})
add_executable(your_test test.cpp)
target_link_libraries(your_test GTest::gtest_main)
add_test(NAME your_test COMMAND your_test)
```

##### Option 2: Add GoogleTest as a Subdirectory

This avoids install and keeps consistent build flags:

```cmake
add_subdirectory(path/to/googletest)

add_executable(your_test test.cpp)
target_link_libraries(your_test gtest_main)
add_test(NAME your_test COMMAND your_test)
```

#### Step 1.7: Verify Installation

Create a simple test file:

```c++
#include <gtest/gtest.h>

TEST(SampleTest, AssertionTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run your test executable. You should see your test run and succeed.

---

### 2. Install GoogleTest and GoogleMock with Bazel

Bazel natively supports GoogleTest and GoogleMock for your C++ workspace.

#### Step 2.1: Ensure Bazel and C++ Toolchain Are Installed

Follow Bazel's official installation guide for your platform.

#### Step 2.2: Create/Modify `WORKSPACE` File

Add the GoogleTest repository:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/main.zip"],
    strip_prefix = "googletest-main",
)
```

#### Step 2.3: Load GoogleTest in BUILD Files

In your `BUILD` or `BUILD.bazel` files:

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cpp"],
    deps = ["@com_google_googletest//googletest:core", "@com_google_googletest//googlemock:gmock_main"],
)
```

#### Step 2.4: Write a Test

Same as above; your test file should include GoogleTest headers and main is supplied by linking against `gmock_main` or `gtest_main`.

#### Step 2.5: Build and Run your Tests

```bash
bazel test //:my_test
```

This will build your code and run the tests.

---

## Additional Configuration Details

- Use **`gmock_main`** or **`gtest_main`** libraries to avoid writing your own `main()` function.
- For custom main, see the [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) example main function.
- When using CMake, GoogleTest and GoogleMock are built with strict compiler warnings to ensure code quality.

---

## Verification

After building your test executable (with or without your own main):

- Run the executable.
- You should see output like:

```plaintext
Running main() from gtest_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SampleTest
[ RUN      ] SampleTest.AssertionTrue
[       OK ] SampleTest.AssertionTrue (0 ms)
[----------] 1 test from SampleTest (0 ms total)

[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

- A return code `0` means success.

<Check>
Always confirm test execution output says `PASSED` and does not produce errors.
</Check>

---

## Troubleshooting and Tips

### Common Issues

- **Missing C++17 environment:** GoogleTest requires C++17 or later. Verify your compiler supports this and CMake sets `CMAKE_CXX_STANDARD` to 17.
- **Link errors:** When linking your test, ensure you link against `gtest_main` or `gmock_main` to provide the main entry point.
- **Thread safety:** On some platforms, you may encounter threading issues if `pthreads` is not available or misconfigured.
- **Windows runtime library mismatch:** Use the CMake option `-Dgtest_force_shared_crt=ON` if you encounter runtime mismatch errors in Visual Studio.

### Best Practices

- Prefer to link with `gtest_main` or `gmock_main` to save boilerplate.
- Use CMake’s `add_subdirectory()` for easier integration and consistent builds.
- Keep your GoogleTest source code version locked via submodule or specific download SHA.
- When using Bazel, always pull the GoogleTest repository with explicit `http_archive` URLs and versions.

### Performance and Build

- For large projects, consider building GoogleTest and GoogleMock as shared libraries optionally.
- Use CMake’s build configurations to control build type (Debug, Release).

---

## Next Steps & Related Documentation

- **Writing Your First Test:** Follow the [Writing Your First Test guide](/guides/getting-started/writing-your-first-test) to start authoring tests.
- **Project Configuration and Test Discovery:** Learn how to properly set up your project with [Project Configuration and Test Discovery](/getting-started/setup-usage-validation/basic-configuration).
- **Quick Validation and Troubleshooting:** Use the [Quick Validation and Troubleshooting](/getting-started/setup-usage-validation/quick-validation) guide if you encounter common issues.
- **GoogleTest Primer:** Refer to the [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) for deeper understanding of test writing and execution.

---



