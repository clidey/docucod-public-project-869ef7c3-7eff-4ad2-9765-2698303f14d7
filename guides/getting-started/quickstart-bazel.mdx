---
title: "Quickstart with Bazel"
description: "Discover how to integrate GoogleTest and GoogleMock using Bazel. This guide covers WORKSPACE and BUILD files, project structure, and running your first tests using the Bazel build tool."
---

# Quickstart with Bazel

This tutorial guides you through integrating GoogleTest and GoogleMock into your C++ project using the Bazel build system. It covers setting up a Bazel workspace, configuring dependencies, and creating, building, and running your first test binary.

---

## Prerequisites

Before you begin, ensure your environment meets these requirements:

- A supported operating system (Linux, macOS, Windows).
- A C++ compiler supporting at least C++17 standard.
- Bazel build system version 7.0 or later installed.

For platform compatibility and detailed prerequisites, see the [Supported Platforms](../../getting-started/setup-foundations/system-requirements) and [Prerequisite Tools & Dependencies](../../getting-started/setup-foundations/prerequisites) pages.

If Bazel is not yet installed, refer to the [Bazel installation guide](https://bazel.build/install).

<Note>
The commands shown use a Unix-like shell prompt, but all steps work on Windows command line as well.
</Note>

---

## Step 1: Set Up a Bazel Workspace

A Bazel workspace is the root directory where Bazel manages your source files and dependencies.

1. Create your workspace directory and navigate into it:

```bash
$ mkdir my_workspace && cd my_workspace
```

2. In the root of your workspace, create a file named `MODULE.bazel` to declare GoogleTest as an external dependency. Use the following content:

```python
# MODULE.bazel

# Specify the GoogleTest module dependency at the desired version
bazel_dep(name = "googletest", version = "1.17.0")
```

Replace `1.17.0` with the latest available version from the [Bazel Central Registry](https://registry.bazel.build/modules/googletest).

<Tip>
Using `MODULE.bazel` leverages Bazel Central Registry for easy and reproducible dependency management.
</Tip>

---

## Step 2: Create the Test Source File

Create a C++ source file named `hello_test.cc` within your workspace. This will hold your simple test.

```cpp
#include <gtest/gtest.h>

// Example test exercising basic assertions.
TEST(HelloTest, BasicAssertions) {
  // Confirm two strings are different.
  EXPECT_STRNE("hello", "world");
  // Confirm arithmetic equality.
  EXPECT_EQ(7 * 6, 42);
}
```

This example test demonstrates how to use GoogleTest assertions in your code.

---

## Step 3: Create the Bazel BUILD File

In the same directory as your test source file, create a `BUILD` file to configure Bazel for building and running your test.

Add the following content:

```python
cc_test(
    name = "hello_test",
    size = "small",  # Denotes the test size category
    srcs = ["hello_test.cc"],  # Source files
    deps = [
        "@googletest//:gtest",        # Link GoogleTest library
        "@googletest//:gtest_main",   # Link GoogleTest main() function
    ],
)
```

This `cc_test` rule defines the test binary with its dependencies. The `gtest_main` dependency provides a default `main()` function, so you don't have to write one yourself.

---

## Step 4: Build and Run Your Test

Use Bazel commands to build and run your test binary:

```bash
$ bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

Here:

- `--cxxopt=-std=c++17` ensures compilation with C++17 standard.
- `--test_output=all` makes Bazel show all test output.
- `//:hello_test` specifies the target.

You should see output like this:

```
INFO: Analyzed target //:hello_test (26 packages loaded, 362 targets configured).
INFO: Found 1 test target...
INFO: From Testing //:hello_test:
==================== Test output for //:hello_test:
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
================================================================================
Target //:hello_test up-to-date:
  bazel-bin/hello_test
INFO: Elapsed time: 4.190s, Critical Path: 3.05s
INFO: 27 processes: 8 internal, 19 linux-sandbox.
INFO: Build completed successfully, 27 total actions
//:hello_test                                                     PASSED in 0.1s

INFO: Build completed successfully, 27 total actions
```

This confirms the test passed successfully.

---

## Practical Tips and Best Practices

- Always specify the C++ standard you intend to use during build to avoid compatibility issues (`--cxxopt=-std=c++17` for GCC/Clang, `/std:c++17` for MSVC).
- Declare dependencies explicitly in your Bazel workspace and BUILD files for clarity and reproducibility.
- Use `@googletest//:gtest_main` to link a ready-made `main()` function unless you need custom test initialization.
- Organize your workspace to keep test sources and BUILD files close to each other.
- When your project grows, consider organizing sources into separate directories with accompanying BUILD files.

---

## Troubleshooting Common Issues

<AccordionGroup title="Common Troubleshooting">  <Accordion title="Bazel Build Fails Due to Missing Dependencies">  Ensure that your `MODULE.bazel` file exists at the workspace root and that you have an active internet connection to download dependencies from the Bazel Central Registry. Verify that the version specified for Googletest is valid.  </Accordion>  <Accordion title="Compiler Does Not Use C++17">  Add the `--cxxopt=-std=c++17` flag on the Bazel command line to enforce C++17 standards support. For MSVC, use `--cxxopt=/std:c++17`.  </Accordion>  <Accordion title="Tests Do Not Run or Are Not Found">  Confirm your `cc_test` rule is correctly named and includes the test source file. Also, ensure it depends on `@googletest//:gtest_main` for a main function unless you provide your own.  </Accordion>  <Accordion title="Linker Errors Related to gtest or gmock">  Ensure your `deps` in the BUILD file correctly reference GoogleTest targets: `@googletest//:gtest` and `@googletest//:gtest_main`. Also, check the Bazel version compatibility with your Googletest version.  </Accordion></AccordionGroup>

<Warning>
Bazel caches dependencies aggressively. If you encounter unexpected behavior after dependency changes, run `bazel clean` to reset cache.
</Warning>

---

## Next Steps & Additional Resources

- Explore the [GoogleTest Primer](primer.md) to learn how to write simple and fixture-based tests after setup.
- Review [GoogleTest Samples](samples.md) for practical examples incorporating mocks and various assertions.
- When ready, dive into [Using Mock Objects Effectively](../../guides/writing-and-running-tests/using-mock-objects) for advanced mocking strategies.
- Consult [Troubleshooting Common Test Issues](../../getting-started/validation-troubleshooting/common-issues) if you face build or runtime test issues.

For more about Bazel build configurations and advanced integrations, visit the official [Bazel documentation](https://docs.bazel.build/).

---

Happy testing with GoogleTest and Bazel!