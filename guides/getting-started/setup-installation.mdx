---
title: "Installation & Initial Setup"
description: "A step-by-step walkthrough on integrating GoogleTest and GoogleMock into your build system using CMake or Bazel. Covers adding dependencies, configuring targets, and building the framework for immediate test authoring."
---

# Installation & Initial Setup

Integrate GoogleTest and GoogleMock smoothly into your C++ build system using this practical guide. Whether you are setting up a standalone test framework or adding GoogleTest/GoogleMock to an existing project, this guide walks you through the necessary steps to configure your environment with CMake or Bazel, ensuring an immediate start to writing and running tests.

---

## Workflow Overview

**Task Description:**
Learn how to build, configure, and integrate GoogleTest and GoogleMock into your project using two primary build systems: CMake and Bazel. This guide enables you to set up dependencies, configure targets, build the libraries, and be ready to author tests instantly.

**Prerequisites:**
- Have C++17 support on your compiler.
- Install CMake (version 3.14 or higher) or Bazel.
- Ensure your environment meets [prerequisites & system requirements](../getting-started/setup-basics/prerequisites-system-requirements).

**Expected Outcome:**
By following this guide, you will have:
- GoogleTest and GoogleMock built and installed (or integrated).
- Your project configured to use GoogleTest and GoogleMock libraries.
- A working environment ready to author and run your tests.

**Time Estimate:** 15-30 minutes, depending on your build system and platform.

**Difficulty Level:** Intermediate â€” basic familiarity with build systems assumed.

---

## Step-by-Step Instructions

### 1. Building GoogleTest and GoogleMock with CMake

GoogleTest ships with a cross-platform CMake build script suitable for most workflows, including standalone builds and integration into larger projects.

#### 1.1 Standalone Build

Execute the following commands in your terminal:

```bash
# Clone the repository at a specific release
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest

# Create a separate build directory
mkdir build
cd build

# Generate native build files including GoogleMock (default)
cmake ..

# If you want only GoogleTest without GoogleMock
# cmake .. -DBUILD_GMOCK=OFF

# Build the project
make  # or use appropriate build command on your platform

# (Optional) Install the built libraries system-wide
sudo make install
```

**Expected Result:**
- Compilation of GoogleTest and GoogleMock libraries.
- Build artifacts generated in your `build` directory.
- Installed headers and libraries if `make install` is run.

#### 1.2 Building on Windows

If you have Visual Studio installed, use CMake to generate `.sln` and `.vcproj` files:

```bash
cmake ..
```
Then open the generated `gtest.sln` in Visual Studio and build.

#### 1.3 Building on macOS

With Xcode installed:

```bash
cmake ..
```
Build using the generated `.xcodeproj` or via command line.

### 2. Incorporating GoogleTest/GoogleMock Into Your Existing CMake Project

Rather than building separately, you can integrate GoogleTest sources directly into your project.

#### 2.1 Using Installed Libraries

If GoogleTest is installed, add to your `CMakeLists.txt`:

```cmake
find_package(GTest CONFIG REQUIRED)

# Link your test executable against GTest libraries
add_executable(my_tests test_main.cpp ...)
target_link_libraries(my_tests GTest::gtest GTest::gmock_main)
add_test(NAME my_tests COMMAND my_tests)
```

#### 2.2 Building GoogleTest as Part of Your Project

Use CMake's FetchContent to download and build GoogleTest during your project's configuration:

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# On Windows, ensures run-time libraries are consistent
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

# Now add your test target
add_executable(example example.cpp)
target_link_libraries(example gtest_main gmock_main)
add_test(NAME example_test COMMAND example)
```

**Note:** This requires CMake 3.14 or later.

### 3. Building with Bazel

If you prefer Bazel, add dependencies in your `BUILD` files as follows:

```bazel
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gmock_main"],
)
```

Ensure workspace is set to include GoogleTest/Bazel dependencies from the official repository.

### 4. Post-Build: Initialize in Your Test Code

Your test executable must call `InitGoogleTest()` or `InitGoogleMock()` in `main()` before running tests:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);  // or InitGoogleMock
  return RUN_ALL_TESTS();
}
```

You can also link against `gtest_main` or `gmock_main` libraries, which provide a `main()` function.

---

## Examples

### Example CMakeLists.txt Embedding GoogleTest

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject CXX)

include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

add_executable(my_tests test1.cpp test2.cpp)
# Link against GoogleTest and GoogleMock
target_link_libraries(my_tests gtest_main gmock_main)

enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

### Example Linux Build Command

```bash
mkdir build && cd build
cmake ..
make
./my_tests
```

---

## Troubleshooting & Tips

<AccordionGroup title="Common Issues During Build">
<Accordion title="Missing or Old CMake Version">
Make sure CMake version 3.14+ is installed. Older versions lack FetchContent support.
</Accordion>
<Accordion title="Runtime Library Mismatch on Windows">
Enable `gtest_force_shared_crt` to align runtime library linkage. This resolves errors like mismatch detected for 'RuntimeLibrary'.
</Accordion>
<Accordion title="Linker Errors on pthread on Linux">
If building manually, link with pthread explicitly (e.g., add `-pthread` flag). Using CMake handles this automatically.
</Accordion>
</AccordionGroup>

<Tip>
Use `cmake --build . --target install` carefully; system administrators often restrict permissions. Consider local or project-specific installation.
</Tip>

<Tip>
To speed up build times and avoid compatibility issues, embed GoogleTest via FetchContent instead of copying source files.
</Tip>

<Warning>
Avoid mixing debug and release versions of GoogleTest/GoogleMock libraries with your test binaries to prevent runtime errors.
</Warning>

---

## Next Steps & Related Content

- Proceed to [Writing Your First Tests](../guides/getting-started/first-tests) to start authoring effective tests.
- Learn about [Basic Mocking Using GoogleMock](../guides/getting-started/mocking-basics) for creating mock objects to simulate dependencies.
- Review [Prerequisites & System Requirements](../getting-started/setup-basics/prerequisites-system-requirements) if environment setup issues occur.
- Troubleshoot build or runtime issues with [Troubleshooting Common Issues](../getting-started/first-test-run-validation/troubleshooting-common-issues).

---

## Additional Resources

- Official GoogleTest repository: [https://github.com/google/googletest](https://github.com/google/googletest)
- CMake Documentation: [https://cmake.org/documentation/](https://cmake.org/documentation/)
- GoogleTest Primer: [primer.md](../primer.md)
- GoogleMock documentation and samples
