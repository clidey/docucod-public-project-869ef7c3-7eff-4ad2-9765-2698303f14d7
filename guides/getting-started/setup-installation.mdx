---
title: "Installation and Setup"
description: "Comprehensive steps for installing GoogleTest and GoogleMock, covering both Bazel and CMake build systems. Learn how to integrate the framework into new or existing C++ projects, configure build files, and verify your environment."
---

# Installation and Setup of GoogleTest & GoogleMock

## Overview
This guide provides comprehensive, step-by-step instructions to install and set up GoogleTest and GoogleMock frameworks in your C++ projects. Whether you're using Bazel or CMake as your build system, you will learn how to integrate the frameworks into new or existing projects, configure your build files correctly, and verify the setup to ensure a smooth testing workflow.

---

## 1. Preparation and Prerequisites

Before starting the installation process, ensure your environment meets the following:

- You have a functional C++ development environment (compiler, build tools).
- For **CMake**, have CMake version 3.13 or higher installed.
- For **Bazel**, ensure Bazel is installed and configured.
- Basic familiarity with your chosen build system (Bazel or CMake).
- Network access to clone the GoogleTest/GoogleMock repositories or download release packages.

<Tip>
If you are setting up for the first time, review the [System Requirements & Prerequisites](https://github.com/google/googletest/blob/main/docs/setup-prerequisites/prerequisites-requirements.md) to confirm compatibility with your platform and tools.
</Tip>

---

## 2. Installation Steps

GoogleTest and GoogleMock are usually installed together as they form a unified testing framework. GoogleMock depends on GoogleTest internally.

### 2.1 Installation Using CMake

#### Step 1: Clone the Repository
```bash
git clone https://github.com/google/googletest.git
git clone will fetch both Googletest and GoogleMock sources.
```

#### Step 2: Create a Build Directory
```bash
mkdir build && cd build
```

#### Step 3: Configure the Build
```bash
cmake ../googletest
```
This configures both GoogleTest and GoogleMock projects.

#### Step 4: Build the Framework
```bash
cmake --build . --config Release
```

#### Step 5: Install Libraries and Headers
Use `make install` or equivalent for your platform, or:
```bash
cmake --install .
```

#### Step 6: Link GoogleTest and GoogleMock to Your Project
Update your `CMakeLists.txt` to include GoogleTest and GoogleMock headers and libraries. Example for your test executable:

```cmake
find_package(GTest REQUIRED)
add_executable(my_tests test_main.cpp ...)
target_link_libraries(my_tests GTest::gtest GTest::gtest_main GMock::gmock GMock::gmock_main pthread)
```


### 2.2 Installation Using Bazel

GoogleTest and GoogleMock have native Bazel support.

#### Step 1: Declare External Repositories
Add the following in your `WORKSPACE` file:

```starlark
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-<version>.zip"],
    strip_prefix = "googletest-release-<version>",
)
```

Adjust `<version>` to the desired release tag.

#### Step 2: Use Targets in Your `BUILD` Files
Depend on `@com_google_googletest//:gmock_main` or `:gtest_main`:

```starlark
cc_test(
    name = "my_test",
    srcs = ["my_test.cpp"],
    deps = ["@com_google_googletest//:gmock_main"],
)
```

This will build your test with GoogleMock and GoogleTest.

---

## 3. Configuring the Build Files for Integration

### Using CMake

- **Include Directories**: GoogleMock and GoogleTest headers are normally found automatically via `find_package(GTest)`.
- **Link Libraries**: Link your test targets against `gtest`, `gtest_main`, `gmock`, and `gmock_main` as appropriate.

<Tip>
Use `gmock_main` or `gtest_main` libraries if you prefer GoogleTest or GoogleMock's provided main() function, which calls `RUN_ALL_TESTS()` internally, so you don't have to write one yourself.
</Tip>

- If your project requires customized initialization, consider writing your own `main()` that calls `testing::InitGoogleMock(&argc, argv);` followed by `RUN_ALL_TESTS();`.

### Using Bazel

- Depend on `@com_google_googletest//:gmock_main` for both GoogleMock and GoogleTest with main() function included.
- For just GoogleTest, depend on `@com_google_googletest//:gtest_main`.

---

## 4. Verifying Your Installation

### Step 1: Write a Simple Test
Create a simple test file `sample_test.cpp`:

```c++
#include "gtest/gtest.h"

TEST(SanityTest, BasicAssertions) {
  EXPECT_EQ(7 * 6, 42);
}
```

### Step 2: Build the Test
Follow your build system's normal build procedure, linking with GoogleTest or GoogleMock libraries.

### Step 3: Run the Test
Execute the test binary. You should see output similar to:

```
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SanityTest
[ RUN      ] SanityTest.BasicAssertions
[       OK ] SanityTest.BasicAssertions (0 ms)
[----------] 1 test from SanityTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

<Tip>
If you are using GoogleMock, initialize with `testing::InitGoogleMock()` instead of `InitGoogleTest()`, and link to `gmock_main` or provide your custom `main()`.
</Tip>

---

## 5. Troubleshooting Common Issues

<AccordionGroup title="Common Issues and Resolutions">
<Accordion title="Test Binary Not Linking or Missing main()">
If your test binary fails to link due to missing `main()`, ensure you:

- Link against `gtest_main` or `gmock_main` libraries which provide main(), or
- Write your own main that initializes and runs tests:

```c++
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv); // Or InitGoogleTest
  return RUN_ALL_TESTS();
}
```
</Accordion>
<Accordion title="Build Failures Due to Missing Includes">
Make sure your include directories point to GoogleTest and GoogleMock headers. With CMake, use `find_package(GTest REQUIRED)` and link targets properly.
</Accordion>
<Accordion title="Tests Not Running or Not Found">
Verify you have called `RUN_ALL_TESTS()` in your main function. Also, ensure your test files are compiled and linked into your test executable.
</Accordion>
<Accordion title="Bazel Build Errors Related to Repository Setup">
Double-check your `WORKSPACE` file contains the proper `http_archive` definitions with the correct URLs and strip prefixes matching the released versions.
</Accordion>
</AccordionGroup>

<Tip>
For detailed platform-specific installation, troubleshooting, and integration guidance, consult the [Installation (All Platforms)](https://github.com/google/googletest/blob/main/docs/setup-prerequisites/installation-platforms.md) and [Integrating GoogleTest with Your Workflow](https://github.com/google/googletest/blob/main/docs/overview/concepts-architecture/integration-overview.md) guides.
</Tip>

---

## 6. Best Practices & Tips

- Prefer linking against `gmock_main` or `gtest_main` to simplify test executable setup unless you have custom initialization needs.
- Always call `testing::InitGoogleMock()` or `testing::InitGoogleTest()` **before** running tests to parse flags and initialize the framework correctly.
- Organize tests to leverage fixtures and parameterized testing for scalable test suites.
- Keep your build environment hermetic and isolate third-party dependencies for reproducibility (especially with Bazel).

---

## 7. Next Steps

After installation and setup:

- Explore the [Writing Your First Test](https://github.com/google/googletest/blob/main/docs/guides/getting-started/writing-first-test.md) guide.
- Learn about [Configuring & Integrating GoogleTest](https://github.com/google/googletest/blob/main/docs/getting-started/first-run-usage/configuration-integration.md).
- Troubleshoot using [Troubleshooting & Quick Validation](https://github.com/google/googletest/blob/main/docs/getting-started/first-run-usage/troubleshooting-quick-validation.md).
- Delve into mocking with GoogleMock in the [Creating and Using Mocks](https://github.com/google/googletest/blob/main/docs/guides/mocking-and-advanced-techniques/creating-and-using-mocks.md) guide.

---

## References & Further Reading

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — Introduction to writing tests.
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md) — Overview of mocking framework.
- [CMakeLists.txt](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt) — Example build configuration.
- [Testing main() implementations](https://github.com/google/googletest/blob/main/googletest/src/gtest_main.cc) — Reference source for main() used by gtest_main.
- [GoogleMock main() implementation](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc) — Reference main() used by gmock_main.

---

By following this guide, you'll have GoogleTest and GoogleMock installed and integrated in your project, ready to create reliable and maintainable C++ tests with both frameworks.