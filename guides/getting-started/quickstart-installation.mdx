---
title: "Installing and Setting Up GoogleTest"
description: "Learn how to add GoogleTest and GoogleMock to your C++ project. This guide covers recommended installation methods, including using CMake or Bazel, and provides troubleshooting tips for common platform-specific setup issues."
---

# Installing and Setting Up GoogleTest

Learn how to add GoogleTest and GoogleMock to your C++ project. This guide covers recommended installation methods, including using CMake or Bazel, and provides troubleshooting tips for common platform-specific setup issues.

---

## 1. Workflow Overview

### What This Guide Helps You Accomplish
This guide walks you through integrating GoogleTest and GoogleMock into your C++ projects. Whether you're starting fresh or adding testing to an existing build system, you'll learn practical ways to install, configure, and validate GoogleTest using the two most common build systems — CMake and Bazel.

### Prerequisites
- Familiarity with C++ development and basic understanding of build systems (CMake or Bazel).
- Installed and working C++ compiler that supports C++17 (GCC 7+, Clang 5+, MSVC 2017+).
- Internet connectivity to fetch source from GitHub.
- Basic command-line usage skills.

### Expected Outcome
- Successfully cloned and built GoogleTest (and GoogleMock) into your project.
- Able to link GoogleTest libraries in your build system.
- Validated installation by compiling and running a simple test binary.

### Time Estimate
Approximately 15-30 minutes to complete if your environment is prepared.

### Difficulty Level
Beginner to Intermediate — assumes you know how to build C++ projects but are new to GoogleTest integration.

---

## 2. Step-by-Step Instructions

### A. Installing GoogleTest with CMake

1. **Clone the GoogleTest Repository**
   ```sh
   git clone https://github.com/google/googletest.git -b v1.17.0
   cd googletest
   ```
   _This fetches the stable release 1.17.0 with both GoogleTest and GoogleMock._

2. **Create a Build Directory**
   ```sh
   mkdir build
   cd build
   ```
   _Keeps build artifacts separate from source._

3. **Configure the Build with CMake**
   For both GoogleTest and GoogleMock:
   ```sh
   cmake ..
   ```

   To build only GoogleTest (no GoogleMock):
   ```sh
   cmake .. -DBUILD_GMOCK=OFF
   ```

4. **Build the Libraries**
   On Linux/macOS:
   ```sh
   make
   ```
   On Windows with Visual Studio:
   - Open the generated `gtest.sln` solution file.
   - Build the solution.

5. **(Optional) Install GoogleTest for System-wide Use**
   ```sh
   sudo make install
   ```
   _Installs GoogleTest headers and libraries to `/usr/local` by default._

6. **Integrate with Your Project**
   - Use `find_package(GTest REQUIRED)` in your `CMakeLists.txt` if installed.
   - Or, include GoogleTest as a subdirectory and link against `gtest` or `gtest_main` targets.

7. **Example CMakeLists.txt Snippet:**
   ```cmake
   find_package(GTest REQUIRED)
   enable_testing()

   add_executable(my_tests test.cpp)
   target_link_libraries(my_tests GTest::gtest_main)
   add_test(NAME MyTest COMMAND my_tests)
   ```

8. **Run Your Tests**
   ```sh
   ctest
   ```
   or execute the test binary directly.


### B. Installing GoogleTest with Bazel

1. **Add GoogleTest as an External Dependency**
   In your `WORKSPACE` file, add:
   ```python
   http_archive(
       name = "com_google_googletest",
       url = "https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip",
       strip_prefix = "googletest-5376968f6948923e2411081fd9372e71a59d8e77",
   )
   ```

2. **Reference GoogleTest in your BUILD files**
   Define your test target by linking against GoogleTest libraries:
   ```python
   cc_test(
       name = "my_test",
       srcs = ["my_test.cc"],
       deps = ["@com_google_googletest//:gtest_main"],
   )
   ```

3. **Build and Run Your Tests with Bazel**
   ```sh
   bazel test //path/to:my_test
   ```

4. **Enable GoogleMock Support**
   Use the `@com_google_googletest//:gmock_main` target instead if you want to utilize mocks.

---

## 3. Practical Examples

### Minimal CMake Project with GoogleTest
```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject)

set(CMAKE_CXX_STANDARD 17)

# Fetch GoogleTest during configure step
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/v1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(test_sample test_sample.cpp)
target_link_libraries(test_sample gtest_main)
include(GoogleTest)
gtest_discover_tests(test_sample)
```

### Sample test_sample.cpp
```cpp
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
}
```

Build and run:
```sh
mkdir build && cd build
cmake ..
make
./test_sample
```

---

## 4. Troubleshooting & Best Practices

### Common Issues

- **Compiler Version Errors:** Ensure your compiler supports C++17 as it is mandatory.
- **Linker Errors:** Confirm that you link against `gtest_main` or `gmock_main` for the main function.
- **Threading Linker Flags:** On some systems, you may need to explicitly link pthread.
- **Visual Studio Runtime Mismatches:** Use the `gtest_force_shared_crt` CMake option on Windows to align runtimes.

### Tips

- Use CMake's `FetchContent` to simplify dependency management.
- When embedding GoogleTest source in your project, keep it up to date to benefit from fixes.
- For CI integration, ensure GoogleTest binaries are built as part of your pipeline.
- Use `ctest` to run your tests consistently across environments.

### Platform-specific Considerations

- Windows users: Opening the generated Visual Studio solution file enables native development.
- Mac users: Xcode projects can be generated with `cmake -G Xcode ..`.
- Embedded platforms (ESP8266, ESP32): See special `setup` and `loop` initialization methods in GoogleMock.

---

## 5. Next Steps & Additional Resources

- **Writing Your First Test:** [Write Your First Test Guide](/getting_started/first_test_and_validation/create_first_test)
- **Running and Validating Tests:** [Test Execution and Validation](/getting_started/first_test_and_validation/run_and_validate)
- **Integration with Build Systems:** [Integration with CMake, Bazel, and CI](/overview/integration-feature-overview/integration-build-systems)
- **Troubleshooting Setup Issues:** [Troubleshooting Setup](/getting_started/first_test_and_validation/troubleshooting_setup)
- **Advanced Mocking:** Explore [GoogleMock Overview](https://github.com/google/googletest/tree/main/googlemock)

<Tip>
For a seamless setup, always keep your build system and compiler versions compatible and consult platform-specific notes.
</Tip>

<Note>
Make sure to check that the GoogleTest and GoogleMock versions used are compatible with each other to avoid unexpected failures.
</Note>

---

## 6. Quick Reference Commands

```sh
# Clone GoogleTest
git clone https://github.com/google/googletest.git -b v1.17.0

# CMake build
mkdir build && cd build
cmake ..
make

# Run tests
ctest

# Bazel example
bazel test //path/to:my_test
```

---

For more detailed options, consult the official [GoogleTest GitHub repository](https://github.com/google/googletest) and the [GoogleMock documentation](https://google.github.io/googletest/gmock_for_dummies.html).
