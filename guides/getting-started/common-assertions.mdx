---
title: "Understanding Assertions and Test Results"
description: "Explore the most useful assertions in GoogleTest, how to verify expected values and conditions, and interpret test runner output for both passing and failing tests."
---

# Understanding Assertions and Test Results

Explore the most useful assertions in GoogleTest, how to verify expected values and conditions, and interpret test runner output for both passing and failing tests.

---

## Overview

This guide helps you master assertions in GoogleTest, enabling you to write tests that clearly verify conditions and understand test output success or failure. You'll learn which assertions to use for your verification needs, how to interpret different test results, and how to make failure messages clear and actionable.

> GoogleTest’s assertion macros form the backbone of writing effective tests by verifying expected values or conditions and reporting results for you.


## Prerequisites

- GoogleTest installed and configured in your development environment.
- Your source files including GoogleTest header: `#include <gtest/gtest.h>`.
- Basic familiarity with writing simple tests (`TEST`, `TEST_F`) in GoogleTest.


## Expected Outcome

- Ability to select appropriate assertions to verify expectations.
- Know how to handle both fatal and nonfatal assertion failures.
- Understand special assertions like `SUCCEED()`, `FAIL()`, and how to use scoped traces.
- Interpret test runner output to quickly identify failing tests and their causes.

## Time Estimate

About 15-30 minutes to read and practice based on your familiarity with GoogleTest.

## Difficulty Level

Beginner to Intermediate

---

## 1. Purpose and Types of Assertions

GoogleTest provides a rich set of macros to help you verify program state during tests. Assertions come in pairs:

- **Fatal Assertions (`ASSERT_`):** On failure, abort the current test function immediately.
- **Nonfatal Assertions (`EXPECT_`):** On failure, record the failure but continue executing the current function.

This allows fine control over whether a failure should halt test execution or not.

### 1.1 Explicit Success and Failure

- **`SUCCEED()`**: Explicitly mark a step or condition as successful. Does NOT make the entire test succeed but can be used for documentation or clarity.

- **`FAIL()`**: Causes a fatal failure and immediately returns from the current function. Only usable in `void` functions.

- **`ADD_FAILURE()`**: Records a nonfatal failure but continues test execution.

### Example:
```cpp
switch (state) {
  case 1:
    ...
    break;
  default:
    FAIL() << "Reached unexpected state.";
}
```

---

## 2. Common Assertions for Condition Verification

### 2.1 Boolean Conditions

- **`EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`**
- **`EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`**

Verify that a condition holds true or false respectively.

### 2.2 Equality and Comparison

Use `EXPECT_EQ`, `EXPECT_NE`, `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE` and their `ASSERT_` variants to compare values.

Example:
```cpp
EXPECT_EQ(result, expected) << "Result did not match expected";
ASSERT_LT(actual_value, threshold);
```

Note:
- For C strings, use `EXPECT_STREQ` and related macros for content comparison.
- Pointers are compared by address, not the content.

### 2.3 String Comparisons

- `EXPECT_STREQ`, `EXPECT_STRNE`: Compare C strings by content.
- `EXPECT_STRCASEEQ`, `EXPECT_STRCASENE`: Compare case-insensitively.

### 2.4 Floating-Point Comparisons

- `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`: Verify floating-point equality with tolerance based on ULPs.
- `EXPECT_NEAR(val1, val2, abs_error)`: Verify values are within absolute error.

### 2.5 Exception Assertions

Verify code throws or doesn't throw exceptions.
- `EXPECT_THROW(statement, ExceptionType)`
- `EXPECT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)`

---

## 3. Writing Assertions with Custom Messages

All assertions support streaming a custom failure message with `<<` operator:

```cpp
EXPECT_TRUE(is_valid) << "Validation failed for input: " << input_val;
```

The streamed message will appear in failure output, helping clarify issues.

**Tip:** Use expressive messages to speed diagnosis when a test fails.

---

## 4. Advanced Assertions: Predicate and Predicate-Format

### 4.1 Predicate Assertions

If you have functions or functors that return `bool`, you can check them with predicate assertions:

```cpp
EXPECT_PRED2(MutuallyPrime, a, b);
```

If the predicate evaluates to false, GoogleTest reports actual argument values.

### 4.2 Predicate-Formatter Assertions

When you need customized failure messages or your predicates can’t stream directly, use predicate formatters that return `testing::AssertionResult`, for example:

```cpp
testing::AssertionResult IsEven(const char* expr, int n) {
  return (n % 2) == 0 ? testing::AssertionSuccess() : testing::AssertionFailure() << expr << " is not even";
}

EXPECT_PRED_FORMAT1(IsEven, value);
```

This gives fine control over error handling and messaging.

---

## 5. Handling Fatal Failures in Subroutines

By default, fatal assertions (`ASSERT_*`) fail the current function but do not abort the entire test. GoogleTest provides tools to propagate or detect fatal failures:

- **`ASSERT_NO_FATAL_FAILURE(statement)`**: Verifies `statement` does not generate fatal failures.
- **`HasFatalFailure()`** (in `testing::Test`): Returns true if the current test has a fatal failure so far.

Example of usage to abort early if subroutine failed:

```cpp
SubroutineThatMayFail();
if (testing::Test::HasFatalFailure()) return;
// Continue only if no fatal failure
```

Alternatively, you can throw exceptions on failure by adding an event listener that throws when an assertion fails.

---

## 6. Viewing and Understanding Test Results

### 6.1 TestPartResult

`TestPartResult` represents the outcome of a single assertion or explicit success/failure:

- `kSuccess`: Passed assertion.
- `kNonFatalFailure`: Failed assertion but test continues.
- `kFatalFailure`: Failed and test should be aborted.
- `kSkip`: Skipped assertion/test part.

You can query these states via `passed()`, `failed()`, `fatally_failed()`, `nonfatally_failed()`, or `skipped()`.

### 6.2 TestResult

Each test has a `TestResult` which aggregates all `TestPartResults` and test properties, provides elapsed time and summary methods like `Passed()`, `Failed()`, `Skipped()`, `HasFatalFailure()`, and `HasNonfatalFailure()`.

### 6.3 Console Output Format

GoogleTest's console prints colorful status messages:

- `[ RUN      ]`: Test started
- `[       OK ]`: Test passed
- `[  FAILED  ]`: Test failed
- `[  SKIPPED ]`: Test skipped

Failures show detailed messages with file/line info and assertion explanation.

### 6.4 XML and JSON Reports

GoogleTest can save detailed test output as XML or JSON using the `--gtest_output` flag, helpful for CI systems.

Example of an XML snippet for a test failure:

```xml
<testcase name="TestName" file="test.cpp" line="42" status="run" time="0.017" classname="TestSuite">
  <failure message="Expected equality of these values..." type="">
    <![CDATA[... detailed message ...]]>
  </failure>
</testcase>
```

---

## 7. Tips and Best Practices

- **Use `EXPECT_` macros in tests where failure should allow cleanup or further checks.** Use `ASSERT_` when continuation is meaningless after failure.
- **Use `SCOPED_TRACE` to add context when calling test helpers or inside loops.** It adds trace points to failure messages which help to pinpoint failures.

Example:

```cpp
SCOPED_TRACE("iteration " << i);
EXPECT_EQ(foo(i), expected);
```

- **Do not put fatal assertions in constructors or destructors.** Instead, use `SetUp()` and `TearDown()`.
- **Use value-parameterized or typed tests for testing multiple inputs or types efficiently.**
- **In death tests, follow the naming convention for test suites ending with "DeathTest" to ensure correct execution order and thread-safety.**
- **Capture and stream custom failure messages for improved debugging.**

---

## 8. Troubleshooting Common Assertion Issues

- **Failing Fatal Assertions Not Aborting Test:** Ensure the function is `void` and `ASSERT_` is used appropriately. Use `HasFatalFailure()` or `ASSERT_NO_FATAL_FAILURE()` to detect subroutine failures.
- **Wrong Pointer Comparisons for C-Strings:** Use `EXPECT_STREQ` and related string comparison assertions.
- **Strange Output of Floating-Point Comparisons:** Prefer `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ` over `EXPECT_EQ` for floats/doubles to handle rounding.
- **Confusing Error Message:** Stream custom messages or use predicate format assertions for clarity.

---

## 9. Practical Examples

### 9.1 Comparing Values with Assertions

```cpp
TEST(FooTest, BasicComparisons) {
  int x = ComputeValue();
  EXPECT_EQ(x, 42) << "Computation returned unexpected value.";
  EXPECT_TRUE(x > 0);
  EXPECT_FALSE(x < 0);
}
```

### 9.2 Using String Comparison Assertions

```cpp
const char* s1 = GetString1();
const char* s2 = GetString2();
EXPECT_STREQ(s1, s2) << "Strings do not match";
```

### 9.3 Floating-Point Equality with Tolerance

```cpp
float a = CalculateFloatA();
float b = CalculateFloatB();
EXPECT_FLOAT_EQ(a, b);
```

### 9.4 Using `SCOPED_TRACE` in Loops to Add Context

```cpp
for (int i = 0; i < 10; ++i) {
  SCOPED_TRACE(testing::Message() << "i=" << i);
  EXPECT_TRUE(CheckCondition(i));
}
```

### 9.5 Handling Failures in Subfunctions

```cpp
void CheckPositive(int n) {
  ASSERT_GT(n, 0) << "Value is not positive";
}

TEST(NumbersTest, PositiveCheck) {
  CheckPositive(-1);
  if (::testing::Test::HasFatalFailure()) return;
  ... further checks ...
}
```

---

## 10. Additional Resources

- [GoogleTest Assertions Reference](reference/assertions.md)
- [Advanced Topics on Assertions and Failures](guides/advanced.md#more-assertions)
- [Writing Your First Test with GoogleTest](guides/getting-started/writing-your-first-test)
- [Understanding Mocks and Matchers](guides/mocking-techniques/creating-mocks)
- [Handling Death Tests](guides/writing-effective-tests/death-tests)
- Official GoogleTest GitHub repository: https://github.com/google/googletest

---

## Summary
This guide presents the essential assertions you'll use to verify your test expectations in GoogleTest, explain how to choose between fatal and nonfatal failures, and interpret test output for successful and failing tests. It demonstrates practical usage with simple examples, how to write clearer failure messages, and best practices to organize tests and handle assertion failures gracefully. Use this knowledge to write more robust and maintainable tests.

