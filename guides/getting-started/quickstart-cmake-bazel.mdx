---
title: "Quickstart: CMake and Bazel"
description: "Guides for integrating GoogleTest into your project using either CMake or Bazel, including setting up dependencies and best practices for build configuration."
---

# Quickstart: CMake and Bazel

This guide helps you quickly integrate GoogleTest into your C++ project using the two most popular build systems: **CMake** and **Bazel**. You'll learn how to declare dependencies, build test binaries, and run tests, with practical examples and best practices for efficient setup.

---

## Workflow Overview

- **Task Description**: Set up GoogleTest in your project, build a test binary, and run basic tests using CMake or Bazel.
- **Prerequisites**:
  - Supported operating system (Linux, macOS, Windows).
  - C++ compiler with support for at least C++17.
  - Installed CMake (version 3.14+) for CMake workflow.
  - Installed Bazel (version 7.0+) for Bazel workflow.
- **Expected Outcome**: A working project where GoogleTest-based tests are built and executed successfully.
- **Time Estimate**: 10-20 minutes depending on familiarity.
- **Difficulty Level**: Beginner to Intermediate.

---

## Setting Up GoogleTest with CMake

### 1. Prepare Your Project Directory

Create a new directory for your project and enter it:

```bash
$ mkdir my_project && cd my_project
```

### 2. Configure `CMakeLists.txt` with GoogleTest Dependency

Create a `CMakeLists.txt` file with the following content, which sets up GoogleTest as a dependency using the `FetchContent` module:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Require C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)

# For Windows: ensure compatible runtime
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

# Enable testing in CMake
enable_testing()

# Add the test executable
add_executable(
  hello_test
  hello_test.cc
)

# Link against GoogleTest's main library for tests
target_link_libraries(
  hello_test
  GTest::gtest_main
)

# Enable CTest discovery of tests
include(GoogleTest)
gtest_discover_tests(hello_test)
```

### 3. Add a Sample Test

Create a file `hello_test.cc` in the same directory:

```cpp
#include <gtest/gtest.h>

// Basic test case demonstrating simple assertions
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

### 4. Build and Run Tests

From your project root directory, execute:

```bash
$ cmake -S . -B build
$ cmake --build build
$ cd build && ctest
```

You should see output confirming the build and that the tests passed:

```
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

### Best Practices & Tips

- Update the GoogleTest commit hash in `FetchContent_Declare` regularly to use the latest stable code.
- Use `target_link_libraries` with `GTest::gtest_main` to automatically include the GoogleTest main() function.
- Ensure your compiler uses C++17 or higher to avoid compatibility issues.

---

## Setting Up GoogleTest with Bazel

### 1. Prepare Your Bazel Workspace

Create a directory and set it as your Bazel workspace:

```bash
$ mkdir my_workspace && cd my_workspace
```

### 2. Create the `MODULE.bazel` to Specify Dependencies

Add the following to a file named `MODULE.bazel` at the root of your workspace:

```python
# MODULE.bazel

# Declare the GoogleTest dependency (use latest version available)
bazel_dep(name = "googletest", version = "1.17.0")
```

This pulls GoogleTest from the Bazel Central Registry.

### 3. Add a Sample Test Source

Create a file named `hello_test.cc` with this content:

```cpp
#include <gtest/gtest.h>

// Demonstrate some basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

### 4. Create the Bazel `BUILD` File

Add a `BUILD` file with the following to describe the test target:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

### 5. Build and Run the Test

Run the test with Bazel, specifying the C++ standard if needed:

```bash
$ bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

You will see detailed output of test execution ending with:

```
[  PASSED  ] 1 test.
INFO: Build completed successfully, 27 total actions
//:hello_test                                                     PASSED in 0.1s
```

### Best Practices & Tips

- Use the Bazel Central Registry for dependency management via `MODULE.bazel`.
- Pass `--cxxopt=-std=c++17` (or equivalent for your compiler) to ensure compatibility.
- For complex projects, organize tests in packages with separate BUILD files.

---

## Troubleshooting Common Issues

<AccordionGroup title="Build and Setup Issues">
<Accordion title="Compiler Compatibility">
Verify your compiler supports C++17 or higher. Older compilers often cause build failures or runtime errors.
</Accordion>
<Accordion title="Dependency Not Found in Bazel">
Ensure `MODULE.bazel` configuration is correct and you have internet access for Bazel to fetch the dependencies.
</Accordion>
<Accordion title="CMake FetchContent Fails">
Make sure the URL for `FetchContent_Declare` is accessible and the commit hash is valid. Network hiccups can cause failure.
</Accordion>
<Accordion title="Test Not Executing or Found">
Confirm test targets are labeled correctly (`cc_test` in Bazel, added to `add_executable` and `gtest_discover_tests` in CMake).
</Accordion>
</AccordionGroup>

---

## Next Steps & Related Content

- Start writing your own tests: see [Writing Your First Test](../guides/getting-started/basic-test-workflow.md).
- Learn about assertions and test control: refer to [Mastering Assertions](../guides/core-testing-workflows/using-assertions.md).
- If working with mocks, explore [Creating and Using Mock Objects](../guides/mocking-techniques/creating-mocks.md).
- For continuous integration, see [Continuous Integration and Test Automation](../guides/advanced-and-integration/ci-integration.md).

---

Congratulations! You have set up GoogleTest successfully using your chosen build system and are ready to write, build, and run tests effectively.


---

## Summary Table of Commands

<CardGroup cols={2}>
<Card title="CMake Quickstart Commands">
```
mkdir my_project && cd my_project
# Create CMakeLists.txt and hello_test.cc
cmake -S . -B build
cmake --build build
cd build && ctest
```
</Card>
<Card title="Bazel Quickstart Commands">
```
mkdir my_workspace && cd my_workspace
# Create MODULE.bazel, BUILD and hello_test.cc
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```
</Card>
</CardGroup>

---

## References

- [GoogleTest GitHub](https://github.com/google/googletest)
- [CMake Documentation](https://cmake.org/cmake/help/latest/)
- [Bazel Documentation](https://bazel.build/)
- [GoogleTest Primer](../primer.md)
- [GoogleTest Build & Installation](../getting-started/setup-installation/installation-cmake-bazel.md)

---

*This guide is aligned with the official GoogleTest documentation and ensures you have a straightforward path to integrating the framework into your workflow using modern tools.*
