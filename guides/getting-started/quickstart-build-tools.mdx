---
title: "Quickstart: Integration with CMake and Bazel"
description: "Step-by-step setup instructions for building and integrating GoogleTest into projects via CMake and Bazel. Covers project setup, dependencies, and running your test suite, so new users can get up and running quickly regardless of their ecosystem."
---

# Quickstart: Integration with CMake and Bazel

This guide provides you with clear, step-by-step instructions to set up, build, and run your GoogleTest tests using two major build ecosystems: **CMake** and **Bazel**. Whether you are starting a new project or integrating GoogleTest into an existing one, this tutorial covers how to configure dependencies, write a simple test, and execute your test suite â€” helping you get started quickly regardless of your preferred build environment.

---

## Prerequisites

Before you start, ensure you have the following ready:

- A supported operating system: Linux, macOS, or Windows.
- A C++ compiler supporting at least C++17.
- For CMake workflows:
  - [CMake](https://cmake.org/) version 3.14 or higher.
  - A compatible build tool such as [Make](https://www.gnu.org/software/make/), [Ninja](https://ninja-build.org/), or equivalent.
- For Bazel workflows:
  - Bazel installed and configured according to your platform.

> Note: Windows users can perform the terminal commands listed here via PowerShell or Command Prompt with minimal changes.

For more details on supported platforms and compilers, see [Supported Platforms & Compatibility](https://google.github.io/googletest/overview/integration-platforms/supported-platforms).

---

## Part 1: Setting Up GoogleTest with CMake

### 1. Create Your Project Directory

Start by creating a directory for your project and navigating into it:

```bash
mkdir my_project && cd my_project
```

### 2. Initialize Your CMakeLists.txt

Create a file named `CMakeLists.txt` in your project folder. Use the **FetchContent** module to declare GoogleTest as a dependency and configure your project to use C++17:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Enforce C++17 standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
# Required for Windows to prevent overriding CRT settings
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)
```

> Update the commit hash regularly to track the latest GoogleTest release.

### 3. Add a Simple Test File

Inside the `my_project` directory, create a C++ source file named `hello_test.cc` containing a basic test example:

```cpp
#include <gtest/gtest.h>

// Simple test suite example
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world"); // Strings should not match
  EXPECT_EQ(7 * 6, 42);             // 7 times 6 is 42
}
```

This file uses GoogleTest assertions to verify basic conditions.

### 4. Complete CMake Setup to Build and Run Tests

Append the following configuration to your `CMakeLists.txt` file to build and discover tests:

```cmake
enable_testing()

add_executable(hello_test hello_test.cc)
target_link_libraries(hello_test GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

These directives enable CMake testing, define the executable, link to GoogleTest's main, and tell CMake to automatically find tests.

### 5. Build Your Project and Run Tests

Execute the following commands:

```bash
cmake -S . -B build
cmake --build build
cd build
ctest
```

**Expected output:**

```
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

You have now successfully built and run your first GoogleTest binary through CMake.

---

## Part 2: Setting Up GoogleTest with Bazel

GoogleTest integration for Bazel users is equally straightforward.

### 1. Declare GoogleTest in Your `WORKSPACE` File

Add the GitHub repository as an external dependency using `git_repository` or `http_archive`. A typical snippet:

```python
load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")

http_archive(
    name = "com_google_googletest",
    url = "https://github.com/google/googletest/archive/v1.17.0.zip",
    strip_prefix = "googletest-1.17.0",
    sha256 = "[SHA256]_OF_ZIP_FILE",
)
```

Replace `[SHA256]_OF_ZIP_FILE` with the actual SHA256 checksum.

### 2. Create a BUILD File for Your Tests

Inside your project, create a `BUILD` file defining your test targets. For example:

```python
cc_test(
    name = "hello_test",
    srcs = ["hello_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

### 3. Write Your Test

Use the same `hello_test.cc` example from the CMake section.

### 4. Build and Run Tests with Bazel

Invoke Bazel's test command to build and execute your tests:

```bash
bazel test //:hello_test
```

If everything is set up properly, Bazel will compile your tests and run them, displaying the test results in the output.

---

## Practical Tips and Best Practices

- **Keep Dependencies Updated:** Regularly update the GoogleTest version or commit hash in your build configurations to benefit from bug fixes and new features.
- **Use `gtest_main` When Possible:** Linking to `gtest_main` provides a ready-made `main()` function that initializes GoogleTest and runs all tests, saving you extra setup.
- **Enable C++17 Consistently:** Ensure your compiler and build system enforce C++17 uniformly across your project to avoid compatibility issues.
- **Leverage CMake's `gtest_discover_tests`:** This lets CMake automatically detect and register tests in your binary without manual listing.
- **Isolate Tests:** Write small, independent tests that can run separately. GoogleTest supports this by creating fresh test fixtures for each test.

---

## Troubleshooting

<Tip>
If you encounter build errors related to CRT mismatches on Windows, remember to define `gtest_force_shared_crt ON` in your CMake configuration to align runtime settings.
</Tip>

<Tip>
When using Bazel, ensure your `http_archive` rule has the correct SHA256 checksum to avoid download verification errors.
</Tip>

<Warning>
Make sure that `cmake` is at least version 3.14; older versions might not support the `FetchContent_MakeAvailable()` command used here.
</Warning>

<Info>
If tests fail to run or are not detected, verify that your test source files are compiled, linked, and properly listed in your build configuration.
</Info>

---

## Next Steps

- Explore the [GoogleTest Primer](https://google.github.io/googletest/guides/primer) to learn how to write various types of tests, including fixtures and parameterized tests.
- Check the [Assertions Reference](https://google.github.io/googletest/reference/assertions) for a full list of assertions available.
- For advanced integrations and customizations, refer to the [Manual and Advanced Installation](https://google.github.io/googletest/getting-started/installation-initialization/installation-manual) guide.
- Dive into continuous integration setups with GoogleTest through the [Cross-Platform and CI Integration Guide](https://google.github.io/googletest/guides/best-practices-integrations/cross-platform-and-ci).

---

## References

- [GoogleTest CMake Quickstart (source)](https://github.com/google/googletest/blob/main/docs/quickstart-cmake.md)
- [GoogleTest Primer: First Steps](https://google.github.io/googletest/guides/primer)
- [Supported Platforms](https://google.github.io/googletest/overview/integration-platforms/supported-platforms)
- [Bazel Integration Overview](https://docs.bazel.build/versions/master/tutorial/cpp.html)
- [CMake FetchContent Module Documentation](https://cmake.org/cmake/help/latest/module/FetchContent.html)

---

This quickstart guide ensures you can rapidly build and validate your C++ tests with GoogleTest, leveraging your chosen build ecosystem effectively.