---
title: "Organizing and Running Test Suites"
description: "Discover best practices for structuring your tests, grouping related cases into suites, and using GoogleTest's automatic discovery features. This guide demonstrates patterns for scaling tests in larger codebases and managing test execution."
---

# Organizing and Running Test Suites

GoogleTest is designed to make managing tests in C++ projects straightforward and scalable. This guide helps you structure your tests effectively by grouping related test cases into test suites, leveraging automatic test discovery, and managing test execution efficiently in large-scale projects.

---

## 1. Understanding Test Suites

### What is a Test Suite?

A *test suite* in GoogleTest is a collection of logically related tests. Each test in the suite validates a specific aspect of the code under test. Using test suites helps organize tests to mirror your code's design, making tests easier to maintain and understand.

### Test Suites vs Test Cases

GoogleTest has transitioned to using the term **test suite** instead of the legacy term **test case**. When you write tests using `TEST()` or `TEST_F()` macros, you are implicitly assigning those tests to a test suite.

### Benefits of Test Suites

- Grouping related tests for clarity and structure.
- Sharing common fixture objects and setup/teardown logic.
- Easier to run subsets of tests selectively.
- Supports advanced features like sharding and parameterized running.

---

## 2. Writing and Structuring Test Suites

### Simple Tests without Fixtures

Use the `TEST` macro to create standalone test functions that belong to suites:

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(3), 6);
}
```

Here both tests belong to the `FactorialTest` suite.

### Using Test Fixtures for Shared Setup

When multiple tests share common data or set-up steps, use test fixtures by deriving from `testing::Test`:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Shared setup
    q1.EnQueue(1);
    q2.EnQueue(2);
    q2.EnQueue(3);
  }

  Queue<int> q0;  // Empty
  Queue<int> q1;  // One element
  Queue<int> q2;  // Two elements
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q1.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  delete n;
}
```

Each `TEST_F` test belongs to the suite named after the fixture (`QueueTest`).

### Best Practices for Test Suites

- Name suites to reflect the component or class you are testing.
- Avoid underscores `_` in suite and test names to prevent naming conflicts.
- Keep tests independent: each test should create its own fixture instance.
- Use fixture `SetUp()` and `TearDown()` for per-test initialization and cleanup.

<Warning>
Avoid naming test suites or tests with underscores (`_`). GoogleTest reserves underscores for internal use (e.g., `DISABLED_` prefix). Using underscores may lead to confusing errors or name clashes.
</Warning>

---

## 3. Running Tests and Filters

### Running All Tests

GoogleTest automatically discovers all defined tests and runs them when you call `RUN_ALL_TESTS()` in your program's `main` function:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Running Selected Test Suites or Tests

You can run specific tests using command-line flags:

- `--gtest_filter=SuiteName.*` runs all tests in a suite.
- `--gtest_filter=SuiteName.TestName` runs a single test.
- Use wildcards `*` and `?` to match multiple tests.

Example to run only `QueueTest.DequeueWorks`:

```shell
./my_test --gtest_filter=QueueTest.DequeueWorks
```

### Including Disabled Tests

Prefix tests with `DISABLED_` to skip them temporarily. To include disabled tests in a run, use:

```shell
./my_test --gtest_also_run_disabled_tests
```

### Stopping on First Failure

Use `--gtest_fail_fast` to halt test execution immediately after a failure.

---

## 4. Organizing Tests at Scale

### Group Related Tests into Suites

Use test suites to group logically related tests; this organization mirrors your code's groups or modules, improving readability and maintainability.

### Shared Fixtures for Efficiency

Use test fixtures with static members and `SetUpTestSuite()`/`TearDownTestSuite()` to share expensive resources across multiple tests within a suite.

```cpp
class ExpensiveTest : public testing::Test {
 protected:
  static void SetUpTestSuite() {
    shared_resource = new ExpensiveResource();
  }
  static void TearDownTestSuite() {
    delete shared_resource;
  }

  static ExpensiveResource* shared_resource;
};

ExpensiveResource* ExpensiveTest::shared_resource = nullptr;
```

### Test Sharding

GoogleTest supports running subsets of tests in parallel on multiple machines using:

- `GTEST_TOTAL_SHARDS`: total machine count.
- `GTEST_SHARD_INDEX`: current machine index.

Tests are automatically distributed based on these environment variables, enabling faster test execution.

---

## 5. Advanced Test Suite Techniques

### Parameterized Tests

When running the same test logic with different data or configurations, use value-parameterized or typed tests (defined with `TEST_P` and `TYPED_TEST`). These tests belong to suites and can be instantiated with different parameters.

Example with `TEST_P`:

```cpp
class FooTest : public ::testing::TestWithParam<int> {};

TEST_P(FooTest, HandlesValue) {
  int param = GetParam();
  EXPECT_GT(param, 0);
}

INSTANTIATE_TEST_SUITE_P(PositiveValues, FooTest, testing::Values(1,2,3));
```

### Dynamically Registering Tests

For test cases that cannot be fixed at compile-time, use `RegisterTest` API to register tests dynamically before running.

---

## 6. Tips and Common Pitfalls

- Always return the value of `RUN_ALL_TESTS()` from your `main()` function.
- Avoid underscores `_` in test suite and test names.
- Use test fixtures (`TEST_F`) for shared setup across tests.
- Remember that each test runs with a new instance of the fixture class.
- Use `GTEST_SKIP()` when you need to skip tests dynamically based on runtime conditions.

<Checklist>
- Name your test suites carefully to reflect code structure.
- Share expensive resources via static members and suite-level setup/teardown.
- Use command-line filters to efficiently run test subsets.
- Avoid disabling tests for long periods; fix or delete broken tests.
</Checklist>

---

## 7. Troubleshooting Test Suites

<AccordionGroup title="Common Issues with Test Suites">
<Accordion title="Tests Not Running as Expected">
Check that your test suite and test names do not contain any underscores or reserved prefixes such as `DISABLED_`. Also confirm that your `main()` properly calls `InitGoogleTest()` and returns the value of `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="Test Fixtures Not Working Correctly">
Make sure your fixture classes have default constructors. Ensure that `SetUp()` and `TearDown()` have the correct casing. For shared expensive data, use static members initialized in `SetUpTestSuite()`.
</Accordion>
<Accordion title="Filtering Tests Has No Effect">
Verify your filter syntax with `--gtest_filter=SuiteName.TestName`. Remember that filters are case-sensitive and support `*` and `?` wildcards.
</Accordion>
</AccordionGroup>

---

## 8. Additional Resources

- [GoogleTest Primer](primer.md) — Basic concepts and writing your first tests.
- [Writing Your First Unit Test](guides/core-testing-workflows/writing-your-first-test) — Practical guide on writing tests.
- [Parameterized Tests](guides/advanced-testing-patterns/parameterized-tests) — Learn about data-driven testing.
- [Test Macros and Assertions](api-reference/gtest-core-api/test-macros-and-assertions) — Reference for test writing macros.
- [Test Cases and Suites API](api-reference/gtest-core-api/test-case-and-suite-apis) — Detailed explanation of suite management.

---

By following this guide, you will be able to organize your tests in a structured, scalable manner using GoogleTest’s features, minimizing maintenance overhead and improving your testing workflow efficiency.
