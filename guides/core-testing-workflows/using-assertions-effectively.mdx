---
title: "Using Assertions Effectively"
description: "Guides users through the rich set of assertions in GoogleTest, covering equality, error, floating point, exception, and user-defined assertions. Provides advice on choosing fatal vs. non-fatal assertions for reliable test outcomes."
---

# Using Assertions Effectively

This guide helps you leverage the rich set of assertions available in GoogleTest to write clear, reliable, and maintainable tests. You will learn to choose the right assertion types for different scenarios including equality checks, error detection, floating point comparison, exception handling, and user-defined assertions. Additionally, guidance on selecting between fatal and non-fatal assertions ensures that your tests behave as intended and provide meaningful feedback.

---

## Workflow Overview

- **Task Description**: Use GoogleTest assertions to verify code correctness effectively, understanding their types and consequences.
- **Prerequisites**: Basic familiarity with GoogleTest test writing, including setting up test cases and test fixtures.
- **Expected Outcome**: Ability to select and apply appropriate assertions confidently, improving test reliability and expressiveness.
- **Time Estimate**: 15â€“30 minutes to review and practice.
- **Difficulty Level**: Intermediate

---

## 1. Understanding Assertions in GoogleTest

GoogleTest provides a comprehensive set of assertion macros to check program behavior in tests. Assertions come as pairs:

- `EXPECT_*`: Non-fatal failures that log the failure but allow the current test to continue.
- `ASSERT_*`: Fatal failures that immediately abort the current function (usually stopping the test).

Use streaming `<<` to add custom failure messages for clearer diagnostics.

### Categories of Assertions

| Category              | Description                                                                                              |
|-----------------------|----------------------------------------------------------------------------------------------------------|
| Equality Assertions   | Check equality, inequality, and relation between values (e.g., `EXPECT_EQ`, `EXPECT_NE`, `EXPECT_LT`).  |
| Error Assertions      | Explicitly signal success or failure (`SUCCEED()`, `FAIL()`, `ADD_FAILURE()`).                            |
| Floating Point Compare| Approximate equality for floating point values (`EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, `EXPECT_NEAR`). |
| Exception Assertions | Verify exception throwing behavior (`EXPECT_THROW`, `EXPECT_ANY_THROW`, `EXPECT_NO_THROW`).               |
| Predicate Assertions | Use custom or parameterized predicates for complex conditions (`EXPECT_PRED*`, `EXPECT_PRED_FORMAT*`).    |
| String Comparison     | Specialized assertions for C-string equality and inequality (`EXPECT_STREQ`, `EXPECT_STRNE`, etc.).      |

---

## 2. Choosing Between Fatal and Non-Fatal Assertions

### When to Use `EXPECT_` (Non-Fatal)
- Allows the test function to continue even if the assertion fails.
- Useful when multiple assertions need to run for full diagnostic information.
- Ideal for checking multiple conditions independently.

### When to Use `ASSERT_` (Fatal)
- Aborts the current function on failure, preventing further execution.
- Critical when subsequent test code depends on the assertion's success.
- Use to guard against invalid preconditions or setup failures.

**Best Practice:** 
- Use `ASSERT_` when failure makes the current test function invalid or unstable.
- Use `EXPECT_` where continuing the test provides additional useful feedback.

---

## 3. Using Equality Assertions Effectively

GoogleTest offers specialized macros for comparing values of different types.

### Basic Equality and Inequality

```cpp
EXPECT_EQ(expected_value, actual_value);   // Passes if expected_value == actual_value
ASSERT_NE(value1, value2);                  // Passes if value1 != value2
```

### Note on String Pointers
- For comparing C strings (`const char*`), use `EXPECT_STREQ` or `EXPECT_STRNE`, since `EXPECT_EQ` compares pointers, not contents.

### Relational Operators

```cpp
EXPECT_LT(val1, val2);  // val1 < val2
EXPECT_GE(val1, val2);  // val1 >= val2
// Similarly, EXPECT_LE, EXPECT_GT
```

- These assertions clarify intent and improve test readability.

---

## 4. Floating Point Assertions

Due to rounding errors, direct equality (`EXPECT_EQ`) is unreliable for floating point types.

Use specialized assertions:

- `EXPECT_FLOAT_EQ(val1, val2)`: compares two `float`s approximately equal within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)`: similarly for `double`s.
- `EXPECT_NEAR(val1, val2, abs_error)`: verifies absolute difference does not exceed `abs_error`.

### Example:

```cpp
float a = 0.1f + 0.2f;
float b = 0.3f;
EXPECT_FLOAT_EQ(a, b);  // Passes even if a != b exactly due to rounding
```

---

## 5. Exception Assertions

Verify that code throws or does not throw expected exceptions.

### Common Macros:

- `EXPECT_THROW(statement, exception_type)`: statement throws specified exception.
- `EXPECT_ANY_THROW(statement)`: statement throws any exception.
- `EXPECT_NO_THROW(statement)`: statement does not throw.

### Usage:

The statement can be a compound statement enclosed in `{}`.

```cpp
EXPECT_THROW({ funcThatShouldThrow(); }, std::runtime_error);
EXPECT_NO_THROW({ funcThatShouldNotThrow(); });
```

---

## 6. Predicate Assertions

For complex conditions not expressible as simple Boolean expressions.

### Using `EXPECT_PREDn`

```cpp
bool IsPositive(int n) { return n > 0; }
EXPECT_PRED1(IsPositive, value);
```

- Supports 1 to 5 arguments.

### Using `EXPECT_PRED_FORMATn`
- Allows you to provide custom assertion formatting.
- Predicate formatters receive expressions as strings to produce detailed failure messages.

---

## 7. User-Defined and Custom Assertions

GoogleTest is extensible with user-defined assertions for domain-specific validation.

- Use custom matcher classes or macros (`MATCHER`, `MATCHER_P`) for predicate-based checks.
- For example, a matcher checking if a value is divisible by 7:

```cpp
MATCHER(IsDivisibleBy7, "") { return (arg % 7) == 0; }
EXPECT_THAT(num, IsDivisibleBy7());
```

- This creates highly expressive, readable assertions with clear failure messages.

---

## 8. Streaming Custom Failure Messages

Add context to any assertion by streaming messages to the assertion. This message is displayed if the assertion fails.

```cpp
EXPECT_TRUE(isReady) << "Expected readiness but was false";
EXPECT_EQ(expected, actual) << "Mismatch in output size";
```

- Use this feature to clarify failures with additional domain information.

---

## 9. Practical Tips and Best Practices

- Prefer `EXPECT_` unless a failure makes further test steps invalid, then use `ASSERT_`.
- Use type-specific assertions for clarity and correctness (e.g., `EXPECT_STREQ` for strings).
- Use floating-point assertions to avoid brittle floating-point comparisons.
- For exception tests, verify the specific exception thrown.
- Avoid over-constraining tests by asserting only what matters to the test intent.

---

## 10. Troubleshooting Common Issues

### Unexpected Test Abort
- Check if `ASSERT_` is used where only warnings were intended.
- Replace with `EXPECT_` if you want the test to proceed after failure.

### Assertion Not Triggered
- Confirm that expressions and values are as expected.
- Consider enabling verbose test output or logging.

### Floating Point Mismatch
- Use `EXPECT_NEAR` with an appropriate tolerance.

### Exception Not Caught
- Ensure exceptions are enabled in your build environment.
- Verify the exact exception type in test.

---

## Next Steps & Related Content

- Explore [Writing and Structuring Tests](../core-testing-workflows/writing-and-structuring-tests) to apply assertions effectively.
- Review the [Assertions and Expectations API Reference](../../api-reference/core-testing-apis/assertions) for detailed macro descriptions.
- Learn to write parameterized assertions and custom matchers for more specialized testing needs.
- Consider using GoogleMock for interaction-based behavior verification when working with dependencies.

---

## Additional Resources
- [GoogleTest Assertions Reference](../reference/assertions.md)
- [Matchers Reference](../reference/matchers.md)
- [gMock Cookbook: Using ON_CALL and EXPECT_CALL](../gmock_cook_book.md#UseOnCall)


---

*This page focuses solely on using GoogleTest assertions efficiently and confidently, empowering you to write robust tests that catch bugs early and provide meaningful feedback.*
