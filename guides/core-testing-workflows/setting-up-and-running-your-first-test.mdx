---
title: "Setting Up and Running Your First Test"
description: "Walks users through installing GoogleTest/GoogleMock, integrating with their build system (CMake, Bazel), and writing and running their very first unit test. Emphasizes quick success and build verification."
---

# Setting Up and Running Your First Test

This guide walks you through the essential steps to **install GoogleTest/GoogleMock**, integrate it into your build system (either CMake or Bazel), and write and run your very first unit test. It emphasizes achieving quick success by verifying the build and running tests promptly.

---

## Table of Contents

1. [Workflow Overview](#workflow-overview)
2. [Installing GoogleTest and GoogleMock](#installing-googletest-and-googlemock)
3. [Integrating GoogleTest with Your Build System](#integrating-googletest-with-your-build-system)
4. [Writing Your First GoogleTest Unit Test](#writing-your-first-googletest-unit-test)
5. [Building and Running Your Test](#building-and-running-your-test)
6. [Verifying the Test Run and Understanding the Output](#verifying-the-test-run-and-understanding-the-output)
7. [Troubleshooting Common Issues](#troubleshooting-common-issues)
8. [Best Practices and Tips](#best-practices-and-tips)
9. [Next Steps and Related Documentation](#next-steps-and-related-documentation)

---

## Workflow Overview

- **Task Description:** Get GoogleTest and GoogleMock installed, linked properly in your C++ project using CMake or Bazel, write the simplest unit test, and confirm it builds and runs.
- **Prerequisites:** 
  - A working C++17 development environment
  - Familiarity with your projectâ€™s build system (CMake or Bazel)
  - Access to GoogleTest source or installed libraries
- **Expected Outcome:** A minimal GoogleTest program linked with your build system that compiles and successfully runs a simple unit test.
- **Time Estimate:** 10-30 minutes
- **Difficulty Level:** Beginner

---

## Installing GoogleTest and GoogleMock

GoogleTest includes both GoogleTest and GoogleMock, and they often come together.

### Quick Steps

1. Clone the GoogleTest repository:

   ```bash
   git clone https://github.com/google/googletest.git -b main
   cd googletest
   ```

2. Build using CMake for standalone use:

   ```bash
   mkdir build && cd build
   cmake ..    # Includes GoogleMock by default
   make
   sudo make install
   ```

3. Alternatively, disable GoogleMock if not needed:

   ```bash
   cmake .. -DBUILD_GMOCK=OFF
   ```

> GoogleMock depends on GoogleTest internally, so initializing GoogleMock also initializes GoogleTest.

---

## Integrating GoogleTest with Your Build System

### Using CMake

1. If GoogleTest is installed on your system or built as a subproject, your `CMakeLists.txt` can locate it using `find_package`:

   ```cmake
   find_package(GTest CONFIG REQUIRED)
   
   add_executable(my_tests test1.cpp test2.cpp)
   target_link_libraries(my_tests GTest::gtest_main)  # Use gtest_main for auto main()
   add_test(NAME my_tests COMMAND my_tests)
   ```

2. If embedding GoogleTest source code:

   ```cmake
   add_subdirectory(path/to/googletest)
   
   add_executable(my_tests test1.cpp)
   target_link_libraries(my_tests gtest_main gmock_main) # link GoogleTest & GoogleMock
   add_test(NAME my_tests COMMAND my_tests)
   ```

### Using Bazel

1. Add GoogleTest and GoogleMock to your `WORKSPACE` and `BUILD` files.
2. Define test targets that depend on GoogleTest/Bazel rules.
3. Use Bazel commands to build and run tests.

Refer to the [Installation with Bazel](https://github.com/google/googletest/blob/main/docs/installation-bazel.mdx) guide for detailed, step-by-step instructions.

---

## Writing Your First GoogleTest Unit Test

To experience GoogleTest immediately, write the simplest test case.

### Example: A simple factorial function test

Suppose you have this factorial function:

```c++
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}
```

### Writing a test

Create `factorial_test.cpp` with the following content:

```c++
#include <gtest/gtest.h>

// Tests factorial of zero.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Tests factorial of positive numbers.
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

### Notes:
- Use `TEST(TestSuiteName, TestName)` macros.
- The first argument groups related tests.
- `EXPECT_EQ` is a non-fatal assertion comparing expected and actual values.

---

## Building and Running Your Test

### Using CMake

1. If you linked against `gtest_main` or `gmock_main`, GoogleTest provides a `main()` function for you.

2. Build your test executable as usual with CMake:

   ```bash
   mkdir build && cd build
   cmake ..
   make
   ./my_tests
   ```

### Using Bazel

```bash
bazel test //path/to:my_tests
```

### Writing Custom main() (Optional)

If you want custom behavior before/after tests, write your own `main()`:

```c++
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Note: The `InitGoogleTest()` call parses relevant flags; you must call it before running tests.

---

## Verifying the Test Run and Understanding the Output

When you run your test executable, the output groups results by test suite with statuses like `[RUN]`, `[ OK ]`, or `[FAILED]`.

Sample output for the factorial tests:

```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)
[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

- `[==========]` marks start/end of all tests.
- `[ RUN      ]` shows a test started.
- `[       OK ]` indicates a passed test.
- Failures (if any) are detailed with file names, line info, and messages.

---

## Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Your First Test">
<Accordion title="Test Does Not Compile or Link">
Ensure GoogleTest libraries and headers are correctly included and linked. If using CMake, confirm `find_package` or `add_subdirectory` is correctly set.
</Accordion>
<Accordion title="main() Linking Errors">
Use `gtest_main` or `gmock_main` to link a default `main()` function. Alternatively, write your own `main()` as shown in this guide.
</Accordion>
<Accordion title="Test Does Not Run or No Output Appears">
Confirm you call `RUN_ALL_TESTS()` in `main()`. Make sure `InitGoogleTest()` is called first.
</Accordion>
<Accordion title="Tests Fail Unexpectedly">
Check your assertions for correctness. Use `EXPECT_*` for non-fatal and `ASSERT_*` for fatal failures as appropriate.
</Accordion>
<Accordion title="Build System Integration Issues">
Review build logs and dependency links. Clean and rebuild if necessary. Check platform compatibility and compiler support (C++17 required).
</Accordion>
</AccordionGroup>

> For more detailed troubleshooting, consult the [Validate Setup](../getting-started/validation-troubleshooting/validate-setup.mdx) and [Troubleshooting Common Issues](../getting-started/validation-troubleshooting/common-issues.mdx) guides.

---

## Best Practices and Tips

- **Link with `gtest_main` or `gmock_main`** to avoid writing boilerplate main functions.
- Use `TEST_F` and test fixtures to reuse common setup code when testing complex classes.
- Name test suites and tests using the same conventions as your production code (no underscores, use CamelCase).
- Call `RUN_ALL_TESTS()` once per test program, and return its result from `main()`.
- Use non-fatal assertions (`EXPECT_*`) to allow multiple checks per test.
- Use `SCOPED_TRACE` to add context for failures inside helper functions.

---

## Next Steps and Related Documentation

- Explore [Writing and Running Your First Test](../getting-started/configuration-bootstrap/first-test-case.mdx) for more about test definitions.
- Learn about [Project Setup and Configuration](../getting-started/configuration-bootstrap/project-setup.mdx) for build integration.
- Deepen understanding with the [GoogleTest Primer](../docs/primer.mdx).
- Investigate [Using Assertions Effectively](../guides/core-testing-workflows/using-assertions-effectively.md) to write robust tests.
- Explore mocking with [Introduction to Mocking](../guides/mocking-and-behavior-verification/introduction-to-mocking.md).

---

This guide sets you on a solid path to confidently **set up and run your first GoogleTest test**, a crucial foundation to mastering C++ testing with GoogleTest and GoogleMock.

---

<Check>
Ensure your build environment meets the [System Requirements](../../getting-started/requirements-installation/system-requirements.mdx) before proceeding.
</Check>

---

### Sample Minimal Test File (factorial_test.cpp)

```c++
#include <gtest/gtest.h>

int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run this test executable to verify your setup.

---

### Minimal CMakeLists.txt Example

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTestProject CXX)

find_package(GTest CONFIG REQUIRED)

add_executable(factorial_test factorial_test.cpp)

target_link_libraries(factorial_test GTest::gtest_main)
add_test(NAME factorial_test COMMAND factorial_test)
```

Ensure you have GoogleTest installed or configured as a subproject.

---

### Minimal Bazel BUILD Example

```bazel
cc_test(
    name = "factorial_test",
    srcs = ["factorial_test.cpp"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

Run with `bazel test //:factorial_test`.

---

### How GoogleTest Handles main()

- GoogleTest provides `gtest_main` and `gmock_main` libraries that implement a `main()` function.
- `testing::InitGoogleTest()` initializes test framework internals.
- `RUN_ALL_TESTS()` runs all registered tests and returns pass/fail status.

---

### Additional Info

- When GoogleMock is used, call `testing::InitGoogleMock()` in your `main()`. It internally calls `InitGoogleTest()`.
- On Arduino-like platforms, GoogleTest hooks into `setup()` and `loop()`.

---

### Sample Output Explanation

After running your tests, you see lines indicating test progress and success/failure. Successfully running tests return `0` from `main()`, indicating no failures.

---

Thank you for starting your testing journey!