---
title: "Writing Your First Unit Test"
description: "A beginner-friendly walkthrough for setting up GoogleTest, creating your first test, compiling, and running it. Learn the key steps to get started with writing and executing tests for your C++ code."
---

# Writing Your First Unit Test

A beginner-friendly walkthrough for setting up GoogleTest, creating your first test, compiling, and running it. Learn the key steps to get started with writing and executing tests for your C++ code.

---

## 1. Getting Started: Overview of Your First Unit Test

- **What you'll achieve:**
  - Set up GoogleTest in your C++ project
  - Write a basic unit test
  - Compile and run the test executable

- **Prerequisites:**
  - A working C++17 or later compiler (GCC, Clang, MSVC)
  - Basic knowledge of C++ syntax
  - GoogleTest installed or source included in your project

- **Expected outcome:**
  - A simple C++ program compiled with a unit test that runs and reports success or failure

- **Time investment:** Approximately 10-20 minutes

- **Skill level:** Beginner

---

## 2. Step-By-Step Instructions

Follow these steps to create your first unit test.

### Step 1: Include GoogleTest Headers

In your test source file, include the GoogleTest header:

```cpp
#include <gtest/gtest.h>
```

This header provides all the necessary testing macros and classes.

### Step 2: Write a Simple Test Case

Use the `TEST` macro to define a test function. It takes two parameters: the *test suite name* and the *test name*.

Example - testing a simple addition function:

```cpp
int Add(int a, int b) {
  return a + b;
}

TEST(AdditionTest, WorksForPositiveNumbers) {
  EXPECT_EQ(Add(3, 4), 7);
  EXPECT_EQ(Add(1, 1), 2);
}
```

- `TEST` defines the test under the suite `AdditionTest` with the name `WorksForPositiveNumbers`.
- `EXPECT_EQ` checks if the first argument equals the second.

### Step 3: Create `main()` Function to Run Tests

If you do not link against the `gtest_main` library that supplies one, you must write a main function to run your tests:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This initializes GoogleTest and runs all tests registered.

### Step 4: Compile Your Test

Compile your test program by linking to GoogleTest.

Example using `g++` assuming GoogleTest installed system-wide:

```bash
g++ -std=c++17 -isystem /usr/include/gtest -pthread my_test.cc -lgtest -lgtest_main -o my_test
```

- Replace `/usr/include/gtest` with the correct path for your environment.
- Link with `-lgtest` and `-lgtest_main` to include GoogleTest libraries.

### Step 5: Run Your Test Executable

Execute your test program:

```bash
./my_test
```

You will see output summarizing the test results:

```
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from AdditionTest
[ RUN      ] AdditionTest.WorksForPositiveNumbers
[       OK ] AdditionTest.WorksForPositiveNumbers (0 ms)
[----------] 1 test from AdditionTest (0 ms total)
[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

If any assertion fails, it will be reported with the source location.

---

## 3. Practical Tips and Best Practices

- **Test Granularity:** Aim for small focused tests that verify a single logical operation.
- **Naming:** Use meaningful test and suite names reflecting behavior, e.g., `AdditionTest` and `WorksForNegativeNumbers`.
- **Assertions:** Prefer `EXPECT_*` to allow multiple checks and better failure context.
- **Compilation:** Use modern C++ flags and enable warnings to catch mistakes early.
- **Linking:** Ensure GoogleTest libraries (`libgtest` and `libgtest_main`) are correctly linked.

<Note>
If you link to the `gtest_main` library, it already provides a main() function, so you don't need to define one yourself.
</Note>

---

## 4. Example: Full Minimal Test Program

```cpp
#include <gtest/gtest.h>

int Add(int a, int b) {
  return a + b;
}

TEST(AdditionTest, AddsPositiveNumbers) {
  EXPECT_EQ(Add(2, 3), 5);
  EXPECT_EQ(Add(7, 0), 7);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile and run as described earlier.

---

## 5. Troubleshooting Common Issues

### Problem: Test binary won't link or `InitGoogleTest` undefined

**Cause:** The GoogleTest library or headers are not linked or included.

**Solution:** Check your include paths and link flags. If using CMake, link to `gtest` and `gtest_main` libraries.

### Problem: Tests run but show "No tests found"

**Cause:** Tests are not registered properly, possibly due to wrong test macro usage or missing initialization.

**Solution:** Ensure you have called `::testing::InitGoogleTest(&argc, argv)` before running tests. Confirm you used `TEST` or `TEST_F` macros correctly.

### Problem: Compilation errors related to GoogleTest macros

**Cause:** Missing `#include <gtest/gtest.h>`, or out-of-date compiler.

**Solution:** Include the correct header before using test macros and confirm compiler supports at least C++11, preferably C++17.

### Problem: Linking errors related to pthread

**Cause:** GoogleTest depends on pthread on POSIX systems but it's not linked.

**Solution:** Add `-pthread` to compiler and linker commands.

---

## 6. Next Steps & Related Documentation

- Explore [GoogleTest Primer](../../getting-started/first-steps/configure-project.md) for detailed setup instructions.
- Learn about [Writing and Running Your First Test](../../getting-started/first-steps/write-first-test.md) for more examples.
- Deep dive into [gMock for Dummies](../gmock_for_dummies.md) to understand mocking basics.
- Use [gMock Cookbook](../gmock_cook_book.md) for advanced mocking recipes.
- Refer to [Troubleshooting Common Issues](../../getting-started/first-steps/troubleshooting.md) if you hit roadblocks.

---

## 7. Additional Resources

- [GoogleTest official GitHub repository](https://github.com/google/googletest)
- [GoogleTest User's Guide](../../index.md)
- [GoogleTest and GoogleMock API Reference](../../api-reference/)

---

With this guide, you have all the essential steps to write your first unit test using GoogleTest, compile it, and verify that your code behaves correctly through automated testing. Start small, build confidence, and gradually explore mocks and more advanced testing patterns.
