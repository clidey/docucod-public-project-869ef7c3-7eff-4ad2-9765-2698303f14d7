---
title: "Assertions: Verifying Test Outcomes"
description: "Dive into the wide range of assertions available in GoogleTest, from simple equality checks to exception assertions. Understand when to use fatal and non-fatal assertions, and tips for writing clear, actionable test failures."
---

# Assertions: Verifying Test Outcomes

GoogleTest provides a comprehensive set of assertion macros to verify the behavior of your code during tests. This page dives into these assertions, explaining their usage from simple checks to advanced exception assertions. You'll learn when to choose fatal (`ASSERT_`) over non-fatal (`EXPECT_`) assertions and how to write clear, actionable failure messages.

---

## 1. Understanding Assertions in GoogleTest

### What are Assertions?
Assertions are statements that verify a condition during your test execution. They help determine whether the test passes or fails based on code behavior.

- **Fatal assertions (`ASSERT_*`)** abort the current function execution on failure.
- **Non-fatal assertions (`EXPECT_*`)** report failures but allow the test function to continue.

Use **`EXPECT_*`** when you want to check multiple conditions in one test and still see all failures.
Use **`ASSERT_*`** when continuing after a failed condition would be meaningless or could cause crashes.

### Adding Custom Failure Messages
Stream additional information after an assertion using the `<<` operator for more context:

```cpp
ASSERT_EQ(x, y) << "Mismatch found in vector size.";
EXPECT_TRUE(ptr != nullptr) << "Pointer must not be null.";
```


---

## 2. Types of Assertions and Their Use

### 2.1 Explicit Success and Failure
- `SUCCEED()` — Marks an explicit success point (does not mark overall test success).
- `FAIL()` — Generates an immediate fatal failure to abort current function.
- `ADD_FAILURE()` — Adds a nonfatal failure to continue execution.

Use explicit failure/assertion macros when you want to control test flow or report unexpected branches.

### 2.2 Boolean Conditions
- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` — Checks if condition evaluates to true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` — Checks if condition evaluates to false.

Example:

```cpp
EXPECT_TRUE(IsValidFoo(foo)) << "Foo is not valid.";
ASSERT_FALSE(hasErrors) << "Errors present, aborting test.";
```

### 2.3 Binary Comparisons
- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — Checks equality (`==`). Use `EXPECT_STREQ` for C strings.
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — Checks inequality (`!=`). Use `EXPECT_STRNE` for C strings.
- Less-than / greater-than variants: `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE` and their `ASSERT_*` counterparts.

Example:

```cpp
ASSERT_EQ(computedValue, expectedValue) << "Computation did not match expected result.";
EXPECT_LT(timeout, 1000) << "Timeout is too long.";
```

### 2.4 String Comparisons (C Strings and Wide Strings)
- `EXPECT_STREQ` / `ASSERT_STREQ` — Compare C strings for equality.
- `EXPECT_STRNE` / `ASSERT_STRNE` — Compare C strings for inequality.
- Case-insensitive variants: `EXPECT_STRCASEEQ`, `EXPECT_STRCASENE`.

Example:

```cpp
EXPECT_STREQ(output, "expected output") << "Output mismatch.";
```

### 2.5 Floating-Point Comparisons
Due to rounding errors, exact equality checks are not suitable for floats/doubles.

- `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ` — Check if `float` values are approximately equal (within 4 ULPs).
- `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ` — Same for `double` values.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR` — Check if difference between `val1` and `val2` stays within `abs_error`.

Example:

```cpp
EXPECT_DOUBLE_EQ(calculatedValue, expectedValue) << "Floating point mismatch.";
EXPECT_NEAR(measured, expected, 0.01) << "Measurement out of bounds.";
```

### 2.6 Exception Assertions (Requires Exceptions Enabled)
- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW` — Verifies that statement throws a specific exception.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW` — Verifies that statement throws any exception.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW` — Verifies that statement does not throw.

Example:

```cpp
EXPECT_THROW(ProcessInvalidInput(), std::invalid_argument);
EXPECT_NO_THROW(ProcessValidInput());
```


---

## 3. Advanced Assertions

### 3.1 Using Predicates for Better Failure Messages
When complex conditions must be verified beyond simple Boolean expressions,
GoogleTest provides predicate assertions:

- `EXPECT_PRED1`, `EXPECT_PRED2`, ..., `EXPECT_PRED5`
- `ASSERT_PRED_FORMAT1`, ..., `ASSERT_PRED_FORMAT5`

These allow you to use functions or functors returning `bool` or `AssertionResult` to
check custom conditions and produce rich error messages on failure.

Example:

```cpp
bool IsPrime(int n);
...
EXPECT_PRED1(IsPrime, value) << "Value " << value << " is not prime.";

AssertionResult AssertIsEven(const char* expr, int n) {
  if (n % 2 == 0) return AssertionSuccess();
  return AssertionFailure() << n << " is odd.";
}
EXPECT_PRED_FORMAT1(AssertIsEven, x);
```

### 3.2 Death Assertions
GoogleTest supports testing that certain code causes termination or abnormal exits:

- `EXPECT_DEATH(statement, regex)` / `ASSERT_DEATH` — Verifies program dies with output matching `regex`.
- `EXPECT_DEATH_IF_SUPPORTED` — Like above but conditional on platform support.
- `EXPECT_DEBUG_DEATH` — Death check only in debug builds.
- `EXPECT_EXIT(statement, predicate, regex)` — Checks exit status matches predicate and output matches.

Example:

```cpp
EXPECT_DEATH(FunctionThatAborts(), "fatal error message");
EXPECT_EXIT(ProcessExit(), ::testing::ExitedWithCode(0), "Success");
```

Refer to [Death Tests](../advanced.md#death-tests) to understand behavior, limitations, and best practices.

### 3.3 HRESULT Assertions (Windows Only)
These assertions check the result of `HRESULT` expressions:

- `EXPECT_HRESULT_SUCCEEDED(expression)` / `ASSERT_HRESULT_SUCCEEDED`
- `EXPECT_HRESULT_FAILED(expression)` / `ASSERT_HRESULT_FAILED`

Example:

```cpp
ASSERT_HRESULT_SUCCEEDED(someComObject->Initialize());
```


---

## 4. Assertion Placement and Execution Behavior

- Use assertions in void functions only when using fatal assertions (`ASSERT_*` and `FAIL()`) as they abort the current function.
- Constructors and destructors cannot contain fatal assertions.
- If fatal assertion failure inside a subroutine should abort the entire test, consider:
  - Using exception handling (see advanced guide).
  - Using `ASSERT_NO_FATAL_FAILURE` to wrap subroutine calls.
  - Checking `HasFatalFailure()` after subroutine execution.

### Using Scoped Traces
To add context when assertions fail inside subroutines, use `SCOPED_TRACE()` or `testing::ScopedTrace`:

```cpp
SCOPED_TRACE("Iter: " << i);
EXPECT_EQ(actual, expected);
```


---

## 5. Best Practices for Writing Assertions

- Prefer `EXPECT_*` unless continuing after failure makes no sense.
- Use clear, concise custom failure messages with meaningful info.
- Choose the appropriate assertion for the data type (e.g., `EXPECT_STREQ` for C strings).
- For floating point, use approximate comparison macros to avoid false failures.
- Use predicate assertions to verify complex conditions with informative messages.
- Leverage death assertions to verify fatal error handling.
- Keep assertions atomic and focused on one thing.
- Avoid over-constraining expectations when using mocks—check only what matters.


---

## 6. Example: Writing Assertions in a Test

```cpp
#include <gtest/gtest.h>

// Test suite: MathTests
// Tests that factorial function computes correctly.
TEST(MathTests, HandlesPositiveInput) {
  int result = Factorial(5);
  ASSERT_GT(result, 0) << "Factorial result should be positive.";
  EXPECT_EQ(result, 120) << "Factorial of 5 should be 120.";

  double approx_pi = 3.1415;
  EXPECT_NEAR(approx_pi, 3.14159, 0.001) << "Pi approximation is off.";
}

// Test suite: ExceptionTests
// Checks that invalid input throws exception.
TEST(ExceptionTests, ThrowsInvalidArgument) {
  EXPECT_THROW({
    ValidateInput(-1);
  }, std::invalid_argument);
}
```

---

## 7. Troubleshooting Common Assertion Issues

### Failing String Comparisons
- Ensure C strings are compared using `EXPECT_STREQ` or `ASSERT_STREQ`.
- Use `EXPECT_STRNE` to check inequality.
- For case insensitive compare, use `EXPECT_STRCASEEQ` and `EXPECT_STRCASENE`.

### Floating-Point Precision Failures
- Avoid using `EXPECT_EQ` on floats or doubles.
- Use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR` with an appropriate error margin.

### Unexpected Termination in Death Tests
- Confirm death tests are supported on your platform.
- Use correct `EXPECT_DEATH` syntax: code block plus expected regex.
- Make sure the tested code does actually terminate.

### Fatal Assertion in Non-void Function Compilation Errors
- Fatal assertions (`ASSERT_*`) can only be used in functions returning void.
- Consider refactoring non-void functions or use non-fatal assertions instead.

### Assertions Evaluating Arguments Multiple Times
- Assertions evaluate their arguments exactly once, but side-effecting expressions might mislead.
- Avoid side effects inside assertion arguments to prevent unexpected behaviors.

---

## 8. Next Steps & Related Documentation

- Explore the [Assertions Reference](reference/assertions.md) for detailed macro list and syntax.
- Learn about [Writing Your First Test](../guides/getting-started/writing-your-first-test) to see assertions in action.
- Understand [Test Structure and Discovery](../guides/getting-started/test-structure-and-discovery) to organize your assertions effectively.
- For complex check scenarios, see [Using Predicate Assertions](../docs/advanced.md#more-assertions).
- Familiarize yourself with [Mocking with GoogleMock](../guides/core-testing-workflows/mocking-with-googlemock) to combine assertions with mocks.

---