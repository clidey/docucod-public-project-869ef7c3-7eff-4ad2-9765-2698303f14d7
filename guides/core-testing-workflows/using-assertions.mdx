---
title: "Mastering Assertions"
description: "Explains the full suite of assertions available, including fatal and non-fatal checks, comparisons, floating point, string, and exception assertions, with tips for robust test design."
---

# Mastering Assertions in GoogleTest

This guide explains the full suite of assertions available in GoogleTest. You will learn about the variety of assertion macros that verify code correctness, including fatal vs non-fatal checks, comparisons for different data types, floating-point number assertions, string and exception assertions, along with effective tips for designing robust and maintainable tests.

---

## 1. Workflow Overview

### What This Guide Helps You Accomplish
- Understand all assertion macros provided by GoogleTest.
- Differentiate between fatal (`ASSERT_`) and non-fatal (`EXPECT_`) assertions.
- Apply appropriate assertions for booleans, comparisons, floating-point numbers, strings, exceptions, and predicates.
- Learn when and how to use each assertion type to improve test clarity and reliability.

### Prerequisites
- GoogleTest installed and correctly set up in your project.
- Basic familiarity with writing C++ tests using GoogleTest.

### Expected Outcome
By following this guide, you will know how to select and use the appropriate assertion macros to verify your program's behavior effectively, and write tests that provide clear, actionable failure messages.

### Time Estimate
Approximately 15-30 minutes to study and practice the assertions in your tests.

### Difficulty Level
Beginner to Intermediate

---

## 2. GoogleTest Assertions Explained

GoogleTest assertions come primarily in pairs that differ by their failure severity:
- **EXPECT_**: Non-fatal assertions allow the test to continue after failure.
- **ASSERT_**: Fatal assertions abort the current function immediately.

Both support streaming messages with `<<` for additional context.

### 2.1 Explicit Success and Failure

- `SUCCEED()`: Marks a success point in the test. It doesnâ€™t influence the overall test result but can clarify flow.
- `FAIL()`: Generates a fatal failure, aborting the current function.
- `ADD_FAILURE()`: Generates a non-fatal failure, allowing continuation.

```cpp
EXPECT_TRUE(condition) << "Custom failure message if false";
FAIL() << "Immediate failure triggered here";
SUCCEED(); // Marks a success explicitly.
```

### 2.2 Boolean Conditions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`: Verifies the condition is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`: Verifies the condition is false.

### 2.3 Binary Comparisons

Use these to compare values with familiar operators:

| Assertion       | Meaning                                   |
|-----------------|-------------------------------------------|
| `EXPECT_EQ(a,b)` / `ASSERT_EQ(a,b)` | Checks `a == b`. For pointers, compares addresses.
| `EXPECT_NE(a,b)` / `ASSERT_NE(a,b)` | Checks `a != b`.
| `EXPECT_LT(a,b)` / `ASSERT_LT(a,b)` | Checks `a < b`.
| `EXPECT_LE(a,b)` / `ASSERT_LE(a,b)` | Checks `a <= b`.
| `EXPECT_GT(a,b)` / `ASSERT_GT(a,b)` | Checks `a > b`.
| `EXPECT_GE(a,b)` / `ASSERT_GE(a,b)` | Checks `a >= b`.

**Note:** For C strings, these check pointer equality. Use string-specific assertions for content comparison.

### 2.4 String Comparisons

Specialized macros for comparing C-style strings and wide strings:

| Assertion           | Description                                |
|---------------------|--------------------------------------------|
| `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ` | Verifies strings have the same content.
| `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE` | Verifies strings have different content.
| `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ` | Case-insensitive content comparison.
| `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE` | Case-insensitive content inequality.

When comparing strings against `nullptr`, use `EXPECT_EQ(str, nullptr)` instead of comparing against `NULL`.

### 2.5 Floating-Point Assertions

Due to rounding issues, comparing floats or doubles for exact equality is unsafe. GoogleTest provides toleranced checks:

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ`: Checks float equality within 4 Units in Last Place (ULPs).
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ`: Same as above but for doubles.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR`: Checks if difference is within specified absolute error.

These assertions handle edge cases like infinities according to IEEE standards.

### 2.6 Exception Assertions

Use these to verify exception throwing behavior in your code.

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW`: Checks `statement` throws specified exception.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW`: Checks if `statement` throws any exception.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW`: Verifies `statement` does not throw exceptions.

Example:
```cpp
EXPECT_THROW({ MyFunc(); }, std::runtime_error);
EXPECT_NO_THROW({ SafeFunc(); });
```

### 2.7 Predicate Assertions

More complex predicates can be tested with clear failure messages:

- `EXPECT_PREDn(pred, val1, val2, ..., valn)` / `ASSERT_PREDn`: Invokes predicate with n values and expects `true`.
- `EXPECT_PRED_FORMATn(pred_formatter, ...)` / `ASSERT_PRED_FORMATn`: Uses a predicate formatter that can generate detailed failure messages.

Example:
```cpp
bool IsMutuallyPrime(int m, int n);
EXPECT_PRED2(IsMutuallyPrime, a, b);
```

### 2.8 Additional Useful Assertions

- `EXPECT_THAT(value, matcher)` / `ASSERT_THAT`: Uses matchers for expressive verification. Matchers can perform rich conditions and generate readable output.

Example:
```cpp
EXPECT_THAT(str, StartsWith("Hello"));
EXPECT_THAT(numbers, ElementsAre(1, 2, 3));
```

---

## 3. Practical Tips for Robust Test Design

- **Choose the right severity:** Use `EXPECT_` when you want test execution to continue after a failure (to catch multiple issues per run). Use `ASSERT_` when subsequent code depends on the success of the assertion.
- **Add clear failure messages:** Always append `<<` with human-readable context to help diagnose failures quickly.
- **For floating-point values:** Prefer `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ` or `EXPECT_NEAR` over generic equality.
- **Beware string type:** Use string-specific assertions for C strings to compare content, or use generic ones for `std::string`.
- **Test exceptions judiciously:** Wrap only the statement expected to throw inside the assertion's braces.
- **Use predicates and matchers:** They make assertions more expressive and failure messages more informative.
- **Avoid over-specification:** Only assert what's necessary to avoid brittle tests.

---

## 4. Examples 

### 4.1 Basic Boolean Assertion
```cpp
TEST(MathTest, SimpleTruth) {
  int x = 5;
  EXPECT_TRUE(x > 0) << "x should be positive";
}
```

### 4.2 Comparing Integers
```cpp
TEST(MathTest, Equality) {
  EXPECT_EQ(Add(2, 3), 5);
  ASSERT_NE(Subtract(5, 2), 4);
}
```

### 4.3 Floating-point Comparison
```cpp
TEST(FloatMathTest, ApproximateEquality) {
  double result = ComputeValue();
  EXPECT_NEAR(result, 3.1415, 0.0001);
}
```

### 4.4 String Comparison
```cpp
TEST(StringTest, CStyleStringCompare) {
  const char* a = "hello";
  const char* b = strdup("hello");
  EXPECT_STREQ(a, b);
  free((void*)b);
}
```

### 4.5 Exception Testing
```cpp
TEST(ExceptionTest, ThrowsOnBadInput) {
  EXPECT_THROW({ ProcessInput(nullptr); }, std::invalid_argument);
  EXPECT_NO_THROW({ ProcessInput(valid_input); });
}
```

### 4.6 Using EXPECT_THAT with Matchers
```cpp
TEST(ContainerTest, ContainsValues) {
  std::vector<int> v = {1, 2, 3};
  EXPECT_THAT(v, ::testing::ElementsAre(1, 2, 3));
}
```

### 4.7 Predicate Assertion
```cpp
bool IsEven(int n) { return n % 2 == 0; }

TEST(PredicateTest, EvenCheck) {
  EXPECT_PRED1(IsEven, 4);
  EXPECT_PRED1(IsEven, 5);  // Will fail
}
```

---

## 5. Troubleshooting & Tips

### Common Issues
- **Assertion fails unexpectedly:** Double-check the expected and actual values or exception types.
- **Tests abort on ASSERT_, but you want continuation:** Replace `ASSERT_` with `EXPECT_` where possible.
- **C string comparison mistakes:** Use `EXPECT_STREQ` and related string assertions instead of `EXPECT_EQ` for C strings.
- **Floating-point precision errors:** Use floating-point specific assertions instead of generic equality.

### Best Practices
- Write clear, meaningful custom failure messages.
- Isolate predicates and use `EXPECT_THAT` with matchers for expressive tests.
- Use `ASSERT_` only when test continuation makes no sense.
- Prefer `EXPECT_` where possible for comprehensive test coverage per run.
- Avoid testing implementation details; test external behavior.

---

## 6. Next Steps & Related Content

- Continue to [Writing Your First Test](../guides/getting-started/basic-test-workflow) to apply assertions in a real test.
- Explore the [Matchers Reference](reference/matchers.md) for advanced matching capabilities.
- Review [Mocking Techniques](../guides/mocking-techniques/creating-mocks) to combine assertions with mocks.
- Consult the [gMock Cookbook](gmock_cook_book.md) for advanced usage patterns and tips.

---

## References

- [GoogleTest Assertions Reference](reference/assertions.md)
- [GoogleMock Mocking Reference](reference/mocking.md)
- [gMock for Dummies](gmock_for_dummies.md) - an introduction to mocking
- [gMock Cheat Sheet](gmock_cheat_sheet.md) - summary of mock related macros
- [GoogleTest Primer](primer.md) - basic guidance

---

<Info>
This page focuses exclusively on assertion macros in GoogleTest to verify test outcomes. For mocking-related testing workflows, see the guides on mocking techniques.
</Info>
