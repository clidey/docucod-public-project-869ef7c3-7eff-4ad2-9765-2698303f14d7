---
title: "Assertions: Verifying Program Behavior"
description: "Deep dive into GoogleTest's assertion macros and how to choose the right assertion for your scenario. Includes examples of equality, floating-point, exception, death, and custom assertions."
---

# Assertions: Verifying Program Behavior

This guide provides a detailed exploration of GoogleTest's assertion macros, which are essential tools for verifying that your code behaves as expected. Whether you're checking simple equality, complex conditions, exceptions, or special cases like pointer comparisons, these assertions help you write effective and maintainable tests.

---

## Overview

GoogleTest offers a rich set of assertion macros designed to simplify and empower the process of testing C++ code. These macros come primarily in two forms:

- `EXPECT_*`: Generate **nonfatal failures** and allow the current function to continue executing.
- `ASSERT_*`: Generate **fatal failures** and abort the current function immediately.

Use the appropriate form based on whether test execution should continue after failure.

All assertions support streaming custom failure messages for more detailed diagnostics.

---

## Explicit Success and Failure

Sometimes you want to explicitly mark a test path as successful or failed without checking an expression.

### SUCCEED

- **Syntax:** `SUCCEED();`
- Generates a success signal. It doesn't force the overall test to pass but can document intentional success.

### FAIL

- **Syntax:** `FAIL();`
- Generates a fatal failure that aborts the current function. Can only be used in `void` functions.

### ADD_FAILURE

- **Syntax:** `ADD_FAILURE();`
- Generates a nonfatal failure, allowing continued execution.

### ADD_FAILURE_AT

- **Syntax:** `ADD_FAILURE_AT(file_path, line_number);`
- Generates a nonfatal failure at the specified source location.

---

## Boolean Assertions

These assertions verify simple logical conditions.

### EXPECT_TRUE / ASSERT_TRUE

- **Syntax:** `EXPECT_TRUE(condition);` or `ASSERT_TRUE(condition);`
- Passes if *condition* evaluates to `true`.

### EXPECT_FALSE / ASSERT_FALSE

- **Syntax:** `EXPECT_FALSE(condition);` or `ASSERT_FALSE(condition);`
- Passes if *condition* evaluates to `false`.

**Example:**

```cpp
EXPECT_TRUE(is_valid) << "Input should be valid.";
ASSERT_FALSE(has_error) << "No errors expected here.";
```

---

## Binary Comparison Assertions

Use these to compare two values with common operators. Arguments support streaming for failure messages.

| Assertion | Meaning                           |
| --------- | -------------------------------- |
| `EXPECT_EQ` / `ASSERT_EQ` | `val1 == val2`           |
| `EXPECT_NE` / `ASSERT_NE` | `val1 != val2`           |
| `EXPECT_LT` / `ASSERT_LT` | `val1 < val2`            |
| `EXPECT_LE` / `ASSERT_LE` | `val1 <= val2`           |
| `EXPECT_GT` / `ASSERT_GT` | `val1 > val2`            |
| `EXPECT_GE` / `ASSERT_GE` | `val1 >= val2`           |


- **Notes:**
  - Pointer comparisons check pointer addresses, not pointee contents.
  - For C strings, use string comparison assertions instead (see next section).


**Example:**

```cpp
EXPECT_EQ(result, expected) << "Result does not match expectation.";
ASSERT_GT(value, threshold) << "Value must exceed threshold.";
```

---

## String Assertions

Specialized for comparing **C strings** (including wide-character strings).

| Assertion          | Meaning                             |
| ------------------ | --------------------------------- |
| `EXPECT_STREQ` / `ASSERT_STREQ` | Strings *equal* in content        |
| `EXPECT_STRNE` / `ASSERT_STRNE` | Strings *not equal* in content    |
| `EXPECT_STRCASEEQ` / `ASSERT_STRCASEEQ` | Strings equal ignoring case       |
| `EXPECT_STRCASENE` / `ASSERT_STRCASENE` | Strings not equal ignoring case   |

- Use `EXPECT_STREQ` and related macros when comparing contents of C strings.

**Example:**

```cpp
EXPECT_STREQ(greeting, "Hello, World!") << "Greeting message mismatch.";
ASSERT_STRNE(name, nullptr) << "Name must not be null.";
```

---

## Floating-Point Comparison

Due to rounding, exact comparison of floating-point values is unreliable. GoogleTest provides special macros with a tolerance based on Units in the Last Place (ULPs).

| Assertion          | Description                                         |
| ------------------ | ------------------------------------------------- |
| `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ` | Compares `float` values approximately equal to 4 ULPs    |
| `EXPECT_DOUBLE_EQ` / `ASSERT_DOUBLE_EQ` | Compares `double` values approximately equal to 4 ULPs   |
| `EXPECT_NEAR` / `ASSERT_NEAR` | Checks values differ less than given absolute error bound |

**Example:**

```cpp
EXPECT_FLOAT_EQ(computed_val, expected_val);
EXPECT_NEAR(computed_val, expected_val, 0.001);
```

---

## Exception Assertions

Verify that code throws or does not throw exceptions. Requires exceptions enabled.

| Assertion        | Description                        |
| ---------------- | -------------------------------- |
| `EXPECT_THROW` / `ASSERT_THROW` | Expects a statement to throw a specific exception type |
| `EXPECT_ANY_THROW` / `ASSERT_ANY_THROW` | Expects a statement to throw any exception             |
| `EXPECT_NO_THROW` / `ASSERT_NO_THROW` | Verifies statement throws no exception                  |

**Examples:**

```cpp
EXPECT_THROW(ThrowRuntimeError(), std::runtime_error);
ASSERT_NO_THROW(ProcessData());
```

You can also use compound statements inside, e.g.: 

```cpp
EXPECT_NO_THROW({ Initialize(); Run(); Cleanup(); });
```

---

## Predicate Assertions

These allow checking complex predicates with better error messages than `EXPECT_TRUE()`.

### EXPECT_PRED*

- Check predicate functions or functors returning `bool`.
- Macros cover 1 to 5 arguments: `EXPECT_PRED1`, `EXPECT_PRED2`, ..., `EXPECT_PRED5`.

**Example:**

```cpp
bool IsDivisibleBy7(int n) { return n % 7 == 0; }
EXPECT_PRED1(IsDivisibleBy7, value);
```

### EXPECT_PRED_FORMAT*

- Use predicate-formatter functions/functors returning `AssertionResult`.
- Provide detailed success/failure explanations.
- Macros exist for 1 to 5 arguments.

Example predicate-formatter:

```cpp
using testing::AssertionFailure;
using testing::AssertionSuccess;

AssertionResult AssertIsEven(const char* expr, int n) {
  if (n % 2 == 0) return AssertionSuccess();
  return AssertionFailure() << expr << " is not even, actual value: " << n;
}
```

Usage:

```cpp
EXPECT_PRED_FORMAT1(AssertIsEven, value);
```

---

## Windows HRESULT Assertions

Simplify checking of Windows HRESULT values.

| Assertion                       | Description                        |
| -------------------------------| ---------------------------------|
| `EXPECT_HRESULT_SUCCEEDED` / `ASSERT_HRESULT_SUCCEEDED` | Expect HRESULT success result        |
| `EXPECT_HRESULT_FAILED` / `ASSERT_HRESULT_FAILED`       | Expect HRESULT failure result        |

**Example:**

```cpp
ASSERT_HRESULT_SUCCEEDED(shell.CoCreateInstance(L"Shell.Application"));
```

Failure messages include readable error codes.

---

## Death Assertions

Death tests verify code terminates unexpectedly (e.g., program aborts). They execute the code in a separate process.

| Assertion               | Description                                                   |
| ----------------------- | -------------------------------------------------------------|
| `EXPECT_DEATH` / `ASSERT_DEATH`        | Expect failure exit with non-zero status and matching stderr  |
| `EXPECT_DEATH_IF_SUPPORTED` / `ASSERT_DEATH_IF_SUPPORTED` | As above if supported, or no-op otherwise               |
| `EXPECT_DEBUG_DEATH` / `ASSERT_DEBUG_DEATH` | Like `EXPECT_DEATH` but only in debug builds                     |
| `EXPECT_EXIT` / `ASSERT_EXIT`          | Expect process exit with status matching predicate and stderr regex |

**Example:**

```cpp
TEST(FooDeathTest, DiesOnInvalidInput) {
  ASSERT_DEATH({ Foo(-1); }, "Invalid argument");
}

TEST(FooDeathTest, ExitsSuccessfully) {
  EXPECT_EXIT(NormalExit(), testing::ExitedWithCode(0), "Success");
}
```

**Important:** Name death test suites ending with `DeathTest` to avoid threading issues.

---

## Using Assertions in Subroutines

Assertions inside helper functions abort only the current function, not the whole test. To propagate failures properly:

- Use `ASSERT_NO_FATAL_FAILURE(statement);` or `EXPECT_NO_FATAL_FAILURE(statement);`
- Check for failure with `HasFatalFailure()` and return early
- Alternatively, set up an event listener to throw exceptions on failures

Use `SCOPED_TRACE` to add contextual trace messages for better diagnostics inside nested calls.

**Example:**

```cpp
void Helper(int n) {
  SCOPED_TRACE("Checking n=" << n);
  ASSERT_EQ(expected, Func(n));
}
```

---

## Logging Additional Information

You can attach key-value pairs to tests by calling `RecordProperty("key", value)`, which will be included in the XML or JSON test report output.

```cpp
RecordProperty("MaxWidgets", max_widgets);
```

**Notes:**
- Only valid XML attribute names allowed
- Can be used outside tests to attribute to test suites or environments

---

## Best Practices and Tips

- Use `EXPECT_*` for nonfatal checks and `ASSERT_*` when failure should abort the current function
- Avoid over-specifying mock expectations; prefer `ON_CALL` for default behaviors
- Use sequences and `.RetiresOnSaturation()` to enforce ordering and consume expectations
- Use custom predicates and predicate-formatters to get clearer failure messages for complex conditions
- Keep assertions focused and concise for more maintainable tests

---

## Next Steps

After mastering assertions, deepen your understanding by exploring:

- [Matchers: Using Matchers for Flexible Validation](/guides/core-testing-workflows/using-matchers)
- [Mocking: Mocking Techniques and Patterns](/guides/core-testing-workflows/mocking-techniques)
- [Advanced: Death Tests, Fatal, and Non-Fatal Failures](/guides/advanced-and-integrations/death-tests-and-fatal-failures)

Also, consult the full [Assertions Reference](reference/assertions.md) for detailed macro descriptions and examples.

---

## References

- GoogleTest [Assertions Reference](reference/assertions.md)
- GoogleTest [Advanced Guide](docs/advanced.md#assertions)
- GoogleMock [Mocking Reference](docs/reference/mocking.md)
- GoogleMock [Cookbook](docs/gmock_cook_book.md)

---