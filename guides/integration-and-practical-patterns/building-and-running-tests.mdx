---
title: "Building and Running Tests"
description: "Follow hands-on instructions for integrating GoogleTest and GoogleMock into your project’s build system, including CMake and Bazel. Covers compiling tests and best practices for configuring build environments."
---

# Building and Running Tests

## Overview

This guide provides practical, step-by-step instructions for building and running tests using GoogleTest and GoogleMock in your C++ projects. It focuses on integrating tests into your build system, compiling test executables, running tests, interpreting results, and applying best practices to configure your build environment efficiently.

Whether you're using CMake or Bazel, this guide ensures you can successfully build your tests and reliably run them to validate your code.

---

## Prerequisites

Before proceeding with this guide, please ensure the following:

- You have already obtained and prepared the GoogleTest and GoogleMock source code or libraries.
- Your development environment supports C++17 or higher.
- You are familiar with your project's build system, preferably CMake or Bazel.
- Your project setup has configured GoogleTest and GoogleMock headers and libraries as dependencies.
- You have written tests following the framework's macros (`TEST`, `TEST_F`, `TEST_P`, etc.).

Refer to the [Installing with CMake and Bazel](../getting-started/installation-configuration/install-build-tools.md) and [Configuring Your Project](../getting-started/installation-configuration/project-setup.md) guides for setup details.

---

## Expected Outcome

After completing this guide, you will be able to:

- Integrate GoogleTest and GoogleMock into your build system (CMake or Bazel).
- Build test executables successfully with linked GoogleTest/GoogleMock libraries.
- Run your tests using `RUN_ALL_TESTS()` and interpret the results.
- Customize test execution via command-line flags like filters, repeat counts, and output options.
- Follow best practices to optimize your build and test workflow.

---

## Time Estimate

Building and running tests can be done within 10-30 minutes depending on your familiarity with the build system and size of your test suite.

---

# Step-by-Step Instructions

### 1. Configure Your Build System to Include GoogleTest and GoogleMock

#### For CMake Users

- If GoogleTest/GoogleMock are already installed as libraries or submodules, link them to your test targets:

```cmake
find_package(GTest CONFIG REQUIRED)  # or use FetchContent to download

target_link_libraries(your_test_target PRIVATE GTest::gtest GTest::gmock)

# If you want to use the main() implementation provided by gtest_main or gmock_main:
target_link_libraries(your_test_target PRIVATE GTest::gtest_main GTest::gmock_main)
```

- For projects embedding googletest source, add the subdirectory:

```cmake
add_subdirectory(googletest)  # path to googletest source

add_executable(your_test_exec your_tests.cpp)
target_link_libraries(your_test_exec PRIVATE gtest gmock gtest_main)
```

- Ensure your compiler uses at least C++17 standard:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

#### For Bazel Users

- Define test targets in your `BUILD` files with `cc_test`:

```bazel
cc_test(
    name = "your_test",
    srcs = ["your_test.cc"],
    deps = ["@com_google_googletest//:gmock_main"],
)
```

- Use the pre-built GoogleTest/GoogleMock Bazel workspace dependencies to manage the libraries.


### 2. Build Your Tests

- Run your build tool to compile the tests. For example:

  - **CMake:**

    ```bash
    mkdir build && cd build
    cmake ..
    make
    ```

  - **Bazel:**

    ```bash
    bazel build //path/to:your_test
    ```

- Confirm the test executable is generated successfully with linked GoogleTest and GoogleMock libraries.


### 3. Running Tests

- Most GoogleTest and GoogleMock test binaries automatically register all your tests.
- To execute the entire test suite, run the test binary, which internally calls `RUN_ALL_TESTS()`:

```bash
./your_test_exec
```

- You will see verbose output of tests passing or failing, including test suite names and individual test names.


### 4. Customizing Test Runs with Command-Line Flags

You can pass various flags to control which tests to run and output style. Key flags include:

- `--gtest_filter=Pattern` — run only tests matching the pattern. Supports wildcards (`*`) and exclusions.
- `--gtest_repeat=N` — repeat the whole test suite N times (useful for flaky tests).
- `--gtest_shuffle` — run tests in random order.
- `--gtest_output=xml[:path]` — generate an XML report (default path: `test_detail.xml`).
- `--gtest_color=yes|no|auto` — control colored output.
- `--gtest_list_tests` — list all tests without running them.

Example running only `FactorialTest` suite tests with colored output:

```bash
./your_test_exec --gtest_filter=FactorialTest.* --gtest_color=yes
```


### 5. Handling Test Failures and Debugging

- Failed assertions print filenames and line numbers.
- Use `--gtest_break_on_failure` to cause a breakpoint if tests fail (requires debugger).
- Save properties or diagnostic information using `RecordProperty()` in your tests to log custom data in the XML report.


### 6. Integrating Continuous Testing into Your Workflow

- Invoke tests automatically after build steps.
- Utilize the XML output for CI systems that parse test results.
- Use filters and repetition flags to run focused test subsets or stress tests.


---

# Best Practices & Tips

- **Always link against `gtest_main` or provide your own `main()`** that calls `InitGoogleTest()` and `RUN_ALL_TESTS()`. If you need custom main, see the example in the GoogleTest Primer guide.

- **Isolate tests:** Use fixtures (`TEST_F`) to create isolated setups with `SetUp()` and `TearDown()`.

- **Use command-line flags democratically:** Leverage filters to speed up debugging.

- **Check return values:** Your test binary's exit code will be 0 on success or 1 on failure — return this from your program's `main()`.

- **Integrate with build system:** Let your build tool define and discover tests for automation.

- **Avoid calling `RUN_ALL_TESTS()` multiple times:** It is designed to be called only once.

- **Consider test order dependency:** Avoid it by writing independent tests or using the `--gtest_shuffle` flag to detect order dependencies.


---

# Example: Simple CMake Test Setup

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Fetch googletest as part of the build
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/v1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp my_test.cpp)
target_link_libraries(my_tests PRIVATE gtest gmock gtest_main)

enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

---

# Example: Custom main() Function

If you want to write your own entry point:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This ensures all command-line flags are parsed before running tests.

---

# Troubleshooting Checklist

- Is your test executable linking with GoogleTest and GoogleMock libraries?
- Are you calling `InitGoogleTest()` before `RUN_ALL_TESTS()`?
- Are your tests registered via `TEST`, `TEST_F`, or `TEST_P` macros?
- Are your tests passing, or is the output showing assertion failure details?
- If tests don't run, try `--gtest_list_tests` to verify registration.
- On Windows, verify runtime library consistency (static vs dynamic link).

---

# Next Steps & Related Content

- Explore [Writing Your First Test](../guides/core-testing-workflows/writing-your-first-test.md) for writing tests to run with this workflow.
- Refer to [Continuous Integration with GoogleTest](../guides/integration-and-practical-patterns/continuous-integration-with-googletest.md) to automate test runs.
- Learn about test execution flags and detailed configuration in the [Feature Summary](../overview/quick-glance/feature-summary.md).
- Troubleshoot common issues with [Troubleshooting Common Installation Issues](../getting-started/first-test-run-validation/troubleshooting-common-issues.md).

---

## Resources

- [GoogleTest Primer](../docs/primer.md) for a complete beginner introduction.
- [GoogleTest README - Build Instructions](https://github.com/google/googletest/blob/main/googletest/README.md) for advanced building details.
- Official GoogleTest GitHub repository: <https://github.com/google/googletest>

---

By following this guide, you have established a robust test build and execution workflow supporting both GoogleTest and GoogleMock frameworks, enabling effective validation and continuous quality assurance throughout your C++ project development.