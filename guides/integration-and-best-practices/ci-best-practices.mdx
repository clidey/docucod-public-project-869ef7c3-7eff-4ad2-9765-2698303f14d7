---
title: "Continuous Integration and Fast Feedback"
description: "Explores how to automate running of tests in CI pipelines for rapid feedback. Provides best practices, sample scripts, and tips for maintaining a healthy test workflow at scale."
---

# Continuous Integration and Fast Feedback

## Introduction

In modern software development, fast and reliable feedback from your test suite is essential to maintaining code quality and developer productivity. This page focuses on automating the running of GoogleTest tests within Continuous Integration (CI) pipelines, enabling rapid feedback after code changes. You will learn best practices for configuring your test runs for CI, sample scripts to get started quickly, and tips to maintain a scalable and healthy testing workflow.

---

## Prerequisites

Before setting up CI integration for GoogleTest, ensure that:

- GoogleTest has been successfully built and integrated into your project. See the [Build and Install from Source](../getting-started/installation-config/build-from-source.md) and [CMake Integration](../getting-started/installation-config/cmake-integration.md) guides.
- Your CI environment supports executing the compiled test binaries.
- The test binary is capable of running tests by invoking `RUN_ALL_TESTS()`.
- Basic familiarity with your CI systemâ€™s configuration files and scripting capabilities.

---

## Expected Outcome

By following this guide, you will achieve:

- Automated execution of GoogleTest test binaries in your CI system.
- Fast identification of test failures with clear reporting.
- Efficient test filtering and sharding for scalable test suites.
- Configurable output formats suited for CI reporting tools.

---

## Time Estimate

Setting up basic CI test execution: 15-30 minutes.

Advanced configurations like test sharding or custom listeners: 1-2 hours.

---

## Difficulty Level

Intermediate: requires working knowledge of test binaries and some CI experience.

---

# Step-by-Step Instructions

### 1. Build Your Test Binary

- Ensure your project builds the GoogleTest-based test binary.
- The binary should include a compiled `main()` that calls `testing::InitGoogleTest()` followed by `RUN_ALL_TESTS()`.

### 2. Running Tests in CI

Invoke your test binary as part of your CI job. For example:

```bash
./my_project_test_binary
```

This will run all registered GoogleTest tests and return a non-zero exit code if any tests fail.

#### 2.1 Using Command-Line Flags for Your Test Executable

GoogleTest supports numerous command-line flags to control test execution and reporting. Key flags for CI:

- `--gtest_filter=`: Run a subset of tests matching a specific pattern.
- `--gtest_repeat=N`: Repeat tests multiple times (useful for flaky test identification).
- `--gtest_shuffle`: Run tests in random order to detect dependencies.
- `--gtest_output=xml:<path>`: Generate an XML report consumable by CI servers.
- `--gtest_fail_fast`: Stop immediately on first failure.

Example:

```bash
./my_project_test_binary --gtest_filter=MySuite.* --gtest_output=xml:report.xml
```

### 3. Integrate Test Execution in Your CI Configuration

Add the test execution command(s) to your CI pipeline configuration file (e.g., GitHub Actions, Jenkins, CircleCI):

```yaml
steps:
  - name: Build
    run: ./build.sh

  - name: Run Tests
    run: ./my_project_test_binary --gtest_output=xml:test_results.xml

  - name: Publish Test Results
    uses: some/ci-test-report-action
    with:
      results: test_results.xml
```

### 4. Use Test Output for Feedback

Configure your CI system to parse the XML or JSON output generated by GoogleTest to:

- Display pass/fail status of tests.
- Show detailed failure messages and stack traces.
- Track test metrics over time.

### 5. Advanced: Test Sharding and Parallel Execution

For large test suites, split testing across multiple CI machines or jobs to speed up runs.

- Set the environment variables `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX`:

```bash
export GTEST_TOTAL_SHARDS=4
export GTEST_SHARD_INDEX=0  # or 1, 2, 3 for other shards
./my_project_test_binary
```

- Each shard runs only a portion of the tests, allowing parallel execution.
- After all shards complete, aggregate results in your CI system.

### 6. Customize Test Event Listening

GoogleTest supports adding custom event listeners to format output or perform actions at test start/end.

In your `main()` function:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);

  // Add custom listeners as needed.
  testing::UnitTest::GetInstance()->listeners().Append(new MyCustomListener());

  return RUN_ALL_TESTS();
}
```

This is useful for integrating with special CI reporting or logging requirements.

---

## Sample Scripts

### Basic Run with XML Output

```bash
#!/bin/bash

./my_project_test_binary --gtest_output=xml:test_results.xml

if [ $? -ne 0 ]; then
  echo "Tests failed, please check test_results.xml"
  exit 1
fi

exit 0
```

### Run with Test Filtering and Sharding

```bash
#!/bin/bash

export GTEST_TOTAL_SHARDS=4
export GTEST_SHARD_INDEX=$1  # parameter: shard index 0-3

./my_project_test_binary \
  --gtest_filter=CriticalTests.* --gtest_output=xml:test_results_shard_${GTEST_SHARD_INDEX}.xml

if [ $? -ne 0 ]; then
  echo "Shard ${GTEST_SHARD_INDEX} tests failed."
  exit 1
fi

exit 0
```

Run this script 4 times with shard indices 0 to 3 to split your critical tests.

---

## Best Practices

- **Run tests on every change:** Quickly spot regressions by running your tests on every push or pull request.
- **Use XML output:** Most CI systems support parsing JUnit-style XML. Use the `--gtest_output` flag to generate these reports.
- **Filter selectively:** When debugging or running heavy tests, use `--gtest_filter` to run relevant subsets.
- **Fail fast when developing:** Use `--gtest_fail_fast` locally to stop on first error and speed up debugging.
- **Leverage sharding:** For large test suites, shard tests across CI agents to improve throughput.
- **Keep tests independent:** Ensure tests don't depend on execution order to maximize effectiveness of shuffling.
- **Monitor flaky tests:** Use repeat runs via `--gtest_repeat` to identify tests with intermittent failures.
- **Customize listeners:** For advanced usage, create custom event listeners to adapt output format.

---

## Troubleshooting & Tips

### Common Issues

| Issue                         | Solution                                                             |
|-------------------------------|----------------------------------------------------------------------|
| Tests not running or detected | Confirm `RUN_ALL_TESTS()` is called in `main()`.                    |
| Test failures with no details | Make sure your CI system parses the GoogleTest XML output correctly. |
| Unable to generate XML report | Provide `--gtest_output=xml:<file>` flag and ensure output dir exists. |
| Partial test execution in shards | Set correct `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX` environment variables. |
| Slow tests block CI feedback  | Use filtering and sharding; mark non-critical tests as disabled with `DISABLED_` prefix. |

### Tips

- Always check the return code of the test binary to make CI build fail on test failures.
- Add retries or flakiness detection to handle intermittent test failures.
- Use `--gtest_list_tests` in CI to confirm which tests will run.

---

## Next Steps & Related Content

- **Setting Up & Writing Your First Test**: Start by creating your initial tests and understanding GoogleTest basics.
- **Running, Organizing, and Interpreting Tests**: Learn best practices for test organization and interpreting output.
- **Integrating with Build Systems (CMake & Bazel)**: Automate builds alongside tests in your CI environment.
- **Mocking with GoogleMock: Basics and Patterns**: Expand testing with mocks and stubs.
- **Effective Use of Matchers & Actions**: Write expressive, maintainable tests with advanced matcher usage.

Explore these guides to grow your mastery and effectively maintain test suites through CI.

---

## References

- [GoogleTest Primer](../primer.md) - Getting started with tests.
- [Test Case and Test Suite API](../api-reference/googletest-core-apis/test-case-and-test-suite-api.md) - API for organizing tests.
- [Running, Organizing, and Interpreting Tests](../guides/getting-started/running-and-organizing-tests.md) - Test execution details.
- [Build and Install from Source](../getting-started/installation-config/build-from-source.md) - Setting up GoogleTest.
- [Integration with Build Systems](../guides/integration-and-best-practices/build-integration.md) - CMake and Bazel integration.
- [Mocking Basics & Patterns](../guides/advanced-and-real-world/mocking-basics-patterns.md) - Basics of mocking.
- [Effective Use of Matchers & Actions](../guides/advanced-and-real-world/effective-use-matchers-actions.md) - Advanced matchers and actions.

<br>

---

*This page is part of the GoogleTest documentation suite dedicated to enabling robust, fast-feedback testing workflows using popular CI systems.*
