---
title: "Continuous Integration: Running Tests Automatically"
description: "Integrate GoogleTest and GoogleMock with CI systems. Covers reporting, test selection, and artifacts to ensure robust automation across platforms."
---

# Continuous Integration: Running Tests Automatically

## Workflow Overview

Automation is essential for maintaining software quality at scale. This guide walks you through integrating GoogleTest and GoogleMock into your Continuous Integration (CI) systems, ensuring your tests run reliably and report meaningful results automatically across platforms.

### Prerequisites
- GoogleTest and GoogleMock installed and successfully building in your development environment.
- Basic familiarity with running GoogleTest test binaries.
- A working CI environment (e.g., Jenkins, GitHub Actions, GitLab CI, Travis CI).

### Expected Outcome
By following this guide, you will be able to run GoogleTest-based tests automatically in your CI pipelines, configure reporting of test results, selectively run tests, and collect artifacts to support troubleshooting and quality monitoring.

### Time Estimate
20-40 minutes to set up basic automation and configure reporting.

### Difficulty Level
Intermediateâ€”requires familiarity with your CI system and test running basics.

---

## Step-by-Step Instructions

### 1. Build Your Tests for CI

Ensure your tests build correctly on the CI agents. Use CMake or your build system to compile GoogleTest and your test code.

**Actions:**
- Configure your CI build scripts to fetch GoogleTest (via submodule, FetchContent, or installed library).
- Compile GoogleTest and your tests with C++17 support as required.

**Verification:**
- The test executable is successfully created and available to run.

### 2. Run Tests with GoogleTest Command-Line Options

Running tests automatically requires invoking your test binaries in the CI environment.

**Actions:**
- Invoke your test executable with `--gtest_output=xml:<path>` to generate machine-readable XML reports.
- Use `--gtest_filter` to select which tests to run when needed, e.g., `--gtest_filter=MyTestSuite.*`.

Example command:

```sh
./my_test_binary --gtest_output=xml:reports/test_results.xml
```

**Verification:**
- XML report file is created in the specified location.
- Console output includes test summary (e.g., passed, failed, skipped counts).

### 3. Configure Reporting to Your CI System

Most CI systems support importing JUnit-compatible XML test reports.

**Actions:**
- Configure your CI job to collect the XML files generated by GoogleTest (e.g., `test_results.xml`).
- Wire the reports into the CI test reporting plugins or built-in features.

**Tips:**
- Use relative paths inside CI to ensure reports are collected regardless of workspace location.
- Configure test report retention to keep historical results.

### 4. Use Test Sharding for Parallel Execution

For large test suites, distribute tests across multiple CI agents to reduce execution time.

**Actions:**
- Set the environment variables `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX` in your CI job configuration.
- Run the same test binary on multiple agents, each with a distinct shard index.

Example:

| Agent | GTEST_TOTAL_SHARDS | GTEST_SHARD_INDEX |
|-------|--------------------|-------------------|
| 1     | 4                  | 0                 |
| 2     | 4                  | 1                 |
| 3     | 4                  | 2                 |
| 4     | 4                  | 3                 |

**Verification:**
- Each shard reports results for a unique subset of tests.
- Combined reports show full test coverage.

### 5. Capture Test Artifacts and Logs

Store logs and other test artifacts in your CI system for debugging failures.

**Actions:**
- Redirect standard output and error of test runs to log files.
- Configure the CI to archive logs and test reports as artifacts.

Example:

```sh
./my_test_binary --gtest_output=xml:reports/test_results.xml > logs/test.log 2>&1
```

### 6. Set Failures as CI Failures

Ensure the CI pipeline fails when tests fail.

**Actions:**
- Make sure the test runner command returns a non-zero exit code upon failures.
- Configure the CI job to treat non-zero exit codes as failures.

GoogleTest returns `0` for successful run, `1` otherwise.

### 7. Optional: Filter Tests Dynamically

Control which tests run by filter expressions directly in your CI setups.

Example:

```sh
./my_test_binary --gtest_filter=MyTestSuite.TestA:OtherSuite.*-OtherSuite.IgnoredTest
```

Use this to speed up test runs or isolate problem areas.


## Practical Tips & Best Practices

- **XML Output Location:** Keep XML outputs in a dedicated folder that your CI archives, e.g., `reports/`.
- **Avoid Overlong Logs:** Redirect console logs to files if they are verbose; use CI features to display summary.
- **Consistent Test Names:** Follow [naming conventions](../faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore) to avoid naming conflicts and errors.
- **Set Up Global Environments with Care:** If using global test environments, be aware their `SetUp()` and `TearDown()` run per test iteration.
- **Fail Fast in CI:** Use `--gtest_fail_fast` to stop tests immediately on failure for quicker feedback.

---

## Troubleshooting Common Issues

### Tests Not Running or XML Not Generated

- Verify your test executable is runnable on the CI agent.
- Confirm `--gtest_output=xml:<path>` is correctly specified.
- Check file path permissions and existence of folder.

### CI Not Recognizing Test Failures

- Make sure your test runner returns proper exit code. GoogleTest does this by default.
- Confirm CI job fails on non-zero exit code.

### Sharding Not Working as Expected

- Check that `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX` are set properly and are integers.
- Ensure all shards are executed and reports are collected.

### Disabled Tests Executing Unexpectedly

- Verify you are not using the `--gtest_also_run_disabled_tests` flag unintentionally.

<Tip>
GoogleTest recommends giving your **test suite** names and **test names** without underscores to avoid internal conflicts in CI environments. See the [FAQ](../faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore) for details.
</Tip>


## Next Steps & Related Content

- **Build Integration:** Follow the [Build Integration guide](../guides/integration-and-best-practices/build-integration.md) to connect GoogleTest with your build system.
- **Test Performance:** Learn how to optimize and parallelize your tests in the [Test Performance guide](../guides/integration-and-best-practices/test-performance.md).
- **Writing Your First Test:** If new, see [Writing and Running Your First Test](../guides/getting-started/quickstart-testing.md).
- **Mocking:** Explore [Mocking Your First Class or Function](../guides/getting-started/first-mock.md) for automating behavior verification in your CI.
- **Troubleshooting:** Use the [Common Issues troubleshooting](../getting-started/troubleshooting/common-issues.md) guide to resolve CI integration problems.

---