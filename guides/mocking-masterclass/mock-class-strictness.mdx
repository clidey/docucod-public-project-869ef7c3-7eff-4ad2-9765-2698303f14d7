---
title: "Mock Strictness: Nice, Naggy, and Strict Mocks"
description: "Describes strategies and tradeoffs using NiceMock, NaggyMock, and StrictMock to control test strictness. Explains how to balance test maintainability with strict verification of mock interactions."
---

# Mock Strictness: Nice, Naggy, and Strict Mocks

## Overview

This guide explains how to control the strictness level of mocks in GoogleMock by using the templates `NiceMock`, `NaggyMock`, and `StrictMock`. These wrappers modify how uninteresting calls—calls to mock methods without explicit expectations—are handled, balancing between test maintainability and strict verification of mock interactions.

Understanding these options helps you avoid brittle tests, reduce test noise, and tune your tests to verify exactly what you need.

---

## What Is Mock Strictness?

In GoogleMock, each mock object monitors calls made to its methods. When a mock method is called without any matching `EXPECT_CALL`:

- It is an **uninteresting call**.
- The default behavior is to execute the default action of that method.
- By default, such calls generate a **warning**.

Mock strictness controls how GoogleMock treats these uninteresting calls:

- Whether to allow them quietly,
- Warn about them,
- Or treat them as errors.

---

## The Three Strictness Modes

GoogleMock provides three wrapper class templates to control mock strictness:

### 1. NiceMock

- **Behavior:** Suppresses warnings for uninteresting calls.
- **Use case:** When you want clean test output and do not want to be notified about calls you don't care about.
- **Effect on unexpected calls:** They still fail the test.

```cpp
using ::testing::NiceMock;

NiceMock<MockFoo> nice_foo;
EXPECT_CALL(nice_foo, DoThis());  // Expected call
nice_foo.DoThat();  // Uninteresting call, no warning
```

### 2. NaggyMock (Default Behavior)

- **Behavior:** Prints warnings for uninteresting calls.
- **Use case:** Useful when you want to be notified about unexpected behavior but not fail the test immediately.
- **Effect on unexpected calls:** They still cause failures.

```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> naggy_foo;
naggy_foo.DoThat();  // Prints warning about uninteresting call
```

Currently, plain mocks behave like `NaggyMock` by default, but this is planned to change to nice mocks.

### 3. StrictMock

- **Behavior:** Treats uninteresting calls as test failures.
- **Use case:** When you want your tests to be very strict and only allow exactly the calls you specify.

```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_foo;
EXPECT_CALL(strict_foo, DoThis());
strict_foo.DoThat();  // Test failure: uninteresting call detected
```

---

## When to Use Each Mock Strictness

| Strictness   | Uninteresting Call Handling                        | Typical Use Case                      |
| ------------ | ------------------------------------------------- | ----------------------------------- |
| **NiceMock** | Silently ignore uninteresting calls               | Most tests, to avoid noise           |
| **NaggyMock**| Warn on uninteresting calls (default behavior)    | During test development or debugging |
| **StrictMock**| Fail tests on any uninteresting calls            | Critical paths, very thorough tests |

### Best Practice Recommendation

- Use **NiceMock** in most cases for maintainable and less brittle tests.
- Use **NaggyMock** temporarily during test development to catch surprises.
- Use **StrictMock** only if you want to enforce very tight interaction contracts.

---

## How to Use Strictness Wrappers

Given a mock class `MockFoo`, wrap it as follows:

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

// Nice mock suppresses uninteresting call warnings
NiceMock<MockFoo> nice_mock;

// Naggy mock prints warnings on uninteresting calls
NaggyMock<MockFoo> naggy_mock;

// Strict mock treats uninteresting calls as failures
StrictMock<MockFoo> strict_mock;
```

The wrappers inherit from the base mock class, so you can use them wherever `MockFoo` would be used.

They also "inherit" constructors of the mock class, so you can initialize with arguments:

```cpp
NiceMock<MockBar> nice_bar("hello", 5);
StrictMock<MockBar> strict_bar('a', 'b', "c", "d", 1, 2, "e", "f", true, false);
```

---

## How Strictness Affects Test Behavior

| Scenario                  | NiceMock                               | NaggyMock                              | StrictMock                                 |
|---------------------------|--------------------------------------|---------------------------------------|--------------------------------------------|
| Uninteresting call        | Allowed quietly                      | Warning printed                       | Test failure                               |
| Unexpected call           | Test failure                        | Test failure                         | Test failure                               |
| Expected call             | Allowed                            | Allowed                             | Allowed                                    |


---

## Understanding Uninteresting vs Unexpected Calls

- **Uninteresting calls** occur when a method without any `EXPECT_CALL` spec is called. The test does not care about such calls.
- **Unexpected calls** occur when calls to a method with some `EXPECT_CALL`s do not match any specified expectations.

**Key points:**

- Unexpected calls always cause failures.
- Uninteresting calls may be allowed, warned, or cause failures depending on mock strictness.

---

## Example Scenario

Suppose we have a mock:

```cpp
class MockDomainRegistry {
public:
  MOCK_METHOD(std::string, GetDomainOwner, (const std::string& domain));
};
```

- You want to expect `GetDomainOwner("google.com")` to be called and return a fixed value:

```cpp
NiceMock<MockDomainRegistry> mock_registry;
EXPECT_CALL(mock_registry, GetDomainOwner("google.com"))
    .WillRepeatedly(Return("Larry Page"));

// Usage
auto owner = mock_registry.GetDomainOwner("google.com");
```

- If `GetDomainOwner("yahoo.com")` is called, it is an unexpected call and will fail the test regardless of strictness.
- To allow other domain queries without error, add a catch-all expectation:

```cpp
EXPECT_CALL(mock_registry, GetDomainOwner(_)).Times(AnyNumber());
```

- If you omit the above catch-all
  - Using a **NiceMock**, uninteresting calls to other domains will be ignored.
  - Using a **NaggyMock**, warnings will be printed.
  - Using a **StrictMock**, tests will fail immediately.

---

## Common Pitfalls and Tips

- **Do not mix strictness wrappers**: nesting `NiceMock<StrictMock<MockFoo>>` is unsupported.
- Mock strictness only affects uninteresting calls, not unexpected calls.
- Use strict mocks sparingly to reduce test brittleness.
- If you want to suppress specific warnings without making a mock fully nice, use `EXPECT_CALL(...).Times(AnyNumber())` for those methods instead.
- Ensure your mock classes have virtual destructors for correct behavior.

---

## Troubleshooting

### Unintended warnings about uninteresting calls

If you see warnings but expect the calls to be allowed:

- Consider wrapping the mock in `NiceMock` if you want to suppress warnings globally.
- Or, add explicit `EXPECT_CALL(mock, Method(_)).Times(AnyNumber());` for those methods.

### Tests fail due to uninteresting calls on StrictMock

- This indicates calls were made to methods without expectations.
- Either add proper expectations or switch to Naggy or Nice mocks based on desired strictness.

### Mixing mock strictness wrappers causes compilation errors

- Ensure you apply at most one strictness wrapper per mock object.
- Refactor tests to not nest `NiceMock` / `StrictMock` / `NaggyMock`.

---

## Additional Resources

- [gMock Cookbook section on Nice, Strict, and Naggy Mocks](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [gMock Cheat Sheet on Using Mocks](https://google.github.io/googletest/gmock_cheat_sheet.html#UsingMocks)
- [Mocking Reference: NiceMock, NaggyMock, StrictMock Classes](https://google.github.io/googletest/reference/mocking.html#NiceMock)

---