---
title: "Setting Up and Building GoogleTest"
description: "Learn how to integrate GoogleTest into your C++ project, covering installation, configuration with popular build systems, and build verification. Step-by-step walkthroughs cover CMake examples and key project structure advice."
---

# Setting Up and Building GoogleTest

## Overview

This guide provides a clear, practical approach to integrating GoogleTest into your C++ project. You'll learn how to install, configure, and build GoogleTest and GoogleMock, focusing on popular build systems like CMake. Follow the detailed steps to verify your setup and ensure a smooth start with the framework.

---

## Prerequisites

Before starting, ensure the following are ready:

- A development environment with C++17 support.
- CMake (version 3.13 or higher) installed if you intend to use it.
- Git installed for cloning the repositories.
- Suitable C++ compiler (e.g., GCC, Clang, MSVC) compatible with C++17.

---

## Expected Outcome

Upon completing this guide, you will:

- Have GoogleTest (and GoogleMock) cloned and built successfully.
- Understand how to integrate GoogleTest into your existing build projects using CMake.
- Be ready to write and run C++ tests using the framework.

---

## Time Estimate

Approximately 15–30 minutes, depending on your familiarity with CMake and your build environment.

---

## Difficulty Level

Beginner to Intermediate.

---

## Step-by-Step Instructions

### 1. Clone the GoogleTest Repository

Start by cloning the official GoogleTest repository which includes GoogleMock by default.

```bash
# Clone the specific release branch (example: v1.17.0)
git clone https://github.com/google/googletest.git -b v1.17.0
git clone https://github.com/google/googletest.git
git checkout v1.17.0
```

> The clone includes both GoogleTest and GoogleMock.

### 2. Build GoogleTest and GoogleMock Using CMake

Navigate into the cloned directory and create a build folder to keep artifacts organized.

```bash
cd googletest
mkdir build
cd build
```

Generate native build files with CMake:

```bash
cmake ..
```

- This step configures the build system and prepares the necessary files.
- By default, GoogleMock is included. To **skip** GoogleMock, run:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

### 3. Compile the Project

On Unix-like systems (Linux/macOS), run:

```bash
make
```

On Windows, if Visual Studio is installed, open the solution file generated (`gtest.sln` or equivalent) and build it within Visual Studio.

### 4. (Optional) Install GoogleTest and GoogleMock

If you want the libraries and headers installed system-wide (or to a local prefix):

```bash
sudo make install
```

This installs the headers in `/usr/local/include` and libraries in `/usr/local/lib` by default.

### 5. Incorporate GoogleTest into Your Existing CMake Project

There are two general approaches:

- **Link to Installed Libraries:**

  Install GoogleTest+Mock according to step 4, then in your project’s `CMakeLists.txt`:

  ```cmake
  find_package(GTest CONFIG REQUIRED)
  target_link_libraries(your_target PRIVATE GTest::gtest GTest::gmock)
  ```

- **Build GoogleTest as Part of Your Project:**

  Make GoogleTest code part of your project via `add_subdirectory`.

  ```cmake
  include(FetchContent)
  FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
  )
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # Fix Visual Studio runtime linking
  FetchContent_MakeAvailable(googletest)

  add_executable(your_test target_src.cpp)
  target_link_libraries(your_test PRIVATE gtest_main gmock_main)
  add_test(NAME your_test COMMAND your_test)
  ```

> This ensures GoogleTest is compiled with your project and matches your compiler settings.

### 6. Verify Your Build

After building, run the tests included in GoogleTest to validate your setup:

```bash
./test/gtest-all-test
./test/gtest_main-test
```

Or if you built `gmock_main` executable (which runs all GoogleMock tests):

```bash
./gmock_main
```

If tests run and pass, your build is configured correctly.

---

## Tips & Best Practices

- **C++17 Required:** Ensure your compiler supports C++17 and it’s enabled in your build setup (e.g., `set(CMAKE_CXX_STANDARD 17)` in CMake).

- **Visual Studio Runtime Clash:** On Windows, to avoid runtime library mismatch, enable `gtest_force_shared_crt`:

  ```cmake
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
  ```

- **Modular Build:** Build GoogleMock and GoogleTest as separate libraries if you need only one.

- **Use FetchContent for Portability:** Embedding GoogleTest via CMake’s `FetchContent` ensures easier dependency management and version control.

- **Isolate Build Artifacts:** Always build outside the source tree to avoid clutter.

- **Keep GoogleMock Updated:** As it’s shipped with GoogleTest, keep the repository updated regularly for bug fixes and improvements.

---

## Common Pitfalls & Troubleshooting

<Tip>
If you receive link errors related to missing pthread libraries on Linux, ensure your project links to pthread explicitly or uses CMake’s thread package finders.
</Tip>

<Tip>
When using Microsoft Visual Studio, mismatches in dynamic vs static runtime can cause linker errors. Use the `gtest_force_shared_crt` variable in your CMake to align runtimes.
</Tip>

<Warning>
If your build commands fail with errors about missing C++17 support, verify your compiler version and CMake standard version settings.
</Warning>

<Tip>
If build times feel long, move mock class constructor and destructor definitions out of header files into `.cc` files to reduce compilation overhead.
</Tip>

---

## Additional Resources & Advanced Topics

- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md) — Learn about defining mocks and expectations.

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — Begin writing your first tests.

- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Recipes for advanced mocking patterns.

- [Integration with Build Systems](https://github.com/google/googletest/blob/main/googletest/README.md#build-with-cmake) — More about CMake and alternatives like Bazel.

- [Troubleshooting Common Issues](https://github.com/google/googletest/blob/main/docs/common-issues.md) — Common build and runtime problems addressed.

---

## Summary

Successfully integrating and building GoogleTest sets the foundation for automated testing in C++ projects. Leveraging CMake’s capabilities or integrating GoogleTest as a build dependency ensures consistent, maintainable test builds aligned with your production code. Verifying your setup by running included tests guarantees a solid starting point for writing your own tests and mocks.

---