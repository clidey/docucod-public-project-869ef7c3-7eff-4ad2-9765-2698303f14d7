---
title: "Working with Assertions"
description: "Comprehensive overview of GoogleTest assertions, including equality, exception, and custom matchers. Explains best practices for selecting and structuring assertions for reliable and readable tests."
---

# Working with Assertions

GoogleTest offers a powerful set of assertion macros that let you verify conditions, compare values, handle exceptions, and use complex matchers to write expressive, reliable, and readable tests. This guide focuses exclusively on working with assertions in GoogleTest — detailing their categories, best practices, and practical examples for building robust test validations.

---

## 1. Workflow Overview

### Task Description
Learn how to write effective assertions in GoogleTest to verify expected conditions and values within your tests, including equality checks, exception verification, custom predicates, and matcher-based assertions.

### Prerequisites
- GoogleTest installed and configured in your C++ project.
- Basic understanding of writing test cases using `TEST` or `TEST_F` macros.
- Familiarity with C++ expressions and GoogleMock basics will help but is not mandatory.

### Expected Outcome
By following this guide, you will be able to:
- Apply appropriate assertion macros to validate test results.
- Use matchers in assertions for expressive value validation.
- Handle expected exceptions cleanly in tests.
- Write custom predicate and predicate-format assertions.

### Time Estimate
10–20 minutes for initial reading and experimentation.

### Difficulty Level
Beginner to Intermediate

---

## 2. Assertion Categories and Usage

GoogleTest assertions come in pairs with `EXPECT_` and `ASSERT_` variants:
- `EXPECT_` macros: Generate nonfatal failures allowing the test to continue.
- `ASSERT_` macros: Generate fatal failures aborting the current function immediately.

You can append custom failure messages using the streaming operator (`<<`).

### Explicit Success and Failure

- `SUCCEED()`
  - Marks a successful assertion explicitly.
  - Useful for documenting test logic.

- `FAIL()`
  - Generates a fatal failure and aborts the current function.
  - Use when a certain code path should never be reached.

- `ADD_FAILURE()`
  - Generates a nonfatal failure, allowing test to continue.

- `ADD_FAILURE_AT(file, line)`
  - Generate failure at specific source code location.

### Boolean Condition Assertions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

Use these to validate boolean expressions directly.

### Binary Comparison Assertions

For comparing two values with natural relational operations:

| Macro        | Description                         |
| ------------ | --------------------------------- |
| `EXPECT_EQ`  | Verifies `val1 == val2`            |
| `EXPECT_NE`  | Verifies `val1 != val2`            |
| `EXPECT_LT`  | Verifies `val1 < val2`             |
| `EXPECT_LE`  | Verifies `val1 <= val2`            |
| `EXPECT_GT`  | Verifies `val1 > val2`             |
| `EXPECT_GE`  | Verifies `val1 >= val2`            |

- Pointer comparisons consider addresses, not contents. Use string-specific macros for C strings.

### String Comparison for C Strings

These macros compare string contents instead of addresses:

- `EXPECT_STREQ(str1, str2)` — Checks if two C strings are equal.
- `EXPECT_STRNE(str1, str2)` — Checks if two C strings differ.
- `EXPECT_STRCASEEQ(str1, str2)` / `EXPECT_STRCASENE` — Case-insensitive versions.

### Floating-Point Comparisons

Due to rounding errors, use specialized macros:

- `EXPECT_FLOAT_EQ(val1, val2)` — Compares `float` within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)` — Compares `double` within 4 ULPs.
- `EXPECT_NEAR(val1, val2, abs_error)` — Compares with absolute error bound.

### Exception Assertions

Verify if code throws or does not throw exceptions:

- `EXPECT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)`

Wrap compound statements in braces if needed:
```cpp
EXPECT_THROW({ DoRisky(); }, std::runtime_error);
```

### Predicate Assertions

Enable more complex logical checks:

- `EXPECT_PREDn(pred, val1, val2, ...)` — Uses Boolean predicate functions/functors.
- `EXPECT_PRED_FORMATn(pred_formatter, val1, val2, ...)` — Uses predicates returning `AssertionResult` for detailed failure messages.

Example predicate formatter:
```cpp
testing::AssertionResult IsMutuallyPrime(const char* expr1, const char* expr2, int m, int n) {
  if (MutuallyPrime(m, n)) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr1 << " and " << expr2 << " are not mutually prime.";
}
EXPECT_PRED_FORMAT2(IsMutuallyPrime, x, y);
```

### Matcher-Based Assertions (`EXPECT_THAT`)

GoogleTest supports rich **matchers** allowing readable and powerful assertions:

```cpp
EXPECT_THAT(value, StartsWith("prefix"));
ASSERT_THAT(list, ElementsAre(1, 2, _, 4));
```

Matchers improve failure messages by describing expectations clearly. See the [Matchers Reference](../matchers.md) for full details.

---

## 3. Best Practices for Using Assertions

- **Prefer `EXPECT_` vs `ASSERT_` based on test flow:**
  - Use `ASSERT_` when failure means continuing is pointless or unsafe.
  - Use `EXPECT_` for soft checks allowing multiple validations in one test.

- **Add explanatory messages:**
  - Use `<<` operator to add clear messages clarifying the assertion intent and failure context.

- **Avoid over-specifying:**
  - Use matchers to verify only what’s truly necessary, avoid brittle tests.

- **Use matchers for cleaner, expressive tests:**
  - `EXPECT_THAT` combined with matchers is preferred for container and complex value checks.

- **Verify exceptions explicitly:**
  - Always use `EXPECT_THROW` or related macros to validate exceptions rather than generic Boolean tests.

- **Leverage predicates and predicate-format assertions for complex logic:**
  - Helpful for advanced checks needing detailed messages.

---

## 4. Practical Examples

### Basic Boolean Checks

```cpp
TEST(SimpleTest, BooleanConditions) {
  EXPECT_TRUE(IsReady()) << "System not ready at start";
  ASSERT_FALSE(IsError());
}
```

### Equality and Comparison

```cpp
TEST(ValueTest, BasicComparisons) {
  int result = Compute();
  EXPECT_EQ(result, 42) << "Result is not as expected";
  EXPECT_LT(result, 100);
}
```

### String Comparisons

```cpp
TEST(StringTest, CompareCStrings) {
  EXPECT_STREQ(GetName(), "Alice");
  EXPECT_STRNE(GetName(), "Bob");
  EXPECT_STRCASEEQ(GetName(), "ALICE");
}
```

### Floating-Point

```cpp
TEST(FloatTest, ApproxEqual) {
  EXPECT_FLOAT_EQ(ComputeValue(), 3.14159f);
  EXPECT_NEAR(ComputeValue(), 3.14f, 0.01f);
}
```

### Exception Verification

```cpp
TEST(ExceptionTest, ThrowsOnError) {
  EXPECT_THROW({ FunctionUnderTest(-1); }, std::invalid_argument);
  EXPECT_NO_THROW({ FunctionUnderTest(1); });
}
```

### Predicate Assertions

```cpp
bool IsPrime(int n) { ... }
TEST(PrimeTest, VerifyPrimality) {
  EXPECT_PRED1(IsPrime, 7);
}
```

### Predicate Formatter Example

```cpp
testing::AssertionResult IsPositive(const char* expr, int val) {
  if (val > 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << expr << " is not positive";
}

TEST(PositivityTest, AssertPositive) {
  EXPECT_PRED_FORMAT1(IsPositive, value);
}
```

### Using `EXPECT_THAT` with Matchers

```cpp
#include <gmock/gmock.h>
using ::testing::StartsWith;
using ::testing::ElementsAre;

TEST(MatcherTest, UseMatchers) {
  EXPECT_THAT("GoogleTest", StartsWith("Google"));

  std::vector<int> v = {1, 2, 3};
  EXPECT_THAT(v, ElementsAre(1, 2, 3));
}
```

---

## 5. Troubleshooting Tips

- If assertions fail unexpectedly, run your test with `--gtest_print_time` or `--gmock_verbose=info` to gather detailed failure messages and call traces.
- For exception assertions, wrap multi-line code blocks inside `{}` braces.
- Avoid side effects inside matcher predicates or custom predicates to prevent undefined behavior.
- Use `EXPECT_` instead of `ASSERT_` when you want to continue checking other assertions after a failure.
- When comparing strings, ensure you use the appropriate string comparison macros to avoid pointer comparison pitfalls.

---

## 6. Next Steps & Related Content

- Explore [Value- and Type-Parameterized Tests](../parameterized-tests.md) to reuse assertions in multiple contexts.
- Learn how to write custom [Matchers](../matchers.md) and use `EXPECT_THAT` for advanced assertions.
- For integration of assertions within mock expectations and actions, see [Using GoogleMock](../using-gmock.md).
- Review the [Assertions Reference](reference/assertions.md) for a complete list and details of assertion macros.

---

## Additional Resources

- [GoogleTest Assertions Guide](https://google.github.io/googletest/reference/assertions.html)
- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)

---

For advanced validation, always prefer using matchers with `EXPECT_THAT`, and custom predicates with predicate-format assertions for clearer and insightful failure messages.

---

*This guide is focused exclusively on assertion usage within the GoogleTest testing framework to maximize test reliability, readability, and maintainability.*

---

# Appendix: Common Assertion Macros Summary

| Assertion                  | Purpose                                                                |
|----------------------------|------------------------------------------------------------------------|
| `EXPECT_TRUE/ASSERT_TRUE`  | Verify condition is true                                                |
| `EXPECT_FALSE/ASSERT_FALSE`| Verify condition is false                                               |
| `EXPECT_EQ/ASSERT_EQ`      | Verify equality (==) of two values                                     |
| `EXPECT_NE/ASSERT_NE`      | Verify inequality (!=)                                                  |
| `EXPECT_LT/ASSERT_LT`      | Verify less than (<)                                                   |
| `EXPECT_LE/ASSERT_LE`      | Verify less or equal (<=)                                              |
| `EXPECT_GT/ASSERT_GT`      | Verify greater than (>)                                                |
| `EXPECT_GE/ASSERT_GE`      | Verify greater or equal (>=)                                           |
| `EXPECT_STREQ/ASSERT_STREQ`| Verify equality of C strings by contents                               |
| `EXPECT_STRNE/ASSERT_STRNE`| Verify inequality of C strings by contents                            |
| `EXPECT_STRCASENE/ASSERT_STRCASENE`| Case-insensitive string inequality                                   |
| `EXPECT_FLOAT_EQ/ASSERT_FLOAT_EQ` | Approximate equality for floats                                    |
| `EXPECT_DOUBLE_EQ/ASSERT_DOUBLE_EQ`| Approximate equality for doubles                                  |
| `EXPECT_NEAR/ASSERT_NEAR`  | Check values are near within absolute error bounds                     |
| `EXPECT_THROW/ASSERT_THROW`| Check code throws specified exception                                 |
| `EXPECT_NO_THROW/ASSERT_NO_THROW`| Check code does not throw any exception                              |
| `EXPECT_ANY_THROW/ASSERT_ANY_THROW`| Check code throws any exception                                    |
| `EXPECT_THAT/ASSERT_THAT` | Combine with matchers for flexible expectations                        |

---

---

<section>Documentation generated and maintained by GoogleTest Team.</section>
