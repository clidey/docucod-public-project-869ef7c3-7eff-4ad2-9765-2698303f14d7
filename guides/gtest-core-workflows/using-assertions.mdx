---
title: "Essential Assertions and How to Use Them"
description: "Demonstrates the core assertion macros in GoogleTest, including equality, exception, and predicate-based assertions. Offers practical tips and real-world examples, helping users achieve expressive and informative test coverage."
---

# Essential Assertions and How to Use Them

This guide demonstrates the core assertion macros provided by GoogleTest. It covers how to use assertions for equality checks, exception handling, and predicate-based validations. By following this guide, users will learn to write expressive and informative tests that give clear feedback when tests fail.

---

## 1. Understanding Assertions in GoogleTest

Assertions are essential for verifying program behavior during testing. GoogleTest offers a rich collection of assertion macros designed to cover common verification needs with clear and actionable outcomes.

### Assertion Types Overview

- `EXPECT_*`: Generates **nonfatal** failures—test continues running after a failure.
- `ASSERT_*`: Generates **fatal** failures—test aborts the current function when failed.

### Custom Failure Messages

You can append additional context to any assertion using the insertion operator `<<`. This is vital to give more details about failures:

```cpp
EXPECT_EQ(value, expected) << "Value doesn't match expected result";
```

---

## 2. Essential Assertion Categories

### 2.1 Basic Boolean Assertions

Use these to check simple true/false conditions.

- **EXPECT_TRUE(condition)** / **ASSERT_TRUE(condition)**
  - Verifies that `condition` is `true`.

- **EXPECT_FALSE(condition)** / **ASSERT_FALSE(condition)**
  - Verifies that `condition` is `false`.

**Example:**

```cpp
EXPECT_TRUE(ptr != nullptr) << "Pointer should not be null";
ASSERT_FALSE(value == 0) << "Zero value is unexpected here";
```

### 2.2 Equality and Comparison Assertions

Compare values with relational operators, ensuring correctness in computations and states.

- Equality checks:
  - `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — checks `val1 == val2`.
  - `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — checks `val1 != val2`.

- Ordering checks:
  - `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)` — `val1 < val2`.
  - `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)` — `val1 <= val2`.
  - `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)` — `val1 > val2`.
  - `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)` — `val1 >= val2`.

**Important:**
- For pointers and strings, use specialized assertions (e.g., `EXPECT_STREQ`) to compare contents rather than addresses.

**Example:**

```cpp
ASSERT_EQ(Factorial(3), 6) << "Factorial calculation failed for 3";
EXPECT_LT(result.size(), 100) << "Result unexpectedly large";
```

### 2.3 String Assertions

Specialized for C strings and wide-character strings, verifying content equality or inequality with or without case sensitivity.

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` — check exact content equality.
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)` — check content inequality.
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)` — check case-insensitive equality.
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)` — check case-insensitive inequality.

**Example:**

```cpp
EXPECT_STREQ(response.c_str(), "OK");
ASSERT_STRCASEEQ(header, "content-type");
```

### 2.4 Floating-Point Comparisons

Due to precision issues, use these to check approximate equality with proper error bounds.

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)` — for `float` values, within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)` — for `double` values, within 4 ULPs.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` — check that absolute difference is at most `abs_error`.

**Example:**

```cpp
EXPECT_FLOAT_EQ(computed_value, expected_value) << "Float comparison failure";
ASSERT_NEAR(measured, target, 0.01) << "Measurement out of acceptable bounds";
```

### 2.5 Exception Assertions

Verify whether code throws or does not throw exceptions.

- `EXPECT_THROW(statement, ExceptionType)` / `ASSERT_THROW(statement, ExceptionType)` — check that `statement` throws specified exception.
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)` — check that `statement` throws any exception.
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)` — check that `statement` throws no exceptions.

**Example:**

```cpp
EXPECT_THROW(ParseConfig("invalid"), std::runtime_error);
ASSERT_NO_THROW(OpenFile("test.txt"));
```

### 2.6 Predicate Assertions

Use predicate functions or functors to check complex conditions while receiving detailed failure messages with argument values.

- `EXPECT_PRED1`, `EXPECT_PRED2`, ..., `ASSERT_PRED1`, `ASSERT_PRED2`, ... allow checking predicates of arity 1 to 5.
- `EXPECT_PRED_FORMAT*` / `ASSERT_PRED_FORMAT*` allow custom formatting of failure messages.

**Use Case:**

Suppose you have a function that validates a condition that involves multiple parameters and you want a clear report on failure.

**Example:**

```cpp
bool IsSorted(const std::vector<int>& v);
...
EXPECT_PRED1(IsSorted, my_vector) << "Vector is not sorted!";
```

For custom messages:

```cpp
AssertionResult AssertIsSorted(const char* expr, const std::vector<int>& v) {
  if (IsSorted(v)) return AssertionSuccess();
  return AssertionFailure() << expr << " is not sorted.";
}

EXPECT_PRED_FORMAT1(AssertIsSorted, my_vector);
```

---

## 3. Quick-Start: Adding Assertions to Your Tests

Follow these steps to incorporate assertions into your tests effectively.

<Steps>
<Step title="Include the Header">
Make sure to include the main GoogleTest header at the top of your test file:

```cpp
#include <gtest/gtest.h>
```
</Step>
<Step title="Use EXPECT_ or ASSERT_ Macros">
Decide whether test execution should continue after failures.

- Use `EXPECT_` macros to record failures but continue.
- Use `ASSERT_` macros to abort the current test function after failure (use sparingly).
</Step>
<Step title="Write Assertions With Contextual Messages">
Add assertions checking conditions relevant to your test.

Example:

```cpp
EXPECT_EQ(calculated_value, expected_value) << "Calculation mismatch";
ASSERT_TRUE(is_valid) << "Validation failed";
```
</Step>
<Step title="Run Tests and Inspect Failure Reports">
Compile and run your tests. When tests fail, GoogleTest will print expressions, their evaluated values, and your custom messages.

Use these messages to debug and refine your code or tests.
</Step>
</Steps>

---

## 4. Practical Examples

### 4.1 Basic Equality Assertion

```cpp
TEST(FactorialTest, CalculatesCorrectly) {
  EXPECT_EQ(Factorial(0), 1);
  EXPECT_EQ(Factorial(5), 120);
}
```

### 4.2 Testing Exceptions

```cpp
TEST(ConfigTest, ThrowsOnInvalidPath) {
  EXPECT_THROW({ LoadConfig("bad_path"); }, std::runtime_error);
}
```

### 4.3 Predicate Assertion with Custom Formatter

```cpp
// Predicate-formatter to assert two numbers are co-prime.
AssertionResult AssertCoPrime(const char* expr1, const char* expr2, int a, int b) {
  if (GCD(a, b) == 1) return AssertionSuccess();
  return AssertionFailure() << expr1 << " and " << expr2 << " (" << a << " and " << b << ") share common divisors.";
}

TEST(NumberTest, CheckCoPrime) {
  EXPECT_PRED_FORMAT2(AssertCoPrime, 15, 28);  // passes
  EXPECT_PRED_FORMAT2(AssertCoPrime, 10, 20);  // fails
}
```

### 4.4 String Comparisons

```cpp
TEST(EqualityTest, CaseInsensitiveCompare) {
  EXPECT_STRCASEEQ("Hello", "hello");
  EXPECT_STRCASENE("Hello", "world");
}
```

### 4.5 Floating-Point Approximate Equality

```cpp
TEST(FloatTest, NearComparison) {
  EXPECT_NEAR(3.14159f, ComputePi(), 0.0001f);
  ASSERT_DOUBLE_EQ(2.71828, ComputeE());
}
```

---

## 5. Tips, Best Practices, and Common Pitfalls

- Use `EXPECT_` assertions when the test can safely continue after failure to capture multiple issues in a single run.
- Use `ASSERT_` assertions sparingly to avoid skipping cleanup and causing test crashes.
- Always check pointers before dereferencing; use `ASSERT_NE(ptr, nullptr)` to guard.
- For comparing strings, prefer the specialized string assertions instead of generic `EXPECT_EQ`.
- Use predicate and predicate-format assertions for complex logical checks. They provide clearer diagnostics than ad-hoc `EXPECT_TRUE`.
- Avoid side effects within assertions since arguments are evaluated once but order is unspecified.
- Add custom streaming messages to enrich failure contexts.
- For floating-point, never use `EXPECT_EQ` directly; instead use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR`.
- Enable exception assertions only if exceptions are enabled in your build environment.

---

## 6. Troubleshooting Common Assertion Issues

### Unexpected Test Continuation After Fatal Failures

Remember that `ASSERT_*` macros abort only the current function, not the entire test. Fatal failures in helper functions won't stop the test unless explicitly propagated.

Use `ASSERT_NO_FATAL_FAILURE()` or wrapping logic to ensure fatal failures propagate as expected.

### Confusing Failure Messages Due to Pointer Comparisons

Comparisons like `EXPECT_EQ(ptr1, ptr2)` compare pointer addresses, not content. For strings or arrays, always use string assertions or custom predicates.

### Floating-Point Failures Due to Precision

Floating-point equality is sensitive to tiny differences. Prefer approximate equality assertions like `EXPECT_NEAR`.

### Exceptions Are Not Caught

Check if exceptions are enabled in builds. Exception assertions only work if exceptions are supported and enabled.

### Predicate Assertions Are Not Printing Useful Messages

Ensure your predicate returns an `AssertionResult` with informative messages. For more customization, use predicate-format assertions (`EXPECT_PRED_FORMAT*`).

---

## 7. Next Steps & Related Content

- Explore the [GoogleTest Primer](primer.md) to understand test writing basics and framework concepts.
- Read [Writing and Running Your First Test](guides/gtest-core-workflows/writing-and-running-tests) for hands-on test creation.
- Dive into [Parameterized and Typed Tests](guides/gtest-core-workflows/parameterized-testing) to write flexible tests.
- Investigate [Death Tests](guides/gtest-core-workflows/death-tests) for robustness checking.
- Visit the [Assertions Reference](reference/assertions.md) for a complete list of assertion macros.

---

For comprehensive understanding, pair this guide with the GoogleTest core testing concepts and API references. These foundational guides provide the context and further detail needed to leverage GoogleTest to its fullest potential in your C++ testing projects.

---