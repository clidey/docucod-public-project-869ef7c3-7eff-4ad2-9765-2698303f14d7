---
title: "Set Up Your Project"
description: "Follow detailed steps to integrate GoogleTest (and optionally GoogleMock) into your C++ project using CMake or Bazel. Learn how to configure build systems, link test libraries, and organize test code for maintainability. This guide ensures you can start testing quickly in any environment."
---

# Set Up Your Project

This guide walks you through integrating GoogleTest (and optionally GoogleMock) into your C++ project using popular build systems: **CMake** and **Bazel**. You will configure your project files to download, build, and link GoogleTest libraries seamlessly so you can start writing and running tests quickly in any environment.

---

## Workflow Overview

- **Task Description:** Configure your C++ project to include GoogleTest and GoogleMock test frameworks using a build system, enabling you to compile and run tests efficiently.
- **Prerequisites:**
  - A C++ project ready to be tested.
  - A working installation of a supported build system (CMake >= 3.14 or Bazel).
  - A compatible C++ compiler supporting at least C++17.
  - Internet access to fetch GoogleTest source (unless vendored locally).
- **Expected Outcome:**
  - Your project can build test binaries linked against GoogleTest or GoogleMock.
  - Tests can be discovered and executed via your build environment.
- **Time Estimate:** Approximately 15–30 minutes depending on familiarity and environment.
- **Difficulty Level:** Beginner to Intermediate.

---

## Set Up Your Project Using CMake

CMake is a versatile and widely used cross-platform build system that simplifies managing your test dependencies.

### 1. Create or Update Your `CMakeLists.txt`

Start by declaring a minimum CMake version and your project details:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Ensure C++17 standard is enabled
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### 2. Use `FetchContent` to Download GoogleTest

Include the CMake FetchContent module to retrieve GoogleTest sources at configure time:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
# Optional: Force dynamic runtime on Windows for compatibility
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)
```

> **Tip:** Update the URL or tag to track the latest stable GoogleTest release.

### 3. Declare Your Test Executable

Add your test source code to an executable. For example, if your test file is `hello_test.cc`:

```cmake
add_executable(
  hello_test
  hello_test.cc
)
```

### 4. Link Against GoogleTest Libraries

Link your test binary with the `gtest_main` library, which provides a default `main()` function:

```cmake
target_link_libraries(
  hello_test
  GTest::gtest_main
)
```

If you want GoogleMock support, link against `gmock_main` instead.

### 5. Enable CTest Integration

This sets up CMake to discover and run your tests automatically:

```cmake
enable_testing()
include(GoogleTest)
gtest_discover_tests(hello_test)
```

### 6. Build and Run Your Tests

In your project root directory, run the following commands:

```bash
cmake -S . -B build
cmake --build build
cd build
ctest
```

You should see output indicating tests passed:

```
Test project /path/to/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.01 sec

100% tests passed, 0 tests failed out of 1
```

<Check>
Ensure your `CMakeLists.txt` links to the correct GoogleTest target (`GTest::gtest_main` or `GMock::gmock_main`) and that you enabled testing with `enable_testing()`.
</Check>

### Example Complete `CMakeLists.txt`

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

enable_testing()

add_executable(hello_test hello_test.cc)
target_link_libraries(hello_test GTest::gtest_main)
include(GoogleTest)
gtest_discover_tests(hello_test)
```

---

## Set Up Your Project Using Bazel

Bazel is another powerful build tool often used with GoogleTest.

### 1. Add GoogleTest as a Dependency

Add the GoogleTest repository to your `WORKSPACE` file:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.17.0.zip"],
    strip_prefix = "googletest-release-1.17.0",
)
```

### 2. Declare a Bazel Test Target

In your `BUILD` file, define a test executable linked with GoogleTest. For example:

```python
cc_test(
    name = "hello_test",
    srcs = ["hello_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

### 3. Build and Run Tests

From the command line:

```bash
bazel test //:hello_test
```

You will see test output and results indicating success or failure.

---

## Organizing Test Code for Maintainability

- **Test Source Files**: Keep your test files in a dedicated directory such as `tests/` or next to source code files.
- **Use Test Fixtures**: To share setups, use `TEST_F` with fixtures.
- **Keep Tests Small and Focused**: Each test should verify a small unit of behavior.
- **Naming Conventions**: Use descriptive test suite and test names without underscores for clarity.

---

## Additional Notes

- **Using `gtest_main` vs. Writing Your Own `main()`**: Linking with `gtest_main` saves time by providing a default `main()` entry point. Only write your own `main()` if you need custom initialization.

- **Platform Specifics**: Some platforms such as embedded (ESP32, QURT) may have customized entry points —see the `gtest_main.cc` file for platform-specific behavior.

- **GoogleMock Integration**: To use GoogleMock features, link against `gmock_main` instead of `gtest_main`.

---

## Troubleshooting Tips

<AccordionGroup title="Common Setup Issues and Solutions">
<Accordion title="Fetching GoogleTest via FetchContent Fails">
Make sure your build environment has internet access. Alternatively, vendor GoogleTest source locally and add it via `add_subdirectory`.
</Accordion>
<Accordion title="Linker Errors Related to Runtime Library Mismatch on Windows">
Set the `gtest_force_shared_crt` option to `ON` in your `CMakeLists.txt` to align runtime library linkage.
</Accordion>
<Accordion title="Tests Not Being Discovered by CTest">
Verify you called `enable_testing()` and `gtest_discover_tests()` correctly. Also, ensure test binaries are correctly linked with GoogleTest libraries.
</Accordion>
<Accordion title="Custom `main()` Needed?">
Only write your own `main()` if special command-line flag parsing or setup is required. Otherwise, link with `gtest_main` or `gmock_main` for convenience.
</Accordion>
</AccordionGroup>

---

## Next Steps & Related Content

- [Writing Your First Tests](/guides/getting-started-core-workflows/writing-your-first-tests) to create meaningful test cases.
- [Running Tests and Interpreting Results](/guides/getting-started-core-workflows/running-tests-and-interpreting-results) for verifying test outcomes.
- [Using Assertions Effectively](/guides/real-world-usage-and-best-practices/using-assertions-effectively) to ensure robust verification.
- Consult the [GoogleTest Primer](docs/primer.md) for fundamental concepts.

---

<Info>
This guide focuses on integrating GoogleTest and GoogleMock into your development workflow. If using other build systems or advanced features, please refer to specific documentation tailored to those contexts.
</Info>
