---
title: "Managing Mock Strictness and Expectations"
description: "Understand and control how GoogleMock handles unexpected calls using NiceMock, NaggyMock, and StrictMock wrappers. Learn when to relax or enforce expectations for readable, reliable tests."
---

# Managing Mock Strictness and Expectations

## Overview

This guide helps you understand and control the behavior of GoogleMock when dealing with unexpected method calls on mock objects. It focuses specifically on using the wrappers `NiceMock`, `NaggyMock`, and `StrictMock` to manage how strictly mock expectations are enforced. By adjusting strictness, you can make your tests either more forgiving or more rigorous, improving clarity, reliability, and maintainability.

---

## What You'll Learn
- The difference between uninteresting and unexpected mock calls
- How `NiceMock`, `NaggyMock`, and `StrictMock` behave differently
- When to use each of these wrappers in your tests
- Handling mocks with non-default constructors
- Best practices and tips for working with mocks and expectations

## Prerequisites
- Familiarity with GoogleMock basics including defining mock classes and setting expectations using `EXPECT_CALL`.
- Understanding of mock method calls, matchers, and default actions.
- Basic knowledge of writing and running tests with GoogleTest and GoogleMock.

## Time Estimate
10-15 minutes to read, understand the behavioral differences and try out examples.

## Difficulty Level
Intermediate â€” assumes familiarity with mock objects and expectations in GoogleMock.

---

## Understanding Mock Call Strictness

When your mock object receives a method call without a matching expectation (`EXPECT_CALL`), GoogleMock treats this as an *uninteresting call*. Calls that do not meet any `EXPECT_CALL` but are still allowed are called *uninteresting calls*, whereas calls that do not match any expectation when some expectations are present are *unexpected calls*.

- **Uninteresting Call**: No `EXPECT_CALL` exists for this method with those arguments.
- **Unexpected Call**: One or more `EXPECT_CALL`s exist on the method but none match the arguments of this call.

### Default Behavior
- By default, uninteresting calls generate **warnings** but do not fail tests.
- Unexpected calls always cause **test failures**.

### Wrappers for Mock Strictness Control
GoogleMock provides three template wrappers to control this behavior:

| Wrapper            | Behavior on Uninteresting Call                    | Use Case Example                            |
|--------------------|--------------------------------------------------|--------------------------------------------|
| `NiceMock<T>`      | **Suppresses warnings** on uninteresting calls.  | Use when you want to ignore unexpected calls to unmocked methods often for cleaner test output. |
| `NaggyMock<T>`     | Prints **warnings** on uninteresting calls.      | Default mock behavior. Useful during test development or debugging. |
| `StrictMock<T>`    | Treats uninteresting calls as **test failures**. | Use when you want your tests to enforce that no unexpected calls happen, making test failures explicit. |

### Important Notes
- These wrappers only affect *uninteresting calls*.
- They do **not** affect *unexpected calls*, which always cause test failures.
- `NiceMock`, `NaggyMock`, and `StrictMock` inherit their mock class constructors, so you can construct them using the same arguments as the underlying mock.

---

## How to Use `NiceMock`, `NaggyMock`, and `StrictMock`

Here's a practical example illustrating each wrapper's usage:

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(int, DoThat, (bool flag), ());
};

// Using default mock (equivalent to NaggyMock)
TEST(ExampleTest, DefaultNaggyMock) {
  NaggyMock<MockFoo> mock;
  EXPECT_CALL(mock, DoThis());

  mock.DoThis();      // Allowed and expected.
  mock.DoThat(true);  // Warning generated: uninteresting call.
}

// Using NiceMock: suppresses warnings for uninteresting calls
TEST(ExampleTest, NiceMockSuppressesWarnings) {
  NiceMock<MockFoo> mock;
  EXPECT_CALL(mock, DoThis());

  mock.DoThis();      // Allowed and expected.
  mock.DoThat(true);  // No warnings; call ignored.
}

// Using StrictMock: errors on uninteresting calls
TEST(ExampleTest, StrictMockFailsOnUninterestingCalls) {
  StrictMock<MockFoo> mock;
  EXPECT_CALL(mock, DoThis());

  mock.DoThis();      // Allowed and expected.
  mock.DoThat(true);  // Test fails: unexpected/uninteresting call.
}
```

---

## Handling Mocks with Non-Default Constructors

All three wrappers support mocks whose constructors require arguments. Use arguments exactly as you would with the original mock:

```cpp
class MockBar {
 public:
  explicit MockBar(std::string name) : name_(name) {}
  MOCK_METHOD(int, Foo, (), ());

 private:
  std::string name_;
};

TEST(ExampleTest, NiceMockWithNonDefaultCtor) {
  NiceMock<MockBar> mock("test_name");
  EXPECT_CALL(mock, Foo());

  mock.Foo();
}
```

---

## Detailed Behavior

### On Uninteresting Calls

| Wrapper      | Generates Warning | Treat As Failure |
|--------------|-------------------|------------------|
| Default/Naggy| Yes               | No               |
| NiceMock     | No                | No               |
| StrictMock   | N/A (treated as failure) | Yes         |

### On Unexpected Calls

All wrappers treat unexpected calls as **test failures**.


---

## Best Practices & Tips

- **Default to NiceMock**: Use `NiceMock` unless you want extra feedback from warnings or stricter enforcement from `StrictMock`. It helps keep test outputs clean and maintenance easier.
- **Use NaggyMock during development/debugging**: Their warnings can alert you about unmocked interactions.
- **Reserve StrictMock for critical invariants**: Use it when you want your tests to strictly fail on any unmocked/unexpected interactions, e.g., for high-assurance modules.
- **Add catch-all expectations to relax strict mocks when needed**:

  ```cpp
  EXPECT_CALL(mock, MethodName(_)).Times(testing::AnyNumber());
  ```

  This tells the mock to allow calls with any arguments, suppressing failures for those calls.

- **Avoid mixing `NiceMock`, `NaggyMock`, and `StrictMock` nested inside each other**, as this is not supported and can cause unexpected behavior.
- **Ensure destructors are virtual** on your mock classes to behave correctly with these wrappers.

---

## Troubleshooting

<AccordionGroup title="Common Issues & Solutions">
<Accordion title="Missing warnings or failures when expected">
Ensure you have applied `NiceMock`, `NaggyMock`, or `StrictMock` **directly** to your mock type, not to base classes or unrelated types. Also verify your expectations with `EXPECT_CALL` are set correctly before exercising the mock.
</Accordion>

<Accordion title="Test fails unexpectedly when using StrictMock">
Check for uninteresting calls that do not have matching expectations. Add catch-all expectations or consider whether strict behavior is required.
</Accordion>

<Accordion title="No effect when nesting wrappers">
Nesting strictness wrappers like `NiceMock<StrictMock<MyMock>>` is not supported and leads to unpredictable behavior. Use only one of these wrappers per mock instance.
</Accordion>

<Accordion title="Mocks with non-virtual destructors misbehaving">
The wrappers rely on virtual destructors to correctly register and deregister behaviors. Make sure your mock classes declare destructors as `virtual`. This can prevent warnings or failures from being correctly reported.
</Accordion>

<Accordion title="Unexpected warnings despite using NiceMock">
Some compilers do not fully support strictness wrappers if mock methods are inherited from base classes. Define mock methods **directly** in the mocked class to ensure wrappers take effect.
</Accordion>
</AccordionGroup>

---

## Next Steps

- Explore the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy) for more on mock strictness patterns.
- Review [Setting Expectations](../reference/mocking.md#EXPECT_CALL) and [Default Actions](../reference/mocking.md#ON_CALL) to fine-tune mock behavior.
- Use [Troubleshooting Common Issues](../../getting-started/troubleshooting/common-issues) for resolving setup and behavior problems.
- Combine with sequence mechanisms like [`InSequence`](../reference/mocking.md#InSequence) to enforce call order in tests.

---

## Helpful References
- [GoogleMock Mocking Reference](../reference/mocking.md)
- [gMock for Dummies](../guides/getting-started/first-mock)
- [gMock Cheat Sheet](../docs/gmock_cheat_sheet.md)
- [gMock Cookbook](../docs/gmock_cook_book.md#NiceStrictNaggy)

---

## Summary
This documentation page explains how to manage mock object strictness and expectations in GoogleMock using `NiceMock`, `NaggyMock`, and `StrictMock` wrappers. It guides you in controlling warnings and failures triggered by uninteresting or unexpected mock calls, helping keep your tests readable and reliable. You will learn when and how to apply each wrapper, handle mocks with custom constructors, and avoid common pitfalls for clean, maintainable tests.


---

<Check>
Always set clear expectations for your mocks to avoid surprises.
Prefer `NiceMock` for cleaner test outputs unless strict verification is required.
Consider adding catch-all expectations to relax strict mocks.
Ensure virtual destructors on your mocks to guarantee proper behavior.
</Check>

---