---
title: "Setting Up Continuous Integration"
description: "A practical guide for integrating your tests with CI systems such as GitHub Actions, Travis CI, or Google’s internal systems. Explores best practices for running, reporting, and maintaining tests in automated pipelines."
---

# Setting Up Continuous Integration

This guide provides a practical, actionable walkthrough to integrate your GoogleTest-based test suites with Continuous Integration (CI) systems such as GitHub Actions, Travis CI, or Google’s internal CI pipelines. You will learn best practices to run, report, and maintain your tests in automated pipelines, ensuring robust, scalable, and informative test automation.

---

## 1. Workflow Overview

### Task Description
Integrate GoogleTest tests into CI systems to automate test execution, gather results, and maintain test workflows reliably and efficiently.

### Prerequisites
- A GoogleTest-enabled C++ test suite built and runnable locally.
- Familiarity with your chosen CI platform (e.g., GitHub Actions, Travis CI).
- Project configured with CMake or Bazel to build and run tests.

### Expected Outcome
- Automated pipeline that builds your project and runs GoogleTest tests.
- Test results captured, including pass/fail status and detailed logs.
- XML or JSON test reports generated for CI dashboards.

### Time Estimate
About 30–60 minutes to configure a basic CI workflow.

### Difficulty Level
Intermediate—requires understanding of build systems and basic CI configuration.

---

## 2. Step-by-Step Instructions

### Step 1: Prepare Your Test Binary for CI

1. Ensure your test executable is built with GoogleTest integrated, either via CMake or Bazel.
2. Enable test discovery if using CMake by including `gtest_discover_tests()` as shown in the [CMake Quickstart](docs/quickstart-cmake.md).
3. Confirm the ability to run tests locally with verbose output and XML or JSON reporting.

Example command with XML output:

```bash
./your_test_binary --gtest_output=xml:report.xml
```

Expected result: an XML file `report.xml` generated with detailed test results.


### Step 2: Choose Your CI Platform and Define Workflow

1. Create a CI configuration file in your repository:
   - GitHub Actions: `.github/workflows/ci.yml`
   - Travis CI: `.travis.yml`
   - Google Cloud Build or Kokoro: defined in their respective config files.

2. Configure the CI environment to install dependencies like compilers, CMake/Bazel, and build tools.

3. Add steps to:
   - Checkout the source code.
   - Configure the build.
   - Build the test executable.
   - Run the tests with options to output test reports.


### Step 3: Example: GitHub Actions Basic Workflow

```yaml
name: Build and Test

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3

    - name: Install dependencies
      run: sudo apt-get update && sudo apt-get install -y build-essential cmake

    - name: Configure
      run: cmake -S . -B build -DCMAKE_BUILD_TYPE=Release

    - name: Build
      run: cmake --build build -- -j$(nproc)

    - name: Run tests
      run: ctest --output-on-failure --test-dir build

    - name: Generate XML report
      run: ./build/your_test_binary --gtest_output=xml:build/test_report.xml

    - name: Upload test report
      uses: actions/upload-artifact@v3
      with:
        name: test-results
        path: build/test_report.xml
```

Expected outcome:
- Tests run with output visible in the CI logs.
- XML report archived as an artifact for further use.


### Step 4: Example: Bazel-based CI Integration

1. Use a similar workflow but replace CMake with Bazel commands:

```bash
bazel test //... --test_output=errors --build_tests_only
```

2. Capture output logs and test results.


### Step 5: Best Practices for CI Integration

- **Run tests with `--gtest_output`** set to `xml` or `json` to generate machine-readable reports.
- **Parallelize test runs** using CTest or Bazel test shards to reduce total pipeline time.
- **Use environment variables for filtering tests** (`--gtest_filter`) to run subsets during incremental builds.
- **Prevent flaky tests:** Employ `--gtest_repeat` in debugging flaky tests.
- **Fail-fast option:** Enable `--gtest_fail_fast` to stop on the first failure during iterative debugging.


### Step 6: Maintain and Monitor

- Ensure that test reports are uploaded or published to your CI dashboard.
- Use test result output to enforce quality gates.
- Periodically verify CI environment matches local build for consistency.

---

## 3. Examples & Configurations

### Example CMakeLists.txt Snippet for Testing

```cmake
enable_testing()

add_executable(
  my_tests
  test_file1.cc
  test_file2.cc
)
target_link_libraries(my_tests GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(my_tests)
```

### Example Bazel BUILD File Snippet

```bazel
cc_test(
    name = "my_tests",
    srcs = ["test_file1.cc", "test_file2.cc"],
    deps = ["@googletest//:gtest_main"],
)
```

### Using Environment Variables to Control Test Running in CI

```yaml
- name: Run subset of tests
  env:
    GTEST_FILTER: "MySuite.MyTest"
  run: ./my_tests
```

### Example XML Report Upload in Travis CI

```yaml
after_script:
  - ./my_tests --gtest_output=xml:report.xml
  - bash <(curl -s https://codecov.io/bash) -f report.xml
```

---

## 4. Troubleshooting & Tips

### Common Issues

- **Tests do not run or are not discovered:**
  - Ensure `enable_testing()` and `gtest_discover_tests()` calls are in your CMake setup.
  - Confirm Bazel tests are defined with `cc_test` and include `:gtest_main`.

- **XML/JSON reports missing or malformed:**
  - Verify `--gtest_output` path is writable.
  - Make sure test binary is executed from the correct working directory.

- **CI build hangs or fails unexpectedly:**
  - Increase timeouts if running long-running tests.
  - Use `--gtest_break_on_failure` locally to debug failures.

### Best Practices

- Use CI caching and vendor mode for build dependencies (e.g., Bazel vendor mode) to increase speed.
- Limit use of `DISABLED_` tests in the long term; maintain a clean test suite.
- Regularly update compiler versions and test C++ standard compliance as noted in [System Requirements](getting-started/prerequisites-installation/system-requirements).

### Performance Considerations

- Use parallelism options available in your CI and test tools.
- Configure tests to reuse expensive shared setups via `SetUpTestSuite()` and `TearDownTestSuite()`.
- Avoid unnecessary rebuilding by leveraging CI build caches.

### Alternative Approaches

- Utilize external test runners like [gtest-parallel](https://github.com/google/gtest-parallel) for speeding test runs.
- Employ custom TestEventListeners to integrate with specialized test reporting tools.

---

## 5. Next Steps & Related Content

- Explore the [Integration with Build & CI Systems](overview/audience-usecases-integration/integration-points) page for detailed compatibility notes.
- Learn [Building with CMake](docs/quickstart-cmake.md) or [Bazel](docs/quickstart-bazel.md) to set up your build system compatible with CI.
- See [Organizing and Structuring Test Code](guides/best-practices-patterns/test-organization) for maintainable test suites.
- For diagnosing CI test failures, consult [Troubleshooting Setup Issues](getting-started/project-setup-validation/troubleshooting-setup).
- Consider advanced test execution with [Improving Test Performance](guides/best-practices-patterns/performance-optimization).

---

# Summary

This guide equips you to set up and maintain continuous integration pipelines for GoogleTest, automating builds, test runs, and results reporting on platforms like GitHub Actions and Travis CI. Core coverage includes preparing test binaries for CI, example workflows, build system integration, and robust troubleshooting practices.

**Key Sections:**
- Preparing tests for CI
- Defining CI workflows
- Example configurations for CMake and Bazel
- Troubleshooting and best practices

**Important Links:**
- [CMake Quickstart](docs/quickstart-cmake.md)
- [Bazel Quickstart](docs/quickstart-bazel.md)
- [Integration Points](overview/audience-usecases-integration/integration-points)
- [Project Setup & Validation](getting-started/project-setup-validation/configuring-project)

**Next Steps:**
- Configure your CI environment with example pipelines.
- Optimize performance and parallel test execution.
- Explore further documentation on test organization and debugging.

---

# Additional Resources
- Official GoogleTest documentation: https://google.github.io/googletest/
- Sample GitHub Actions workflows: https://github.com/actions/starter-workflows/blob/main/ci/cmake.yml
- Bazel testing guide: https://docs.bazel.build/versions/main/test-encyclopedia.html
- Troubleshooting CI issues: [Troubleshooting Setup Issues](getting-started/project-setup-validation/troubleshooting-setup)

