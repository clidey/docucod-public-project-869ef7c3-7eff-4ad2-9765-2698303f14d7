---
title: "Continuous Integration Best Practices"
description: "Walks through best practices for running GoogleTest suites in CI pipelines, including recommended flags, failure handling, parallelization techniques, and interpreting results for sustained quality."
---

# Continuous Integration Best Practices

## Overview

This guide walks you through the essential best practices for running GoogleTest suites within Continuous Integration (CI) pipelines. Leveraging these recommendations will help you maintain high-quality, reliable C++ test automation, efficiently handle test failures, optimize runtimes with parallelization, and interpret results effectively for long-term project success.

## Prerequisites

- A working GoogleTest setup integrated into your build environment.
- Access to your CI system configuration.
- Basic familiarity with running tests via command line.

## Expected Outcome

By following this guide, you will be able to:
- Configure GoogleTest runs optimized for CI environments.
- Apply recommended command-line flags to control test output and failure behaviors.
- Implement parallel test execution strategies to reduce feedback loops.
- Monitor and interpret test outcomes effectively for sustained quality.

## Time Estimate

Setting up and tuning your GoogleTest runs for CI can typically be accomplished within 30-60 minutes, depending on your build system and existing CI configuration.

## Difficulty Level

Intermediate: Requires some familiarity with CI pipeline configuration and test automation.

---

## 1. Running GoogleTest in Continuous Integration

### 1.1 Basic Command to Run Tests in CI

Use the following command in your CI scripts to execute all tests:

```bash
./your_test_executable --gtest_output=xml:report.xml
```

This generates an XML report (`report.xml`) compatible with the CI system to visualize test results.

### 1.2 Recommended Flags

- `--gtest_output=xml:<file>`
  - Outputs test results in XML format.

- `--gtest_color=no`
  - Disables ANSI colors for clean console output in many CI systems.

- `--gtest_filter=`
  - Allows selective testing if full suite runs are too costly.

- `--gtest_repeat=<N>`
  - Runs tests N times to catch flaky behavior.

- `--gtest_shuffle`
  - Randomizes test execution order to detect inter-test dependencies.

- `--gtest_break_on_failure`
  - Useful locally, but avoid in CI to allow collecting all failures before aborting.

- `--gtest_catch_exceptions=0`
  - Optionally disables catching exceptions; only if your environment requires it.

### 1.3 Example Full Command

```bash
./your_test_executable \
  --gtest_output=xml:report.xml \
  --gtest_color=no \
  --gtest_shuffle
```

### 1.4 Tips

- Always capture and archive the XML test report for later analysis.
- Use CI-specific plugins or steps to parse and show test results with fail/pass status.

---

## 2. Handling Failures and Flaky Tests

### 2.1 Flaky Tests Identification

To identify flaky tests that intermittently fail:

- Use the `--gtest_repeat` flag to run your test suite multiple times in CI.
- Use `--gtest_shuffle` to randomize the order.

Example:

```bash
./your_test_executable --gtest_repeat=10 --gtest_shuffle
```

If a test fails intermittently, it will appear only on some runs.

### 2.2 Isolation and Debugging

- When flaky tests are found, isolate them by running with filters:

  ```bash
  ./your_test_executable --gtest_filter=TestSuite.TestName
  ```

- Use `--gtest_break_on_failure` locally for easier debugging.

- Avoid using `--gtest_break_on_failure` in CI pipelines to allow all test results to be collected.

### 2.3 Test Failures Reporting

- Make sure test failures cause CI jobs to fail immediately.
- Use the XML results to pinpoint exact test failures.

- Configure notification mechanisms (email, messaging) for developers.

---

## 3. Optimizing Test Runs with Parallelization

Running tests sequentially can slow down feedback in CI. Parallel execution reduces the wall-clock time.

### 3.1 Options for Parallel Testing

- **Using GoogleTest's Own Parallel Test Execution**:

  GoogleTest has no built-in parallel test runner by default; you must run multiple test executables or split tests manually.

- **Splitting Tests by Binaries**:

  - Split your test suite into multiple smaller executables.
  - Run these executables concurrently in parallel CI jobs.

- **Splitting Tests Within a Single Executable**:

  - Use `--gtest_filter` to run subsets of tests in parallel workers.

- **Using Third-Party Tools**:

  - Integrate with build system parallelism (e.g., Bazel, CMake's ctest parallelism).

### 3.2 Example Parallel Execution

With GNU Parallel or a CI matrix:

```bash
# Split tests manually or generate test list
TESTS=(TestSuite1.* TestSuite2.* TestSuite3.*)

parallel -j4 './your_test_executable --gtest_filter={}' ::: "${TESTS[@]}"
```

### 3.3 Managing Test Dependencies

- Avoid tests that depend on each other's side effects.
- Use test fixtures and proper setup/teardown to isolate tests fully.

---

## 4. Continuous Monitoring and Reporting

### 4.1 Test Result Artifacts

- Always generate XML test reports (`--gtest_output=xml`) to feed CI's test reporting.
  
- Archive logs and any core dumps or artifacts related to test failures.

### 4.2 Handling Large Logs

- Configure CI to truncate logs or upload logs as separate artifacts to avoid cluttering the main build log.

### 4.3 Verbosity Control

- Use `--gmock_verbose` flag to control logging:

  - `info` for detailed invocation logging (mainly for debugging).

  - `warning` (default) for warnings and errors only.

  - `error` for errors only in stable CI runs.

- Tweak verbosity based on CI troubleshooting needs.

### 4.4 Notifications and Alerts

- Set up integrations with messaging tools or email for test failures.

- Use dashboards that aggregate flaky test metrics over time.

---

## 5. Example CI Pipeline Snippet

Here is a sample script snippet that could be used in a simple CI pipeline:

```bash
#!/bin/bash
set -e

# Run tests with XML output for CI reporting
./your_test_executable \
  --gtest_output=xml:test-results.xml \
  --gtest_color=no \
  --gtest_shuffle

# Optional: Check for flaky tests by rerunning a limited set
./your_test_executable --gtest_repeat=5 --gtest_filter=FlakyTestSuite.*
```

In more sophisticated setups, replace reruns with separate jobs or use dedicated flaky test detectors.

---

## Troubleshooting & Tips

### Common Issues

- **Tests failing only in CI but passing locally:**
  - Check for environment differences.
  - Verify resource limitations (memory, CPU).
  - Investigate dependencies on network or external services.

- **Tests that are order-dependent or flaky:**
  - Use `--gtest_shuffle` and `--gtest_repeat` to identify and fix.

- **Excessively long tests slowing down CI:** Split or mark as integration and run in separate stages.

### Best Practices

- Use descriptive, focused test names to simplify filtering.
- Use fixtures to isolate state.
- Run tests frequently during development to catch regressions early.
- Integrate with code coverage and static analysis tools.

---

## Next Steps & Related Content

- [GoogleTest Primer](primer.md) for foundational test authoring.
- [Mocking for Dummies](gmock_for_dummies.md) to start using mocks.
- [gMock Cookbook](gmock_cook_book.md) for advanced mocking scenarios.
- [Troubleshooting Common Issues](getting-started/troubleshooting-help/common-issues.md) for diagnostics.
- [Build System Integration](guides/integration-scenarios/build-system-integration.md) for seamless CI setup.
- [Continuous Integration Best Practices â€” this guide](current page).

---

## References

- Official GoogleTest documentation:
  - https://github.com/google/googletest
  - https://google.github.io/googletest/

---