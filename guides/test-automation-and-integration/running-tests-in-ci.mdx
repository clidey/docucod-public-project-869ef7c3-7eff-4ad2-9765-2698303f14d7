---
title: "Running Tests in Continuous Integration"
description: "A walkthrough of setting up automated test runs on CI/CD platforms. Includes advice on output formats, test selection, and optimizing for speed and feedback in team environments."
---

# Running Tests in Continuous Integration

## Overview

This guide walks you through setting up automated test runs using GoogleTest on Continuous Integration (CI) and Continuous Delivery (CD) platforms. You will learn how to configure GoogleTest outputs, select which tests to run, and optimize test execution for faster feedback and efficient team collaboration.

Automated testing in CI/CD pipelines ensures that your C++ codebase remains reliable, regressions are caught early, and team members receive timely feedback on their changes.

## Prerequisites

Before starting, ensure:

- GoogleTest is properly integrated with your build system (CMake, Bazel, or manual).
- Your tests compile and run successfully in your local development environment.
- You have access and permissions to configure your CI/CD platform (e.g., Jenkins, GitHub Actions, GitLab CI).

## Expected Outcome

By following this guide, you will:

- Configure GoogleTest to generate machine-readable output suitable for CI tools.
- Select specific tests or test patterns to run in CI.
- Optimize test runs for speed and useful feedback.
- Understand how to interpret CI results from GoogleTest.

## Time Estimate

Setting up your first GoogleTest automation on CI takes approximately 30 to 45 minutes, depending on your CI platform familiarity.

## Difficulty Level

Intermediate

---

## 1. Configuring GoogleTest Output for CI

### Use XML or JSON Output Formats

CI systems often require test results in a standard format. GoogleTest supports generating XML or JSON reports.

- To generate an XML report:

  ```bash
  ./your_test_executable --gtest_output=xml:report.xml
  ```

  This command produces an XML file at `report.xml` in the current directory, which CI tools can parse.

- To generate a JSON report:

  ```bash
  ./your_test_executable --gtest_output=json:report.json
  ```

  This produces a JSON report useful for systems that support JSON parsing.

### CI Pipeline Integration Tips

- Specify absolute or workspace-relative paths for the output file to ensure the CI runner can find it.
- Enable test reports in your CI platform to use these files for reporting.

<Note>
Ensure that the test executable is run with `--gtest_output` flag every time in your CI scripts. Without it, only console output is generated, which is harder to parse.
</Note>

## 2. Selecting Tests to Run in CI

### Filtering Tests

GoogleTest allows selecting specific tests or test suites to execute using filters.

- Use the `--gtest_filter` flag to run a subset of tests matching a wildcard pattern:

  ```bash
  ./your_test_executable --gtest_filter=TestSuiteName.*  # Runs all tests in TestSuiteName

  ./your_test_executable --gtest_filter=*SpecificTest  # Runs all tests ending with 'SpecificTest'

  ./your_test_executable --gtest_filter=Test1:Test2   # Runs tests named Test1 and Test2
  ```

- To exclude tests, prefix the pattern with a minus (`-`):

  ```bash
  ./your_test_executable --gtest_filter=-*Experimental*  # Excludes tests with 'Experimental' in their names
  ```

### Running Disabled Tests in CI

- Disabled tests (prefixed with `DISABLED_`) are ignored by default.
- To run disabled tests in CI, set the flag:

  ```bash
  ./your_test_executable --gtest_also_run_disabled_tests
  ```

### Use Case: Running Only Fast, Critical Tests First

In large projects, implement and use test suite or naming conventions to group tests by execution time or priority, and run fast tests on each commit. Run slower, comprehensive tests (e.g., integration tests) on scheduled nightly builds.

## 3. Optimizing Test Execution

### Parallel Test Execution

While GoogleTest itself doesn't parallelize test cases internally, running tests in parallel across multiple processes can speed up CI.

- Use test runners like `gtest-parallel` to distribute tests across CPU cores or machines.

- Configure sharding to split test suites across multiple CI jobs:

  Set environment variables:

  - `GTEST_TOTAL_SHARDS`: total number of shards
  - `GTEST_SHARD_INDEX`: index of the current shard (0-based)

  ```bash
  export GTEST_TOTAL_SHARDS=4
  export GTEST_SHARD_INDEX=0  # This run executes shard 0
  ./your_test_executable
  ```

- Each shard runs a disjoint subset of tests, enabling parallelization.

### Using `--gtest_repeat` for Flaky Tests

If you suspect flaky tests, you can repeat test runs multiple times:

```bash
./your_test_executable --gtest_repeat=10
```

This helps catch intermittent failures in CI.

### Manage Test Setup Overheads

- Use test suite-level setup (`SetUpTestSuite` and `TearDownTestSuite`) to share expensive resources efficiently across tests.

- Avoid interdependent tests to enable more reliable parallel and repeated runs.

## 4. Ensuring Meaningful Feedback

### Leveraging Event Listeners

GoogleTest’s event listener API allows customization of test reporting.

- You can replace the default console output with custom listeners to integrate test results with CI dashboards or notifications.

- See the [Advanced GoogleTest Topics](advanced.md#extending-google-test-by-handling-test-events) guide for creating and attaching event listeners.

### Using `--gtest_brief` to Suppress Passed Tests Output

Focus CI logs on failures by using:

```bash
./your_test_executable --gtest_brief=1
```

### Fail Fast

Stop test execution at the first failure to speed up debugging:

```bash
./your_test_executable --gtest_fail_fast
```

<Warning>
Fail fast is helpful for debugging but disables detection of multiple failures in the same run.
</Warning>

### Combining Flags Example

```bash
./your_test_executable --gtest_output=xml:results.xml --gtest_filter=FastTests.* --gtest_fail_fast
```

Run only the fast tests, generate an XML report for CI, and stop at the first failure.

## 5. Example: Integrating GoogleTest with a GitHub Actions Workflow

```yaml
name: C++ Test

on: [push, pull_request]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        build-type: [Debug, Release]
    steps:
    - uses: actions/checkout@v3

    - name: Install Dependencies
      run: sudo apt-get update && sudo apt-get install -y cmake g++

    - name: Build
      run: |
        cmake -S . -B build -DCMAKE_BUILD_TYPE=${{ matrix.build-type }}
        cmake --build build

    - name: Run Tests
      run: |
        ./build/your_test_executable \
          --gtest_output=xml:test_results_${{ matrix.build-type }}.xml \
          --gtest_brief=1

    - name: Upload Test Results
      uses: actions/upload-artifact@v3
      with:
        name: test-results-${{ matrix.build-type }}
        path: test_results_${{ matrix.build-type }}.xml
```

This workflow builds your tests in Debug and Release modes, runs them with XML output, and uploads the XML files as build artifacts.

## 6. Troubleshooting Common Issues

<AccordionGroup title="Common CI Testing Issues">
<Accordion title="Tests Not Running or Being Discovered">
- Verify that your test executables are compiled and linked correctly.
- Ensure `InitGoogleTest(&argc, argv)` is called before `RUN_ALL_TESTS()` in your main function.
- Confirm your tests are not disabled or filtered out.
- Use `--gtest_list_tests` to confirm which tests the executable sees.
</Accordion>
<Accordion title="Output Files Not Found by CI">
- Provide absolute or correctly relative paths for the test output files.
- Confirm the output directory exists and has write permissions.
- Check that your CI runner persists the working directory or artifacts correctly.
</Accordion>
<Accordion title="Slow Test Runs in CI">
- Use test sharding (`GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX`) to parallelize test execution.
- Use `SetUpTestSuite()` to share heavy resources across tests.
- Disable or separate very slow or flaky tests from main runs.
</Accordion>
</AccordionGroup>

## 7. Best Practices

- **Keep tests independent:** Avoid shared states that cause flaky behavior in CI.
- **Name test suites clearly:** Easier to filter and run specific tests.
- **Use filters to speed up iteration:** Run a subset of tests on each commit.
- **Leverage CI artifacts** for reporting and debugging failed test runs.
- **Automate environment setup:** Use CI job steps to install dependencies and build without manual steps.

## 8. Next Steps

- Explore [Integrating with Build Systems](guides/test-automation-and-integration/integrating-with-build-systems) to streamline builds.
- Read [Performance Optimization and Scaling](guides/test-automation-and-integration/performance-optimization) for advanced optimization.
- Learn [Advanced Event Listener Customization](docs/advanced.md#extending-google-test-by-handling-test-events) to tailor your CI reports.

---

## References

- [GoogleTest Primer](primer.md) — for foundational test writing concepts.
- [Testing Reference](reference/testing.md) — detailed API reference.
- [Advanced Topics](advanced.md) — in-depth tutorials on event listeners, parameterized tests, and test environments.
- [Running tests in CI](https://github.com/google/googletest/blob/main/docs/README.md) — official GoogleTest documentation and examples on GitHub.


---

## Summary

This page guides you step-by-step through setting up and optimizing GoogleTest execution on CI/CD platforms. It covers output format configuration, test selection filters, parallel execution, and best practices for fast, reliable feedback in automated testing workflows.

---