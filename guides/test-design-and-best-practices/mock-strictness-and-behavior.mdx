---
title: "Controlling Mock Strictness and Behavior"
description: "Explore GoogleMock's NaggyMock, NiceMock, and StrictMock for tuning diagnostics and flexibility in your tests, with real-world use case breakdowns."
---

# Controlling Mock Strictness and Behavior

Explore GoogleMock's NaggyMock, NiceMock, and StrictMock for tuning diagnostics and flexibility in your tests, with real-world use case breakdowns.

---

## Overview

When using GoogleMock, it is critical to control how strictly your mocks react to calls that do not match any set expectations. GoogleMock provides three key wrappers — **NaggyMock**, **NiceMock**, and **StrictMock** — to tune the diagnostics and behavior of your mock objects on uninteresting calls (calls to mock methods without explicit expectations).

This guide helps you understand when and how to use these mock wrappers, what effects they have, and common scenarios illustrating their value in maintaining robust, readable, and maintainable tests.

---

## Understanding Mock Strictness Levels

By default, GoogleMock mocks behave as **Naggy Mocks**, meaning they generate warnings on uninteresting calls but do not fail tests. Depending on your testing needs, you can alter this behavior by wrapping your mock in either a `NiceMock` or a `StrictMock`.

### 1. NaggyMock (Default Behavior)

- **Role:** Warns (prints a diagnostic message) on calls to mock methods that have no associated expectations.
- **Effect:** Keeps tests running and alerts you to potentially unexpected invocations.
- **Use Cases:** Useful during test development to spot unexpected behavior without failing the test.

### 2. NiceMock

- **Role:** Suppresses warnings on uninteresting calls.
- **Effect:** Non-critical calls that lack expectations do not clutter test logs.
- **Use Cases:** Ideal for tests where uninteresting calls are common but irrelevant, helping reduce noise and improve test readability.

### 3. StrictMock

- **Role:** Treats all uninteresting calls as test failures.
- **Effect:** Ensures tests only pass if *all* calls are expected, making tests more rigorous.
- **Use Cases:** Best for critical tests where detecting any extraneous interaction is essential.

---

## How to Use NiceMock, NaggyMock, and StrictMock

These modifiers are class templates that you can wrap around your mock classes. They "inherit" constructors of the original mock class, so usage is straightforward even if your mock has non-default constructors.

### Basic Usage Examples

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(int, Compute, (int x), ());
};

// Default naggy behavior
MockFoo raw_mock;
raw_mock.DoThis();  // Emits warning for uninteresting call

// Creating a nice mock suppresses warnings
NiceMock<MockFoo> nice_mock;
nice_mock.DoThis();  // No warning emitted

// Creating a strict mock treats uninteresting calls as test failures
StrictMock<MockFoo> strict_mock;
EXPECT_CALL(strict_mock, DoThis());
strict_mock.DoThis();  // OK
// strict_mock.Compute(5);  // Causes failure: uninteresting call
```

### Using with Constructors

If your mock class has constructors with parameters, you can pass arguments the same way:

```cpp
class MockBar {
 public:
  MockBar(int a, std::string s) { ... }
  MOCK_METHOD(int, Foo, (), ());
};

NiceMock<MockBar> nice_bar(42, "hello");
EXPECT_CALL(nice_bar, Foo());
nice_bar.Foo();
```

---

## What Happens Under the Hood?

Underneath, these templates inherit from your mock class and modify the "strictness" level via internal registration to GoogleMock's framework:

- `NiceMock` registers to allow uninteresting calls silently.
- `NaggyMock` (default) registers to warn on uninteresting calls.
- `StrictMock` registers to fail on uninteresting calls.

This modification controls whether the mock emits logs or treats uninteresting calls as errors.

---

## Practical User Flows and Scenarios

### Scenario 1: Reducing Noise in Tests with NiceMock

During development, your mock may be called in ways that are irrelevant to the test intent. Wrapping your mock in `NiceMock` suppresses warnings for these uninteresting calls, keeping your test output concise.

```cpp
NiceMock<MockDatabase> db_mock;
EXPECT_CALL(db_mock, Connect());
// Connect is expected; other calls to db_mock that aren't explicitly expected
// will be silently ignored.
```

**Success:** You get clear failure feedback on calls you care about, without distractions from unrelated calls.

### Scenario 2: Enforcing Strict Call Policies with StrictMock

When the interaction with a component must be tightly controlled, use StrictMock to ensure no unexpected calls slip through.

```cpp
StrictMock<MockNetwork> net_mock;
EXPECT_CALL(net_mock, Send(_)).Times(2);
net_mock.Send("hello");
net_mock.Send("world");
// net_mock.Receive("foo");  // This would fail the test: unexpected call
```

**Success:** Your tests fail immediately on any call outside expectations, enabling precise behavior contracts.

### Scenario 3: Leveraging NaggyMock in Early Test Development

You want to see all uninteresting calls to understand potential gaps in expectations.

```cpp
NaggyMock<MockLogger> logger_mock;
logger_mock.LogInfo("Starting up");  // Emits a warning
```

**Success:** Diagnostic output reveals areas where you may want to add expectations or refine test conditions.

---

## Best Practices and Tips

- **Start with NaggyMock or raw mocks** during initial test development to catch unexpected calls.
- **Move to NiceMock** when stable, to reduce noise for irrelevant calls.
- **Reserve StrictMock** for tests requiring exact call verification, especially in integration or critical logic.
- **Never mix nested strictness modifiers.** For example, `NiceMock<StrictMock<T>>` is unsupported and will cause compilation errors.
- **Ensure mock classes have virtual destructors** to maintain proper behavior when wrapping with these templates.
- **Always set explicit expectations for critical calls** when using NiceMock to detect missed interactions.

---

## Common Pitfalls

- **Unintended strictness:** Wrapping a mock with `StrictMock` without adjusting expectations will cause test failures on any unexpected call.
- **Suppression of important warnings:** Using `NiceMock` blindly can hide potential bugs where calls were unintentionally made.
- **Non-virtual destructors:** `NiceMock` and `StrictMock` rely on virtual destructors; omitting these can cause undefined behavior.
- **Mixing modifiers:** Do not nest `NiceMock`, `NaggyMock`, or `StrictMock` around the same mock class.

---

## Troubleshooting

### Unexpected warnings or failures

- Verify if you are using the correct mock wrapper that aligns with your test's strictness requirements.
- Use the `--gmock_verbose` flag to increase or decrease mock diagnostic output (e.g., `--gmock_verbose=info`).

### Compilation errors about strictness modifiers

- Check if you have applied multiple strictness wrappers to the same mock.
- Ensure your mock class has a virtual destructor.

### Uninteresting calls causing test failures

- Either add an expectation for those calls or switch from `StrictMock` to `NiceMock` if those calls are expected but unimportant.

---

## Next Steps & Related Documentation

- Explore [Using Mock Objects Effectively](/guides/writing-and-running-tests/using-mock-objects) to learn about setting expectations and default behaviors.
- Review [Mocking Reference](/docs/reference/mocking) for comprehensive API details related to mocks.
- Visit [Quick Validation Checklist](/getting-started/validation-troubleshooting/quick-validation) to ensure your mocking setup is correct.
- For advanced call order control, read about [Sequences and Ordering](/docs/reference/mocking#EXPECT_CALL.InSequence).


---

## References and Further Reading

- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html) - Quick mock reference.
- [gMock Cookbook – Nice, Strict, and Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy) - In-depth recipes on strictness.
- [Mocking API Reference](/api-reference/core-apis/mocking) - Detailed API and clauses overview.

---