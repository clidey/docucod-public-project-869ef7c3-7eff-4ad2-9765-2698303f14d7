---
title: "Sample Projects and Real-World Examples"
description: "Walkthroughs of sample test suites and real project scenarios using GoogleTest and GoogleMock, demonstrating configuration, assertion usage, and mocking in production-like contexts."
---

# Sample Projects and Real-World Examples

This guide provides practical walkthroughs and examples of using **GoogleTest** and **GoogleMock** in realistic project contexts. It helps you understand how to configure test suites, implement assertions effectively, and write mocks that simulate complex interactions in production-like codebases. Through hands-on demos, you will learn how to apply key GoogleTest mocking features, leverage test fixtures, and integrate GoogleMock expectations with test logic.

---

## 1. Getting Started with Sample Tests

### 1.1 Basic Test Suite Example

Start by exploring a simple test that verifies a clear-cut behavior. Consider testing a calculator class:

```cpp
#include <gtest/gtest.h>

class Calculator {
 public:
  int Add(int a, int b) { return a + b; }
};

TEST(CalculatorTest, AddsTwoNumbers) {
  Calculator calc;
  EXPECT_EQ(calc.Add(2, 3), 5);
  EXPECT_EQ(calc.Add(-1, 1), 0);
}
```

This concrete example shows how to use `TEST` macros to define the test case and use assertions (`EXPECT_EQ`) to validate outcomes.

---

### 1.2 Using Test Fixtures for Setup and Teardown

For scenarios requiring shared setup or teardown logic across tests, use a test fixture:

```cpp
class CalculatorTest : public ::testing::Test {
 protected:
  Calculator calc_;  // Available in all tests

  void SetUp() override {
    // Initialization code if needed
  }

  void TearDown() override {
    // Cleanup code if needed
  }
};

TEST_F(CalculatorTest, ReturnsCorrectSum) {
  EXPECT_EQ(calc_.Add(10, 5), 15);
}

TEST_F(CalculatorTest, HandlesZero) {
  EXPECT_EQ(calc_.Add(0, 0), 0);
}
```

Test fixtures are critical in larger workflows where multiple tests operate on shared objects or state.

---

## 2. Integrating GoogleMock into Sample Projects

### 2.1 Defining a Mock Class

Practical production code often depends on interfaces or abstract dependencies. Define mocks to simulate these for isolated testing.

Example:

```cpp
#include <gmock/gmock.h>

class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void GoTo(int x, int y) = 0;
  virtual int GetX() const = 0;
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, GoTo, (int x, int y), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

Put mock classes in test-specific headers or files, especially if you do not maintain the interfaces.

---

### 2.2 Writing Tests Using Mocks

Create mock objects and set expectations with `EXPECT_CALL` before exercising the code:

```cpp
using ::testing::AtLeast;
using ::testing::_;
using ::testing::Return;

class Painter {
 public:
  explicit Painter(Turtle* turtle) : turtle_(turtle) {}

  bool DrawSquare(int x, int y, int size) {
    turtle_->GoTo(x, y);
    turtle_->PenDown();
    for (int i = 0; i < 4; ++i) {
      turtle_->GoTo(x + size, y);
      // ... rotate turtle etc
    }
    turtle_->PenUp();
    return true;
  }

 private:
  Turtle* turtle_;
};

TEST(PainterTest, DrawsSquare) {
  MockTurtle mock_turtle;

  EXPECT_CALL(mock_turtle, GoTo(_, _))
      .Times(AtLeast(1));  // Expects GoTo to be called one or more times
  EXPECT_CALL(mock_turtle, PenDown())
      .Times(1);
  EXPECT_CALL(mock_turtle, PenUp())
      .Times(1);

  Painter painter(&mock_turtle);
  EXPECT_TRUE(painter.DrawSquare(0, 0, 10));
}
```

This approach verifies the interactions your code has with its dependencies by defining exact call expectations and allowed call counts.

---

### 2.3 Managing Call Order and Sequences

To enforce call order constraints, wrap `EXPECT_CALL` statements inside an `InSequence` block:

```cpp
using ::testing::InSequence;

TEST(PainterTest, CallsExpectationsInOrder) {
  MockTurtle mock_turtle;

  {
    InSequence seq;
    EXPECT_CALL(mock_turtle, PenDown());
    EXPECT_CALL(mock_turtle, GoTo(0, 0));
    EXPECT_CALL(mock_turtle, PenUp());
  }

  Painter painter(&mock_turtle);
  painter.DrawSquare(0, 0, 10);
}
```

This guarantees that calls occur sequentially as specified, improving test precision in complex scenarios.

---

## 3. Advanced Mocking Scenarios in Real Projects

### 3.1 Multiple Expectations with Overlapping Matchers

When multiple expectations on the same method exist, GoogleMock uses the most recently defined matching expectation, allowing you to specialize behavior progressively:

```cpp
EXPECT_CALL(mock_turtle, GoTo(0, 0)).Times(2);
EXPECT_CALL(mock_turtle, GoTo(_, _)).Times(AnyNumber());
```

Calls to `GoTo(0, 0)` match the first expectation twice; other `GoTo` calls match the second.

### 3.2 Delegating to Real or Fake Implementations

You may want mocks to delegate calls to existing real or fake objects for default behavior:

```cpp
class FakeTurtle : public Turtle {
 public:
  void PenUp() override { /* ... */ }
  // ... other methods
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  // ...

  void DelegateToFake() {
    ON_CALL(*this, PenUp()).WillByDefault([this]() {
      fake_.PenUp();
    });
    // ... more delegation
  }

 private:
  FakeTurtle fake_;
};
```

Call `DelegateToFake()` early in your test setup to enable delegation.

---

## 4. Configuring and Running Sample Test Suites

### 4.1 Test Filtering and Selection

Use command-line options to control which test suites or cases to run in large projects:

```bash
test_binary --gtest_filter=PainterTest.*
```

This runs all tests matching `PainterTest.*`.

### 4.2 Output Formats

Generate XML or JSON reports for CI integration:

```bash
test_binary --gtest_output=xml:report.xml
```

or

```bash
test_binary --gtest_output=json:report.json
```

### 4.3 Running Tests Repeatedly or Randomly

Run tests multiple times to catch flaky failures:

```bash
test_binary --gtest_repeat=10
```

Shuffle test execution order:

```bash
test_binary --gtest_shuffle
```

---

## 5. Troubleshooting Common Issues

### 5.1 Verifying Mock Expectations

Ensure that all `EXPECT_CALL`s are set BEFORE exercising mocks. Violations lead to failures that might be hard to diagnose.

### 5.2 Managing Uninteresting and Unexpected Calls

- **Uninteresting calls:** method invoked without an expectation; usually generates warnings.
- **Unexpected calls:** called with unmatched arguments or exceeding expected cardinailty; causes test failures.

Use `NiceMock` to suppress warnings for uninteresting calls when appropriate.

### 5.3 Common Pitfalls

- Omitting `Times()` or mismatching number of calls can lead to failures.
- Forgetting to add `override` in mock method declarations when overriding virtual methods.
- Misordering calls when sequences or `.After()` clauses are in place.

### 5.4 Enabling Verbose Logs

Run tests with the `--gmock_verbose=info` flag to trace call matching, aiding diagnosis:

```bash
test_binary --gmock_verbose=info
```

---

## 6. Best Practices and Tips

- Define mock classes close to the interfaces they mock, preferably separated into dedicated files.
- Use `ON_CALL` to set default behaviors, `EXPECT_CALL` to specify required calls.
- Prefer focused expectations to ensure tests verify only necessary interactions.
- Retire expectations explicitly with `.RetiresOnSaturation()` to avoid sticky expectation errors.
- Use sequences (`InSequence`) to clarify complex call order requirements.

---

## 7. Next Steps

- Explore the [Writing Your First Test](../getting-started/first-test/writing-basic-test) guide to deepen understanding.
- Consult the [Mocking Basics](../guides/mocking-and-mocking-patterns/mocking-basics) for comprehensive mock usage.
- Study the advanced [Custom Actions and Matchers](../guides/mocking-and-mocking-patterns/custom-actions-matchers) to master complex mocking.
- Use the [Running and Configuring Tests](../guides/writing-tests/running-and-configuring-tests) for test suite management.

---

For more sample code and better understanding of workflows, browse the [`googletest/samples`](https://github.com/google/googletest/tree/main/googletest/samples) directory in the GitHub repository.

---

### Additional Resources
- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [GoogleTest Sample Tests Repository](https://github.com/google/googletest/tree/main/googletest/samples)

---

This guide is designed to bridge foundational concepts with practical project examples, enabling you to confidently apply GoogleTest and GoogleMock in real-world software development scenarios.