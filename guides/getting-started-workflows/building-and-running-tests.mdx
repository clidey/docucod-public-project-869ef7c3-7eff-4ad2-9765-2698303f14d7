---
title: "Building and Running Tests"
description: "Instructions and real-world examples for integrating GoogleTest and GoogleMock into different C++ build systems (CMake, Bazel), running tests from the command line, and interpreting test outputs for efficient development."
---

# Building and Running Tests

This guide provides detailed, actionable instructions for integrating GoogleTest and GoogleMock into your C++ projects using common build systems, running tests from the command line, and understanding test outputs for effective test development.

---

## Integration with Build Systems

GoogleTest and GoogleMock are designed to work with popular C++ build systems, primarily **CMake** and **Bazel**. This section will guide you through integrating them effectively.

### Building with CMake

CMake is a widely used cross-platform build system. GoogleTest provides a robust CMake build script to build both GoogleTest and GoogleMock.

#### Standalone Build

1. **Clone the repository** (if you haven't already):
    ```bash
    git clone https://github.com/google/googletest.git -b v1.17.0
    cd googletest
    ```
2. **Create a build directory and generate build files**:
    ```bash
    mkdir build
    cd build
    cmake ..
    ```
    To build only GoogleTest (excluding GoogleMock), use:
    ```bash
    cmake .. -DBUILD_GMOCK=OFF
    ```
3. **Build the libraries:**
    ```bash
    make
    ```
4. **Install (optional):** Requires admin privileges.
    ```bash
    sudo make install
    ```

#### Integrating GoogleTest into Your CMake Project

Instead of building GoogleTest separately, you can incorporate it directly into your build:

1. Use `FetchContent` to download and add GoogleTest during your build configuration.

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# On Windows, prevent mismatch of CRT linkage:
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

add_executable(your_test your_test.cpp)
target_link_libraries(your_test gtest_main)
add_test(NAME your_test COMMAND your_test)
```

2. Ensure you have a C++17 compiler. You can set this in your top-level `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

3. Use `gtest` or `gtest_main` targets for linking your tests.

##### Visual Studio Tips

Visual Studio projects default to dynamic CRT linkage, but GoogleTest defaults to static CRT linkage. To fix "RuntimeLibrary" mismatch errors, set `gtest_force_shared_crt` to `ON` as shown above.

### Building with Bazel

GoogleTest supports Bazel for build and test automation. Integrate GoogleTest targets and use Bazel commands to build and run tests if your project uses Bazel.

(Please refer to the [GoogleTest Bazel documentation](https://github.com/google/googletest/tree/main/bazel) for detailed Bazel integration instructions.)

---

## Running Tests from the Command Line

After building your test executable, you use the command line to execute tests and control their behavior.

### Basic Test Execution

Run your compiled test executable directly:

```shell
./your_test_executable
```

This runs all tests and shows a detailed report.

### Listing All Tests

Use the `--gtest_list_tests` flag to list all discovered tests without running them:

```shell
./your_test_executable --gtest_list_tests
```

Example output:

```
MathTest.
  Addition
  Subtraction
LogicTest.
  NonContradiction
```

### Selecting Tests to Run

You can run a subset of tests using the `--gtest_filter` flag. The filter supports wildcards `*` (any substring) and `?` (single character), and a `-` for excluding patterns.

Examples:

- Run all tests in `MathTest`:
  ```shell
  ./your_test_executable --gtest_filter=MathTest.*
  ```
- Run tests containing "Null" or "Constructor":
  ```shell
  ./your_test_executable --gtest_filter=*Null*:*Constructor*
  ```
- Run tests in `FooTest` but exclude `FooTest.Bar`:
  ```shell
  ./your_test_executable --gtest_filter=FooTest.*-FooTest.Bar
  ```

### Controlling Test Output

- **Stop on first failure:**
  ```shell
  ./your_test_executable --gtest_fail_fast
  ```
- **Run disabled tests:**
  ```shell
  ./your_test_executable --gtest_also_run_disabled_tests
  ```
- **Enable color output:**
  ```shell
  ./your_test_executable --gtest_color=yes
  ```

### Generating Test Reports

You can output detailed XML or JSON reports using the `--gtest_output` flag.

- **XML report:**
  ```shell
  ./your_test_executable --gtest_output=xml:report.xml
  ```
- **JSON report:**
  ```shell
  ./your_test_executable --gtest_output=json:report.json
  ```

If a filename is omitted, the default `test_detail.xml` or `test_detail.json` is created.

This helps integrate test results with CI systems and test dashboards.

---

## Interpreting Test Output

GoogleTest provides readable output to help you analyze the results of your test executions.

### Typical Output Structure

```
[==========] Running 3 tests from 2 test suites.
[----------] Global test environment set-up.
[----------] 2 tests from MathTest
[ RUN      ] MathTest.Addition
[       OK ] MathTest.Addition (0 ms)
[ RUN      ] MathTest.Subtraction
/path/to/test.cpp:25: Failure
Expected equality of these values:
  Subtract(5, 2)
    Which is: 4
  3
[  FAILED  ] MathTest.Subtraction (1 ms)
[----------] 1 test from LogicTest
[ RUN      ] LogicTest.NonContradiction
[       OK ] LogicTest.NonContradiction (0 ms)
[----------] Global test environment tear-down
[==========] 3 tests from 2 test suites ran. (2 ms total)
[  PASSED  ] 2 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] MathTest.Subtraction

 1 FAILED TEST
```

- Tests are grouped by **test suite**.
- Each test runs individually showing `[ RUN      ]`, `[       OK ]`, or `[  FAILED  ]` status.
- Failures include file and line location and a summary message.
- Summary at the end counts passed and failed tests.

### Test Failure Details

If a test fails, GoogleTest prints:

- The test suite and test name.
- Assertion failure location (file and line number).
- Expected vs. actual values.
- Optional user-defined failure messages.

These details enable quick identification and debugging of the root cause.

### Using the Output Tags

- `[ RUN      ]`: Indicates the test start.
- `[       OK ]`: Indicates the test passed.
- `[  FAILED  ]`: Indicates the test failed.
- `[  SKIPPED ]`: Indicates the test was skipped.

### Debugging Tips

- Use `--gtest_filter` to run only the failing test for focused debugging.
- Add verbosity by streaming message with assertions:

```cpp
EXPECT_EQ(x, y) << "Failure details: x = " << x << ", y = " << y;
```

- Use `SCOPED_TRACE` to provide contextual information in deeper call stacks.

```cpp
SCOPED_TRACE("Context info");
```

- Enable failure breakpoints with `--gtest_break_on_failure` when debugging with a debugger.

---

## Practical Example: From Build to Run

1. Add GoogleTest as a subdirectory in your CMake project:

```cmake
add_subdirectory(googletest)

add_executable(my_tests test1.cpp test2.cpp)
target_link_libraries(my_tests gtest_main)
add_test(NAME my_tests COMMAND my_tests)
```

2. Build your project:

```bash
mkdir build && cd build
cmake ..
make
```

3. Run all tests:

```bash
./my_tests
```

4. Run specific tests:

```bash
./my_tests --gtest_filter=TestSuiteName.TestName
```

5. Generate an XML report:

```bash
./my_tests --gtest_output=xml:test_results.xml
```

6. Interpret results from the output and XML report to address failures.

---

## Troubleshooting Common Issues

### Tests Not Discovered or Run

- Verify your test cases use the correct macros (`TEST`, `TEST_F`, `TEST_P`).
- Ensure test suite and test names do **not** contain underscores (`_`). This can cause conflicts and test discovery issues.
- Confirm that your test executable is linked with GoogleTest correctly.
- Use `--gtest_list_tests` to confirm test detection.

### Build Failures with CMake

- Confirm that C++17 is enabled in your project.
- Fix runtime library conflicts on Windows by setting `gtest_force_shared_crt=ON`.
- Clean your build directory and regenerate build files if stale.

### Running Tests Fails or Crashes

- Confirm that `testing::InitGoogleTest` is called before `RUN_ALL_TESTS`.
- Avoid having side-effects in global objects or static initializers.
- Ensure compatibility between your test code and GoogleTest versions.

### Test Output Confusion

- Use `--gtest_brief=1` to suppress passed test messages if output cluttered.
- Use `--gtest_color=yes` to enable colored output for better readability.
- For multi-threaded tests, note GoogleTest's thread safety limitations.

---

## Best Practices

- **Call `InitGoogleTest`** before `RUN_ALL_TESTS()` in main().
- Use **test fixtures (`TEST_F`)** for sharing setup/teardown logic.
- Avoid **underscores in test suite and test names**.
- Use **parameterized tests** (`TEST_P`) and instantiation macros properly.
- Name death-test suites with suffix `DeathTest`.
- Capture detailed failure context in assertions for easier debugging.
- Utilize the **XML/JSON output** for CI integration.

---

## Additional Resources

- [GoogleTest Primer](docs/primer.md) — Understand core test writing concepts
- [Testing Reference](docs/reference/testing.md) — Full API and macro reference for tests
- [Mocking Reference](docs/reference/mocking.md) — Comprehensive guide to GoogleMock
- [GoogleTest CMake README](googletest/README.md) — Build system integration details
- [GoogleMock README](googlemock/README.md) — Mocking framework overview
- [Advanced GoogleTest Topics](docs/advanced.md) — Deep dive on advanced test techniques
- [Samples](docs/samples.md) — Sample test projects

---

Make sure to follow the recommended test naming conventions and understand your build system's requirements to achieve a smooth build-and-run test workflow with GoogleTest and GoogleMock.
