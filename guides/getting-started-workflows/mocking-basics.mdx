---
title: "Getting Started with GoogleMock"
description: "An approachable walkthrough for adding GoogleMock to a project, writing your first mock classes, and leveraging core mocking workflows, including ON_CALL/EXPECT_CALL usage and common patterns."
---

# Getting Started with GoogleMock

An approachable walkthrough for adding GoogleMock to a project, writing your first mock classes, and leveraging core mocking workflows, including ON_CALL/EXPECT_CALL usage and common patterns.

---

## 1. Introduction

GoogleMock is a powerful C++ mocking framework that lets you create mock classes for your interfaces and verify how your code interacts with these mocks. This guide focuses entirely on the **Getting Started with GoogleMock** page — helping you add GoogleMock to your project, write your first mock classes, and use essential mocking techniques such as setting default behaviors (`ON_CALL`) and expectations (`EXPECT_CALL`).

You'll learn how to inject and use mocks effectively, understand the semantics behind call expectations, and apply common patterns to write flexible, readable, and maintainable tests.

<Tip>
Before diving in, make sure you have a working GoogleTest + GoogleMock installation. Refer to the installation and setup sections in the documentation for your build system (CMake, Bazel, etc.).
</Tip>

---

## 2. Prerequisites

- **Existing project with GoogleTest/GoogleMock installed**. Include `<gmock/gmock.h>` in your test files.
- **Basic familiarity with C++ classes and virtual functions**.
- **An interface or abstract class to mock**. GoogleMock transformers virtual methods into mocks with `MOCK_METHOD`.

If you are just getting started with GoogleTest, review the [`Writing Your First Test`](https://google.github.io/googletest/gmock_for_dummies.html) guide first.

---

## 3. Workflow Overview

### What Will You Achieve?

By the end of this guide, you will be able to:
- Define your own mock classes using `MOCK_METHOD` macro
- Set default behaviors for mock methods using `ON_CALL`
- Write and verify expectations about method calls using `EXPECT_CALL`
- Use cardinality, sequences, and actions to control mock behavior and validate call order

### Time Estimate

Expect about 30-45 minutes to understand and apply these concepts thoroughly in your tests.

### Difficulty Level

Beginner to Intermediate

---

## 4. Step-by-Step Instructions

<Steps>
<Step title="Add GoogleMock to Your Test Source">
Import GoogleMock in your test files to access all utilities.

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>
```

Expected Result: No compilation errors and all mocking utilities are available.
</Step>

<Step title="Define a Mock Class Using MOCK_METHOD">
Create a mock class inheriting from the interface you want to mock, and declare mocked methods with `MOCK_METHOD` inside the `public:` section.

Example:
```cpp
class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
  virtual int GetX() const = 0;
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

Note:
- Use `(const, override)` for const virtual methods.
- Wrap types with commas in parentheses or typedefs if necessary.

Expected Result: You have a mock class ready for testing.
</Step>

<Step title="Set Default Behavior Using ON_CALL">
`ON_CALL` configures the default behavior of your mock methods when they are called but no specific expectation is set.

```cpp
MockTurtle mock_turtle;
ON_CALL(mock_turtle, GetX()).WillByDefault(::testing::Return(42));
```

Expected Result: Mock returns 42 whenever `GetX()` is called and no `EXPECT_CALL` is in place.

<Tip>
Use `ON_CALL` for defining common behavior that applies across many tests, avoiding over-specification.
</Tip>
</Step>

<Step title="Set Expectations Using EXPECT_CALL">
Use `EXPECT_CALL` to specify how many times, with which arguments, and in which order you'd expect methods to be called.

```cpp
EXPECT_CALL(mock_turtle, Forward(::testing::Ge(10)))
    .Times(2)
    .WillRepeatedly(::testing::Return());
```

Expected Result: The test will fail if `Forward()` is not called at least twice with argument >= 10.

Decision Point:
- If you want to verify call order, consider using `InSequence`.
- Choose argument matchers carefully to avoid brittle tests.
</Step>

<Step title="Exercise Your Code Using Mock Objects">
Pass the mock objects to the code under test and execute the logic that triggers method calls.

```cpp
Painter painter(&mock_turtle);
painter.DrawLine(20);
```

Expected Result: Your mock receives calls and GoogleMock verifies expectations.
</Step>

<Step title="Run Tests and Confirm Behavior">
Run your test binary. GoogleMock automatically verifies all expectations are satisfied when mocks are destroyed.

Observe test output for failures related to unmet expectations or unexpected calls.
</Step>

</Steps>

---

## 5. Common Patterns & Practical Tips

### Using Argument Matchers

- Match specific values directly: `EXPECT_CALL(mock, Foo(5))`
- Ignore arguments with `_`: `EXPECT_CALL(mock, Foo(_))`
- Combine matchers for flexible matching: `EXPECT_CALL(mock, Foo(::testing::AllOf(::testing::Ge(0), ::testing::Le(10))))`

### Controlling Call Cardinality

- `Times(n)` expects exactly n calls
- `Times(::testing::AnyNumber())` allows any number of calls
- `Times(::testing::AtLeast(n))` enforces minimum calls

### Ordering Expectations

- Use `InSequence` to enforce order of calls
- Use `After` to require calls happen after others

### Default vs Expected Calls

- `ON_CALL` defines behavior but does NOT verify call
- `EXPECT_CALL` defines behavior AND verifies call happens
- Prefer `ON_CALL` for setup, `EXPECT_CALL` for important call verifications

### NiceMock, NaggyMock, StrictMock

Which mock wrapper you choose affects handling uninteresting calls:
- `NiceMock` suppresses warnings about unexpected calls
- `NaggyMock` (default) warns on uninteresting calls
- `StrictMock` fails on uninteresting calls

### Mocking Overloaded and Const Methods

- Mock all overloads you want to test
- For const methods, use `(const, override)` qualifier
- Use `Const(mock)` wrapper to set expectations on const overload

### Common Pitfalls

- Set expectations before exercising mocks
- Avoid over-specifying arguments
- Remember expectations are ‘sticky’ unless retired

---

## 6. Troubleshooting

<AccordionGroup title="Common Issues in Getting Started with GoogleMock">
<Accordion title="Mock Method Not Called as Expected">
Check that your `EXPECT_CALL` is set before the method is called.
Verify argument matchers correctly match the actual call.
Consider running tests with `--gmock_verbose=info` to see call traces.
</Accordion>
<Accordion title="Uninteresting Function Call Warning">
Means a mock method was called without expectation.
Suppress by adding a catch-all `EXPECT_CALL(...).Times(AnyNumber())` or by using `NiceMock`.
</Accordion>
<Accordion title="Compilation Errors on MOCK_METHOD">
Ensure virtual methods have proper signatures.
Wrap argument or return types with commas inside parentheses or use type aliases.
Use `(override)` and `(const, override)` qualifiers consistently.
</Accordion>
<Accordion title="Mismatch on Overloaded Methods">
Use explicit argument matcher lists to disambiguate overloads.
Use `Const` wrapper for const overloads.
</Accordion>
</AccordionGroup>

---

## 7. Examples

### Writing a Simple Mock and Test

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void Forward(int distance) = 0;
  virtual int GetX() const = 0;
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};

TEST(PaintTest, TestForwardCalls) {
  MockTurtle mock_turtle;
  ON_CALL(mock_turtle, GetX()).WillByDefault(::testing::Return(10));

  EXPECT_CALL(mock_turtle, Forward(::testing::Ge(5)))
      .Times(1);

  // Code exercising mock
  mock_turtle.Forward(7);

  EXPECT_EQ(mock_turtle.GetX(), 10);
}
```

### Using InSequence for Ordered Calls

```cpp
{
  ::testing::InSequence seq;
  EXPECT_CALL(mock_turtle, PenUp());
  EXPECT_CALL(mock_turtle, Forward(10));
  EXPECT_CALL(mock_turtle, PenDown());
}
```

This enforces these calls happen in the above order.

---

## 8. Next Steps & Related Content

- Explore the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for advanced techniques.
- Read [Matchers Reference](https://google.github.io/googletest/gmock_matchers.html) to learn how to write flexible call argument checks.
- Consult [gMock API Reference](https://google.github.io/googletest/reference/mocking.html) for detailed macro and class documentation.
- Review [Writing Your First Unit Test](https://google.github.io/googletest/gmock_for_dummies.html) and [Quick Start Journey](https://google.github.io/googletest/overview/features-workflows/quick-start-journey.html) for end-to-end workflow.

---

For complete context and best practices, always ensure your mocks:
- Have virtual destructors in base classes.
- Use `MOCK_METHOD` in public sections.
- Setup expectations before code execution.
- Avoid over-specification of argument matchers.

---