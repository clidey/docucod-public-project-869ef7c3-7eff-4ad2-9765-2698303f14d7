---
title: "Controlling Mock Strictness"
description: "Understand and apply NiceMock, NaggyMock, and StrictMock wrappers to control the handling of unexpected mock invocations, ensuring your tests fail, warn, or ignore as appropriate for your workflow."
---

# Controlling Mock Strictness

Understand and apply NiceMock, NaggyMock, and StrictMock wrappers to control the handling of unexpected mock invocations, ensuring your tests fail, warn, or ignore as appropriate for your workflow.

---

## Overview

When writing tests with GoogleMock, you often want to control how your mock objects react to calls that haven't been explicitly declared with expectations (`EXPECT_CALL`). These calls are called **uninteresting calls**. GoogleMock provides three wrappers over your mock classes to control the behavior for these calls:

- **NiceMock**: Suppresses warnings for uninteresting calls (ignores them).
- **NaggyMock**: Prints warnings on uninteresting calls (default behavior).
- **StrictMock**: Treats uninteresting calls as test failures.

Using these wrappers helps you tailor your test's strictness level and maintain clarity in test results.

---

## Prerequisites

- Familiarity with creating mock classes using `MOCK_METHOD` macros.
- Understanding of `EXPECT_CALL` and `ON_CALL` for setting expectations and default behaviors.
- GoogleMock setup complete with includes to `<gmock/gmock.h>`.

---

## Using Mock Strictness Wrappers

### 1. NiceMock

Wrap your mock class with `NiceMock<YourMockClass>` to silence warnings about any calls to mock methods that do not have an expectation. Useful when uninteresting calls are expected and safe to ignore.

```cpp
using ::testing::NiceMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
};

NiceMock<MockFoo> nice_foo;

// Uninteresting calls produce no warnings.
nice_foo.DoThis();
```

- Allows all unexpected calls to pass silently.
- Fails tests if calls violate explicit expectations.
- Supports construction forwarding for mocks with non-default constructors.

### 2. NaggyMock

Wrap your mock class with `NaggyMock<YourMockClass>` to get a warning printed for each uninteresting call. This is the default behavior of plain mock classes.

```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> naggy_foo;

// Uninteresting calls print warnings.
naggy_foo.DoThis();
```

- Useful during test development for visibility on unexpected interactions.
- Does not fail tests for uninteresting calls, just warns.

### 3. StrictMock

Wrap your mock class with `StrictMock<YourMockClass>` to treat any call to a mock method without an explicit expectation as a test failure.

```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_foo;

// Uninteresting calls cause test failures.
strict_foo.DoThis();  // Fails
```

- Enforces strict verification that no unexpected calls occur.
- Essential for tests requiring tight control over mock interactions.

---

## How To Choose The Right Wrapper

| Wrapper      | Uninteresting Calls Behavior            | When to Use                               |
|--------------|----------------------------------------|------------------------------------------|
| `NiceMock`   | Ignored silently (no warnings or errors) | Most tests; reduces noise from uninteresting calls |
| `NaggyMock`  | Print warnings                          | When debugging to detect uninteresting calls |
| `StrictMock` | Fail tests on uninteresting calls      | Strict tests ensuring no unexpected calls occur |

---

## Practical Examples

Assuming you have a mock class:

```cpp
class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
};
```

### Using NiceMock

```cpp
NiceMock<MockFoo> nice_foo;

// No warning for uninteresting call
nice_foo.DoThis();

EXPECT_CALL(nice_foo, DoThis());
nice_foo.DoThis();  // Passes

// Using with constructor arguments
class MockBar {
 public:
  explicit MockBar(const std::string& s) : str_(s) {}
  MOCK_METHOD(int, GetValue, (), ());
  const std::string& str() const { return str_; }
 private:
  std::string str_;
};

NiceMock<MockBar> nice_bar("hello");
EXPECT_CALL(nice_bar, GetValue());
nice_bar.GetValue();
```

### Using NaggyMock

```cpp
NaggyMock<MockFoo> naggy_foo;

// This will print a warning about uninteresting call
naggy_foo.DoThis();
```

### Using StrictMock

```cpp
StrictMock<MockFoo> strict_foo;

// This will cause test failure due to uninteresting call
strict_foo.DoThis();

// Expected call, works fine
EXPECT_CALL(strict_foo, DoThis());
strict_foo.DoThis();
```

---

## Best Practices

- **Default to `NiceMock`** when starting tests to avoid noise.
- Use **`NaggyMock`** temporarily to detect surprising/mock call patterns during development or debugging.
- Reserve **`StrictMock`** for tests where you want to ensure full control of interactions.
- Always set `EXPECT_CALL` for interactions you want to validate explicitly.
- Avoid mixing wrappers (e.g., `NiceMock<StrictMock<MockFoo>>`) as it is unsupported.
- Use `Mock::AllowLeak()` for mocks deliberately leaked to avoid spurious leak reports.

---

## Troubleshooting

### Uninteresting Call Warnings Still Appear with `NiceMock`

- Confirm you are using `NiceMock` directly on the mock class.
- Check if the mocked methods are defined directly in the mock class. Wrappers affect only methods defined with `MOCK_METHOD` in the immediate mock class.

### Unexpected Calls Fail in `NaggyMock`

- Unexpected calls always fail regardless of strictness wrappers.
- Ensure that all calls expected in test behavior have matching `EXPECT_CALL`s.

### Uninteresting Calls Fail in `StrictMock`

- This is by design. Unexpected or unmocked calls cause test failures.
- Add explicit `EXPECT_CALL(...).Times(AnyNumber())` for calls you expect but don't want to verify.

---

## Additional Reference

- [`NiceMock`, `NaggyMock`, and `StrictMock` documentation in GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- See [gmock-nice-strict.h source](https://github.com/google/googletest/blob/main/googlemock/include/gmock/gmock-nice-strict.h) for implementation details
- Explore tests in [gmock-nice-strict_test.cc](https://github.com/google/googletest/blob/main/googlemock/test/gmock-nice-strict_test.cc) for usage scenarios
- For understanding uninteresting vs unexpected calls, read [Understanding Uninteresting vs Unexpected Calls](https://google.github.io/googletest/gmock_cook_book.html#uninteresting-vs-unexpected)

---

## Summary

This guide focused specifically on how to control **mock strictness** in GoogleMock by applying `NiceMock`, `NaggyMock`, and `StrictMock` wrappers around your mock classes, allowing you to choose whether uninteresting calls should be ignored, warned, or treated as test failures. It provides practical examples, best practices for deciding when and how to use each wrapper, and troubleshooting tips to avoid common pitfalls.

---

## References

- [GoogleMock: The Nice, the Strict, and the Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [Mocking Reference - NiceMock, NaggyMock, StrictMock](https://google.github.io/googletest/reference/mocking.html#NiceMock)
- [GoogleMock API Reference](https://google.github.io/googletest/reference/gmock-md.html)
- [`gmock-nice-strict.h` source code](https://github.com/google/googletest/blob/main/googlemock/include/gmock/gmock-nice-strict.h)
- [Working with mocks - GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)

---

<Callout title="Tip" type="tip">
Use `NiceMock` as your default choice to reduce noise from uninteresting calls, apply `NaggyMock` when you need to detect unexpected calls during debugging, and choose `StrictMock` only when you want your tests to fail on any unmocked calls.
</Callout>

<Callout title="Note" type="note">
Remember that strictness wrappers only affect **uninteresting** calls (i.e., calls with no matching `EXPECT_CALL`). Calls that match an expectation but violate its constraints (unexpected calls) will always fail the test regardless of wrapper.
</Callout>
