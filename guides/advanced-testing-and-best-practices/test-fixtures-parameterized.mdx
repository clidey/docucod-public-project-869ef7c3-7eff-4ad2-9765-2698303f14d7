---
title: "Test Fixtures and Parameterized Tests"
description: "Delve into shared setup/teardown logic with test fixtures, and leverage parameterized tests to cover input diversity. Practical patterns illustrate how to avoid code duplication and increase coverage efficiently."
---

# Test Fixtures and Parameterized Tests

Delve into shared setup/teardown logic with test fixtures, and leverage parameterized tests to cover input diversity. Practical patterns illustrate how to avoid code duplication and increase coverage efficiently.

---

## Overview

Test fixtures and parameterized tests are essential tools in GoogleTest to write maintainable and comprehensive tests efficiently. This guide focuses specifically on how to use **test fixtures** to factor out shared setup and teardown logic across related tests, and how to apply **parameterized tests** to run the same test logic over diverse inputs without duplicating code.

By mastering these patterns, you will save development time, improve test clarity, and ensure your tests cover edge cases and variations systematically.

---

## Prerequisites

- A working GoogleTest setup in your C++ project, with the framework properly installed and configured.
- Familiarity with basic GoogleTest macros such as `TEST`, `TEST_F`, and the concept of assertions.
- Understanding of GoogleTest’s installation and how to compile and run tests (`RUN_ALL_TESTS()`).

---

## Expected Outcome

After completing this guide, you will be able to:

- Create test fixtures with `TEST_F` to share setup and teardown logic across multiple tests.
- Write value-parameterized tests using `TEST_P` and instantiate them using parameter generators.
- Employ GoogleTest's parameter generators like `Values()`, `Range()`, `Combine()`, and `Bool()` to define comprehensive test inputs.
- Utilize typed tests and type-parameterized tests to test multiple types with shared test logic efficiently.
- Avoid common pitfalls such as code duplication, uninstantiated parameterized tests, and improperly scoped fixtures.

---

## Time Estimate

Completing this guide and trying out the examples will take around 25-40 minutes.

## Difficulty Level

Intermediate — assumes familiarity with basic GoogleTest test definition.

---

## Test Fixtures: Sharing Setup and Teardown

When multiple tests share a common setup or shared resource, write a test fixture class derived from `testing::Test`. This helps you avoid repeating code by providing a reusable context for tests.

### How to Create a Test Fixture

1. Derive a class from `testing::Test`.
2. In the fixture, declare member variables for shared objects.
3. Override `SetUp()` to initialize shared state before each test.
4. Override `TearDown()` to clean up after each test.
5. Use `TEST_F(FixtureName, TestName)` to write tests using that fixture.

Example:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Setup queues for tests.
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);  // Abort test if nullptr
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

### Best Practices for Fixtures

- Always use `override` keyword for `SetUp()` and `TearDown()`.
- Avoid modifying shared objects in a way that affects other tests.
- Keep test fixtures focused and simple.
- For expensive shared resources, consider `SetUpTestSuite()` and `TearDownTestSuite()` static methods for one-time setup/cleanup (see advanced topics).

---

## Value-Parameterized Tests: Increasing Test Coverage

Value-parameterized tests let you run the same test logic over a series of input values efficiently.

### Writing Value-Parameterized Tests

1. Define a test fixture that inherits from `testing::TestWithParam<T>`, where `T` is the parameter type.
2. Write tests using the `TEST_P` macro, accessing the parameter with `GetParam()`.
3. Instantiate the test suite with `INSTANTIATE_TEST_SUITE_P` and a parameter generator.

Example:

```cpp
class MyStringTest : public testing::TestWithParam<std::string> {};

TEST_P(MyStringTest, IsNonEmpty) {
  EXPECT_FALSE(GetParam().empty());
}

INSTANTIATE_TEST_SUITE_P(NonEmptyStrings, MyStringTest,
                         testing::Values("foo", "bar", "baz"));
```

Each input value creates a unique test case.

### Common Parameter Generators

| Generator       | Description                                   | Example Usage                              |
|-----------------|-----------------------------------------------|--------------------------------------------|
| `Values(v...)`  | Yields explicit listed values                  | `Values(1, 2, 3)`                         |
| `ValuesIn(container)` | Yields values from an array or container  | `ValuesIn(arr)` or `ValuesIn(vec.begin(), vec.end())` |
| `Range(start, end [, step])` | Yields values from `start` to `end-1` with optional `step` | `Range(0, 10, 2)`                         |
| `Bool()`        | Yields boolean values `{false, true}`          | `Bool()`                                  |
| `Combine(...)`  | Cartesian product of multiple generators       | `Combine(Values(1,2), Values('a','b'))`   |

---

## Typed Tests and Type-Parameterized Tests: Testing Multiple Types

When you want to verify the same behavior across multiple types, use typed tests or type-parameterized tests.

### Typed Tests

- Define a fixture template class inheriting from `testing::Test`.
- Define the list of types using `testing::Types<...>`.
- Instantiate the test suite with `TYPED_TEST_SUITE`.
- Write tests with `TYPED_TEST(FixtureName, TestName)`, using `TypeParam` to refer to the current type.

Example:

```cpp
template <typename T>
class NumericTest : public testing::Test {
 public:
  T value = T();
};

using NumericTypes = testing::Types<int, float, double>;
TYPED_TEST_SUITE(NumericTest, NumericTypes);

TYPED_TEST(NumericTest, IsZeroInitially) {
  EXPECT_EQ(this->value, TypeParam{});
}
```

### Type-Parameterized Tests

Similar to typed tests but allow defining the test patterns separately and instantiating them later with different type lists, suitable for library authors.

- Use `TYPED_TEST_SUITE_P` to declare a type-parameterized test suite.
- Use `TYPED_TEST_P` to declare tests.
- Register tests with `REGISTER_TYPED_TEST_SUITE_P`.
- Instantiate with `INSTANTIATE_TYPED_TEST_SUITE_P` and type lists.

---

## Step-by-Step Instructions

<Steps>
<Step title="Define a Test Fixture with Shared Setup">
Create a class deriving from `testing::Test` with shared data members and implement initialization in the constructor or `SetUp()`. Override cleanup in `TearDown()` if needed.
</Step>
<Step title="Write Tests Using TEST_F">
Write test functions using the `TEST_F(FixtureName, TestName)` macro, accessing fixture members directly.
</Step>
<Step title="Define a Parameterized Test Fixture">
Derive a fixture from `testing::TestWithParam<T>`, where `T` is the parameter type for your tests.
</Step>
<Step title="Write Parameterized Tests Using TEST_P">
Write tests with `TEST_P(FixtureName, TestName)`. Use `GetParam()` within the test body to get the current parameter.
</Step>
<Step title="Instantiate Parameterized Tests Using INSTANTIATE_TEST_SUITE_P">
Instantiate the test suite for specific parameter sets using generators like `Values()`, `Range()`, or their combinations.
</Step>
<Step title="(Optional) Use Typed or Type-Parameterized Tests">
If testing multiple types, define typed test fixtures and use `TYPED_TEST_SUITE` or `TYPED_TEST_SUITE_P` and related macros to generate tests per type.
</Step>
</Steps>

---

## Examples & Code Samples

### Example 1: Simple Test Fixture

```cpp
class MyFixture : public testing::Test {
 protected:
  void SetUp() override {
    data_ = 5;
  }

  int data_ = 0;
};

TEST_F(MyFixture, DataIsInitialized) {
  EXPECT_EQ(data_, 5);
}
```

### Example 2: Value-Parameterized Test

```cpp
class EvenTest : public testing::TestWithParam<int> {};

TEST_P(EvenTest, CheckIsEven) {
  int n = GetParam();
  EXPECT_EQ(n % 2, 0) << n << " is not even";
}

INSTANTIATE_TEST_SUITE_P(Evens, EvenTest,
                         testing::Values(2, 4, 6, 8));
```

### Example 3: Combining Parameter Generators

```cpp
class ComboTest : public testing::TestWithParam<std::tuple<int, char>> {};

TEST_P(ComboTest, ValidCombo) {
  int i;
  char c;
  std::tie(i, c) = GetParam();
  EXPECT_GT(i, 0);
  EXPECT_TRUE(c == 'a' || c == 'b');
}

INSTANTIATE_TEST_SUITE_P(
    Combinations, ComboTest,
    testing::Combine(testing::Values(1, 2), testing::Values('a', 'b')));
```

### Example 4: Typed Test

```cpp
template <typename T>
class NumberTest : public testing::Test {
 public:
  T value = static_cast<T>(0);
};

using NumberTypes = testing::Types<int, float>;
TYPED_TEST_SUITE(NumberTest, NumberTypes);

TYPED_TEST(NumberTest, IsZero) {
  EXPECT_EQ(this->value, TypeParam{});
}
```

---

## Troubleshooting & Tips

### Common Issues

- **Uninstantiated Parameterized Tests**: If parameterized test suites are declared but not instantiated, GoogleTest reports failures. Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST(FixtureName)` to suppress these if intentional.

- **Naming Conflicts**: Avoid underscores in test suite or test names to prevent issues with test discovery and ordering.

- **Dangling References in ConvertGenerator**: When using `ConvertGenerator` with lambdas and string views, ensure the strings outlive the generator to avoid dangling references.

- **Incorrect Fixture Scope**: Make sure `SetUpTestSuite()` and `TearDownTestSuite()` methods are public if using them with `TEST_P` fixtures.

- **Parameter Names Invalid for Tests**: Test name suffixes must only contain ASCII alphanumeric characters or underscores. Use a custom name generator function if necessary.

### Best Practices

- Use `SCOPED_TRACE` or `testing::ScopedTrace` to add contextual messages for failure diagnostics within nested test calls.

- Use the many helpful parameter generators GoogleTest offers to methodically cover many input permutations without duplication.

- Define typed tests when you want to check the same behavior across various types and ensure compile-time consistency.

- Keep your fixtures clean and focused; avoid adding unrelated setup code that only some tests use.

- Use `INSTANTIATE_TEST_SUITE_P` at global or namespace scope, not inside functions.

---

## Next Steps & Related Content

- Explore the [Advanced GoogleTest Topics](docs/advanced.md) for deeper insights into test suite setup and complex fixtures.
- See the [Value-Parameterized Tests](docs/advanced.md#value-parameterized-tests) and [Typed Tests](docs/advanced.md#typed-tests) sections for richer examples.
- Check the [Testing Reference](docs/reference/testing.md) for a complete list of macros and functions discussed here.
- Consult the [Mocking Reference](docs/reference/mocking.md) if integrating mocks with parameterized tests.
- For a gentle introduction, start with the [GoogleTest Primer](docs/primer.md) and [Writing Your First Test](guides/getting-started-with-googletest/writing-your-first-test.mdx).

---

## Additional Resources

- Official [GoogleTest GitHub Samples](https://github.com/google/googletest/tree/main/googletest/samples) including sample7 (value-parameterized) and sample6 (typed tests).
- The `README.md` in the GoogleTest repo for latest details and community practices.

---

<AccordionGroup title="Quick Reference">
<Accordion title="Key Macros for Fixtures and Parameterized Tests">
- `TEST_F(FixtureName, TestName)`: Defines a test using a fixture.
- `TEST_P(FixtureName, TestName)`: Defines a value-parameterized test.
- `INSTANTIATE_TEST_SUITE_P(Name, FixtureName, ParamGenerator)`: Instantiates parameterized tests.
- `TYPED_TEST_SUITE(FixtureTemplate, Types)`: Defines a typed test suite.
- `TYPED_TEST(FixtureName, TestName)`: Defines a typed test.
</Accordion>
<Accordion title="Common Parameter Generators">
- `Values(...)`
- `ValuesIn(container or array)`
- `Range(start, end [, step])`
- `Bool()`
- `Combine(...)`
</Accordion>
<Accordion title="Important Notes">
- `GetParam()` accesses parameter in `TEST_P`.
- Avoid underscores in test and suite names.
- Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` for tests meant to be instantiated elsewhere.
</Accordion>
</AccordionGroup>

---

## Summary

GoogleTest's support for test fixtures and parameterized tests empowers developers to write cleaner, scalable, and thoroughly covered tests by sharing setup logic and running tests across diverse inputs and types without duplicating code. The framework's flexible parameter generators and type-parameterized test infrastructure enable systematic and maintainable testing strategies.

---

## Source

For detailed implementation and further examples, refer to:

- [`docs/advanced.md`](https://github.com/google/googletest/blob/main/docs/advanced.md#value-parameterized-tests) — Advanced usage of fixtures and parameterized tests.
- [`docs/reference/testing.md`](https://github.com/google/googletest/blob/main/docs/reference/testing.md#value-parameterized-tests) — Macro and function references.
- [`googletest/test/googletest-param-test-test.cc`](https://github.com/google/googletest/blob/main/googletest/test/googletest-param-test-test.cc) — Tests validating parameter generators.

---