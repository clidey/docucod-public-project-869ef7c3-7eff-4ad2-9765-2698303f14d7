---
title: "Installation and Project Setup"
description: "Discover how to install GoogleTest, configure your environment for C++, and integrate the framework using CMake or Bazel. This guide focuses on steps for compiler and environment compatibility, providing a stable base for test-driven development."
---

# Installation and Project Setup

## Overview
This guide walks you through installing GoogleTest, preparing your development environment for C++ testing, and integrating GoogleTest into your projects using CMake (primary) and includes notes on alternative methods. By following these instructions, you'll build a stable foundation for incorporating automated testing into your development workflow.

---

## Prerequisites
- A C++ development environment with at least C++17 support.
- Compatible compiler: GCC 7.1+, Clang 5.0+, MSVC 2015 Update 3 or newer.
- CMake version 3.13 or higher (recommended 3.14+ for FetchContent integration).
- Basic familiarity with CMake build systems.
- Internet connection to clone the GoogleTest repository, unless using pre-downloaded source or packages.

---

## Expected Outcome
Following this guide, you will have:
- Installed GoogleTest and GoogleMock libraries in your system or local environment.
- Configured your project build with appropriate compiler and linker flags for GoogleTest.
- Created and built a test executable linked against GoogleTest and/or GoogleMock.
- Verified your installation by running sample tests.

---

## Time Estimate
Approximately 15-30 minutes, depending on your setup speed and familiarity with CMake.

---

## Step-By-Step Instructions

### 1. Clone the GoogleTest Repository
GoogleTest includes GoogleMock by default.

```bash
# Clone the repository at a stable release tag (example: v1.17.0)
git clone https://github.com/google/googletest.git -b v1.17.0
dcd googletest
```

### 2. Create a Build Directory and Generate Build Files

```bash
mkdir build
cd build
cmake ..
```

This generates native build system files (Makefiles on Linux, Visual Studio solutions on Windows, etc.)

### 3. Build the GoogleTest and GoogleMock Libraries

```bash
make
# or on Windows, build the solution in Visual Studio.
```

### 4. (Optional) Install GoogleTest System-wide
If you have system permissions and want to install GoogleTest for global access:

```bash
sudo make install
```

By default, this will install to `/usr/local/` on Linux/macOS.

### 5. Integrate GoogleTest into Your Project Using CMake

#### a) Find Installed GoogleTest

If you installed GoogleTest or have it available in your system:

```cmake
find_package(GTest REQUIRED)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests PRIVATE GTest::gtest_main)
enable_testing()
add_test(NAME RunMyTests COMMAND my_tests)
```

#### b) Using GoogleTest as a Subdirectory (Build from Source)

If you prefer to build GoogleTest as part of your project (recommended for matching compiler/linker flags):

```cmake
add_subdirectory(path/to/googletest)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests PRIVATE gtest_main)
enable_testing()
add_test(NAME RunMyTests COMMAND my_tests)
```

This ensures a consistent build environment for tests.

### 6. Build Your Test Executable

Run your build system (Make, Ninja, MSBuild, etc.) in your project's build directory.

### 7. Run Your Tests

Execute your test binary directly or use CTest for integration:

```bash
./my_tests
# or
ctest
```

Successful execution confirms your setup.

---

## Detailed Notes on Compiler and Linker Flags

- GoogleTest requires C++17 or newer.
- The build scripts automatically configure threading support:
  - If pthread is available and enabled, `-DGTEST_HAS_PTHREAD=1` is added.
- If building shared libraries on Windows, run-time linkage and flag settings will be handled by `gtest_force_shared_crt`.

For advanced customization, review [googletest/cmake/internal_utils.cmake](https://github.com/google/googletest/blob/main/googletest/cmake/internal_utils.cmake).

---

## Using pkg-config to Integrate GoogleTest

If GoogleTest is installed with `.pc` files, pkg-config can help retrieve compiling and linking flags.

### Example CMake usage:

```cmake
find_package(PkgConfig REQUIRED)
pkg_search_module(GTEST REQUIRED gtest_main)

add_executable(my_tests test_main.cpp)
target_compile_options(my_tests PRIVATE ${GTEST_CFLAGS})
target_link_libraries(my_tests PRIVATE ${GTEST_LDFLAGS})

enable_testing()
add_test(NAME RunMyTests COMMAND my_tests)
```

Make sure to set `PKG_CONFIG_PATH` or `PKG_CONFIG_LIBDIR` if your installation places `.pc` files in non-standard locations.

---

## Best Practices

- Use `gtest_main` or `gmock_main` library to avoid writing your own `main()` in most cases.
- Prefer building GoogleTest from source inside your project for consistency.
- Avoid mixing different runtime libraries on Windows to prevent linker errors. Use `gtest_force_shared_crt` when appropriate.
- Ensure your compiler supports C++17 as older versions are not compatible.

---

## Common Pitfalls and Troubleshooting

### Problem: Linker Errors or Missing `main()`
- Solution: Link your test executable against `gtest_main` or `gmock_main` to get the default `main()` implementation.

### Problem: Compiler or runtime mismatch on Windows
- Solution: Use `-Dgtest_force_shared_crt=ON` flag if your project uses dynamic CRT.

### Problem: pthread not detected or race conditions in tests
- Solution: Add `-DGTEST_HAS_PTHREAD=1` if you know pthread is available.

### Problem: Tests not running or no tests detected
- Solution: Ensure `InitGoogleTest()` is called in your `main()` (if you write your own), or link against `gtest_main`.

For more detailed issues, consult the Troubleshooting Installation and Build Issues guide.

---

## Example: Minimal `CMakeLists.txt` to Build Tests
```cmake
cmake_minimum_required(VERSION 3.13)
project(MyProject CXX)

# Download GoogleTest via FetchContent (requires CMake 3.14+)
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/v1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests PRIVATE gtest_main)
enable_testing()
add_test(NAME RunMyTests COMMAND my_tests)
```

---

## Example: Basic Test File `test_main.cpp`
```c++
#include <gtest/gtest.h>

TEST(SampleTest, AlwaysPasses) {
  EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## Next Steps
After setting up and confirming your build environment:
- Learn to write tests with `TEST()` and `TEST_F()` macros.
- Explore assertions and matchers to express test expectations.
- Understand test fixtures for sharing setup and teardown code.
- Integrate GoogleMock for advanced mocking capabilities.

Useful links:
- [Writing Your First Test](../guides/getting-started-with-googletest/writing-your-first-test)
- [Understanding Test Execution and Output](../guides/getting-started-with-googletest/understanding-test-execution)
- [Troubleshooting Installation and Build Issues](../getting-started/troubleshooting-faq/common-install-issues)

---

## Additional Resources
- Official GoogleTest repository: https://github.com/google/googletest
- GoogleMock integration details can be found in the `googlemock` directory.
- `gmock_main.pc.in` and `gmock/CMakeLists.txt` provide insight into pkg-config and CMake support for GoogleMock.

<Tip>
Building GoogleTest and GoogleMock as part of your project ensures maximum compatibility especially regarding compiler flags and runtime library linkage.
</Tip>

<Note>
While GoogleTest's CMake support is community-driven and values contributions, maintainers do not use CMake internally. This means active testing and validation on various platforms help improve build scripts.
</Note>