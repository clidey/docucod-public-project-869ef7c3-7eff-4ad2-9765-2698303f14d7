---
title: "Choosing the Right Assertions"
description: "Explore the range of assertion macros available in GoogleTest, when to use fatal vs non-fatal checks, and best practices for making your test failures maximally informative and debuggable."
---

# Choosing the Right Assertions

Explore the range of assertion macros available in GoogleTest, when to use fatal vs non-fatal checks, and best practices for making your test failures maximally informative and debuggable.

---

## Understanding Assertions in GoogleTest

Assertions in GoogleTest allow you to verify your code’s behavior and ensure test correctness. They come primarily in pairs:

- **EXPECT_** assertions generate *non-fatal* failures, allowing the test to continue running.
- **ASSERT_** assertions generate *fatal* failures, aborting the current function immediately.

Choosing the appropriate assertion type in your tests can help you write clearer, more robust, and debuggable test cases.

## When to Use Fatal vs Non-fatal Assertions

### Fatal Assertions (`ASSERT_` macros)

- Abort the current test function immediately on failure.
- Use when further execution in the function depends on the condition being true.
- Examples include:
  - Verifying critical preconditions
  - Ensuring necessary setup succeeded

### Non-fatal Assertions (`EXPECT_` macros)

- Report a failure but allow the current function to continue.
- Use when you want to collect multiple failures in a single test run.
- Best when failures don't prevent meaningful further checks.

### Practical Guidance

- Use `ASSERT_` to fail fast when continuing doesn't make sense.
- Use `EXPECT_` for multiple checks that are independent and informative.

<Tip>
Balancing fatal and non-fatal assertions improves test diagnostic power and speeds debugging.
</Tip>

## Commonly Used Assertion Macros

GoogleTest provides a rich set of assertion macros for different test scenarios:

### Boolean Conditions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)` — Check if condition is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)` — Check if condition is false.

### Equality and Comparison

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — Check equality with `operator==`.
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — Check inequality.
- `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)` — Less than.
- `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)` — Less or equal.
- `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)` — Greater than.
- `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)` — Greater or equal.

### Floating-Point Comparisons

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)` — Approximate equality for `float`.
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)` — Approximate equality for `double`.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)` — Checks if values differ by less than `abs_error`.

### String Comparisons

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)` — Compares C strings for equality.
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)` — Compares for inequality.
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)` — Case-insensitive equality.
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)` — Case-insensitive inequality.

### Exception Assertions (Requires exceptions enabled)

- `EXPECT_THROW(statement, exception_type)` — Expect statement throws specified exception.
- `EXPECT_ANY_THROW(statement)` — Expect statement throws any exception.
- `EXPECT_NO_THROW(statement)` — Expect statement does not throw.

### Explicit Success and Failure

- `SUCCEED()` — Marks success explicitly.
- `FAIL()` — Generates fatal failure.
- `ADD_FAILURE()` — Generates non-fatal failure.

## Using Matchers for More Powerful Assertions

Use `EXPECT_THAT(value, matcher)` and `ASSERT_THAT(value,matcher)` to write expressive assertions leveraging GoogleMock matchers. This allows verification of complex properties and improves failure diagnostics.

```cpp
EXPECT_THAT(value, StartsWith("Hello"));
ASSERT_THAT(value, AllOf(Gt(5), Lt(10)));
```

For details on matchers, refer to the [Matchers Reference](/api-reference/advanced-behaviors/argument-matchers).

## Best Practices for Writing Effective Assertions

- Prefer *specific* assertions targeting one property per test.
- Use *non-fatal* assertions when subsequent checks still provide value.
- Use *fatal* assertions for critical fail-fast checks.
- Stream failure messages to assertions using `<<` for clarity:

```cpp
EXPECT_EQ(result, expected) << "Computation error for input " << input_value;
```

- Favor `EXPECT_THAT` with matchers for readable, expressive tests.
- Avoid overusing `EXPECT_CALL` or `EXPECT_` without intention, to prevent brittle tests.

## How Assertions Affect Test Outcomes

- Multiple failures in a single test function may be reported with `EXPECT_` assertions.
- `ASSERT_` failures abort the current function immediately, skipping subsequent assertions.

## Step-by-Step: Using Assertions Correctly

<Steps>
<Step title="Write your test condition">Identify the condition or value you want to verify in your test.</Step>
<Step title="Choose assertion type">Decide between `EXPECT_` and `ASSERT_` depending on whether the test can proceed upon failure.</Step>
<Step title="Select appropriate macro">Use GoogleTest assertion matching your verification (e.g., `EXPECT_EQ`, `ASSERT_TRUE`, `EXPECT_THAT`).</Step>
<Step title="Add descriptive failure messages">Use streaming to add contextual messages to help diagnose failures.</Step>
<Step title="Run and interpret results">Run your tests and check failure output for clarity and actionable information.</Step>
</Steps>

## Examples

```cpp
TEST(MathTest, SumIsCorrect) {
  int x = 1 + 1;
  EXPECT_EQ(x, 2) << "Basic addition failed";

  int y = 3 + 4;
  ASSERT_EQ(y, 7) << "Unexpected sum of 3 + 4";

  // No code here runs if ASSERT_EQ fails above
}

TEST(StringTest, StartsWithHello) {
  std::string greeting = "Hello, world!";
  EXPECT_THAT(greeting, StartsWith("Hello"));
}

TEST(ExceptionTest, ThrowsOnInvalidInput) {
  ASSERT_THROW(MyFunction(-1), std::invalid_argument);
}
```

## Troubleshooting Common Issues

### Assertion Failure But Test Continues
- Check if you used `EXPECT_` instead of `ASSERT_`. Use `ASSERT_` if the test should abort.

### Multiple Failures Obscuring Root Cause
- Stream helpful messages to assertions for better debugging.
- Consider splitting complex tests into smaller units.

### Misleading String Comparison Failures
- Use `EXPECT_STREQ`/`ASSERT_STREQ` for C strings instead of `EXPECT_EQ`, which compares pointers.

### Floating Point Comparison Surprises
- Use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR` for approximate equality instead of `EXPECT_EQ`.

<Note>
To debug unexpected assertion failures, run tests with verbose output or with `--gmock_verbose=info` flag.
</Note>

## Summary

Choosing the right assertion macros in GoogleTest ensures your tests are robust, maintainable, and clear. Fatal assertions (`ASSERT_`) help you stop test execution when conditions are critical, while non-fatal assertions (`EXPECT_`) allow for multiple checks per test. Leveraging matchers with `EXPECT_THAT` enhances expressiveness and failure clarity.

## Next Steps

- Explore the [Assertions Reference](../api-reference/core-apis/assertions) for detailed macro usage.
- Learn about [Matchers](../api-reference/advanced-behaviors/argument-matchers) to write expressive assertions.
- Combine assertions with your mocks and expectations as detailed in the [Mocking Workflows Guide](/guides/effective-testing-techniques/mocking-workflows).

---

## References

- [GoogleTest Assertions Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md)
- [Matchers Reference](../api-reference/advanced-behaviors/argument-matchers)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#UseOnCall)
- [Choosing the Right Assertions Guide](https://google.github.io/googletest/guides/effective-testing-techniques/assertions-best-practices.html)

---

*This page fits within the Effective Testing Techniques guides, complementing the test structure and mocking workflow documentation.*