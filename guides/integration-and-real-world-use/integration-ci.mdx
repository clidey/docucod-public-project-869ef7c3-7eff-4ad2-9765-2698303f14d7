---
title: "Integrating with Continuous Integration Systems"
description: "How to run your tests automatically in CI pipelines (e.g., GitHub Actions, Jenkins). Includes setup examples, troubleshooting tips, and recommendations for reporting and analyzing test results."
---

# Integrating with Continuous Integration Systems

## Overview

This guide walks you through running your GoogleTest and GoogleMock tests automatically within Continuous Integration (CI) pipelines such as GitHub Actions, Jenkins, GitLab CI, and others. You will learn how to configure your CI environment for smooth test execution, capture and analyze test results, and handle common issues encountered in automated workflows.

GoogleTest and GoogleMock are designed with automation in mind, supporting command-line options and output formats ideal for CI integration. Leveraging these features helps ensure your tests run reliably and provide actionable feedback without manual intervention.

---

## 1. Preparing Your Test Suite for CI

### 1.1. Ensure Tests are Self-contained and Repeatable

- Avoid relying on external side effects not reset between runs.
- Make sure tests don't require interactive input.
- Use fixtures (`TEST_F`) to create predictable, clean test environments.

### 1.2. Use `RUN_ALL_TESTS()` as the Entry Point

- Your `main()` function must call `testing::InitGoogleTest()` followed by `RUN_ALL_TESTS()`.
- This setup allows the framework to parse flags and discover tests automatically.

Example main function:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### 1.3. Compile with Thread Support Enabled

- GoogleTest is thread-safe when compiled with pthread support.
- Ensure your build includes the appropriate threading flags (e.g., `-pthread` on Linux).

---

## 2. Running Tests in CI Pipelines

### 2.1. Command Line Invocation

Run the test executable with the following standard approach:

```bash
./your_test_binary
```

This runs all registered tests, prints test progress, and returns exit code `0` if all tests pass.

### 2.2. Passing GoogleTest Flags

You can pass GoogleTest flags to control test execution, filtering, output verbosity, and results reporting. Some common flags:

| Flag                         | Description                                  | Example
|------------------------------|----------------------------------------------|--------------------------
| `--gtest_filter=`             | Run only tests matching pattern(s).           | `--gtest_filter=MySuite*` |
| `--gtest_output=xml:<file>`  | Output test results in XML format to file.    | `--gtest_output=xml:report.xml` |
| `--gtest_color=yes/no/auto`  | Enable/disable colored output.                 | `--gtest_color=auto` |
| `--gtest_repeat=<count>`     | Run tests multiple times for stability check. | `--gtest_repeat=3` |
| `--gtest_break_on_failure`   | Abort on first test failure (optional).       | `--gtest_break_on_failure` |

**Example:** Running tests with XML output for CI reports:

```bash
./your_test_binary --gtest_output=xml:report.xml
```

### 2.3. Exit Codes and CI Success Criteria

- `RUN_ALL_TESTS()` returns `0` if all tests succeed.
- Any failures cause a nonzero return code, making CI pipelines detect failures automatically.

---

## 3. Setting Up Test Reporting and Integration Examples

### 3.1. Using GoogleTest XML Output in CI

GoogleTest generates detailed XML reports compatible with many CI systems' test report parsers.

- Enable XML output with `--gtest_output=xml:<filename>`.
- After test execution, upload or expose the XML file for your CI system to parse.

#### Example GitHub Actions Workflow Snippet

```yaml
name: C++ Tests

on: [push, pull_request]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2
    - name: Install dependencies
      run: sudo apt-get install -y build-essential cmake
    - name: Build
      run: |
        mkdir build && cd build
        cmake ..
        make
    - name: Run tests
      run: ./build/your_test_binary --gtest_output=xml:test-results.xml
    - name: Upload test results
      uses: actions/upload-artifact@v3
      with:
        name: test-results
        path: test-results.xml
```

*Tip:* Many CI tools automatically display and parse JUnit-style XML test reports generated by GoogleTest.

### 3.2. Jenkins Example

- Configure your build step to run tests with XML output

```bash
./your_test_binary --gtest_output=xml:report.xml
```

- In Jenkins, add a “Publish JUnit test result report” post-build action pointing to the XML file.

---

## 4. Troubleshooting Common CI Integration Issues

### 4.1. Tests Not Discovered or Running

- Verify that `InitGoogleTest()` is called before `RUN_ALL_TESTS()`.
- Check that your test executables include the tests (they must be linked properly).
- Confirm that test suites and tests do not use underscores in their names (GoogleTest requires identifier-conforming names).

### 4.2. Flaky or Timing-sensitive Tests

- Use `--gtest_repeat=<count>` to run tests multiple times and catch non-deterministic failures.
- Review fixture setup/teardown for state leaks or parallel resource conflicts.

### 4.3. Output XML File Not Created or Empty

- Confirm write permissions in the build and CI environment.
- Check your command-line flags for typos.
- Validate the working directory to ensure the test output path is correct.

### 4.4. Handling Failed Tests in CI

- Ensure your CI parses the exit code of the test binary (GoogleTest exits with nonzero on failures).
- Review test logs and XML reports for failure details.
- If needed, enable verbose logging using `--gtest_brief=0` (default) or `--gtest_color=yes` for clearer output.

<Warning>
Avoid ignoring `RUN_ALL_TESTS()` return code in your CI scripts. Its exit status governs test pass/fail recognition.
</Warning>

---

## 5. Best Practices for CI Integration

- **Isolate Tests:** Ensure that tests do not share global state that might cause flaky results across runs.
- **Use Parameterized Tests:** Leverage `TEST_P` and `INSTANTIATE_TEST_SUITE_P` for broad test coverage with varied inputs.
- **Leverage Filters:** Use `--gtest_filter` to run subsets of tests during presubmits or partial builds.
- **Parallel Execution:** If supported by your CI, run multiple test executables in parallel to speed up testing.
- **Test Environment Setup:** Use `testing::Environment` subclasses to handle expensive setup/teardown once per test run.
- **Integrate with Coverage and Static Analysis:** Combine test runs with coverage tools and linters to enhance quality.

---

## 6. Further Customization and Advanced Topics

### 6.1. Custom Test Listeners

- Implement or attach `TestEventListener` to capture detailed test events and integrate with custom reporting.

### 6.2. Skipping and Conditional Test Execution

- Use `GTEST_SKIP()` in test code to dynamically skip tests under certain conditions (e.g., lack of environment features).

### 6.3. Repeat Tests for Stability

- Use `--gtest_repeat` combined with `--gtest_shuffle` flags to detect flaky tests.

---

## 7. Summary

This page equips you with the knowledge to successfully automate GoogleTest test executions in any CI system, maximize reliability, capture results effectively, and quickly resolve common integration issues. Following these guidelines will help maintain robust continuous quality assurance for your C++ projects.

---

## References and Links

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) - For writing tests and fixtures
- [Running Tests - Command Line Flags](https://google.github.io/googletest/advanced.html#running-a-subset-of-the-tests) - Flags and usage
- [GoogleTest XML Output](https://github.com/google/googletest/blob/main/docs/advanced.md#generating-xml-output) - XML format details
- [GitHub Actions for C++](https://docs.github.com/en/actions/automating-builds-and-tests/building-and-testing-cpp) - Workflow examples
- [Jenkins JUnit Plugin](https://plugins.jenkins.io/junit/) - For XML report parsing
- [Writing Your First Test](getting-started/configuration-validation/writing-first-test.md) - Tutorial for new users

---

## Appendix: Minimal CI Test Command Example

```bash
# Run all tests with XML output into test_results.xml
./my_tests --gtest_output=xml:test_results.xml

# Use optional flags for filtered or repeated runs
./my_tests --gtest_filter=MyTestSuite.* --gtest_repeat=5
```


---


