---
title: "Integrating with CI/CD and Build Systems"
description: "A pragmatic walkthrough on running GoogleTest in common CI/CD pipelines (like GitHub Actions, Jenkins), configuring for different platforms, and using Bazel or CMake for test automation."
---

# Integrating with CI/CD and Build Systems

## Overview

This guide delivers a pragmatic walkthrough for incorporating GoogleTest into common continuous integration and delivery (CI/CD) pipelines such as GitHub Actions and Jenkins. It also addresses configuring GoogleTest across different platforms and utilizing popular build systems like Bazel and CMake for automated test building and execution.

By following this guide, you will systematically enable automated test runs, integrate GoogleTest cleanly with your existing build workflows, and optimize your test automation process for different development environments.

---

## 1. Understanding the Workflow

### What You Will Accomplish
- Automate running GoogleTest tests as part of your CI/CD pipelines.
- Configure GoogleTest test execution on multiple platforms (Linux, Windows, macOS).
- Build and link GoogleTest tests using Bazel and CMake effectively.
- Interpret test outcomes and troubleshoot common integration issues.

### Prerequisites
- A working GoogleTest test suite in your project.
- Access to a CI/CD pipeline environment (e.g., GitHub Actions, Jenkins).
- Familiarity with your build system (Bazel or CMake).
- Compilers and tools supporting the C++17 standard.

### Expected Outcome
After completing the steps, your CI/CD pipeline will:
- Automatically detect and execute all your GoogleTest-based tests.
- Report test results clearly and reliably.
- Support running tests on multiple platforms with consistent behavior.
- Allow easy configuration and extension for complex pipeline scenarios.

### Time Estimate
20 to 45 minutes depending on your current project setup and CI/CD experience.

### Difficulty Level
Intermediate (requires basic knowledge of CI/CD and build system configuration).

---

## 2. Step-by-Step Instructions

### Step 1: Prepare Your Test Binary

GoogleTest produces one or more test binaries (executables) that run your tests. Ensure your test binary is built correctly with GoogleTest linked, either using Bazel or CMake.

#### With CMake

1. Include GoogleTest in your CMakeLists.txt (either via `find_package` or as a subdirectory).
2. Link your test executable to `gtest_main` or `gmock_main` to get the default `main()` function that runs all tests.

Example snippet:
```cmake
find_package(GTest REQUIRED)
add_executable(my_tests test_suite.cpp)
target_link_libraries(my_tests PRIVATE GTest::gtest_main)
add_test(NAME MyTests COMMAND my_tests)
```

*Tip:* Linking with `gtest_main` eliminates the need to write your own main function, as it initializes GoogleTest and runs all tests.

#### With Bazel

In your BUILD file:
```python
cc_test(
    name = "my_tests",
    srcs = ["test_suite.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

This will build a self-contained test binary linked against GoogleTest.

### Step 2: Validate Test Binary Locally

Run your test binary locally to ensure:
- Tests execute without errors.
- Results output is clear and actionable.
- The exit code is zero when all tests pass, non-zero otherwise.

```bash
./my_tests --gtest_color=yes --gtest_output=xml:report.xml
```

*Verification:* Check the terminal output and any generated XML file for detailed results.

### Step 3: Configure Your CI Pipeline to Build Tests

Set up your CI pipeline to build your test binaries using your build system commands.

#### GitHub Actions Example
```yaml
name: C++ Tests

on: [push, pull_request]

jobs:
  build_and_test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Install Dependencies
        run: sudo apt-get install -y cmake g++
      - name: Build Tests
        run: |
          mkdir build && cd build
          cmake ..
          make -j$(nproc)
      - name: Run Tests
        run: |
          cd build
          ./my_tests --gtest_output=xml:test_results.xml
      - name: Upload Test Results
        uses: actions/upload-artifact@v3
        with:
          name: Test Results
          path: build/test_results.xml
```

#### Jenkins Pipeline Example (Declarative)
```groovy
pipeline {
  agent any

  stages {
    stage('Checkout') {
      steps { checkout scm }
    }
    stage('Build') {
      steps {
        sh 'mkdir -p build && cd build && cmake .. && make'
      }
    }
    stage('Test') {
      steps {
        sh 'build/my_tests --gtest_output=xml:test_results.xml'
        junit 'test_results.xml'
      }
    }
  }
}
```

*Tip:* Ensure your environment installs required dependencies, such as compilers and CMake.

### Step 4: Enable Cross-Platform Testing

GoogleTest supports Linux, Windows, and macOS. To run tests on different platforms:

- In GitHub Actions, specify multiple runner OSes:
```yaml
jobs:
  build_and_test:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
    runs-on: ${{ matrix.os }}
    steps:
      ...
```

- Configure the build commands according to platform specifics, e.g. `msbuild` on Windows or adjusting paths.

- Use platform detection macros and recommended build flags to ensure compatibility (see [Supported Platforms & Dependencies](../overview/integration-and-ecosystem/platforms-dependencies.md)).

### Step 5: Run Tests with Desired Flags for CI Environments

Common command-line flags to pass when running tests in CI/CD:
- `--gtest_color=no` (disable color output if your CI console does not support it)
- `--gtest_output=xml:<file>` (generate XML reports consumable by CI test reporters)
- `--gtest_filter=` (to run specific test subsets when needed)

Example:
```bash
./my_tests --gtest_color=no --gtest_output=xml:results.xml
```

*Tip:* Producing XML output enables results integration with CI dashboards.

### Step 6: Interpret Test Results in CI

- Most CI tools can parse the XML files generated by GoogleTest to display test results in their UI.
- Configure your CI jobs to publish or archive these results.
- Failures will cause the CI job to fail, providing immediate feedback.

### Step 7: Handle Common Issues

If your tests do not run as expected in the CI environment, check:
- **Build failures:** Missing dependencies or incompatible compiler versions.
- **Runtime errors:** Environment variable differences or file path mismatches.
- **Empty test suites:** Verify test registration and linking (see [Initial Configuration](../getting-started/setup-requirements-installation/initial-configuration.md)).
- **Linker errors:** Ensure consistent runtime linkage (e.g., dynamic vs static runtimes on Windows).

Retry running your tests locally with the same flags used in CI to debug.

---

## 3. Examples & Integration Samples

### Minimal GitHub Actions Workflow Example

```yaml
name: GoogleTest CI

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: lukka/get-cmake@v3
      with:
        cmakeVersion: '3.22.0'
    - name: Build
      run: |
        mkdir build && cd build
        cmake ..
        cmake --build .
    - name: Run tests
      run: |
        ./build/my_tests --gtest_output=xml:test_results.xml --gtest_color=no
    - uses: actions/upload-artifact@v3
      with:
        name: test-results
        path: build/test_results.xml
```

### Bazel Integration Snippet

```bash
bazel test //path/to/my_tests
```

Bazel automatically handles building and running GoogleTest targets, reporting pass/fail status.

*Tip:* Use `bazel test --test_output=errors` to see detailed failing test output.

---

## 4. Troubleshooting & Best Practices

### Common Issues and Solutions

| Issue                         | Cause                                               | Resolution                                                  |
|-------------------------------|----------------------------------------------------|-------------------------------------------------------------|
| Tests not discovered           | Missing or incorrect test registration              | Use `TEST()` or `TEST_F()` macros correctly; link with gtest_main or gmock_main. |
| Linker errors (unresolved symbols) | Incorrect linking of GoogleTest or threading libs | Confirm libraries (gtest, gmock_main) are linked; add pthread if on Linux.   |
| Test results not reporting in CI | Missing XML output flag or incorrect paths         | Use `--gtest_output=xml:<file>` and archive this in CI.     |
| Runtime crashes                | Incompatible runtime libraries or env setup        | Match runtime linkage (static/dynamic), verify compiler version.              |

### Best Practices

- Always link your test executables with `gtest_main` or `gmock_main` for standard entry points.
- Use consistent compiler flags across platforms to prevent runtime discrepancies.
- Generate XML output by default in CI to leverage test result visualization.
- Keep your CI build environment clean and predictableâ€”cache dependencies thoughtfully.
- In Bazel builds, rely on target dependencies to minimize manual linking errors.

### Performance Considerations

- Parallelize your test execution wherever supported by your CI tool to reduce overall build time.
- Use selective test filtering (`--gtest_filter=`) during iterative development cycles.
- Cache build artifacts especially when using CMake to speed up repeat builds.

### Alternative Approaches

- In some pipelines, consider containerizing test execution environments to ensure reproducibility.
- Use third-party GoogleTest GUI runners or dashboards integrated into your CI for enhanced visibility.

---

## 5. Next Steps & Related Content

- Explore the [Setup & Installation](../getting-started/setup-requirements-installation/installing-googletest.md) guide for detailed environment preparation.
- Review [Initial Configuration](../getting-started/setup-requirements-installation/initial-configuration.md) to learn proper test setup.
- Use the [Running Tests](../getting-started/first-run-validation/running-tests.md) guide for deeper insights into test execution and flags.
- For advanced CI integration, refer to ecosystem integrations at [Integration with Tools & Extensions](../overview/integration-and-ecosystem/ecosystem-integrations.md).
- Investigate [Troubleshooting Installation Issues](../getting-started/first-run-validation/installation-troubleshooting.md) if builds or tests fail in your CI.

---

<Info>
This guide focuses exclusively on integrating GoogleTest with CI/CD pipelines and build systems. For broader GoogleTest concepts and API references, please consult the User's Guide index.
</Info>
