---
title: "Setting Up and Configuring GoogleTest"
description: "Learn how to incorporate GoogleTest into your C++ project using CMake and Bazel. This page covers download, installation, linking, and configuration basics, ensuring a smooth start regardless of the chosen build system."
---

# Setting Up and Configuring GoogleTest

Learn how to incorporate GoogleTest into your C++ project using CMake and Bazel. This guide covers downloading, installation, linking, and the basic configuration steps needed to start testing smoothly, regardless of your chosen build system.

---

## Workflow Overview

### What This Guide Will Help You Accomplish
This guide will enable you to integrate GoogleTest into your C++ project by configuring it with either CMake or Bazel. You will learn how to acquire the source code, build the framework, link it properly in your project, and make sure everything is set up for running tests.

### Prerequisites
- A C++ development environment with a supported compiler (see [Prerequisites & System Requirements](../../getting-started/setup-basics/prerequisites-requirements) for platform/complier compatibility).
- Familiarity with CMake or Bazel build systems.
- Access to the internet or local source for obtaining GoogleTest.

### Expected Outcome
- GoogleTest and GoogleMock built and installed properly.
- Your project configured to link against GoogleTest libraries using either CMake or Bazel.
- Ability to compile and run tests leveraging GoogleTest's testing and mocking functionality.

### Time Estimate
Approximately 20-40 minutes depending on environment and familiarity.

### Difficulty Level
Beginner to Intermediate.

---

## Step-by-Step Instructions

### 1. Obtain the GoogleTest Source Code

- Clone the repository or download the latest release from the official GitHub repository:

```bash
git clone https://github.com/google/googletest.git
```

- Alternatively, download and extract the archive from the release page.

### 2. Building GoogleTest with CMake

The recommended way to build GoogleTest is using CMake.

1. Navigate to the GoogleTest directory:

```bash
cd googletest
```

2. Create a build directory:

```bash
mkdir build && cd build
```

3. Run CMake to configure the project:

```bash
cmake ..
```

4. Build the source:

```bash
cmake --build .
```

5. (Optional) Install to your system or a custom prefix:

```bash
cmake --install . --prefix=/desired/install/path
```

After installation, the libraries and headers will be available for your projects.

### 3. Integrating GoogleTest with Your CMake Project

Add the following to your project’s `CMakeLists.txt`:

```cmake
# Find or add GoogleTest
# If installed system-wide:
find_package(GTest REQUIRED)

# Add your test executable
add_executable(MyTests test_file1.cc test_file2.cc)

# Link against GoogleTest libraries
target_link_libraries(MyTests PRIVATE GTest::gtest GTest::gtest_main)

# Enable testing and add test
enable_testing()
add_test(NAME MyTests COMMAND MyTests)
```

If you build GoogleTest from source inside your project, you can add it as a subdirectory:

```cmake
add_subdirectory(path/to/googletest)
add_executable(MyTests test_file1.cc test_file2.cc)
target_link_libraries(MyTests PRIVATE gtest gtest_main)
```

### 4. Integrating GoogleTest With Bazel

GoogleTest includes Bazel build targets.

1. Add the following in your workspace's `WORKSPACE` file if you include GoogleTest as external repository, or use it locally:

```bazel
# Example: local repository
local_repository(
    name = "com_google_googletest",
    path = "path/to/googletest",
)
```

2. In your Bazel build file (`BUILD`), add a test target:

```bazel
cc_test(
    name = "my_test",
    srcs = [
        "my_test.cc",
    ],
    deps = [
        "@com_google_googletest//:gtest",
        "@com_google_googletest//:gmock",
    ],
)
```

3. Build and run your tests via:

```bash
bazel test //path/to:my_test
```

### 5. Linking and Using GoogleMock

GoogleMock is included with GoogleTest by default. Simply include `<gmock/gmock.h>` in your test sources and link against `gmock` or `gmock_main` as shown above.

### 6. Initializing GoogleMock in Test Code

In your `main()` function or test setup code, initialize GoogleMock (and GoogleTest) by calling:

```cpp
::testing::InitGoogleMock(&argc, argv);
return RUN_ALL_TESTS();
```

If you use the `gmock_main` library, it provides a main function, so you don't need to write your own.

---

## Practical Tips & Best Practices

- Build GoogleTest once and install it system-wide or to a well-known location to avoid rebuilding it for every project.
- Prefer using the bundled `gmock_main` target/library to simplify test runner setup.
- Always initialize GoogleMock before running tests to ensure all command-line flags and internal setup are processed.
- When working with Bazel, keep your WORKSPACE and BUILD files updated to reflect the GoogleTest version you use.

---

## Troubleshooting Common Issues

### Build Errors or Missing Dependencies
- Confirm your compiler supports at least C++11 as required by GoogleTest and GoogleMock.
- Ensure CMake is up-to-date (at least version 3.10 recommended).
- Check your compiler’s include and library paths if linking fails.

### Linking Errors with GoogleMock Symbols
- Link explicitly against `gmock` and `gmock_main` if you implement your own `main()`.
- If using `gmock_main`, do not define another `main()` function.

### Test Binary Fails to Run or Finds No Tests
- Verify you called `InitGoogleMock` before running tests.
- Confirm your test binary is linked with GoogleTest libraries.

### Bazel Build Failures
- Check `WORKSPACE` repository paths and targets.
- Run `bazel clean` before rebuilding if you update dependencies.

---

## Next Steps & Related Content

- Write and build your first test by following the [Writing Your First Test](../../getting-started/first-test-run/writing-first-test) guide.
- Learn how to run tests and interpret test results in the [Running and Validating Tests](../../getting-started/first-test-run/running-tests) documentation.
- For advanced configuration and integration tips, see the [Configuration & Environment Setup](../../getting-started/setup-basics/configuration-setup).
- Explore mocking capabilities thoroughly in the [Mocking with GoogleMock: A Practical Introduction](../core-workflows/mocking-basics) guide.

---

## References

- [Official GoogleTest GitHub Repository](https://github.com/google/googletest)
- [CMake Official Site](https://cmake.org/)
- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [GoogleMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)

---

This documentation page fits as a foundational setup guide within the broader GoogleTest onboarding flow, introducing users to build and configure the tool using common build systems before advancing to test writing and running workflows.
