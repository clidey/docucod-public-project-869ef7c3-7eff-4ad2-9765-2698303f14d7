---
title: "Mastering Assertions"
description: "Explore the rich set of built-in assertions GoogleTest offers, including equality, exceptions, floating point, and more. This guide explains when and how to use each assertion effectively, including tips for user-defined checks."
---

# Mastering Assertions

Explore the rich set of built-in assertions GoogleTest offers, including equality, exceptions, floating point, and more. This guide explains when and how to use each assertion effectively, including tips for user-defined checks.

---

## 1. Overview

Assertions verify that your code meets expected conditions and report failures when it does not. GoogleTest provides a wide variety of assertion macros tailored for different validation needs — from simple boolean checks to complex predicate matching and exception handling.

### Why Assertions Matter

Assertions are the primary mechanism to express test expectations clearly and concisely. Writing effective assertions leads to maintainable tests that quickly pinpoint defects when failures occur.

### Assertion Types

GoogleTest splits assertions into three main categories:

- **Boolean assertions:** check simple true/false conditions
- **Comparison assertions:** compare values with operators like `==`, `<`, `>`
- **Predicate assertions:** use complex matchers, predicates, or functions

Further, most macros come in paired variants: nonfatal (`EXPECT_`) and fatal (`ASSERT_`). Nonfatal failures notify the user but continue executing, while fatal failures abort the current test.


---

## 2. Boolean Conditions

Use these assertions to confirm that a condition is true or false.

### `EXPECT_TRUE(condition)` and `ASSERT_TRUE(condition)`

Verify that `condition` evaluates to `true`.

```cpp
EXPECT_TRUE(x > 0);
ASSERT_TRUE(Initialize());
```

Use `ASSERT_` variants when subsequent test steps depend on the condition.

### `EXPECT_FALSE(condition)` and `ASSERT_FALSE(condition)`

Verify that `condition` evaluates to `false`.

```cpp
EXPECT_FALSE(user.IsExpired());
```


---

## 3. Comparison Assertions

These assertions verify expected relationships between two values.

| Macro         | Meaning                                      |
|---------------|----------------------------------------------|
| `EXPECT_EQ`   | Checks `val1 == val2`                         |
| `EXPECT_NE`   | Checks `val1 != val2`                         |
| `EXPECT_LT`   | Checks `val1 < val2`                          |
| `EXPECT_LE`   | Checks `val1 <= val2`                         |
| `EXPECT_GT`   | Checks `val1 > val2`                          |
| `EXPECT_GE`   | Checks `val1 >= val2`                         |

Each has a fatal counterpart prefixed with `ASSERT_`.

### Using `EXPECT_EQ` and `EXPECT_NE`

Use when values are expected to be equal or not equal.

```cpp
EXPECT_EQ(expected_count, result.Count());
ASSERT_NE(nullptr, handle);
```

Note: Comparing C strings (`const char*`) with `EXPECT_EQ` tests pointer equality, not string contents. Use `EXPECT_STREQ` and `EXPECT_STRNE` to compare string values.

### String Comparisons

| Macro            | Description                              |
|------------------|------------------------------------------|
| `EXPECT_STREQ`   | Asserts C strings have same contents    |
| `EXPECT_STRNE`   | Asserts C strings have different contents |
| `EXPECT_STRCASEEQ` | Asserts C strings are equal, ignoring case |
| `EXPECT_STRCASENE` | Asserts C strings are not equal, ignoring case |

#### Example

```cpp
EXPECT_STREQ("Hello", actual_c_string);
EXPECT_STRNE(expected_c_string, user_input);
```


---

## 4. Floating-Point Comparisons

Due to floating-point precision limitations, equality comparison with `EXPECT_EQ` is rarely suitable.

Use these macros designed to compare floats and doubles with specified tolerances:

| Macro              | Description                              |
|--------------------|------------------------------------------|
| `EXPECT_FLOAT_EQ`  | Checks two floats are approximately equal within 4 ULPs |
| `EXPECT_DOUBLE_EQ` | Same as above but for doubles              |
| `EXPECT_NEAR`      | Checks values differ by a custom absolute error |

#### Example

```cpp
EXPECT_FLOAT_EQ(3.14159f, result.pi);
EXPECT_DOUBLE_EQ(2.718281828, result.e);
EXPECT_NEAR(computed, expected, 1e-5);
```

Use `EXPECT_NEAR` when you want to explicitly define the maximum acceptable difference.


---

## 5. Predicate Assertions

When default operators aren't sufficient, predicates and matchers allow detailed validation.

### `EXPECT_THAT(value, matcher)`

Verifies that `value` matches the provided `matcher` (see GoogleMock's rich set of matchers).

```cpp
EXPECT_THAT(name, StartsWith("John"));
EXPECT_THAT(numbers, ElementsAre(1, 2, 3));
```

This assertion produces user-friendly failure messages explaining exactly how the match failed.

### Custom Predicate Functions

You can also use unary or multi-argument predicates:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_CALL(foo, Bar(Truly(IsEven)));
```

### Predicate Format Assertions: `EXPECT_PRED_FORMAT*`

Enables writing custom predicate formatters returning `testing::AssertionResult` with detailed failure messages.

```cpp
AssertionResult IsDivisibleBy(int value, int divisor);
EXPECT_PRED_FORMAT2(IsDivisibleBy, 10, 2);
```

### Boolean Predicate Assertions: `EXPECT_PRED*`

Useful when you just want to test that a predicate returns `true` for given arguments.


---

## 6. Exception Assertions

Test whether your code throws expected exceptions.

| Macro             | Description                              |
|-------------------|------------------------------------------|
| `EXPECT_THROW`    | Verifies that code throws a specific exception type |
| `EXPECT_ANY_THROW`| Verifies that code throws any exception  |
| `EXPECT_NO_THROW` | Verifies that code throws no exceptions  |

#### Example

```cpp
EXPECT_THROW(ThrowOnNull(nullptr), std::invalid_argument);
EXPECT_NO_THROW(ProcessData(valid_input));
```


---

## 7. Explicit Success and Failure

Sometimes you want to explicitly mark a test success or failure.

- `SUCCEED()` generates an explicit success report.
- `FAIL()` generates a fatal failure and aborts the current function.
- `ADD_FAILURE()` generates a nonfatal failure.

Use these for complex test flow control, e.g.:

```cpp
if (!ValidateConfig(config)) {
  FAIL() << "Configuration is invalid";
}
```


---

## 8. Death Assertions

GoogleTest supports assertions that a statement causes the program to terminate.

| Macro               | Description                                   |
|---------------------|-----------------------------------------------|
| `EXPECT_DEATH`      | Verifies process death with stderr output matching a regex |
| `EXPECT_DEBUG_DEATH`| Only in debug mode                            |
| `EXPECT_DEATH_IF_SUPPORTED` | Runs death assertions conditionally       |
| `EXPECT_EXIT`       | Verifies controlled process exit with predicate |

### Example

```cpp
EXPECT_DEATH({ CrashFunction(); }, "Segmentation fault");
```


---

## 9. Best Practices for Assertions

- Prefer **nonfatal** (`EXPECT_`) assertions unless the test cannot proceed.
- Make assertions **focused and meaningful** — test one property at a time.
- Favor **predicate assertions** for complex conditions to get clearer diagnostics.
- Use **`EXPECT_THAT`** with GoogleMock matchers to express intent clearly.
- When comparing floating points, always use **`EXPECT_FLOAT_EQ`**, **`EXPECT_DOUBLE_EQ`**, or **`EXPECT_NEAR`** instead of exact equality.
- Use **exception assertions** to validate error handling.
- When testing for death conditions, always provide a **meaningful matcher** for the output.


---

## 10. Troubleshooting Assertions

### Unexpected Assertion Failures

- Verify that the expressions being tested are correct and don't have side effects.
- For floating-point comparisons, check if the chosen tolerance is appropriate.
- Use verbose output (`--gtest_break_on_failure`) to debug failures step-by-step.

### Assertion Macro Selection

- Use `ASSERT_` variants when test flow depends critically on the assertion.
- Use `EXPECT_` variants to continue testing other assertions even after failure.

### Common Pitfalls

- Comparing C strings using `EXPECT_EQ` compares pointers, not contents—prefer `EXPECT_STREQ`.
- Using `EXPECT_EQ` on floats/doubles leads to brittle tests—use dedicated floating-point comparisons.
- Beware of side effects in predicates or argument evaluation.


---

## 11. Additional Resources

For further learning and examples, consult:

- [GoogleTest Assertion Macros Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md)
- [Matchers Reference](https://github.com/google/googletest/blob/main/docs/reference/matchers.md)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) for mocking and predicate examples

Explore related guides on mock behavior and advanced assertion techniques for deeper mastery.

---

## 12. Summary Table of Common Assertions

| Assertion            | When to Use                             |
|----------------------|---------------------------------------|
| `EXPECT_TRUE` / `ASSERT_TRUE` | Validate simple Boolean conditions    |
| `EXPECT_EQ` / `ASSERT_EQ`     | Check for equality                     |
| `EXPECT_NE` / `ASSERT_NE`     | Check for inequality                   |
| `EXPECT_STREQ` / `ASSERT_STREQ` | C-string content equality              |
| `EXPECT_FLOAT_EQ` / `ASSERT_FLOAT_EQ` | Float approximate equality             |
| `EXPECT_THAT`                | Complex predicates or matchers        |
| `EXPECT_THROW` / `ASSERT_THROW` | Verify exceptions                      |
| `EXPECT_DEATH`               | Test program termination behavior     |

---

## Callouts

<Tip>
Remember to include `#include <gtest/gtest.h>` in your test source files to access the assertion macros.
</Tip>

<Note>
Use `EXPECT_` macros to accumulate failures but continue running. Use `ASSERT_` when subsequent test steps require that assertion to pass.
</Note>

<Warning>
Never write assertions with side effects, as they may be evaluated multiple times or optimized away.
</Warning>
