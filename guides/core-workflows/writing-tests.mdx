---
title: "Writing and Running Unit Tests"
description: "Detailed workflows for writing test cases using TEST and TEST_F macros, running tests, interpreting results, and following best practices for maintainable test code."
---

# Writing and Running Unit Tests

## Workflow Overview

### Task Description
This guide walks you through the practical steps of writing unit test cases using the GoogleTest macros `TEST` and `TEST_F`, running those tests, interpreting their output, and adopting best practices for creating maintainable and understandable test code.

### Prerequisites
- GoogleTest and GoogleMock are installed and properly configured in your development environment.
- You have a basic understanding of C++ and how to compile C++ programs.
- Your project is set up to include GoogleTest headers and link against the GoogleTest libraries.

### Expected Outcome
By completing this guide, you will be able to:
- Write and organize unit tests with the `TEST` and `TEST_F` macros.
- Compile and execute your tests successfully.
- Interpret GoogleTest test result outputs to validate your code correctness.
- Follow best practices to write clear and maintainable test code.

### Time Estimate
Approximately 30 minutes to 1 hour, depending on familiarity with C++ and testing concepts.

### Difficulty Level
Beginner to Intermediate

---

## Step-by-Step Instructions

### 1. Understand Test Macros: `TEST` vs. `TEST_F`
- Use `TEST(TestSuiteName, TestName)` for simple tests that do not require shared setup or state between tests.
- Use `TEST_F(TestFixtureClass, TestName)` when your tests require:
  - Reusable state or objects in a fixture class.
  - Setup and teardown logic applied before and after each test.

### 2. Define Your Test Cases
- For simple tests:

```cpp
#include <gtest/gtest.h>

TEST(MathTest, AddPositiveNumbers) {
  EXPECT_EQ(4, 2 + 2);
}
```

- For tests requiring setup:

```cpp
class MyTestFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    // Code here will be called immediately before each test
    value = 5;
  }
  int value;
};

TEST_F(MyTestFixture, ValueIsInitialized) {
  EXPECT_EQ(5, value);
}
```

### 3. Write Assertions
- Use GoogleTest assertions such as `EXPECT_EQ`, `ASSERT_TRUE`, `EXPECT_NE`, etc. to check test conditions.
- Understand the difference:
  - `EXPECT_*` assertions let the test continue after failure.
  - `ASSERT_*` assertions stop the current test immediately if they fail.

### 4. Compile Your Tests
- Ensure your test source files include GoogleTest headers and link the test executable with GoogleTest and pthread libraries.
- For example, with `g++`:

```bash
g++ your_test.cc -lgtest -lgtest_main -pthread -o your_test
```

- If using CMake or Bazel, configure your build accordingly.

### 5. Run Your Tests
- Execute your compiled test binary:

```bash
./your_test
```

- Tests will run and produce output indicating passes, failures, or skipped tests.

### 6. Interpret Test Output
- Successful tests will show `[  PASSED  ]` with counts.
- Failures will print descriptive error messages with file names and line numbers.
- Use these messages to locate and fix bugs.

### 7. Organize Tests for Maintainability
- Use descriptive test suite and test names reflecting the behavior tested.
- Group related tests in test suites or fixtures.
- Use `SetUp` and `TearDown` for common initialization and cleanup.

---

## Best Practices for Writing Tests

- **Focus on Single Behavior**: Each test should verify one specific aspect of your code.
- **Prefer `EXPECT_*` for validations where possible** to allow multiple assertions per test.
- **Use `ASSERT_*` when continuation does not make sense after failure.**
- **Keep fixtures lightweight:** avoid complex setup if not necessary.
- **Write readable tests:** use clear names and comments where needed.
- **Avoid test dependencies:** each test must be independent and runnable in any order.

---

## Examples

### Simple Test Case
```cpp
#include <gtest/gtest.h>

TEST(StringTest, LengthCheck) {
  std::string str = "hello";
  EXPECT_EQ(str.length(), 5);
}
```

### Test Fixture Example
```cpp
class CalculatorTest : public ::testing::Test {
 protected:
  void SetUp() override {
    calc = new Calculator();
  }

  void TearDown() override {
    delete calc;
  }

  Calculator* calc;
};

TEST_F(CalculatorTest, Addition) {
  EXPECT_EQ(calc->Add(1, 2), 3);
}

TEST_F(CalculatorTest, Subtraction) {
  EXPECT_EQ(calc->Subtract(5, 3), 2);
}
```

### Running and Output Example
```
[ RUN      ] StringTest.LengthCheck
[       OK ] StringTest.LengthCheck (0 ms)
[ RUN      ] CalculatorTest.Addition
[       OK ] CalculatorTest.Addition (0 ms)
[ RUN      ] CalculatorTest.Subtraction
[       OK ] CalculatorTest.Subtraction (0 ms)
[  PASSED  ] 3 tests.
```

---

## Troubleshooting & Tips

- **Common Issue: Tests Not Running or Linker Errors**
  - Verify GoogleTest is correctly linked.
  - Ensure that your test executable references `gtest_main` or includes a proper `main()`.
- **Tests Compile but Always Show Failures**
  - Review assertion messages to pinpoint failures.
  - Use verbose test output by running tests with `--gtest_verbose=info`.
- **Tests Run Too Slowly**
  - Isolate tests; avoid heavy fixtures or external dependencies.
- **Test Fails Without Clear Error**
  - Run tests with `--gmock_verbose=info` to get detailed mock call traces.

---

## Next Steps & Related Content

- After mastering writing and running unit tests, explore:
  - [Using Mocks for Dependency Isolation](../core-workflows/using-mocks.md) to create mocks for testing interactions.
  - [Assertions and Matchers in Practice](../core-workflows/assertions-matchers.md) to harness the full power of GoogleTest assertions.
  - [Integrating with Build Systems](../integration-solutions/build-integration.md) for streamlined development.


## Additional Resources

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [gMock for Dummies](../gmock_for_dummies.md) for mocking basics
- [GoogleMock Cheat Sheet](../gmock_cheat_sheet.md)
- [Running and Validating Your Tests](../../getting-started/first-test-workflow/running-tests.md) guide

---