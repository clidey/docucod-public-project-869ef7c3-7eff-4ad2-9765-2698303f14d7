---
title: "Mastering Common and Custom Assertions"
description: "Dive into the variety of built-in assertions supported by GoogleTest, and learn the best practices for writing your own custom assertions to fit specific testing needs."
---

# Mastering Common and Custom Assertions

GoogleTest provides a comprehensive set of built-in assertions to verify the behavior of your code during testing. Moreover, it empowers you to write custom assertions tailored to complex or domain-specific needs. This guide helps you dive into the most frequently used assertions and guides you to create your own custom assertions with clarity and best practices.

---

## 1. Understanding GoogleTest Assertions

### Task Description
This guide helps you leverage GoogleTest's wide variety of assertions to write robust and expressive tests. You will learn how to use built-in assertions effectively and how to write custom assertions for more descriptive and maintainable test code.

### Prerequisites
- You should have GoogleTest integrated into your C++ project.
- Basic understanding of writing GoogleTest tests.
- Familiarity with C++ assertion syntax.

### Expected Outcome
- Mastery of common assertions like `EXPECT_EQ`, `EXPECT_TRUE`, `EXPECT_THAT`, etc.
- Ability to create custom assertions using predicate assertions and detailed failure messages.
- Understanding of advanced assertion techniques such as predicate-format assertions and floating-point comparisons.

### Time Estimate
Approximately 30-45 minutes to read, practice, and integrate assertions.

### Difficulty Level
Beginner to Intermediate

---

## 2. Built-in Assertions at a Glance

GoogleTest splits assertions into several kinds depending on how they handle failures and their purpose.

### Boolean Condition Assertions
- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`

### Equality and Comparison Assertions
- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)` — asserts equality with `==`
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)` — asserts inequality
- `EXPECT_LT`, `EXPECT_LE`, `EXPECT_GT`, `EXPECT_GE` — relational comparisons

### String-Specific Assertions
- `EXPECT_STREQ(str1, str2)` — compares C strings by content
- `EXPECT_STRNE(str1, str2)` — asserts C strings are different
- Case-insensitive variants available

### Floating-Point Assertions
- `EXPECT_FLOAT_EQ(val1, val2)`
- `EXPECT_DOUBLE_EQ(val1, val2)`
- `EXPECT_NEAR(val1, val2, abs_error)`

### Rich Assertions with Matchers
- `EXPECT_THAT(value, matcher)` — allows matching with expressive matchers such as `StartsWith`, `HasSubstr`, `ElementsAre`, etc.

### Explicit Success or Failure
- `SUCCEED()` — reports test success (used mostly for documentation)
- `FAIL()` — immediately fails a test with a fatal error

---

## 3. Using Assertions Effectively

### Writing Clear Assertions
To ensure your tests are maintainable and failures are easy to diagnose, write assertions that precisely express the intended behavior. For example, prefer:

```cpp
EXPECT_EQ(result, expected_value) << "The operation result did not match expected value.";
```

This provides a helpful custom failure message.

### Avoid Over-Specification
Don’t impose stricter conditions than necessary. For instance, use matchers like `_` (wildcard) when the exact argument isn’t important.

### Progressive Disclosure of Assertions
For complex conditions, start with simple assertions and then add more specific ones.

---

## 4. Writing Custom Assertions

GoogleTest makes it easy to write custom assertions that help explain why a test failed with detailed messages.

### Predicate Assertions
Create a function or functor returning a `bool` to express a simple predicate for use with `EXPECT_TRUE()`.

Example:

```cpp
bool IsEven(int n) {
  return (n % 2) == 0;
}
EXPECT_TRUE(IsEven(x)) << x << " is not even.";
```

### AssertionResult-Based Assertions
For enhanced failure messages, write predicates returning `testing::AssertionResult`:

```cpp
#include <gtest/gtest.h>

using ::testing::AssertionResult;

AssertionResult IsEven(int n) {
  if (n % 2 == 0)
    return AssertionSuccess();
  else
    return AssertionFailure() << n << " is odd";
}

EXPECT_TRUE(IsEven(x));
```

If this assertion fails, the error output will clearly show the problem.

### Using Predicate-Format Assertions
To customize messages and include expression strings, use `EXPECT_PRED_FORMAT*` macros.

Signature of predicate-format:

```cpp
testing::AssertionResult MyPredicateFormatter(const char* expr1, const char* expr2, T1 val1, T2 val2);
```

Example:

```cpp
AssertionResult AssertGreaterThan(const char* expr1, const char* expr2, int val1, int val2) {
  if (val1 > val2) return AssertionSuccess();
  return AssertionFailure() << expr1 << " (" << val1 << ") is not greater than " << expr2 << " (" << val2 << ")";
}
EXPECT_PRED_FORMAT2(AssertGreaterThan, x, y);
```

---

## 5. Using Matchers with Assertions

Matchers offer expressive power to write precise tests.

### Common Matchers
- `_` matches anything
- `Eq(val)` matches exactly val
- `Ne(val)`, `Ge(val)`, `Gt(val)`, `Le(val)`, `Lt(val)` for comparisons
- `Contains()`, `StartsWith()`, and `EndsWith()` for strings

### Containers
Matchers like `ElementsAre()`, `UnorderedElementsAre()` let you match contents of STL containers.

Example:

```cpp
using ::testing::ElementsAre;
EXPECT_THAT(vec, ElementsAre(1, 2, 3));
```

---

## 6. Best Practices for Assertions

- Use `EXPECT_` variants for non-fatal checks; use `ASSERT_` when further test steps depend on success.
- Keep failure messages descriptive and actionable.
- Avoid side effects in assertion parameters.
- Prefer `EXPECT_THAT` with matchers for flexible and readable assertions.
- Use `SCOPED_TRACE()` to add context to nested assertions.

---

## 7. Troubleshooting Assertion Failures

### Common Issues
- **Silently passing tests**: Check if assertions are in test functions properly.
- **Failing assertions with vague output**: Use `AssertionResult` or predicate-format for better messages.
- **Floating-point comparison failures**: Use `EXPECT_NEAR` or `EXPECT_FLOAT_EQ` instead of `EXPECT_EQ`.

### Tips
- Enable verbose logging (`--gtest_verbose=info`) to get more details.
- Use `SCOPED_TRACE()` to pinpoint where failure happens if it’s inside loops or helper functions.

---

## 8. Next Steps & Related Content

- Explore the [Assertions API Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md) for a comprehensive list.
- Try writing some [custom matchers](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#writing-new-matchers-quickly) to complement assertions.
- Use [EXPECT_THAT with matchers](https://github.com/google/googletest/blob/main/docs/reference/assertions.md#EXPECT_THAT) to write expressive conditions.
- Combine assertions with mock expectations from [GoogleMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md).

---

## References
- [GoogleTest Assertions Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md)
- [GoogleMock Cookbook - Custom Matchers](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#writing-new-matchers-quickly)
- [Guide to Using Matchers](https://github.com/google/googletest/blob/main/docs/reference/matchers.md)
- [Best Practices in Writing Tests](https://github.com/google/googletest/blob/main/guides/core-workflows/writing-tests.md)

---