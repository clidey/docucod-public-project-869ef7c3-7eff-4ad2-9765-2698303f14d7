---
title: "GoogleTest with Continuous Integration"
description: "Step-by-step instructions for integrating GoogleTest into your CI/CD pipelines across Linux, macOS, and Windows. Covers automated test execution, reporting, and troubleshooting common setup issues."
---

# GoogleTest with Continuous Integration

Integrating GoogleTest into your Continuous Integration (CI) pipelines ensures automated, reliable, and repeatable validation of your C++ code. This guide walks you through practical, step-by-step instructions to embed GoogleTest test suites into CI workflows for Linux, macOS, and Windows environments. It covers automated test execution, generating reports, debugging failures, and common setup troubleshooting to keep your pipelines robust and maintainable.

---

## 1. Understanding GoogleTest in CI Context

**What this guide covers:**
- How to set up GoogleTest test executables for automated CI runs
- Command-line options to control test execution
- Generating machine-readable test reports for CI dashboards
- Diagnosing and resolving common issues encountered during CI integration

**Prerequisites:**
- A working build environment with GoogleTest compiled (see the [Installation via CMake](https://google.github.io/googletest/getting-started/setup-and-installation/installation-via-cmake) guide)
- Familiarity with basic CMake or build system setup
- Access to your CI provider (e.g., GitHub Actions, Jenkins, Travis CI)

**Expected Outcome:**
- GoogleTest binaries run automatically on CI
- Test outputs are captured and interpreted by your CI server
- Failures cause CI job failures with actionable logs

**Time Estimate:** ~45 minutes

**Difficulty Level:** Intermediate

---

## 2. Preparing Your Test Binaries for CI

### Step 1: Build Your Test Executable

Start by building your test executable linked against GoogleTest's `gtest_main` or `gmock_main` libraries.

For example, using CMake:

```cmake
add_executable(my_tests test_suite.cpp)
target_link_libraries(my_tests GTest::gtest_main)
```

or for GoogleMock integration:

```cmake
add_executable(my_mock_tests mock_test_suite.cpp)
target_link_libraries(my_mock_tests GMock::gmock_main)
```

This automatically provides a `main()` function that initializes GoogleTest and runs all registered tests.

### Step 2: Enable Test Discovery (Optional but Recommended)

Enable CMake's test discovery to integrate with `ctest`:

```cmake
enable_testing()

add_test(NAME my_tests COMMAND my_tests)
include(GoogleTest)
gtest_discover_tests(my_tests)
```

This allows CI pipelines to invoke tests via `ctest` for better reporting integration.

### Step 3: Run Tests Locally

Before CI integration, verify that your test executable runs and reports as expected:

```bash
./my_tests
```

Expected output will list tests running and their status, ending with a summary.

---

## 3. Running GoogleTest in CI Pipelines

### Common Invocation Patterns

Run your test executable directly:

```bash
./my_tests
```

Or use CTest, which understands GoogleTest:

```bash
ctest --output-on-failure
```

### Use Flags to Control Output for CI

GoogleTest supports several command-line flags to make output parsing CI-friendly:

- `--gtest_output=xml:<path>`  
  Generates an XML report (compatible with many CI systems) at the given path.

- `--gtest_filter=PositiveTests*`  
  To run a subset of tests.

- `--gtest_shuffle`  
  Runs tests in random order (good for detecting order dependencies).

- `--gtest_repeat=N`  
  Runs all tests N times to check for flakiness.

#### Example for CI:

```bash
./my_tests --gtest_output=xml:test_results.xml
```

Most CI services can consume these XML reports and display rich test summaries.

---

## 4. Integrating with Popular CI Systems

### GitHub Actions Example

```yaml
name: C++ GoogleTest

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Install dependencies
      run: sudo apt-get install -y cmake g++
    - name: Configure
      run: cmake -S . -B build
    - name: Build
      run: cmake --build build
    - name: Run tests
      run: |
        cd build
        ctest --output-on-failure
        # or directly
        # ./my_tests --gtest_output=xml:test_results.xml
    - name: Upload test results
      uses: actions/upload-artifact@v3
      with:
        name: test-results
        path: build/test_results.xml
```

### Jenkins Example

- Configure a build step to run `cmake` and `make` to build tests.
- Add a post-build action to "Publish JUnit test result report" and specify the GoogleTest XML report `**/test_results.xml`.

### Tips for Other CI Systems

Most CI providers like Travis CI, CircleCI, and Azure Pipelines support JUnit XML reports generated by GoogleTest. Export results as XML using `--gtest_output=xml:filename` and publish accordingly.

---

## 5. Troubleshooting Common CI Issues

### Problem: Tests are running but CI does not detect failures

- Ensure your `main()` function returns the result of `RUN_ALL_TESTS()`.
- Use `ctest` or confirm your CI parses GoogleTest XML outputs.
- Avoid suppressing test failures via flag misuse.

### Problem: Tests are flaky or order-dependent

- Use `--gtest_shuffle` in your CI runs.
- Investigate shared state or static/global variables among tests.

### Problem: XML report not generated or malformed

- Confirm `--gtest_output=xml:<file>` flag usage is correct.
- Check file path permissions in the CI environment.

### Problem: Build fails on CI but builds locally

- Verify CI environment matches local toolchain versions.
- Check C++ standard compliance (C++17 required minimum).
- Make sure GoogleTest and GoogleMock libraries are correctly installed and linked.

---

## 6. Best Practices for Smooth CI Integration

- **Use `gtest_main` or `gmock_main` Libraries:** These provide a ready-to-use `main()` that handles initialization.
- **Return `RUN_ALL_TESTS()` Result:** Always ensure your `main()` returns this value to signal test success/failure.
- **Leverage XML Output:** Produce XML test reports and use your CI's native support for detailed results.
- **Run Tests via CTest When Possible:** Improves integration, parallel runs, and output control.
- **Automate Test Discovery:** Use `gtest_discover_tests()` in CMake to automate test registration.
- **Address Flaky Tests:** Run with shuffling and repetitions in CI to detect flakiness early.

---

## 7. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) - Learn basic test writing
- [Installing and Configuring GoogleTest](https://google.github.io/googletest/guides/getting-started/installing-and-configuring) - Setup and integration
- [Troubleshooting Common Setup Issues](https://google.github.io/googletest/getting-started/troubleshooting-and-resources/common-setup-issues) - Fix common build and configuration problems
- [CMake Integration Quickstart](https://google.github.io/googletest/quickstart-cmake.html) - Build integration best practices
- [GoogleTest with Bazel](https://google.github.io/googletest/getting-started/setup-and-installation/installation-via-bazel) - Alternative build system

---

## Appendix: Example `main()` Using GoogleMock

If using GoogleMock, your binary can link with `gmock_main` which provides this `main()`:

```cpp
#include "gmock/gmock.h"
#include "gtest/gtest.h"

int main(int argc, char **argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes both GoogleMock and GoogleTest
  return RUN_ALL_TESTS();
}
```

This is automatically provided if you link against `gmock_main`.

---

# Troubleshooting Checklist

<AccordionGroup title="Common CI Troubleshooting">
<Accordion title="Test Executable Does Not Run in CI">
- Verify build steps complete successfully.
- Check executable permissions in CI environment.
- Confirm the executable path is correct.
- Ensure dependencies and environment variables are properly set.
</Accordion>
<Accordion title="Test Failures Not Detected by CI">
- Make sure the return value of `RUN_ALL_TESTS()` is propagated from `main()`.
- Use `ctest` if your CI supports it.
- Enable GoogleTest XML output and configure CI to consume it.
</Accordion>
<Accordion title="Test Output Too Verbose or Hard to Parse">
- Use `--gtest_brief=1` for succinct outputs.
- Limit output to failed cases with `--gtest_also_run_disabled_tests` if appropriate.
- Generate XML and use CI native visualization.
</Accordion>
</AccordionGroup>

---

# Summary

- GoogleTest integrates smoothly with modern CI systems supporting C++.
- Use `gtest_main` or `gmock_main` libraries to get a standard `main()`.
- Generate XML reports with `--gtest_output` for CI dashboard ingestion.
- Troubleshoot typical CI issues by verifying executables and output parsing.
- Leverage CMake and CTest for standardized build and test discovery.

---

Start automating your C++ test suites now to catch bugs early and keep your releases reliable with GoogleTest in your CI pipeline.


<Check>
Ensure you have installed GoogleTest and configured your build system before enabling CI integration. For installation details, see the 'Installation via CMake' and 'Building from Source' guides.
</Check>

<Info>
For advanced scenarios, consider exploring parallel test execution and integration with test flakiness detection tools to enhance your CI workflows.
</Info>
