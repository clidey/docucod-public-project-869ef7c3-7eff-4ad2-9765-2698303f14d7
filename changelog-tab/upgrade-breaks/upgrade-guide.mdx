---
title: "Upgrade Guide"
description: "Step-by-step strategies for transitioning from earlier versions to the latest release, with best practices for migrating test code, adapting build scripts, and leveraging new features with minimal disruption."
---

# Upgrade Guide

This Upgrade Guide assists developers in smoothly transitioning their test suites and build configurations from earlier GoogleTest versions to the latest release. It provides clear, practical strategies to update test code, adapt build scripts, and adopt new framework features without disruption.

---

## 1. Preparing for Upgrade

Before starting your upgrade journey, it is crucial to ensure your environment meets the necessary prerequisites for the latest GoogleTest version:

- Confirm your compiler supports **at least C++17**, as this is now a minimum requirement.
- Update your build system configuration to reflect any new include paths or dependencies.

<Tip>
Keep your system branches or release tags clearly labeled so you can revert if unexpected issues arise during migration.
</Tip>

## 2. Migrating Test Code

### Revising Test Macros

GoogleTest may deprecate or replace older macros. Review your code for:

- Transitioning from the legacy `TEST_CASE` API to the newer `TEST_SUITE` terminology where applicable.
- Ensuring that test suite and test names avoid underscores (`_`) as they can be problematic or restricted.

### Updating Test Fixtures

When upgrading, verify fixture classes for:

- Proper overriding of `SetUp()` and `TearDown()`. Remember, spelling mistakes like `Setup()` are common pitfalls that prevent hooks from executing.
- Use of `SetUpTestSuite()` and `TearDownTestSuite()` instead of deprecated `SetUpTestCase()` and `TearDownTestCase()`.

### Handling Parameterized and Typed Tests

- Confirm that all `TEST_P` tests have corresponding `INSTANTIATE_TEST_SUITE_P` instantiations; otherwise, use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST()` to suppress failure.
- For typed tests, ensure use of `TYPED_TEST_SUITE` instead of the deprecated `TYPED_TEST_CASE` macro.

<Tip>
Parameterized tests add significant flexibility and coverage with minimal code duplication. Leverage the new recommended macros for better future compatibility.
</Tip>

## 3. Updating Build Scripts

### CMake Integration

- If you use CMake, ensure you reference the updated minimum required version (`>= 3.14`) because of usage of `FetchContent_MakeAvailable()`.
- Adjust your CMakeLists.txt to link against the correct GoogleTest targets such as `GTest::gtest` or `gtest_main`.
- For Windows users, use the `gtest_force_shared_crt` option when linking dynamically to avoid runtime library mismatches.

Example snippet:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

### Other Build Systems

- If you use build systems other than CMake (e.g., Bazel), ensure updated rules reference the latest GoogleTest artifacts.
- Confirm build definitions consider the C++17 flag settings.

## 4. Leveraging New Features

Upgrade opportunities are also growth opportunities. The latest release introduces enhancements you can benefit from:

- Utilize improved assertion macros with richer reporting.
- Access the enhanced matcher library with broader capabilities for complex validation.
- Take advantage of enhanced event listener interfaces for detailed test execution tracking.

Ensure your tests take full benefit of these improvements by reviewing the [Assertions Reference](../api-reference/testing-framework/assertions-reference.md) and the [Matchers Library and Customization](../api-reference/actions-matchers-extensions/matchers-library-and-customization.md).

## 5. Common Pitfalls and How to Avoid Them

<Tip>
Carefully check for leftover deprecated APIs such as `SetUpTestCase()` and `TearDownTestCase()` in your fixture classes. These should be replaced by their `TestSuite` counterparts.
</Tip>

<Tip>
Avoid mixing `TEST` and `TEST_F` macros within the same test suite name as it can cause obscure compiler or runtime errors.
</Tip>

<Tip>
Make sure that parameterized tests are always instantiated appropriately; uninstantiated parameterized tests now cause explicit failures unless opt-out macros are used.
</Tip>

## 6. Step-by-Step Upgrade Flow

<Steps>
  <Step title="Backup Your Project">
    Before making changes, ensure you have a current backup or can revert to a previous commit. This protects your work from unintended disruptions.
  </Step>
  <Step title="Update Compiler and Build Environment">
    Verify that your compiler supports C++17. Update your build scripts to include any new flags or library paths required by the latest GoogleTest.
  </Step>
  <Step title="Replace Deprecated Macros and APIs">
    Search for deprecated macros (like `TEST_CASE`) and APIs, refactor to current alternatives.
  </Step>
  <Step title="Adapt Parameterized and Typed Tests">
    Ensure all `TEST_P` tests are instantiated properly and switch to `TYPED_TEST_SUITE` macros where needed.
  </Step>
  <Step title="Rebuild and Run Tests">
    Rebuild your test suite and run all tests to verify correctness. Use `RUN_ALL_TESTS()` return value to detect issues.
  </Step>
  <Step title="Leverage New Features">
    Gradually refactor legacy code to utilize new features, improved assertions, or better event listeners for richer test diagnostics.
  </Step>
</Steps>

## 7. Troubleshooting

If you encounter failures or unexpected behavior during or after upgrade:

- Confirm that your build environment uses the correct headers and links against the updated GoogleTest libraries.
- Use GoogleTestâ€™s `--gtest_list_tests` flag to ensure tests are discovered correctly.
- Check `--gtest_filter` to selectively run problematic tests.
- Review your test fixture constructors and destructors for unintended failures or resource leaks.
- Consult the updated [Troubleshooting Common Issues](../getting-started/troubleshooting/common-issues.md) guide.

## 8. Additional Resources and Next Steps

- Review the [GoogleTest Primer](../docs/primer.md) for foundational concepts and best practices.
- Explore the [Testing Reference](../docs/reference/testing.md) for macros, classes, and function details.
- Visit the [Breaking Changes & Deprecations](../changelog-tab/upgrade-breaks/breaking-changes.md) page for an exhaustive list of backward-incompatible changes.
- For improved test organization, see the [Test Structure](../guides/getting-started/test-structure.md) guide.
- Follow build integration examples in [Build Integration](../guides/integration-and-best-practices/build-integration.md).

<Tip>
Keep your upgrade smooth by integrating continuous testing and incremental refactoring, avoiding large-scale upheavals at once.
</Tip>

---

## Source References

- GoogleTest main include and API: [gtest.h](https://github.com/google/googletest/blob/main/googletest/include/gtest/gtest.h)
- Build integration details: [googletest/README.md](https://github.com/google/googletest/blob/main/googletest/README.md)
- Testing framework reference: [Testing Reference](../docs/reference/testing.md)
- Parameterized and Typed Tests: [Parameterized and Typed Tests](../api-reference/testing-framework/parameterized-and-typed-tests.md)

---

For any issues, please check [Troubleshooting Common Issues](../getting-started/troubleshooting/common-issues.md) and consider participating in community forums as detailed in [Where to Find Help](../getting-started/troubleshooting/community-help.md).
