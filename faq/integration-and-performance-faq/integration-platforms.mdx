---
title: "Platform and Build Integration Issues"
description: "Guides users through resolving platform-specific issues, unsupported compilers, or special environment configurations (including popular build systems like CMake and Bazel). Discusses known limitations and solutions for smoother integration."
---

# Platform and Build Integration Issues FAQ

This FAQ helps you navigate and resolve platform-specific challenges, compiler incompatibilities, and special environment configurations encountered when integrating GoogleTest and GoogleMock into your projects. It covers common problems and solutions related to popular build systems like CMake and Bazel, highlighting known limitations and recommended practices for smoother integration and build stability.

---

## Frequently Asked Questions

### General Build and Integration

**Q: What platforms does GoogleTest officially support?**  
A: GoogleTest supports a broad range of platforms aligned with Google's Foundational C++ Support Policy. For precise platform listings, supported compilers, and build tools, see the [Supported Platforms table](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md). Unsupported platforms like Fuchsia are possible but not officially supported and may require additional tweaks.

**Q: How can I build GoogleTest with CMake?**  
A: GoogleTest provides a `CMakeLists.txt` enabling both standalone builds and integration into existing CMake projects. Typically, you clone the repository, create a build directory, run `cmake ..` (add `-DBUILD_GMOCK=OFF` to skip GoogleMock), then build with `make` or your platform's equivalent. For integrating into a project with CMake, you can use `find_package(GTest CONFIG REQUIRED)` or incorporate GoogleTest as a git submodule and add it with `add_subdirectory()`. Refer to the [googletest README section on CMake](https://github.com/google/googletest/blob/main/googletest/README.md) for detailed workflows.

**Q: What should I know when building with Bazel?**  
A: The `BUILD.bazel` file configures GoogleTest and GoogleMock builds with Bazel, including platform-specific settings for OS types (Windows, QNX, FreeBSD, OpenBSD, etc.) and compiler selections like MSVC. Bazel dependencies and link options are set to match your target environment. For example, `-pthread` is added by default except on Windows. If your environment has special threading or linking needs, configure Bazel accordingly.


### Platform-Specific Issues

**Q: Why does building GoogleTest fail on unsupported platforms like Fuchsia?**  
A: GoogleTest provides some workaround dependencies when targeting platforms like Fuchsia (e.g., linking Fuchsia SDK packages for fdio, syslog, zx). However, full support is not guaranteed. You can inspect the Bazel `config_setting` with name `fuchsia` in `BUILD.bazel` and adjust dependencies if you encounter build failures.

**Q: How do I address compiler version and incompatibility issues?**  
A: GoogleTest requires at least C++17 support. For MSVC, Visual C++ 2015 or newer is needed. Older compilers or those lacking features such as RTTI, exceptions, or threading will cause issues. It's critical to verify your compiler version and enable appropriate flags. Setting the C++ standard to 17 (e.g., via `set(CMAKE_CXX_STANDARD 17)` in CMake) ensures compatibility.

**Q: How do I handle linking errors related to runtime library mismatches on Windows?**  
A: On Windows using MSVC, GoogleTest links C runtimes statically by default, conflicting with projects that dynamically link runtimes. Set the CMake option `gtest_force_shared_crt` to `ON` before configuring builds to force dynamic linking, matching project defaults. This prevents the `LNK2038` error about runtime library mismatch.

**Q: Are there any special compiler flags I should be aware of?**  
A: Yes. Compiler and linker flags are adjusted per environment to balance warnings, threading, and exceptions. For example, Bazel and CMake configs set flags for warnings, exception support, and pthread usage. You can override these flags to suit your builds but typically should follow the default or documented settings for your platform.


### Build System Integration

**Q: How do I include GoogleTest in an existing CMake project?**  
A: You have multiple integration methods:
- Build and install GoogleTest separately and use `find_package(GTest)` to import.
- Add GoogleTest's source as a git submodule and call `add_subdirectory(googletest)`.
- Use CMake's `FetchContent` to download and add GoogleTest during your project's configuration step.

Embedding GoogleTest as source and building it in your project is preferred for consistent compiler/linker flags and eliminates library incompatibilities.

**Q: How does GoogleTest handle multithreaded test scenarios during builds?**  
A: GoogleTest is thread-safe where pthread or Windows threading primitives are supported. The macro `GTEST_HAS_PTHREAD` (set automatically or manually) controls pthread use. When building manually, ensure that relevant threads libraries (`-pthread` or Windows threading libs) are linked. CMake scripts handle this for you; for manual build scripts, add flags accordingly.

**Q: Can I build GoogleTest and GoogleMock as shared libraries?**  
A: Yes. Define the macro `GTEST_CREATE_SHARED_LIBRARY=1` during compilation of GoogleTest to create a shared library. When building your tests to link against the shared library, define `GTEST_LINKED_AS_SHARED_LIBRARY=1`. This is recommended especially on platforms like Windows for better modularization, but static linking remains simpler for most users.


### Known Limitations and Tweaks

**Q: How do I prevent macro name clashes when including GoogleTest?**  
A: GoogleTest defines many common macros (e.g., `TEST`, `EXPECT_EQ`) without namespaces, which may clash with other libraries. You can disable specific macro definitions by defining `-DGTEST_DONT_DEFINE_<MACRO>=1` (e.g., `-DGTEST_DONT_DEFINE_TEST=1`) to have GoogleTest rename them with a `GTEST_` prefix (e.g., `GTEST_TEST`). This avoids collisions but requires adapting test code accordingly.

**Q: What should I do if GoogleTest's default configuration does not fit my environment?**  
A: GoogleTest offers control macros prefixed with `GTEST_` to tweak its behavior. For example, force enabling pthread support with `-DGTEST_HAS_PTHREAD=1` or disable it with `0`. Adjusting these macros allows adaptation to unusual or embedded environments.

**Q: How can I verify that my platform and build integration is working correctly?**  
A: Start with writing and building simple test cases using the GoogleTest samples. Use the Validation Checklist and refer to the `troubleshooting-common-issues` guide for resolving typical compiler, linker, or platform miscues. If using Bazel or CMake, ensure you follow their provided build and linking conventions strictly.


## Common Issues & Gotchas

- **Unsupported Compiler:** Building on older compilers without C++17 support will fail. Upgrade your compiler first.
- **Linker Errors on Windows:** Mismatched run-time library settings require aligning project and GoogleTest build flags.
- **Missing pthread Link Flags:** On POSIX, missing `-pthread` during linking causes unresolved symbols. Add pthread flags manually if not using CMake.
- **Build Failures on Less Common OSes:** Platforms like Fuchsia or QNX may require custom Bazel config tweaks or additional dependencies.


## Troubleshooting Tips

<AccordionGroup title="Troubleshooting Platform and Build Issues">
<Accordion title="Build fails with missing pthread symbols on Linux or macOS">
Check that your compiler and linker flags include `-pthread`. If you build manually, add `-pthread` to both compile and link commands. Using CMake's GoogleTest support typically handles this automatically.
</Accordion>

<Accordion title="MSVC linker error due to CRT mismatch">
Set CMake option `gtest_force_shared_crt` to `ON` before configuring the build when your project uses dynamic CRT linkage. This aligns GoogleTest's runtime linkage with your project.
</Accordion>

<Accordion title="Compiler errors related to RTTI or exceptions being disabled">
GoogleTest requires exception handling and RTTI in most environments. Enable compiler flags to support these features or define `GTEST_HAS_EXCEPTIONS` and `GTEST_HAS_RTTI` appropriately if your toolchain disables them by default.
</Accordion>

<Accordion title="Clash of GoogleTest macros with another library">
Use compiler defines like `-DGTEST_DONT_DEFINE_TEST=1` to rename GoogleTest macros and avoid collision, updating your tests to use the renamed macros (e.g., `GTEST_TEST`).
</Accordion>
</AccordionGroup>


## Best Practices for Smooth Integration

- Prefer embedding GoogleTest source in your project via git submodules or `FetchContent` rather than prebuilt binaries for consistent build configurations.
- Always enforce C++17 or later standard to ensure compatibility.
- Ensure build flags for threading, exceptions, and dynamic/static runtime linkage are consistent between your tests and the GoogleTest library.
- Use CMake or Bazel provided build files as a reference to handle platform-specific flags and link settings.
- Regularly consult the [Platform-Specific Setup guide](/getting-started/prerequisites-installation/platform-specific-instructions) for environment-specific instructions.

---

## Related Topics

- [Platform-Specific Setup](/getting-started/prerequisites-installation/platform-specific-instructions)  
- [Installation Overview](/getting-started/prerequisites-installation/installation-overview)  
- [Configuring Your First Test Project](/getting-started/first-steps-usage-validation/configuration-basics)  
- [Troubleshooting Common Setup Issues](/getting-started/first-steps-usage-validation/troubleshooting-common-issues)  
- [Supported Platforms](docs/platforms.md)  
- [CMake Integration and Build Instructions](googletest/README.md)  
- [Bazel Build Configuration](BUILD.bazel)  

---

## Additional Resources

- GoogleTest GitHub Repository: <https://github.com/google/googletest>  
- CMake Official Website: <https://cmake.org>  
- Google's Foundational C++ Support Policy: <https://opensource.google/documentation/policies/cplusplus-support>

---

This FAQ empowers you to overcome the most common hurdles in integrating GoogleTest with your platform and build ecosystem, ensuring your unit testing workflow remains reliable and efficient across environments.