---
title: "Getting Started and Setup Issues"
description: "Troubleshoot common setup concerns, such as compiler errors, linking problems, version incompatibilities, and build configuration for both GoogleTest and GoogleMock. This page assists new users in moving past initial barriers to run their first tests."
---

# Getting Started and Setup Issues

This page addresses the most common setup hurdles users face when beginning with GoogleTest and GoogleMock. Whether you encounter compiler errors, linking problems, or configuration mismatches for your build environment, this page guides you past initial barriers so you can write and run your first tests successfully.

---

## 1. Common Setup Problems and How to Resolve Them

### Compiler Errors

GoogleTest and GoogleMock require support for modern C++20 features and careful compiler configuration. Here is how to avoid common issues:

- **Check Compiler Version**: Ensure your compiler meets minimal required versions supporting C++17 or later (see [System Requirements](../../getting-started/prerequisites-installation/system-requirements.md)).

- **Unsupported Compiler**: If your compiler is unsupported, upgrade to a compatible GCC, Clang, or MSVC version.

- **Incorrect Macro Usage or Syntax Errors**: When defining mocks, verify that you use the `MOCK_METHOD` macro correctly with the right signature and specifiers. For overloaded methods or methods with commas in types, wrap return or argument types in parentheses or use type aliases.

  ```cpp
  MOCK_METHOD((std::pair<bool, int>), GetPair, ());
  MOCK_METHOD(bool, CheckMap, ((std::map<int, double>), bool));
  ```

- **Virtual Destructors Are Required**: When mocking a class, its destructor **must** be virtual to avoid memory leaks and heap check failures.


### Linking Problems

Incorrect linkage configuration causes missing symbols and unresolved externals:

- **Link GoogleTest and GoogleMock Libraries**: When building your test executable, link with `gtest`, `gmock`, and optionally `gtest_main` to avoid writing your own `main()`.

- **Initialization of GoogleTest**: Call `testing::InitGoogleTest(&argc, argv);` in your `main()` before `RUN_ALL_TESTS();` for proper flag handling.

- **One-Time Use of `RUN_ALL_TESTS()`**: Use `RUN_ALL_TESTS()` only once per test executable to avoid runtime conflicts.

- **Ensure Proper Include Paths**: Include `<gtest/gtest.h>` and `<gmock/gmock.h>` correctly relative to your build systemâ€™s include directories.


### Version Incompatibilities and Build Configuration Errors

- **Build System Compatibility**: Use recommended build setups (CMake, Bazel) as per the [Installation Overview](../../getting-started/prerequisites-installation/installation-overview.md).

- **Disabling Exceptions**: GoogleTest/gMock can operate without exceptions, but verify flags like `-fno-exceptions` do not break mock creation or test runs.

- **Consistent C++ Standard**: Ensure the entire project and GoogleTest submodules use the same C++ standard (C++17 or higher).

- **Mock Method Qualifiers Must Match Exactly**: When mocking const or noexcept methods, mirror these qualifiers exactly in your `MOCK_METHOD` declarations, e.g.:  
  ```cpp
  MOCK_METHOD(void, Foo, (), (const, override));
  MOCK_METHOD(int, Bar, (), (noexcept, override));
  ```

---

## 2. Step-by-Step Setup Verification Checklist

Follow this sequence to confirm your environment and test setup work correctly:

<Steps>
<Step title="Compiler Compatibility">
Verify that your compiler version supports C++17 or higher and is officially supported by GoogleTest/GoogleMock.
</Step>
<Step title="Build System Configuration">
Check your build system includes `gtest` and `gmock` correctly and that your test target links with their libraries.
</Step>
<Step title="Basic Test Code">
Write a simple test using `TEST()` or `TEST_F()` macros and a minimal mock class with a single `MOCK_METHOD`.
</Step>
<Step title="Run Basic Test">
Ensure your `main()` calls `testing::InitGoogleTest()` and `RUN_ALL_TESTS()`.
</Step>
<Step title="Check Output and Warnings">
Run your test and observe: on success no errors; on failures, expect clear messages identifying expectation violations.
</Step>
</Steps>

<Tip>
Keep your first test small and simple, focusing on verifying compilation and linkage before increasing complexity.
</Tip>

---

## 3. Common Pitfalls and How to Avoid Them

### Incorrect Use of `EXPECT_CALL` and `ON_CALL`

- Always set expectations **before** the mock method is called.
- Use `ON_CALL` for defining default/mock behavior without expectations.
- Use `EXPECT_CALL` when you want to verify calls happen.

### Forgetting Virtual Destructors

Mocked interfaces and classes **must** have virtual destructors to ensure proper cleanup.

### Mismatched Method Signatures

When declaring mocks, qualifiers such as `const`, `noexcept`, and reference qualifiers must exactly match the base class method signature.

### Overloaded Methods

Use the correct `MOCK_METHOD` signature and disambiguate overloads with explicit parameters or helper utilities as needed.

### Handling Uninteresting Calls

By default, uninteresting calls generate warnings. Suppress these with `NiceMock` or explicit expectations using `.Times(AnyNumber())`.

---

## 4. Troubleshooting Instructions for Common Issues

### Compiler Errors: Unknown Identifier or Macro Failures

- Confirm you included `<gmock/gmock.h>` and `<gtest/gtest.h>` in your test files.
- Check that your compiler supports variadic macros.
- Verify `MOCK_METHOD` syntax, especially parentheses wrapping complex argument types.

### Linker Errors: Undefined References

- Ensure your test executable links with the GoogleTest and GoogleMock static or dynamic libraries.
- Verify object files for mocks are included.
- For Bazel or CMake, confirm dependencies include `gtest_main` or your own test `main()` is implemented.

### Unexpected Runtime Failures or Test Behavior

- Run tests with `--gmock_verbose=info` to trace mock calls and expectations.
- Check that all expectations are properly defined before the mock methods are called.
- Verify mock objects are properly destroyed to trigger verification.

### Heap Checker or Memory Leak Warnings

- Confirm the mocked class has a virtual destructor.
- Check for ownership and lifetime issues with mocks created on the heap.

---

## 5. Quick-Start Example

Here is a minimal test setup to verify your environment is ready:

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

class MockInterface {
 public:
  virtual ~MockInterface() = default;
  virtual int GetValue() const = 0;
};

class MockClass : public MockInterface {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
};

TEST(SimpleTest, ReturnsExpectedValue) {
  MockClass mock;
  EXPECT_CALL(mock, GetValue())
      .WillOnce(testing::Return(42));

  EXPECT_EQ(mock.GetValue(), 42);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run this. Success means your compiler, linker, and mock configuration are sound.

---

## 6. Additional Resources and References

- [GoogleMock README](https://google.github.io/googletest/googlemock/)
- [GoogleTest Primer](../../getting-started/first-steps-usage-validation/primer.md)
- [gMock for Dummies](../gmock_for_dummies.md)
- [Mocking Reference](../reference/mocking.md)
- [gMock Cookbook](../gmock_cook_book.md)
- [Troubleshooting Common Setup Issues](../../getting-started/first-steps-usage-validation/troubleshooting-common-issues.md)

---

## Summary

This page empowers you to quickly resolve the most common setup issues preventing GoogleTest and GoogleMock from building, linking, or running correctly. Through clear diagnostic steps, sample code, and advice on common pitfalls, you will gain confidence to run your first tests and start integrating test-driven workflows smoothly.

<Tip>
If you encounter persistent issues, enabling verbose gMock logging with `--gmock_verbose=info` and consulting the [Legacy gMock FAQ](../gmock_faq.md) often reveals immediate clues.
</Tip>

---

<Note>
For platform or build tool-specific setup, please consult the appropriate [Platform-Specific Setup](../../getting-started/prerequisites-installation/platform-specific-instructions.md) document.
</Note>


---