---
title: "Installation and Setup Problems"
description: "Solutions to common installation problems, including supported compilers, CMake integration, version mismatches, and platform-specific issues. Includes guidance for troubleshooting failed builds and initial configuration."
---

# Installation and Setup Problems

This FAQ addresses common challenges encountered during the installation and initial setup of GoogleTest. Whether you are building from source, integrating with CMake, or facing platform-specific difficulties, this guide provides clear, actionable solutions to ensure a smooth and successful build process.

---

## Supported Compilers and Platforms

GoogleTest requires a C++17-compliant compiler and officially supports Linux, Windows, and macOS platforms. It also works on embedded and specialized platforms with appropriate customization.

### Key Points

- Ensure your compiler supports C++17 or later. Commonly supported compilers include:
  - GCC 7.x and above
  - Clang 5.x and above
  - Microsoft Visual Studio 2017 and above
- For embedded platforms like ESP8266, ESP32, and NRF52 (Arduino environment), GoogleTest adapts its entry points (`setup()`/`loop()` instead of `main()`).

<Tip>
Use compiler flags like `-std=c++17` to enforce the required standard. If build errors mention unsupported language features, check your compiler version and flags.
</Tip>

---

## Building with CMake

### Standalone Build

To build GoogleTest (including GoogleMock) as a standalone project:

```bash
git clone https://github.com/google/googletest.git -b main
dcd googletest
mkdir build
cd build
cmake ..
make
sudo make install  # Requires admin privileges
```

To build only GoogleTest without GoogleMock, disable GoogleMock explicitly:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

### Integration into Existing CMake Projects

Instead of separately installing, you can add GoogleTest as a subdirectory in your own CMake project:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/heads/main.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test.cpp)
target_link_libraries(my_tests gtest_main)  # or gtest
add_test(NAME my_tests COMMAND my_tests)
```

This approach guarantees consistent compiler and linker settings.

### Common CMake Issues

- **CMake version:** GoogleTest's build scripts require at least CMake 3.13.
- **Compiler flags:** Make sure compiler flags specify C++17.
- **Shared/static linking conflicts:** Use `-DBUILD_SHARED_LIBS=ON` or `OFF` appropriately.
- **Visual Studio runtime mismatch:** Enable `gtest_force_shared_crt` option to match CRT linkage.

<Warning>
Building GoogleTest as a shared library requires you to define `-DGTEST_CREATE_SHARED_LIBRARY=1` and link tests with `-DGTEST_LINKED_AS_SHARED_LIBRARY=1`. Failing to do so may cause linker errors or runtime crashes.
</Warning>

---

## Version Mismatches and Linking Errors

When linking your tests, you may experience errors due to version mismatches or missing symbols.

### Common Scenarios

- Linking without `gtest_main` library requires you to provide your own `main()` function that calls `testing::InitGoogleTest()` and `RUN_ALL_TESTS()`.
- Using `gmock_main` provides a main function that initializes both GoogleMock and GoogleTest.
- If missing symbols appear from GoogleTest internals, ensure that your linker includes the `gtest` or `gtest_main` libraries.

### Example Custom main()

```c++
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Use `gtest_main` to avoid writing this if no special setup is needed.

<Tip>
Always check that versions of GoogleTest and GoogleMock binaries match the source code used to avoid ABI incompatibility.
</Tip>

---

## Troubleshooting Failed Builds

### Common Build Failures

- **Unsupported C++ standard or features:** Confirm your compiler version and flags.
- **Missing pthreads on Unix systems:** Add `-DGTEST_HAS_PTHREAD=1` and link with pthread library (`-lpthread`).
- **Linker errors on Windows with MSVC:** Use the CMake option `-Dgtest_force_shared_crt=ON` to fix CRT conflicts.
- **File not found errors for headers or sources:** Ensure the source tree is intact and paths to `googletest/include` and `googletest/src` are valid in your build system.

### Platform-Specific Notes

- On **Windows**, use the Visual Studio solution generated by CMake or build directly with MSBuild.
- On **macOS**, Xcode project files are generated and can be used for building.
- For **embedded platforms (ESP8266, ESP32, NRF52)**, entry points differ as explained in the `gtest_main.cc` file, ensure your build config aligns.

---

## Initial Configuration Tips

- Always invoke `testing::InitGoogleTest()` before calling `RUN_ALL_TESTS()`.
- If using GoogleMock, prefer `testing::InitGoogleMock()` which initializes both GoogleMock and GoogleTest.
- Do not call `RUN_ALL_TESTS()` more than once per process; multiple invocations cause undefined behavior.

---

## Additional Best Practices

- Use `BUILD_SHARED_LIBS` with caution and match it with your projectâ€™s expectations.
- When embedding GoogleTest sources, synchronize CMake settings to avoid conflicts.
- Leverage the CMake hermetic build setup when available to minimize environmental variables affecting builds.

<Note>
Consult the official [GoogleTest README](https://github.com/google/googletest/blob/main/README.md) for the latest build instructions and troubleshooting tips.
</Note>

---

## Common Questions

### Q: What if my tests fail to link with `undefined reference` errors?
**A:** Verify that your linker includes `gtest` or `gtest_main`. Add them to your linker inputs explicitly or via CMake targets.

### Q: Can I build GoogleTest without GoogleMock?
**A:** Yes. Pass `-DBUILD_GMOCK=OFF` when running CMake.

### Q: How do I fix runtime errors related to pthreads?
**A:** Ensure the pthread library is linked (e.g., add `-lpthread` to linker flags) and define `-DGTEST_HAS_PTHREAD=1`.

### Q: I get mismatched runtime library errors on Windows. How to solve?
**A:** Use the `gtest_force_shared_crt` CMake option to align runtime libraries across your tests and GoogleTest.

### Q: How do I write a custom `main()`?
**A:** Implement `main()` to call `testing::InitGoogleTest()` with command-line args and return `RUN_ALL_TESTS()`. Alternatively, link with `gtest_main` to avoid writing it manually.

---

## Troubleshooting Checklist

<Steps>
<Step title="Verify Compiler Compatibility">
Ensure your compiler supports at least C++17. Check compiler version and compile flags.
</Step>
<Step title="Check CMake Version">
Use CMake 3.13 or newer to avoid unsupported commands.
</Step>
<Step title="Confirm Library Linking">
Verify linkage of `gtest` and `gtest_main` or `gmock` and `gmock_main` if using GoogleMock.
</Step>
<Step title="Resolve pthreads Dependencies">
On Unix platforms, add pthread flags and define `GTEST_HAS_PTHREAD` appropriately.
</Step>
<Step title="Platform-Specific Adjustments">
For embedded platforms, adapt your main entry point as GoogleTest expects (e.g., `setup()` and `loop()` for Arduino-like systems).
</Step>
<Step title="Check for Runtime Library Mismatches">
On Windows, align runtime library settings via `gtest_force_shared_crt`.
</Step>
</Steps>

---

## Getting Help

If you encounter persistent issues:

- Review the error logs carefully and identify if they relate to compiler compatibility, linker errors, or missing dependencies.
- Consult the official [GoogleTest GitHub Issues](https://github.com/google/googletest/issues) to see if your problem has been reported.
- Engage with community forums and Q&A sites where GoogleTest is discussed.
- Refer to related documentation pages such as:
  - [System Requirements](https://github.com/google/googletest/tree/main/docs/prerequisites-installation/system-requirements)
  - [Project Setup & Configuration](https://github.com/google/googletest/tree/main/docs/getting-started/configuration-first-use/project-setup)
  - [Integration & Ecosystem](https://github.com/google/googletest/tree/main/docs/overview/feature-overview-integration/integration-points)

<Tip>
Always reproduce build issues with verbose logging enabled (`make VERBOSE=1` or equivalent) to provide detailed information when seeking support.
</Tip>

---

For comprehensive information, see:

- [GoogleTest README on GitHub](https://github.com/google/googletest/blob/main/README.md)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/guides/getting-started/primer-basics.md)
- [CMake Quickstart](https://github.com/google/googletest/blob/main/docs/guides/getting-started/quickstart-cmake.md)

---

#### Example minimal main() using GoogleTest:

```c++
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

#### Platform-specific entry example for Arduino-like systems (taken from `gtest_main.cc`):

```c++
void setup() { testing::InitGoogleTest(); }
void loop() { RUN_ALL_TESTS(); }
```

---

### Related Documentation

- [System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/system-requirements)
- [Project Setup & Configuration](https://github.com/google/googletest/tree/main/docs/getting-started/configuration-first-use/project-setup)
- [Troubleshooting Common Issues](https://github.com/google/googletest/tree/main/docs/getting-started/troubleshooting-help/common-issues)
- [Integration with Build Systems](https://github.com/google/googletest/tree/main/docs/guides/integration-scenarios/build-system-integration)

---

This page is part of the Getting Started and FAQ sections focused on resolving installation and setup problems, feeding into guides on writing tests and build system integration.