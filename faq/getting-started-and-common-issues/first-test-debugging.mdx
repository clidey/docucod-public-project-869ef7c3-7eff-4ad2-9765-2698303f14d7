---
title: "My First Test: Debugging and Best Practices"
description: "Guides users through their first test, highlighting typical runtime errors, assertion failures, and best practices for structuring and executing tests with GoogleTest and GoogleMock."
---

# My First Test: Debugging and Best Practices

This guide helps you navigate the initial experience of writing and running your first test using GoogleTest and GoogleMock. It highlights common runtime errors, assertion failures, and effective test structure best practices to set you on a solid foundation.

---

## 1. Understanding Your First Test

When you write your first test, you typically:

- Define the test case and test method.
- Write some code exercising your units under test.
- Make assertions about expected outcomes.

GoogleTest and GoogleMock provide macros and utilities to automate much of the test verification, including detailed reporting when things go wrong.


## 2. Typical Runtime Errors and How to Handle Them

### 2.1 Linking Errors

These errors usually occur when the GoogleTest or GoogleMock libraries are missing during build or linking.

**How to fix:**
- Ensure you link `gtest`, `gmock`, and their dependencies correctly.
- Follow the instructions in the [Installation and Project Setup](/guides/getting-started/installation-and-setup) guide.

### 2.2 Mock Method Not Called Error

When a mocked method expected to be called is not called:

```text
path/to/my_test.cc:119: Failure
Actual function call count doesn't match this expectation:
  Actually: never called;
  Expected: called at least once.
Stack trace:
...
```

**Remedy:**
- Verify your `EXPECT_CALL()` matches the actual calls.
- Make sure your code executes the calls as intended.

### 2.3 Unexpected Calls

You might see warnings or errors about unexpected calls:

- **Naggy** mocks print warnings on calls with no matching `EXPECT_CALL`.
- **Strict** mocks treat such calls as failures.

**Control the behavior using** `NiceMock`, `NaggyMock` or `StrictMock` wrappers (see [Strictness: Nice, Naggy, and Strict Mocks](https://google.github.io/googletest/concepts/core-architecture/strictness-model.html)).


### 2.4 Common Assertion Failures

- Make sure you call `EXPECT_CALL()` *before* the call to the mock method.
- Validate matchers carefully; mismatched arguments cause failures.
- Use the `--gmock_verbose=info` flag to get detailed call trace info.


## 3. Structuring Your First Test

### 3.1 Basic Test Example

Here is a pattern for simple tests:

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

using ::testing::AtLeast;

class MockTurtle {
 public:
  MOCK_METHOD(void, PenDown, (), ());
};

TEST(PainterTest, CanDrawSomething) {
  MockTurtle turtle;                 // Create mock object
  EXPECT_CALL(turtle, PenDown())    // Set expectation
      .Times(AtLeast(1));

  // Exercise code under test, which uses turtle
  Painter painter(&turtle);
  EXPECT_TRUE(painter.DrawCircle(0, 0, 10));
}
```

### 3.2 Tips for Effective Tests

- Always set your expectations before exercising the code.
- Use explicit matchers (`_`, `Eq()`) for arguments.
- Use `NiceMock` if you want quiet warnings when uninteresting calls happen.
- Group related expectations inside an `InSequence` block if you want to enforce call order.


## 4. Debugging Test Failures

### 4.1 Enable Detailed Output

Add the flag:

```
--gmock_verbose=info
```

when running tests to see verbose call traces, which help pinpoint why expectations fail.


### 4.2 Test Stack Trace Inspection

If using Emacs, you can jump directly to failure points by pressing `Enter` on the error line.


### 4.3 Check Matcher Details

Match failures often reveal which argument caused the mismatch. Adjust your matchers or `EXPECT_CALL` accordingly.


## 5. Best Practices for Writing Tests

- **Minimal Necessary Expectation:** Don’t over-specify expectations unnecessarily.
- **Use ON_CALL for Defaults:** Use `ON_CALL()` to specify default behavior without strict verification.
- **Avoid Overly Complex Matchers:** Err on side of clarity. Use custom matchers if needed.
- **Clean Up After Tests:** Memory leaks prevent automatic verification; prefer stack allocated mocks or use heap checkers.


## 6. Next Steps and Resources

Explore related guides to deepen your mastery:

- [Writing and Running Your First Test](/guides/getting-started/your-first-test)
- [Installing and Project Setup](/guides/getting-started/installation-and-setup)
- [Mocking Workflows](/guides/effective-testing-techniques/mocking-workflows)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for recipes
- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) for beginner tutorials


---

## Appendix: Sample Simple Test

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

using ::testing::AtLeast;

class MockTurtle {
 public:
  MOCK_METHOD(void, PenDown, (), ());
};

void PainterDrawCircle(MockTurtle* turtle) {
  turtle->PenDown();
  // draws circle...
}

TEST(PainterTest, PenIsDownWhenDrawingCircle) {
  MockTurtle turtle;
  EXPECT_CALL(turtle, PenDown())
      .Times(AtLeast(1));

  PainterDrawCircle(&turtle);
}
```

Run with:

```bash
./your_test_binary
```

If the test fails, check output for: 

- Whether `PenDown()` call matched expectation.
- Matchers and call count.
- Use `--gmock_verbose=info` for verbose output.

---

## Summary

Writing your first test includes defining expectations, running code under test, and interpreting failures. Watch out for linking issues, uncaught mismatches in call expectations, and unexpected mock method usage. Use GoogleMock’s control over mock strictness and expectation behavior to tune your tests, and leverage detailed verbose output for troubleshooting. Adopt best practices such as setting expectations before code execution, using clear matchers, and managing mock lifetimes properly.



---

<CallToAction>
For more in-depth guidance and advanced scenarios, review the [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) and the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html).
</CallToAction>
