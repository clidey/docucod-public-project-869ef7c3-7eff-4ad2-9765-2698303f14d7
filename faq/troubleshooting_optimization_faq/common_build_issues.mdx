---
title: "How can I resolve build or linking errors?"
description: "Identifies typical build and linking issues when integrating GoogleTest or GoogleMock, with actionable troubleshooting steps tailored for both CMake and Bazel workflows. Enables users to overcome common compilation and configuration obstacles."
---

# How Can I Resolve Build or Linking Errors?

Integrating GoogleTest and GoogleMock into your C++ projects can occasionally surface build and linking errors, particularly when working with different build systems like CMake and Bazel. This troubleshooting guide illuminates common causes of such errors and provides *actionable*, step-by-step approaches to overcome them, ensuring your test environment compiles and links smoothly.

---

## Common Causes of Build and Linking Errors

Understanding typical sources of build and linking issues helps you target fixes quickly.

- **Incorrect Target Linking:** Your test executable must explicitly link against the GoogleTest (`gtest`), GoogleMock (`gmock`), and their respective main libraries when using `gtest_main` is not applicable.

- **Missing or Misconfigured Include Paths:** Failing to set the path to `gtest/include` and `gmock/include` headers causes compiler errors.

- **Conflicts Between GoogleTest and GoogleMock Libraries:** GoogleMock depends on GoogleTest, so linking order or missing dependencies trigger issues.

- **Mismatched Build Configurations:** Compiling GoogleTest/GoogleMock separately with different compiler flags, runtime settings, or standards may cause incompatibilities.

- **Incorrect Use of Test Macros and Fixtures:** Mixing `TEST` and `TEST_F` in the same suite, or missing instantiations of parameterized tests can result in linking or runtime failures.

- **Platform-Specific or Environment Issues:** Differences in compiler versions, C++17 compliance, or Bazel/CMake integration quirks can cause build failures.

---

## Troubleshooting Steps for CMake-Based Projects

CMake is the most common build system for GoogleTest integration. Follow these steps to identify and fix build and linking problems:

### 1. Verify GoogleTest Source and Target Inclusion

- Ensure GoogleTest is added as a subdirectory in your `CMakeLists.txt`:

  ```cmake
  add_subdirectory(googletest)
  ```

- Link your test executable with the correct targets:

  ```cmake
  add_executable(my_tests my_tests.cc)
  target_link_libraries(my_tests PRIVATE gtest_main gmock)
  ```

  - Use `gtest_main` if you want the default main function provided by GoogleTest.
  - Link `gmock` if you use GoogleMock features.

### 2. Configure Include Directories

- CMake sets include directories automatically with `add_subdirectory`, but if using installed packages, ensure proper include paths:

  ```cmake
  target_include_directories(my_tests PRIVATE ${gtest_SOURCE_DIR}/include)
  target_include_directories(my_tests PRIVATE ${gmock_SOURCE_DIR}/include)
  ```

- Verify that your compiler can find `gtest/gtest.h` and `gmock/gmock.h`.

### 3. Confirm Compiler and C++ Standard

- GoogleTest requires C++17 or higher. Set this explicitly:

  ```cmake
  target_compile_features(my_tests PRIVATE cxx_std_17)
  ```

- Ensure your compiler supports C++17 and is compatible with GoogleTest.

### 4. Clean and Rebuild

- Sometimes stale build files cause issues. Clean your build directory:

  ```bash
  rm -rf build/*
  cmake -S . -B build
  cmake --build build
  ```

- Re-run configuration and rebuild.

### 5. Handle Parameterized Test Linking Errors

- If you get linking errors related to value- or type-parameterized tests:
  - Confirm that all `TEST_P` and `TYPED_TEST_P` test cases are instantiated with `INSTANTIATE_TEST_SUITE_P` or `INSTANTIATE_TYPED_TEST_SUITE_P` respectively.
  - If your suite is intentionally abstract and not instantiated, suppress errors by adding:

  ```cpp
  GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST(MyTestSuite);
  ```

### 6. Verify No Conflicting Libraries

- Avoid linking against multiple conflicting versions of GoogleTest or GoogleMock.
- If integrating via external packages, verify library paths and versions.

---

## Troubleshooting Steps for Bazel-Based Projects

Bazel integration can have particular challenges due to its workspace and target rules.

### 1. Confirm WORKSPACE Setup

- GoogleTest and GoogleMock must be properly declared in `WORKSPACE` (e.g., via `http_archive` or `git_repository`).

### 2. Declare Correct Dependencies in BUILD Files

- Add dependencies to the test target in your `BUILD` file:

  ```python
  cc_test(
      name = "my_tests",
      srcs = ["my_tests.cc"],
      deps = [
          "@com_google_googletest//:gtest",
          "@com_google_googletest//:gtest_main",
          "@com_google_googletest//:gmock",
      ],
  )
  ```

  - Include `gtest_main` if you rely on its main function.
  - Include `gmock` if mocking features are used.

### 3. Use Compatible C++ Standards

- Bazelâ€™s default may differ. Set `cxx_std` attribute appropriately:

  ```python
  cc_test(
      ...
      copts = ["-std=c++17"],
  )
  ```

### 4. Check for Proper Linkage

- Linking issues sometimes stem from missing archive dependencies or incorrect order.
- Use Bazel's `verbose_failures` and `sandbox_debug` flags for detailed build logs:

  ```bash
  bazel test --test_output=all --verbose_failures --sandbox_debug //path/to:my_tests
  ```

### 5. Handle Parameterized Tests Properly

- Ensure that your test suite includes the necessary `REGISTER_TYPED_TEST_SUITE_P` and instantiation macros.
- If Bazel's build graph is missing instantiation files, you might get undefined symbol errors.

### 6. Verify No Conflicts or Stale Artifacts

- Run `bazel clean` to remove previous build artifacts.

---

## Best Practices for Avoiding Build and Linking Errors

- **Prefer using `gtest_main`** if you don't need a custom main function.
- **Consistently apply C++17 or higher standard** in both GoogleTest and your tests.
- **Do not mix `TEST` and `TEST_F` in the same test suite.** Use consistent fixture usage.
- **Always instantiate parameterized and typed tests** where necessary.
- **Keep GoogleTest/GoogleMock source and binaries in a single place** when building manually.
- **Use the official GoogleTest subdirectory or package** for consistent versions.
- **Always call `testing::InitGoogleTest()` before `RUN_ALL_TESTS()` in your main.**

---

## Additional Tips and Checks

- If you see errors indicating multiple fixtures with the same test suite name but different fixture classes, check your test suite and fixture naming to avoid clashes.
- If tests are defined but not running, ensure they pass filtering and are linked.
- For complex errors, enable verbose compiler and linker flags to get detailed messages.
- Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` to suppress warnings about uninstantiated parameterized tests if intentional.

---

## Summary

Build and linking errors in GoogleTest and GoogleMock integration typically arise from incorrect target linkages, missing includes, mismatched C++ standards, and missing instantiations in parameterized tests. Following clear build system-specific guidance for CMake or Bazel, verifying dependencies, and using GoogleTest best practices will lead to smooth builds and productive testing.

---

## References

- [GoogleTest: Getting Started - Setting Up Your Test Project](/guides/getting-started/setup-project)
- [GoogleTest: Writing and Running Your First Test](/guides/getting-started/writing-your-first-tests)
- [GoogleTest: Test Macros & Fixtures (API Reference)](/api-reference/core-testing-apis/test-macros)
- [GoogleTest: Installation & Setup - Configuration & Integration](/getting-started/installation-setup/configuration-integration)
- [GoogleTest: FAQ on Supported Platforms](/faq/getting_started_faq/supported_platforms_faq)
- [GoogleTest: Troubleshooting & Common Issues](/getting-started/first-test-experience/common-issues-troubleshooting)

Use these resources alongside this troubleshooting guide to deepen your understanding and quickly resolve integration problems.

---

### Example CMake Configuration

```cmake
cmake_minimum_required(VERSION 3.10)
project(MyProject LANGUAGES CXX)

# Add GoogleTest
add_subdirectory(googletest)

# Your test executable
add_executable(my_tests my_tests.cc)

# Link against GoogleTest and GoogleMock
target_link_libraries(my_tests PRIVATE gtest gtest_main gmock)

target_compile_features(my_tests PRIVATE cxx_std_17)
```

### Example Bazel BUILD Snippet

```python
cc_test(
    name = "my_tests",
    srcs = ["my_tests.cc"],
    deps = [
        "@com_google_googletest//:gtest",
        "@com_google_googletest//:gtest_main",
        "@com_google_googletest//:gmock",
    ],
    copts = ["-std=c++17"],
)
```

---