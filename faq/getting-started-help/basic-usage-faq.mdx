---
title: "Basic Usage FAQ"
description: "Concise explanations for frequent questions about writing, running, and interpreting basic tests and mock objects, including test discovery and core assertions. Ideal for new users who want to understand key workflows quickly."
---

# Basic Usage FAQ

This FAQ addresses common questions and concerns about writing, running, and interpreting basic tests and mock objects with GoogleTest and GoogleMock. It is tailored to help new users navigate common workflows quickly and with confidence.

---

### 1. How do I write my first test with GoogleTest?

Writing your first test involves including GoogleTest headers, defining a test case with the `TEST` macro, and using assertions to verify behavior. Here's a simple example:

```cpp
#include <gtest/gtest.h>

TEST(ExampleTest, BasicAssertion) {
  EXPECT_EQ(1 + 1, 2);
}
```

After compiling and running your test executable, GoogleTest will report success or failure based on the assertions.

For detailed steps, see [Writing Your First Test](https://github.com/google/googletest/blob/main/docs/primer.md#writing-your-first-test).

### 2. What is test discovery and how does GoogleTest find my tests?

GoogleTest automatically discovers tests registered with the `TEST` and `TEST_F` macros at runtime. When you run your test executable, it enumerates all tests and executes them unless you filter them.

Use command-line options like `--gtest_filter` to run specific tests or suites.

### 3. How do I define and use mock objects in my tests?

Mock objects simulate interfaces and let you specify expected method calls, their arguments, and return behaviors.

Typical workflow:

1. Define a mock class by subclassing your interface and using the `MOCK_METHOD` macro to declare mock methods.

2. Create mock object instances in your tests.

3. Use `EXPECT_CALL` to specify expected calls and behaviors.

4. Run code that interacts with mocks.

For example:

```cpp
#include <gmock/gmock.h>

class Foo {
 public:
  virtual ~Foo() {}
  virtual int GetValue() const = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
};

TEST(MockTest, ReturnsExpectedValue) {
  MockFoo mock_foo;
  EXPECT_CALL(mock_foo, GetValue())
      .WillOnce(::testing::Return(42));

  EXPECT_EQ(mock_foo.GetValue(), 42);
}
```

See [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) and the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for more.

### 4. What is the difference between EXPECT_CALL and ON_CALL?

- `EXPECT_CALL` sets an expectation that a mock method **must** be called matching certain arguments and optionally sets an action. If calls don't respect the expectation, the test fails.

- `ON_CALL` defines a default behavior (action) for a method when called, but does **not** require it to be called. Useful for setting default mock method behaviors without imposing strict checks.

Example:

```cpp
ON_CALL(mock_foo, GetValue())
    .WillByDefault(::testing::Return(0));  // Default action

EXPECT_CALL(mock_foo, GetValue())
    .Times(1)
    .WillOnce(::testing::Return(42));     // Expectation
```

### 5. How do I specify how many times a mock method is expected to be called?

You use the `.Times()` clause in an `EXPECT_CALL` statement. Cardinalities include:

- `Times(1)` - Exactly once (default if omitted)
- `Times(AnyNumber())` - Any number of times
- `Times(AtLeast(n))` - At least n times
- `Times(AtMost(n))` - At most n times
- `Times(Between(m, n))` - Between m and n times always inclusive

Example:

```cpp
EXPECT_CALL(mock_foo, GetValue())
    .Times(AtLeast(2));
```

### 6. How do I specify the order of expected function calls?

GoogleMock supports ordered calls via sequences.

Create a `Sequence` object and assign expectations to it using `.InSequence()`:

```cpp
Sequence s;
EXPECT_CALL(mock_foo, DoFirst())
    .InSequence(s);
EXPECT_CALL(mock_foo, DoSecond())
    .InSequence(s);
```

Calls matching expectations in the same sequence must occur in the given order. Alternatively, wrap expectations in a block with an `InSequence` object for convenience.

### 7. What are NiceMock, NaggyMock, and StrictMock?

- **NaggyMock** (default behavior) warns when uninteresting calls (calls without expectations) occur.
- **NiceMock** suppresses warnings for uninteresting calls, making the tests less noisy.
- **StrictMock** treats uninteresting calls as failures.

Use these to control the strictness of your mock's call monitoring.

Example:

```cpp
using testing::NiceMock;
NiceMock<MockFoo> mock_foo;
```

### 8. What causes "unexpected mock function call" errors?

An unexpected call means your code called a mock method with arguments that do not match any **active** expectation (`EXPECT_CALL`). It indicates the test did not expect that call.

To fix this, add or correct the `EXPECT_CALL` statements for those calls.

### 9. Why am I getting warnings about "Uninteresting mock function call"?

This means a mock method without an explicit expectation (`EXPECT_CALL`) was called. By default, GoogleMock considers such calls uninteresting and proceeds with default action, but it prints a warning for your information.

If you intended the call to be allowed without strict checks, use `NiceMock`, or add an `EXPECT_CALL` with `.Times(AnyNumber())` to silence warnings.

### 10. How can I check that a function is never called?

Use `.Times(0)` in an `EXPECT_CALL` for that method and argument pattern:

```cpp
EXPECT_CALL(mock_foo, ForbiddenMethod())
    .Times(0);
```

If the method is called, the test fails immediately.

### 11. How do I handle overloaded mock methods?

Use `MOCK_METHOD` with exact argument types. To deal with const and non-const overloads, use the `Const()` wrapper when setting expectations.

Example:

```cpp
MOCK_METHOD(int, GetNumber, (), (override));
MOCK_METHOD(int, GetNumber, (), (const, override));

EXPECT_CALL(mock, GetNumber());           // Non-const
EXPECT_CALL(Const(mock), GetNumber());    // Const
```

### 12. How do I return values that depend on the call index or arguments?

You can chain multiple `.WillOnce()` clauses followed optionally by `.WillRepeatedly()`:

```cpp
EXPECT_CALL(mock, GetValue())
    .WillOnce(Return(1))
    .WillOnce(Return(2))
    .WillRepeatedly(Return(3));
```

This example returns 1 on first call, 2 on second, then 3 on subsequent calls.

### 13. What if my mock method returns a move-only type like `std::unique_ptr`?

Simply use `MOCK_METHOD` as usual. To return such types, use lambdas with `WillOnce` or `WillRepeatedly` to return new instances since `Return` can only be used once for move-only types.

Example:

```cpp
EXPECT_CALL(mock_buzzer, MakeBuzz(_))
    .WillRepeatedly([](auto) {
        return std::make_unique<Buzz>();
    });
```

### 14. How can I reset the expectations and default actions of a mock?

Use the verification and clearing functions:

- `Mock::VerifyAndClearExpectations(&mock_obj);`
- `Mock::VerifyAndClear(&mock_obj);` (also clears default actions)

Avoid setting new expectations after calling these functions for the same mock.

### 15. How do I debug failing expectations and understand why calls are unexpected?

Run your tests with the flag `--gmock_verbose=info` to see detailed traces of all expectations and mock calls, including which expectations matched and which didn't.

This insight helps pinpoint argument mismatches, call orders, and missing expectations.

### 16. Can I delegate a mock's call to a real or fake implementation by default?

Yes. Use `ON_CALL` with lambda or function to forward calls to a real or fake object.

Example:

```cpp
ON_CALL(mock_foo, DoThis)
    .WillByDefault([this](int n) {
      return real_.DoThis(n);
    });
```

This preserves call verification but reuses existing logic.

### 17. How does GoogleMock deal with unexpected or excessive calls?

- **Unexpected calls:** Fail tests with detailed messages.
- **Excessive calls:** Calls after the expected count are treated as errors but execute default actions if provided.

Use `.RetiresOnSaturation()` on expectations to retire expectations once saturated, allowing other expectations to match later calls.

### 18. How to control verbosity of mock failure messages?

Set the flag `--gmock_verbose=LEVEL` where `LEVEL` is:

- `info`: Show all messages including stack traces
- `warning`: Show warnings and errors (default)
- `error`: Show errors only, suppress warnings

Example:

```bash
test_binary --gmock_verbose=info
```

---

### Additional Resources

- [gMock for Dummies Guide](https://google.github.io/googletest/gmock_for_dummies.html)
- [Mocking Reference Overview](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cookbook with Recipes](https://google.github.io/googletest/gmock_cook_book.html)
- [gMock Cheat Sheet for Quick Reference](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html)

---

For troubleshooting setup and usage issues, consult the [Common Installation Issues FAQ](https://github.com/google/googletest/blob/main/docs/faq/getting-started-help/common-installation-issues.md).

# Troubleshooting Highlights

<AccordionGroup title="Common User Issues in Basic GoogleMock Usage">
<Accordion title="Unexpected Call Errors">
These occur when your code calls a mock method with arguments that do not match any expectation. The solution is to review your `EXPECT_CALL`s to ensure they cover the calls made.
</Accordion>
<Accordion title="Uninteresting Call Warnings">
Warnings when mock methods without expectations are invoked. Suppress these by using `NiceMock` or by adding `EXPECT_CALL` with `.Times(AnyNumber())`.
</Accordion>
<Accordion title="Mismatch Arguments in Calls">
Check that your argument matchers match the actual calls' arguments. Use `--gmock_verbose=info` for detailed call logs.
</Accordion>
<Accordion title="Order of Calls Fails">
Use `InSequence` or `Sequence` objects to enforce ordering expectations.
</Accordion>
</AccordionGroup>

<Tip>
Always set expectations **before** exercising the mock object to avoid undefined behavior.
</Tip>

<Note>
If you observe warnings about "Uninteresting mock function calls," verify if you want those calls allowed; if so, use a NiceMock or add catch-all expectations.
</Note>

<Warning>
Overusing strict mocks or overly specific expectations can make your tests brittle and hard to maintain. Balance precision with maintainability.
</Warning>

---

### Quick Reference Code Snippet: Defining and Using a Mock

```cpp
#include <gmock/gmock.h>

class Interface {
 public:
  virtual ~Interface() {}
  virtual int Foo(int x) = 0;
};

class MockInterface : public Interface {
 public:
  MOCK_METHOD(int, Foo, (int x), (override));
};

TEST(MyTest, Example) {
  MockInterface mock;

  EXPECT_CALL(mock, Foo(::testing::Ge(0)))
      .WillOnce(::testing::Return(42));

  int result = mock.Foo(10);
  EXPECT_EQ(result, 42);
}
```

---

### Summary of Key Terms

| Term              | Description                                  |
|-------------------|----------------------------------------------|
| Mock Object       | A test double with controllable behavior and expectations.
| EXPECT_CALL       | Defines expected calls and actions on mocks.
| ON_CALL           | Defines default behaviors without expectations.
| Matcher           | Predicate used to specify argument conditions.
| Cardinality       | Specifies how many times an expectation should be met.
| Sequence / InSequence | Enforces call order.
| NiceMock / NaggyMock / StrictMock | Controls uninteresting call handling.

---