---
title: "How do I install and set up GoogleTest and GoogleMock?"
description: "Covers recommended installation flows, integration with build systems like CMake and Bazel, pointers to quickstart guides, and common obstacles faced during setup. Provides direct guidance to solve typical new user snags."
---

# How do I install and set up GoogleTest and GoogleMock?

This guide provides practical, actionable instructions to help you get started quickly with installing and setting up **GoogleTest** and **GoogleMock**. It covers recommended installation flows, integration with popular build systems like **CMake** and **Bazel**, common obstacles you may encounter during setup, and pointers to quickstart guides to accelerate your initial testing experience.

---

## 1. Overview of Installation and Setup

GoogleTest and GoogleMock are distributed together but can be built and used independently if needed. Both require a compliant C++17 environment and support major platforms like Linux, macOS, and Windows.

The installation involves:

- Cloning the repository or obtaining a release.
- Building the framework libraries.
- Integrating the libraries into your build system.
- Writing and running your first tests.

You can build GoogleTest/GoogleMock as standalone projects or integrate their sources directly into your existing projects.

<Info>
Building the `gtest_main` and `gmock_main` libraries includes default `main()` implementations so you usually don't need to write your own test main function.
</Info>

## 2. Building with CMake

CMake is the recommended and widely supported build system.

### Standalone GoogleTest/GoogleMock Build

Follow these steps:

```bash
# Clone the latest stable release
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest

# Create and enter a build directory
mkdir build && cd build

# Generate the build system (includes GoogleMock by default)
cmake ..

# Optional: Disable GoogleMock if only GoogleTest is needed
# cmake .. -DBUILD_GMOCK=OFF

# Build everything
make

# Optional: Install to system directories (may require admin rights)
sudo make install
```

- On Windows, CMake generates Visual Studio project files.
- On macOS, Xcode project files are generated if Xcode is installed.

### Incorporating into Your Own CMake Project

To include GoogleTest and GoogleMock in your project via CMake:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
# Make available for build
FetchContent_MakeAvailable(googletest)

# Link your test executable against gtest_main or gmock_main
add_executable(my_tests test.cpp)
target_link_libraries(my_tests gtest_main)  # For GoogleTest
# or
# target_link_libraries(my_tests gmock_main) # For GoogleMock

add_test(NAME MyTest COMMAND my_tests)
```

_This requires CMake 3.14 or later._

<Note>
Make sure to specify C++17 standard in your project (`set(CMAKE_CXX_STANDARD 17)`).
</Note>

## 3. Building with Bazel

GoogleTest and GoogleMock can also be integrated into Bazel-based projects:

- Add GoogleTest as a Bazel workspace dependency.
- Define relevant BUILD files to include GoogleTest and your test targets.

Refer to the [Installing with Bazel](../getting-started/installation-and-configuration/installing-googletest-bazel) guide for detailed instructions, including workspace and BUILD file setup.

## 4. Common Setup Snags and How to Resolve Them

### 4.1. Compiler and Platform Compatibility

- Ensure your compiler supports **C++17** or later.
- GoogleTest requires threading support; verify pthread availability or the equivalent on your platform.
- On Windows, beware of runtime library mismatches; use the CMake option `gtest_force_shared_crt` if you encounter linking errors related to the MSVC runtime.

### 4.2. Build and Link Errors

- Linking errors due to missing GoogleTest or GoogleMock libraries usually indicate incorrect or incomplete linking paths.
- Ensure `gtest`, `gtest_main`, `gmock`, and/or `gmock_main` are correctly linked.

### 4.3. Macro Name Conflicts

GoogleTest macros may clash with other libraries. To prevent conflicts, define relevant macros to rename GoogleTest macros (e.g., `-DGTEST_DONT_DEFINE_TEST=1`) and use the prefixed versions:

```cpp
GTEST_TEST(MySuite, MyTest) { ... }
```

### 4.4. Missing or Incorrect `main()` Entry Point

- If you don't want to provide your own `main()`, link with `gtest_main` or `gmock_main` libraries, which include a default `main()` implementation that calls `RUN_ALL_TESTS()`.

- If you provide your own `main()`, be sure to initialize GoogleTest or GoogleMock by calling `testing::InitGoogleTest(&argc, argv);` or `testing::InitGoogleMock(&argc, argv);` before `RUN_ALL_TESTS()`.

### 4.5. Running Tests

- After building, run your test executable. It will automatically discover and run all registered tests.
- The return code reflects success (`0`) or failure (`1`).
- Use command line flags to filter tests or control verbosity. You can explore them via `--help`.

## 5. Post-Setup Guidance

- Once installed, start writing tests using `TEST()` or `TEST_F()` macros.
- Refer to the [GoogleTest Primer](../getting-started/first-test-and-validation/quickstart-primer) to understand test writing basics.
- Use the [Writing Your First Test](../guides/getting-started/writing-your-first-test) guide for actionable examples.
- For mocking, explore the [Mocking with GoogleMock](../guides/core-testing-workflows/mocking-with-googlemock) guide.

## 6. Additional Tips and Best Practices

- Regularly update your copy of GoogleTest/GoogleMock to benefit from latest fixes and features.
- Use CMakeâ€™s FetchContent or git submodules for better version management integration.
- Utilize GoogleTest's built-in test discovery to avoid manual test registration.
- Consider linking with `gtest_main` and `gmock_main` libraries to reduce boilerplate.
- For large projects, organize your tests into suites and fixtures for maintainability.

---

## Related Documentation Links

- [Installing with CMake](../getting-started/installation-and-configuration/installing-googletest-cmake)
- [Installing with Bazel](../getting-started/installation-and-configuration/installing-googletest-bazel)
- [Platform-Specific Setup](../getting-started/installation-and-configuration/platform-specific-setup)
- [Writing and Running Your First Test](../getting-started/first-test-and-validation/writing-and-running-your-first-test)
- [GoogleTest Primer](../getting-started/first-test-and-validation/quickstart-primer)
- [Mocking with GoogleMock](../guides/core-testing-workflows/mocking-with-googlemock)
- [Troubleshooting Common Issues](../getting-started/first-test-and-validation/troubleshooting)

---

## Example: Minimal Custom `main()` Function

If you want a custom entry point, here is a basic example:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This setup is rarely necessary unless you need to perform additional setup before tests run.

---

## Troubleshooting Tips

- If your tests fail to link, verify the library link order and presence.
- Use verbose flags (`--gtest_verbose=info`) for more details.
- Validate compiler and linker flags to match those used for GoogleTest builds.
- Check for multiple definitions of `main()` if you link both `gtest_main` and define your own.

---

By following these instructions, you will have a robust, maintainable foundation for adding GoogleTest and GoogleMock to your C++ projects, accelerating your path toward effective, automated testing and improved code quality.
