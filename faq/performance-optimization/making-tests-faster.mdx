---
title: "How can I make my tests run faster?"
description: "Provides actionable tips on optimizing test execution, reducing test suite runtime, and practical advice for speeding up build and test cycles in large projects."
---

# How Can I Make My Tests Run Faster?

Optimizing the speed of your test suite enhances productivity and accelerates development cycles. This guide provides practical tips and strategies tailored for GoogleTest users to reduce test runtime, improve execution efficiency, and scale testing in large projects.

---

## 1. Understand What Affects Test Speed

Before optimizing, understand key factors influencing your test execution time:

- **Setup and teardown costs:** Expensive initialization or cleanup routines repeatedly invoked per test.
- **Test count and granularity:** Large numbers of tests or very fine-grained tests increase total runtime.
- **Test data and resource usage:** Heavy use of files, databases, or network calls slows down tests.
- **Parallelization and concurrency:** Inefficient use of system resources can cause bottlenecks.

Optimizing test speed is about balancing thoroughness with efficiency, focusing on high-impact areas.

---

## 2. Share Resources Across Tests With Test Suites

GoogleTest helps you reduce redundant setup costs with **per-test-suite setup/teardown:**

- Use static members in your test fixture class to hold expensive shared resources.
- Implement the public static methods `SetUpTestSuite()` and `TearDownTestSuite()` to initialize and dispose of shared objects once, not before every test.

### Example:

```cpp
class FooTest : public testing::Test {
 protected:
  static ExpensiveResource* shared_resource_;

  static void SetUpTestSuite() {
    shared_resource_ = new ExpensiveResource(/*...*/);
  }

  static void TearDownTestSuite() {
    delete shared_resource_;
    shared_resource_ = nullptr;
  }

  void SetUp() override {
    // Per-test setup, if needed.
  }

  void TearDown() override {
    // Per-test teardown, if needed.
  }
};

ExpensiveResource* FooTest::shared_resource_ = nullptr;

TEST_F(FooTest, Test1) {
  ASSERT_TRUE(shared_resource_->IsValid());
}
```

This approach prevents repeatedly reconstructing expensive objects and reduces total test runtime significantly.

---

## 3. Minimize Test Work and Improve Efficiency

- **Use scoped assertions wisely:** Prefer `EXPECT_*` over `ASSERT_*` when possible to allow tests to continue and report more failures in one run, reducing the need to rerun.
- **Avoid unnecessary I/O:** Cache file contents or mock external services instead of running actual I/O operations.
- **Use lightweight test data:** Prefer small, synthetic data sets over large, real-world files when possible.
- **Group related checks:** Combine related assertions into fewer, more comprehensive tests to reduce test overhead.

---

## 4. Run Tests Selectively and In Parallel

### Selective Test Execution

You can focus on relevant tests to save time by running subsets:

- Use `--gtest_filter` flag to run tests matching specific name patterns:

```bash
./your_test_binary --gtest_filter=FooTest.*
```

- Exclude tests or run only disabled tests using filter patterns.

### Parallel Test Execution

GoogleTest supports **test sharding** to distribute tests across multiple machines or processes:

- Set environment variables `GTEST_TOTAL_SHARDS` (total number of shards) and `GTEST_SHARD_INDEX` (zero-based index for each shard).
- Each shard runs a subset of tests so all tests are covered collectively.

Example:

```bash
export GTEST_TOTAL_SHARDS=4
export GTEST_SHARD_INDEX=2
./your_test_binary
```

This can significantly reduce wall-clock runtime on CI or multi-core machines.

---

## 5. Leverage Test Repetition and Shuffling for Flakiness Detection

- Use `--gtest_repeat=N` to run tests multiple times, uncovering flaky tests that may delay your test suite via intermittent failures.
- Use `--gtest_shuffle` to randomize test execution order, helping to identify hidden inter-test dependencies that slow tests.

```bash
./your_test_binary --gtest_repeat=100 --gtest_shuffle
```

---

## 6. Optimize Parameterized and Typed Tests

Parameterized tests (`TEST_P` and `INSTANTIATE_TEST_SUITE_P`) can explode the test count because tests expand for every parameter.

- Limit parameter counts to essential cases only.
- Use **custom parameter name generators** to quickly identify failing parameters without running all to completion.
- Combine parameters thoughtfully with `Combine()` only when necessary.

Typed tests (`TYPED_TEST_SUITE`) run each test for every type and can cause long runtimes if overused.

- Restrict types to the minimal relevant set.
- Consider splitting test suites to isolate expensive type tests.

---

## 7. Avoid Test Suite and Fixture Pitfalls

- Do not mix test types inconsistently in the same test suite (e.g., `TEST` and `TEST_F`) as GoogleTest requires fixture uniformity and inconsistent usage can cause runtime errors.
- Beware of expensive constructors or `SetUp()` code in fixtures that create overhead per test.
- Avoid heavy work in constructors or destructors; prefer shared fixture setups.

---

## 8. Monitor and Profile Tests

- Use test time reporting features (`--gtest_print_time=1`) to identify slow tests.
- Generate XML or JSON reports (`--gtest_output=xml:report.xml`) and analyze them to find bottlenecks.
- Optimize or refactor slow tests by understanding their shared context and resource usage.

---

## 9. Best Practices Summary

- Share costly resources using `SetUpTestSuite` / `TearDownTestSuite` to reduce per-test overhead.
- Run only selected tests or shards when possible to speed up feedback loops.
- Use `EXPECT_*` to maximize information yield per run.
- Limit parameter space in parameterized/typed tests.
- Use mocks or lightweight stubs instead of real I/O or external dependencies.
- Profile test durations regularly to keep the suite lean.

By following these strategies, you will consistently reduce your test suite's runtime and improve productivity.

---

## 10. Troubleshooting Performance Issues

<AccordionGroup title="Common Performance Issues and Solutions">
<Accordion title="Setup/TearDown Overhead">

If your tests run slowly due to expensive setup or teardown per test:

- Move setup code to `SetUpTestSuite()` or environment class.
- Cache expensive resources once.
- Profile which setup steps consume the most time.

</Accordion>
<Accordion title="Large Parameterized Test Explosion">

Too many test instantiations can bloat runtime:

- Limit parameters to a minimal representative subset.
- Use custom parameter name generators to identify failing cases efficiently.
- Split parameterized tests into categories.

</Accordion>
<Accordion title="Resource Contention in Parallel Tests">

When running tests in parallel or shards:

- Ensure tests do not contend for shared resources (files, ports).
- Use unique temporary directories or mock dependencies.
- Adjust shard/environment settings for optimal load balancing.

</Accordion>
<Accordion title="Slow External Dependencies">

Slow database, network, or file I/O in tests:

- Mock external systems where feasible.
- Use in-memory or lightweight substitutes.
- Limit test scope requiring heavy access.

</Accordion>
</AccordionGroup>

---

## 11. Additional Resources

- [Running Tests in Parallel or Selecting Specific Tests](/faq/performance-optimization/using-parallel-or-selective-test-execution)
- [Adapting GoogleTest/GoogleMock to Large Projects](/faq/performance-optimization/adapting-to-large-projects)
- [Value-Parameterized and Typed Tests](/concepts/advanced-concepts/parameterized-and-typed-tests)
- [Global and Shared Set-Up/Tear-Down](/docs/advanced.md#sharing-resources-between-tests-in-the-same-test-suite)
- [GoogleTest Command-line Flags and Filtering](../advanced.md#running-test-programs-advanced-options)

---

By adopting these practices, your tests will become faster, more reliable, and your development feedback loop will accelerate.

---

*This documentation is for the "How can I make my tests run faster?" FAQ page of GoogleTest.*


