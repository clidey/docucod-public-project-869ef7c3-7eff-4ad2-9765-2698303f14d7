---
title: "How do I write and structure my first tests?"
description: "Guides users through initial test creation, best practices for structuring suites, and mapping existing code to the framework's testing paradigms. Emphasizes recommended macros, fixtures, and patterns."
---

# How do I write and structure my first tests?

This guide walks you through creating your initial tests using GoogleTest, recommends best practices for organizing test suites, and shows how to map existing code into GoogleTest's testing patterns. You'll learn about essential macros, test fixtures, and structured approaches that build reliable and maintainable tests.

---

## 1. Starting with Simple Tests

The foundational element in GoogleTest is the `TEST()` macro, which lets you write an independent test function. Each `TEST()` requires two names: the *test suite* and the *test name*, both adhering to C++ naming conventions without underscores.

**Basic Workflow:**

1. Use `TEST(TestSuiteName, TestName) { ... }` to create a test.
2. Inside the block, write assertions to verify behavior.
3. Run your tests with `RUN_ALL_TESTS()` invoked in `main()`.

For example, to test a `Factorial()` function:

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

Tests that belong together logically share the same test suite name (`FactorialTest` above), which keeps your tests organized and easier to maintain.

> **Tip:** Avoid using underscores in test suite or test names to prevent naming conflicts and maintain compatibility.

---

## 2. Using Assertions

Assertions form the backbone of your tests. GoogleTest provides two key macros:

- `EXPECT_*` assertions generate *nonfatal* failures allowing the test to continue.
- `ASSERT_*` assertions generate *fatal* failures and abort the current test function immediately.

Choose `EXPECT_*` to collect multiple failures per test run for comprehensive feedback, and use `ASSERT_*` when continuing after failure is unsafe or meaningless.

You can add custom failure messages conveniently:

```cpp
ASSERT_EQ(x.size(), y.size()) << "Vectors have different sizes";
EXPECT_EQ(x[i], y[i]) << "Vectors differ at index " << i;
```

GoogleTest offers a wide range of assertions, including for equality, truth values, string comparisons, floats, exceptions, and more.

---

## 3. Organizing Tests with Fixtures

When multiple tests share the same setup or data, the *test fixture* pattern applies. A test fixture is a class derived from `testing::Test` that sets up common context.

**Key Steps:**

1. Define a test fixture class:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Setup shared queues
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_, q1_, q2_;
};
```

2. Write tests using `TEST_F()` with the fixture class name:

```cpp
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  delete n;
}
```

Each test runs with a fresh fixture instance, ensuring isolation and repeatability.

> **Best Practice:** Use the constructor for basic setup and `SetUp()` for complex initialization. Always ensure cleanup in `TearDown()` if required.

---

## 4. Writing the `main()` Function

Typically, you don't need to write your own `main` function if you link with `gtest_main`. However, if custom operations before or after tests are necessary, define your own as:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

`InitGoogleTest` processes command-line flags and initializes the framework. `RUN_ALL_TESTS()` executes all registered tests and returns zero on success, non-zero on failures.

> **Important:** Always return the value of `RUN_ALL_TESTS()` to accurately signal test result to your build or CI system.

---

## 5. Best Practices for Test Structure

- **Group Related Tests:** Use test suites to mirror the structure of your production code.
- **Name Thoughtfully:** Match function or class names but avoid underscores to prevent naming collisions.
- **Isolate Tests:** Prefer fixtures to global variables to reduce cross-test interactions.
- **Use Assertions Appropriately:** Favor `EXPECT_*` for non-fatal failures; use `ASSERT_*` when continuation doesn't make sense.
- **Write Clear Messages:** Provide custom failure messages to aid diagnosis.
- **Keep Tests Independent:** Avoid dependencies on execution order to ensure robustness.

---

## 6. Mapping Existing Code to GoogleTest

If you have legacy tests, map each scenario to a `TEST` or `TEST_F` based on:

- The scope of shared data (global setup moves to fixture setup).
- Test isolation (ensure no side-effects leak between tests).
- Logical grouping following source code modularity.

Use fixtures to consolidate setup and teardown logic.

---

## 7. Troubleshooting Common Issues

- **Tests Not Running:** Make sure `RUN_ALL_TESTS()` is called in `main()` and its return is propagated.
- **Naming Issues:** Avoid placing underscores in test suite and test names.
- **Test Failures with Unexpected Errors:** Check for misuse of `ASSERT_*` in non-void functions or constructors.
- **Linker Errors:** Ensure test source files are linked correctly with GoogleTest libraries.

For deeper troubleshooting, consult [the FAQ](../faq.md) and [the Troubleshooting Guide](../getting-started/first-steps-validation/troubleshooting-common-issues.md).

---

## 8. Next Steps

- Explore writing parameterized and typed tests to handle multiple inputs efficiently.
- Learn about advanced assertions and how to propagate failures.
- Discover mocking patterns to isolate dependencies.
- Study recommended test organization and maintenance strategies.

See also:
- [GoogleTest Primer](primer.md)
- [Testing Reference](reference/testing.md)
- [GoogleTest FAQ](faq.md)
- [GoogleMock for Dummies](gmock_for_dummies.md)

---

## References

- GoogleTest Primer: https://github.com/google/googletest/blob/main/docs/primer.md
- Testing Reference: https://github.com/google/googletest/blob/main/docs/reference/testing.md
- GoogleTest FAQ: https://github.com/google/googletest/blob/main/docs/faq.md
- GoogleMock for Dummies: https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md

---

## Summary

The "How do I write and structure my first tests?" page guides new users through creating initial GoogleTest tests, introduces the key macros `TEST()` and `TEST_F()`, and emphasizes structuring tests with fixtures to share setup and promote isolation. It stresses best practices around naming, assertions, and test suite organization. The page also covers writing a `main()` function to execute tests and points users to foundational resources for further mastery, positioning these basics within the broader GoogleTest documentation framework.