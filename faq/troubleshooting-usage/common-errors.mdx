---
title: "Common Build & Runtime Errors"
description: "Solutions for frequent build failures, link errors, or runtime issues that users encounter when integrating GoogleTest/GoogleMock into their projects. Includes practical error messages, diagnostics steps, and how to resolve them."
---

# Common Build & Runtime Errors

This FAQ section addresses frequent build failures, linking errors, and runtime issues encountered during integration and use of GoogleTest and GoogleMock in C++ projects. It provides clear explanations for common error messages, diagnostic procedures to identify root causes, and actionable steps to resolve these issues effectively.

---

## 1. Common Build Errors

### Q: I get errors related to missing `MOCK_METHOD` macros or compilation failures when defining mock methods. What should I check?

- Ensure you have included the main gMock header:
  ```cpp
  #include <gmock/gmock.h>
  ```
- Confirm you are placing `MOCK_METHOD` declarations in the `public:` section of your mock class. Methods must be virtual in the base class to be mockable.
- Be cautious with argument or return types containing commas, like template types. Wrap such types in extra parentheses or define type aliases:
  ```cpp
  MOCK_METHOD((std::pair<int, int>), GetPair, ());  // Correct
  using IntPair = std::pair<int, int>;
  MOCK_METHOD(IntPair, GetPair, ());                // Also correct
  ```
- Verify that the compiler supports C++17 or later since GoogleTest and GoogleMock require this.

### Q: Why do I see MSVC warnings C4301 or C4373 about overriding virtual functions with const parameters?

- This is a known MSVC compiler bug regarding top-level const on parameters, which is ignored in C++. Remove `const` from parameter declarations in both the interface and the mock class.
- For pointer or reference parameters, `const` is meaningful and should be preserved.

---

## 2. Linking Problems

### Q: My tests fail linking due to unresolved symbols related to GoogleMock mocks or main functions.

- Make sure you link against both GoogleTest and GoogleMock libraries.
- When using CMake, include:
  ```cmake
  find_package(GTest REQUIRED)
  target_link_libraries(my_test PRIVATE GTest::gtest_main GTest::gmock)
  ```
- If using provided `gtest_main` or `gmock_main` libraries, confirm linking against them.
- Check that your build system is using consistent compiler flags across compilation and linking stages.

---

## 3. Runtime and Test Execution Issues

### Q: I get warnings about "Uninteresting mock function call" during test runs. What does this mean?

- An *uninteresting call* happens when a mock method is called without any `EXPECT_CALL` set for it.
- This is not an error by default but a warning to alert you that you might have forgotten to specify expectations or oversaw this call.
- To silence warnings for these calls:
  - Use `NiceMock<T>` instead of raw mocks.
  - Add an `EXPECT_CALL` with `.Times(AnyNumber())` on the method.
- Avoid blindly adding `EXPECT_CALL` just to suppress the warning; focus on intention.

### Q: My test fails with an "Unexpected mock function call" error.

- This means your mock was called with arguments that do not match any existing `EXPECT_CALL`.
- Verify that you have declared expectations on the mock for these arguments.
- Check the order of `EXPECT_CALL`s, as the last matching expectation that fits the call will be applied.
- Using `--gmock_verbose=info` helps by printing detailed traces of calls and matched expectations.

### Q: What does "Too many actions specified in EXPECT_CALL" or "actions ran out" warning indicate?

- It means the number of `WillOnce()` actions specified is more than the expected number of calls or fewer actions are specified than calls made without a `WillRepeatedly()` provided.
- Ensure that the number of `WillOnce()` matches or is less than calls, and optionally provide a `WillRepeatedly()` action.

---

## 4. Diagnosing Expectation and Mock Object Issues

### Q: How can I verify that all expectations on a mock object have been satisfied before its destruction?

- Use:
  ```cpp
  Mock::VerifyAndClearExpectations(&mock_object);
  ```
- This forces verification and clears expectations, useful when mocks are heap allocated or managed by tested code.
- Returns a bool indicating success; failures can be handled with assertions.

### Q: How do I clean up mocks and their expectations properly between tests?

- Use:
  ```cpp
  Mock::VerifyAndClear(&mock_object);
  ```
- This verifies expectations and clears default actions.
- Avoid setting new expectations after clearing or verification to prevent undefined behavior.

### Q: Sometimes my mock object leaks on destruction. How to handle it?

- Use:
  ```cpp
  Mock::AllowLeak(mock_pointer);
  ```
- This informs GoogleMock to suppress leak detection for that object.
- Prefer this only for deliberately leaked mocks; generally avoid leaks.

---

## 5. Best Practices to Prevent Common Failures

- Always ensure all pure virtual functions in interfaces are mocked or overridden.
- Set expectations (`EXPECT_CALL`) before exercising the object to avoid undefined behavior.
- Use sequences (`InSequence`) or `After` to enforce call order where necessary.
- Use `RetiresOnSaturation()` when you want expectations to retire once their call limit is reached to avoid sticky expectations causing failures.
- When mocking overloaded methods, clarify overload resolution either with explicit matchers or `Const()` wrapper.
- Avoid overly restrictive matchers unless necessary—use `_` wildcard where argument values are not important.

---

## 6. Troubleshooting Steps

<Steps>
<Step title="Check Build Environment">
Verify compiler version supports C++17 and environment variables or build flags do not conflict.
</Step>
<Step title="Include Proper Headers">
Ensure `#include <gmock/gmock.h>` is present in mock definitions.
</Step>
<Step title="Validate Macro Usage">
Correctly use `MOCK_METHOD` with argument parentheses to wrap types having commas.
</Step>
<Step title="Inspect Linking Settings">
Confirm linking against GoogleTest and GoogleMock libraries.
</Step>
<Step title="Review Mock Expectations">
Ensure all expected calls are declared with proper arguments and ordering.
</Step>
<Step title="Run Tests with Verbose Output">
Use `--gmock_verbose=info` to gain detailed diagnostic messages.
</Step>
</Steps>

---

## 7. Additional Resources

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — Beginner-friendly introduction
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Detailed techniques and recipes
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html) — Quick reference for mocking
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — Full API specifications
- [Strict, Naggy, and Nice Mocks](https://google.github.io/googletest/concepts/strictness-modes.html) — Understanding mock strictness

---

This FAQ serves as a practical guide for common build and runtime issues faced during GoogleTest and GoogleMock integration, helping users achieve smooth and reliable test execution with comprehensive troubleshooting steps.