---
title: "How can I improve the performance of my test suite?"
description: "Covers actionable techniques for reducing test execution time, making use of parameterized and parallel tests, and managing test resources efficiently. Helps users scale their testing as project size grows."
---

# How can I improve the performance of my test suite?

Optimizing the performance of your GoogleTest test suite is crucial as your project grows, ensuring faster feedback, smoother development cycles, and efficient resource use. This page provides concrete, user-focused guidance on proven techniques to speed up test execution, manage resources effectively, and scale testing workloads.

---

## 1. Leverage Test Suite Shared Setup and TearDown

GoogleTest allows you to share expensive resources or setup across all tests in a test suite with `SetUpTestSuite()` and `TearDownTestSuite()`. By moving resource-intensive initialization and cleanup to these static methods, you avoid redundant setup for each test, reducing total execution time.

### Example Workflow:

```cpp
class FooTest : public testing::Test {
 public:
  static void SetUpTestSuite() {
    shared_resource_ = new ResourceExpensiveToCreate();
  }
  static void TearDownTestSuite() {
    delete shared_resource_;
    shared_resource_ = nullptr;
  }

 protected:
  static ResourceExpensiveToCreate* shared_resource_;
  void SetUp() override { /* per-test setup */ }
  void TearDown() override { /* per-test cleanup */ }
};

ResourceExpensiveToCreate* FooTest::shared_resource_ = nullptr;
```

**Benefits:**
- Initialization happens once before the first test.
- Cleanup occurs once after the last test.
- Tests remain independent but benefit from reused data.

### Best Practices:
- Keep shared resources immutable or restore state if mutable.
- Declare `SetUpTestSuite()` and `TearDownTestSuite()` as `public` if using `TEST_P` or `INSTANTIATE_TEST_SUITE_P`.

## 2. Use Parameterized and Typed Tests to Reach More Coverage with Less Code

Parameterized (`TEST_P`) and typed tests (`TYPED_TEST`) let you run the same tests multiple times with different inputs or types, effectively reducing boilerplate and speeding up test development.

- **Value-Parameterized Tests:** Run tests over different runtime values.
- **Typed Tests:** Run the same tests over a compile-time list of types.
- **Type-Parameterized Tests:** Define abstract test patterns and instantiate them with various types later.

### Quick Example: Value-Parameterized Test

```cpp
class MyTest : public testing::TestWithParam<int> {};

TEST_P(MyTest, HandlesVariousValues) {
  EXPECT_GT(GetParam(), 0);
}

INSTANTIATE_TEST_SUITE_P(
    PositiveValues, MyTest, testing::Values(1, 2, 3, 4, 5));
```

### Tips:
- Use `INSTANTIATE_TEST_SUITE_P` with `Values`, `ValuesIn` or `Combine` (for multiple arguments) to generate comprehensive yet concise test coverage.
- Define custom name generators to enhance clarity in test reports.

## 3. Run Tests in Parallel to Utilize Available CPU Cores

Speed test execution by running tests concurrently, typically in separate processes or threads.

### How to Use:
- Build your test executable with support for parallel runs (GoogleTest supports sharding via environment variables).
- Set environment variables:
  - `GTEST_TOTAL_SHARDS`: total number of parallel shards.
  - `GTEST_SHARD_INDEX`: shard index (0-based).
- Your test runner invokes the same executable multiple times with different shard indices.

### Benefits:
- Distributes test workload across machines or cores.
- Reduces total runtime proportionally to the number of shards.

### Considerations:
- Avoid shared mutable global state in tests to prevent flakiness.
- Some tests may require isolation or single-thread execution (e.g., tests interacting with global hardware).

## 4. Identify and Optimize Slow Tests

Track test runtime to find outliers and optimize or exclude them as needed.

### Techniques:
- Use GoogleTest's test result XML or JSON output with timing information (`--gtest_output=xml:<file>`).
- Sort or filter tests by elapsed time.
- Rewrite slow tests to minimize resource use or external dependencies.
- Consider splitting slow tests into smaller ones for better parallelization.

## 5. Avoid Unnecessary Test Execution

Use filtering and disabling features to run only what you need.

### Methods:
- **Filter Tests:** Run a subset with `--gtest_filter=TestSuite.TestName` to focus on relevant tests.
- **Disable Tests Temporarily:** Prefix test or test suite names with `DISABLED_` to skip them.
- **Skip Tests Programmatically:** Use `GTEST_SKIP()` in `SetUp()` or test bodies to skip tests dynamically.

## 6. Minimize Overhead in Setup and TearDown

- Avoid heavy operations in per-test `SetUp()`/`TearDown()` when they can be done once per suite.
- Prefer lightweight initialization for each test to keep per-test overhead low.

## 7. Share Code with Base Fixtures and Helper Functions

Reusing setup code in base fixtures reduces repetition and prevents costly reinitializations.

## 8. Use Listener API to Track and Profile Test Performance

Implement custom event listeners to log test timings and resource usage for further analysis and optimization strategies.

---

## Troubleshooting Common Performance Issues

### Symptoms and Diagnostics
- **Slow overall test run:** Check if resource-heavy setup is repeated per test.
- **Tests blocked or delayed:** Detect contention or dependency on shared external resources.
- **Flaky tests under parallel runs:** Check for shared mutable state.

### Remedies
- Refactor setup/tear-down to suite-level static methods.
- Isolate tests accessing shared external resources.
- Disable or move problematic tests to special suites.

---

## Additional Resources

- [GoogleTest Primer](../primer.md) — get a foundational grasp on test writing and fixtures.
- [Advanced GoogleTest Topics](../advanced.md) — deep dive into parameterized and typed tests.
- [Running Tests in Continuous Integration](../guides/test-automation-and-integration/running-tests-in-ci.md) — optimal setups for scaling test runs.
- [Performance Optimization and Scaling Guide](../guides/test-automation-and-integration/performance-optimization.md) — advanced strategies for large test suites.

---

For a practical demonstration, see the [typed test example in the test suite source](https://github.com/google/googletest/blob/main/googletest/samples/sample6_unittest.cc).

---

Implementing these strategies transforms your test suite into a scalable, maintainable, and efficient testing pipeline, accelerating development cycles and boosting developer productivity.

<Tip>
Regularly profile your tests and measure the impact of optimization changes to ensure you are improving overall performance without sacrificing test reliability.
</Tip>

<Note>
Use GoogleTest's XML or JSON output capabilities to gather detailed timing information across test suites for performance analysis.
</Note>
