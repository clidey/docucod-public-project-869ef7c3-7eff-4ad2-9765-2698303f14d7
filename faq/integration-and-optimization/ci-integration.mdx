---
title: "Integrating with CI/CD and External Tools"
description: "Step-by-step advice for connecting GoogleTest/GoogleMock to continuous integration pipelines such as GitHub Actions, or to third-party test runners. Covers environment variables, parallelization tools, and integration troubleshooting."
---

# Integrating with CI/CD and External Tools

GoogleTest and GoogleMock are designed to integrate smoothly into continuous integration (CI) pipelines such as GitHub Actions and support external test runners, enabling automated and scalable testing workflows. This page provides step-by-step guidance on connecting GoogleTest/GoogleMock to CI systems and third-party tools, focusing on practical user needs like environment setup, parallel test execution, and troubleshooting common integration issues.

---

## 1. Setting Up GoogleTest with Your CI Pipeline

### 1.1 Building Tests for CI

Ensure your CI environment includes a compatible C++17 compiler and a build system configured for GoogleTest and GoogleMock. Use CMake or Bazel configurations that your CI system can invoke as part of the build step.

- Use the CMake scripts to build tests, linking with the `gtest_main` or `gmock_main` libraries, which provide default `main()` entry points.
- Verify your CI environment installs any required dependencies like pthread where applicable.

### 1.2 Running Tests via Command Line

Invoke the test binary in your CI pipeline to run all tests automatically:

```bash
./your_test_binary --gtest_output=xml:test_report.xml
```

- The `--gtest_output=xml:` flag tells GoogleTest to generate an XML test result report in a format compatible with most CI systems.
- This enables your CI pipelines to capture, display, and archive test results easily.

### 1.3 Initializing Tests Programmatically

When writing your custom `main()` function, or if you embed tests in complex frameworks, initialize GoogleTest/GoogleMock properly:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv); // Initializes both GoogleMock and GoogleTest flags
  return RUN_ALL_TESTS(); // Executes all registered tests
}
```

This ensures command line flags are parsed properly, including those for test filtering and output.

---

## 2. Environment Variables and Configuration in CI

GoogleTest supports flags and environment variables to control test execution. Here are key ways to use them effectively:

- **Test filtering**: Use `--gtest_filter=TestSuiteName.TestName` to run specific tests.
- **Output format**: `--gtest_output=xml:<path>` for XML reports; also supports JSON in newer versions.
- **Repeat tests**: `--gtest_repeat=<count>` for flaky test detection.
- **Death tests in CI**: Special flags like `--gtest_death_test_style=threadsafe` may be required depending on the environment.

In GitHub Actions, you can expose these flags via environment variables or directly pass them in the test command.

<Tip>
Always ensure that your CI environment preserves the artifacts (e.g., XML reports) generated by GoogleTest to enable test result visualization and failure analysis.
</Tip>

---

## 3. Parallel Test Execution & Integration Helpers

### 3.1 Using gtest-parallel

To speed up test suites, especially large ones, use the open-source [`gtest-parallel`](https://github.com/google/gtest-parallel) tool:

- Runs tests in parallel processes to fully leverage multi-core machines.
- Supports test sharding and workload balancing.
- Compatible with test binaries built using GoogleTest and GoogleMock.

Example of running tests in parallel with an XML output:

```bash
gtest-parallel ./your_test_binary --output=xml --output_dir=ci_reports
```

### 3.2 Integration with Third-Party Test Runners

GoogleTest supports integration with test frameworks that can invoke external binaries or parse TAP output:

- Consider [GTest TAP Listener](https://github.com/kinow/gtest-tap-listener) if your test runner understands the TAP format.
- Use adapter plugins for IDEs (e.g., GoogleTest Adapter or C++ TestMate for Visual Studio Code) to run tests with ease, often usable in CI.

### 3.3 CI Tools and Workflows

Many CI providers, including Travis CI, CircleCI, and Jenkins, offer native plugins or steps for GoogleTest:

- Configure build steps to compile tests.
- Run tests capturing exit codes and outputs.
- Parse XML results to mark build success or failure.

GitHub Actions example snippet:

```yaml
steps:
  - uses: actions/checkout@v3
  - name: Build tests
    run: cmake --build build --target your_test_binary
  - name: Run tests
    run: ./build/your_test_binary --gtest_output=xml:test_results.xml
  - name: Upload test results
    uses: actions/upload-artifact@v3
    with:
      name: test-results
      path: test_results.xml
```

---

## 4. Debugging Integration Issues

### 4.1 Common Problems

- **Tests not running or discovered**: Ensure your tests are properly linked and registered via macros like `TEST()` or `TEST_F()`. Using `gmock_main` or `gtest_main` libraries handles this automatically.
- **No test output or results**: Confirm your test binary is executing and not being skipped by filtering or build errors.
- **XML report not generated**: Double-check the `--gtest_output=xml:<path>` flag and file write permissions in CI.
- **Parallel execution race conditions**: Use thread-safe death test styles and isolate tests appropriately.

### 4.2 Best Practices

- Always call `testing::InitGoogleMock()` (or `InitGoogleTest()`) with `argc` and `argv` to ensure proper flag parsing.
- Use assertion macros (`ASSERT_*` and `EXPECT_*`) consistently to flag failures correctly.
- Verify exit codes of test runs are propagated back to the CI system (GoogleTest returns 0 on success, 1 on failures).
- Cache and persist logs and reports to investigate flaky or failing tests post mortem.

### 4.3 Troubleshooting Workflow

<Steps>
<Step title="Confirm Build and Link Setup">
Ensure GoogleTest and GoogleMock libraries are correctly linked and the test binary includes main(). You can link against `gtest_main` or `gmock_main` for default main implementations.
</Step>
<Step title="Validate Command Line in CI">
Add verbose flags such as `--gtest_list_tests` to check test discovery and `--gtest_break_on_failure` to debug failing tests.
</Step>
<Step title="Check Permissions and Paths">
Validate that output directories exist and have write permissions for XML reports.
</Step>
<Step title="Use Local Runs Before CI">
Run tests locally with the same flags as CI to debug issues earlier.
</Step>
</Steps>

<Note>
Because GoogleTest was designed for flexible environments including embedded systems (see `gmock_main.cc` for platform conditional initialization), adapt initialization steps if working on non-standard platforms (e.g., ESP32 or Arduino).
</Note>

---

## 5. Summary & Further Resources

This page equips you with essential knowledge and concrete steps to integrate GoogleTest and GoogleMock into your CI/CD workflows and external test runners effectively. You'll learn to initialize test runs correctly, capture detailed output, accelerate testing through parallel execution, and troubleshoot common integration issues.

For a comprehensive overview of writing tests, building with CMake or Bazel, and using GoogleMock, refer to the following key documentation:

- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [Integrating with Build Systems](../guides/integration-and-best-practices/integrating-with-build-systems.md)
- [Continuous Integration & Test Automation](../guides/integration-and-best-practices/continuous-integration-automation.md)
- [gtest-parallel GitHub project](https://github.com/google/gtest-parallel)

Additionally, explore sample CI workflows available publicly for platform-specific configurations and test optimizations.

---

### Code Snippet Example: Minimal `main()` for CI-Compatible Tests

```cpp
#include "gmock/gmock.h"

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv); // Init Google Mock & Google Test
  return RUN_ALL_TESTS();               // Run all tests, return pass/fail
}
```

This boilerplate ensures your test executables are ready for any CI system.

---

### Related Documentation

- [GoogleTest User's Guide (docs/index.md)](/docs/index.md)
- [Testing Reference](../api-reference/core-test-api/testing.md)
- [GoogleMock README](../googlemock/README.md)
- [Integration Ecosystem](overview/architecture-features-integration/integration-ecosystem.md)
- [Performance and Scalability Guide](../guides/integration-and-best-practices/performance-and-scalability.md)

---

Explore these resources to deepen integration capabilities and optimize your testing pipelines.