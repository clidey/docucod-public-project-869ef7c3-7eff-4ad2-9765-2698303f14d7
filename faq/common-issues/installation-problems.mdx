---
title: "Installation and Setup Issues"
description: "Guidance for resolving problems encountered during the installation or initial setup of GoogleTest and GoogleMock, such as build failures, compiler compatibility, and missing dependencies. Includes actionable steps and pointers to supported compilers and platforms."
---

# Installation and Setup Issues FAQ

GoogleTest and GoogleMock offer powerful frameworks for C++ unit and mock testing, but installation and initial setup can sometimes pose challenges. This FAQ page focuses exclusively on the most common issues encountered during the build and setup phases, from environment prerequisites to compiler compatibility and dependency errors. Our goal is to guide you step-by-step toward resolving these issues, ensuring a smooth testing setup.

---

## 1. Common Installation Problems and Solutions

### Q: What platforms and compilers are supported for building GoogleTest and GoogleMock?

GoogleTest requires a C++ environment supporting C++17. Supported platforms include Linux, Windows, macOS, and some embedded systems. Commonly tested compilers are GCC (7.0+), Clang, MSVC (Visual Studio 2017+), and IntelLLVM. For detailed compiler versions and platform support, see the [Prerequisites & System Requirements](https://github.com/google/googletest/blob/main/getting-started/setup-requirements/prerequisites-system-requirements.md) guide.


### Q: What are the mandatory build tools and dependencies?

- **CMake 3.14 or later** is required for building with CMake, which is the most common build system.
- POSIX threading libraries are used for multithreaded tests (pthread on Unix, native Windows threads on Windows).
- Abseil and RE2 libraries are optional but can be enabled via the `GTEST_HAS_ABSL` option.

Make sure your system’s compilers and tools meet these requirements to avoid build failures.


### Q: Why am I encountering build failures related to compiler flags?

GoogleTest's CMake build system internally adjusts compiler and linker flags to ensure compatibility and strict warnings. If you use custom toolchains or override default flags, conflicts may arise.

**Solution:**
- Review the file `cmake/internal_utils.cmake` which tweaks flags per compiler.
- On Windows with MSVC, use the `gtest_force_shared_crt` CMake option to align C runtime linkage dynamically if your project requires it.
- Avoid overriding core flags like `/W4` and exception handling unless necessary.


### Q: What should I do if CMake does not find the GoogleTest package?

If you've installed GoogleTest manually or via a custom prefix, the CMake `find_package` command may fail.

**Solution:**
- Confirm that GoogleTest was installed with the `INSTALL_GTEST` option enabled.
- Ensure your CMake prefix paths include the location where GoogleTest is installed.
- Alternatively, embed GoogleTest sources directly in your project's build using `add_subdirectory()`.


## 2. Troubleshooting Build Failures

### Q: How do I build GoogleTest and GoogleMock using CMake?

A typical standalone build flow is:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
d
cd googletest
mkdir build
cd build
cmake ..  # Or use -DBUILD_GMOCK=OFF for only GoogleTest
make
sudo make install  # Optional system-wide installation
```

On Windows, you can generate Visual Studio projects using:

```powershell
cmake .. -G "Visual Studio 17 2022" -DCMAKE_CXX_STANDARD=17
```

Building issues usually stem from missing dependencies or incompatible compilers.


### Q: I am seeing linker errors related to pthread on Windows or MinGW.

GoogleTest's threading support expects native Windows threading APIs when built on Windows or MinGW.

**Solution:**
- Avoid forcing pthread support on MinGW, as it is unsupported.
- When using CMake, threading libraries are automatically handled, but custom build scripts must manually link to Windows thread libs.


### Q: How do I handle C++ standard version issues if my environment defaults to older versions?

GoogleTest mandates C++17 support.

**Solution:**
- Use `set(CMAKE_CXX_STANDARD 17)` and `set(CMAKE_CXX_STANDARD_REQUIRED ON)` in your `CMakeLists.txt`.
- Alternatively, pass compiler flags explicitly, such as `-std=c++17`.
- Verify your compiler version supports C++17 fully.


### Q: How can I build GoogleTest as a shared library (DLL) on Windows?

By default, GoogleTest builds as a static library. To build it as a shared library:

- Add `-DGTEST_CREATE_SHARED_LIBRARY=1` to your compiler flags when building GoogleTest.
- Link your tests with `-DGTEST_LINKED_AS_SHARED_LIBRARY=1`.

This ensures proper symbol export and dynamic linking. Certain compilers like GCC may require these flags even if not strictly necessary now.


## 3. Handling Missing Dependencies

### Q: What if Abseil or RE2 libraries are missing but I enabled `GTEST_HAS_ABSL`?

GoogleTest optionally uses Abseil and RE2 for enhanced utilities. When enabled, these libraries must be explicitly present.

**Solution:**
- Add Abseil (`absl::base`) and RE2 (`re2::re2`) to your build system separately before building GoogleTest.
- Use `find_package(absl REQUIRED)` and `find_package(re2 REQUIRED)` in your CMakeLists.
- Disable `GTEST_HAS_ABSL` if these libraries are not required or you cannot install them.


## 4. Best Practices and Tips

- Use the official CMakeLists.txt from the GoogleTest repository to leverage tested build configurations.
- When integrating GoogleTest into an existing CMake project, consider adding it as a subdirectory rather than relying solely on installed packages to ensure compiler/linker flag compatibility.
- Use `pkg-config` files generated by GoogleTest (`gtest.pc`) to simplify flags integration if your build system supports it. See [Using pkg-config](https://github.com/google/googletest/blob/main/docs/pkgconfig.md) for examples.
- On Windows, watch for runtime library mismatches and use `gtest_force_shared_crt` to harmonize linking.


## 5. Example: Windows Presubmit Build

A reference example for automating builds on Windows is shown in `ci/windows-presubmit.bat`, which:

- Sets up environment variables for Python, Bazel, CMake, and CTest.
- Creates a dedicated CMake build directory.
- Runs CMake with Visual Studio 2022 generator, enabling C++17.
- Builds all targets and runs CTest with parallel execution.
- Cleans up after completion.

This batch script demonstrates common flags and environment setups to avoid common pitfalls.


## 6. Troubleshooting Summary

<AccordionGroup title="Common Troubleshooting Areas">
<Accordion title="Build Fails with Compiler Errors or Warnings">
- Verify your compiler supports C++17.
- Use supported compilers listed in prerequisites.
- Check for conflicting flags, e.g., multiple runtime library specifications.
- Use `gtest_force_shared_crt` on Visual Studio to match runtime linking.
</Accordion>
<Accordion title="CMake Cannot Find GoogleTest">
- Make sure you installed GoogleTest with `INSTALL_GTEST` enabled.
- Add the install prefix to your `CMAKE_PREFIX_PATH`.
- Use `add_subdirectory()` for in-tree builds.
</Accordion>
<Accordion title="Linker Errors Involving Pthread or Threading Libraries">
- Do not enable pthread on MinGW.
- Verify threading libraries are linked when using custom builds.
- Ensure `-pthread` is added on Linux when not using CMake.
</Accordion>
<Accordion title="Runtime Crashes After Setup">
- Check for runtime library mismatches between your project and GoogleTest.
- Consistently use static or shared CRT across libraries.
- Align compile options for exception handling and RTTI.
</Accordion>
</AccordionGroup>

---

## Related Documentation

* [Installation & Setup Guide](https://github.com/google/googletest/blob/main/guides/getting-started/installation-setup.md) – step-by-step installation instructions.
* [Prerequisites & System Requirements](https://github.com/google/googletest/blob/main/getting-started/setup-requirements/prerequisites-system-requirements.md) – detailed platform and compiler requirements.
* [Integration with CMake and Bazel](https://github.com/google/googletest/blob/main/guides/integration-optimization/build-system-integration.md) – best practices for build systems.
* [pkg-config Integration](https://github.com/google/googletest/blob/main/docs/pkgconfig.md) – use pkg-config for easier compiler flag management.

---

<Check>
Before you start, verify your compiler supports C++17 and that your environment variables like `CMAKE_PREFIX_PATH`, `PKG_CONFIG_PATH`, and runtimes are properly configured to avoid common build failures.
</Check>

<Tip>
If you encounter persistent issues on Windows related to the C runtime library, toggle the `gtest_force_shared_crt` option to ensure linkage compatibility with your main project.
</Tip>

<Tip>
When building GoogleTest inside your CMake project, using `add_subdirectory(googletest)` ensures consistent builds and reduces dependency headaches compared to separately installed libraries.
</Tip>


---

By following these steps and recommendations, you can confidently diagnose and resolve typical installation and setup issues with GoogleTest and GoogleMock, enabling you to focus on developing robust test suites.
