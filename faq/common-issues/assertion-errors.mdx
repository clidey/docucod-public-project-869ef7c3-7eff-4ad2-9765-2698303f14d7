---
title: "Assertion Failures and Error Messages"
description: "Explains how to interpret and resolve assertion failures, including cryptic error messages and failed expectations. Provides sample outputs and clarification on assertion syntax."
---

# Assertion Failures and Error Messages

This page explains how to interpret and resolve assertion failures in GoogleTest. It covers why error messages appear the way they do, clarifies the syntax of assertions, and provides sample outputs with guidance for common scenarios.

---

## Understanding Assertion Failures

An **assertion failure** in GoogleTest indicates that a test has detected an unexpected condition — e.g., a value inequality, a false predicate, or an exception mismatch.

GoogleTest's assertion macros provide detailed diagnostics by showing:

- The **expression** that was tested (e.g., `x == y`).
- The **actual values** that caused the failure.
- If applicable, a **diff** for multi-line strings or arrays.
- Any **user-provided failure messages** appended via streaming (`<<`).

### Fatal vs Nonfatal Failures

- `ASSERT_*` macros produce **fatal failures** that abort the current function immediately.
- `EXPECT_*` macros produce **nonfatal failures**, letting the function continue execution.

Both failure types generate error messages in similar formats.

---

## Common Assertion Macros and What Failures Look Like

### Equality and Inequality Checks

- `EXPECT_EQ(val1, val2)` tests if `val1 == val2`.
- On failure, GoogleTest prints the expressions and their evaluated values:

```none
Expected equality of these values:
  val1
    Which is: 5
  val2
    Which is: 6
```

- `EXPECT_NE(val1, val2)` checks inequality and reports failures similarly.

### Boolean Conditions

- `EXPECT_TRUE(condition)` expects `condition` to be true.
- On failure, the message shows the expression, actual value, and any streamed explanation:

```none
Value of: 2 < 3
  Actual: false
Expected: true
```

### String Comparisons

- `EXPECT_STREQ(str1, str2)` compares C strings by value.
- Failures print both strings:

```none
Expected equality of these values:
  "foo"
  "bar"
```

- `EXPECT_STRNE`, `EXPECT_STRCASEEQ`, and `EXPECT_STRCASENE` work similarly with variations on case sensitivity.

### Floating-Point Comparisons

- Use `EXPECT_FLOAT_EQ()`, `EXPECT_DOUBLE_EQ()` for approximate equality based on Units in Last Place (ULPs).
- `EXPECT_NEAR(val1, val2, abs_error)` verifies values are within an absolute tolerance.

Failures show the difference and expected bounds:

```none
The difference between 1.0 and 1.5 is 0.5, which exceeds 0.25
```

### Exception Assertions

- `EXPECT_THROW(statement, ExceptionType)` verifies that `statement` throws the expected exception.
- `EXPECT_NO_THROW(statement)` verifies that `statement` does not throw any exception.
- `EXPECT_ANY_THROW(statement)` verifies that `statement` throws an exception of any type.

Failure messages describe expected and actual behavior in readable sentences.

---

## Understanding Failure Message Components

### Expression Display

GoogleTest shows the original source expressions used in the assertion, so you can pinpoint which part failed.

Example:

```none
Expected: Foo() == 5
  Actual: 3 vs 5
```

### Value Display

When possible, actual values are printed alongside the expressions to clarify what the code computed.

### String and Container Diffs

For multi-line strings or array-like containers, GoogleTest computes a **unified diff** highlighting insertions, deletions, and replacements to aid diagnosing subtle mismatches.


Example diff excerpt (lines starting with "-" are in the expected but not actual, and lines starting with "+" are in the actual but not expected):

```diff
@@ -1,5 +1,6 @@
 1
-2XXX
+2
 3
+4
 5
 6
@@ -7,8 +8,6 @@
 8
 9
-10
 11
-12XXX
+12
 13
 14
-15
```

### User-Provided Messages

You can append custom payloads to assertions with `<<`. These appear under GoogleTest's diagnostic message and help with contextualizing failures.

Example:

```cpp
EXPECT_EQ(x, y) << "Vectors differ at index " << i;
```

---

## Sample Failure Outputs and Explanation

### Simple Equality Failure

```
path/to/my_test.cc:45: Failure
Expected equality of these values:
  ComputeAnswer()
    Which is: 42
  43
```

- The assertion on line 45 expected `ComputeAnswer()` to equal 43.
- Actual value was 42.

### Boolean Assertion Failure

```
path/to/example.cc:27: Failure
Value of: is_ready()
  Actual: false
Expected: true
```

- `EXPECT_TRUE(is_ready())` failed: `is_ready()` returned false instead of true.

### String Comparison Failure

```
foo/test.cc:30: Failure
Expected equality of these values:
  expected_string
  actual_string
```

Use `EXPECT_STREQ` to compare C strings by value rather than pointer identity.

### Floating Point Failure with Absolute Error

```
math_test.cc:78: Failure
The difference between 1.0 and 1.5 is 0.5, which exceeds 0.25
```

You likely want to increase the allowed tolerance or use `EXPECT_DOUBLE_EQ` for approximate comparisons.

### Exception Assertion Failure

```
exception_test.cc:54: Failure
Expected: FunctionThatThrows() throws an exception of type std::runtime_error.
  Actual: it throws a different type.
```

Make sure the thrown exception type matches the expected one exactly.

---

## Tips and Best Practices for Debugging Assertion Failures

- **Examine printed expressions and their actual values carefully** to spot logic or calculation errors.
- For string and container mismatches, use diff output to quickly spot discrepancies.
- Use **custom failure messages** to add helpful context, especially in loops or parameterized tests.
- If you get cryptic failures due to type mismatches, double-check assertion macros and data types.
- Use `SCOPED_TRACE` to add trace points inside helper functions to locate nested failures.
- Remember that **fatal failures (`ASSERT_*`) abort current function**, so any cleanup code after them will not run.
- Use nonfatal assertions (`EXPECT_*`) when you want to continue testing after a failure to discover further issues.

---

## Decoding Cryptic or Unusual Failure Messages

### Pointer Equality vs Value Equality

- If you use `EXPECT_EQ` or `ASSERT_EQ` on C strings (`const char*`), the macro compares pointers (addresses), not string contents.
- Use `EXPECT_STREQ` or `ASSERT_STREQ` for content equality of C strings.

### Floating-Point Comparison Errors

- Don't use `EXPECT_EQ` on floating-point numbers.
- Use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR`.
- Differences are reported carefully including the reason why they failed (e.g., too large difference).

### Null Pointer Checks

- Prefer to use `EXPECT_EQ(ptr, nullptr)` rather than `EXPECT_EQ(ptr, NULL)`.

### Macro Usage Pitfalls

- Assertion macros evaluate their arguments exactly once, but the order of evaluation is undefined.
- Avoid writing assertions that depend on side effects in arguments.

### Thread Safety and Concurrency

- GoogleTest assertions are thread-safe on most supported platforms, but be cautious if your tests involve multiple threads.

---

## Advanced Topics

For deep debugging and customized failure messages:

- Use **predicate assertions** (`EXPECT_PRED*`) to write assertions that print argument values on failure.
- Use **predicate-formatter assertions** (`EXPECT_PRED_FORMAT*`) for custom failure text beyond the default.
- Use **`ASSERT_EXIT`** and **death test macros** to verify code that terminates unexpectedly.

See related documentation for predicate assertions, death tests, and custom matchers.

---

## Troubleshooting Assertion Failures

<AccordionGroup title="Troubleshooting Assertion Failures">
<Accordion title="Assertion Fails but Output is Unclear">
Use `EXPECT_PRED_FORMAT` with custom printers or `SCOPED_TRACE` to improve context.
</Accordion>
<Accordion title="Tests Appear to Fail Without Trace">
Check whether failures happen in helper functions where tracing may be missing.
</Accordion>
<Accordion title="Assertion Causes Fatal Failure and Aborts Test Early">
Switch to `EXPECT_*` variants if you want continued testing despite failures.
</Accordion>
<Accordion title="Confusing Pointer Comparisons in Assertions">
Use string-specific macros like `EXPECT_STREQ` and avoid `EXPECT_EQ` on pointers.
</Accordion>
</AccordionGroup>

---

## Additional Resources

- [Assertions Reference](reference/assertions.md) — complete list of assertion macros
- [GoogleTest Primer](docs/primer.md) — beginner-friendly introduction
- [Advanced GoogleTest Topics](docs/advanced.md) — detailed assertions and test design
- [Test and Fixture Declarations](docs/reference/testing.md) — how to declare tests
- [Test Discovery & Execution](guides/getting-started/test-discovery-execution.mdx)

---

_This page focuses exclusively on interpreting and resolving assertion failures. For overall strategies on test writing or mocking, please refer to other guides in the documentation._
