---
title: "Installation and Build Problems"
description: "Clear guidance for resolving difficulties during installation and building of GoogleTest/GoogleMock on various platforms and toolchains. This page covers compiler requirements, C++ standard support, and integration with build systems like CMake and Bazel."
---

# Installation and Build Problems FAQ

This FAQ page provides clear, actionable guidance on resolving installation and build difficulties when integrating GoogleTest and GoogleMock. It focuses specifically on compiler requirements, C++ standard support, and working with popular build systems like CMake and Bazel. Whether you are building GoogleTest standalone, embedding it in your project, or encountering toolchain-specific challenges, this guide will help you overcome common issues.

---

## Frequently Asked Questions

### 1. What are the minimum compiler requirements for building GoogleTest and GoogleMock?

GoogleTest requires a compiler with full C++17 support. Ensure your compiler version meets the minimum requirements for C++17. Check your compiler documentation or run the following to verify:

```sh
$ g++ --version   # GCC version 7.0 or newer recommended
$ clang++ --version  # Clang 5.0 or newer recommended
$ cl.exe           # Visual Studio 2017 or newer
```

Attempting to build with unsupported compilers or older C++ standards will result in errors.

### 2. How do I build GoogleTest and GoogleMock as standalone projects using CMake?

Follow this typical workflow:

```sh
# Clone the repository targeting a stable version
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build

# Generate build files with GoogleMock included (default)
cmake ..

# Alternatively, disable GoogleMock if not needed
cmake .. -DBUILD_GMOCK=OFF

# Build the project
make

# Install (optional, requires admin privileges)
sudo make install
```

On Windows, open the generated `gtest.sln` in Visual Studio and build there. On Mac OS X, use the `.xcodeproj` file.

### 3. Can I use GoogleTest and GoogleMock inside my existing CMake project?

Yes. There are two main ways:

- **Find the installed package:** Use `find_package(GTest CONFIG REQUIRED)` and link targets `GTest::gtest` and/or `GTest::gmock`.

- **Add GoogleTest as a subdirectory:** Add GoogleTest source code to your project and include it with `add_subdirectory()`. This ensures consistent compiler and linker flags across your project and GoogleTest, avoiding compatibility issues such as debug vs release runtime mismatches.

Example snippet to include via FetchContent in your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Visual Studio dynamic runtimes
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

### 4. What do I need to know about C++ standard versions and flags?

GoogleTest mandates building with **C++17** support enabled. You should set this in your CMake configuration:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

If you cannot control the project-level setting (e.g., in a C project), you may pass compiler flags explicitly using `-DCMAKE_CXX_FLAGS`.

Failing to use C++17 will cause build errors due to usage of features like `std::string_view`.

### 5. How do I handle threading support and pthreads?

GoogleTest is thread-safe on platforms with pthread support. The build system tries to detect pthread availability and links against it automatically.

If pthread detection fails in your environment (e.g., MinGW on Windows), you can force it with the following compiler defines:

```sh
-DGTEST_HAS_PTHREAD=1
# or to disable
-DGTEST_HAS_PTHREAD=0
```

When pthread support is enabled, ensure your compiler and linker flags include the pthread library (CMake typically manages this).

### 6. How to resolve Visual Studio runtime library conflicts?

By default, Visual Studio projects use dynamic C runtime (/MD), but GoogleTest defaults to static CRT (/MT). This mismatch leads to linker errors like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug'
```

To fix this, enable `gtest_force_shared_crt` in your CMake configuration:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This forces GoogleTest to link against the dynamic runtime, matching your project setting.

### 7. Can I build GoogleTest and GoogleMock as shared libraries?

Yes. By default, GoogleTest is built as a static library for simplicity. To build shared libraries (DLLs on Windows), enable the standard CMake option:

```cmake
-D BUILD_SHARED_LIBS=ON
```

Additionally, ensure you add the following compile definitions when building GoogleTest and your tests:

```
-DGTEST_CREATE_SHARED_LIBRARY=1  # when building the library
-DGTEST_LINKED_AS_SHARED_LIBRARY=1  # when building tests
```

This setup will also produce shared GoogleMock libraries if `BUILD_SHARED_LIBS` is on.

### 8. What can I do if my build fails due to macro name clashes?

GoogleTest defines assertion macros like `TEST`, `ASSERT_EQ`, which may clash with other libraries defining the same names. To avoid clashes, you can tell GoogleTest to rename these macros by defining control macros on the compiler command line:

```sh
-DGTEST_DONT_DEFINE_TEST=1
```

For example, after this, you must use `GTEST_TEST` instead of `TEST`:

```c++
GTEST_TEST(MyTestSuite, MyTest) { ... }
```

Similar macros exist for other GoogleTest assertions. This helps avoid macro collisions in complex builds.

### 9. How do I build GoogleTest/GoogleMock using Bazel?

While this page mainly covers CMake, GoogleTest and GoogleMock provide Bazel build files. You can build and run tests with Bazel using typical commands:

```
bazel build //googletest:all
bazel test //googletest:all
```

Check [Installation with Bazel](/getting-started/prerequisites-installation/installation-bazel) for detailed instructions.

### 10. What are common pitfalls during build and how to avoid them?

- **Mixing debug and release runtime libraries** causes linker errors — fix by aligning your project and GoogleTest compilation options.
- **Insufficient C++ standard**: GoogleTest requires C++17 minimum.
- **Pthread detection failures**: explicitly define `GTEST_HAS_PTHREAD` as needed.
- **Missing compiler flags**: Use CMake’s `set(CMAKE_CXX_STANDARD 17)` and `gtest_force_shared_crt` as needed.
- **Wrong macro usage**: If macro conflicts, use the `DGTEST_DONT_DEFINE_*` flags and fully qualified macro names.

---

## Troubleshooting and Tips

<AccordionGroup title="Troubleshooting Installation and build issues">
<Accordion title="GoogleTest build errors about C++ version or missing features">
Ensure your compiler supports C++17 and that your build system enables it. In CMake, use:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Verify compiler version compatibility.
</Accordion>

<Accordion title="Runtime Library mismatch on Visual Studio linking">
If you get errors like LNK2038 about 'RuntimeLibrary' mismatch, add to your project’s CMakeLists:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This sets GoogleTest to use dynamic CRT matching your project.
</Accordion>

<Accordion title="Pthread-related link errors on *nix platforms">
GoogleTest attempts to link pthread when available. If you see linker errors about pthread, explicitly provide linker flags:

```sh
-lpthread
```

Or use CMake’s Threads package:

```cmake
find_package(Threads REQUIRED)
target_link_libraries(your_target Threads::Threads)
```
</Accordion>

<Accordion title="Macro name conflicts with other libraries">
If other libraries define macros like TEST or ASSERT_EQ that clash with GoogleTest's, disable conflicting macros with compiler defines:

```sh
-DGTEST_DONT_DEFINE_TEST=1
```

Then, use fully qualified macro names like `GTEST_TEST()` instead of `TEST()`.
</Accordion>

<Accordion title="Building only GoogleTest without GoogleMock">
Pass the option:

```sh
cmake .. -DBUILD_GMOCK=OFF
```

to skip building GoogleMock sources when only GoogleTest framework is needed.
</Accordion>
</AccordionGroup>

---

## Best Practices and Recommendations

- **Embed GoogleTest sources via `add_subdirectory()` in CMake** to ensure consistent compiler flags across your project and tests.
- **Use `gtest_main` or `gmock_main` libraries** to avoid writing your own main function.
- **Always specify C++17 or later** when setting up your build.
- **Enable `gtest_force_shared_crt` on Windows** unless you have a specific reason otherwise.
- **Avoid multiple invocations of `RUN_ALL_TESTS()`** in your code, as it can cause undefined behavior.
- **Check your environment supports pthreads or force correct flags.**

---

## Additional Resources

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — Introduction and example usage.
- [System Requirements](https://example.com/getting-started/prerequisites-installation/system-requirements) — Verify environment compatibility.
- [Installing with CMake](https://example.com/getting-started/prerequisites-installation/installation-cmake) — Step-by-step CMake install guide.
- [Installing with Bazel](https://example.com/getting-started/prerequisites-installation/installation-bazel) — For Bazel users.

---

If you continue to face issues, consult the [Troubleshooting Common Issues](https://example.com/getting-started/validation-troubleshooting/common-issues) page for targeted solutions.

---

This page is part of the FAQ's [Common Issues & Troubleshooting](https://example.com/faq/common-issues/installation-build-problems) section.

For integration details, see [Integration & Ecosystem Overview](https://example.com/overview/architecture-features-integration/integration-overview).

