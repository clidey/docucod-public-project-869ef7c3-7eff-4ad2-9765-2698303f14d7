---
title: "How can I make my test suite run faster?"
description: "Recommends strategies to accelerate tests, such as parallel execution, selective run options, and efficient test design patterns. Helps teams and individuals minimize test latency."
---

# How can I make my test suite run faster?

This page provides practical strategies to accelerate your GoogleTest and GoogleMock test suites, enabling you to minimize test latency and improve developer productivity. Whether you are working individually or as a team, these recommendations will help you optimize test execution and maintain fast feedback loops.

---

## 1. Run Tests in Parallel

GoogleTest supports executing tests in parallel, which can drastically reduce the total runtime of your test suite, especially on multi-core machines or CI environments.

### How to Enable Parallel Execution

- Run your tests with the `--gtest_parallel` flag or use test runners that support parallelization.
- Alternatively, use build system features (e.g., CMake's `ctest`) to execute multiple test binaries or test shards concurrently.

### Benefits

- Multiple test cases or test binaries execute simultaneously.
- Maximizes CPU utilization.
- Significantly reduces wall-clock test time.

### Tips

- Ensure your tests are thread-safe and independent, especially when using shared resources.
- Use fixtures and setup/teardown wisely to isolate tests.

## 2. Selectively Run Tests Using Filtering Options

Instead of running the entire test suite every time, focus on running specific subsets of tests relevant to your recent changes.

### Use `--gtest_filter` Flag

- Run only tests matching the specified pattern.
- Example:

```bash
./my_tests --gtest_filter=MyTestSuite.*
```

- Exclude tests by prefixing with a minus sign:

```bash
./my_tests --gtest_filter=-FlakyTestSuite.*
```

### Combine with Other Flags

- Use alongside `--gtest_repeat` for repeated runs of critical tests.
- Combine with parallel execution to run filtered tests faster.

### Best Practices

- Regularly maintain your test filters to ensure coverage and avoid missing critical tests.
- Use meaningful test naming to enable precise selection.

## 3. Optimize Mock Usage in Tests

GoogleMock is powerful but can add overhead if not used efficiently. Following best practices can speed up test execution.

### Use `ON_CALL` for Default Behavior

- Define common mock behaviors in fixtures using `ON_CALL` without strict expectations.
- Only use `EXPECT_CALL` when you need to explicitly verify interaction.

### Avoid Overly Strict or Numerous Expectations

- Excessive use of expectations increases overhead.
- Keep expectations focused and meaningful to avoid slowing down tests.

### Leverage `NiceMock` and `StrictMock` Judiciously

- Use `NiceMock` to suppress uninteresting call warnings and avoid test clutter.
- Reserve `StrictMock` for critical interactions.

### Delegate Calls to Fakes or Real Objects If Needed

- Delegate mock behavior to a fake or real implementation to save effort.
- This can simplify mocks and improve performance.

## 4. Design Efficient and Isolated Tests

Writing tests that are quick to execute and do not impact each other is key.

### Isolate Test Fixtures

- Use lightweight setup/teardown steps.
- Favor `TEST_F` fixtures over heavy global setup.

### Avoid External Dependencies

- Mock file systems, networks, databases.
- Keep tests deterministic and fast.

### Minimize Expensive Operations

- Cache or reuse large data.
- Avoid redundant computations.

## 5. Use Test Suite Organization and Test Order Controls

GoogleTest lets you organize and control test execution order to optimize runtime.

### Group Related Tests

- Structure tests into logical suites.
- Run only relevant suites in certain CI jobs.

### Control Test Execution Order

- Use `InSequence` or custom ordering to reduce test setup conflicts.

## 6. Profile and Incrementally Optimize

Regularly measure your test performance to identify bottlenecks.

### Profiling Tools

- Use `time`, `perf`, or platform-specific profilers.
- Analyze slow tests and mocks.

### Incremental Improvements

- Focus on tests that take the longest.
- Reduce flakiness and retries.

---

## Troubleshooting Common Performance Issues

- **Tests too slow?** Look for heavy fixtures, external dependencies.
- **Mocks causing overhead?** Simplify or delegate behaviors.
- **Parallel runs flaky?** Check for shared static/global state.
- **Linking large mock classes slows build?** Move mock class constructors/destructors to `.cc` files.

---

## Example: Running Tests Fast with Filtering and Parallel Execution

```bash
# Run all tests in parallel with up to 8 concurrent jobs
./my_tests --gtest_workers=8

# Run only tests in FooSuite related to initialize or cleanup
./my_tests --gtest_filter=FooSuite.Initialize*:*Cleanup*

# Run filtered tests in parallel shards (e.g., with Bazel or custom runner)
bazel test //myproject:tests --test_arg=--gtest_filter=MyTest.* --test_sharding_strategy=dynamic
```

---

## Further Reading and Useful Links

- [GoogleTest Running Tests and Interpreting Results](https://github.com/google/googletest/blob/main/docs/guides/getting-started/running-tests-and-interpreting-results.md) — Learn about filtering and running tests effectively.
- [Building Test System and Build System Integration](https://github.com/google/googletest/blob/main/docs/guides/practical-integrations/build-system-integration.md) — Integration approaches that affect speed.
- [Mocking with GoogleMock](https://github.com/google/googletest/blob/main/docs/guides/advanced-testing/mocking-with-googlemock.md) — Best practices for mocks.
- [Performance Tuning and Optimization](https://github.com/google/googletest/blob/main/docs/guides/practical-integrations/performance-tuning.md) — Dive deeper into performance strategies.

---

<Tip>
  Accelerate your tests by combining parallel execution with focused filtering.
  Remember that efficient, isolated tests and responsible mock usage lay the foundation for scalability.
</Tip>

<Note>
  When using mock expectations (`EXPECT_CALL`), avoid over-constraining calls to prevent brittle and slow tests. Use `ON_CALL` and `NiceMock` to reduce the overhead of uninteresting calls.
</Note>
