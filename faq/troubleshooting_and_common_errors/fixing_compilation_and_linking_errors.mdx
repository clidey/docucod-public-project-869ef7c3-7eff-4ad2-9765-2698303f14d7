---
title: "Fixing Compilation and Linking Errors"
description: "Answers to the most common build, include-path, and linking failures users face, including C++ standard version mismatches and integration with existing build systems."
---

# Fixing Compilation and Linking Errors

GoogleTest and GoogleMock are powerful frameworks for C++ testing, but integrating them into your project can sometimes cause build issues. This FAQ page addresses the most common compilation, include-path, and linking problems, focusing on the typical user pain points such as compiler compatibility, standard mismatches, and build system integration.

---

## Frequently Asked Questions

### Why do I get compilation errors about C++ standard versions?

GoogleTest requires **C++17** or later to build successfully. If your compiler or build system is configured with an older standard (e.g., C++11 or C++14), you will encounter errors.

#### How to fix:
- Ensure that your compiler supports C++17.
- Set the C++ standard explicitly in your build system to C++17 or higher.
  - For CMake, add:
  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```
- If your build system overrides flags externally, verify that no conflicting flags disable or lower the standard.

<Tip>
Always confirm the compiler version and standard flags before starting your build. Mismatched standards are the root cause of many compile issues.
</Tip>

### I’m facing include path errors like "gmock/gmock.h" not found.

This usually means your compiler cannot locate GoogleMock's headers.

#### How to fix:
- Confirm you have downloaded or cloned the full GoogleTest repository, which includes GoogleMock.
- Make sure your build system includes GoogleMock's headers in its include search paths.
  - For CMake, add:
  ```cmake
  target_include_directories(your_target PRIVATE ${gmock_SOURCE_DIR}/include ${gmock_SOURCE_DIR})
  ```
- If you are using installed GoogleTest/GoogleMock, verify the installation location and adjust your include paths accordingly.

### Linking errors: unresolved symbols or duplicate symbols

Users often see linker errors related to GoogleMock and GoogleTest libraries.

#### Common causes:
- Missing linkage to GoogleMock and GoogleTest libraries.
- Mismatched linkage between static and shared libraries.
- Multiple definitions due to linking both static and shared versions simultaneously.

#### How to fix:
- Link your tests or executables against the required GoogleMock and GoogleTest libraries.
  - For CMake:
  ```cmake
  target_link_libraries(your_target gmock_main)
  ```
  This links GoogleMock along with the main function.
- Avoid linking both static and shared variants to prevent symbol duplication.
- If you build GoogleTest/GoogleMock with CMake, use the exported targets like `gmock`, `gmock_main`, `gtest`, or `gtest_main`.

<Note>
`gmock_main` includes main(), so link to it if you do not provide your own main function.
</Note>

### How do I properly build and run GoogleMock with CMake?

GoogleMock's CMake build is community-maintained and works on many platforms.

#### Basic workflow:
1. Clone the GoogleTest repository (includes GoogleMock):
    ```bash
    git clone https://github.com/google/googletest.git
    cd googletest
    mkdir build && cd build
    ```
2. Run CMake to configure:
    ```bash
    cmake ..
    ```
    By default, this builds GoogleMock and GoogleTest.
3. Build the libraries:
    ```bash
    make
    ```
4. Optionally install (may require admin permissions):
    ```bash
    sudo make install
    ```

#### In your project:
- Use `add_subdirectory` in your CMake build to include GoogleMock sources.
- Link your tests against `gmock_main` or `gmock` depending on whether you provide your own main.

### Sometimes I get warnings or errors about overriding methods not being virtual or about const qualifier mismatches in my mock classes. What's wrong?

This corresponds to C++ rules regarding virtual and const qualifiers on mocked methods.

#### How to fix:
- The methods to be mocked must be **virtual** unless you use advanced techniques (see mocking non-virtual methods in the gMock Cookbook).
- When mocking a const method, ensure the mock method is also qualified as const.
- Use the `override` qualifier in the mock methods to catch signature mismatches early.

For example:
```cpp
class Foo {
 public:
  virtual int GetValue() const = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
};
```

### I have multiple macros to mock methods and get errors about parsing arguments containing commas.

This is due to how `MOCK_METHOD` macro parses types with commas.

#### How to fix:
- Wrap complex types containing commas in an extra pair of parentheses:
```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
MOCK_METHOD(bool, CheckMap, ((std::map<int, double>), bool));
```
- Alternatively, use type aliases:
```cpp
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());
```

### How do I avoid errors related to linking GoogleMock and GoogleTest with different standard libraries or runtime libraries?

Mismatched runtime libraries or compiler flags cause linker errors.

#### How to fix:
- Ensure all parts of your project — GoogleMock, GoogleTest, your test code — are built with compatible compiler flags.
- For Visual Studio, be consistent with static vs dynamic CRT linkage:
  - Use `gtest_force_shared_crt` option if needed.
- Rebuild all libraries and your project after changing key compiler flags.

### Can I build GoogleMock and GoogleTest as shared libraries?

Yes, the CMake build supports this.

- Set `BUILD_SHARED_LIBS=ON` in CMake configuration to build shared libraries.
- Link your tests accordingly.

Beware that binary compatibility requires all dependent libraries to use the same shared/static conventions.

### What are some common pitfalls with build systems like CMake or Bazel?

- Missing dependencies on `pthread` or threading libraries cause build failures.
- Incorrect or missing include directories.
- Forgetting to set the C++ standard.

Refer to the sections on Integration and Compatibility in the documentation for detailed guidance.

---

## Troubleshooting Tips

- Use `--gmock_verbose=info` flag when running tests to get detailed logs on mock method calls.
- Confirm installed versions of compiler and CMake correspond to or exceed minimum requirements.
- If you encounter strange warnings or errors with Microsoft Visual C++, verify compiler and linker flag configurations.
- Check for multiple GoogleTest or GoogleMock installations that could cause conflicts.

---

## Additional Resources

- [GoogleMock CMakeLists.txt](googlemock/CMakeLists.txt) — Details on the CMake build script for Google Mock.
- [GoogleTest README](googletest/README.md) — Generic build instructions including CMake and standalone builds.
- [Legacy gMock FAQ](docs/gmock_faq.md) — Common error causes and resolutions from a testing perspective.
- [Integration & Compatibility](overview/architecture-key-concepts/integration-with-build-and-tools) — How GoogleTest and GoogleMock integrate with popular build systems.

---

## Sample CMake Integration Snippet

```cmake
# Add googletest/googlemock from source
add_subdirectory(path/to/googletest)

# Add your test executable
add_executable(my_test my_test.cpp)

# Link to gmock_main to include main()
target_link_libraries(my_test PRIVATE gmock_main)

# Specify C++17 standard explicitly
target_compile_features(my_test PRIVATE cxx_std_17)
```

---

By following these guidelines, you will avoid common build issues related to compilation, include paths, and linking, ensuring a smooth experience integrating GoogleTest and GoogleMock into your C++ projects.
