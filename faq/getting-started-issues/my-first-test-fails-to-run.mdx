---
title: "Why doesn't my first test compile/run?"
description: "Troubleshooting missteps when creating or running your initial test: header includes, correct macros, linking errors, C++17 requirement issues, and resolving missing symbol or main function errors."
---

# Why doesn't my first test compile/run?

When you are getting started with GoogleTest, encountering compilation or runtime issues on your first test is common. This page addresses typical challenges users face while creating or running their initial test, helping you troubleshoot and resolve them smoothly.

---

## Common Reasons Your First Test May Fail to Compile or Run

### 1. Missing or Incorrect Header Includes

- Ensure that you include the correct GoogleTest headers in your test files. The base minimal header for test macros and assertions is:

  ```cpp
  #include <gtest/gtest.h>
  ```

- For mocking functionality, include:

  ```cpp
  #include <gmock/gmock.h>
  ```

- Omitting or misspelling these headers leads to compilation errors such as "undefined macro" or "missing file" errors.

### 2. Using the Correct Test Macros

- Use `TEST()` or `TEST_F()` macros appropriately:

  - `TEST(TestSuiteName, TestName)` defines a simple, independent test.
  - `TEST_F(FixtureClassName, TestName)` uses a fixture class for common setup.

- Older macros like `TEST_CASE` or `TEST_CASE_F` or underscore-containing names are deprecated.

- Failing to use the correct macro causes unexpected compiler errors.

### 3. Linker Issues Due to Missing `main()`

- GoogleTest includes a default main function in the `gtest_main` library.

- If you link only with `gtest` and omit `gtest_main`, you must supply your own `main()`:

  ```cpp
  #include <gtest/gtest.h>

  int main(int argc, char** argv) {
    ::testing::InitGoogleTest(&argc, argv);
    return RUN_ALL_TESTS();
  }
  ```

- Without either linking `gtest_main` or defining this `main()`, linker errors like "undefined reference to main" occur.

### 4. Ensure Proper Linking to GoogleTest Libraries

- Verify your build system or compiler command line links against `gtest`, `gmock` (if used), and optionally `gtest_main`.

- For example, using `g++`:

  ```bash
  g++ my_test.cc -lgtest -lgtest_main -pthread -o my_test
  ```

- Using CMake, add GoogleTest target dependencies correctly via `target_link_libraries()`.

- Linking mistakes often cause unresolved symbols at link-time.

### 5. Compiler and Language Standard Requirements

- GoogleTest requires **C++17 or later** to compile and run correctly.

- If your compiler defaults to an earlier standard (e.g., C++11 or C++14), specify the language standard explicitly:

  ```bash
  g++ -std=c++17 my_test.cc -lgtest -lpthread
  ```

- Failing to set this can cause obscure errors related to language features.


### 6. Using the Correct Namespace

- GoogleTest classes and functions live in the `testing` namespace.

- You can refer to them explicitly:

  ```cpp
  testing::InitGoogleTest(&argc, argv);
  return testing::RUN_ALL_TESTS();
  ```

- Or bring the namespace into scope:

  ```cpp
  using namespace testing;
  ```

- Omitting namespace qualification can cause "symbol not found" or ambiguous errors.

---

## How GoogleTest's `main()` Works Behind the Scenes

GoogleTest offers a ready-to-use `main()` function via the `gtest_main` library. This function:

- Initializes the framework by parsing command-line arguments with `InitGoogleTest()`.
- Registers all tests defined via `TEST()` and `TEST_F()` macros.
- Runs all tests via `RUN_ALL_TESTS()`, returning `0` on success or `1` otherwise.

Your custom `main()` must:

- Call `testing::InitGoogleTest(&argc, argv);` before running tests.
- Return the value of `RUN_ALL_TESTS()`.

Here is an example of a minimal user-defined main for cases needing custom setup:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Failing to adhere to this requirement results in runtime errors or tests not executing.

---

## Troubleshooting Specific Compilation or Run-Time Errors

### Error: `'RUN_ALL_TESTS()' was not declared in this scope`

**Cause:** Missing `#include <gtest/gtest.h>`.

**Solution:** Add the missing include in your test file.

### Error: `undefined reference to 'main'`

**Cause:** You did not link against `gtest_main` and did not provide a `main()`.

**Solution:** Either link with `gtest_main` or write your own `main()` as shown above.

### Error: `symbol(s) not found for architecture x86_64` or `unresolved external symbol`

**Cause:** Incorrect linking or missing dependencies, or mixing incompatible runtime libraries.

**Solution:**

- Verify linking order and that you specify all needed libraries.
- Link with `-pthread` or equivalent for threading support.
- Ensure consistent compiler and standard version for all components.

### Compile Error: `‘nullptr’ was not declared in this scope`

**Cause:** Not using C++11 or later.

**Solution:** Use `-std=c++17` or later.

### Error: Incompatible compiler or missing features

**Cause:** Your compiler may be too old or not fully supporting C++17.

**Solution:** Upgrade your compiler or configure the right standard.

---

## Common Pitfalls and How to Avoid Them

### Mixing `TEST()` and `TEST_F()` within the same test suite

- GoogleTest requires all tests in the same test suite to use the same fixture type.
- Mixing these causes compilation or runtime errors.

### Naming Tests with Underscores

- Avoid using underscores (`_`) in test suite or test names.
- Use CamelCase or PascalCase.

### Forgetting to Return from `main()` Properly

- Always return the value from `RUN_ALL_TESTS()`; it reflects test success.

### Multiple Definitions or Missing Symbols for `RunAllTests()`

- Ensure single linkage of GoogleTest sources.

---

## Practical Tips & Best Practices for First Tests

- Start with a single simple test using `TEST()` macro.

- Use `EXPECT_*` assertions initially to allow failures to accumulate.

- Compile and run your test binary to verify setup before writing more tests.

- Use verbose compiler and linker output to identify missing dependencies.

- Consult GoogleTest's sample tests and primer for minimal working examples.

- Use an IDE or build system integration with GoogleTest support (like CMake) to simplify configuration.

---

## Example: Basic Test File and Build Command

```cpp
// my_first_test.cc
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
  EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run:

```bash
# Compile and link with threading support
# Link with GoogleTest and its dependencies
g++ -std=c++17 -pthread my_first_test.cc -lgtest -lgtest_main -o my_first_test

# Run the test binary
./my_first_test
```

You should see output indicating tests running and passing.

---

## Additional Resources

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — Learn the basics of test writing.
- [Testing Reference](https://github.com/google/googletest/blob/main/docs/reference/testing.md) — Detailed API information.
- [Troubleshooting Setup Issues](https://github.com/google/googletest/blob/main/docs/getting-started/project-setup-validation/troubleshooting-setup.md) — Broader troubleshooting guide.
- [Configuring Your Project](https://github.com/google/googletest/blob/main/docs/getting-started/project-setup-validation/configuring-project.md) — How to integrate GoogleTest into your build system.

---

<Tip>
If your first test isn't compiling or running, carefully check your includes, linkage, and ensure you have either linked with `gtest_main` or provided a `main()` function that calls `InitGoogleTest()` before `RUN_ALL_TESTS()`.
</Tip>

<Warning>
GoogleTest requires C++17 or later. Make sure your build system is set up to use this standard to avoid confusing compilation errors.
</Warning>

---

By addressing these common points, you will resolve the majority of problems related to your first test not compiling or running, and gain confidence in your initial GoogleTest setup.
