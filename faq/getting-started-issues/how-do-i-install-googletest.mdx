---
title: "How do I install and set up GoogleTest/GoogleMock?"
description: "Step-by-step guidance for installing GoogleTest and GoogleMock, including supported platforms, common build tools (CMake, Bazel), resolving environment/configuration errors, and verifying the installation is successful."
---

# How do I install and set up GoogleTest/GoogleMock?

GoogleTest (gTest) and GoogleMock (gMock) form a comprehensive C++ framework for unit testing and mocking, designed to improve the quality and maintainability of your code through automated, expressive tests. Setting up GoogleTest and GoogleMock involves preparing your system, building the libraries (usually via CMake or Bazel), integrating them into your projects, and verifying that your installation works correctly.

---

## Supported Platforms and Requirements

- **Platforms:** Linux, Windows Desktop, Mac OS X.
- **Compiler:** Requires a C++17-compatible compiler.
- **Threading:** GoogleTest is thread-safe on systems with pthread support. On other systems, thread safety is limited.

Ensure you have the necessary build tools installed, such as `git`, `CMake` (minimum version 3.14 for FetchContent support), and your platform’s native compiler.

See [System Requirements](https://github.com/google/googletest/blob/main/getting-started/prerequisites-installation/system-requirements.md) for detailed environment details.

---

## Installation Methods

### 1. Building from Source Using CMake (Recommended)

GoogleTest/GoogleMock comes with ready-to-use CMake build scripts.

#### Standalone Build Steps

<Steps>
<Step title="Clone the Repository">
Run:
```bash
git clone https://github.com/google/googletest.git -b v1.17.0
downloads the GoogleTest and GoogleMock sources at version 1.17.0.
```
</Step>
<Step title="Create and Enter Build Directory">
```bash
cd googletest
mkdir build
cd build
```
</Step>
<Step title="Generate Build Files">
To build **both GoogleTest and GoogleMock** (default):
```bash
cmake ..
```
To build **GoogleTest only**, disable gMock:
```bash
cmake .. -DBUILD_GMOCK=OFF
```
</Step>
<Step title="Build the Libraries">
```bash
cmake --build .
```
or simply
```bash
make
```
depending on your platform.
</Step>
<Step title="(Optional) Install Libraries">
On Unix-like systems if you have admin privileges:
```bash
sudo make install
```
This installs headers and libraries typically under `/usr/local/`.
</Step>
</Steps>

#### Incorporate Into Your Existing CMake Project

Use `FetchContent` or `find_package` for easy inclusion:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(mytests test1.cpp test2.cpp)
target_link_libraries(mytests gtest_main gmock_main)
add_test(NAME MyTest COMMAND mytests)
```

`gtest_force_shared_crt` ensures runtimes are linked dynamically on Windows to match your project.

---

### 2. Using Bazel

GoogleTest and GoogleMock are compatible with Bazel build systems. Add the appropriate `http_archive` or git rules and load the `googletest` dependencies.

Refer to the [Integration with Build & CI Systems](https://github.com/google/googletest/blob/main/overview/audience-usecases-integration/integration-points.md) and [Build System Integration Guide](https://github.com/google/googletest/blob/main/guides/integration-scenarios/build-system-integration.md) for concrete Bazel usage.

---

### 3. Package Managers

For some operating systems, prebuilt packages of GoogleTest exist (e.g., through `apt` on Ubuntu or `vcpkg` on Windows). Using these can simplify installation.

---

## Linking and Compiling Your Tests

- **Link against `gtest_main` and/or `gmock_main` libraries** to use the provided main function.
- If you want a custom `main()`, link against `gtest` and/or `gmock` libraries only.

Example CMake snippet:
```cmake
target_link_libraries(mytests gtest_main gmock_main)
```

Ensure consistent compiler flags for standard version (C++17) and pthread linkage if necessary:
- `-std=c++17` for the compiler
- `-pthread` for Linux linking if pthread is detected

---

## Verifying Your Installation

A minimal test helps ensure setup correctness.

Example test (`sample_test.cpp`):
```c++
#include "gtest/gtest.h"

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile linking with `gtest_main`:
```bash
g++ sample_test.cpp -lgtest_main -lgtest -lpthread -o sample_test
./sample_test
```

Successful output will indicate test run status and PASS result.

---

## Building and Running with GoogleMock

Because GoogleMock depends on GoogleTest, the build steps are similar.

You can also link with `gmock_main` which provides a main function initializing both GoogleMock and GoogleTest.

Custom main example (if needed):
```c++
#include "gmock/gmock.h"

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Example build with CMake:
```cmake
target_link_libraries(mytests gmock_main gtest_main)
```

Run the tests as usual.

---

## Common Setup Issues and How to Fix Them

<AccordionGroup title="Common Issues During Installation and Setup">
<Accordion title="C++17 Not Enabled or Unsupported Compiler">
Ensure your compiler flag includes `-std=c++17` or higher. GoogleTest 1.17.x requires at least C++17.
</Accordion>
<Accordion title="Linker Errors Related to pthread">
On Linux, ensure you link pthread libraries by adding `-pthread` or `-lpthread`.
If using CMake, this is usually automatic.
</Accordion>
<Accordion title="Runtime Errors: Missing main() Function">
Link your test binary with `gtest_main` or `gmock_main` to use the default main function.
If you supply your own main, make sure it calls `InitGoogleTest()` or `InitGoogleMock()` and `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="Symbol or Macro Conflicts">
GoogleTest defines many assertion macros. If macro clashes occur, use the `GTEST_DONT_DEFINE_*` flags to rename macros.
For example, compile with `-DGTEST_DONT_DEFINE_TEST=1` and use `GTEST_TEST()` instead of `TEST()`.
</Accordion>
<Accordion title="Visual Studio Runtime Library Mismatches">
Use the `gtest_force_shared_crt` CMake option to force GoogleTest to link against the dynamic runtime to match your project settings.
</Accordion>
</AccordionGroup>

---

## Best Practices

- Prefer linking with `gtest_main` or `gmock_main` to avoid writing boilerplate main functions.
- Use CMake `FetchContent` or `add_subdirectory()` for robust build integration.
- Always verify your tests with a minimal sample to confirm build correctness before scaling.
- Keep your compiler, build tools, and dependencies updated to maintain C++17 compatibility.

---

## Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — Introductory tutorial explaining test writing.
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md) — Overview and detailed info on mocking.
- [Installation Options](https://github.com/google/googletest/blob/main/getting-started/prerequisites-installation/installation-options.md) — More ways to install GoogleTest.
- [Building from Source](https://github.com/google/googletest/blob/main/getting-started/prerequisites-installation/building-from-source.md) — Extended build and configuration instructions.
- [Troubleshooting Setup Issues](https://github.com/google/googletest/blob/main/getting-started/project-setup-validation/troubleshooting-setup.md) — Help for common setup problems.

---

By following this guide, you'll confidently install and configure GoogleTest and GoogleMock, ensuring your C++ tests run smoothly across supported platforms and build environments.


---