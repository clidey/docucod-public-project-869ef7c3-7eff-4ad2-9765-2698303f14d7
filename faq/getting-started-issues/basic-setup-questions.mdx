---
title: "How do I set up and start using GoogleTest/GoogleMock?"
description: "Get information on installing, including, and configuring GoogleTest and GoogleMock in your project. Guidance covers the easiest way to add the framework to your build, initial test setup, and links to further documentation for both Bazel and CMake workflows."
---

# How do I set up and start using GoogleTest/GoogleMock?

Welcome to your first step in harnessing the power of GoogleTest and GoogleMock for C++ testing and mocking. This guide streamlines the process of installing, including, and configuring these frameworks in your project, helping you start writing and running tests with confidence. Whether your project uses Bazel or CMake, you'll find clear instructions and tips to get up and running.

---

## 1. Installing GoogleTest and GoogleMock

### 1.1 Choosing Your Build Approach

GoogleTest and GoogleMock can be integrated via several common build systems. The two most popular methods are:

- **Bazel**: Google's own build system, which supports native rules for `googletest` and `gmock`.
- **CMake**: Widely used cross-platform build system, with ready support to build and link these frameworks.

If your project already uses one of these, proceed accordingly. If not, CMake is a straightforward option to add.

### 1.2 Cloning the Repository

Obtain the source code:

```bash
  git clone https://github.com/google/googletest.git
  cd googletest
```

This repository contains both GoogleTest and GoogleMock.

### 1.3 Building with CMake

GoogleTest and GoogleMock are built together by default.

- To perform a standalone build:

```bash
  mkdir build
  cd build
  cmake ..
  make
```

- If you want to build only GoogleTest and exclude GoogleMock:

```bash
  cmake .. -DBUILD_GMOCK=OFF
  make
```

Installation is typically to `/usr/local/` by default, with `sudo make install`.

### 1.4 Building with Bazel

Add the following dependencies in your `BUILD` or `WORKSPACE` file:

```starlark
  # Load googletest dependencies
  load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")

  http_archive(
      name = "com_google_googletest",
      url = "https://github.com/google/googletest/archive/release-1.12.1.zip",
      sha256 = "093e45375bdebad766cf04c212c5cc75e2f7e05448fcf081589e777f8db00b53",
      strip_prefix = "googletest-release-1.12.1",
  )
```

Your tests can then declare dependencies on `@com_google_googletest//:gtest` or `@com_google_googletest//:gmock`.

## 2. Including GoogleTest and GoogleMock in Your Code

To write tests and mock objects:

- Include the main headers:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>
```

- For mocking features, ensure you include `gmock/gmock.h`.

## 3. Initializing and Running Tests

Your test executable must initialize the GoogleTest or GoogleMock framework before running tests.

### 3.1 Initialization Procedure

The initialization parses command-line arguments and sets up internal state. Use one of the following in your `main` function or equivalent:

For GoogleTest only:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

For GoogleMock (which includes GoogleTest):

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes both GoogleMock and GoogleTest
  return RUN_ALL_TESTS();
}
```

On embedded platforms (Arduino, ESP32, etc.), you use `setup()` and `loop()` functions accordingly.

### 3.2 Running Tests

After initialization, calls to `RUN_ALL_TESTS()` execute all registered tests.

You can run your test executable with optional filters and flags to select tests or control output verbosity.

## 4. Configuring Your Project Build

### 4.1 Using CMake

Add GoogleTest and GoogleMock to your `CMakeLists.txt` via `add_subdirectory` or `find_package`:

```cmake
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})

add_executable(my_tests test_mycode.cpp)
target_link_libraries(my_tests ${GTEST_LIBRARIES} pthread)
```

For integrated builds, use `add_subdirectory` for the googletest repo.

### 4.2 Using Bazel

Declare the `gmock` and `gtest` dependencies in `BUILD` and `WORKSPACE` as shown previously.

Your tests depend on these to link and compile correctly.

## 5. Next Steps

- Start writing your first test cases. See the guide: [Writing Your First Test](../getting-started/first-test-run-validation/writing-your-first-test.md).
- Learn how to create and use mock objects with GoogleMock. Reference: [Basic Mocking: Using GoogleMock](../guides/getting-started/mocking-basics.md).
- For advanced installation and configuration tips, check: [Installation & Initial Setup](../guides/getting-started/setup-installation.md).


## Additional Resources

- [GoogleTest Primer](../docs/index.md#googletest-primer) – Understand the testing basics.
- [Mocking Reference](./reference/mocking.md) – Comprehensive details on mock APIs.
- [gMock Cookbook](../docs/gmock_cook_book.md) – Practical recipes for mocking scenarios.
- [gMock Cheat Sheet](../docs/gmock_cheat_sheet.md) – Handy quick reference.

---

<Tip>
Initializing GoogleMock automatically handles GoogleTest initialization. Use `testing::InitGoogleMock()` when you plan to use mocks.
</Tip>

<Note>
Include `#include <gmock/gmock.h>` before using mocking macros and functions.
</Note>

<Warning>
Make sure to call `RUN_ALL_TESTS()` *after* initialization, or tests will not execute.
</Warning>

---

Embark on writing robust tests and confidently leveraging mocks to improve your C++ code quality and reliability.

---