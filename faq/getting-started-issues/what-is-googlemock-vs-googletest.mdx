---
title: "What's the difference between GoogleTest and GoogleMock?"
description: "Clarifies the relationship, usage, and integration between GoogleTest (core test framework) and GoogleMock (mocking extensions), and when/how to use each in your project."
---

# What's the difference between GoogleTest and GoogleMock?

This guide clarifies the relationship and usage distinctions between **GoogleTest** and **GoogleMock**, two integral components of the GoogleTest C++ testing framework. It explains when and how to use each tool in your project, highlighting their interaction and complementary roles.

---

## Overview

**GoogleTest** is the core C++ testing framework that provides a rich set of assertion macros, test discovery, execution, and result reporting. It enables developers to write unit and integration tests with expressive failure diagnostics.

**GoogleMock** (often abbreviated as gMock) is an extension built on top of GoogleTest. Its primary purpose is to facilitate **mocking** — creating mock objects to simulate and verify interactions between components. GoogleMock empowers you to specify expected calls, argument matchers, call count cardinalities, and mock behaviors using an intuitive syntax.

Together, GoogleTest and GoogleMock form a comprehensive solution for writing expressive and maintainable tests in C++.

---

## When to Use GoogleTest vs GoogleMock

| Use Case                                    | Use GoogleTest                          | Use GoogleMock                                   |
|---------------------------------------------|---------------------------------------|-------------------------------------------------|
| Writing basic unit or integration tests     | ✅ Provides all test definition and assertion APIs | No mocking involved                              |
| Verifying functional correctness of code   | ✅ Use assertions to validate outcomes | May be used indirectly if mock objects are needed |
| Testing complex interactions between modules| Use GoogleTest to write tests          | ✅ Use to create and set expectations on mock objects to verify interactions |
| Replacing dependencies or collaborators in tests | Not applicable                     | ✅ Create mocks to isolate the unit under test  |

---

## How GoogleTest and GoogleMock Integrate

GoogleMock depends on GoogleTest as the underlying test framework:

- **Initialization**: Calling `testing::InitGoogleMock(&argc, argv);` initializes both GoogleMock and GoogleTest flags.
- **Test Execution**: Mock verification and test execution occur within GoogleTest's lifecycle.
- **Assertions**: GoogleMock uses GoogleTest’s assertion infrastructure for reporting expectation failures.

You typically include GoogleMock in your test source files with:

```cpp
#include <gmock/gmock.h>
```

which indirectly includes GoogleTest headers.

---

## Core Features of GoogleTest

- **Test Macros**: `TEST()`, `TEST_F()`, `TEST_P()` for defining tests and test fixtures.
- **Assertions**: Rich macros such as `EXPECT_EQ()`, `ASSERT_TRUE()`, and predicate-based assertions.
- **Test Discovery and Execution**: Automatically finds and runs all registered tests.
- **Parameterized Tests**: Run the same test logic with multiple inputs.
- **Death Tests**: Verify program termination behavior.

Learn more:
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [Assertions Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md)

---

## Core Features of GoogleMock

- **Mock Class Definitions**: Define mocks using the `MOCK_METHOD` macro.

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(void, Process, (int count), (override));
};
```

- **Setting Expectations**: Use `EXPECT_CALL()` to specify which calls should happen:

```cpp
EXPECT_CALL(mock_foo, Process(5)).Times(1).WillOnce(Return());
```

- **Default Behaviors**: Set default method actions without setting expectations using `ON_CALL()`.
- **Matchers**: Specify argument constraints with built-in or custom matchers, e.g., `_`, `Eq()`, `Ge()`, `HasSubstr()`.
- **Call Cardinalities**: Control expected number of invocations using `Times()`, supporting `Exactly()`, `AtLeast()`, `AnyNumber()`, etc.
- **Call Ordering**: Enforce call order with `InSequence`, `After` clauses.
- **Actions**: Control method results and side effects, returning values or invoking callbacks.
- **Mock Object Behaviors**: Use `NiceMock`, `NaggyMock`, and `StrictMock` to manage how uninteresting calls are treated.
- **Automatic Verification**: All expectations are checked automatically on mock destruction or can be manually verified.

Learn more:
- [gMock for Dummies (beginner-friendly introduction)](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)

---

## Typical Workflow with GoogleTest and GoogleMock

1. **Include Headers**: 

```cpp
#include <gmock/gmock.h>
```

2. **Define Mock Classes**: Derive mock classes using `MOCK_METHOD`.

3. **Set Up Tests**: Use GoogleTest `TEST()` or `TEST_F()`.

4. **Set Default Behaviors (Optional)**: Use `ON_CALL` for default mock method behavior.

5. **Set Expectations**: Use `EXPECT_CALL` to specify expected method calls, arguments, and return behaviors.

6. **Exercise Code Under Test**: Run the code interacting with mocks.

7. **Verify**: Automatic on mock destruction or explicit calls like `Mock::VerifyAndClearExpectations(&mock_obj);`.

---

## Practical Tips

- **Expectations Before Use**: Always set `EXPECT_CALL` before exercising the mock.
- **Use `ON_CALL` Wisely**: Use `ON_CALL` for default behaviors, not for verifying calls.
- **Avoid Over-Specifying**: Write only the necessary expectations to avoid brittle tests.
- **Use Matchers to Reasonably Match Arguments**: Employ wildcard `_` or composite matchers to express intent clearly.
- **Manage Call Ordering**: Use `InSequence` or `After` only when order matters.
- **Handle Move-Only Types Natively**: GoogleMock supports move-only types like `std::unique_ptr` in mocks.
- **Suppress Unnecessary Warnings**: Use `NiceMock` if uninteresting calls produce distracting warnings.

---

## Common Questions

### Can I use GoogleMock without GoogleTest?
No. GoogleMock depends on GoogleTest, both at compile-time and runtime. Always initialize GoogleMock via `InitGoogleMock`, which also initializes GoogleTest.

### Can I mock non-virtual functions?
Not directly. You can use template-based techniques for non-virtual functions or wrap the interface.

### How do I verify that a method is NEVER called?
Use:

```cpp
EXPECT_CALL(mock_obj, Method(_)).Times(0);
```

### What if my mock object is leaked?
GoogleMock detects leaked mocks on program exit and warns. Use `Mock::AllowLeak(&mock_obj);` to suppress warnings if intentional.

### How do I handle overloaded methods?
Define distinct `MOCK_METHOD`s for each overload; use `using BaseClass::Method;` to expose unmocked overloads if necessary.

---

## Additional Resources

- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Understanding Mocks, Matchers, and Actions](https://github.com/google/googletest/blob/main/concepts/mocking-and-data-models/mock-objects-and-expectations.mdx)
- [Mocking APIs Reference](https://google.github.io/googletest/reference/mocking.html)

---

This page fits into the documentation flow bridging basic test creation with advanced mocking techniques and complements other getting started guides on project setup, writing tests, and mocking basics.