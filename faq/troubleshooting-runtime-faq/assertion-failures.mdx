---
title: "What do assertion failures and error messages mean?"
description: "Demystifies common GoogleTest and GoogleMock assertion failures, providing examples and guidance on troubleshooting failed tests, interpreting test output, and tracing problems to their source."
---

# What Do Assertion Failures and Error Messages Mean?

Understanding why a GoogleTest or GoogleMock assertion fails is key to quickly diagnosing test issues and improving your test suite. This page demystifies common failure messages, explains how to interpret test outputs, and guides you through tracing problems back to their roots.

---

## 1. Overview of Assertion Failures

When a GoogleTest assertion fails, it typically means that a condition specified by your test code did not hold true. There are two main types of assertion failures:

- **Fatal failures** (e.g. `ASSERT_*`, `FAIL()`) which immediately abort the current test function.
- **Non-fatal failures** (e.g. `EXPECT_*`, `ADD_FAILURE()`) which allow the test function to continue running, recording the failure for reporting later.

Failures are reported with detailed messages, including:

- The expression tested.
- The expected versus actual values.
- The source file and line number where the failure occurred.
- A stack trace, if available.

These messages help you pinpoint exactly what went wrong and where.


## 2. Common Assertion Failure Messages and What They Mean

### Equality and Comparison Assertions

These include macros like `EXPECT_EQ`, `ASSERT_NE`, `EXPECT_LT`, and their variations.

**Failure Example:**

```
Expected equality of these values:
  foo
    Which is: 5
  bar
    Which is: 6
```

This means that the test expected `foo` and `bar` to be equal, but their actual printed values differed (`5` vs `6`). GoogleTest prints both the expressions and their evaluated values to help you identify the mismatch.

**Tips:**
- For comparing strings, prefer `EXPECT_STREQ` instead of `EXPECT_EQ` to compare contents rather than pointer addresses.
- For floating-point comparisons, use `EXPECT_FLOAT_EQ`, `EXPECT_DOUBLE_EQ`, or `EXPECT_NEAR`.

### Boolean Assertions

Assertions like `EXPECT_TRUE` and `EXPECT_FALSE` check boolean conditions.

**Failure Example:**

```
Value of: 2 < 1
  Actual: false
Expected: true
```

Here, the condition `(2 < 1)` evaluated to false, causing the failure.

**Tips:** Use predicate assertions that return `AssertionResult` for more expressive and informative failure messages.

### String Comparison Failures

GoogleTest offers specialized assertions for C strings:

- `EXPECT_STREQ`/`ASSERT_STREQ` for equality.
- `EXPECT_STRNE`/`ASSERT_STRNE` for inequality.
- Case-insensitive variants: `EXPECT_STRCASEEQ`, `EXPECT_STRCASENE`.

If the comparison fails, the output shows the strings with proper escaping.

### Exception Assertions

Macros like `EXPECT_THROW`, `EXPECT_ANY_THROW`, and `EXPECT_NO_THROW` verify exception behavior.

Failures here indicate that either no exception was thrown when one was expected, or the thrown exception did not match the expected type.

---

## 3. Interpreting GoogleTest Failure Output

When a test fails, the output provides a structured report:

- **Location:** Source file and line number where the failure occurred. This helps you locate the assertion in your test code quickly.

- **Failure Type:** Fatal or non-fatal.

- **Details:** The condition that failed and its evaluated values.

- **Stack Trace:** Optionally included to trace the call stack leading up to the failure.

- **User Messages:** Any custom failure messages you've streamed into the assertion.

> **Example:**
> 
> ```
> foo_test.cc:42: Failure
> Expected equality of these values:
>   x
>     Which is: 2
>   y
>     Which is: 3
> Stack trace:
>   ...
> ```

Use this detailed output to understand precisely what failed, why, and where.

---

## 4. Using Scoped Traces to Improve Failure Diagnostics

If your test calls helper functions that contain assertions, the failure messages might not indicate which invocation caused the problem. `SCOPED_TRACE` lets you add context to all assertions within a scope or a helper function.

**Example:**

```cpp
void HelperFunction(int n) {
  SCOPED_TRACE(testing::Message() << "Checking value " << n);
  EXPECT_EQ(1, Foo(n));
}

TEST(MyTest, Works) {
  SCOPED_TRACE("Outer trace");
  HelperFunction(5);
  HelperFunction(10);
}
```

If the assertion in `HelperFunction` fails, the output will include the trace messages, helping you identify exactly which call failed.

---

## 5. Troubleshooting Assertion Failures

### Common Causes and Fixes

- **Mixing `TEST` and `TEST_F` in the same test suite:** GoogleTest requires all tests in a suite to use the same fixture class. Failure to comply results in an error advising to make them consistent.

- **Uninstantiated parameterized tests:** If you define `TEST_P` without providing `INSTANTIATE_TEST_SUITE_P`, no tests will run and an error message will inform you. Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` to suppress this if intentional.

- **Assertion inside constructors or destructors:** Fatal assertions (`ASSERT_*`, `FAIL()`) are illegal in constructors/destructors. Use `SetUp` or `TearDown` instead.

- **Incorrect use of `EXPECT_*` and `ASSERT_*`:** Remember that `ASSERT_*` aborts the current function, not the entire test. Use `HasFatalFailure()` to detect fatal failures in subroutines and manage control flow appropriately.

- **String comparison pitfalls:** Use correct string comparison macros (`EXPECT_STREQ`, not `EXPECT_EQ`) to avoid failures due to pointer comparisons.

### Verifying Failure Counts

Use `EXPECT_FATAL_FAILURE` or `EXPECT_NONFATAL_FAILURE` macros from `gtest-spi.h` to verify that code triggers the expected number and type of failures. This is especially useful for testing testing utilities.

---

## 6. Advanced Failure Messages and Customization

### AssertionResult and Predicate-Formatters

To get more descriptive failure messages for complex conditions, you can write predicate functions returning `testing::AssertionResult` or use predicate-formatters with `EXPECT_PRED_FORMAT*`. These allow streaming detailed diagnostic messages on failure.

### User-Supplied Failure Messages

You can append custom messages to assertions by streaming into them with `<<`. These messages appear alongside the standard messages in test reports.

Example:

```cpp
EXPECT_EQ(foo, bar) << "foo and bar should match after processing";
```

---

## 7. Understanding Stack Traces in Failures

GoogleTest can include the OS-level stack trace when an assertion fails. This feature is controlled by `--gtest_stack_trace_depth`.

- Stack traces exclude internal GoogleTest frames by default for clarity, but you can enable their inclusion with `--gtest_show_internal_stack_frames`.

- Stack trace inclusion helps diagnose where exactly in your code the failure originated, often critical for debugging complex interactions or asynchronous behavior.

---

## 8. Resources for Further Help

- [Assertions Reference](../reference/assertions.md): Comprehensive details and examples for all assertion macros.

- [Advanced Topics](../advanced.md): Techniques for custom assertions, predicate assertions, and writing robust tests.

- [Mocking Concepts and Reference](../concepts/mocking-and-extensibility/mocking-concepts.md): Understanding GoogleMock assertions and expectations.

- [Troubleshooting & Common Pitfalls](../getting-started/first-test-usage/troubleshooting-setup.md): Guides for setup issues and common mistakes.

- [GoogleTest Primer](../overview/introduction-core-value/what-is-googletest.md): Beginner’s guide to GoogleTest basics.

- GoogleTest GitHub repository: https://github.com/google/googletest

---

## 9. Summary

GoogleTest assertion failures provide detailed diagnostics to help you understand why your expectations were not met during test execution. By carefully reading the failure messages, using helper macros like `SCOPED_TRACE`, and consulting associated documentation, you can quickly identify the source of errors and improve your tests' reliability.

---

### Quick Reference Example of a Failure Message:

```none
path/to/my_test.cc:42: Failure
Expected equality of these values:
  foo
    Which is: 10
  bar
    Which is: 20
Stack trace:
...
```

This indicates the failure location, the compared expressions, their actual values, and optionally a call stack to trace execution flow.

---

# FAQ Entries Related to Assertion Failures

- Why are some tests not being discovered or run? See [Test Discovery Issues FAQ](../faq/troubleshooting-runtime-faq/test-discovery-issues.md)
- How to interpret assertion failure and error messages? See this page and the [Assertions Reference](../reference/assertions.md)
- Troubleshooting common setup and runtime failures: [Troubleshooting & Common Pitfalls](../getting-started/first-test-usage/troubleshooting-setup.md)


---

For detailed and nuanced control, always ensure your tests use the right assertion macros for your intent, provide informative failure messages where appropriate, and leverage GoogleTest’s rich diagnostic output.


---

### Related Topics

- [Writing Effective Assertions](../guides/core-testing-workflows/writing-effective-assertions.md)
- [Exception Assertions](../reference/assertions.md#exceptions)
- [Death Tests and Expected Failures](../concepts/scalability-and-advanced-testing/death-tests-concept.md)
- [Test Event Listeners](../reference/testing.md#TestEventListener) for custom failure reporting


---

# Practical Tips to Diagnose Failures

- Check the exact line and file reported by the failure message.
- Review expected vs actual values carefully to spot logical errors.
- Use `SCOPED_TRACE` to add context to failures deep in helper calls.
- Enable stack traces for tougher bugs with `--gtest_stack_trace_depth`
- For strange failures in parameterized or typed tests, verify test instantiation correctness.
- Use `EXPECT_FATAL_FAILURE` and `EXPECT_NONFATAL_FAILURE` macros (from `gtest-spi.h`) when testing that your tests or utilities produce expected failures.

---

For any questions or advanced error diagnosis needs, consult the detailed GoogleTest documentation or community forums.