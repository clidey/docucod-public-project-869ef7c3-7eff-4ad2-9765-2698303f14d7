---
title: "Build Errors and Linking Problems"
description: "Guidance for resolving typical build errors, missing symbols, library linking issues, and incompatibility warnings in a variety of build environments."
---

# Build Errors and Linking Problems

When integrating and building GoogleTest in your project, encountering build errors, missing symbol issues, or library linking problems is common yet solvable. This page provides focused guidance to identify, understand, and resolve typical problems during the compilation and linking phases, placed specifically within the context of GoogleTest’s usage and integration.

---

## 1. Common Build Errors and Their Causes

### 1.1 Missing Symbols or Undefined References

**Problem:** Linker complains about undefined references to GoogleTest symbols (e.g., `RunAllTests()`, `InitGoogleTest()`).

**Cause:** This usually means the GoogleTest implementation files (`gtest-all.cc` or `gtest_main.cc`) have not been compiled or linked into your project.

**Solution:**
- Ensure you include the GoogleTest source files in your build.
  - If you use CMake, link your test targets with `gtest` or `gtest_main` libraries.
- Remember that `gtest_main` provides a main function for you. If you write your own `main()`, link only with `gtest`.
- Verify your build system is correctly configured to see GoogleTest’s includes and link libraries.

### 1.2 Compiler Support and Language Standards

**Problem:** Build errors like "features requires at least C++17" or syntax errors related to `std::string_view` or other C++17 constructs.

**Cause:** Your compiler or build system is not configured to use C++17 or newer.

**Solution:**
- Ensure your compiler supports C++17. GoogleTest requires C++17 or newer.
- Update your build flags accordingly (e.g., add `-std=c++17` for GCC/Clang, or `/std:c++17` for MSVC).
- Use GoogleTest’s recommended CMake setup that automatically sets the required standard.

### 1.3 Mismatch of Runtime Libraries on Windows

**Problem:** Link errors related to runtime library mismatch, e.g., `MSVCRT` discrepancies or linker warnings about multiple CRTs.

**Cause:** GoogleTest is built or linked against a different C runtime than your application.

**Solution:**
- If using Visual Studio, ensure GoogleTest and your project use consistent runtime linkage settings (either both static or both dynamic CRT).
- Use GoogleTest’s CMake option `gtest_force_shared_crt` to force shared CRT linkage if your project uses it.
- Avoid mixing static and dynamic runtimes between your tests and GoogleTest.

### 1.4 Missing pthread Linkage on Linux

**Problem:** Undefined references to pthread functions during linking.

**Cause:** GoogleTest or your tests require pthread but `-lpthread` is not specified during link.

**Solution:**
- Add `-pthread` or `-lpthread` flag when linking on Linux.
- If using CMake, ensure Threads package is found (`find_package(Threads REQUIRED)`) and linked properly.

### 1.5 Duplicate or Conflicting Definitions

**Problem:** Errors about duplicate symbols when linking.

**Cause:** GoogleTest source may be compiled or linked multiple times unintentionally.

**Solution:**
- Avoid including GoogleTest source files in multiple places or linking multiple GoogleTest static libraries.
- Use official `gtest` and `gtest_main` targets as intended.

---

## 2. Best Practices for Linking GoogleTest

### 2.1 Using `gtest_main` vs. Custom `main()`

- To simplify test executable creation, use `gtest_main` to provide the `main()` function that initializes GoogleTest and runs all tests.
- If you write your own `main()`, link only with `gtest`.
- Avoid linking both `gtest` and `gtest_main` directly to prevent duplicate symbol conflicts.

### 2.2 Controlling Dependencies

- Link with `pthread` on Linux/macOS when necessary.
- For Windows, ensure correct CRT linkage and define `GTEST_HAS_PTHREAD=0` if no pthreads are used.
- Keep GoogleTest compiled with consistent compiler flags as your tests (e.g., same optimization level, exception settings).

### 2.3 CMake Integration

GoogleTest ships with a CMake build script to help manage dependencies and linkage.

Basic recommended usage:

```cmake
find_package(GTest REQUIRED)
add_executable(mytests test1.cc test2.cc)
target_link_libraries(mytests GTest::gtest_main)
add_test(NAME mytests COMMAND mytests)
```

- Ensures headers and libraries are correctly found.
- Manages platform specifics automatically.

### 2.4 Handling Shared vs Static Libraries

- By default, GoogleTest builds as a static library.
- To build and link GoogleTest as a shared library:
  - Define `GTEST_CREATE_SHARED_LIBRARY=1` when building.
  - Define `GTEST_LINKED_AS_SHARED_LIBRARY=1` when linking your tests.
- Avoid mixing static and shared linkage in your project.

---

## 3. Common Pitfalls and Troubleshooting

### 3.1 Mixing TEST() and TEST_F() in the Same Test Suite

- GoogleTest requires all tests in the same test suite to use the same test fixture class.
- Mixing `TEST()` (which uses the bare `testing::Test` fixture) and `TEST_F()` (a user-defined fixture) is illegal and causes build or runtime errors.

**Solution:**
- Use either `TEST()` or `TEST_F()` consistently within a test suite.
- Rename test suites or reorganize tests if you have to use different fixtures.

### 3.2 Parameterized Test Instantiation Errors

- Tests defined with `TEST_P` require instantiation with `INSTANTIATE_TEST_SUITE_P`.
- Failure to instantiate will result in no tests running and warnings/errors.

**Solution:**
- Add proper instantiation in your source files.
- Verify test registration order.

### 3.3 Compilation Errors for Fixtures

- If you define a test fixture class but forget to define `SetUp()` or `TearDown()` properly (misspelling `SetUp()` as `Setup()`), you might get compilation errors.

**Solution:**
- Use `override` keyword to help detect misspellings.
- Ensure fixture methods have correct signature: `void SetUp() override`.

### 3.4 Exceptions Affecting Test Flow

- GoogleTest catches exceptions by default, which is configurable.
- During build or runtime, exceptions escaping fixtures or tests may cause confusion.

**Solution:**
- Configure `--gtest_catch_exceptions` flag as per your needs.
- Use assertion macros properly to avoid unknown exceptions.

---

## 4. Verification and Diagnostic Tips

- Use `--gtest_list_tests` to check which tests your test executable will run.
- Use `--gtest_filter` to selectively run tests for debug or diagnosis.
- Build with verbose outputs or enable GoogleTest’s debug flags for more information.
- Ensure your build tool invokes all necessary compile and link steps.
- Confirm you are using a compatible compiler and build environment.

---

## 5. Getting Further Help

If you continue to face build or linking errors after following these guidelines:

- Consult the official [GoogleTest README](https://github.com/google/googletest/blob/main/googletest/README.md) for detailed build instructions.
- Review the [Installation & Integration guide](/getting-started/environment-installation/installation-integration) for environment-specific advice.
- Check out the [Troubleshooting Common Setup Issues](/getting-started/troubleshooting/common-setup-issues) page.
- Visit community forums and support channels as detailed in [Community & Further Help](/getting-started/troubleshooting/community-resources).


---

## Related Documentation

- [GoogleTest Primer](primer.md): Understand the basics of writing and running tests.
- [Advanced GoogleTest Topics](advanced.md): Learn advanced usage and troubleshooting.
- [Installation & Integration Guide](/getting-started/environment-installation/installation-integration): Step-by-step build setup.

---

## Summary
Resolving build and linking errors is critical to successful GoogleTest integration. Focus on linking required source files and libraries, ensuring consistent compiler standards, and maintaining proper test declarations. Use GoogleTest flags and CMake integration to control build behaviors and diagnostics.

---

For a practical start, try building and running the sample tests included with GoogleTest, and adapt the build process toward your project incrementally.
