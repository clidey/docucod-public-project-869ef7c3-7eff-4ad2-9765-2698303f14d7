---
title: "Common Questions & Errors"
description: "Find answers to common usage questions, error messages, and unexpected behaviors when using GoogleTest and GoogleMock. Covers topics such as missing dependencies, build failures, and test execution errors, helping users resolve issues and get tests running quickly."
---

# Common Questions & Errors

This FAQ page addresses frequently encountered questions, error messages, and unexpected behaviors while using GoogleTest and GoogleMock. It focuses on helping you troubleshoot installation problems, build failures, runtime errors, and test execution issues, enabling you to get your tests running smoothly.

---

## 1. Installation and Build Issues

### Why does my build fail due to missing pthread or linker errors on Linux?

GoogleTest requires pthread support on Unix-like systems. Link errors often occur if pthread libraries are not linked correctly.

**Solution:**
- Ensure you link your test executable with `-pthread`.
- If using CMake, link with `${CMAKE_THREAD_LIBS_INIT}`.
- Verify your compiler supports at least C++17.

```cmake
find_package(Threads REQUIRED)
target_link_libraries(your_test_target PRIVATE gtest pthread)
```

### On Windows, why do I get runtime library mismatches or errors linking GoogleTest?

These errors usually stem from inconsistent runtime library settings between GoogleTest and your project.

**Solution:**
- Build GoogleTest with the same runtime library as your project (e.g., Multi-threaded DLL `/MD`).
- Use pre-built binaries that match your compiler and runtime.
- Check for mixing Debug and Release builds.

### What should I do if `MOCK_METHOD` macro gives parsing errors due to commas in argument types?

Because `MOCK_METHOD` expects a comma-separated format, argument types containing commas (e.g., templates like `std::map<int, double>`) must be wrapped in extra parentheses or replaced with type aliases.

**Example:**

```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
using MapIntDouble = std::map<int, double>;
MOCK_METHOD(bool, CheckMap, (MapIntDouble, bool));
```

{/*
Tip: See [Mock Object Definition](../api-reference/mocking-apis/mock-object-definition) for detailed examples.
*/}

## 2. Test Execution and Runtime Errors

### Why does my test fail with "void value not ignored as it ought to be" or similar errors when using `ASSERT_*` in functions returning non-void?

`ASSERT_*` macros that generate fatal failures must only be used in void-returning functions because they return from the current function upon failure.

**Solution:**
- Use `EXPECT_*` macros if you cannot use void-returning functions.
- Refactor your function to `void` or rewrite using out parameters.

```cpp
void Foo(int x, int* result) {
  ASSERT_GT(x, 0);  // OK, void return
  *result = 10 / x;
}
```

### Why does `RUN_ALL_TESTS()` return 1 even though my test seems to pass visually?

Any failed assertion or crash causes `RUN_ALL_TESTS()` to return non-zero.

**Solution:**
- Check test output closely for hidden failures.
- Remember `ASSERT_*` causes immediate failure, while `EXPECT_*` reports but continues.

### What does the error "Actual function call count doesn't match this expectation" mean in gMock?

This means a mock method was called fewer or more times than expected in your `EXPECT_CALL()` configuration.

**How to resolve:**
- Review the `.Times()` clause and expected number of calls.
- If missing `.Times()`, understand default cardinality rules (see [Setting Expectations and Behavior](../api-reference/mocking-apis/setting-expectations-and-behavior)).
- Use `.RetiresOnSaturation()` to prevent sticky expectations causing saturation errors.

### Why do my expectations fail because of call ordering?

By default, mock method calls in gMock can be called in any order.

**If ordering matters:**
- Use `InSequence` to enforce strict order.
- Alternatively, use `Sequence` objects and `After()` clauses to define partial orders.

```cpp
{
  InSequence s;
  EXPECT_CALL(mock, Foo()).Times(1);
  EXPECT_CALL(mock, Bar()).Times(1);
}
```

### What if my mock methods are called unexpectedly or never called?

- Unexpected calls occur if gMock detects a method called more than expected or without matching expectation.
- Uncalled methods could mean you did not specify an `EXPECT_CALL()` or the call did not happen.

**Tips:**
- Use `NiceMock` to suppress warnings about uninteresting calls when appropriate.
- Check that the mocked interface matches the real usage.

## 3. Common Pitfalls and Best Practices

### Can I use `ASSERT_*` macros in constructors or destructors?

No. Constructors and destructors are not void-returning, so fatal assertions cannot be used there.

**Best Practice:**
- Use `SetUp()` and `TearDown()` methods of your test fixture to do setup and cleanup with assertions.

### How to manage test dependencies and flaky tests?

- Tests must be independent and repeatable.
- Avoid sharing state between tests.
- Use fresh fixtures for each test.
- Use `SetUpTestSuite()` judiciously for expensive resources.
- Use `--gtest_repeat` and `--gtest_shuffle` to detect flaky tests.

### How to diagnose test failures with complex subroutines?

- Use `SCOPED_TRACE` to add context information during assertions in subroutines.

```cpp
SCOPED_TRACE("On iteration " << i);
EXPECT_EQ(Foo(i), expected_value);
```

- For verbose logging, use streaming to assertions:

```cpp
EXPECT_TRUE(CheckSomething()) << "Detailed details: var=" << var;
```

### Why is `EXPECT_CALL()` or mock failures reported late or confusingly?

- gMock requires that expectations are set *before* exercising the mock.
- Setting expectations after the mock method is called may lead to undefined behavior.

## 4. Troubleshooting Build and Setup

### Runtime errors on Windows like "Your DLL did not register a main() function"

Make sure you link against the correct main library:

- For GoogleTest: link `gtest_main.lib`.
- For GoogleMock: link `gmock_main.lib`.

### Linking errors due to missing GoogleMock symbols

This happens if you link only against GoogleTest and forget GoogleMock libraries.

**Solution:**
- Link your test executable with both `gmock` and `gtest` libraries.

### Why do my tests not run even though they compile and link?

- Check if tests are disabled by prefixing with `DISABLED_`.
- Verify your `main()` calls `testing::InitGoogleTest()` and returns `RUN_ALL_TESTS()`.
- Verify your test filter settings.

## 5. Useful Commands and Debugging Techniques

- Enable verbose logging for GoogleMock by setting environment variable:

```sh
export GMOCK_VERBOSE=info
```

- List all available tests:

```sh
./your_test_executable --gtest_list_tests
```

- Run a subset of tests:

```sh
./your_test_executable --gtest_filter=TestSuiteName.TestName
```

- Repeat tests to catch flaky failures:

```sh
./your_test_executable --gtest_repeat=100
```

---

## Related Resources

- [GoogleTest Primer](primer.md) — Beginner-friendly introduction
- [Mocking Basics with GoogleMock](guides/getting-started/mocking-basics.mdx) — Mock creation and usage
- [Assertions Reference](reference/assertions.md) — Complete list of assertions
- [Mocking Reference](reference/mocking.md) — Detailed mocking macros and classes
- [Troubleshooting Setup Issues](getting-started/troubleshooting-faq/troubleshooting-setup-issues.mdx) — Common installation problems
- [Performance and Scaling Tips](faq/advanced-usage-optimization/faq-performance) — Optimize test suite runs

<Tip>
If you encounter issues not resolved by this FAQ, consult the community resources or open an issue in the <a href="https://github.com/google/googletest">GoogleTest GitHub repository</a>.
</Tip>