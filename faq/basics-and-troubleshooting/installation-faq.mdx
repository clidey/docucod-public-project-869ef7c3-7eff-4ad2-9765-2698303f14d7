---
title: "Installation and Build Issues"
description: "Covers common problems encountered during installation (CMake, Bazel, etc.), platform-specific concerns, and solutions for build failures or environment configuration. Points users to relevant setup documentation."
---

# Installation and Build Issues

This page addresses common problems encountered during the installation and build process of GoogleTest and GoogleMock using build systems such as CMake and Bazel. It highlights platform-specific concerns, troubleshooting guidance, and best practices to resolve build failures or environment configuration issues. If you need foundational setup instructions, please refer to the dedicated Setup and Installation documentation.

---

## 1. Building GoogleTest and GoogleMock with CMake

### 1.1 Community Support Notice

GoogleTest and GoogleMock’s CMake support is community-maintained; the main maintainers do not internally use CMake. This means some build issues may require consultation of community resources or issues for resolution.

### 1.2 Minimum CMake Version and Project Setup

- Requires **CMake 3.16** or later to build GoogleTest distribution.
- The main `CMakeLists.txt` defines `googletest-distribution` as the project.

```cmake
cmake_minimum_required(VERSION 3.16)
project(googletest-distribution)
```

---

### 1.3 Basic Build Workflow

Typical standalone GoogleTest build flow using CMake:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build
cmake ..
make
sudo make install
```

- By default, this includes GoogleMock. To skip GoogleMock, use:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

- On Windows, Visual Studio projects will be generated.
- On macOS, an Xcode project is generated.

#### Pro Tip
If integrating GoogleTest into an existing CMake project, consider using `add_subdirectory()` or CMake’s `FetchContent` module for seamless compiler/linker flag compatibility.

---

### 1.4 Compiler Flags and Environment Tweaks

The build scripts include macros to:

- Override default compiler flags for MSVC, Clang, GCC, and other compilers to ensure correctness.
- Handle static vs shared runtime library linkage, especially on MSVC (e.g., `gtest_force_shared_crt` option).
- Enable stricter warnings (`/W4` on MSVC).
- Configure threading, defaulting to POSIX threads where available.

Users encountering build errors often benefit from explicitly setting `gtest_force_shared_crt` or adjusting C++ standard enforcement.

### 1.5 C++ Standard Requirement

GoogleTest mandates **C++17** support. Ensure your compiler and build system specify this, commonly via:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Failure to meet this requirement will generate build-time errors or unexpected behavior.

---

## 2. Common Installation and Build Issues

### 2.1 Missing Headers or Source Files

- Confirm the correct directory structure and `include` paths are configured.
- When using pre-installed libraries, ensure environment variables or find_package commands locate them properly.

### 2.2 Linker Errors

- Verify libraries `gtest`, `gmock`, `gtest_main`, or `gmock_main` are linked appropriately.
- When building shared libraries, add the `-DGTEST_CREATE_SHARED_LIBRARY=1` flag.
- For user test executables linking against shared libraries, use `-DGTEST_LINKED_AS_SHARED_LIBRARY=1`.

### 2.3 Compiler Flag Incompatibilities

- Check for conflicts between your project compiler flags and GoogleTest defaults.
- Specifically on Windows, mismatched runtime libraries (static vs dynamic) cause LNK2038 errors; enable `gtest_force_shared_crt` to address this.

### 2.4 Threading Support and PThreads

- GoogleTest expects pthreads on Unix-like platforms. Make sure pthread is available and linked.
- On MinGW or Windows, pthreads support may be limited, and GoogleTest uses native Windows threading primitives.

### 2.5 Platform-Specific Notes

- **Windows**: Visual Studio users should open the generated solution file and build within that environment.
- **Mac OS**: Xcode builds are supported via the generated project.
- **Embedded or Less Common Platforms**: GoogleTest may require custom configuration or patches.

---

## 3. Troubleshooting Steps

### Step 1: Verify Prerequisites

- Confirm that CMake version meets minimum requirements.
- Confirm compiler supports C++17.
- Confirm necessary dependencies (pthreads, absl, re2 if using `GTEST_HAS_ABSL`) are installed.

### Step 2: Clean and Rebuild

- Delete previous build artifacts (e.g., `build/` directory).
- Run `cmake ..` cleanly to regenerate build files.

### Step 3: Build with Verbose Logging

Use verbose output to identify problems:

```bash
make VERBOSE=1
```

or if using Ninja:

```bash
ninja -v
```

### Step 4: Check Build Options

Ensure that options such as `BUILD_GMOCK`, `INSTALL_GTEST`, and `gtest_force_shared_crt` are appropriately set.

### Step 5: Consult CMake Cache

Examine `CMakeCache.txt` for misconfigurations.

### Step 6: Cross-reference with Official Setup Docs

Refer back to [Installation Methods](https://github.com/google/googletest/blob/main/docs/GettingStarted.md) and [Prerequisites & Supported Platforms](https://github.com/google/googletest/blob/main/docs/Prerequisites.md).

<br>

## 4. Platform-Specific Configuration Options

| Platform           | Notes                                                 | Recommended Flag or Action              |
|--------------------|-------------------------------------------------------|---------------------------------------|
| Windows (MSVC)     | Runtime library mismatches cause linker errors.        | Set `-Dgtest_force_shared_crt=ON`     |
| Linux / Unix       | Requires pthreads support and proper linking.          | Ensure `find_package(Threads REQUIRED)` succeeds |
| macOS              | Uses Xcode project generation through CMake.           | Use Xcode IDE or CLI build              |
| MinGW              | PThread support is limited; GoogleTest uses Win threads.| Disable pthread-related options          |
| Bazel Integration  | Use Bazel build rules as documented separately.         | Refer to Bazel build documentation      |

---

## 5. Best Practices for Successful Builds

- Use out-of-source builds (`mkdir build && cd build`)
- Specify explicit compiler and linker options consistent with your project.
- When embedding GoogleTest, sync compiler standards and runtime linkages.
- Use CMake options to toggle features like `BUILD_GMOCK` and test compilation.
- Keep GoogleTest version updated to benefit from fixes and compatibility improvements.

---

## 6. Additional Resources

- [CMakeLists.txt](https://github.com/google/googletest/blob/main/CMakeLists.txt) - Main CMake build configuration
- [googlemock/CMakeLists.txt](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt) - GoogleMock-specific CMake support
- [googletest/README.md](https://github.com/google/googletest/blob/main/googletest/README.md) - Generic build instructions
- [Setup Troubleshooting FAQ](https://github.com/google/googletest/blob/main/docs/SetupTroubleshooting.md) - Deeper insight on setup failures

<Check>
If build problems persist, verify your environment matches supported platforms, update dependencies, and consult community forums or issue trackers.
</Check>