---
title: "Installation & Build Troubleshooting"
description: "Frequently asked questions about installing, building, and linking GoogleTest and GoogleMock across supported platforms. Includes common compiler issues, dependency management, and guidance on integrating with popular build systems like CMake and Bazel."
---

# Installation & Build Troubleshooting FAQ

This page addresses the most frequently asked questions related to installing, building, and linking GoogleTest and GoogleMock. It provides guidance on handling common compiler issues, managing dependencies, and integrating with popular build systems like CMake and Bazel across different platforms.

---

## 1. General Installation and Build

### Q: How do I build GoogleTest and GoogleMock on my platform?

GoogleTest offers a versatile CMake build script that supports a broad range of platforms, including Linux, Windows, and Mac.

**Basic standalone build steps:**
```bash
# Clone the repository at a specific version
git clone https://github.com/google/googletest.git -b v1.17.0
db googletest
mkdir build
cd build
cmake ..              # Generates native build files
make                   # On Unix-like systems
sudo make install       # Optional system-wide install
```

- CMake generates *Visual Studio solutions* on Windows and *Xcode projects* on Mac.
- GoogleMock is included by default; to build only GoogleTest, use `cmake .. -DBUILD_GMOCK=OFF`.

### Q: How can I incorporate GoogleTest into an existing CMake project?

You can use GoogleTest installed libraries via `find_package`:

```cmake
find_package(GTest CONFIG REQUIRED)
add_executable(your_test your_test.cc)
target_link_libraries(your_test PRIVATE GTest::gtest GTest::gtest_main)
```

Alternatively, integrate GoogleTest source into your build using `add_subdirectory()`, ensuring consistent compiler and linker flags. This approach avoids mismatches, especially important on Windows.

### Q: What C++ standard is required to build GoogleTest?

An environment supporting **C++17 or later** is mandatory. You can specify this in your top-level `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Or pass compiler flags such as `-std=c++17` directly.

---

## 2. Common Platform-Specific Issues

### Q: How do I avoid runtime library mismatches on Visual Studio?

Visual Studio projects default to dynamically linking the C runtime, whereas GoogleTest links statically by default. This leads to errors like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary':...
```

**Solution:** Enable dynamic runtime linking for GoogleTest by setting the CMake option:

```bash
-Dbtest_force_shared_crt=ON
```

This ensures consistent runtime linkage.

### Q: How do I handle pthread availability and linking issues?

GoogleTest is thread-safe when pthreads are available. If detection fails, you can:

- Manually force pthread detection with `-DGTEST_HAS_PTHREAD=1` or disable it with `-DGTEST_HAS_PTHREAD=0`.
- Link with pthread explicitly if using your own build system.

CMake scripts handle pthread flags automatically.

### Q: Can I build GoogleTest as a shared library (DLL) on Windows?

Yes. Compile GoogleTest with:

```bash
-DGTEST_CREATE_SHARED_LIBRARY=1
```

and compile tests linking to the shared library with:

```bash
-DGTEST_LINKED_AS_SHARED_LIBRARY=1
```

This preparation ensures proper symbol visibility and dynamic linkage.

---

## 3. Build Customization and Tweaks

### Q: How can I tweak GoogleTest’s build or features?

You can define `GTEST_*` macros on the compiler command line to enable or disable features.

For example, to avoid macro name clashes:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

This renames GoogleTest macros to `GTEST_TEST` instead of `TEST`.

Refer to [gtest-port.h](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h) for a full list of customizable macros.

### Q: How is compiler and linker configuration managed?

GoogleTest’s CMake scripts adjust flags according to the compiler:

- MSVC and Clang get stricter warnings and static runtime linkage by default.
- GNU and Clang compilers have tailored warning flags.
- Pthread support is auto-detected.

These settings ensure consistent builds and better diagnostics.

---

## 4. Linking Errors and Dependency Management

### Q: I encounter linker errors when linking GoogleTest/GoogleMock, how do I fix them?

Common causes and fixes:

- **Mixing static and dynamic runtimes:** Ensure consistent `gtest_force_shared_crt` setting or runtime linkage flags.
- **Missing pthread linkage:** Link with pthread explicitly or use CMake scripts that handle this.
- **Incorrect library order:** When linking manually, list GoogleTest and GoogleMock libraries after your test targets.

Using CMake `target_link_libraries()` is recommended to handle dependencies correctly.

### Q: How do I use pkg-config to build with GoogleTest?

GoogleTest provides pkg-config files for compiler flags and libraries.

Example in CMake:

```cmake
find_package(PkgConfig REQUIRED)
pkg_search_module(GTEST REQUIRED gtest_main)

add_executable(my_test tests/my_test.cc)
target_link_libraries(my_test PRIVATE ${GTEST_LDFLAGS})
target_compile_options(my_test PRIVATE ${GTEST_CFLAGS})

enable_testing()
add_test(NAME my_test COMMAND my_test)
```

If `pkg-config` can't find GoogleTest, ensure the `PKG_CONFIG_PATH` includes your installation's `pkgconfig` directory.

---

## 5. Troubleshooting Common Build and Setup Issues

### Q: What if CMake cannot find GoogleTest on my system?

Make sure GoogleTest is installed properly. If installed to a non-standard prefix (e.g., `/usr/local`), set `PKG_CONFIG_PATH`:

```bash
export PKG_CONFIG_PATH=/usr/local/lib64/pkgconfig:$PKG_CONFIG_PATH
```

Alternatively, build and link GoogleTest directly in your project as a subdirectory.

### Q: I'm getting compiler errors related to exceptions or RTTI. What do I do?

GoogleTest requires exceptions and RTTI enabled in your compiler settings.

Make sure these flags are set:

- Exceptions enabled (`-fexceptions` for GCC/Clang, `/EHsc` for MSVC)
- RTTI enabled (not disabled with `-fno-rtti`)

On MSVC, CMake settings in GoogleTest will adjust these flags.

### Q: How do I compile GoogleTest for an embedded environment or with limited OS support?

GoogleTest supports limited configurations if necessary. You may need to tweak macros such as `GTEST_HAS_PTHREAD` manually and modify build flags accordingly.

See the [customization macros documentation](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h) for details.

---

## 6. Verifying Your Installation

### Q: How can I confirm GoogleTest is installed correctly and working?

- Build and run the sample tests provided in the repository.
- Use `gtest_main` to link your test executables for convenience.
- Run tests with verbose output to check for linking/runtime issues.

Example main function:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Q: What if my tests crash or fail at runtime due to linking or environment setup?

- Check that all required libraries (e.g., pthread) are linked.
- Ensure your test binary and GoogleTest are built with the same compiler and standard library versions.
- Verify runtime dependencies and environment variables.

---

## 7. Integration with Bazel and Other Build Systems

GoogleTest also supports integration with Bazel. For CMake, see above.

For other build systems, GoogleTest provides pkg-config files for determining required flags.

Using GoogleTest as a git submodule or fetching content during build can help keep your builds reproducible.

---

## 8. Additional Tips & Best Practices

- **Use `gtest_force_shared_crt` to avoid MSVC runtime conflicts.**
- **Prefer building GoogleTest as part of your main project to keep compiler/linker flags consistent.**
- **Keep the C++ standard at 17 or higher to prevent build failures related to language features.**
- **For cross-compilation, configure `pkg-config` variables correctly for sysroot resolution.**

---

## Related Documentation

- [Installing GoogleTest](../../getting-started/setup-prerequisites-installation/installing-googletest.md)
- [Troubleshooting Common Setup Issues](../../getting-started/first-run-configuration-troubleshooting/troubleshooting-common-setup-issues.md)
- [Integration & Dependencies](../../overview/architecture-core-concepts/integration-and-dependencies.md)
- [Using pkg-config with GoogleTest](../../docs/pkgconfig.md)
- [CMake Build Details](https://github.com/google/googletest/blob/main/googletest/README.md#build-with-cmake)

---

<Tip>
Building and integrating GoogleTest can be straightforward when following recommended workflows like using CMake's FetchContent or pkg-config. Always ensure the C++17 standard and matching runtime libraries to avoid subtle build and runtime errors.
</Tip>

<Warning>
Linker errors or runtime crashes often stem from mismatched runtime libraries, missing pthread linkage, or inconsistent compiler flags. Review your build configuration carefully.
</Warning>
