---
title: "Platform-Specific Questions"
description: "Answers to frequent platform compatibility questions, including differences and recommended setups for Windows, Linux, MacOS, and embedded systems. Provides workarounds for the most common platform-specific issues."
---

# Platform-Specific Questions

This FAQ addresses frequent queries concerning GoogleTest and GoogleMock platform compatibility and behavior differences particularly focused on Windows, Linux, MacOS, and various embedded systems. It provides guidance on recommended setups, subtle distinctions, and practical workarounds for common platform-specific issues when using GoogleTest and GoogleMock.

---

## 1. Which platforms does GoogleTest officially support?

GoogleTest supports a wide range of platforms, including:

- Desktop OSes: Linux, Windows (including MinGW), and macOS.
- Major Unix-like OSes: FreeBSD, NetBSD, OpenBSD, Solaris, AIX.
- Embedded and specialized systems: ESP8266, ESP32, NRF52, Xtensa architectures, and QuRT.

Key platform availability macros such as `GTEST_OS_LINUX`, `GTEST_OS_WINDOWS`, `GTEST_OS_MAC`, `GTEST_OS_ESP8266`, and others are automatically set during compilation in `gtest-port-arch.h`.

> Note that for each platform, GoogleTest adapts low-level implementations accordingly to maximize portability, such as using Win32 APIs on Windows and POSIX APIs on Unix-like systems.


## 2. Are there any essential platform differences I should know?

### Windows

- Windows is fully supported with special considerations for UTF-16 path handling, threading, and file system operations.
- GoogleTest uses `_wfopen` internally on Windows to handle Unicode file paths correctly.
- Separate macros distinguish Windows desktop, mobile, RT, and phones (`GTEST_OS_WINDOWS_DESKTOP`, etc).
- The typical main function entry point differs on Windows Mobile (_tmain) versus desktop (main).

### Linux and Unix-like

- Full support with pthread-based threading, POSIX regular expressions, and file systems.
- Android is supported but with some differences around exceptions and clone syscall availability.

### MacOS and iOS

- Supports native MacOS and iOS variants, adjusting features like death tests availability.

### Embedded Systems (ESP8266, ESP32, NRF52)

- Limited feature support, notably no environment variables, limited or no file system,
  and no stream redirection.
- The test runner is adapted to the embedded event loop (e.g., `setup()` and `loop()` in Arduino environments).


## 3. What common platform-specific issues might I encounter?

### Problem: Linker errors or missing symbols on Windows

- Cause: Mismatched runtime library linkage between GoogleTest and your project (static vs dynamic CRT).

- Solution: Use the CMake option `gtest_force_shared_crt` to align GoogleTest linkage with your projectâ€™s CRT.

- Reference: See [googletest/README.md - Visual Studio Dynamic vs Static Runtimes](https://github.com/google/googletest/blob/main/README.md#visual-studio-dynamic-vs-static-runtimes)


### Problem: Thread-safety issues on Windows

- Cause: GoogleTest is thread-safe only where `pthreads` or equivalent threading APIs are supported; on some Windows platforms, threading synchronization primitives differ.

- Solution: Confirm that your platform defines `GTEST_IS_THREADSAFE` or ensure the presence of threading support macros.


### Problem: Death tests unsupported or failing on embedded or limited platforms

- Cause: Death tests require file system support and process control that embedded platforms lack.

- Solution: Death tests are disabled on such platforms (`GTEST_HAS_DEATH_TEST` undefined). Avoid or conditionally exclude death tests.


### Problem: Wide string (`std::wstring`) support is limited

- Cause: Some platforms like Android, Cygwin, and embedded systems lack full wide string support.

- Solution: Recognize that `GTEST_HAS_STD_WSTRING` will be 0 in these environments. Prefer UTF-8 strings in test messages.


### Problem: Environment variables unavailable on embedded

- Cause: Embedded systems usually don't provide environment variable facilities.

- Solution: GoogleTest returns `nullptr` for `GetEnv()` on those platforms. Tests depending on environment variables must be conditioned or avoided.


## 4. How do I handle differences in test entry points and initialization?

- On desktop platforms, GoogleTest initialization involves calling `testing::InitGoogleTest(&argc, argv);` followed by `RUN_ALL_TESTS();`.

- On embedded platforms like ESP8266 and ESP32, GoogleMock provides `setup()` and `loop()` functions that integrate with the hardware event loop.

- Source example for embedded main loop:

  ```c++
  void setup() {
    testing::InitGoogleMock();
  }

  void loop() {
    RUN_ALL_TESTS();
  }
  ```


## 5. What are the recommended configurations for building GoogleTest on different platforms?

- **Linux/macOS:** Use CMake with standard pthread support detected automatically.
- **Windows:** Use CMake with `gtest_force_shared_crt=ON` if your project links CRT dynamically. The code uses Windows threading primitives.
- **Embedded:** Use custom compile flags to disable unsupported features (e.g., exceptions, RTTI), and rely on specialized integration hooks.

Consult the [GoogleTest README](https://github.com/google/googletest/blob/main/README.md) and [internal_utils.cmake](https://github.com/google/googletest/blob/main/googletest/cmake/internal_utils.cmake) for detailed compiler and linker flag configurations.


## 6. Are there platform-specific macros I can utilize in my tests?

Yes, GoogleTest defines macros automatically to facilitate platform-specific code paths:

| Macro                  | Description                            |
|------------------------|------------------------------------|
| `GTEST_OS_WINDOWS`      | Compiled on Windows                  |
| `GTEST_OS_LINUX`        | Compiled on Linux                    |
| `GTEST_OS_MAC`          | Compiled on Mac OS X                 |
| `GTEST_OS_ESP8266`      | Compiled for ESP8266 embedded       |
| `GTEST_OS_ESP32`        | Compiled for ESP32 embedded         |
| `GTEST_IS_THREADSAFE`   | Thread support enabled               |
| `GTEST_HAS_PTHREAD`     | PThread support enabled              |
| `GTEST_HAS_DEATH_TEST`  | Death tests supported                |

**Usage example**:

```c++
#if defined(GTEST_OS_WINDOWS)
// Windows-specific initialization
#elif defined(GTEST_OS_LINUX)
// Linux-specific code
#endif
```


## 7. Troubleshooting Tips for Platform Issues

<AccordionGroup title="Platform Troubleshooting Scenarios">
<Accordion title="Build Failures on Windows">
Make sure you have aligned your build's runtime library linking using the `gtest_force_shared_crt` setting. Verify that the proper versions of Visual Studio and toolchains are used (at least VS 2015 for GoogleMock). Check for Unicode path conversion issues that can cause compiler errors.
</Accordion>
<Accordion title="Segfaults or Crashes on Embedded Platforms">
Confirm that all required initializations are complete before running tests. Embedded platforms may lack some standard features; conditionally compile out unsupported GoogleTest features.
</Accordion>
<Accordion title="Tests Not Running or Being Detected">
On some embedded or unusual systems, GoogleTest's automatic test discovery might be limited. Verify that your build is correctly linking GoogleTest's registration mechanisms. Inspect command-line flags if overriding test filters.
</Accordion>
<Accordion title="Problems with Threading or Deadlocks">
Check if `GTEST_IS_THREADSAFE` is defined as `1`. If not, your platform might lack suitable threading support. Limit your tests accordingly or port threading primitives.
</Accordion>
</AccordionGroup>


## 8. Additional Resources & Links

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md): Core concepts and usage across platforms
- [Integration and Platform Support](https://github.com/google/googletest/blob/main/overview/integration-and-getting-started/integration-points.md)
- [Common Installation and Setup Issues](https://github.com/google/googletest/blob/main/getting-started/troubleshooting-learn/common-setup-issues.md)
- [GoogleTest README](https://github.com/google/googletest/blob/main/README.md): Build instructions and platform-specific notes

---

## Summary

This FAQ clarifies platform compatibility considerations crucial to effectively using GoogleTest and GoogleMock on diverse systems. It highlights distinctions between desktop OSes and embedded platforms, common challenges such as threading support, runtime linkage issues, and death test availability. Users are guided in configuring builds and adapting test code to platform constraints.

For complex platform-specific needs or troubleshooting, users should consult the official GoogleTest build and platform documentation, and leverage platform macros for conditional compilation.


---