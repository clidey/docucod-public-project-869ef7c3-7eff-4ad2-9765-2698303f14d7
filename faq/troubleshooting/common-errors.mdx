---
title: "Troubleshooting Common Build and Test Issues"
description: "Targets recurring user problems including compilation errors, linking failures, missing dependencies, and runtime misbehavior. Provides actionable solutions and checklists to resolve problems quickly and independently."
---

# Troubleshooting Common Build and Test Issues

This page addresses recurring challenges faced by users when building projects that use GoogleTest and GoogleMock, and when running tests. It focuses on actionable solutions and checklists to help you resolve issues such as compilation errors, linking failures, missing dependencies, and unexpected runtime behavior quickly and independently.

---

## 1. Compilation Errors

### Why Am I Getting Compilation Errors?

Compilation failures often occur due to misconfiguration or missing components:

- Missing include paths for GoogleTest or GoogleMock headers.
- Typo or incorrect syntax in test or mock definitions.
- Incorrect use of macros such as `TEST()`, `TEST_F()`, and `MOCK_METHOD`.
- Using unsupported C++ language features or compiler versions.

### How to Resolve Compilation Errors

Follow these checks:

1. **Include Paths:** Ensure your build system includes the directory containing `gtest/gtest.h` and `gmock/gmock.h`.

2. **Linking GoogleTest/GoogleMock:** If you build GoogleTest and GoogleMock as libraries, link them properly.

3. **Correct Macro Usage:** Use the `TEST()` macro for simple tests and `TEST_F()` for tests requiring fixtures. Always define test fixtures correctly as classes derived from `testing::Test`.

4. **Use `MOCK_METHOD` Correctly:**
   - Make sure to place `MOCK_METHOD` declarations in the `public:` section of your mock class.
   - Surround return or argument types containing commas with parentheses or use `using` type aliases to avoid parsing errors.

5. **Compiler Compatibility:** GoogleTest requires C++17 or later; ensure your compiler satisfies this requirement.

### Example Fix: Mock Method With Comma in Argument Type

Incorrect:
```cpp
MOCK_METHOD(std::pair<bool, int>, GetPair, ());  // Won't compile
```

Correct options:
```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
```
or
```cpp
using BoolIntPair = std::pair<bool, int>;
MOCK_METHOD(BoolIntPair, GetPair, ());
```

### Tips

<Tip>
If you are new, begin with small, simple tests using the `TEST()` macro and progressively add complexity.
</Tip>

---

## 2. Linking Failures

### Common Causes

- Forgetting to link with the `gtest` or `gmock` libraries.
- Incorrect order of libraries in link flags.
- Mixing debug and release versions of libraries and tests.
- Missing `gtest_main` when relying on the default `main()` function.

### How to Fix Linking Issues

1. Link with `gtest` and/or `gmock` libraries explicitly in your build system.
2. If you want your tests to have a default `main()`, link with `gtest_main` (or `gmock_main`).
3. Ensure libraries and your tests are built with compatible compiler flags and runtimes.
4. Verify the order of linking places GoogleTest libraries after your test object files.

### Example Link Setup with CMake

```cmake
find_package(GTest REQUIRED)

add_executable(my_tests test1.cc test2.cc)
target_link_libraries(my_tests PRIVATE GTest::gtest_main GTest::gmock)
```

---

## 3. Missing Dependencies

GoogleTest depends only on standard C++ and system libraries, but some components require additional dependencies:

- On Windows, linking against specific system libraries may be required.
- On Linux and macOS, you may need pthread (`-lpthread`) explicitly.

### Fix

Make sure to adjust your build to link necessary system libraries. For example, add `-lpthread` when building.

---

## 4. Runtime Failures and Misbehavior

### Common Runtime Issues

- Tests crashing unexpectedly.
- Tests hanging or running indefinitely.
- Unexpected test results, such as all tests failing or passing.

### Diagnosing Runtime Issues

1. **Initialization:** Confirm that your `main()` is properly calling `testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS()`.
2. **Thread Safety:** GoogleTest is thread-safe on pthread-based systems; avoid running assertions concurrently from multiple threads on unsupported platforms.
3. **Test Fixtures:** Ensure you do not share mutable state across tests unless intended, to preserve test independence.
4. **Exception Handling:** GoogleTest catches exceptions by default (controlled by `--gtest_catch_exceptions`). Check if exceptions might cause unexpected behavior.

### Solutions

- Use provided default `main()` by linking with `gtest_main` unless custom setup is needed.
- Handle fatal failures correctly. Use `ASSERT_*` to abort problematic tests.
- Use tools like `SCOPED_TRACE` to add context to your tests to aid debugging.
- Use the `--gtest_break_on_failure` flag to cause debugger breakpoints at failed assertions.

---

## 5. Common Pitfalls Checklist

- ✔️ **Don’t call `RUN_ALL_TESTS()` multiple times.**
- ✔️ **Return the result of `RUN_ALL_TESTS()` from `main()`.**
- ✔️ **Avoid mixing `TEST()` and `TEST_F()` in the same test suite.**
- ✔️ **Use `TEST_F()` only with defined fixture classes derived from `testing::Test`.**
- ✔️ **Name test suites and tests without underscores to prevent internal issues.**
- ✔️ **Avoid ignoring compiler warnings and errors; fix them instead.**

---

## 6. Troubleshooting Steps Summary

<Steps>
<Step title="Fix Compilation Errors">
  Check include paths, macro usage, and compiler version.
</Step>
<Step title="Resolve Linking Failures">
  Confirm all required libraries are linked correctly.
</Step>
<Step title="Verify Dependencies">
  Ensure system libraries like pthread are linked.
</Step>
<Step title="Validate Test Program Setup">
  Confirm `InitGoogleTest` and `RUN_ALL_TESTS` usage.
</Step>
<Step title="Isolate Runtime Failures">
  Use debugger flags, `SCOPED_TRACE`, and proper fixtures.
</Step>
</Steps>

---

## 7. Getting Further Help

- Review the [GoogleTest Primer](overview/introduction-product-value/what-is-googletest).
- Consult the [GoogleMock Cookbook](docs/gmock_cook_book.md) for detailed mocking troubleshooting.
- Check the [Assertions Reference](docs/reference/assertions.md) for assertion-related issues.
- Visit the [Community Support & Resources](faq/community-support/help-channels) page.

<Note>
Do not hesitate to open issues or ask questions on the official [GoogleTest GitHub repository](https://github.com/google/googletest), providing detailed error messages, environment details, and minimal reproducible examples.
</Note>

---

## Related Documentation

- [GoogleTest Primer](/overview/introduction-product-value/what-is-googletest)
- [GoogleMock Cookbook](docs/gmock_cook_book.md)
- [Test Registration and Structure](api-reference/core-testing-apis/test-registration-and-structure)
- [Core Matchers Reference](api-reference/matcher-and-mocking-apis/core-matchers-reference)
- [Assertions Reference](docs/reference/assertions.md)
- [Basic Setup & First Test](getting-started/basic-setup-first-test/configure-project)
- [Troubleshooting Common Issues](getting-started/troubleshooting-validation/common-issues)

---

<Info>
This page focuses specifically on common build and test issues encountered when working with GoogleTest and GoogleMock. For broader understanding, including architecture, mocking patterns, and advanced usage, consult the guides and references linked above.
</Info>