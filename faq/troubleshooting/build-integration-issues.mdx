---
title: "Why are my tests not building or linking?"
description: "Explains typical causes of build or linker problems, such as missing includes, configuration issues, or version mismatches. Provides checklists and references to streamline troubleshooting for both platforms and build systems."
---

# Why Are My Tests Not Building or Linking?

When working with GoogleTest and GoogleMock, encountering build or linking failures is a common hurdle. This documentation helps you understand typical causes behind such problems and guides you through effective troubleshooting to get your tests compiling and linking correctly.

---

## Common Causes of Build and Linking Issues

### 1. Missing or Incorrect Header Includes
Tests often fail to build when necessary GoogleTest or GoogleMock headers are not correctly included.

- **Ensure** you `#include <gtest/gtest.h>` and/or `#include <gmock/gmock.h>` as needed.
- Avoid circular or redundant includes that may cause compilation errors.

### 2. Not Linking with Test Libraries
Your build system must link the test binaries with the appropriate GoogleTest and GoogleMock libraries.

- For most setups, link against `gtest`, `gmock`, and optionally `gmock_main` if you want the default main() entry point.
- **Missed linking** will cause unresolved symbol errors.

### 3. Mismatched or Unsupported Compiler and C++ Standard
GoogleTest requires compliant C++11 (or newer) compilers.

- Verify your compiler supports necessary standards.
- Confirm your build flags specify at least `-std=c++11`.

### 4. Incorrect or Missing Initialization
Your test binaries must call `testing::InitGoogleMock()` before running tests.

- Forgetting to initialize can prevent tests from running and fail the build in some setups.

### 5. Version Mismatches or Mixed Builds
If different parts of your project use conflicting versions of GoogleTest or GoogleMock, build and link problems can arise.

- Be consistent in versions and build environments.

### 6. Build System Misconfiguration
Improper build system setups (CMake, Bazel, Makefiles, etc.) frequently cause test build/link failures.

- Check dependency declarations, include directories, link libraries, and target scopes.

### 7. Platform-Specific Issues
Some platforms require special compiler flags or definitions.

- Confirm platform compatibility (Windows vs Linux vs macOS).
- Adapt build rules accordingly.

---

## Checklist for Troubleshooting Build and Link Problems

Follow this systematic approach to resolve issues efficiently:

<Steps>
<Step title="Verify Header Includes">
- Confirm inclusion of `<gtest/gtest.h>` and/or `<gmock/gmock.h>` in your test source files.
- Check for missing or misplaced includes causing compiler errors.
</Step>
<Step title="Validate Build Flags and Compiler">
- Ensure compiler supports C++11 or newer.
- Check `-std=c++11` or equivalent build flags are set.
</Step>
<Step title="Confirm Linking Settings">
- Verify linking against `gtest`, `gmock`, and optionally `gmock_main` libraries.
- Adjust linker settings to reflect installed GoogleTest and GoogleMock locations.
</Step>
<Step title="Initialize GoogleMock in Test Executables">
- Call `testing::InitGoogleMock(&argc, argv)` at the start of your test main.
- If using `gmock_main`, verify no conflicting main entry points exist.
</Step>
<Step title="Check Consistent Versions">
- Use uniform versions of GoogleTest and GoogleMock across your project.
- Avoid mixing pre-built binaries from different versions.
</Step>
<Step title="Review Build System Configuration">
- Examine CMakeLists, Bazel BUILD files, or Makefiles for correct target dependencies.
- Confirm proper include directories, library targets, and linkage.
</Step>
<Step title="Inspect Platform-Specific Flags">
- Add or adjust platform-specific compiler/linker flags.
- Review known platform quirks for GoogleTest and GoogleMock.
</Step>
</Steps>

---

## Common Error Messages Explained

### "undefined reference to..."
Usually indicates missing linkage against GoogleTest or GoogleMock libraries.

- Make sure to link with the appropriate static or shared libraries.

### Missing `main()` Function Errors
If you do not provide a `main()` manually and do not link `gmock_main`, tests cannot link.

- Link with `gmock_main` or write your own `main` that calls `InitGoogleMock()` and `RUN_ALL_TESTS()`.

### Compilation Errors on MOCK_METHOD or EXPECT_CALL
Indicates missing include `<gmock/gmock.h>` or C++ standard issues.

- Confirm correct headers and compiler support.

---

## Practical Tips for Successful Builds

- Use `gmock_main` target/library unless you want to write your own test main function.
- For CMake, link tests as:

```cmake
add_executable(MyTests my_tests.cc)
target_link_libraries(MyTests gmock gmock_main pthread)  # pthread for POSIX
```

- If tests do not build or link, isolate the problem by building a minimal test case.
- Check your environment variables and include paths.

---

## References for Further Help

- [Installation Instructions](../../getting-started/setup-basics/installation-instructions) - Complete setup and build guidance.
- [Configuration & Environment Setup](../../getting-started/setup-basics/configuration-setup) - How to configure your environment for GoogleTest and GoogleMock.
- [Troubleshooting Common Setup Issues](../../getting-started/first-test-run/troubleshooting-setup) - Diagnosing common installation and integration mistakes.
- [Integration Patterns and Build Systems](../../concepts/performance-integration/integration-patterns-build-systems) - For advanced build system configurations.

---

## Summary

Build and linking issues often stem from missing includes, improper linkage, compiler standard mismatches, or build system misconfiguration. Methodically verifying header files, build flags, linkage settings, and initialization routines will solve most problems. Consult the references above for comprehensive instructions and examples.

<Tip>
Ensuring that expectations and mock methods are defined in `public:` sections and that test binaries link to the correct GoogleTest and GoogleMock libraries is crucial for hassle-free test build and execution.
</Tip>

---

## Troubleshooting Flow for Failed Builds

<AccordionGroup title="Troubleshooting Steps">
<Accordion title="Build fails during compilation">
- Check that `<gtest/gtest.h>` and `<gmock/gmock.h>` are included.
- Verify that your compiler supports C++11 and relevant flags are set.
- Look for syntax errors related to mock macros (`MOCK_METHOD`).
</Accordion>
<Accordion title="Linker reports undefined symbols">
- Confirm your link commands include `-lgmock -lgtest -lgmock_main` as needed.
- Ensure library search paths are set correctly.
- Use verbose linker output to diagnose missing symbols.
</Accordion>
<Accordion title="Missing main function errors">
- Use `gmock_main` library to provide a default `main()`.
- Alternatively, supply your own `main()` that calls `testing::InitGoogleMock()` and `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="Version or platform incompatibilities">
- Match GoogleTest and GoogleMock versions.
- Verify platform support and required dependencies.
</Accordion>
</AccordionGroup>
