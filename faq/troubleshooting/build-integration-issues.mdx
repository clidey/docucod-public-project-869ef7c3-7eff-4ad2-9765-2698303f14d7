---
title: "Build, Linking, and Integration Issues"
description: "Covers solutions to common build and linking errors—including CMake, Bazel, and custom build systems—as well as advice on integrating GoogleTest/GoogleMock with other frameworks or languages."
---

# Build, Linking, and Integration Issues FAQ

This FAQ section addresses the common problems and practical solutions related specifically to building, linking, and integrating GoogleTest and GoogleMock within diverse environments—including CMake, Bazel, and custom build systems. Additionally, it provides guidance on how to integrate GoogleTest/GoogleMock alongside other frameworks or languages.

---

## 1. Common Build and Linking Problems

### 1.1. How do I properly build GoogleTest and GoogleMock using CMake?

Building GoogleTest (and GoogleMock) using CMake involves the following standard steps:

<Steps>
<Step title="Clone the repository">
Clone the GoogleTest repo with:
```bash
git clone https://github.com/google/googletest.git -b v1.17.0
```
</Step>
<Step title="Create a build directory">
Inside the cloned folder, create and move into a build directory:
```bash
mkdir build && cd build
```
</Step>
<Step title="Configure the build">
Run CMake configuration:
- To build with GoogleMock (default):
```bash
cmake ..
```
- To build only GoogleTest:
```bash
cmake .. -DBUILD_GMOCK=OFF
```
</Step>
<Step title="Build with make or your platform's build tool">
- On Unix/Linux/macOS:
```bash
make
```
- On Windows: open the generated `.sln` in Visual Studio and build.
</Step>
</Steps>

<Note>
Ensure your compiler supports C++17 and that the CMake version is 3.14 or later for best compatibility.
</Note>

### 1.2. How can I incorporate GoogleTest and GoogleMock into my existing CMake project?

- Use `find_package(GTest CONFIG REQUIRED)` after installing GoogleTest.
- Link your test targets against `GTest::gtest` and `GTest::gmock`.

Alternatively:
- Add the GoogleTest source tree as a subdirectory using `add_subdirectory()` in your project's CMakeLists.
  This ensures consistent compiler and linker flags between your project and GoogleTest.

<Tip>
To avoid runtime library conflicts on Windows, consider toggling the `gtest_force_shared_crt` option when building GoogleTest.
</Tip>

### 1.3. What are typical causes of build failures and how can I fix them?

- **Compiler support:** GoogleTest requires C++17 support.
- **Missing dependencies:** For pthread support on Linux/macOS, ensure pthread is installed and linked.
- **Runtime library mismatch (Windows):** If you receive linker errors mentioning `RuntimeLibrary` mismatches (`MTd` vs `MDd`), use `gtest_force_shared_crt` to align CRT linkage.

<Warning>
If you use custom build systems, ensure that test targets link against both `gtest` and platform threading libraries.
</Warning>

### 1.4. How do I handle slow compilation of large mock classes?

Mock classes generate many templated methods, which can slow down compilation. Use this technique:

- Declare the mock class constructor and destructor in the header only (without inline definitions).
- Provide definitions in a `.cc` file. This way, compilation of constructor/destructor code is done once.

Example:
```cpp
class MockFoo : public Foo {
 public:
  MockFoo();
  virtual ~MockFoo();

  MOCK_METHOD(void, Bar, (), (override));
};
```

And in the source file:
```cpp
MockFoo::MockFoo() {}
MockFoo::~MockFoo() {}
```

## 2. Linking Issues

### 2.1. I get undefined references to GoogleTest or GoogleMock symbols when linking. What should I do?

- Make sure your test target links against the appropriate GoogleTest and GoogleMock libraries:
  - `gtest` and `gmock` or `gtest_main` and `gmock_main` if you use provided main functions.
- If using CMake, link targets with `GTest::gtest`, `GTest::gmock` or similar imported targets.
- For custom build systems, ensure GoogleTest/GoogleMock static or shared libs are included.
- On Linux, remember to also link with `pthread`.

### 2.2. How do I avoid runtime library conflicts on Windows?

GoogleTest is built with static linkage of the C runtime by default, which may conflict with your project settings. Fix this by:

- Enabling the `gtest_force_shared_crt` CMake option before building GoogleTest:

```bash
cmake .. -DGTEST_FORCE_SHARED_CRT=ON
```

- Ensure your test and GoogleTest use the same runtime linkage settings.

### 2.3. What about building GoogleTest/GoogleMock as shared libraries (DLLs)?

GoogleTest can be built as shared libraries by defining `GTEST_CREATE_SHARED_LIBRARY=1` during compilation. Correspondingly, tests linking against shared libs should define `GTEST_LINKED_AS_SHARED_LIBRARY=1`.

<Note>
This enables efficiency in dynamic linking and resolving issues with duplicate runtime instances but requires explicit management of these macros.
</Note>

## 3. Integrating with Other Build Systems

### 3.1. How to integrate GoogleTest/GoogleMock with Bazel?

- GoogleTest is supported natively by Bazel.
- Use Bazel rules such as `cc_test` with `@antlr4` or other dependencies.
- Ensure `gmock` is included as a dependency if mocking support is needed.
- Consult the `guides/advanced-usage/integration-workflows` documentation for sample configurations.

### 3.2. Can I integrate GoogleTest with other languages or frameworks?

- GoogleTest and GoogleMock are designed for C++ projects.
- To interoperate with other languages (e.g., Python), consider using language bindings or wrappers.
- For projects mixing languages, isolate GoogleTest tests in C++ modules.

## 4. Common Integration Pitfalls

### 4.1. Mismatched versions of GoogleTest cause undefined symbols or weird failures

- Keep GoogleTest and GoogleMock versions in sync.
- Avoid mixing headers from one version with libraries from an older or newer version.

### 4.2. Linking errors due to missing pthreads on Windows

- Windows does not have `pthread` by default; GoogleTest uses platform-native threading there.
- Try enabling appropriate threading support or disabling pthread dependencies with CMake options.

### 4.3. GoogleMock uninteresting call warnings when no expectations are set

- Use `NiceMock<T>` to suppress warnings for uninteresting calls.
- Alternatively, explicitly set expectations like `EXPECT_CALL(mock, Method).Times(AnyNumber());` to silence these warnings.

## 5. Troubleshooting Build and Integration

<AccordionGroup title="Troubleshooting Scenarios">
<Accordion title="Build Fails with Compiler Errors Related to MOCK_METHOD">
Check that:
- The `MOCK_METHOD` macro parameters are correctly wrapped when they contain commas (e.g., template types).
- `MOCK_METHOD`s are declared in `public:` sections even if mocking protected or private methods.
</Accordion>
<Accordion title="Linker Errors on Windows about CRT Mismatch">
- Enable `gtest_force_shared_crt` option.
- Ensure your project’s runtime linkage matches GoogleTest's (dynamic or static CRT).
</Accordion>
<Accordion title="Test Executable Fails to Run or Load Shared Libraries">
- Confirm dependencies and environment variables (e.g., `LD_LIBRARY_PATH` on Linux).
- Verify shared DLLs or `.so` files are built and installed correctly.
- Rebuild with static linking if dynamic linking is problematic.
</Accordion>
<Accordion title="Uninteresting Call Warnings during Tests">
- Suppress with `NiceMock` or add explicit expectations.
- Investigate whether the calls indicate test coverage holes.
</Accordion>
</AccordionGroup>

---

## 6. Best Practices for Smooth Integration

- **Set expectations before exercising mocks:** Always declare `EXPECT_CALL()` before running code under test.
- **Use sequences for ordered calls:** Use `InSequence` to enforce call order when necessary.
- **Prefer `ON_CALL` for default behavior:** Use `ON_CALL()` to specify default mock behaviors without adding strict expectations.
- **Isolate GoogleTest dependencies:** Keep GoogleTest and GoogleMock dependencies in dedicated targets.
- **Check compiler and standard settings:** Always compile with at least C++17 standard.
- **Keep versions synchronized:** Use matching versions of GoogleTest and GoogleMock.

---

## 7. Where to Get Help and Further Documentation

- Consult the [GoogleTest Project Setup Guide](/guides/getting-started/project-setup) for integration examples.
- Visit the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for practical mock usage and deeper insights.
- Read the [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) for troubleshooting tips.
- Explore the [Build and Integration Workflows guide](/guides/advanced-usage/integration-workflows) for CI and large-scale project integrations.

<Tip>
If you encounter build or toolchain-specific problems, confirm your tool versions and consider checking platform compatibility listed in the prerequisites documentation.
</Tip>

---