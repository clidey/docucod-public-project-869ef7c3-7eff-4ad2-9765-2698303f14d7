---
title: "Resolving Build and Integration Errors"
description: "Detailed advice on addressing compilation issues, linker problems, and misconfigurations when integrating GoogleTest with various build systems like CMake and Bazel. Includes actionable tips for debugging and resolving common project setup pitfalls."
---

# Resolving Build and Integration Errors

This page provides detailed guidance on diagnosing and resolving common build-time and integration issues encountered when incorporating GoogleTest and GoogleMock into C++ projects. It focuses on compilation errors, linker failures, and misconfigurations particularly with support for major build systems like CMake and Bazel. Practical tips and troubleshooting steps help developers establish a smooth setup and integration experience.

---

## Frequently Asked Questions (FAQs)

### Why am I facing compilation errors when building tests with GoogleTest and GoogleMock?

Compilation errors commonly arise due to missing include directories, misconfigured compiler flags, or use of unsupported C++ standards. To ensure smooth compilation:

- Confirm that your build system includes the directory containing `gmock` and `gtest` headers.
- Verify you are compiling with **at least C++17** support enabled, as GoogleTest requires this standard or later.
- Check for proper inclusion order; `#include <gmock/gmock.h>` generally includes all necessary headers.
- If you see errors related to unresolved templates or macros, make sure your code follows the `MOCK_METHOD` syntax correctly.


### What linker errors might I encounter when integrating GoogleTest with CMake or Bazel?

The most frequent linker errors include unresolved symbols related to GoogleTest or GoogleMock functions. This typically indicates:

- Missing linkage to the actual GoogleTest and GoogleMock libraries.
- Conflicts between static and dynamic linking options.
- Incorrect or absent `target_link_libraries()` directives in CMake.
- Missing dependencies or libraries when building with Bazel.


### How can I resolve missing symbols or undefined reference errors?

1. **In CMake**:

   - Make sure you have linked both GoogleTest and GoogleMock libraries explicitly, for example:
   
   ```cmake
   target_link_libraries(your_test_target gmock gtest pthread)
   ```

   - Confirm that the `gmock` and `gtest` targets or libraries exist and are findable.
   - Use the `find_package(GTest REQUIRED)` followed by linking `${GTEST_BOTH_LIBRARIES}` if available.

2. **In Bazel**:

   - Include the appropriate GoogleTest and GoogleMock dependencies in your `BUILD` files.
   - Use `cc_test` with `deps` pointing to `@com_google_googletest//:gmock_main` or related test libraries.

3. **General Recommendations**:

   - Check the linker search paths.
   - Avoid mixing debug and release versions of libraries.
   - If using prebuilt binaries, verify their compatibility with your environment and compile flags.


### What are common pitfalls in project setup that lead to integration problems?

- Overlooking to link GoogleMock when expectations or mocks are used.
- Inconsistent C++ standards across different targets within a project.
- Defining mock methods incorrectly, leading to compilation errors around `MOCK_METHOD` macros.
- Not providing a virtual destructor in interfaces to be mocked, causing runtime issues.
- Mixing static and dynamic linkage without careful configuration, causing duplicate symbols or unresolved symbols.


### Any tips for debugging build and integration problems?

- Enable verbose build output (`make VERBOSE=1` or equivalent) for CMake to spot missing flags.
- Use `nm`, `objdump`, or equivalent tools to inspect symbols in your compiled libraries.
- Run simple test programs that only include GoogleTest or GoogleMock to isolate issues.
- Validate your `CMakeLists.txt` or `BUILD` files with minimal configurations before expanding.
- Review GoogleTest and GoogleMock version compatibility with your compiler and platform.


---

## Common Issues & Gotchas

### C++ Standard Compatibility

GoogleTest requires C++17 or later. Using an older standard without necessary flags leads to parsing and semantic errors, especially with templates and lambdas.

Ensure your project explicitly sets the standard, for example in CMake:

```cmake
target_compile_features(your_target PUBLIC cxx_std_17)
```


### Including Headers Properly

Include `gmock/gmock.h` instead of just `gtest/gtest.h` if you use mocking features.
Ensure include paths cover both GoogleMock and GoogleTest headers.


### Linking Order and Dependencies

In CMake, the order of linked libraries matters. GoogleMock typically depends on GoogleTest and pthreads.
Always link `gmock` before `gtest`.


### Overloaded and Const Methods in Mocks

When mocking overloaded or const-qualified methods, ensure you specify qualifiers correctly in `MOCK_METHOD`. Otherwise, you might get build errors or ambiguous references.

Example:

```cpp
MOCK_METHOD(int, GetValue, (), (const, override));
```


### Using GoogleMock and GoogleTest in Bazel

Bazel users must depend on the right targets such as `@com_google_googletest//:gmock_main` for linking.
Not setting these dependencies results in missing symbols.


---

## Troubleshooting Procedures

<Steps>
<Step title="Verify Include Paths and Compiler Flags">
Check that your build configuration includes the correct include directories for GoogleTest and GoogleMock.
Confirm that compiler flags enable C++17 or later.
</Step>
<Step title="Check Library Linking">
Ensure GoogleMock and GoogleTest libraries are linked in your executable target.
Verify linking order and dependencies.
</Step>
<Step title="Test Minimal Example">
Create a minimal test file that compiles and runs a simple test using GoogleTest or GoogleMock to isolate issues.
</Step>
<Step title="Analyze Error Messages">
Read and interpret compiler and linker error outputs carefully.
Look for missing symbols, incompatible types, or wrong method signatures.
</Step>
<Step title="Use Verbose Build Output">
Enable verbose output for your build system to see detailed compiler and linker commands.
It helps identify missing flags or paths.
</Step>
</Steps>

---

## Best Practices & Recommendations

- Always pin your GoogleTest and GoogleMock versions in your dependency manager or submodule to ensure consistent behavior.
- Follow GoogleMock’s mocking guidelines by defining mock methods in `public:` sections.
- Prefer defining virtual destructors on interfaces to avoid runtime issues.
- Use `ON_CALL` and `EXPECT_CALL` appropriately to define behaviors and expectations.
- Use `NiceMock` or `StrictMock` wrappers to control the behavior of uninteresting calls, depending on your test needs.
- Regularly update your build configuration to support best compiler flags and dependencies.

---

## Additional Resources

- [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — for advanced mocking recipes.
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) — comprehensive API reference.
- [Installing GoogleTest and GoogleMock](../getting-started/prerequisites-installation/installation-instructions) — steps for installation.
- [Project Configuration](../getting-started/configuration-initial-run/project-setup) — how to configure your build system.
- [Integration Examples Guide](../guides/core-workflows/integration-examples) — examples of CMake and Bazel integration.
- [Troubleshooting Installation & Configuration](../getting-started/troubleshooting-common-issues/common-setup-issues) — common issues and solutions.


---

For cross-reference, see:

- The [Mocking Reference](../api_reference/mocking_api/mock_object_basics) for writing mock classes.
- The [GoogleTest Assertions API](../api_reference/test_framework_api/assertions) for verifying test outcomes.

By following the above guidance and referencing these documents, users will gain the skills to resolve most build and integration errors encountered when setting up GoogleTest and GoogleMock in their projects.
