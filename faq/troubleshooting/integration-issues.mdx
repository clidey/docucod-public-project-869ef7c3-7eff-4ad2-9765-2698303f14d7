---
title: "Integration with Build Systems and CI"
description: "Addresses questions on integrating GoogleTest with popular build systems (CMake, Bazel), handling continuous integration workflows, and working with related projects or extensions."
---

# Integration with Build Systems and CI

## Overview

This FAQ addresses common questions about integrating GoogleTest with popular build systems like CMake and Bazel, managing Continuous Integration (CI) workflows, and working with related projects or extensions. Whether you are setting up tests in a new project or automating test runs on CI servers, this page provides practical guidance to ensure smooth integration and reliable test execution.

---

## Frequently Asked Questions

### 1. How do I integrate GoogleTest with CMake?

GoogleTest provides a CMake build script that you can use as a standalone project or incorporate into your existing CMake project. The typical workflow is:

- Clone or download GoogleTest sources.
- Create a build directory and run `cmake ..` to generate build files.
- You can build GoogleTest and GoogleMock together by default, or pass `-DBUILD_GMOCK=OFF` to build only GoogleTest.
- To integrate with your existing project, use `find_package(GTest CONFIG REQUIRED)` if GoogleTest is installed.
- Alternatively, add GoogleTest as a subdirectory in your CMake project with `add_subdirectory()` and link your test targets against `gtest` or `gtest_main`.

Example minimal integration:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Visual Studio runtime consistency.
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

Refer to the [Installing with CMake Guide](https://github.com/google/googletest/blob/main/docs/installation-cmake.mdx) for full details.

### 2. How do I add GoogleTest to Bazel projects?

You can add GoogleTest and GoogleMock as dependencies in Bazel by:

- Including GoogleTest repositories with Bazel workspace rules.
- Defining build targets for your test binaries that link against `@com_google_googletest//:gtest` and `@com_google_googletest//:gmock`.
- Running test binaries with Bazel's test command.

For detailed instructions, see the [Installing with Bazel Guide](https://github.com/google/googletest/blob/main/docs/installation-bazel.mdx).

### 3. How can I run GoogleTest tests in Continuous Integration pipelines?

To run GoogleTest in CI systems like GitHub Actions, Jenkins, or GitLab:

- Build your test binaries using your build system (CMake, Bazel, etc.).
- Run tests from command line as part of pipeline steps.
- Use GoogleTest flags to generate machine-readable output:
  - `--gtest_output=xml:path/to/report.xml` to generate XML reports.
  - Combine with `--gtest_filter` to run specific subsets.
- Integrate the XML output into CI test reporters for visibility.

Example:

```bash
./my_test_binary --gtest_output=xml:report/test_results.xml --gtest_filter=*
```

Refer to the [Integrating with CI Guide](https://github.com/google/googletest/blob/main/guides/integration-and-real-world-use/integration-ci.mdx) for best practices and troubleshooting.

### 4. What are common integration pitfalls and how do I troubleshoot them?

Common issues include:

- **Build errors** due to missing include paths or incorrect linking.
  - Ensure `gtest`/`gmock` headers and libraries are correctly referenced.
  - In CMake, link your test targets properly using `target_link_libraries`.
- **Runtime failures** if test environment is not set up properly.
  - Confirm `testing::InitGoogleTest()` is called before `RUN_ALL_TESTS()`.
- **CI failures in parsing test results.**
  - Make sure your CI tool expects the report format and path.
- **Threading and platform compatibility.**
  - Some platforms require specific compiler flags or environment variables.

See [Common Errors & Their Solutions](https://github.com/google/googletest/blob/main/faq/troubleshooting/common-errors.mdx) and [Integration Issues FAQ](https://github.com/google/googletest/blob/main/faq/troubleshooting/integration-issues.mdx) for detailed help.

### 5. How do I integrate GoogleTest with IDEs and third-party tools?

GoogleTest integrates well with many popular IDEs (Visual Studio, CLion, Eclipse), providing test discovery and execution features. Use CMake integration or IDE-specific plugins to:

- Detect test targets.
- Display test status.
- Run tests and debug them interactively.

Additionally, configure GoogleTest to output XML for coverage tools and test reporters. Documentation on integrating with IDEs and coverage tools is available in the [Integration with Other Tools Guide](https://github.com/google/googletest/blob/main/guides/integration-and-real-world-use/integration-other-tools.mdx).

### 6. How can I customize test execution in CI?

You can control your tests in CI using GoogleTest's rich command line options:

- Run only specific tests with `--gtest_filter`.
- Repeat tests with `--gtest_repeat` to find flaky tests.
- Produce XML or JSON output for test results.
- Enable sharding for parallel test execution with `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX` environment variables.

Ensure to report the exit status from `RUN_ALL_TESTS()` as the CI job success criteria.

---

## Common Integration Workflows

<Steps>
<Step title="Setting Up GoogleTest with CMake">
- Add GoogleTest as a subdirectory or via FetchContent.
- Link test targets against `gtest_main`.
- Call `testing::InitGoogleTest()` in your `main()`.
- Run tests with `RUN_ALL_TESTS()`.
</Step>
<Step title="Running Tests on CI">
- Build test binaries using your build system.
- Run test binaries with appropriate flags, e.g., XML output.
- Upload XML results to CI test report dashboards.
- Use filtering and repeat flags as needed.
</Step>
<Step title="Automating via Scripts">
- Write scripts to build and run tests.
- Make sure to propagate the return code of `RUN_ALL_TESTS()`.
- Combine with coverage and lint steps for full pipeline.
</Step>
</Steps>

---

## Troubleshooting Integration

<AccordionGroup title="Common Issues and Tips">
<Accordion title="Build and Link Errors">
- Verify include directories: `gtest/include` and `gmock/include`.
- Check link libraries: `gtest`, `gmock`, `pthread` (Linux).
- For CMake, link with `target_link_libraries(your_test PRIVATE gtest_main)`.
</Accordion>
<Accordion title="Missing Tests at Runtime">
- Confirm all tests register before running.
- Ensure `testing::InitGoogleTest` is called early in `main()`.
- Check for disabled tests (`DISABLED_` prefix).
</Accordion>
<Accordion title="CI XML Reports Not Recognized">
- Verify output path and permissions.
- Confirm the CI tool supports GoogleTest jUnit XML format.
- Use GoogleTest flag `--gtest_output=xml:path` exactly.
</Accordion>
<Accordion title="Test Failures on CI but Not Locally">
- Check environment differences.
- Verify test filters and sharding settings.
- Use `--gtest_break_on_failure` to debug within CI.
</Accordion>
</AccordionGroup>

---

## Additional Resources and References

- [Installing with CMake](https://github.com/google/googletest/blob/main/docs/installation-cmake.mdx)
- [Installing with Bazel](https://github.com/google/googletest/blob/main/docs/installation-bazel.mdx)
- [Integration with CI Systems](https://github.com/google/googletest/blob/main/guides/integration-and-real-world-use/integration-ci.mdx)
- [Common Errors & Their Solutions](https://github.com/google/googletest/blob/main/faq/troubleshooting/common-errors.mdx)
- [Test Lifecycle and Discovery](https://github.com/google/googletest/blob/main/concepts/core-architecture/test-lifecycle-and-discovery.mdx)
- [Configuring Your Project](https://github.com/google/googletest/blob/main/getting-started/configuration-validation/project-integration.mdx)

---

## Summary

Integrating GoogleTest efficiently into build systems and CI pipelines ensures reliable, scalable, and maintainable automated testing. Clear understanding of setup steps, command-line options, and proper environment configuration will minimize friction.

<Tip>
Always use `testing::InitGoogleTest()` before `RUN_ALL_TESTS()` and return its value from your `main()` function to correctly indicate test success or failure in CI environments.
</Tip>

<Tip>
Take advantage of GoogleTest's XML and JSON output flags to integrate seamlessly with CI testing dashboards and coverage tools.
</Tip>