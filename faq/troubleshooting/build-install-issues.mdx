---
title: "Why won't GoogleTest or GoogleMock build or install?"
description: "Collection of common pitfalls (like missing C++17, incorrect include paths, CMake/Bazel issues) and step-by-step advice on resolving installation and compilation problems for a range of environments."
---

# Why won't GoogleTest or GoogleMock build or install?

This page guides you through the common pitfalls and step-by-step advice to troubleshoot build and installation problems you might encounter with GoogleTest and GoogleMock. Whether you see compilation failures, linking errors, or installation issues across various platforms and build systems, this FAQ helps you understand the root causes and how to fix them.

---

## 1. Common Pitfalls That Block Builds

### Missing or Incorrect C++17 Support

GoogleTest and GoogleMock require C++17 support. If your compiler or build system does not enable C++17 or uses an older standard, build failures will occur.

- **Symptoms:**
  - Errors about unknown language features.
  - Failures related to type traits, template features, or `std::unique_ptr` with move-only types.
  
- **Resolution Steps:**
  - Verify your compiler version meets the minimum requirements (e.g. GCC 7.4+, Clang 5.0+, MSVC 2017+).
  - Ensure your build files specify `-std=c++17` (or equivalent for MSVC).
  - Check for explicit flags that disable C++17 or override the language standard.

### Incorrect or Missing Include Paths

GoogleTest/GMock depend on proper inclusion of headers and source files.

- **Symptoms:**
  - Compilation errors stating missing `gtest/gtest.h` or `gmock/gmock.h`.
  - Errors about undefined symbols due to missing source files.

- **Resolution Steps:**
  - Confirm the include path points to GoogleTest's include directory.
  - For source builds, make sure your build system compiles `gtest_main.cc` or includes the GoogleTest source files.
  - In CMake, use the official `FetchContent` or `add_subdirectory` methods to pull GoogleTest correctly.
  
### CMake and Bazel Configuration Issues

Misconfiguration of build systems is a primary root cause of build failures.

- **Common issues:**
  - Misaligned C++ standard in your CMake or Bazel build.
  - Linking errors due to missing GoogleTest or GoogleMock libraries.
  - Runtime library mismatches, especially on MSVC (e.g., static vs dynamic runtime).

- **Resolution Tips:**
  - Follow the official installation guides for CMake and Bazel carefully.
  - Verify that GoogleTest targets are linked correctly to your test executables.
  - Avoid mixing debug and release runtime libraries.
  - For CMake, consider using `enable_testing()` and `gtest_discover_tests()`.

### Platform or Compiler Not Supported

Your platform or compiler might not be officially supported or might require special flags.

- **Symptoms:**
  - Compiler errors with obscure or undefined identifiers.
  - Tests or mocks failing unexpectedly or failing to build.

- **Resolution Steps:**
  - Check the [Supported Platforms & Compilers](https://github.com/google/googletest/blob/main/docs/supported_platforms.md) documentation.
  - Ensure your environment matches the listed requirements (for example, requires std::thread support).
  - Review platform-specific notes, like handling MSVC runtime mismatches or embedded platform limitations.

---

## 2. Step-by-Step Installation & Build Troubleshooting

### Step 1: Verify Your Development Environment

- Confirm your compiler supports C++17 and its version.
- Check that necessary tools like CMake or Bazel are installed and meet minimum versions.
- Use commands like `gcc --version` or `clang --version` to inspect.

### Step 2: Check Your Build Configuration

- Ensure your build system enables C++17.
- For CMake, confirm you're using `set(CMAKE_CXX_STANDARD 17)` and that it propagates to tests.
- For Bazel, verify toolchains support C++17 or specify the standard.
- Confirm that source directories and include paths for Googletest and GoogleMock are included.

### Step 3: Inspect Your Linking Setup

- Make sure your test binaries link against GoogleTest and GoogleMock libraries.
- Static and dynamic runtime mix-ups are common on Windows. Use matching runtime flags.
- If you manually compile source files, ensure both `gtest` and `gmock` sources are compiled and linked.

### Step 4: Run a Minimal Test

- Try building and running one of the provided GoogleTest/GoogleMock sample tests.
- If sample tests fail, troubleshoot environment; else, isolate your own project configuration.

### Step 5: Enable Verbose Build Output

- Enable verbose output in your build system (e.g., `make VERBOSE=1` or `bazel build --verbose_failures`).
- Review exact compiler and linker commands to verify correctness.

### Step 6: Consult Logs and Error Messages

- Identify error patterns indicating missing headers, undefined symbols, or incompatible flags.
- Cross-reference errors with known issues listed below.

---

## 3. Common Error Messages & What They Mean

### "No C++17 support detected"

Occurs when your compiler or toolchain doesn't support C++17 or the flag enabling it.

**Fix:** Upgrade compiler or add appropriate `-std=c++17` flag.

### "Cannot find gtest/gtest.h or gmock/gmock.h"

Header include paths missing or incorrect.

**Fix:** Add GoogleTest include directory to `-I` includes; if using CMake, ensure GoogleTest is added properly.

### "Undefined reference to `testing::InitGoogleMock`"

Linker can't find the GoogleMock library or source object.

**Fix:** Link against `gmock` and `gtest` libraries or compile their sources explicitly.

### "MSVC runtime library mismatch warnings (C4996, C4251, etc.)"

Microsoft Visual Studio runtime library versions are mismatched across your project and dependencies.

**Fix:** Align your project and Googletest builds to use the same runtime (e.g. `/MD` or `/MT`).

### "Mock methods not found or mocking virtual methods fails"

Possibly missing `virtual` keyword or mock methods misdefined.

**Fix:** Ensure methods mocked are virtual; see [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) for details.

### "COMPILE ERROR: macro redefinition or unprotected comma in MOCK_METHOD"

Unprotected commas confusing the macro parser.

**Fix:** Wrap argument or return types with parentheses or use alias types.

---

## 4. Best Practices to Avoid Installation Issues

- Always call `InitGoogleMock()` before running tests.
- Use `FetchContent` or `add_subdirectory` in CMake for GoogleTest integration.
- Keep compiler and build tools up to date.
- Mock only virtual functions, and always in the `public:` section.
- Wrap complicated argument types in parentheses or use type aliases with `MOCK_METHOD`.
- Verify your project and GoogleTest share the same C++ standard and runtime flags.
- Use `NiceMock`, `StrictMock`, or `NaggyMock` wisely to control warning verbosity.

---

## 5. Where to Get Help

If you continue to have trouble building or installing GoogleTest or GoogleMock:

- Review the [Common Installation Problems](https://github.com/google/googletest/blob/main/docs/installation.md) documentation.
- Check the [GoogleTest Issues on GitHub](https://github.com/google/googletest/issues) for existing bugs or ask questions.
- Browse the [Getting Help & Community Resources](https://github.com/google/googletest/blob/main/docs/help.md) page for forums and discussion groups.
- Join GoogleTest's mailing list or community chat to interact with other users.

---

## Additional References

- [Supported Platforms & Compilers](https://github.com/google/googletest/blob/main/docs/supported_platforms.md) - verify environment compatibility
- [Building and Running Tests](https://github.com/google/googletest/blob/main/docs/build.md) - ensure proper integration
- [Mock Class Definitions](https://google.github.io/googletest/reference/mocking.html#mock-classes) - how to declare mocks
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) - answers to common mocking issues
- [Configuring Build Systems](https://github.com/google/googletest/blob/main/docs/cmake.md) - detailed CMake integration guide
- [Installation Guides](https://github.com/google/googletest/tree/main/docs) - full set of documentation

---

By following the above advice, you can diagnose and resolve most build and installation issues, enabling smooth integration of GoogleTest and GoogleMock into your development workflow.
