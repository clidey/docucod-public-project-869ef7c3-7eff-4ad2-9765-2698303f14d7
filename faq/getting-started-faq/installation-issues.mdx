---
title: "Installation and Setup Issues"
description: "Discover solutions to common problems encountered during installation or initial setup. This page helps users troubleshoot missing dependencies, build errors, and environment mismatches that often appear when integrating GoogleTest or GoogleMock."
---

# Installation and Setup Issues

Discover solutions to common problems encountered during installation or initial setup. This page helps you troubleshoot missing dependencies, build errors, and environment mismatches that often appear when integrating GoogleTest or GoogleMock.

---

## Frequently Asked Questions

### What are the primary steps to build and install GoogleTest?
To build GoogleTest as a standalone project, follow these steps:

```bash
# Clone the specified release version
$ git clone https://github.com/google/googletest.git -b v1.17.0
$ cd googletest

# Create a build directory
$ mkdir build
$ cd build

# Generate build scripts (includes GoogleMock by default)
$ cmake ..

# To build only GoogleTest
$ cmake .. -DBUILD_GMOCK=OFF

# Build the project (Unix systems)
$ make

# Optionally install (requires admin privileges)
$ sudo make install
```

On Windows, after running `cmake ..`, Visual Studio solution files will be generated, which you can build using Visual Studio. On Mac OS X, an Xcode project file will appear.


### What if I want to include GoogleTest in my existing CMake project?
There are several approaches:

- Use `find_package(GTest CONFIG REQUIRED)` to import installed libraries like `GTest::gtest` and `GTest::gmock`.
- Embed GoogleTest sources using `add_subdirectory()` inside your project's `CMakeLists.txt`. This keeps compiler/linker settings consistent across your project and tests.
- Download GoogleTest sources during the configure step with CMake's `FetchContent` module, ensuring up-to-date and automated inclusion.

Example of using CMake FetchContent to incorporate GoogleTest:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # Fixes Visual Studio runtime mismatch.

FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

> **Note:** CMake 3.14 or newer is required for `FetchContent_MakeAvailable()`.


### What does the error about Visual Studio Runtime Library (RuntimeLibrary mismatch) mean, and how do I fix it?

When using Visual Studio, your project might be configured to link against the Dynamic Runtime (MD/MDd), but GoogleTest by default links statically (MT/MTd). This causes a linker error with messages like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

**Solution:** Enable the CMake option `gtest_force_shared_crt` when building GoogleTest:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

This makes GoogleTest link with the dynamic runtime to match your project's settings.


### My build fails due to missing pthreads; how can I resolve this?

GoogleTest requires multi-threading support, which depends on pthread on \'nix systems. If your environment does not correctly detect pthread, or you encounter linker errors related to `pthread`, specify the pthread availability explicitly:

- To force enable pthread:

  ```
  -DGTEST_HAS_PTHREAD=1
  ```

- To disable pthread support:

  ```
  -DGTEST_HAS_PTHREAD=0
  ```

When using your own build system without CMake, make sure to link against pthread by adding `-lpthread` or the equivalent flag. The CMake build scripts handle this automatically.


### What C++ standard is required to build GoogleTest?

GoogleTest requires an environment with at least C++17 support.

To ensure the correct standard is used in your CMake project, add:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Or provide C++ flags manually with:

```bash
-DCMAKE_CXX_FLAGS="-std=c++17"
```


### Can GoogleTest be built as a shared library (DLL) instead of static?

Yes. By default, GoogleTest builds static libraries for simplicity, but you can enable shared libraries with compiler flags:

- When building GoogleTest as a shared library, add:

  ```
  -DGTEST_CREATE_SHARED_LIBRARY=1
  ```

- When building your tests that link to the shared GoogleTest library, add:

  ```
  -DGTEST_LINKED_AS_SHARED_LIBRARY=1
  ```

You will also need to configure your linker to produce shared libraries as per your platform's requirements.

> **Tip:** Even if not strictly required now (e.g., GCC), providing these flags prepares your build system for future versions and prevents future build breakages.


### What is the recommended way to avoid macro name clashes with GoogleTest macros?

Because C++ macros are global and can clash with other libraries or your code, GoogleTest allows you to rename conflicting macros.

For example, if macro `TEST` conflicts, build with:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

In your test code, you then must use the renamed macros explicitly with the `GTEST_` prefix, e.g.:

```cpp
GTEST_TEST(SomeTest, DoesThis) { ... }
```

Similarly, this applies to other commonly used macros like `ASSERT_EQ`, `EXPECT_TRUE`, and `FAIL`.


## Common Issues & Gotchas

### Missing Dependencies or Headers

- **Symptom:** Compilation error citing missing pthread or related headers.
- **Cause:** System missing pthread library or headers, or build system not linking pthread.
- **Fix:** Install pthread development package for your OS and ensure your build links pthread (`-lpthread`).

### CMake Version Too Old

- **Symptom:** Error about `FetchContent_MakeAvailable` not found.
- **Cause:** Using CMake older than 3.14.
- **Fix:** Upgrade CMake to 3.14 or newer, or revert to other integration methods (manual git submodule or embedding).

### RuntimeLibrary Mismatch on Windows

- **Symptom:** Linker errors about runtime library mismatches.
- **Cause:** Inconsistent runtime linkage between GoogleTest and your project.
- **Fix:** Use `-Dgtest_force_shared_crt=ON` in CMake.

### Build Errors Due to Macro Clashes

- **Symptom:** Compile errors referencing macro redefinition or conflicts.
- **Cause:** Name collisions with third-party or user macros.
- **Fix:** Use `-DGTEST_DONT_DEFINE_<MACRO>=1` to rename GoogleTestâ€™s macros.

### Unsupported Compiler Version

- **Symptom:** Build fails on MSVC versions before Visual C++ 2015.
- **Cause:** GoogleMock requires MSVC 14.0 or newer.
- **Fix:** Upgrade your MSVC compiler.


## Troubleshooting Procedures

<AccordionGroup title="Installation and Build Troubleshooting">
<Accordion title="GoogleTest Build Fails with Missing pthread">
Ensure pthread library is installed and linked.

- On Debian/Ubuntu: `sudo apt-get install libpthread-stubs0-dev`
- Verify build linkage includes `-lpthread`
- On CMake, pthread is detected automatically unless overridden; check `CMAKE_HAVE_THREADS_LIBRARY`.
</Accordion>
<Accordion title="Visual Studio Linking Errors Related to CRT">
- Enable dynamic runtime via `-Dgtest_force_shared_crt=ON`.
- Rebuild GoogleTest and your project to use consistent runtime.
- Clean previous build artifacts to avoid mixed runtimes.
</Accordion>
<Accordion title="CMake Can't Find GoogleTest with find_package()">
- GoogleTest might not be installed in standard directories.
- Verify or set `CMAKE_PREFIX_PATH` or `pkg-config` paths.
- Use manual `add_subdirectory()` or FetchContent for simpler integration.
</Accordion>
</AccordionGroup>


## Practical Tips and Best Practices

- **Match Compiler Settings:** Ensure compiler flags and runtime settings are identical between your tests and GoogleTest library.
- **Specify C++ Standard Early:** Always set `CMAKE_CXX_STANDARD` to 17 or above in your main project to avoid mismatches.
- **Use FetchContent for Integration:** It's the most robust, maintainable approach to embed GoogleTest sources.
- **Rename Macros if Needed:** Avoid name collisions by renaming GoogleTest macros when conflicts arise with other libraries.
- **Check Dependency Paths:** If using pkg-config, verify environment variables like `PKG_CONFIG_PATH` are set correctly.


## Example: Basic Standalone Build Workflow on Linux

```bash
# Clone GoogleTest
$ git clone https://github.com/google/googletest.git -b v1.17.0
$ cd googletest

# Create build directory
$ mkdir build && cd build

# Generate build files
$ cmake ..

# Build the library
$ make

# Run tests (optional)
$ ctest

# Install to system (optional)
$ sudo make install
```


## Example: Handling Macro Name Clash

If your project already defines a `TEST` macro, compile GoogleTest with:

```bash
cmake .. -DGTEST_DONT_DEFINE_TEST=1
```

Then define tests with:

```cpp
GTEST_TEST(MySuite, TestName) {
  EXPECT_EQ(1, 1);
}
```


## Troubleshooting: Build Error Example

**Problem:** Linker error about undefined reference to pthread.

**Step-by-step solution:**

1. Confirm pthread development packages are installed.
2. Ensure your build links the pthread library.
3. For CMake:
  - Confirm that `find_package(Threads REQUIRED)` is called.
  - Check if target libraries include `Threads::Threads`.
4. Use `-DGTEST_HAS_PTHREAD=1` if automatic detection fails.


## Additional Resources

- [Official GoogleTest README](https://github.com/google/googletest/blob/main/README.md)
- [GoogleTest CMake Build Instructions](https://github.com/google/googletest/blob/main/README.md#build-with-cmake)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [Using pkg-config with GoogleTest](https://github.com/google/googletest/blob/main/docs/pkgconfig.md)
- [Common Build Issues and Fixes](https://github.com/google/googletest/blob/main/docs/pkgconfig.md)

---

Visit the related [Common Issues & Gotchas](../getting-started/troubleshooting-help/common-issues.md) for more examples of common pitfalls and fixes.

For detailed guidance on writing your first test and configuring your build system, see the [GoogleTest Primer](../getting-started/configuration-validation/first-test.md) and [Configuring Includes and Linking](../getting-started/configuration-validation/include-and-link.md).

Stay connected with the community and find more support via the [Where To Get Help](../getting-started/troubleshooting-help/support-resources.md) page.

---

*End of Installation and Setup Issues FAQ*