---
title: "Installation and Setup Issues"
description: "Guidance on resolving the most common installation problems, including CMake/Bazel setup, required compiler versions, and basic integration steps. Offers clarity on project requirements such as C++17, platform compatibility, and how to connect GoogleTest/GoogleMock to a project."
---

# Installation and Setup Issues FAQ

This page provides clear guidance on resolving the most frequent installation and setup challenges encountered while integrating GoogleTest and GoogleMock into your C++ projects. It focuses specifically on project requirements such as compiler versions, C++ standard compliance, and connecting GoogleTest and GoogleMock to your build system using CMake or Bazel.

---

## 1. What are the minimum system and compiler requirements to build GoogleTest/GoogleMock?

GoogleTest requires a modern C++ environment supporting the C++17 standard. Supported platforms include Linux, Windows (Desktop), and macOS. The extensible CMake build setup works across these platforms with widely used compilers like GCC (7.0 or later), Clang, MSVC, and Intel LLVM.

**Key Requirements:**
- C++17 standard support must be enabled.
- Compatible compilers include MSVC, GCC 7.0+, Clang, Intel LLVM.
- POSIX-compliant threading preferable; pthread support auto-detected.


## 2. How do I build GoogleTest with CMake?

### Building as a Standalone Project

1. Clone the repository:

   ```bash
   git clone https://github.com/google/googletest.git -b v1.17.0
   cd googletest
   mkdir build && cd build
   ```

2. Generate build files with CMake:

   ```bash
   cmake ..            # Builds both GoogleTest and GoogleMock by default
   ```

   To build only GoogleTest, disable GoogleMock explicitly:

   ```bash
   cmake .. -DBUILD_GMOCK=OFF
   ```

3. Build the binaries:

   ```bash
   make                # on Unix-like systems
   ```

4. (Optional) Install libraries and headers:

   ```bash
   sudo make install   # Installs to /usr/local/ by default
   ```

### Windows and macOS

- On Windows with Visual Studio: Use the generated `.sln` file generated by CMake to build.
- On macOS with Xcode installed: Use the generated `.xcodeproj` project.


## 3. How do I incorporate GoogleTest into my existing CMake project?

The integration is streamlined with two primary approaches:

### Using Installed GoogleTest

- Use `find_package(GTest CONFIG REQUIRED)` if you have GoogleTest installed.
- Link your test target with `GTest::gtest` or `GTest::gmock`.

### Building GoogleTest as Part of Your Project

- Add GoogleTest source tree as a subdirectory with CMake's `add_subdirectory()`.
- This approach ensures consistent compiler/linker settings and simplifies dependency management.

Example snippet:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Visual Studio runtime compatibility
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

> **Note:** This requires CMake 3.14 or later due to `FetchContent_MakeAvailable()`.


## 4. How do I ensure compiler and runtime compatibility on Windows?

By default, Visual Studio projects link the C runtime dynamically (`/MD`), but GoogleTest links it statically (`/MT`). This leads to linker errors:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

**Solution:** Enable the CMake option `gtest_force_shared_crt` to force GoogleTest to use the shared runtime, matching your project.

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

This avoids conflicts and runtime crashes related to multiple runtime library copies.


## 5. What compiler flags and settings are applied by GoogleTest's CMake scripts?

- Compiler flags are tailored per platform and compiler to ensure warnings are elevated (`-Wall -W4` for MSVC, equivalent strict flags for GCC/Clang).
- GoogleTest requires C++17 by setting `target_compile_features(... PUBLIC cxx_std_17)`.
- Pthread usage is auto-detected and used on compatible platforms; otherwise, Windows native threading primitives are used.
- When building as shared libraries (`BUILD_SHARED_LIBS=ON`), linker and compiler flags are adjusted to define `GTEST_CREATE_SHARED_LIBRARY=1` and `GTEST_LINKED_AS_SHARED_LIBRARY=1` appropriately.


## 6. How do I connect GoogleTest and GoogleMock to my project?

- Link your test binaries with the appropriate libraries:
  - For GoogleTest only: link with `gtest` or `gtest_main`.
  - For GoogleMock (which depends on GoogleTest): link with `gmock` or `gmock_main`.

For example, in CMake:

```cmake
target_link_libraries(your_test_target PRIVATE gmock_main)
```

This automatically pulls in the necessary dependencies.


## 7. How do I handle multi-thread support and pthread dependencies?

GoogleTest prefers pthreads on platforms where available (Linux/macOS). It auto-detects pthread using `find_package(Threads)`. If pthread detection fails or is disabled, GoogleTest falls back to platform-specific threading primitives.

If your environment doesn’t detect pthread correctly, you can override with compile flags:

```
-DGTEST_HAS_PTHREAD=1   # To enable pthread
-DGTEST_HAS_PTHREAD=0   # To disable pthread
```

Use these definitions if you encounter pthread-related linking errors.


## 8. What common installation pitfalls should I watch for?

- **Compiler standard version:** Ensure your compiler supports C++17. Newer GCC (7+), Clang, and MSVC versions accommodate this.
- **Runtime mismatches (especially on Windows):** Use `gtest_force_shared_crt` to align runtimes.
- **Missing pthread libraries:** Add `-lpthread` linker flag or ensure pthread development packages are installed on Linux.
- **Build system compatibility:** When embedding GoogleTest in your projects, avoid mixing debug and release builds to circumvent incompatibilities.
- **Macro name collisions:** If GoogleTest macros clash with other libraries, rename GoogleTest macros by defining flags:
  
  ```
  -DGTEST_DONT_DEFINE_TEST=1
  ```

  This requires writing `GTEST_TEST` instead of `TEST`.


## 9. How do I verify a successful installation?

- Build the examples or write a simple test using the `TEST` macro.
- Compile and link with the appropriate GoogleTest or GoogleMock libraries.
- Run your test binary; a successful test run concludes with zero failures.


## Troubleshooting Common Setup Issues

### Problem: Linker errors due to missing pthread

- Confirm your build command includes pthread:
  
  ```bash
  -pthread
  ```

- With CMake, use `find_package(Threads REQUIRED)` and link `Threads::Threads`.


### Problem: Runtime mismatch errors on Windows

- Enable `-Dgtest_force_shared_crt=ON` when configuring CMake.


### Problem: Tests not discovered or macros undefined

- Ensure test source files are compiled with the GoogleTest include path set.
- Confirm usage of correct macros: `TEST`, `TEST_F`.


## Additional Tips and Best Practices

- Use CMake’s imported targets (`GTest::gtest`, `GTest::gtest_main`, `gmock`, `gmock_main`) rather than raw include/library paths.
- Keep your GoogleTest version updated; new releases address compiler compatibility and platform issues.
- Use `add_test()` in CMake to integrate tests with CTest for easy execution.


---

## Related Documentation

- [Installation Methods](/getting-started/prerequisites-installation/installation-methods): Detailed installation instructions for CMake, Bazel, and manual setups.
- [System Requirements](/getting-started/prerequisites-installation/system-requirements): Supported compilers, platforms, and environment prerequisites.
- [Initial Configuration](/getting-started/prerequisites-installation/initial-configuration): Setting up includes, linking, and common build configurations.
- [Integration with Build Systems](/overview/use-cases-integration/integration-with-build-systems): Patterns and tips for integrating GoogleTest and GoogleMock into C++ projects' builds.
- [Troubleshooting Common Setup Issues](/getting-started/troubleshooting/common-setup-issues): Step-by-step diagnosis of the most prevalent installation and build problems.


---

For further assistance, please consult community forums and open issues on the official GitHub repository: [https://github.com/google/googletest](https://github.com/google/googletest).


---

_Last updated: June 2024_