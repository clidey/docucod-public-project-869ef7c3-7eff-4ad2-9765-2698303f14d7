---
title: "Writing and Running Tests"
description: "Common questions about creating unit tests, using the xUnit framework, executing test suites, test discovery, and test output control. Includes troubleshooting for missing tests and non-running tests."
---

# Writing and Running Tests FAQ

This FAQ addresses common questions related to creating unit tests, using the xUnit-based GoogleTest framework, running test suites, discovering tests automatically, controlling test output, and troubleshooting typical problems such as missing or non-running tests.

---

## 1. Getting Started with Writing Tests

### Q: How do I write my first test using GoogleTest?

To write your first test, define a function using the `TEST(TestSuiteName, TestName)` macro. Inside this function, use GoogleTest assertions to verify behavior. For example:

```cpp
#include <gtest/gtest.h>

TEST(MathTest, Addition) {
  EXPECT_EQ(2 + 2, 4);
}
```

Compile your test binary linking against GoogleTest libraries, then run it. The framework automatically discovers and runs all tests defined with `TEST` or `TEST_F`.

For a step-by-step guide, see the [Writing and Running Your First Test](https://google.github.io/googletest/getting-started/quickstart-usage/writing-first-test) documentation.

### Q: What is the correct way to name and organize tests?

Organize tests by grouping related tests under the same test suite name passed to `TEST` or `TEST_F`. Use descriptive test and suite names to clearly document intent. Avoid overly verbose names; focus on what behavior the test verifies.

### Q: How do I run all tests in my test executable?

Simply execute the compiled test binary. GoogleTest handles test discovery and runs all tests it finds. You can also use command-line flags to filter tests, e.g., `--gtest_filter=SuiteName.TestName`.

---

## 2. Understanding Test Discovery and Execution

### Q: How does GoogleTest discover tests?

Tests are discovered automatically by the framework during runtime initialization. Any function using the `TEST` or `TEST_F` macros registers itself as a test. The framework internally maintains a registry of all tests compiled into the binary.

### Q: Why might some tests not run?

Common reasons include:
- Test code not being linked into the final test executable.
- Using wrong or missing `TEST` or `TEST_F` macros (e.g., forgetting to define tests inside these macros).
- Test filters excluding those tests.
- Compilation or linking errors preventing tests from registering.

Review your build and linking steps to ensure all test files are included and verify that no test filters (such as `--gtest_filter`) are unintentionally hiding tests.

### Q: How can I run a subset of tests?

Use the `--gtest_filter` flag with patterns to include/exclude tests. For example:

```
./my_tests --gtest_filter=MySuite.*
```

runs all tests in `MySuite`.

---

## 3. Controlling Test Output

### Q: Can I customize how much information GoogleTest outputs?

Yes. GoogleTest supports flags like `--gtest_verbose=LEVEL` where level can be `info`, `warning`, or `error` to control verbosity. Use `--gtest_output` for XML or other formats to integrate with CI systems.

Example:

```
./my_tests --gtest_verbose=info
```

provides detailed logs of which expectations matched and why.

### Q: How do I see detailed logs of mock calls?

GoogleMock supports the `--gmock_verbose=info` flag, which emits detailed information about mock object interactions including matched expectations and call arguments. This is invaluable for troubleshooting mock-related failures.

---

## 4. Writing and Using Mock Classes

### Q: How do I create a mock class in GoogleMock?

Derive your mock class from the interface to be mocked. Use the `MOCK_METHOD` macro to mock virtual methods, specifying the return type, method name, and argument list. For example:

```cpp
#include <gmock/gmock.h>

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(void, SetName, (const std::string& name), (override));
};
```

Mock methods must be declared in `public:` regardless of the method's original access.

### Q: How do I set expectations on mock methods?

Use the `EXPECT_CALL` macro to specify how a mock method is expected to be called, with what arguments, how many times, and what action it should perform. For example:

```cpp
EXPECT_CALL(mock_foo, GetSize())
    .Times(3)
    .WillOnce(Return(10))
    .WillRepeatedly(Return(20));
```

This means the first call returns 10, the next two return 20.

### Q: When should I use `ON_CALL` vs `EXPECT_CALL`?

`ON_CALL` specifies default behavior for methods but does **not** enforce that the methods are called. Use it to set mock behavior when you don't want to require calls.

`EXPECT_CALL` not only defines behavior but asserts that calls happen as specified, including order and argument matching.

As a best practice, use `ON_CALL` to set default mock behavior and `EXPECT_CALL` only when you want to verify calls.

### Q: How can I handle overloaded methods in mocks?

Mock all overloaded versions you expect to use. If some overloads are not mocked, use `using BaseClass::MethodName;` to bring them into scope and prevent compiler warnings.

### Q: How do I handle sequences and ordering of calls?

Use the `InSequence` helper or `.InSequence` clause on `EXPECT_CALL` to enforce strict order. For partial ordering, use `.After` clauses or multiple `Sequence` objects.

Example:

```cpp
{
  InSequence seq;
  EXPECT_CALL(mock, FirstMethod());
  EXPECT_CALL(mock, SecondMethod());
}
```

Ensures `FirstMethod` must be called before `SecondMethod`.

### Q: What are NiceMock, NaggyMock, and StrictMock?

- `NaggyMock`: Default mock object behavior, warns on uninteresting calls.
- `NiceMock`: Suppresses warnings on uninteresting calls, useful in tests where you are not interested in calling every mock method explicitly.
- `StrictMock`: Treats uninteresting calls as test failures, makes tests brittle but guarantees all calls must be expected.

Use `NiceMock` to reduce noise, `StrictMock` to enforce strict verification.

### Q: How do I troubleshoot missing mock tests or non-running tests?

- Verify mock classes derive from correct interfaces with virtual destructors.
- Ensure mock methods are declared with `MOCK_METHOD` and in `public` scope.
- Use `--gmock_verbose=info` to trace mock calls.
- Check that all `.EXPECT_CALL`s are set before exercising the code.
- Confirm that test cases are registered properly and linked.
- Use test filters carefully to avoid accidentally hiding tests.

---

## 5. Common Errors and Troubleshooting

### Q: Why does an unexpected real method get called instead of the mock one?

The method being mocked must be `virtual`. Otherwise, GoogleMock cannot intercept calls. For non-virtual methods, consider redesigning interfaces or use the high-performance dependency injection pattern.

### Q: What does "Uninteresting mock function call" warning mean?

It means a mock method was called without an expectation (`EXPECT_CALL`) set on it. This is not an error but a warning that you may have forgotten to add an expectation or to explicitly allow calls.

Suppress the warning with `NiceMock` or add `EXPECT_CALL(...).Times(AnyNumber())` to allow calls without warnings.

### Q: How do I verify expectations were met if my mock object is not destroyed?

Call `Mock::VerifyAndClearExpectations(&mock_object);` explicitly after your test code runs to force verification.

### Q: How should I handle mocks with default return values?

GoogleMock provides default actions for common return types (e.g., zero or default constructed). You can customize defaults per type with `DefaultValue<T>::Set()`, or per mock method with `ON_CALL`.

### Q: Why might some expectations be reported twice or seem redundant?

Because GoogleMock prints failure information at different points in time during execution, duplications may happen but reflect different states and contexts. It's useful for thorough debugging.

### Q: How do I mock methods involving move-only types like `std::unique_ptr`?

Use the standard `MOCK_METHOD` syntax; for return values, use lambdas or `WillOnce` with `Return` of `std::move`d instances. Be aware that `Return(std::move(...))` can only be used once; for repeated calls, use lambdas that create new objects.

---

## 6. Tips & Best Practices

- **Set expectations before exercising code.**
- **Use matchers (`_`, `Eq()`, `Gt()`, etc.) to specify argument expectations clearly.**
- **Use sequences to enforce call order only when necessary to avoid brittle tests.**
- **Avoid over-specification; prefer `ON_CALL` for default behaviors to reduce maintenance overhead.**
- **Make mock destructors virtual to prevent silent failures and leaks.**
- **When mocking classes you don't own, define adapters/interfaces you control.**
- **Use `RetiresOnSaturation()` to allow expectations to deactivate after being met, useful for sequence setups.**
- **Use `--gmock_verbose=info` during test debugging to gain insight into mock call matching.**

For detailed patterns on mocking, actions, and using matchers, consult the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) and the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html).

---

## 7. Where to Get Additional Help

- **GoogleTest and GoogleMock official documentation site:** [https://google.github.io/googletest/](https://google.github.io/googletest/)
- **Mocking Cookbook:** Practical recipes and examples for advanced mocking
- **Mocking Reference:** Complete API and usage details for mocks
- **Using Assertions Effectively:** To master test assertions alongside mocks
- **Getting Started Guides:** Installation, quickstart, and first-test instructions
- **Community Support:** GitHub issues and discussion forums for community help

---

## Related Topics

- [Writing Your First Test](https://google.github.io/googletest/getting-started/quickstart-usage/writing-first-test)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Test Runner Entry Points](https://google.github.io/googletest/reference/configuration_and_main_api/runner_entry_points)
- [Common Setup Issues](https://google.github.io/googletest/getting-started/troubleshooting-support/common-setup-issues)

---

For more on advanced usages like parameterized tests, continuous integration, and custom assertions, see the corresponding guides in the documentation navigation.
