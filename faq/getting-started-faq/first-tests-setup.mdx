---
title: "How do I write and run my first test?"
description: "Provides step-by-step guidance on creating and running your initial tests using GoogleTest and GoogleMock, highlights basic assertions, and demonstrates recommended file structure and test discovery. Points to sample code for reference."
---

# How do I write and run my first test?

This page provides a clear, step-by-step guide designed for users new to GoogleTest and GoogleMock. It walks you through creating an initial test, running it, understanding basic assertions, following recommended file structure, and ensuring tests are discovered correctly by the framework. Sample code references are included to help you get started quickly.

---

## 1. Writing Your First Test

Writing your first test with GoogleTest involves defining a test function using the `TEST()` macro and adding assertions that verify your code's behavior.

### Steps:

1. **Create a Test File**

   Start with a `.cc` or `.cpp` file, for example, `sample_test.cc`.

2. **Include GoogleTest Header**

   ```cpp
   #include <gtest/gtest.h>
   ```

3. **Write a Test Case Using `TEST()` Macro**

   The `TEST()` macro takes two arguments: a test suite name and a test name. Both should be valid C++ identifiers without underscores.

   ```cpp
   // Tests factorial of 0.
   TEST(FactorialTest, HandlesZeroInput) {
     EXPECT_EQ(Factorial(0), 1);
   }

   // Tests factorial of positive numbers.
   TEST(FactorialTest, HandlesPositiveInput) {
     EXPECT_EQ(Factorial(1), 1);
     EXPECT_EQ(Factorial(2), 2);
     EXPECT_EQ(Factorial(3), 6);
     EXPECT_EQ(Factorial(8), 40320);
   }
   ```

> **Tip:** Use `EXPECT_*` assertions when you want the test to continue after a failure, and `ASSERT_*` when a failure should abort the current test.

### Example: Basic Factorial Tests

```cpp
int Factorial(int n);  // Your factorial function implementation

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

---

## 2. Running Your Test

Once your test is written and compiled, use GoogleTest's test runner to execute your tests.

### Basic Run

In your `main()` function, initialize GoogleTest and run all tests:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

The `RUN_ALL_TESTS()` function runs all tests registered in your binary, returning `0` if all succeed.

### Using gtest_main or gmock_main

GoogleTest and GoogleMock provide pre-built main functions in `gtest_main` and `gmock_main` libraries. Linking against these saves you from writing your own `main()`.

### Compiling and Running

Compile your test with the appropriate flags and link to GoogleTest/GoogleMock libraries. Then run the resulting binary to see test results.

```bash
$ ./my_tests
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

---

## 3. Understanding Basic Assertions

Assertions are the core of test verification in GoogleTest. They check if certain conditions hold.

### Popular Assertion Macros

| Macro      | Description                                | Effect on Failure                 |
|------------|--------------------------------------------|---------------------------------|
| `EXPECT_EQ`| Checks if two values are equal              | Nonfatal failure (continues test)|
| `ASSERT_EQ`| Same as `EXPECT_EQ`, but aborts test on failure | Fatal failure (aborts test)       |
| `EXPECT_TRUE`/`ASSERT_TRUE`| Checks if a condition is true  | Nonfatal or fatal failure          |
| `EXPECT_FALSE`/`ASSERT_FALSE`| Checks if a condition is false | Nonfatal or fatal failure          |

### Example of Assertions

```cpp
TEST(SampleTest, BasicAssertions) {
  int x = 5;
  int y = 5;

  EXPECT_EQ(x, y) << "x and y should be equal";
  ASSERT_TRUE(x == y) << "x should equal y";

  EXPECT_FALSE(x != y);
}
```

---

## 4. Recommended File Structure and Test Discovery

GoogleTest automatically discovers and runs all tests it finds in your linked objects. To ensure smooth test discovery and organization:

- Keep test files separate from production code (e.g., `src/` vs `tests/`).
- Use descriptive naming conventions, e.g., `foo_test.cc`.
- Group logically related tests with common test suite names.
- Use test fixtures (`TEST_F`) for tests sharing setup.

GoogleTest will discover all tests defined by `TEST()`, `TEST_F()`, and similar macros from all compiled files linked into your test binary – there’s no need to list tests manually.

> **Tip:** Having a consistent directory and naming structure helps when scaling up your test base and integrating with build systems and CI pipelines.

---

## 5. Using GoogleMock for Mocking in Your First Test

If your testing scenario involves mock objects, GoogleMock can help you create mocks and expectations.

### Defining a Simple Mock Class

1. Include GoogleMock header:

```cpp
#include <gmock/gmock.h>
```

2. Derive a mock class from the interface you want to mock.

3. Use `MOCK_METHOD` macros to mock virtual functions.

```cpp
class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

### Setting Expectations

Before running your test code, set expectations with `EXPECT_CALL`:

```cpp
MockTurtle turtle;
EXPECT_CALL(turtle, PenDown()).Times(1);
```

Then pass the mock object into the code under test and exercise it.

### Example

```cpp
TEST(PaintTest, DrawsCircle) {
  MockTurtle turtle;
  EXPECT_CALL(turtle, PenDown()).Times(1);

  Painter painter(&turtle);
  EXPECT_TRUE(painter.DrawCircle(0, 0, 10));
}
```

---

## 6. Sample Code Reference

You can find working example tests and mocks in the [GoogleTest GitHub repository](https://github.com/google/googletest) that demonstrate these concepts in full context.

Look for the `googletest/samples` directory for test examples.

---

## 7. Troubleshooting Quick Tips

- Make sure GoogleTest and GoogleMock are installed and linked correctly.
- Verify your test functions are using `TEST()` or `TEST_F()` macros.
- Ensure your test runner calls `RUN_ALL_TESTS()` exactly once after `InitGoogleTest()`.
- For mocks, set expectations *before* exercising the mock.
- Keep an eye on test output for assertion failure details and test discovery logs.

---

## 8. Next Steps

After writing and running your first test:

- Explore more complex assertions and custom predicates.
- Learn how to use test fixtures (`TEST_F`) for reusable setup.
- Dive into parameterized tests for running tests with multiple inputs.
- Practice writing mocks with GoogleMock and defining expectations.
- Understand assertions' best practices and test organization.

See also:
- [GoogleTest Primer](primer.md)
- [gMock for Dummies](gmock_for_dummies.md)
- [Mocking Reference](reference/mocking.md)
- [Assertions Reference](reference/assertions.md)

---