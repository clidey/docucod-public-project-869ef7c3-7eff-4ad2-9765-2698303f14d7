---
title: "Installation and Setup Issues"
description: "Covers common challenges users face when installing or configuring GoogleTest/GoogleMock, including required C++ standards, build tools, and typical environment issues, with actionable solutions."
---

# Installation and Setup Issues FAQ

This FAQ addresses common challenges faced while installing or configuring GoogleTest and GoogleMock. It covers necessary system and compiler requirements, build tool usage, environment setup, and provides practical solutions for frequently encountered errors.

---

## 1. What are the minimum C++ standard and compiler requirements for building GoogleTest and GoogleMock?

GoogleTest requires an environment supporting **C++17** or later. Ensure that your compiler and build tools are set accordingly:

- For CMake builds, explicitly specify the C++ standard by adding:
  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```
- Alternatively, you can add the C++17 flag via the compiler options, for example:
  ```bash
  -DCMAKE_CXX_FLAGS="-std=c++17"
  ```

Supported compilers include recent versions of GCC, Clang, MSVC, and others that support C++17. Compatibility with other compilers should be verified early to avoid build failures.


## 2. How do I build GoogleTest and GoogleMock using CMake?

GoogleTest includes CMake build scripts to simplify building on multiple platforms.

### Standalone Build Steps:

1. Clone the repository:
   ```bash
   git clone https://github.com/google/googletest.git -b v1.17.0
   cd googletest
   ```
2. Create and navigate to a build directory:
   ```bash
   mkdir build && cd build
   ```
3. Configure the build system:
   - To build both GoogleTest and GoogleMock (default):
     ```bash
     cmake ..
     ```
   - To build only GoogleTest:
     ```bash
     cmake .. -DBUILD_GMOCK=OFF
     ```
4. Build the libraries:
   ```bash
   make
   ```
5. (Optional) Install to system directories:
   ```bash
   sudo make install
   ```

### Platform-specific notes:

- On Windows with Visual Studio, a `.sln` file is generated for building via the IDE.
- On macOS with Xcode installed, a `.xcodeproj` file is provided.


## 3. How do I integrate GoogleTest into my existing CMake project?

You have two primary options:

- **Use installed libraries and headers**: Use `find_package(GTest CONFIG REQUIRED)` and link targets `GTest::gtest`, `GTest::gmock`.

- **Add GoogleTest as part of your build** via `add_subdirectory()`. This ensures consistent compiler/linker settings.

For example, using CMake's `FetchContent`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # For Windows runtime
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test.cpp)
target_link_libraries(my_tests gtest_main)
add_test(NAME my_tests COMMAND my_tests)
```

Be sure your CMake version is 3.14 or higher to use `FetchContent_MakeAvailable()`.


## 4. What build issues and common errors should I be aware of?

### Runtime library mismatches on Windows

- GoogleTest links statically to the C runtime by default.
- Your project may link dynamically, causing linker errors (`LNK2038: mismatch detected for 'RuntimeLibrary'`).
- Fix by setting the CMake option:
  ```cmake
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
  ```
  This instructs GoogleTest to use the dynamic runtime to match your project.

### Multi-threading and pthread issues

- GoogleTest is thread-safe if the `pthread` library is available.
- If automatic detection fails, force pthread usage with:
  ```bash
  -DGTEST_HAS_PTHREAD=1
  ```
- Make sure to link your tests with pthread explicitly if your build script requires it.


## 5. What are the steps to build and run tests with GoogleMock?

GoogleMock depends on GoogleTest and provides its own main function implementation.

- Link your test executables against the `gmock_main` library (which includes both GoogleMock and GoogleTest plus a main function).

- Example CMake linking:
  ```cmake
  target_link_libraries(my_tests gmock_main)
  ```

- The `gmock_main.cc` file contains the `main()` that initializes GoogleMock (and GoogleTest) and runs all tests.

- For embedded or Arduino-like platforms, entry points are adjusted to use `setup()` and `loop()` instead.


## 6. How can I avoid macro name clashes with GoogleTest assertions?

GoogleTest defines assertion macros such as `TEST()`, `ASSERT_EQ`, etc. These can conflict with other libraries.

- Use the compile flag `-DGTEST_DONT_DEFINE_TEST=1` (and similarly for other macros) to prevent GoogleTest from defining these macros.
- Doing so requires using the prefixed names like `GTEST_TEST()` instead of `TEST()`.


## 7. What if I encounter unexpected build or runtime errors?

- Ensure all GoogleTest and GoogleMock source files are correctly included and linked.
- Verify compiler flags and environment variables are set for your platform.
- Use the diagnostic verbosity flags:
  ```
  --gmock_verbose=info
  ```
  to get more insights.
- Consult the troubleshooting guide for specific build issues.


## 8. Where are additional resources and related documentation?

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) for test writing basics.
- [Getting Started with CMake](https://github.com/google/googletest/blob/main/README.md#build-with-cmake) section for build details.
- [Build and Run Tests Guide](https://github.com/google/googletest/blob/main/docs/guides/getting-started/build-run.md) for integrating and executing tests.
- Troubleshooting common issues: `/getting-started/validation-troubleshooting/troubleshooting`.

---

# Troubleshooting Tips

<AccordionGroup title="Common Setup and Installation Problems">
<Accordion title="Build Fails Due to Missing C++17 Support">
Ensure your compiler supports C++17 and the build system is configured to use it. Update the compiler or add `-std=c++17` flag accordingly.
</Accordion>
<Accordion title="Linker Errors on Windows Related to CRT Mismatch">
Set `gtest_force_shared_crt` to `ON` in your CMake to make runtime linkage consistent between your project and GoogleTest.
</Accordion>
<Accordion title="GoogleMock `main()` Function Conflicts or Missing Entry Point">
Link your tests against `gmock_main` instead of just `gmock` to use the supplied main.
</Accordion>
<Accordion title="Failure to Detect pthreads on Unix-like Systems">
Manually specify `-DGTEST_HAS_PTHREAD=1` and link with pthread during compilation and linkage.
</Accordion>
</AccordionGroup>

<Tip>
Always verify your build environment (compiler version, flags, platform capabilities) before attempting complex configurations. Clear diagnostics help reduce wasted time.
</Tip>


# Additional Best Practices

- **Use CMakeâ€™s FetchContent or add_subdirectory for consistent builds.** Avoid mixing prebuilt and source-built GoogleTest libraries to prevent ABI mismatches.
- **Return `RUN_ALL_TESTS()` from `main()`** to surface correct exit codes for CI systems.
- **Avoid manually enumerating tests.** GoogleTest auto-registers tests.
- **Leverage GoogleTest and GoogleMock flags** to fine-tune verbosity and behavior.


# Where to Go Next

- See the [Getting Started guides](../getting-started/project-setup/first-test.md) for writing your first tests.
- Review the [Configuring Test Execution](../getting-started/project-setup/configuration-options.md) page to customize test runs.
- Consult the [Troubleshooting Guide](../getting-started/validation-troubleshooting/troubleshooting.md) for detailed problem-solving advice.

---