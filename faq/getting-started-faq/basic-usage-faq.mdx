---
title: "Basic Usage and Test Discovery"
description: "Common questions about writing and running your first tests, how test discovery works in GoogleTest, and how to organize test cases for reliable execution. Helps users avoid pitfalls in early test development."
---

# Basic Usage and Test Discovery FAQ

This FAQ addresses common questions that arise when writing and running your first tests with GoogleTest, explains how test discovery works, and offers guidance on organizing test cases for consistent and reliable execution. It aims to help you avoid common pitfalls in early test development.

---

## 1. Writing and Running Your First Tests

### How do I write a simple test case with GoogleTest?
Writing a test case starts by including the main header `<gtest/gtest.h>`. Then, create a test using the `TEST` macro with a test suite name and test name:

```cpp
#include <gtest/gtest.h>

TEST(MathTest, AdditionWorks) {
  EXPECT_EQ(2 + 2, 4);
}
```

Running your tests can be done by calling `RUN_ALL_TESTS()` inside your `main()` function after initializing GoogleTest:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

When you build and run this, GoogleTest automatically discovers all tests and executes them.

### What is test discovery in GoogleTest?
GoogleTest automatically identifies all test cases defined with `TEST` or `TEST_F` macros at runtime. It registers them so that when you run your test binary, all registered tests are executed without needing manual listing.

### How can I run only a subset of tests?
Use the command line flag `--gtest_filter` to select specific tests. For example:

```
./my_tests --gtest_filter=MathTest.*
```

runs all tests in the `MathTest` suite.

Use `--gtest_list_tests` to see all available tests.

### How do I handle test setup and teardown?
Use test fixtures with `TEST_F` to share setup and teardown logic:

```cpp
class MyTestFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    // Code here will run before each test
  }

  void TearDown() override {
    // Code here will run after each test
  }
};

TEST_F(MyTestFixture, SomeTest) {
  // Your test code here
}
```

This promotes reuse and cleaner tests.

### What are common pitfalls in early test development?

- **Not specifying expectations before exercising code:** GoogleMock expects you to declare `EXPECT_CALL` before the mock’s methods are invoked to enable proper verification.
- **Overly strict expectations:** While precise expectations improve validation, over-specifying arguments or call order can make tests fragile.
- **Ignoring uninteresting calls warnings:** By default, mock methods without explicit expectations emit warnings, which are a helpful notification that you might have missed something.

<Tip>
Always write your expectations clearly and in advance, and use test fixtures to manage setup and teardown consistently.
</Tip>

---

## 2. Understanding Test Discovery in GoogleTest

### How does GoogleTest discover tests automatically?
GoogleTest uses macros like `TEST` and `TEST_F` to register test classes and test methods globally at program load time. This registration enables the test runner to know all tests without manual listing.

### Can I organize test cases to control their order of execution?
Yes. By default, tests run in order of registration, but you can control ordering using the `--gtest_shuffle` flag to randomize execution.

If your test suite depends on running order, consider redesigning to avoid interdependencies since independent, isolated tests are more maintainable and reliable.

### How do parameterized and typed tests affect discovery?
Parameterized (`TEST_P`) and typed tests also register automatically, but expand into multiple test cases based on data sets or types provided.

---

## 3. Organizing Test Cases for Reliable Execution

### How do I group tests effectively?
Group related tests into test suites (`TEST`’s first argument or `TEST_F` fixtures) so you can manage setup/teardown and run subsets efficiently.

### How to avoid flaky tests?
- Design tests to have no dependencies on external state.
- Avoid shared mutable global state.
- Mock dependencies when tests involve external modules.

### How do I use mock objects in my tests?
Mock objects are created using the GoogleMock framework, integrated with GoogleTest. Typical workflow:

<Steps>
<Step title="Define a Mock Class">
Use the `MOCK_METHOD` macro inside your mock class to mock virtual methods.
</Step>
<Step title="Set Default Behavior with ON_CALL">
Specify common behavior for mock methods without requiring specific call expectations.
</Step>
<Step title="Set Call Expectations with EXPECT_CALL">
Define expected calls with argument matchers, call counts, and behaviors.
</Step>
<Step title="Run Tests and Verify">
Exercise your code and let gMock automatically verify expectations during test teardown.
</Step>
</Steps>

### What are uninteresting vs unexpected calls?
- **Uninteresting calls:** Methods called without an `EXPECT_CALL` defined. By default, issues a warning but test continues.
- **Unexpected calls:** Method calls with arguments not matching any active expectation; causes test failures.

Using `NiceMock` suppresses uninteresting call warnings, while `StrictMock` treats them as failures.

### How can I suppress warnings on uninteresting calls?
Wrap your mock with `NiceMock<YourMock>` or add a catch-all expectation:

```cpp
EXPECT_CALL(mock_obj, MethodName(_)).Times(AnyNumber());
```

---

## 4. Practical Tips & Best Practices

- Always define mock expectations before exercising the mock.
- Use `ON_CALL` for setting default behaviors, `EXPECT_CALL` for strict verification.
- Declare mock classes in public sections regardless of method visibility.
- Use sequences (`InSequence`, `Sequence`) to assert call order when necessary.
- Use argument matchers (`_`, `Eq()`, `Ge()`, etc.) to avoid over-specification.
- Keep test cases independent for reliable parallel execution.
- Take advantage of `--gtest_filter` and `--gtest_shuffle` during test runs.

---

## 5. Troubleshooting Common Issues

<AccordionGroup title="Common Early Test Development Issues">
<Accordion title="Test Not Detected or Run">
Make sure you use the `TEST`, `TEST_F`, or `TEST_P` macros correctly; confirm the test binary is rebuilt; use `--gtest_list_tests` to verify test registration.
</Accordion>
<Accordion title="Mock Expectations Not Verified">
gMock verifies expectations at mock destruction; be sure mocks aren’t leaked or your tests won’t catch failures. Use heap checker or explicit verification with `Mock::VerifyAndClearExpectations`.
</Accordion>
<Accordion title="Unexpected/Uninteresting Call Warnings">
Add explicit `EXPECT_CALL` or use `NiceMock` to suppress warnings for uninteresting calls if those calls are expected. Avoid blindly suppressing warnings as it hides potential bugs.
</Accordion>
<Accordion title="Ordering Issues in Tests">
If call order matters, use `InSequence` or `Sequence` to specify ordering. Without this, tests may pass or fail unpredictably based on call order.
</Accordion>
</AccordionGroup>

---

## 6. Useful Commands and Flags

- `--gtest_filter=<pattern>` — Run tests matching the pattern.
- `--gtest_list_tests` — List all available tests.
- `--gtest_shuffle` — Randomize test execution order.
- `--gtest_repeat=<N>` — Run tests N times.
- `--gmock_verbose=<level>` — Control GoogleMock log verbosity (`info`, `warning`, `error`). Use `info` for detailed mock call tracing.

---

## 7. References and Further Learning

- [GoogleTest Primer](primer.md) — Introduction to writing tests.
- [gMock for Dummies](gmock_for_dummies.md) — Learn mock objects and expectations.
- [gMock Cookbook](gmock_cook_book.md) — Recipes and advanced mock usage.
- [Mocking Reference](reference/mocking.md) — API details on mocks.
- [Test Discovery & Execution Workflows](guides/essential-testing-patterns/test-discovery-execution.md) — Deep dive into test discovery.

<Tip>
For a smooth start, follow tutorials step by step, and focus on understanding test flow before diving into advanced features.
</Tip>
