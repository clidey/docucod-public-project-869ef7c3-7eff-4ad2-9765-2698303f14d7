---
title: "Troubleshooting My First Test"
description: "Answers recurring questions encountered when writing and running your first tests, such as test discovery, linking errors, assertion failures, and integrating with your project's build or CI pipeline. Guides new users through resolving obstacles so they can quickly validate their code."
---

# Troubleshooting My First Test

This page addresses recurring questions and challenges new users encounter when writing and running their first tests with GoogleTest and GoogleMock. It provides practical solutions and clear guidance for issues like test discovery problems, linker errors, assertion failures, and CI pipeline integration hurdles. The goal is to help you quickly diagnose and resolve obstacles so you can validate your code confidently.

---

## 1. Test Discovery Issues

### Why is GoogleTest not finding my test cases?

GoogleTest uses macros and naming conventions to automatically discover tests. If your tests are not being detected:

- Ensure each test uses the `TEST` or `TEST_F` macro correctly.
- Verify your test executable is linked against the GoogleTest libraries.
- Confirm that the tests are not disabled (`TEST(DISABLED_TestName, ...)` will be skipped).
- Check that the test functions are not placed in an anonymous namespace or have incorrect linkage.

**Example**:
```cpp
#include <gtest/gtest.h>

TEST(MyTestSuite, MyTestCase) {
  EXPECT_EQ(1, 1);
}
```

Make sure the above code is compiled and linked correctly so the test binary can register it.

### My tests compile but don't run. What could be wrong?

This usually means your test executable is missing the main entry point to GoogleTest.

- If you rely on the default main, ensure you link your test executable with the `gtest_main` or `gmock_main` library which provides the main function.
- Alternatively, provide your own main() where you initialize the framework:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Consult the [Main Entry & Execution guide](https://google.github.io/googletest/concepts/core-architecture/main-entry-and-execution) for details.


## 2. Linking and Build Errors

### I get linker errors about missing symbols from GoogleMock. How do I fix this?

Linker errors commonly happen if GoogleMock is not linked properly.

- Make sure to link your test binary with GoogleMock libraries (usually `libgmock.a` or `libgmock_main.a`).
- Verify that the include paths and library paths are correctly specified in your build system.
- If using Bazel or CMake, follow recommended integration steps from the [Setup & Integration guide](https://google.github.io/googletest/googletest/integration.html).

### Errors related to runtime library conflicts on Windows?

- When using Visual Studio, ensure the runtime library linkage (static/dynamic) is consistent for all components.
- GoogleTest and GoogleMock binaries must use compatible runtime settings matching your project.
- Refer to the [Basic Configuration](https://google.github.io/googletest/getting-started/basic-configuration) guide to resolve MSVC runtime conflicts.


## 3. Common Assertion Failures in First Tests

### My `EXPECT_EQ` or other assertions fail unexpectedly. How do I debug?

- Read the error message carefully; it pinpoints the line and explains the expected vs actual values.
- Use `ASSERT_*` if you want the test to abort immediately on failure, which simplifies debugging.
- If your test depends on proper setup, ensure that fixtures and environment are correctly initialized.
- If using mocks, verify your expectations and default behaviors are correctly set using `EXPECT_CALL` and `ON_CALL`.
- Learn about the [Assertions and Test Validation](https://google.github.io/googletest/googletest/assertions.html) best practices to write robust tests.

### Why does my mock method call fail with "unexpected mock function call"?

This happens because:

- You did not set an expectation with `EXPECT_CALL` before calling the mock method.
- The call arguments do not match any of the specified expectations.

**Fix it by:**

- Setting explicit expectations on your mock objects *before* exercising the code under test.
- Using matchers (`_` for any argument) when you don't care about specific argument values.

Example:
```cpp
using ::testing::_;
EXPECT_CALL(mock_obj, Foo(_));
...
mock_obj.Foo(42);
```

See the [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) for beginner-friendly examples.


## 4. Linking Tests with Build or Continuous Integration Pipelines

### How do I integrate GoogleTest with my build system or CI?

- Make sure your build system compiles and links the test executables with GoogleTest and GoogleMock libraries.
- Enable automatic test discovery by running the test binaries directly; GoogleTest enumerates all tests.
- Use the `--gtest_output=xml:<path>` flag to produce XML reports compatible with many CI systems.
- If using CMake, follow the instructions in [Installation: CMake](https://google.github.io/googletest/getting-started/prerequisites-installation/install-cmake) and the [CI Integration guide](https://google.github.io/googletest-guides/practical-examples-and-patterns/ci-integration).

### Test failures in CI but not locally?

- Compare environment differences, including OS, compiler versions, and library versions.
- Check for flaky tests relying on timing or external resources.
- Increase logging verbosity using `--gmock_verbose=info` or `--gtest_break_on_failure`.
- Use artifacts and logs to diagnose issues.


## 5. Practical Tips & Best Practices

- Always set expectations on mocks before exercising code that uses them.
- Use `NiceMock` to suppress warnings about uninteresting calls during initial test development.
- Use `StrictMock` in final tests to enforce strict checking of mock method calls.
- When mocking methods with complex argument types (e.g., with commas), use the recommended wrapping or type aliasing from the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html#MOCK_METHOD).
- Consult the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for recipes addressing common challenges.

## 6. Where to Go Next

- After resolving initial test setup issues, explore writing more advanced mocks and expectations in the [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html).
- Learn about managing mock strictness and test reliability in [Building Maintainable Mocks](https://google.github.io/googletest-guides/advanced-mocking-patterns/writing-maintainable-mocks).
- If your errors persist or you hit platform-specific issues, consult the [Legacy gMock FAQ](https://google.github.io/googletest/faq/gmock_faq.html).

---

<Tip>
Run your test binaries with the `--gmock_verbose=info` flag to gain detailed insights into which mock functions were called, which expectations matched, and why failures occurred. This debugging detail accelerates troubleshooting during your first test setup.
</Tip>

<Note>
Remember, mock expectations must be set before the code under test calls the mock functions â€” setting them afterward leads to undefined behavior and confusing errors.
</Note>

<Check>
Verify that your mock classes' base interfaces have virtual destructors to avoid memory leaks and unexpected failures.
</Check>

---

## Related Documentation

- [Writing Your First Test](https://google.github.io/googletest-guides/getting-started/primer-first-test)
- [Setting Up and Integrating GoogleTest](https://google.github.io/googletest-guides/getting-started/setup-integration)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Common Installation and Build Issues](https://google.github.io/googletest/getting-started/troubleshooting-support/common-issues)
- [CI Integration Guide](https://google.github.io/googletest-guides/practical-examples-and-patterns/ci-integration)

---

Ensure proper build setup, mocking discipline, and use our detailed guides to swiftly overcome common beginner hurdles and get your tests running reliably.
