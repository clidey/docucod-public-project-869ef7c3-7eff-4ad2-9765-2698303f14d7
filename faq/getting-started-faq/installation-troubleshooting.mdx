---
title: "Installation & Build Problems"
description: "Answers to common installation and compilation issues, such as errors with C++ standard requirements, missing files, or incorrect build configurations. Offers quick fixes and pointers to verify your environment is set up for GoogleTest."
---

# Installation & Build Problems

This page addresses the most frequent issues users encounter while installing and building GoogleTest (and GoogleMock). It offers actionable advice on resolving errors related to C++ standard requirements, missing files, build configurations, and environment setup verification to get you quickly back on track.

---

## Frequently Asked Questions

### Why am I getting errors about C++17 when building GoogleTest?
GoogleTest requires a C++17-compliant compiler environment. If your build fails with errors related to the C++ standard, ensure your compiler and build system specify C++17 or later. In CMake, you can enforce this by adding:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Alternatively, pass appropriate flags to your compiler directly (e.g., `-std=c++17`). Note that older compilers or outdated build flags will cause failures.

### What causes 'missing file' or header not found errors when including GoogleTest?
Ensure your build system knows where to find GoogleTest headers. When using CMake and FetchContent or `add_subdirectory()`, GoogleTest's include directories are added automatically. For manual build setups, verify the include path points to GoogleTest's `include` directory.

### How do I resolve linker errors about missing `main()` or `RUN_ALL_TESTS()` symbols?
GoogleTest provides two libraries:

- `gtest`: Contains the core testing framework without a `main()` function.
- `gtest_main`: Provides an executable with a default `main()` that calls `RUN_ALL_TESTS()`.

If you see linker errors about missing `main()`, link your test binary with `gtest_main` or provide your own `main()` that initializes and runs tests:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

For GoogleMock, use `gmock` and `gmock_main` similarly.

### How do I correctly set up GoogleMock alongside GoogleTest?
GoogleMock depends on GoogleTest. When building or linking, include GoogleMock libraries (`gmock` or `gmock_main`) which transitively include GoogleTest. Linking `gmock_main` provides the `main()` function for mock tests.

---

## Common Issues & Solutions

### 1. Compiler Standard Compatibility
- **Problem**: Errors about unsupported C++ features or unknown flags.
- **Cause**: Compiler does not support or is not set to use C++17.
- **Solution**: Upgrade your compiler or set your build files to target C++17 explicitly (see FAQ above).

### 2. Include Paths Not Set or Incorrect
- **Problem**: Header files for GoogleTest/GoogleMock cannot be found.
- **Cause**: Missing or incorrect include directories.
- **Solution**: Verify your build configuration points to the correct `googletest/include` and `googlemock/include` directories. In CMake, if using `FetchContent` or `add_subdirectory`, this is automated.

### 3. Linking Errors for `main()`
- **Problem**: Undefined reference to `main`.
- **Cause**: Linking only with `gtest` or `gmock` without `gtest_main` or `gmock_main`.
- **Solution**: Link your executable with the `-lgtest_main` or `-lgmock_main` library or provide your own `main()` function.

### 4. Visual Studio Runtime Library Mismatch
- **Problem**: Linker errors due to runtime library conflicts (e.g., MSVC runtime mismatch).
- **Cause**: GoogleTest uses static runtime by default; your project may use dynamic runtime.
- **Solution**: Enable `gtest_force_shared_crt` option in your CMake configuration to align runtimes, e.g.,

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

### 5. Multi-threading and Linking with pthread
- **Problem**: Linker errors related to pthread symbols.
- **Cause**: On POSIX systems, GoogleTest requires pthread for thread safety.
- **Solution**: Add pthread to your linker flags (e.g., `-lpthread`), or let CMake handle it automatically if you use its CMake scripts.

---

## Quick Environment Setup Verification

After building GoogleTest or GoogleMock, verify your installation by compiling and running a simple test program:

```cpp
#include <gtest/gtest.h>

TEST(SimpleTest, AssertionTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

If this compiles, links, and runs successfully, your setup works correctly.

---

## Best Practices to Avoid Build Problems

- Always use a modern compiler supporting C++17 or later.
- When using CMake, prefer the FetchContent method or `add_subdirectory()` to ensure proper setup.
- Link with `gtest_main` or `gmock_main` to avoid writing your own `main()` unless custom behavior is required.
- Enable `gtest_force_shared_crt` on Windows to prevent runtime mismatches.
- For continuous integration systems, keep your build scripts consistent to avoid hidden environment disparities.

---

## Troubleshooting Checklist

<Steps>
<Step title="Verify Compiler Version and Flags">
Ensure you use a compiler that supports C++17 and confirm your build system passes flags like -std=c++17.
</Step>
<Step title="Check Include Paths">
Confirm your buildâ€™s include paths point to GoogleTest/GoogleMock headers.
</Step>
<Step title="Confirm Linked Libraries">
Make sure you link against the correct libraries: gtest_main/gmock_main or provide main().
</Step>
<Step title="Resolve Runtime Conflicts on Windows">
Use the `gtest_force_shared_crt` option to align runtimes.
</Step>
<Step title="Verify pthread Linking on POSIX">
Add `-lpthread` if linker complains about pthread symbols.
</Step>
</Steps>

---

## Example: Linking GoogleTest in a CMake Target

```cmake
# Download GoogleTest sources (one-time setup)
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

# Your test target
add_executable(my_test test.cpp)

# Link to GoogleTest with main() provided
target_link_libraries(my_test PRIVATE gtest_main)

# Enable C++17
target_compile_features(my_test PRIVATE cxx_std_17)

# Add the test
add_test(NAME my_test COMMAND my_test)
```

---

## Additional Resources

- [Installation with CMake](https://github.com/google/googletest/blob/main/docs/installation.md#installation-with-cmake)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [Getting Started Troubleshooting Common Errors](https://github.com/google/googletest/blob/main/docs/faq.md#common-errors)

---

For detailed build integration and advanced troubleshooting, please refer to the "Ecosystem & Build Integration" and "Solving Common Setup Problems" pages in the Getting Started tab.

<br>

---

## Troubleshooting Examples

<AccordionGroup title="Common Build Errors and Fixes">
<Accordion title="Error: Compiler does not support C++17 features">
<b>Problem:</b> Attempting to build GoogleTest triggers errors about keywords or library features not recognized.<br>
<b>Fix:</b> Upgrade your compiler or add the following to your build config:<br>
```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```
Ensure the compiler invocation includes `-std=c++17` (or equivalent).
</Accordion>
<Accordion title="Linker error: undefined reference to main">
<b>Problem:</b> Linker cannot find `main()` function.

<b>Fix:</b> Link against `gtest_main` (or `gmock_main` if you use GoogleMock) which provides the main function. Alternatively, write your own:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```
</Accordion>
<Accordion title="Header files not found">
<b>Problem:</b> Build fails stating `gtest/gtest.h` or similar headers are missing.

<b>Fix:</b> Make sure your build system's include paths include the directory where GoogleTest headers reside. If using CMake with FetchContent or add_subdirectory(), this happens automatically.
</Accordion>
<Accordion title="Runtime Library Mismatch on MSVC">
<b>Problem:</b> Linker errors complaining about runtime library mismatch (e.g., static vs dynamic CRT).

<b>Fix:</b> Add to your top-level `CMakeLists.txt`:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```
This option ensures GoogleTest uses the dynamic runtime matching your project.
</Accordion>
</AccordionGroup>

---

## Understanding the Default `main()` Provided by GoogleTest and GoogleMock

GoogleTest and GoogleMock provide default `main` function implementations to simplify running your tests. For example, the GoogleMock [`gmock_main.cc`](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc) file:

- Initializes the GoogleMock and GoogleTest frameworks via `testing::InitGoogleMock()`.
- Calls `RUN_ALL_TESTS()` to run all registered tests.

If your project requires additional setup before tests run, you must provide your own `main()` and call `InitGoogleTest()` or `InitGoogleMock()` as appropriate.

---

## Final Tips

- Always verify your build environment against the [System Requirements & Supported Platforms](https://github.com/google/googletest/blob/main/docs/requirements.md) documentation.
- Use Google's recommended build approaches such as CMake FetchContent or Bazel integration for the smoothest setup.
- Check the FAQ and troubleshooting sections first when encountering build errors; they contain specific solutions tailored to common pain points.

---

<div align="center">Documentation version: v1.17.0</div>
