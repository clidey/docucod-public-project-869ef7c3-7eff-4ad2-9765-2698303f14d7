---
title: "How do I install and build GoogleTest?"
description: "Provides guidance on acquiring, building, and linking GoogleTest (and GoogleMock) using CMake, Bazel, and pkg-config. Covers common build issues and platform requirements, ensuring users can start testing quickly."
---

# How do I install and build GoogleTest?

This guide provides comprehensive instructions for acquiring, building, and linking GoogleTest and GoogleMock using popular build systems like CMake and Bazel. It covers system requirements, common build workflows, troubleshooting tips, and best practices to help you get your testing environment up and running quickly and reliably.

---

## Table of Contents

- [Acquiring GoogleTest and GoogleMock](#acquiring-googletest-and-googlemock)
- [Building with CMake](#building-with-cmake)
  - [Standalone CMake Project](#standalone-cmake-project)
  - [Incorporating Into Existing CMake Project](#incorporating-into-existing-cmake-project)
  - [C++ Standard Version Requirements](#c-standard-version-requirements)
  - [Visual Studio Runtime Compatibility](#visual-studio-runtime-compatibility)
- [Building with Bazel](#building-with-bazel)
- [Using pkg-config](#using-pkg-config)
- [Common Build Issues and Troubleshooting](#common-build-issues-and-troubleshooting)
- [Next Steps](#next-steps)

---

## Acquiring GoogleTest and GoogleMock

GoogleTest and GoogleMock are distributed together in the same repository. To get started:

- Clone or download the repository from GitHub:

  ```sh
  git clone https://github.com/google/googletest.git -b v1.17.0
  cd googletest
  ```

- GoogleMock is included by default in the source. If you want to build only GoogleTest, specific build options will apply as described below.

---

## Building with CMake

GoogleTest provides a CMake build system suitable for a wide range of platforms, including Linux, Windows, and macOS. This section outlines common workflows for building GoogleTest (and GoogleMock) using CMake.

### Standalone CMake Project

Build GoogleTest as a standalone project by following these steps:

1. Create a build directory:

   ```sh
   mkdir build
   cd build
   ```

2. Generate build files with CMake.

   To build GoogleTest and GoogleMock both:

   ```sh
   cmake ..
   ```

   To build only GoogleTest without GoogleMock:

   ```sh
   cmake .. -DBUILD_GMOCK=OFF
   ```

3. Build the project:

   ```sh
   make
   ```
   or using Visual Studio, open the generated `.sln` file and build.

4. Optionally install GoogleTest (requires admin privileges):

   ```sh
   sudo make install
   ```

### Incorporating Into Existing CMake Projects

You can integrate GoogleTest into your existing project in one of two common ways:

- **Link against installed GoogleTest libraries:**

  Use `find_package(GTest CONFIG REQUIRED)` in your CMakeLists.txt if GoogleTest is already installed on the system.

- **Build GoogleTest as part of your project:**

  Add the GoogleTest source as a subdirectory or fetch it during your build configuration using CMake's `FetchContent`. This ensures consistent compiler and linker settings, which is especially important on platforms like Windows.

Example using `FetchContent`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # For Windows runtime compatibility
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test1.cc test2.cc)
target_link_libraries(my_tests GTest::gtest_main)
```


### C++ Standard Version Requirements

GoogleTest requires a compiler that supports **at least C++17**. Ensure your top-level CMakeLists.txt sets this explicitly:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

If your project cannot set this globally (e.g., it’s a C project), manually add `-std=c++17` or equivalent flags as appropriate to your compiler.

### Visual Studio Runtime Compatibility

By default, Visual Studio projects link the C runtime dynamically, while GoogleTest links it statically. This mismatch causes linker errors like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug'
```

To resolve this, enable the `gtest_force_shared_crt` option in your CMake configuration to make GoogleTest link dynamically with CRT:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This adjustment ensures that runtime libraries are consistent between GoogleTest and your project.

---

## Building with Bazel

GoogleTest and GoogleMock can also be built and used with Bazel.

- Add GoogleTest as an external dependency in your `WORKSPACE` file.
- Use the provided Bazel targets to build and link your tests.

Refer to the official Bazel integration guide for GoogleTest for detailed Bazel usage instructions.

---

## Using pkg-config

For environments that support `pkg-config`, GoogleTest can generate `.pc` files (`gtest_main.pc`, `gmock_main.pc`), which allow simpler integration and compiler flags discovery:

- Use `pkg-config --cflags gtest_main` to get compiler flags.
- Use `pkg-config --libs gtest_main` to get linker flags.

Make sure to install GoogleTest properly for these to be available.

---

## Common Build Issues and Troubleshooting

**Problem:** Linker errors related to pthreads on Linux.

**Solution:** When building manually, ensure you link against the pthread library (`-lpthread`). The CMake scripts handle this automatically.


**Problem:** Compiler errors due to missing C++17 support.

**Solution:** Check your compiler version and flags to ensure C++17 is enabled.

**Problem:** Runtime or compile-time errors due to incompatible Visual Studio runtime libraries.

**Solution:** Enable the `gtest_force_shared_crt` option in CMake as described above.

**Problem:** Macro name collisions with other libraries.

**Solution:** Use GoogleTest control macros to rename conflicting macros (e.g., `-DGTEST_DONT_DEFINE_TEST=1`) and adjust your code accordingly.

**Problem:** Building only GoogleTest without GoogleMock.

**Solution:** Use `-DBUILD_GMOCK=OFF` when configuring with CMake.

---

## Next Steps

* After building GoogleTest successfully, explore the **[GoogleTest Primer](../overview/getting-started-with-googletest/product-introduction-and-value.md)** to learn how to write your first tests.
* Check out **[Writing and Running Your First Test](../getting-started/first-steps/write-first-test.md)** for practical examples.
* If you run into problems, consult the **[Troubleshooting Common Issues](../getting-started/first-steps/troubleshooting.md)** section.
* For integrating testing seamlessly into your builds, see **[Integrating with CMake and Bazel](../guides/integration-and-best-practices/build-system-integration.md)**.

---

## Example Minimal CMake Workflow

```sh
# Clone the repository
$ git clone https://github.com/google/googletest.git
$ cd googletest

# Create build directory
$ mkdir build && cd build

# Configure build (includes GoogleMock by default)
$ cmake ..

# Build all libraries
$ make

# (Optional) Install to system
$ sudo make install
```


## Example Linking in Your Project's `CMakeLists.txt`

```cmake
add_executable(my_test_executable tests/my_tests.cc)

# Link against GoogleTest main library that provides a ready-to-use main()
target_link_libraries(my_test_executable GTest::gtest_main)

# Discover and register tests automatically
enable_testing()
include(GoogleTest)
gtest_discover_tests(my_test_executable)
```


---

## Summary

Following this guide ensures you have a reliable, portable, and reproducible GoogleTest build environment across platforms. Whether working standalone or integrating into an existing project, CMake provides flexible options, and Bazel support is optionally available. Pay attention to platform-specific requirements, especially Windows runtime settings, to avoid common pitfalls.

---

For a quick introduction, see the [Quickstart: Building with CMake guide](../getting-started/setup-overview/install-cmake.md).


---

# Additional References

- **GoogleTest source:** [https://github.com/google/googletest](https://github.com/google/googletest)
- **Official CMake tutorial:** [https://cmake.org/cmake/help/latest/guide/tutorial/index.html](https://cmake.org/cmake/help/latest/guide/tutorial/index.html)
- **C++17 standard requirements:** check your compiler documentation
- **GoogleMock:** Included by default with GoogleTest source

---

*This document focuses strictly on building and installing GoogleTest and GoogleMock. For information about writing tests, running tests, or other advanced topics please visit related documentation pages.*


---

<Info>
Make sure to run `cmake ..` or equivalent from a clean build directory to avoid stale cache issues.
</Info>

<Note>
If you choose to build only GoogleTest without GoogleMock, specify `-DBUILD_GMOCK=OFF` during CMake configuration.
</Note>

<Check>
On Visual Studio, verify that your project’s Runtime Library setting matches with that used by GoogleTest to prevent linker errors.
</Check>