---
title: "How can I make my tests run faster?"
description: "Performance tips for large test suites, including strategies for parallel test execution, fixture optimization, and minimizing unnecessary setup or teardown overhead. References third-party tools and flags to accelerate testing."
---

# How can I make my tests run faster?

Performance is crucial for managing large test suites effectively. This page provides practical tips and strategies tailored to GoogleTest users for accelerating test execution, focusing on parallel test execution, optimizing test fixtures, and reducing unnecessary setup and teardown overhead. By applying these techniques, you can speed up your feedback cycle and improve overall testing efficiency.

---

## 1. Parallel Test Execution

Parallelizing test runs is one of the most effective ways to reduce total test duration, especially when you have a large number of independent tests.

### a. Use Test Sharding
GoogleTest supports sharding, allowing you to distribute subsets of tests across multiple machines or processes.

- **Environment Variables to Configure Sharding:**
  - `GTEST_TOTAL_SHARDS`: Total number of shards (test splits).
  - `GTEST_SHARD_INDEX`: Index of the current shard, zero-based.

When these are set, GoogleTest runs only the subset of tests belonging to the given shard index. Across all shards, the entire test suite will run exactly once.

**How it works:**
- GoogleTest automatically selects tests for each shard based on your configuration.
- The sharding logic handles disabled and filtered tests appropriately.

### b. Use Multiple Machines or Processes
- You can run the same test binary concurrently on multiple machines, each with different shard settings.

- A sharding-aware test runner can coordinate these executions, aggregating the results from all shards after completion.

### c. Control Test Order and Randomization
- Use the `--gtest_shuffle` flag to randomize the test execution order in each run, which can expose test dependencies and improve parallel fairness.

- Specify a seed with `--gtest_random_seed` to reproduce flaky failures.

### d. Repeat Tests Efficiently
- The `--gtest_repeat` flag lets you repeat test runs multiple times for stability checks without restarting the binary each time.

## 2. Fixture Setup and Teardown Optimization

Expensive setup or teardown in test fixtures can bottleneck your tests. GoogleTest provides mechanisms to minimize this overhead.

### a. Use Per-Test Suite Setup/TearDown

Instead of setting up heavy resources before every single test, leverage suite-level setup and teardown:

- Define `static void SetUpTestSuite()` in your test fixture to perform setup once before the first test in the suite runs.
- Define `static void TearDownTestSuite()` to clean up after all tests in the suite have executed.

**Benefits:**
- Shared resources are initialized once.
- Avoids repeat overhead in creating and destroying costly objects.

### b. Keep Tests Independent

Ensure tests do not modify suite-level shared resources in ways that affect others, or reset state appropriately.

### c. Avoid Heavy Work in Fixture Constructors or Destructors

Put expensive work in `SetUp()`/`TearDown()` or `SetUpTestSuite()`/`TearDownTestSuite()` methods instead of constructors, as test execution logic expects this pattern.

## 3. Minimize Unnecessary Setup and Teardown

- Avoid setting up unused global environments or fixtures. Use `testing::AddGlobalTestEnvironment()` carefully to only add required environments.

- Use `GTEST_SKIP()` in `SetUp()` methods to skip tests if certain expensive preconditions are unmet, preventing unnecessary execution.

## 4. Efficient Use of Parameterized and Typed Tests

- Use **value-parameterized tests** (`TEST_P`, `INSTANTIATE_TEST_SUITE_P`) and **typed tests** (`TYPED_TEST`, `TYPED_TEST_SUITE`) to avoid code duplication and leverage the underlying GoogleTest optimizations.

- Instantiate only the necessary parameter ranges or type lists to keep the test suite size manageable.

## 5. Leveraging GoogleTest Flags for Performance

GoogleTest provides command-line flags to control execution behavior and optimize performance:

| Flag                                | Description                                                                 |
|-------------------------------------|-----------------------------------------------------------------------------|
| `--gtest_fail_fast`                 | Stops test execution on first failure; useful for fast feedback iteration.  |
| `--gtest_also_run_disabled_tests`  | Runs disabled tests; use selectively to avoid slowing down normal runs.     |
| `--gtest_filter=<pattern>`          | Runs only selected tests matching the filter; use to isolate test subsets.  |
| `--gtest_repeat=<count>`            | Repeats tests multiple times; avoid full teardown overhead.                  |
| `--gtest_shuffle`                   | Randomizes test order, helping to detect inter-test dependencies quickly.   |
| `--gtest_random_seed=<value>`       | Sets seed value for randomization reproducibility.                          |

## 6. Tips for Test Writers

- Write **small, focused tests** that run quickly and independently.
- Avoid heavy I/O operations per test; consider mocking or simulating.
- Use **SCOPED_TRACE** to improve diagnostics rather than expensive logging in every test.
- Apply **ASSERT_NO_FATAL_FAILURE** or **EXPECT_NO_FATAL_FAILURE** to catch fatal failures within subroutines effectively without slowing overall runs.

## 7. Common Pitfalls and How to Avoid Them

### a. Tests Sharing State Unsafely
- Tests that mutate shared state can introduce flakiness.
- Always reset or isolate the state in `SetUp()` or `TearDown()`.

### b. Long-Running Global Environments
- Avoid expensive setup in global test environments if it can be done at suite or test level.

### c. Uninstantiated Parameterized Tests
- Make sure all `TEST_P` tests have corresponding `INSTANTIATE_TEST_SUITE_P` instantiations; otherwise, tests won't run and can generate warnings.

- Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST(TestSuiteName);` if intentional.

## 8. Using Third-Party Tools to Accelerate Testing

- Although GoogleTest offers rich built-in features, external tools like **test runners that support parallelism and test distribution** can complement its capabilities.

- Continuous integration systems often integrate with GoogleTest through XML or JSON output (`--gtest_output=xml:path`), enabling parallel execution and failure analysis.

- For extensive test suites, consider combining GoogleTest with build systems and test orchestration tools (e.g., Bazel, CMake, TestGrid) for optimized parallel execution and caching.

## 9. Summary: Best Practices for Faster Tests

- Run tests in parallel shards across machines or processes.
- Optimize fixture setup with suite-level setup/teardown.
- Use built-in command-line flags for filtering and repetition.
- Write isolated, lightweight tests with minimal shared state.
- Leverage parameterized tests to reuse efficiently.

---

## References and Further Reading

- [GoogleTest Sharding and Parallel Execution (Advanced Guide)](docs/advanced.md#running-test-programs-advanced-options)
- [Test Fixtures and Test Suites (API Reference)](docs/reference/testing.md#test)
- [Parameterized and Typed Tests (Guide)](guides/advanced-testing-strategies/parameterized-and-typed-tests)
- [Running and Configuring Tests (API Reference)](api-reference/core-testing-api/running-and-configuring-tests)
- [Global Set-Up and Tear-Down (Advanced Topics)](docs/advanced.md#global-set-up-and-tear-down)
- [Command-Line Flags and Configuration (Advanced Topics)](docs/advanced.md#running-test-programs-advanced-options)

<Tip>
To achieve the fastest possible test runs, combine sharding on multiple machines with lightweight test fixtures and judicious use of parameterized tests. Always monitor your test duration distribution to find bottlenecks for targeted optimization.
</Tip>
