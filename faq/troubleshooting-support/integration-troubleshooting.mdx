---
title: "Integration and Build Issues"
description: "Answers common questions around integrating GoogleTest and GoogleMock into various build systems, handling platform-specific quirks, and ensuring smooth CI workflows. Provides tips based on real-world user experiences."
---

# Integration and Build Issues

This page answers common questions around integrating GoogleTest and GoogleMock into various build systems, handling platform-specific quirks, and ensuring smooth continuous integration (CI) workflows. It offers practical tips and guidance drawn from real-world user experiences to help you seamlessly embed testing into your development process.

---

## 1. Common Integration Questions

### 1.1 How should I link GoogleTest and GoogleMock libraries?

To integrate GoogleTest and GoogleMock into your C++ projects, you typically:

- Link against the appropriate libraries: usually `gtest`, `gtest_main`, and `gmock` depending on your needs.
- Use CMake, Bazel, or your build system to include GoogleTest headers and libraries.

If using CMake, here is a minimal pattern:

```cmake
find_package(GTest REQUIRED)

target_link_libraries(my_test PRIVATE GTest::gtest GTest::gtest_main GMock::gmock)
```

Refer to the [Integrating with CMake, Bazel, and Other Build Tools](/guides/integration-and-best-practices/build-integration) for step-by-step instructions.

---

### 1.2 Are there special considerations for platform-specific build quirks?

Yes. Different platforms and compilers may impose unique constraints:

- **Windows**: Ensure you use the proper runtime (e.g., `/MD` or `/MT`) to avoid CRT conflicts.
- **Linux/macOS**: Be aware of threading and signal-handling interactions affecting Death Tests.
- **Cross-compilation and embedded environments**: Verify support for exceptions and standard threading.

The [Supported Platforms & Integration Points](/overview/feature-glance-integration/platforms-integration) provides detailed platform compatibility and recommendations.

---

### 1.3 How to address build or linker errors related to GoogleTest?

Common errors include undefined symbols or missing dependencies:

- Verify that GoogleTest source or binary libraries are properly added to the link line.
- Check that you initialized GoogleTest correctly by calling `testing::InitGoogleTest()` before running tests.
- For static const variables declared in test fixtures, ensure you provide definitions in source files.

See [Troubleshooting Common Issues](/getting-started/troubleshooting/common-issues) for more details and examples.

---

## 2. Naming Conventions and Test Registration

### 2.1 Why should test suite names and test names avoid underscores?

GoogleTest reserves underscores for internal use in generated class names. Underscores at the start or end of test suite or test names, or consecutive underscores, can cause name collisions or compiler errors.

Example of problematic tests:

```cpp
TEST(Time, Flies_Like_An_Arrow) { ... }
TEST(Time_Flies, Like_An_Arrow) { ... }
```

Both generate the same underlying class name and may break in certain compilers or future versions.

The recommended practice is to avoid underscores in test suite and test names for compatibility and forward stability.

---

### 2.2 Can I dynamically register tests at runtime?

Yes. Use `::testing::RegisterTest()` to programmatically add tests before `RUN_ALL_TESTS()`.

This is useful for data-driven or configuration-driven test registration.

Example:

```cpp
testing::RegisterTest(
    "MySuite", "Test1", nullptr, nullptr, __FILE__, __LINE__, []() {
      return new MyFixtureTest;
    });
```

Ensure all tests in a test suite use the same fixture class to avoid runtime errors.

See [Registering tests programmatically](../advanced.md#registering-tests-programmatically) for detailed guidance.

---

## 3. Continuous Integration (CI) Workflow Tips

### 3.1 How to generate machine-readable test reports for CI?

GoogleTest can emit XML or JSON reports, which CI systems commonly consume for test results reporting.

Use the flag or environment variable:

- Flag: `--gtest_output=xml[:path]` or `--gtest_output=json[:path]`
- Env var: `GTEST_OUTPUT=xml[:path]` or `json[:path]`

Example:

```bash
./my_test --gtest_output=xml:reports/my_test_results.xml
```

The generated report files contain structured information about all test suites and test results.

More details are covered in [Testing Reference](reference/testing.md#controlling-test-output).

---

### 3.2 How can tests be run in parallel or sharded?

GoogleTest supports test sharding, allowing splitting tests across multiple machines or processes.

Set environment variables:

- `GTEST_TOTAL_SHARDS`: total number of shards
- `GTEST_SHARD_INDEX`: index of the current shard (0-based)

With these set, the test executable automatically runs only the subset of tests assigned to that shard.

In CI pipelines, coordinate these variables to speed up test runs via parallel execution.

Refer to [Running Test Programs: Advanced Options](reference/testing.md#distributing-test-functions-to-multiple-machines) for details.

---

## 4. Common Build and Integration Pitfalls

### 4.1 Fatal and non-fatal assertion usage in constructors or destructors can cause build or test failures.

- GoogleTest does not allow fatal assertions (`ASSERT_*`) in constructors or destructors.
- Use `SetUp()` and `TearDown()` methods of test fixtures instead for setup/teardown logic that may fail.

See [FAQ](faq/core-faq/getting-started-faq.md#should-i-use-the-constructordestructor-of-the-test-fixture-or-setuptear-down) for explanations.

### 4.2 Mixing `TEST` and `TEST_F` in the same test suite is illegal and causes runtime failures.

All tests in a test suite must use the same fixture class.

If you mix `TEST` and `TEST_F` in one test suite, GoogleTest reports an error and fails at runtime.

Ensure that your test suite consistently uses either `TEST` (no fixture) or `TEST_F` (with a fixture).

### 4.3 Undefined references to static const members defined only inside class bodies

For static const data members (non-`constexpr`), you must provide a definition in a `.cc` file.

Wrong:

```cpp
class Foo {
  static const int kValue = 42;  // Declaration + init
};
```

Correct:

```cpp
const int Foo::kValue;  // Definition without initializer
```

Failing to do this causes linker errors.

---

## 5. Troubleshooting Common Integration Issues

### 5.1 My test suite reports "no matching function for call to" errors with `ASSERT_PRED` macros

These errors usually mean that the compiler cannot deduce the proper overload of a predicate used in `EXPECT_PRED*` or `ASSERT_PRED*` macros.

Solution:

- Explicitly specify the predicate type using a cast or specify template parameters.

Refer to the [Assertions Reference](reference/assertions.md#EXPECT_PRED) for examples.

### 5.2 Tests do not run or all are skipped unexpectedly

Common causes:

- You may have set a filter (`--gtest_filter`) that excludes all tests.
- Tests may be disabled (`DISABLED_` prefix) and not run unless `--gtest_also_run_disabled_tests` is set.
- In sharded runs, your shard index may exclude all tests.

Run your test executable with `--gtest_list_tests` to verify which tests are visible.

### 5.3 Death tests hang or fail unexpectedly

Death tests spawn child processes and are sensitive to multithreading and environment state.

Tips:

- Avoid creating threads globally before death tests.
- Use the "threadsafe" death test style to improve stability.
- Follow the convention of naming test suites containing death tests with suffix `DeathTest` to ensure death tests run first.

Further details are available in [Death Tests](concepts/core-architecture/test-lifecycle-and-execution.md#death-tests) and the FAQ.

---

## 6. Best Practices

### 6.1 Consistent Naming

- Avoid underscores in test suite and test names.
- Use clear, concise, and unique test and suite names.

### 6.2 Use of Fixtures

- Share expensive resources via static members and `SetUpTestSuite`/`TearDownTestSuite`.
- Keep tests independent to avoid hidden dependencies and improve parallel execution.

### 6.3 CI Friendly Setup

- Generate XML or JSON test reports.
- Use sharding for large test suites.
- Integrate test invocation and artifact collection into your CI pipeline.

### 6.4 Use GoogleTest Flags for Control

- Use `--gtest_filter` for selective runs.
- Use `--gtest_repeat` to find flaky tests.
- Use `--gtest_shuffle` to detect order dependencies.

---

## 7. Useful Links

- [Installation Instructions](/getting-started/setup-basics/installation)
- [Building with CMake and Bazel](/guides/integration-and-best-practices/build-integration)
- [Supported Platforms and Integration](/overview/feature-glance-integration/platforms-integration)
- [Troubleshooting Common Issues](/getting-started/troubleshooting/common-issues)
- [Death Tests Guide](/guides/practical-testing-patterns/death-tests)
- [Core FAQ: Getting Started](/faq/core-faq/getting-started-faq)
- [Core FAQ: Mocking and Matchers](/faq/core-faq/mocking-faq)
- [Testing Reference](/docs/reference/testing.md)

---

If you encounter difficulties during integration or build setup, following these guidelines and referring to the linked resources will typically resolve most issues efficiently.