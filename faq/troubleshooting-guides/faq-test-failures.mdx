---
title: "Why are my tests failing or not being discovered?"
description: "Examines the most frequent causes for test failures or missing test detection, such as incorrect test registrations, missing dependencies, or improper test naming. Provides diagnostic steps and links to relate source utilities."
---

# Why Are My Tests Failing or Not Being Discovered?

This FAQ addresses the most frequent causes behind failing tests or missing test detection in GoogleTest. If your tests are not running or failing unexpectedly, this guide walks you through common pitfalls, diagnostic strategies, and practical solutions to help you identify and resolve these issues efficiently.

---

## 1. Common Causes for Test Failures and Missing Detection

### a) Incorrect Test Registration

GoogleTest automatically discovers tests registered via the `TEST()`, `TEST_F()`, `TEST_P()`, and related macros. If you manually register tests, improper usage of `testing::RegisterTest()` may cause tests not to appear or run.

- Ensure that `RegisterTest` calls occur *before* `RUN_ALL_TESTS()`.
- The factory callable passed must create instances of the correct test fixture type.
- Test suite and test names must be valid C++ identifiers with **no underscores** to avoid naming conflicts and registration failures.

### b) Naming Issues

- Test suite names and test names **must not contain underscores (`_`)**. While C++ identifiers may allow underscores, GoogleTest forbids them to prevent issues in test filtering and output.
- Reserved suffixes like `DeathTest` affect test execution order and behavior—use carefully.

### c) Disabled Tests

- Tests prefixed with `DISABLED_` are compiled but *not executed*.
- Disabled test suites behave similarly.
- To include disabled tests in a run, use the flag `--gtest_also_run_disabled_tests`.

### d) Missing `InitGoogleTest()` Invocation

- You must call `testing::InitGoogleTest(&argc, argv)` before `RUN_ALL_TESTS()` in your test program’s `main()`.
- Failure to initialize properly causes test discovery failures.

### e) Linking and Build Configuration

- Ensure your test binaries are properly linked with GoogleTest and all dependencies.
- Missing or corrupted object files can cause tests to be silently skipped.
- When using build systems (e.g., CMake, Bazel), verify that your test sources are included and compiled.

### f) Filtering and Sharding

- The test filter flag (`--gtest_filter`) restricts which tests are run.
- Overly restrictive or incorrect filters may yield no tests to run.
- Similarly, test sharding controlled by `GTEST_SHARD_INDEX` and `GTEST_TOTAL_SHARDS` environment variables can prevent tests from running in a shard if filters don't match or sharding is misconfigured.

### g) Errors in Test Fixture Setup and TearDown

- If `SetUpTestSuite()`, `SetUp()`, or constructors throw, fail assertions, or call `GTEST_SKIP()`, tests may be skipped or fail prematurely.
- Verify that setup functions do not cause fatal failures unintentionally.


## 2. Diagnosing Test Discovery Issues

### Step 1: List Available Tests

Run your test binary with the `--gtest_list_tests` flag to list all discovered tests without running any:

```bash
./my_test_binary --gtest_list_tests
```

If tests are missing from this list, it indicates they are not getting registered.

### Step 2: Check Naming Conventions

Review your test suite and test names:

- They must be valid C++ identifiers without underscores.
- Avoid using `DISABLED_` prefix unless intentional.

### Step 3: Confirm Initialization

Make sure your `main()` calls `InitGoogleTest()` before running tests.

### Step 4: Review Filters

Check if `--gtest_filter` or `GTEST_FILTER` environment variable are set to restrictive patterns.

### Step 5: Verify Registration in Dynamic Tests

If using `RegisterTest()` or programmatic test registration, ensure that:

- The factory function returns the correct fixture type.
- Calls happen before tests run.

### Step 6: Inspect Test Fixture Setup

Add diagnostic logging or remove complex setup logic to identify failures in `SetUp` or `SetUpTestSuite`.


## 3. Common Test Failure Scenarios

### a) Fatal Failure in Constructor or Setup

- Fatal failures (`ASSERT_*` or `FAIL()`) in constructors or `SetUp()` abort only the current function, not the whole test suite.
- Use `SetUpTestSuite()` or `SetUp()` for fatal checks instead of constructors.
- If necessary, consult [Assertion Placement and Propagation](../advanced.md#assertion-placement-and-propagation).

### b) Mixing TEST and TEST_F in the Same Suite

- Defining some tests with `TEST()` and others with `TEST_F()` under the same suite causes errors.

### c) Using Underscores in Test Names

- Underscores are disallowed to avoid filtering and output problems; adjusting names often resolves failures.

### d) Unregistered Parameterized or Typed Tests

- Forgetting to instantiate parameterized tests or register typed tests causes zero tests to run.
- Use `INSTANTIATE_TEST_SUITE_P()` correctly and ensure visible instantiation.

### e) Unhandled Exceptions

- If exceptions are thrown in tests, GoogleTest reports failures unless catch exceptions flag is disabled.
- Use `--gtest_catch_exceptions=0` to allow exceptions to propagate to the debugger.


## 4. Troubleshooting Tips and Best Practices

- **Incremental Isolation:** Comment out or disable parts of your test to isolate failure causes.
- **Test Output Logging:** Use `SCOPED_TRACE()` to add trace information for complex nested test calls.
- **Check Disabled Tests Warnings:** GoogleTest prints warnings if disabled tests exist; use them to find hidden issues.
- **Use Listing Feature:** Running with `--gtest_list_tests` quickly tells if tests are discovered.
- **Use `HasFatalFailure()` in helper functions:** To detect if an `ASSERT_*` caused abort in subroutine.
- **Ensure Consistency in Fixtures:** Do not mix macros for different fixture types in same suite.
- **Ensure Proper Linking:** Missing symbol or compilation mistakes sometimes cause tests to vanish from discovery.


## 5. Example Diagnostic Workflow

1. Run `./my_test_binary --gtest_list_tests` to verify tests are recognized.
2. Check test and suite names for underscores or reserved suffixes.
3. Verify your `main()` function calls `InitGoogleTest()` before `RUN_ALL_TESTS()`.
4. Run test binary without any filters or with `--gtest_filter=*`.
5. Confirm that there are no fatal failures in setup methods.
6. Review build logs for missing files or linking errors.


## 6. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — introductory concepts and writing tests.
- [Advanced Guide](../advanced.md) — more on assertions, fixtures, and test lifecycle.
- [Test Case Structure & Registration](../api-reference/test-and-assertion-api/test-case-api.md) — detailed info on test registration and naming.
- [Writing Your First Test](../getting-started/first-test/writing-basic-test.md) — a quick start tutorial on test creation.

---

<Tip>
If your tests are not discovered, remember that failing to call `testing::InitGoogleTest()` before test execution or using disallowed naming conventions are the leading causes. Always run your tests with `--gtest_list_tests` to immediately reveal whether your tests are detected.
</Tip>

<Warning>
Never mix `TEST()` and `TEST_F()` within the same test suite or use underscores in test names, or your tests may fail silently or produce cryptic errors.
</Warning>

<Note>
Disabled tests (prefixed with `DISABLED_`) remain compiled but are skipped at runtime. Use the `--gtest_also_run_disabled_tests` flag if you intend to run them.
</Note>

<AccordionGroup title="Common Issues & Solutions">
<Accordion title="Test not listed with --gtest_list_tests">
If your test does not appear in the list:
- Confirm test macros are used correctly.
- Verify test suite and test names contain no underscores.
- Ensure `InitGoogleTest()` is called before running tests.
- Check build system includes the file.
- Review `RegisterTest()` usage in advanced cases.
</Accordion>
<Accordion title="Tests fail immediately without running">
- Check for fatal failures in test fixture constructors, `SetUp()`, or `SetUpTestSuite()`.
- Look for exceptions if enabled and whether caught or propagated.
- Use logging or debugging in setup to trace failures.
- Use `HasFatalFailure()` to identify failing subroutines.
</Accordion>
<Accordion title="Tests silently skipped or never run">
- Verify that filters are not excluding your tests.
- Check environment variables for sharding configuration.
- Confirm tests are not disabled unintentionally.
- Use `--gtest_filter=*` and `--gtest_also_run_disabled_tests` to run broadly.
</Accordion>
</AccordionGroup>

---

## 7. Summary

Detecting why tests fail or are not discovered often comes down to verifying test registration, naming conventions, and proper initialization in the test harness. GoogleTest's command-line flags for listing tests and filtering provide immediate feedback to validate registration and execution paths.

Always refer to GoogleTest's foundational guides and API documentation to understand proper test definition and execution mechanics.

---

## 8. Sample Minimal `main()` function for Testing Setup

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);  // Must be called first
  return RUN_ALL_TESTS();  // Runs all registered tests
}
```

---

## 9. Related Documentation

- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [Test Case Structure & Registration](../api-reference/test-and-assertion-api/test-case-api.md)
- [Advanced GoogleTest Topics](../advanced.md)
- [Test Writing and Setup Troubleshooting](../getting-started/troubleshooting/common-issues.md)
- [FAQ: Getting Started](../faq/common-questions/faq-getting-started.md)

---

## 10. Getting More Help

If you continue to experience issues with test discovery or failures, consider:

- Reviewing GoogleTest's official issues and user forums.
- Checking build system integration and linking settings.
- Running tests in isolation with minimal code to isolate failure causes.


---

_Source: GoogleTest internal implementation and official documentation excerpts, including `RegisterTest()`, test event lifecycle, and test suite registration logic._
