---
title: "Why am I getting linker or symbol errors?"
description: "Solutions to common build and linker errors, including missing symbols, multiple definition errors, and tips for correct linkage of GoogleTest/GoogleMock in your project. Includes advice on CMake/Bazel setup, and usage of provided main entry points."
---

# Why am I getting linker or symbol errors?

Linker or symbol errors are a common roadblock when integrating GoogleTest or GoogleMock into your C++ project. These errors typically occur when your build system or your project setup does not properly link the GoogleTest (or GoogleMock) libraries, or if there are conflicting or missing object files.

This FAQ addresses the common causes of these errors and provides actionable solutions to get your tests building and linking successfully.

---

## Common Linker and Symbol Errors

### Missing Symbols

If you encounter undefined reference errors for GoogleTest symbols such as:

```none
undefined reference to `testing::Test::Test()'
undefined reference to `testing::InitGoogleTest(int*, char**)' 
...
```

it usually means that your linker is missing GoogleTest implementation files or libraries.

### Multiple Definition Errors

Errors like:

```none
multiple definition of `testing::UnitTest::GetInstance()'
```

indicate that multiple definitions of the same symbols exist in the linker input, often caused by including implementation files (.cc/.cpp) directly in multiple places or incompatible static/dynamic linkage.

### Conflicting Runtime Libraries (MSVC Specific)

When building on Windows using MSVC, you may see errors related to runtime library mismatches. For example:

```none
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

This is caused by GoogleTest using a different runtime library setting (static vs dynamic) than your project.

---

## How to Fix Linker or Symbol Errors

### 1. Link Against GoogleTest Library Properly

Ensure that your build system links the compiled GoogleTest libraries (`gtest`, `gtest_main`, `gmock`, etc.) into your test executable.

- If you build GoogleTest from source, build it first and link to the generated libraries.
- If using CMake, link your test executable target like:

```cmake
target_link_libraries(your_test_target PRIVATE gtest gtest_main)
```

- Include GoogleTest headers via `#include <gtest/gtest.h>` but **do not** add GoogleTest source `.cc` files directly to your project.

### 2. Use the Provided Main Function or Define Your Own Correctly

You can link your tests against `gtest_main` to get a default `main()` implementation that initializes GoogleTest and calls `RUN_ALL_TESTS()`. This reduces the risk of missing essential calls.

Alternatively, write a custom `main()` as follows:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

**Tip:** Calling `testing::InitGoogleTest()` before `RUN_ALL_TESTS()` is mandatory.

### 3. Verify Build and Link Order

The order of source files and libraries can matter on some platforms and build systems. Make sure GoogleTest libraries are linked after your test code.

### 4. Avoid Multiple Inclusion of Implementation Files

GoogleTest’s source files (`.cc` files) define symbols that must only appear once. Never include these `.cc` files in multiple translation units.

### 5. On Windows, Match Runtime Library Settings

Make sure your project and GoogleTest use compatible runtime libraries.

- GoogleTest can be configured to use dynamic or static CRT.
- In CMake, toggle the `gtest_force_shared_crt` option:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This ensures GoogleTest links against the same CRT as your project.

### 6. For Bazel Users, Correctly Declare Dependencies

If you are building with Bazel, make sure your `BUILD` files properly declare dependencies on `@com_google_googletest//:gtest` and, if needed, `:gtest_main`. Also, confirm no conflicting versions are pulled in.

### 7. Use GoogleTest’s Recommended Build Integration

GoogleTest documentation and README recommend methods for integration:

- Using CMake with `FetchContent` or `add_subdirectory`
- Linking against prebuilt system-installed GoogleTest libraries
- Using `gtest_main` for main entry

Doing so reduces common linkage problems.

---

## Diagnosing Linker Errors

When linker errors occur:

1. **Check the missing symbol name** — it tells you which GoogleTest part failed to link.
2. **Confirm you have compiled GoogleTest sources or linked correctly**.
3. **Verify you do not include `.cc` files multiple times**.
4. **On Windows, verify runtime library compatibility**.
5. **Use verbose build output** to confirm link commands include GoogleTest libraries.

---

## Additional Tips for Success

- Always include `gtest/gtest.h` rather than internal headers.
- Use GoogleTest version compatible with your compiler and C++ standard (C++17 or above required).
- Avoid mixing GoogleTest source files and precompiled libraries in the same link unless properly configured.
- Run build clean to reset any stale object files.

---

## Example: Simple CMake Setup

Here is an example minimal `CMakeLists.txt` for a GoogleTest project:

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTests CXX)

enable_testing()

# Download GoogleTest
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)

target_link_libraries(my_test PRIVATE gtest_main)

include(GoogleTest)
gtest_discover_tests(my_test)
```

In this setup:
- GoogleTest is built as part of your project.
- Tests link against `gtest_main` to get a main() function.
- `gtest_discover_tests` auto-discovers tests.

---

## How to Report Unresolved Linker Issues

If you followed all steps yet still encounter linker errors:

- Verify the exact error message.
- Confirm which linker command is invoked and its arguments.
- Check for duplicate symbol definitions.
- Ensure all required GoogleTest libraries (`gtest`, `gmock` if used, `gtest_main`) are built and linked.
- Refer to GoogleTest community forums or GitHub issues for similar problems.

Also consult:
- [GoogleTest Primer](primer.md)
- [Advanced GoogleTest Topics](advanced.md)
- [Troubleshooting Setup Issues](getting-started/first-tests-and-troubleshooting/troubleshooting-setup-issues.md)

---

## Summary

Linker or symbol errors with GoogleTest are usually caused by missing or incorrect linkage of GoogleTest libraries, multiple definitions from improper file inclusions, or runtime library mismatches. Correct linkage, consistent project configuration, using provided main programs, and proper build integration resolve these issues reliably.

For more details, review the [Advanced GoogleTest Topics](advanced.md) and [Setup and Installation Guides](getting-started/setup-and-installation).


---

### Related Documentation

- [GoogleTest Primer](primer.md) — Introduction to writing tests
- [Advanced GoogleTest Topics](advanced.md) — Tips on advanced usage including test registration, fixtures, and assertions
- [Setup and Installation - Troubleshooting](getting-started/first-tests-and-troubleshooting/troubleshooting-setup-issues.md) — Common setup problems
- [GoogleTest README](googletest/README.md) — Build and integration instructions
- [Testing Reference (Macros and Assertions)](reference/testing.md) — API reference for test writing

<Tip>
Properly linking GoogleTest libraries and using the provided main entry point is the fastest path to resolving most linker errors when using GoogleTest.
</Tip>

<Warning>
Avoid including GoogleTest `.cc` implementation files directly in your project source; use compiled libraries instead.
</Warning>
