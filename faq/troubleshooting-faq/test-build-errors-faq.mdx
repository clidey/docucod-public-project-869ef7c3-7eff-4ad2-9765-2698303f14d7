---
title: "How do I fix common build or linking errors?"
description: "Addresses frequent build and linker issues such as missing headers, symbol resolution failures, and C++ standard mismatches. Suggests practical checks and solutions for CMake and Bazel users, along with references to sample projects and minimal reproducible examples."
---

# How do I fix common build or linking errors?

This page addresses frequent build and linker errors that users encounter while integrating and building GoogleTest and GoogleMock in their projects. It provides actionable guidance to resolve issues such as missing headers, unresolved symbols, C++ standard mismatches, and build system misconfigurations. These troubleshooting tips are tailored especially for common tools like CMake and Bazel, helping you restore a smooth build and linking process.

---

## Frequently Encountered Build and Linking Errors

### 1. Missing Header Files or Include Paths

**Problem:** Your compiler reports errors such as `fatal error: gtest/gtest.h: No such file or directory`.

**Cause:** Your build system is not correctly locating the GoogleTest headers.

**Solution:**
- Verify that your project includes the correct GoogleTest or GoogleMock header directories.
- For CMake users, ensure you use the correct target include directories. For example:
  ```cmake
  target_link_libraries(my_tests PRIVATE GTest::gtest GTest::gmock)
  ```
- If manually specifying include directories, add something like:
  ```cmake
  include_directories(${gtest_SOURCE_DIR}/include ${gmock_SOURCE_DIR}/include)
  ```
- Confirm that the GoogleTest source is available or that the library is installed on your system.

---

### 2. Undefined Reference or Linker Errors

**Problem:** Linker errors like "undefined reference to `testing::InitGoogleTest`" or missing symbols from GoogleMock or GoogleTest.

**Cause:** Your test executable is not linked against the required GoogleTest or GoogleMock libraries.

**Solution:**
- Link your test binaries against `gtest`, `gtest_main`, `gmock`, or `gmock_main` appropriately.

For example in CMake:
```cmake
add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests PRIVATE gtest_main gmock_main)
```

- Use `gmock` if you need mocking features; use `gtest` if only GoogleTest is needed.
- Link against `gmock_main` or `gtest_main` to use the provided `main()`.
- Avoid defining multiple `main()` functions; either use the provided `gtest_main`/`gmock_main` or provide your own but not both.

---

### 3. C++ Standard Version Mismatch

**Problem:** Compilation errors indicating incompatibility with C++ standards, or linker errors related to symbol versions.

**Cause:** GoogleTest and GoogleMock require at least C++17.

**Solution:**
- Ensure your compiler uses C++17 or above.
- In CMake, enforce this with:
  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```
- Check that both your project and GoogleTest / GoogleMock are compiled with compatible C++ standards to avoid ABI incompatibilities.

---

### 4. Duplicate `main()` Function Errors

**Problem:** Linker errors stating duplicate `main` function definitions.

**Cause:** Linking both your own `main()` and `gtest_main` or `gmock_main`.

**Solution:**
- Choose either:
  - Link against `gtest_main` or `gmock_main` to get the default `main()`.
  - Or provide your own `main()` and link only against `gtest` and/or `gmock`.

- Do not link both your own `main()` and `gmock_main` or `gtest_main` libraries simultaneously.

---

### 5. Threading and PThread-related Link Errors

**Problem:** Linker errors related to pthread symbols on platforms like Linux.

**Cause:** Missing linking against pthread library when GoogleTest detects pthread support.

**Solution:**
- Ensure your linker command includes `-lpthread`.
- If using CMake, this is usually handled automatically by `find_package(Threads)`. You can add:
  ```cmake
  find_package(Threads REQUIRED)
target_link_libraries(my_tests PRIVATE Threads::Threads)
  ```
- When using custom builds/scripts, explicitly add `-lpthread`.

---

### 6. GoogleMock Not Found or Link Errors

**Problem:** Errors when GoogleMock symbols are missing.

**Cause:** GoogleMock sources or libraries are missing or not linked.

**Solution:**
- Ensure GoogleMock is enabled and built along with GoogleTest (default in official repo).
- Link your tests against `gmock` or `gmock_main` as needed.
- For standalone GoogleMock build, verify you have the googletest sources accessible or included.

---

## Practical Checks for CMake Users

Follow this workflow when encountering build/link errors:

<Steps>
  <Step title="Validate Source Availability">
Ensure the GoogleTest/GoogleMock source directories are correctly located, either bundled or fetched as submodules or via FetchContent.
  </Step>
  <Step title="Configure with Verbose Output">
Run `cmake .. -DCMAKE_VERBOSE_MAKEFILE=ON` inside your build directory to check the exact compilation and linking commands.
  </Step>
  <Step title="Inspect Include and Link Targets">
Check your `CMakeLists.txt` to make sure test targets link correctly to GoogleTest/GoogleMock targets:
```cmake
target_link_libraries(my_tests PRIVATE gtest_main gmock_main)
```
  </Step>
  <Step title="Confirm C++ Standard">
Ensure `CMAKE_CXX_STANDARD` is set to at least 17 and enforced.
  </Step>
  <Step title="Check for Multiple Mains">
Avoid providing your own `main()` if linking with `gtest_main` or `gmock_main`.
  </Step>
  <Step title="Add Threading Libraries">
If using pthreads, link with it:
```cmake
find_package(Threads REQUIRED)
target_link_libraries(my_tests PRIVATE Threads::Threads)
```
  </Step>
  <Step title="Rebuild and Test">
Re-run `cmake --build .` and check for errors.
</Step>
</Steps>

<Tip>
For best compatibility and simplicity, use GoogleTest and GoogleMock as subdirectories or FetchContent in CMake, letting CMake handle all configurations and dependencies.
</Tip>

---

## Troubleshooting Common Bazel Build Problems

- Ensure you have the `@com_google_googletest` workspace rule included.
- Verify visibility of the GoogleTest and GoogleMock targets in your BUILD files.
- Use the correct Bazel test rules such as `cc_test` linking against `@com_google_googletest//:gtest_main`.
- Check for ABI mismatches and compile with C++17.

Refer to the Bazel integration guidelines in the official guides for detailed setup.

---

## References and Further Help

- Official [GoogleTest CMake Build Instructions](https://github.com/google/googletest/tree/main)
- Guide on [Build Integration](https://github.com/google/googletest/blob/main/docs/guides/advanced_scenarios/build_integration.md)
- Minimal reproducible example projects under the `examples/` directory in the GoogleTest repo
- GoogleTest [Primer](https://github.com/google/googletest/blob/main/docs/primer.md) for setup and test basics

---

<Check>
If you continue to experience build or linking issues, verify your compiler and linker flags, include and lib paths, and ensure consistent C++ standard versions across all compiled components.
</Check>


---

## Summary

This page empowers you to quickly identify and fix typical build and linker issues when working with GoogleTest and GoogleMock, focusing on missing includes, linking errors, C++ standard requirements, and runtime-related linkage. By following prescribed checks and configurations tailored to popular build systems like CMake and Bazel, you can achieve a stable and predictable test build environment.

For more detailed build integration and troubleshooting advice, please consult the related guides and primers linked throughout this page.

---

### Sample `main()` Usage to Avoid linker errors

If you decide to provide your own `main()`, it should look like this:

```cpp
#include "gmock/gmock.h"

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Otherwise, link your tests with `gmock_main` or `gtest_main` libraries to use the provided `main()`.

---

# Related Documentation

- [Getting Started Installation & Configuration](https://github.com/google/googletest/blob/main/docs/getting_started/core-setup/installation-platforms.md)
- [Build Integration Guide](https://github.com/google/googletest/blob/main/docs/guides/advanced-scenarios/build-integration.md)
- [Your First Test](https://github.com/google/googletest/blob/main/docs/getting_started/core-setup/first-test.md)
- [GoogleMock Integration](https://github.com/google/googletest/blob/main/docs/guides/getting-started/integrate-mocking.md)


---

# What to do next?

- Review your project's CMakeLists.txt or Bazel BUILD files to verify linking and include directives.
- Run builds with verbose flags to trace compilation steps.
- Use minimal examples to isolate problems.
- Consult community forums or issue trackers for environment-specific issues.