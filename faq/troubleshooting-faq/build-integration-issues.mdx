---
title: "Why am I having build or integration issues?"
description: "Highlights the most frequent problems with compiling or linking GoogleTest and GoogleMock, including mismatched compiler versions, missing files, and build toolchain misconfigurations. Offers guidance for both CMake and Bazel users, as well as troubleshooting for custom setups."
---

# FAQ: Why am I having build or integration issues?

This FAQ addresses the most frequent challenges developers encounter when compiling or linking GoogleTest and GoogleMock, focusing on mismatched compiler versions, missing files, and build toolchain misconfigurations. The guidance covers common pitfalls and resolution strategies for both CMake and Bazel build systems, including advice for custom or complex integration setups.

---

## Common Build and Integration Issues

### 1. Compiler Version Mismatch

**Problem:**
Your project uses a different compiler version or standard library than the precompiled GoogleTest or GoogleMock binaries.

**Why it Happens:**
GoogleTest and GoogleMock rely on compiler ABI compatibility. Even minor differences in compiler versions or standard library implementations can cause linker errors or runtime failures.

**How to Fix:**
- Ensure the compiler version used to build GoogleTest/GoogleMock matches your project’s compiler exactly.
- If you're using a system-installed package of GoogleTest, confirm your compiler version matches that of the package.
- For custom builds, rebuild GoogleTest and GoogleMock from source with your project's compiler.

<Tip>
Using consistent compiler versions across your dependencies and your own code guarantees ABI compatibility.
</Tip>

### 2. Missing or Incorrect Source Files

**Problem:**
Build failures due to missing header files (`gtest/gtest.h`), source files, or compiled libraries.

**Why it Happens:**
Your build system may not be correctly locating GoogleTest/GoogleMock headers or library files, or the build scripts may omit required source files.

**How to Fix:**
- Verify include paths: your compiler must be able to find the GoogleTest header files.
- Check that the GoogleTest sources or prebuilt libraries are added to your build targets.
- With CMake, add `gtest` or `gtest_main` as targets to link against.
- For Bazel, ensure `@com_google_googletest` repository is correctly fetched and declared.

<Check>
Always double-check your `<INCLUDE_DIRECTORIES>` and `<LINK_LIBRARIES>` in build config.
</Check>

### 3. Build Toolchain Misconfiguration

**Problem:**
Errors related to flags, linkers, or platform-specific settings.

**Why it Happens:**
GoogleTest and GoogleMock require certain compiler flags and link options, especially when handling exceptions, RTTI, and threading.

**How to Fix:**
- Make sure the compilation flags in your environment are consistent and compatible with GoogleTest requirements (e.g., `-pthread` on Linux).
- Confirm exception handling and RTTI settings align between your build and GoogleTest.
- With CMake, use official CMake support such as `FetchContent` or `find_package(GTest)` which abstracts configuration details.
- In Bazel, rely on official rules to configure linking and ensure toolchain settings are applied.

<Warning>
Mismatched compiler flags or missing platform-specific flags are a major source of integration errors.
</Warning>

### 4. Mixing GoogleMock and GoogleTest Incorrectly

**Problem:**
Linker errors when linking `gmock` and `gtest` components.

**Why it Happens:**
GoogleMock depends on GoogleTest, so the order and completeness of libraries during linking matter.

**How to Fix:**
- Link both `gmock` and `gtest` libraries correctly.
- If you only need basic testing support, linking just `gtest` and `gtest_main` may suffice.
- With CMake, link to `gmock_main` or `gmock` and `gtest` targets as appropriate.
- Avoid conflicts or duplication in linking libraries.


---

## CMake-Specific Troubleshooting

### Proper Integration

Use CMake’s recommended methods to add GoogleTest/GoogleMock:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.12.1.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests my_tests.cpp)
target_link_libraries(my_tests gtest_main)
```

This approach ensures:
- Correct include directories
- Proper linking of compiled libraries
- Compatible compiler flags for GoogleTest

### Common Issues

- If you encounter linker errors for GoogleTest symbols, check that `target_link_libraries()` includes `gtest` or `gtest_main`.
- Ensure your CMake minimum version supports FetchContent (3.11+).

<Note>
Do not manually copy source files or compile GoogleTest separately if you’re using FetchContent or `find_package`.
</Note>

---

## Bazel-Specific Troubleshooting

### Workspace Setup

Make sure your `WORKSPACE` file includes:

```starlark
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.12.1.tar.gz"],
    strip_prefix = "googletest-release-1.12.1",
)
```

Your `BUILD` files should properly declare dependencies on `@com_google_googletest//:gtest` and `@com_google_googletest//:gmock` as needed.

### Typical Pitfalls

- Forgetting to add GoogleTest or GoogleMock to `deps` in `cc_test` declarations.
- Mismatching bazel versions or incompatible flags.

<Tip>
Follow the official GoogleTest Bazel build examples to ensure attributes and dependencies are correct.
</Tip>

---

## Troubleshooting for Custom or Complex Build Setups

If your build system or integration is custom, or if you manually compile and link:

- Confirm that all required GoogleTest source files (`gtest-all.cc`, `gtest_main.cc` for example) are compiled and linked.
- Avoid mixing precompiled binaries with source builds unless you clearly understand compatibility.
- Inspect compiler and linker command lines for inconsistencies or missing flags.
- Ensure macOS SIP or Windows Defender policies are not blocking file access.

---

## Practical Tips to Succeed

- Always build GoogleTest/GoogleMock from source with your exact compiler.
- Use the recommended build integration systems (CMake or Bazel) wherever possible.
- Keep your compiler toolchain updated and consistent.
- Study the error messages carefully; GoogleTest errors often hint at missing or misordered libraries.
- When in doubt, start with minimal examples and incrementally add complexity.

---

## Related Documentation

- [GoogleTest Primer](primer.md) — Introduction to writing tests with GoogleTest.
- [Integration & Build Systems Guide](guides/beyond-basics/integration-build-systems.mdx) — For deeper integration details.
- [Troubleshooting Common Setup Issues](getting-started/first-test-experience/troubleshooting-common-issues.mdx) — Quick fixes for common errors.
- [GoogleTest FAQ](faq.md) — Broader questions including test naming and assertion usage.

---

By understanding these common build and integration challenges and following the guidance tailored for CMake, Bazel, or custom setups, you will achieve a smooth and reliable testing setup with GoogleTest and GoogleMock.