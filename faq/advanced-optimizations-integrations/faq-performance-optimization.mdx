---
title: "Performance Optimization Tips"
description: "Practical strategies to reduce test execution time and improve test performance, including test filtering, parallel execution, and avoiding slow anti-patterns."
---

# Performance Optimization Tips

Practical strategies to reduce test execution time and improve test performance, including test filtering, parallel execution, and avoiding slow anti-patterns.

---

## 1. Introduction

Optimizing your test runs is essential to maintain rapid feedback cycles and efficient development workflows. This page focuses specifically on practical methods to decrease the time GoogleTest takes to execute your tests without sacrificing correctness or reliability.

By applying these strategies, you can significantly improve test throughput, enabling faster iteration and more robust continuous integration.

---

## 2. Test Filtering

To reduce execution time, consider limiting which tests are run during development or CI sessions.

### How to Use Test Filtering

- Use the `--gtest_filter` flag to run only a subset of tests matching specific patterns.

Example:
```bash
./your_test_binary --gtest_filter=MyTestSuite.*
```
This runs all tests in `MyTestSuite`.

- Combine positive and negative filters to fine-tune test selection:

```bash
./your_test_binary --gtest_filter=FooTest.*-FooTest.Bar
```
Runs all tests in `FooTest` except `FooTest.Bar`.

### Benefits

- Saves time by focusing on relevant tests during iteration.
- Minimizes risk of irrelevant failures distracting your debugging.

### Best Practices

- Use meaningful test suite and test names to enable effective filtering.
- For large projects, create filters for common development tasks.

---

## 3. Parallel Test Execution

GoogleTest supports running tests in parallel to utilize available CPU cores effectively.

### How to Enable

- Use external test runners or CI systems that support parallel execution.
- When using Bazel or similar build systems, configure test sharding with the following environment variables:
  - `GTEST_TOTAL_SHARDS`: total number of shards (parallel chunks).
  - `GTEST_SHARD_INDEX`: index of the current shard.

Example:
```bash
export GTEST_TOTAL_SHARDS=4
export GTEST_SHARD_INDEX=0
./your_test_binary # shard 0
export GTEST_SHARD_INDEX=1
./your_test_binary # shard 1
# Repeat for other shards
```

### How It Works

- GoogleTest distributes tests evenly across shards, running subsets concurrently.
- This reduces wall time and improves resource utilization.

### Tips for Parallel Execution

- Tests must be isolated and independent to avoid flaky results.
- Avoid global or static state that mutations could cause race conditions.
- Use test fixtures wisely to share setup costs but keep tests safe.

---

## 4. Avoiding Slow Anti-Patterns

Some test patterns inherently slow down test execution. Identifying and modifying these can have major performance benefits.

### Common Slow Patterns

- **Large Fixture Setups:** Expensive setup/teardown in each test
  - Prefer shared resource set up via `SetUpTestSuite()` where feasible.
- **Excessive Use of EXPECT_CALL Without Need:** Overly strict expectations slow mocks.
  - Use `ON_CALL` for default behaviors and `EXPECT_CALL` sparingly for necessary checks.
- **Unnecessary Serial Ordering:** Overuse of sequences or ordering constraints forcing serial execution
  - Order expectations only when necessary; allow flexible call order to leverage parallelism.
- **Heavy Use of Global or Static Variables:** Leads to tests interfering and requiring serialization
  - Prefer test-local or fixture-local state.

### Practical Tips

- Profile your slowest tests to identify bottlenecks.
- Use `--gtest_repeat` to isolate flaky or slow tests by rerunning them repeatedly.
- Measure time per test in XML or JSON reports to get precise durations.

---

## 5. Test Suite Design Recommendations

Good test design also contributes significantly to performance.

- Write **small, focused tests** to minimize runtime.
- Group tests logically to enable selective filtering.
- Use **parameterized tests** to avoid duplication and speed up related scenarios.

---

## 6. Summary and Next Steps

By applying filtering, parallelism, and avoiding performance anti-patterns, you can optimize your GoogleTest test runs to be both faster and more reliable.

Refine your test suite iteratively by profiling and addressing hotspots.

For deeper mastery, consult:

- [GoogleTest Primer](primer.md) for basic testing concepts
- [Advanced Topics](advanced.md) for setup and tear down optimizations
- [FAQ: Performance Optimization](faq-performance-optimization.md) for targeted troubleshooting

---

## 7. Troubleshooting Common Performance Issues

### Tests Seem to Run Longer Than Expected

- Check for expensive global setup steps.
- Use filtering to confirm if specific tests slow down runs.

### Parallel Tests Interfering or Flaky

- Verify no shared mutable state.
- Look for static/global counters or singletons.

### Unexpected Serialization of Tests

- Avoid strict sequences unless necessary.
- Consider removing or simplifying test dependencies.

### Mock Objects Causing Slowdowns

- Use `NiceMock` to silence unnecessary warnings.
- Use `ON_CALL` for common mock behaviors rather than `EXPECT_CALL` unless verification is needed.

---

## 8. References

- [GoogleTest Primer](primer.md)
- [Advanced GoogleTest Topics](advanced.md)
- [GoogleMock Basics & Cookbook](gmock_cook_book.md, gmock_for_dummies.md)
- [FAQ: Performance Optimization](faq-performance-optimization.md)
- [GoogleTest Command Line Flags](advanced.md#running-test-programs-advanced-options)

---

## 9. Related Pages

- [Test Filtering and Execution Flags](advanced.md#selecting-tests)
- [Parallel and Sharded Tests](advanced.md#distributing-test-functions-to-multiple-machines)
- [Writing Efficient Mock Expectations](gmock_cook_book.md#UseOnCall)
- [Configuring Mock Strictness and Verbosity](api-reference/advanced-mocking-features/behavior-strictness.md)

---

**Unlock efficient test cycles with these targeted performance tips for GoogleTest.**