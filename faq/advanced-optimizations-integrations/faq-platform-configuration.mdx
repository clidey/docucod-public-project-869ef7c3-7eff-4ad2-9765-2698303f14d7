---
title: "Platform & Build Configuration Questions"
description: "Answers to recurring questions about supported platforms, build systems (CMake, Bazel), required flags, and compiler compatibility. Includes guidance on managing dependencies and resolving build integration problems."
---

# Platform & Build Configuration Questions

This page addresses common questions about supported platforms, build systems (CMake, Bazel), compiler compatibility, required compiler and linker flags, and how to manage dependencies and resolve build integration challenges when working with GoogleTest and GoogleMock.

---

## Supported Platforms

GoogleTest and GoogleMock support a broad set of operating systems and compilers compliant with C++17 or later. Supported platforms include:

- **Operating Systems:** Linux, Windows (Desktop, MinGW), macOS, FreeBSD, AIX, Solaris, and embedded platforms with some restrictions.
- **Compilers:** GCC (7.0+ recommended), Clang, MSVC (Visual Studio 2017 and later), IntelLLVM, SunPro, and others with partial support.

GoogleTest detects platform features automatically but can be overridden with specific macros when necessary. For example, pthread support detection can be forced.

> Note: GoogleTest requires C++17 or newer. Ensure your build environment supports this standard.


## Building with CMake

CMake is the recommended build system for GoogleTest and GoogleMock. It provides a flexible way to build standalone or integrate into existing C++ projects.

### Common Workflows

- **Standalone build:** Clone repository, create a build directory, and run `cmake ..` to generate native build files.
  - Use `-DBUILD_GMOCK=OFF` to build only GoogleTest without GoogleMock.
  - Run `make` (or equivalent) to build.

- **Integration in existing projects:**
  - Use `find_package(GTest CONFIG REQUIRED)` and link libraries like `GTest::gtest`, `GTest::gmock`.
  - Alternatively, add GoogleTest source with `add_subdirectory()` for consistent compiler flags.
  - Use `FetchContent` for downloading GoogleTest during CMake configure step.

### Important CMake Flags and Options

- `gtest_force_shared_crt`: Controls whether GoogleTest links against the dynamic or static Microsoft C runtime on Windows, preventing runtime mismatches.
- `BUILD_SHARED_LIBS`: If ON, GoogleTest compiles as shared libraries. Compiler flags `-DGTEST_CREATE_SHARED_LIBRARY=1` for the library and `-DGTEST_LINKED_AS_SHARED_LIBRARY=1` for test executables are automatically handled.

### Compiler and Linker Flags

- GoogleTest applies strict warning settings for robustness but adapts to platform defaults.
- Compiler flags enable C++17 standard compliance using `target_compile_features(... PUBLIC cxx_std_17)`.
- PThread support detection defines `-DGTEST_HAS_PTHREAD=1` or `0` and links `Threads::Threads`.

### Troubleshooting Common Build Issues

- Link errors related to pthreads require explicitly linking with pthread (`-lpthread`) if not using CMake.
- On Windows, resolve runtime mismatch errors by setting `gtest_force_shared_crt` to ON to align DLL CRT linkage.
- When building as shared libraries, use appropriate compile and link definitions to avoid symbol visibility issues.

---

## Building with Bazel

Bazel users should declare GoogleTest as a dependency in their `MODULE.bazel` or `WORKSPACE` files.

Key steps:

- Add GoogleTest dependency via Bazel's go rules or by direct GitHub repository reference.
- Create Bazel `BUILD` files with test sources and link against `@com_google_googletest//:gtest_main` or `gmock_main` libraries.
- Bazel handles platform-specific configurations internally, but users should ensure the toolchain supports C++17.

Refer to Bazel-specific installation documentation for detailed examples and troubleshooting.

---

## Key Compiler Macros and Configuration

GoogleTest exposes macros to tweak behavior and platform detection. Users may define some macros to fix build or compatibility issues.

### Important Macros

- `GTEST_HAS_PTHREAD`: Define as 1 or 0 to force pthread support detection.
- `GTEST_CREATE_SHARED_LIBRARY` and `GTEST_LINKED_AS_SHARED_LIBRARY`: Control shared library build and usage.
- `GTEST_HAS_EXCEPTIONS`: Whether compiler exceptions are enabled.
- `GTEST_HAS_RTTI`: Enables Run-Time Type Information checks.

### Example Usage

To force pthread detection and build GoogleTest as a shared library:

```bash
cmake .. -DGTEST_HAS_PTHREAD=1 -DGTEST_CREATE_SHARED_LIBRARY=1 -DBUILD_SHARED_LIBS=ON
```

### Platform-Specific Notes

- On Windows, MinGW has limited pthread support; native Windows threading is used instead.
- Embedded platforms may require disabling features like stream redirection or death tests.

---

## Managing Dependencies

If using GoogleTest and GoogleMock together, it is recommended to:

- Link to `gmock_main` or `gtest_main` libraries to provide standard test entry points.
- Ensure all dependencies (e.g., threading libraries) are specified in your build scripts.
- For CMake users, use the provided targets like `GTest::gmock`, `GTest::gmock_main` to simplify linking and dependency handling.

---

## FAQs for Build Integration

<AccordionGroup title="Build System Questions">
<Accordion title="Why am I getting pthread linker errors?">
If your build system does not automatically link the pthread library, you must add it explicitly (e.g., using `-lpthread`) to the linker flags. With CMake, the script sets this up automatically.
</Accordion>
<Accordion title="How do I change GoogleTest's default C++ standard?">
GoogleTest requires C++17. You should specify this in your build system (e.g., `set(CMAKE_CXX_STANDARD 17)` in CMake). GoogleTest's targets ensure `-std=c++17` or equivalent is used.
</Accordion>
<Accordion title="Can I build GoogleTest as a shared library on Windows?">
Yes, but you must define `GTEST_CREATE_SHARED_LIBRARY=1` when building the library, and `GTEST_LINKED_AS_SHARED_LIBRARY=1` when compiling tests that link to it. Also, ensure runtime library settings (`MT` vs. `MD`) are consistent.
</Accordion>
<Accordion title="What if I encounter macro name conflicts?">
GoogleTest allows disabling some macro definitions by defining `DGTEST_DONT_DEFINE_<MACRO>=1` in your compiler flags, e.g., `-DGTEST_DONT_DEFINE_TEST=1` to avoid conflicts with other frameworks.
</Accordion>
</AccordionGroup>

---

## Best Practices

- Use CMake integration where possible to handle dependencies, platform details, and flags transparently.
- Regularly update your compiler and build tools to meet GoogleTest's minimum requirements.
- Use the recommended `gtest_main` or `gmock_main` libraries to avoid writing custom main functions unless necessary.
- Review platform macros if you run into unexpected runtime or linking behavior.

---

## Resources and References

- [GoogleTest README and Build Instructions](https://github.com/google/googletest/blob/main/README.md)
- [Supported Platforms Table](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md)
- [GoogleTest CMake Build Documentation](https://github.com/google/googletest/blob/main/googletest/README.md#build-with-cmake)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [CMake Functions and Macros for GoogleTest](https://github.com/google/googletest/blob/main/googletest/cmake/internal_utils.cmake)
- [FAQ: Build Configuration and Platform Issues](https://github.com/google/googletest/tree/main/faq)


For advanced troubleshooting and configuration, consult the `gtest-port.h` and `gmock-port.h` headers where platform-specific macros and features are documented in detail.

---

This page aims to ease your journey in integrating GoogleTest and GoogleMock into your platform and build environment, addressing recurring questions related to platform compatibility, compiler flags, and build system integration to get your tests running smoothly.