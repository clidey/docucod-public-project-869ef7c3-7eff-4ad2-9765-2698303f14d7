---
title: "What are GoogleTest and GoogleMock?"
description: "Provides an overview of GoogleTest and GoogleMock, explaining their purposes, the value they provide for C++ testing, and how they can be used together or separately. Clarifies how these frameworks streamline the unit testing process and enable robust, maintainable code."
---

# FAQ: What are GoogleTest and GoogleMock?

GoogleTest and GoogleMock are powerful frameworks designed to support reliable and maintainable unit testing in C++. This FAQ focuses on introducing both frameworks, explaining their purpose, how they integrate, and the benefits they bring to your C++ test suites. Whether used together or separately, they streamline creating thorough unit tests and quick feedback cycles.

---

## 1. What are GoogleTest and GoogleMock?

- **GoogleTest** (often referred to as gTest) is a C++ testing framework enabling developers to write, organize, and run tests with rich assertions and a structured test lifecycle.
- **GoogleMock** (often called gMock) is a powerful extension to GoogleTest that provides support for creating mock classes and methods, allowing you to simulate and verify interactions between components.

Together, they empower developers to write both state-based and interaction-based tests efficiently.

## 2. How do GoogleTest and GoogleMock relate?

GoogleMock is built on top of GoogleTest: it depends on gTest for test discovery, execution, and reporting. However, they can be used independently:

- Use **GoogleTest alone** when focusing purely on assertion-based testing.
- Add **GoogleMock** when your tests need to verify complex interactions, particularly for dependencies that need to be mocked.

## 3. What are the primary benefits of using GoogleTest and GoogleMock?

- **Automated Test Management**: Tests are automatically discovered and executed without cumbersome registration.
- **Rich Assertions and Matchers**: GoogleTest provides various assertion types; GoogleMock adds expressive matchers for argument verification.
- **Mocking and Verification**: GoogleMock offers macros and constructs to define mock classes and set precise expectations on method calls.
- **Flexible Test Flow Control**: Control how tests handle failures, order mock calls strictly or partially, and configure mock behaviors thoroughly.
- **Cross-Platform Support**: Both frameworks support major platforms and compilers, ensuring portability.

## 4. How do I create mock objects with GoogleMock?

### Defining Mock Classes

- Mock classes derive from interfaces or classes to be mocked.
- Use `MOCK_METHOD` macros to declare mock methods inside a `public:` section.
- Example:

```cpp
#include <gmock/gmock.h>

class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual int GetX() const = 0;
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

### Best Practices

- Always place `MOCK_METHOD` declarations in the `public` section, regardless of the original method’s access.
- Wrap complex argument types containing commas with parentheses or use type aliases.
- Use `override` and `const` qualifiers to match the original method signatures.

## 5. How to set expectations and behaviours?

### Expectation Syntax

Use the `EXPECT_CALL` macro to specify expected calls and their parameters:

```cpp
using ::testing::_;
using ::testing::Return;

MockTurtle turtle;
EXPECT_CALL(turtle, PenDown())
    .Times(1);
EXPECT_CALL(turtle, GetX())
    .WillOnce(Return(10));
```

### Default Behavior

- Methods return default values unless configured otherwise.
- You can define default behaviors without setting expectations using `ON_CALL`:

```cpp
ON_CALL(turtle, GetX()).WillByDefault(Return(0));
```

### Actions

- Specify what a mock method should do using clauses like `.WillOnce()` and `.WillRepeatedly()`, e.g., `Return()`, `Invoke()`, or custom lambdas.
- Chain multiple behaviors or call sequences for sophisticated testing of stateful methods.

## 6. What are matchers, and how do I use them?

Matchers express conditions on arguments methods are expected to receive:

- `_` matches any argument.
- Predefined matchers like `Eq()`, `Gt()`, `NotNull()`, `Contains()`, etc., provide powerful expressive capabilities.
- Combine matchers with logical operators (e.g., `AllOf`, `AnyOf`) for complex argument validation.

Example:

```cpp
EXPECT_CALL(turtle, GoTo(50, _));  // Called with x=50, any y
EXPECT_CALL(turtle, GetX()).WillOnce(Return(10));
```

## 7. What are the different types of mock strictness?

- **NaggyMock** (default behavior): Warns about uninteresting calls (calls not expected explicitly).
- **NiceMock**: Suppresses warnings for uninteresting calls.
- **StrictMock**: Treats uninteresting calls as failures.

Choosing the right strictness helps balance feedback and test fragility.

## 8. How do I control call ordering in mocks?

GoogleMock lets you enforce:

- **No ordering** (default): calls may occur in any order.
- **Strict ordering** with `InSequence` blocks:

```cpp
using ::testing::InSequence;
{
  InSequence seq;
  EXPECT_CALL(mock, Foo());
  EXPECT_CALL(mock, Bar());
}
```

- **Partial ordering** using `After()` clauses or `Sequence` objects for flexible call ordering graphs.

## 9. How do I handle move-only types in mocks?

GoogleMock supports mocking methods that accept or return move-only types such as `std::unique_ptr`.

Example:

```cpp
MOCK_METHOD(std::unique_ptr<Foo>, CreateFoo, (int), (override));
```

Use lambdas inside `WillOnce()` or `WillRepeatedly()` to create new instances on demand.

## 10. What should I do when I get warnings about uninteresting calls?

These warnings mean a mock method is called without an `EXPECT_CALL` set for that method, hinting at possible missing expectations.

- If calls are legitimate, use `NiceMock` or add a catch-all expectation like `EXPECT_CALL(mock, Method(_)).Times(AnyNumber());`.
- To debug unexpected calls, enable verbose logging by running tests with `--gmock_verbose=info` to trace calls and expectations.

## 11. Can GoogleMock mock free functions or static methods?

You cannot mock free functions directly. Instead, use interfaces with virtual methods.

If performance is a concern, consider mocking non-virtual methods using the high-performance dependency injection pattern by templating your code.

## 12. How do I speed up compilation of large mock classes?

Define the constructor and destructor of mock classes out-of-line (in a `.cc` file) to reduce compile-time overhead across multiple translation units.

Example:

```cpp
// In mock_foo.h
class MockFoo : public Foo {
 public:
  MockFoo();
  ~MockFoo() override;
  MOCK_METHOD(...);
};

// In mock_foo.cc
MockFoo::MockFoo() {}
MockFoo::~MockFoo() {}
```

## 13. How do I verify or reset mocks manually?

- Use `Mock::VerifyAndClearExpectations(&mock);` to verify that expectations were met and clear them.
- Use `Mock::VerifyAndClear(&mock);` to verify and clear both expectations and default actions.
- If needed to allow a mock to be leaked without verification, use `Mock::AllowLeak(&mock);`.

## 14. Where can I get more help and detailed examples?

- **[gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)** — An easy introduction with examples and concepts.
- **[gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)** — Detailed recipes on mocking usage.
- **[Mocking Reference](reference/mocking.md)** — Complete API documentation for mocks.
- **[Matchers Reference](reference/matchers.md)** — Extensive list and explanation of matchers.

---

## Additional Tips & Resources

- Always set expectations (`EXPECT_CALL`) before invoking mock methods to avoid undefined behavior.
- Use sequences and cardinalities to fine-tune call order and number expectations.
- Use `ON_CALL` for specifying default mock behavior without specifying an expectation for call count.
- Use the verbosity flag `--gmock_verbose=info` to debug why expectations fail or unexpected calls occur.

---

For further learning, please consult the [GoogleTest core concepts](https://google.github.io/googletest/primer.html), [Writing Your First Test](getting_started/first_test_and_validation/create_first_test), and [Integration with Build Systems](overview/integration-feature-overview/integration-build-systems) guides.


---

### References & Related Documentation

- [GoogleTest Primer](overview/intro-value-prop/what-is-googletest)
- [Writing and Structuring Tests](guides/writing-and-structuring-tests/assertions-and-matchers)
- [Basic Mocking Tutorial](guides/getting-started/basic-mocking)
- [Advanced Mocking Patterns](guides/writing-and-structuring-tests/advanced-mocking-patterns)
- [Mock Objects and Methods API](api-reference/mocking-actions-matchers/mock-objects-and-methods)
- [Test Structure & Lifecycle](api-reference/core-testing-api/test-structure)
- [Main Entrypoint & Initialization](api-reference/configuration-and-runtime/main-entrypoint)

---

### Practical Example: Mocking a Turtle

```cpp
#include <gmock/gmock.h>

class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
  virtual int GetX() const = 0;
};

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};


// Usage in a test
using ::testing::AtLeast;
using ::testing::Return;
using ::testing::_;

TEST(PainterTest, DrawsCircle) {
  MockTurtle turtle;

  EXPECT_CALL(turtle, PenDown())
      .Times(AtLeast(1));

  EXPECT_CALL(turtle, Forward(_))
      .Times(AtLeast(1));

  EXPECT_CALL(turtle, GetX())
      .WillOnce(Return(10));

  // Code under test uses turtle
  ...
}
```

---

<Tip>
Always match mock methods and their expectations carefully. Match argument types, constness, and qualifiers exactly.
</Tip>
<Note>
Setting expectations with `EXPECT_CALL` should be done before exercising the code under test.
</Note>
<Warning>
Do not mock private methods directly. Place mocks in public sections even for private/protected base methods.
</Warning>

