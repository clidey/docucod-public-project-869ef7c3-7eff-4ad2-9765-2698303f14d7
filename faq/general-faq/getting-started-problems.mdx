---
title: "Getting Started Issues"
description: "Addresses common challenges encountered during initial setup and configuration of GoogleTest/GoogleMock. Includes help for missing includes, linking problems, and mistakes in writing the first test cases. Guides users to key resources for onboarding."
---

# Getting Started Issues

This page addresses common challenges encountered during the initial setup and configuration of GoogleTest and GoogleMock. If you are encountering issues such as missing include files, linking errors, or mistakes when writing your first test cases, this FAQ will help you identify and solve these problems quickly.

---

## Frequently Asked Questions

### Why do I get errors about missing include files like `<gtest/gtest.h>` or `<gmock/gmock.h>`?

GoogleTest and GoogleMock headers are not found because your build system is not properly configured to locate them. Ensure that:

- You have installed GoogleTest/GoogleMock or included the source in your project.
- Your compiler's include path includes the directory containing these headers.
- For CMake, consider using `find_package(GTest)` or adding GoogleTest as a subdirectory.

For example, with CMake:

```cmake
find_package(GTest REQUIRED)
target_link_libraries(your_test_target GTest::gtest GTest::gtest_main GTest::gmock)
```

### What causes linker errors when building tests with GoogleTest/GoogleMock?

Usually, linker errors happen because:

- The GoogleTest and GoogleMock libraries were not linked to your test executable.
- You might have inconsistencies between build configurations (release vs debug).
- Your platform requires additional dependencies (e.g., pthread on Linux).

**How to fix:**

- Link against `gtest`, `gtest_main`, and `gmock` libraries.
- On [1mLinux and Mac[0m, add `pthread` to your linker flags if necessary:

  ```bash
  -pthread
  ```

- For CMake, add:

  ```cmake
target_link_libraries(your_test_target gtest gmock pthread)
  ```

### My first test does not compile. What common mistakes should I check?

- Make sure you included the proper header:

  ```cpp
  #include <gtest/gtest.h>
  #include <gmock/gmock.h>  // If using mocks
  ```

- When writing a simple test, use the `TEST` macro with valid C++ identifiers for test suite and test name:

  ```cpp
  TEST(FactorialTest, HandlesZeroInput) {
    EXPECT_EQ(Factorial(0), 1);
  }
  ```

- Avoid underscores in test suite and test names.
- If you are using a test fixture, define it correctly by inheriting `::testing::Test` and use `TEST_F`.

### How do I correctly use the `MOCK_METHOD` macro in my mock class?

- Place `MOCK_METHOD` declarations within the `public:` section of your mock class, even if the base class method is protected or private.
- Specify the method's return type, name, and argument list inside the macro.
- For const or override qualifiers, add them as an optional fourth argument in parentheses.

Example:

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
  MOCK_METHOD(void, SetValue, (int val), (override));
};
```

- If argument types include commas (e.g., `std::pair<int, int>`), wrap them in parentheses or use a type alias:

```cpp
using PairInt = std::pair<int, int>;
MOCK_METHOD(PairInt, GetPair, (), (override));
```

### I wrote `EXPECT_CALL(mock, Func(args))` but the expectations are not verified. Whatâ€™s wrong?

- Expectations must be set *before* the mock method is called.
- GoogleMock verifies expectations either when the mock object is destroyed or when explicitly requested.
- If the mock object isn't destroyed (for example, if allocated with `new` and never deleted), the verification won't happen.

**Fix:**

- Destroy mocks properly.
- Or explicitly call `::testing::Mock::VerifyAndClearExpectations(&mock)`.

### What are `NiceMock`, `NaggyMock`, and `StrictMock` and when should I choose them?

- `NaggyMock`: The default behavior. Prints warnings on uninteresting calls (calls with no expectations).
- `NiceMock`: Suppresses warnings on uninteresting calls â€“ use when you want to reduce noise.
- `StrictMock`: Treats uninteresting calls as failures â€“ enforces stricter testing.

Choose based on your test's strictness requirements:

- Use `NiceMock` during development or when you don't want to be flooded with warnings.
- Use `StrictMock` when you want to ensure only expected calls occur.

Example:

```cpp
NiceMock<MockFoo> nice_mock;
StrictMock<MockFoo> strict_mock;
```

### What should I do if I encounter link errors about missing pthread symbols?

On Linux and other POSIX systems, GoogleTest uses pthreads. Ensure your link command includes `-pthread`. 

In your build system:

- For CMake, make sure to link pthread explicitly if not provided automatically:

  ```cmake
  find_package(Threads REQUIRED)
target_link_libraries(your_test_target Threads::Threads)
  ```

- Or add `-pthread` to both compilation and linking flags.

### I get error messages about mismatched runtime libraries on Windows Visual Studio. How do I fix it?

This occurs when GoogleTest or GoogleMock is compiled with static runtime linking but your project uses dynamic runtimes (or vice versa).

**Solution:**

- Set CMake option `gtest_force_shared_crt` to `ON` to enforce dynamic linkage of the C runtime in GoogleTest:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

- Rebuild GoogleTest after setting this option.

### How can I verify that my first test ran successfully?

- Run your test executable.
- GoogleTest reports results with `PASSED` or `FAILED` lines.
- The program returns 0 on success.

Example:

```shell
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[  PASSED  ] 1 test.
```

### How do I get started with GoogleMock behavior definitions such as `EXPECT_CALL` or `ON_CALL`?

- Use `EXPECT_CALL` to set expectations that certain mock methods *will be called*.
- Use `ON_CALL` to set default behaviors without expectations.
- Specify argument matchers if you want to control which calls match.

Example:

```cpp
EXPECT_CALL(mock_foo, GetValue(42)).WillOnce(Return(1));
ON_CALL(mock_foo, GetValue(_)).WillByDefault(Return(0));
```

For more details, see the [Mocking Reference](../reference/mocking.md) and [gMock for Dummies](../gmock_for_dummies.md).

---

## Common Issues & Solutions

### Missing Includes
- **Issue:** `<gtest/gtest.h>` or `<gmock/gmock.h>` not found.
- **Cause:** Incorrect include paths or missing installation.
- **Solution:** Verify include paths, ensure dependencies installed, use `find_package` or add GoogleTest as a submodule/subdirectory.

### Linking Failures
- **Issue:** Undefined references to GoogleTest or pthread symbols.
- **Cause:** GoogleTest or pthread libraries not linked.
- **Solution:** Link `gtest`, `gmock`, and `pthread`. Adjust build configurations accordingly.

### Incorrect Use of `MOCK_METHOD`
- **Issue:** Compilation fails on `MOCK_METHOD` usage.
- **Cause:** Commas inside types without parentheses or aliasing, missing qualifiers.
- **Solution:** Wrap complicated types in parentheses or define using aliases. Put mock methods in `public:`.

### Expectations Not Verified
- **Issue:** Tests pass despite broken expectations.
- **Cause:** Mock object lifetime issues or expectations set after calls.
- **Solution:** Set expectations before calls, ensure mock objects are destroyed or manually verify.

### Multi-threading Concerns
- **Issue:** Race conditions or test instability.
- **Cause:** Setting expectations or destroying mocks concurrently.
- **Solution:** Follow single-threaded test logic; gMock is thread-safe only if expected.

---

## Key Resource Links for Onboarding

- [GoogleTest Primer](../primer.md) â€“ Learn to write simple tests and understand core concepts.
- [Writing Your First Test](../getting-started/first-steps-validation/write-your-first-test.md) â€“ Step-by-step guide to initial tests.
- [Mocking Reference](../reference/mocking.md) â€“ Full details on mock class creation and expectations.
- [gMock for Dummies](../gmock_for_dummies.md) â€“ Beginner-friendly tutorial about mocks and expectations.
- [Troubleshooting Common Setup Issues](../getting-started/first-steps-validation/troubleshooting-common-issues.md) â€“ Solve typical installation and build problems.

---

## Tips for Success

- Always call `testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS()` in your `main()`.
- Use `TEST()` for simple tests; use `TEST_F()` when working with test fixtures.
- Define mock methods with `MOCK_METHOD` in `public:` even if base methods are protected/private.
- Set expectations before exercising the code under test.
- Link properly against GoogleTest and GoogleMock libraries and dependencies.
- For complicated argument types in mocks, use parentheses or type aliases.

<Tip>
If you find many uninteresting call warnings during test runs, consider wrapping your mocks in `NiceMock` to reduce noise.
</Tip>

<Warning>
Setting expectations after calling the mock functions causes undefined behavior. Always set `EXPECT_CALL` statements before exercising your mocks.
</Warning>

<Note>
If building with CMake and encountering VS runtime mismatch errors, ensure you use the `-Dgtest_force_shared_crt=ON` flag.
</Note>