---
title: "How can I speed up my test suite?"
description: "Introduces strategies for running tests faster, leveraging parallel test execution, and reducing test overhead. Highlights available tools, flags, and best practices for performance-oriented users."
---

# How can I speed up my test suite?

Running tests efficiently is crucial to maintaining fast development cycles and quick feedback loops. This page introduces practical strategies to accelerate your test suite, focusing on parallel execution, reducing test overhead, and leveraging available tools and flags for optimal performance.

---

## Frequently Asked Questions

### What strategies can I apply to run tests faster?

- **Leverage Parallel Test Execution**: Run tests in parallel across multiple CPU cores or machines to reduce wall-clock time.
- **Minimize Test Setup and Teardown**: Share fixtures carefully, use lightweight mocks, and avoid costly resource initialization where possible.
- **Use Selective Test Runs**: Run only affected tests or use test filters to skip irrelevant tests.
- **Optimize Mock Usage**: Use GoogleMock's facilities like NiceMock and NaggyMock to control verbosity and overhead.

### How does parallel test execution work with GoogleTest or GoogleMock?

GoogleTest supports running tests in parallel by launching multiple test processes concurrently. This divides the test workload and utilizes hardware more efficiently. You can enable parallel execution using test runners or build system support.

### Are there flags or tools to help with test speed?

Yes. GoogleTest and GoogleMock provide various flags to control verbosity, test filtering, and concurrency. For example:

- `--gtest_filter` to select specific tests to run.
- `--gtest_repeat` to run tests multiple times for stability checks.
- Build system integrations like Bazel or CMake often provide parallel build and test execution.

### What are best practices for writing fast tests?

- Avoid interacting with external resources unless absolutely necessary.
- Use mocks to simulate dependencies, reducing I/O and computation overhead.
- Keep each test focused and minimize shared state to prevent cross-test dependencies.
- Use GoogleMock features sparingly to reduce mock setup times.
- Regularly profile your test suite to detect slow tests and bottlenecks.

### How can I reduce mocking overhead?

- Define mock methods only for needed interactions.
- Use `NiceMock` to suppress warnings on uninteresting calls instead of verbose mocks.
- Avoid over-specifying expectations (`EXPECT_CALL`) that cause additional runtime checks.
- Pre-compile mock classes separately to reduce compilation time (see [Compiling Mocks Faster](gmock_cook_book.md#making-the-compilation-faster)).

---

## Common Issues & Gotchas

### Tests hanging or running longer than expected

- **Cause**: Tests waiting on asynchronous operations or locks.
- **Solution**: Use GoogleMock's features for testing asynchronous code deterministically, like `Notification` synchronization.

### Excessive test suite runtime due to global setup

- **Cause**: Heavy resource initialization in test fixtures.
- **Solution**: Use `SetUpTestSuite` and `TearDownTestSuite` to share expensive setup among tests.

### Slower compilation times with large mocks

- **Cause**: Mock classes with many mocked methods cause compiler overhead.
- **Solution**: Move constructor and destructor implementations out of the header into `.cc` files.

### Over-specification of mock expectations causing brittle tests

- **Cause**: Setting too many `EXPECT_CALL`s or strict call orders.
- **Solution**: Use `ON_CALL()` to define default behavior and limit `EXPECT_CALL()` usage to necessary verifications.

---

## Error Messages & Debugging

While this page focuses on performance, understanding test suite errors related to mocks or tests can help identify performance bottlenecks:

- **Uninteresting mock function call warning**: May indicate missing `EXPECT_CALL` or `ON_CALL`. Suppress with `NiceMock` or add `EXPECT_CALL(...).Times(AnyNumber())`.
- **Unexpected mock function call error**: Occurs when an unexpected function call does not match any declared expectations.
- **Excessive call warnings**: Indicates mocks called more times than expected, often slowing tests.

Use the `--gmock_verbose` flag (values: `info`, `warning`, `error`) for detailed mock call traces to diagnose mismatches impacting performance.

---

## Troubleshooting Procedures

### Step-by-step to identify slow tests:

1. **Profile Test Execution**: Use test runners that report per-test duration.
2. **Isolate Slow Tests**: Run suspect tests individually to verify runtime.
3. **Check for Expensive Fixtures or External Calls**: Review test code for costly operations.
4. **Use Mocks to Replace Expensive Dependencies**: Apply mocks judiciously to reduce runtime.
5. **Consider Parallel Execution**: If tests are independent, configure parallel test running.

### Verifying that changes reduce test suite time:

- Run the full test suite and note total runtime.
- Apply changes incrementally.
- Run only affected or slow tests with `--gtest_filter`.
- Confirm runtime improvements.

### Common pitfalls:

- Not cleaning up resources properly causing leaks or state contamination that slows tests.
- Overusing strict call sequences that cause test failures and retries.

---

## Performance & Optimization Tips

- **Use Efficient Matchers and Actions:** Complex matchers and lambda actions may introduce some overhead. Use simple matchers or pre-defined ones when possible.
- **Limit Verbosity in Tests:** Excessive logging or verbose mock behavior (`--gmock_verbose=info`) slows tests.
- **Balance Between Completeness and Speed:** Avoid over-specifying expectations that force unnecessary mock evaluations.
- **Organize Tests for Parallelism:** Group tests that can safely run concurrently.
- **Cache Expensive Data:** Reuse expensive input data or computation results within fixture lifetimes.

See [Best Practices and Test Performance Optimization](guides/advanced-usage-patterns/best-practices-optimization) for a broader coverage.

---

## Security & Access Notes

Tests rarely involve security or permissions but consider:

- **Mocking Authentication and Authorization:** Use mocks to simulate security checks to avoid setup overhead.
- **Environment Isolation:** Ensure tests run with minimal privileges and mock external dependencies that require secure credentials.

---

## Getting Help & Support

- **Official Documentation:** Review the [Mocking Reference](reference/mocking_api/mock_object_basics), [gMock Cookbook](guides/core-workflows/using-mocks), and [Legacy gMock FAQ](faq/troubleshooting/faq-death-tests).
- **Community Support:** Use GitHub issues at [GoogleTest repo](https://github.com/google/googletest), or community forums.
- **Debugging:** Utilize the `--gmock_verbose` flag and enable detailed logging during test runs.

---

## Additional Resources

- [GoogleMock Overview](googlemock/README.md) — Understanding what GoogleMock offers
- [GoogleMock for Dummies](docs/gmock_for_dummies.md) — Beginner friendly guide
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md) — Quick reference for mock macros and usage
- [Understanding Mock Behaviors (Nice, Naggy, Strict)](api_reference/mocking_api/mock_behaviors_and_strategies.mdx)

---

This page fits within the FAQ category and links closely with the guides on using mocks, advanced usage tips, and troubleshooting test failures.

## Conclusion

Efficient testing demands careful balance: apply parallelism, smart mocking, and minimal overhead practices. Use provided GoogleTest and GoogleMock tools and flags intentionally to accelerate your test suite without sacrificing test coverage or reliability.


---

# References

- [Mocking Reference](docs/reference/mocking.md)
- [gMock Cookbook](docs/gmock_cook_book.md)
- [GoogleMock FAQ](docs/gmock_faq.md)
- [GoogleMock for Dummies](docs/gmock_for_dummies.md)
- [GoogleTest Primer](docs/primer.md)
- [Best Practices and Test Performance Optimization Guide](guides/advanced-usage-patterns/best-practices-optimization)

