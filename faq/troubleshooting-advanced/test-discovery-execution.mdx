---
title: "Why are some of my tests not discovered or executed?"
description: "Explains typical causes for missing or unexecuted tests, such as naming conventions, macro misuse, or misconfigured build tools, and provides practical solutions."
---

# Why Are Some of My Tests Not Discovered or Executed?

GoogleTest’s automatic test discovery is designed to be seamless, but sometimes users find that some of their tests are not discovered or executed when running their test suites. This page explains the most typical causes of missing or unexecuted tests, focusing on practical issues like naming conventions, macro usage, and build system misconfigurations, and provides straightforward solutions to help you get all your tests recognized and running.

---

## 1. Understanding Test Discovery in GoogleTest

GoogleTest automatically discovers tests by scanning for test macros like `TEST()` and `TEST_F()` embedded in your source files. To participate in discovery and execution, tests must follow specific patterns and be correctly registered during build and linking.

Successful test discovery depends on:

- Correct **test macro usage**
- Naming tests following **GoogleTest conventions**
- Including test files in the **build system**
- Linking test binaries properly

Failing any of these leads to tests being overlooked or not run.


## 2. Common Reasons Tests Are Not Discovered or Executed

### 2.1 Test Naming and Macro Usage Issues

- **Invalid Test or Test Suite Names:** Test suite and test names must be valid C++ identifiers without underscores; for example, `TEST(MySuite, ExampleTest)` is valid, but `TEST(My_Suite, Example_Test)` can cause tests to be ignored.

- **Using Deprecated Macros:** GoogleTest recommends using `TEST_SUITE` (or the updated `TestSuite` API) instead of the legacy `TestCase`. Using deprecated macros improperly can break discovery.

- **Misuse of `TEST_F()` and Fixtures:** If a test fixture class isn’t defined or is misspelled, tests declared with `TEST_F()` won’t compile or register correctly.

- **Macros in Header Files without Inclusion:** Defining tests in header files that are not included in any build target will prevent discovery.

- **Macro Expansion Conflicts:** Sometimes other macros or preprocessor definitions can interfere with GoogleTest macros, especially on Windows (e.g., macros expanding method names). Verify that macro redefinitions don't break `EXPECT_CALL` or `TEST` macros.

**Solution:** Ensure all test suite and test names are valid identifiers without underscores, always `#include <gtest/gtest.h>` before defining your tests, and use `TEST()` or `TEST_F()` properly with well-defined fixtures.

### 2.2 Misconfigured or Missing Build System Entries

- **Missing Source Files:** The `.cc` or `.cpp` files containing tests must be listed in your build system (CMake, Bazel, etc.). Omitting these files means they are never compiled or linked.

- **Incorrect Linking:** If the object files with tests are not linked into the final test executable, tests won't register.

- **Not Linking Against `gtest_main` or Providing `main()`:** Typically, you link against `gtest_main` which provides a main() function to run all tests. If you omit this or provide your own `main()` but fail to call `RUN_ALL_TESTS()`, no tests will run.

- **Source Folder Not Included in Test Compilation:** Sometimes the test code is in a directory not recognized by the build system, so it never gets compiled.

**Solution:** Verify your build files list all your test source files and link them properly with GoogleTest libraries (`gtest` or `gtest_main`). If you write your own `main()`, ensure it calls `testing::InitGoogleTest(&argc, argv)` and `RUN_ALL_TESTS()`.

### 2.3 Incorrect or Missing Use of `RUN_ALL_TESTS()`

- Without calling `RUN_ALL_TESTS()`, GoogleTest will not execute any registered tests.

- Calling `RUN_ALL_TESTS()` multiple times is not supported and can cause unpredictable behavior.

- It is important to return the result of `RUN_ALL_TESTS()` as the exit code of your `main()` to correctly indicate success or failure.

**Solution:** Use the provided `gtest_main` library if possible to avoid writing your own `main()`. Otherwise, ensure your `main()` function follows this pattern:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```


### 2.4 Misuse of Macros or Incorrect Macro Expansion

- Using macros like `MOCK_METHOD` incorrectly in mocks that affect discovery indirectly.

- Macro redefinitions interfering with method names, especially in environments with macros from system headers.

**Solution:** Use recommended macro syntax as documented in the [Mock Object Definition](https://google.github.io/googletest/reference/mocking.html#mockobject) and ensure macros are not accidentally redefined. Consider using `#undef` if needed.

### 2.5 Running Partial or Filtered Tests Incorrectly

- Using test filtering options incorrectly may hide some tests.

- Running in a mode that suppresses output or discovery.

**Solution:** Run your tests without filters or ensure your filters include all desired tests, e.g., `--gtest_filter=*` to run everything.

### 2.6 Build or Platform Specific Issues

- Using unusual compilers or platforms where threading or linking behavior differs can impact discovery.

- Embedded platforms sometimes require platform-adapted entry points (see [Entrypoint and Initialization](https://google.github.io/googletest/api/reference/supporting-infrastructure/entrypoint-initialization)).

**Solution:** Verify platform compatibility and refer to platform integration guides.


## 3. Step-by-Step Checklist to Fix Missing Tests

<Steps>
<Step title="Verify Test Names and Macros">
Ensure your `TEST()` and `TEST_F()` macros use valid C++ identifiers for test suites and tests without underscores. Confirm that test fixtures are properly defined and spelled.
</Step>
<Step title="Confirm Test Source Files Are Compiled">
Check your build configuration to verify that all source files containing tests are included in compilation and linking.
</Step>
<Step title="Review Linking Settings">
Make sure your test executable links against GoogleTest libraries correctly, preferably `gtest_main` unless you provide a `main()`.
</Step>
<Step title="Check Your Main Function">
Verify your `main()` calls `testing::InitGoogleTest()` and `RUN_ALL_TESTS()`, and returns the latter's result.
</Step>
<Step title="Run Tests with No Filters">
Run your test binary with no filters or use `--gtest_filter=*` to ensure tests are not being filtered out.
</Step>
<Step title="Inspect Macro Conflicts">
Look for macro redefinitions or name clashes that might interfere with GoogleTest/gMock macros.
</Step>
</Steps>


## 4. Practical Tips and Best Practices

- **Use the Provided `gtest_main` or `gmock_main`:** To avoid manual errors in `main()`, link with these libraries which provide a robust main.

- **Avoid Underscores in Test and Suite Names:** GoogleTest historically does not discover tests with underscores in names; avoid underscores to be safe.

- **Define Test Fixtures Before Use:** Always define test fixtures fully before using `TEST_F` macros referencing them.

- **Keep Tests in Source Files Included in your Build:** Never place test definitions only in headers or files not built.

- **Use Verbose Output to Debug Discovery:** Running tests with `--gtest_list_tests` lists all recognized tests — verify that your tests appear here.

- **Use Logs and Warnings from GoogleTest:** When a test suite or test is silently missing, logging output or warnings can provide clues.

- **Check for Name Collisions with Macros:** Especially on Windows, system headers might define macros with common names; use `#undef` or adjust order of includes.


## 5. Troubleshooting Common Scenarios

<AccordionGroup title="Troubleshooting Common Test Discovery Issues">
<Accordion title="My tests are compiling but not showing when I run the test executable">

- Verify all test source files are linked.
- Run the test executable with `--gtest_list_tests` and check if your tests appear.
- Make sure `RUN_ALL_TESTS()` is called.
- Confirm test suite and test names comply with GoogleTest naming rules.
- Use `--gtest_filter=*` to run all tests.

</Accordion>
<Accordion title="I provided my own main() and my tests are not executing">

- Confirm calling `testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS();`.
- Confirm you return the result of `RUN_ALL_TESTS();`.
- Check for multiple calls to `RUN_ALL_TESTS()` — this is unsupported.

</Accordion>
<Accordion title="Tests in header files are not running">

- Header files must be included in a compiled source file.
- Avoid defining tests in headers unless explicitly included in multiple translation units (generally discouraged).

</Accordion>
<Accordion title="My mock expectations are set but tests are not run">

- Ensure your mock classes use macros correctly like `MOCK_METHOD`.
- Confirm that mocks and tests are compiled and linked into the same project.
- Verify the linking to gmock libraries.

</Accordion>
</AccordionGroup>


## 6. Related Issues from Build & Integration

If you are integrating GoogleTest and GoogleMock into complex build systems:

- Consult [Integrating with Build Systems & Platforms](https://google.github.io/googletest/guides/real-world-patterns/integrating-with-build-systems.html) for best practices.
- Verify that `gtest` and `gmock` libraries, as well as `gtest_main` or `gmock_main`, are properly linked.
- For embedded or unusual platforms, see special entry point documentation.


## 7. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/guides/getting-started/primer.html) — foundation of test writing and execution.
- [Test Structure and Discovery Guide](https://google.github.io/googletest/guides/getting-started/test-structure-and-discovery.html) — detailed workflows on discovery.
- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) — to understand mock definition and use.
- [Mock Object Definition Reference](https://google.github.io/googletest/reference/gmock-mocking-apis/mock-object-definition.html) — details on mocking macros.
- [Entrypoint and Initialization](https://google.github.io/googletest/api/reference/supporting-infrastructure/entrypoint-initialization.html) — platform-specific main function usage.


---

<Tip>
**Tip:** Use the `--gtest_list_tests` command line option to list all tests GoogleTest detects in your binary. If your tests do not appear there, it’s a clear sign of discovery or linking issues.
</Tip>

<Note>
**Note:** GoogleTest discovers tests at link time. Ensure your test object files are linked. Simply compiling source files without linking them into the test binary will prevent discovery.
</Note>

<Warning>
**Warning:** Calling `RUN_ALL_TESTS()` multiple times or failing to return its value from `main()` will prevent test execution or produce unpredictable results.
</Warning>

---

For advanced troubleshooting or if you suspect bugs, consider:

- Verifying macro expansions do not interfere with test or mock method names.
- Checking platform-specific constraints, especially on embedded or Windows systems.
- Reviewing any linker or build warnings.


---

**By following these guidelines, you will ensure your tests are properly discovered and executed, unlocking the full power of GoogleTest and GoogleMock in your development workflow.**


---

## Source References

For users looking to dive deeper into relevant source code:

- GoogleMock main function implementations for test execution flow: [`googlemock/src/gmock_main.cc`](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc)
- Mock object definition and macro usage: [Mock Object Definition Reference](https://google.github.io/googletest/reference/gmock-mocking-apis/mock-object-definition.html)
- Test discovery flows and naming conventions: [Test Structure and Discovery](https://google.github.io/googletest/guides/getting-started/test-structure-and-discovery.html)

---

## Summary

This page focused on explaining why some of your test cases might not be discovered or executed by GoogleTest and GoogleMock, highlighting typical causes like improper naming, macro misuse, incomplete build integration, or missing `RUN_ALL_TESTS()`. Step-by-step troubleshooting and practical tips have been provided along with key references to help you diagnose and resolve these issues efficiently.
