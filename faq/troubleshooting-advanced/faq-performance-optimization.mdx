---
title: "Test Performance and Optimization"
description: "Best practices and suggestions to improve your test suite’s runtime efficiency, manage test flakiness, and optimize for parallel execution. Includes guidance on isolating slow tests and tuning GoogleTest parameters."
---

# Test Performance and Optimization FAQ

This FAQ provides practical advice on improving the efficiency and reliability of your GoogleTest test suites. It covers best practices for managing test runtime, isolating slow or flaky tests, and tuning GoogleTest parameters, especially for parallel execution.

---

## 1. How can I improve my test suite's runtime efficiency?

Improving runtime efficiency is key to keeping feedback cycles short and your development process smooth. Here are proven approaches:

- **Identify Slow Tests**: Use GoogleTest's built-in timing output (`--gtest_print_time=1`) to detect slow-running tests.
- **Isolate and Fix Slow Tests**: Once slow tests are found, investigate underlying causes such as heavy I/O, long setup/teardown, or external dependencies. Refactor or reimplement them as needed.
- **Leverage Parallel Execution**: Run tests in parallel across multiple CPU cores to reduce total runtime. Configure parallelism through your build system or test harness.
- **Skip or Disable Expensive Tests When Appropriate**: Use `GTEST_SKIP()` or the `DISABLED_` prefix to exclude tests during routine runs.

<Tip>
To get started with timing runs, add the flag `--gtest_print_time=1` when running your tests to see individual test durations ranked by slowness.
</Tip>

## 2. What strategies help manage test flakiness?

Flaky tests that sometimes fail and sometimes pass cause frustration and reduced confidence. Manage them by:

- **Isolate External Dependencies**: Use mocks or fakes (see GoogleMock) to avoid relying on unstable network services, databases, or timing-sensitive code.
- **Use Retry Patterns Cautiously**: Temporarily retry tests, but avoid masking underlying problems.
- **Tune Timeouts and Waits**: When tests involve timing or waiting, make timeouts generous enough to accommodate variability without slowing too much.
- **Run Flaky Tests Separately**: Mark flaky tests and isolate their runs to avoid polluting overall test results.

<Warning>
Don't ignore flaky tests; they erode trust in your test suite. Invest time to stabilize tests using mocking, better synchronization, or determinism.
</Warning>

## 3. How do I optimize GoogleTest for parallel test execution?

Parallel execution spreads tests across multiple processes or threads, reducing total duration, but requires attention:

- **Use Test Sharding**: GoogleTest supports test sharding with `--gtest_total_shards=N --gtest_shard_index=M` flags to run subsets of tests independently.
- **Avoid Shared State Between Tests**: Make sure tests are independent to run safely in parallel.
- **Control Shared Resources**: If your tests share files, databases, or network ports, use isolation or unique copies.
- **Tune GoogleTest Flags**: Flags like `--gtest_repeat` and `--gtest_shuffle` can impact parallel runs and are helpful during flakiness diagnosis.

<Tip>
Refer to the [Test Discovery & Execution Flow](https://github.com/google/googletest/blob/main/docs/concepts/testing-architecture/test-execution-flow.md) documentation to understand how your tests are discovered and controlled.
</Tip>

## 4. How can I isolate slow tests effectively?

Isolating slow tests prevents them from slowing down the most frequent test runs:

- **Categorize Tests**: Use test labels or naming conventions like `SlowTest` or `IntegrationTest`.
- **Filter Tests**: Run only the fast tests during pre-commit, and run slow tests less frequently.
- **Leverage Parameterized Tests**: Sometimes parameterized tests aggregate multiple cases; use disabling or separate instantiations to avoid slow tests in standard runs.

<Info>
The guide on [Parameterized and Typed Tests](../api-reference/core-testing-apis/parameterized-and-typed-tests.md) provides guidance on managing test cases efficiently.
</Info>

## 5. What GoogleTest parameters can I tune for optimization?

Several runtime parameters impact performance and behavior:

| Flag                              | Purpose                                      |
| -------------------------------- | -------------------------------------------- |
| `--gtest_filter`                  | Run a subset of tests.                        |
| `--gtest_repeat`                  | Repeat tests to detect flakiness and latency. |
| `--gtest_shuffle`                 | Shuffle order to uncover order dependencies. |
| `--gtest_catch_exceptions`       | Enable catching exceptions during tests. Can impact speed. |
| `--gtest_break_on_failure`       | Debug on failure by breaking immediately.   |
| `--gtest_print_time`             | Report test durations.                        |
| `--gtest_color`                  | Enable colored output for readability.       |

<Note>
Customizing these flags according to your workflow and environment can greatly enhance test performance.
</Note>

## 6. Are there any best practices to prevent test slowdown?

Definitely. Keep these in mind:

- **Keep Tests Small and Focused**: Each test should be limited in scope to limit runtime.
- **Avoid Excessive Setup and Teardown**: Share fixtures where safe and possible.
- **Cache Expensive Resources**: Reuse initialized data or mocks when safe.
- **Avoid Sleeping or Busy Waiting**: Prefer efficient synchronization or mocking time.

<Tip>
See the [Scalability and Performance](../concepts/advanced-usage-and-integration/scalability-and-performance.md) guide for additional strategies.
</Tip>

## 7. What troubleshooting steps can I take if my tests are unexpectedly slow or flaky?

Follow a systematic approach:

<Steps>
<Step title="Check Test Output with Timing Flags">
Run your tests with `--gtest_print_time=1` and analyze which tests take the longest.
</Step>
<Step title="Review External Dependencies">
Make sure no test is slowing due to network access, databases, or file I/O.
</Step>
<Step title="Analyze Parallel Execution Settings">
Validate flags related to sharding and parallelism; check if shared state causes locking.
</Step>
<Step title="Run Tests in Isolation">
Run suspected slow/flaky tests individually. Confirm if the problem persists.
</Step>
<Step title="Use GoogleMock to Replace External Interactions">
Replace flaky external calls with mocks to isolate problem areas.
</Step>
<Step title="Consult Logs and Verbose Flags">
Run with `--gmock_verbose=info` to get detailed mock call information; helps diagnose unexpected test behavior.
</Step>
</Steps>

---

## Related Documentation

- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) – Introductory guide to mocking.
- [Mocking Reference](../api-reference/mocking-framework/defining-and-using-mocks.md) – Detailed reference on mocking APIs.
- [GoogleTest Test Execution Flow](../concepts/testing-architecture/test-execution-flow.md) – How tests run under the hood.
- [Scalability and Performance Guide](../concepts/advanced-usage-and-integration/scalability-and-performance.md) – Best practices for large test suites.
- [Parameterized and Typed Tests](../api-reference/core-testing-apis/parameterized-and-typed-tests.md) – Efficiently covering multiple input variations.

---

## Practical Tips

- Use `EXPECT_CALL` and `ON_CALL` wisely to balance test strictness and runtime.
- Mark slow tests clearly with test naming or categories to exclude them when needed.
- Use mocking extensively to replace slow or unreliable dependencies.
- Regularly profile your test suite timing to catch regressions early.
- Experiment with test sharding and parallelization in your continuous integration setup.


## Troubleshooting Section

<AccordionGroup title="Common Performance and Flakiness Issues">
<Accordion title="Test Runs Too Long Despite Parallelization">
Check for shared mutable state or resources (files, ports, environment variables). Make sure tests are independent and isolate resource usage.
</Accordion>
<Accordion title="Mock Expectations Not Met, Tests Fail Unexpectedly">
Debug with `--gmock_verbose=info` to see mock calls and expectations. Ensure `EXPECT_CALL` precedes execution and arguments/matchers are correct.
</Accordion>
<Accordion title="High CPU or Memory Use During Testing">
Profile tests individually to identify leaks or high resource usage. Use `Mock::AllowLeak()` carefully when mocked objects are owned by tested code.
</Accordion>
<Accordion title="Slow Tests Caused by External Dependencies">
Mock out network, database, or file system calls where possible. Use fakes or stubs for expensive operations.
</Accordion>
<Accordion title="Tests Fail Randomly Without Code Changes">
Investigate test order dependencies and shared state. Use `--gtest_shuffle` to uncover order dependencies. Avoid global mutable state.
</Accordion>
</AccordionGroup>

---

# Summary
This FAQ equips you with practical knowledge to optimize test performance and stability in GoogleTest suites. Leveraging timing analysis, parallel execution, mocking, and structured test organization reduces runtime and flakiness, ensuring fast and reliable feedback.

---

# Additional Help & Support
If you encounter persistent issues, visit the [Getting More Help](../getting-started/troubleshooting-resources/where-to-find-more-help.md) page or engage with the GoogleTest community via forums and issue trackers.

---

<footer>Documentation by GoogleTest Team | [Project Repo](https://github.com/google/googletest)</footer>
