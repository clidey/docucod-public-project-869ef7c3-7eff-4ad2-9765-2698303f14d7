---
title: "Installation & Setup Issues"
description: "Answers to frequent problems encountered during installation or setup of GoogleTest and GoogleMock, such as compatibility, build errors, or linking problems. Helps users quickly find resolutions to get up and running on various platforms."
---

# Installation & Setup Issues FAQ

This page addresses frequent problems encountered during the installation and setup of **GoogleTest** and **GoogleMock**. Whether you're facing build errors, compatibility challenges, or linking issues on various platforms, this guide provides quick, actionable solutions to help you get up and running smoothly.

---

## 1. Common Installation & Setup Questions

### 1.1 What are the basic prerequisites for building GoogleTest and GoogleMock?

- **C++17 Support:** Both frameworks require a C++17 compatible compiler.
- **Build Tools:** CMake 3.14 or newer is recommended.
- **Threading Libraries:** pthreads are preferred on Unix-like systems; Windows threading primitives are used otherwise.

> For detailed prerequisites, see the [System Requirements](../../getting-started/setup-basics/system-requirements) page.

### 1.2 How do I build GoogleTest and GoogleMock using CMake?

Typically, build GoogleTest (which includes GoogleMock by default) as follows:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build && cd build
cmake ..           # Builds GoogleTest and GoogleMock
make               # or use your platform-appropriate build command
sudo make install   # optional, requires admin privileges
```

To build only GoogleTest (without GoogleMock):

```bash
cmake .. -DBUILD_GMOCK=OFF
```

Visual Studio users will find `.sln` files generated for easier IDE builds.

### 1.3 How do I incorporate GoogleTest into my existing CMake project?

You have two main options:

- **Use Installed Libraries:** Import with `find_package(GTest CONFIG REQUIRED)` and link with `GTest::gtest` and `GTest::gmock`.
- **Add Subdirectory:** Include GoogleTest source in your project tree and call `add_subdirectory(googletest)`. This ensures consistent compiler and linker settings.

Full details at [CMake Integration](../../getting-started/installation-config/cmake-integration).

### 1.4 I encountered a runtime library mismatch error on Windows with Visual Studio. How do I fix this?

By default, Visual Studio links CRT dynamically (`/MD`), but GoogleTest links it statically (`/MT`). This can cause errors like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary': value 'MTd_StaticDebug' doesn't match value 'MDd_DynamicDebug' in main.obj
```

**Solution:** set the CMake option `gtest_force_shared_crt` to `ON`. This makes GoogleTest link against the dynamic runtime:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

This option adjusts compiler flags accordingly to prevent conflicts.

### 1.5 What CMake flags control compiler and linker settings for GoogleTest/GoogleMock?

- `BUILD_SHARED_LIBS` controls building shared (`.dll`/`.so`) vs static libraries.
- `gtest_force_shared_crt` on Windows ensures runtime libraries are linked dynamically.

Internally, the build scripts apply compiler and linker tweaks for warnings, exception handling, and threading support aligned with the platform and chosen options.

### 1.6 How can I avoid macro name clashes when using GoogleTest with other libraries?

GoogleTest macros do not obey namespaces. To rename conflicting macros, define a preprocessor flag:

```
-DGTEST_DONT_DEFINE_<MACRO_NAME>=1
```

For example, to avoid conflict with `TEST` macro:

```
-DGTEST_DONT_DEFINE_TEST=1
```

You will need to prefix the macro with `GTEST_` in your code:

```cpp
GTEST_TEST(MyTestSuite, MyTest) { ... }
```


---

## 2. Troubleshooting Common Setup Problems

### 2.1 Build fails with missing pthreads or thread library errors on MinGW or Windows.

- GoogleTest disables pthreads on MinGW and uses Windows native threads instead.
- If your toolchain expects pthread support, explicitly disable pthread with:

```
-DGTEST_HAS_PTHREAD=0
```

- Using the included CMake scripts automatically links appropriate threading libraries.

### 2.2 Linker errors related to missing symbols from GoogleTest or GoogleMock libs.

- Ensure your test targets link against `gtest_main`, `gtest`, `gmock`, or `gmock_main` as appropriate.
- For example, with CMake:

```cmake
add_executable(my_test test.cpp)
target_link_libraries(my_test gtest_main gmock)
```

- If building shared libraries, confirm you use `-DGTEST_LINKED_AS_SHARED_LIBRARY=1` for test targets.

### 2.3 I receive warnings or errors about RTTI or exception handling being disabled.

- GoogleTestâ€™s CMake build configures exception and RTTI flags based on the compiler.
- If your project disables RTTI or exceptions, ensure you build GoogleTest/GoogleMock with:

  - `cxx_no_exception` flags to disable exceptions
  - `cxx_no_rtti` flags to disable RTTI

- You can build variants of GoogleTest/GoogleMock with these flags, but tests that require these features may fail.

### 2.4 Tests are not running or GoogleMock initialization fails.

- Make sure you initialize GoogleTest or GoogleMock properly in your test executable:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- On embedded platforms, such as ESP32 or Arduino, use the appropriate setup and loop functions as provided by the framework.

### 2.5 Command line arguments controlling GoogleMock flags are not recognized.

- Use `testing::InitGoogleMock(&argc, argv)` to parse GoogleMock flags such as `--gmock_verbose`.
- Unrecognized flags are left intact.
- You can verify flag parsing with tests in `gmock_test.cc`.

---

## 3. Platform-Specific and Integration Tips

### 3.1 Building on Windows with Visual Studio

- Use the Visual Studio solution (`.sln`) generated by CMake in the build directory.
- Set `gtest_force_shared_crt=ON` to avoid runtime library conflicts.
- For static linking, ensure you do not mix dynamic CRT builds.

### 3.2 Building on Linux/macOS

- Install CMake 3.14+.
- Use the default pthread threading unless explicitly disabled.
- The CMake scripts handle compiler flags to enforce warnings, exception behavior, and standard compliance.

### 3.3 Using GoogleTest and GoogleMock in Embedded Environments

- For Arduino, ESP32, and similar platforms, use the specialized `setup()` and `loop()` entry points from the provided source files (`gtest_main.cc` and `gmock_main.cc`).

---

## 4. Best Practices for a Smooth Setup

- Always ensure your compiler supports C++17.
- Use the bundled CMake scripts to avoid manual flag misconfiguration.
- Leverage `FindPackage(GTest)` if GoogleTest is installed system-wide.
- When embedding GoogleTest into large projects, prefer `add_subdirectory()` to keep compiler/linker options synchronized.
- Take advantage of the `gmock_build_tests` option to verify build correctness by enabling and running internal GoogleMock tests.

---

## 5. Example CMake Integration Snippet

Here is a minimal example to incorporate GoogleTest and GoogleMock into your project:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)
target_link_libraries(my_test gtest_main gmock)
add_test(NAME my_test COMMAND my_test)
```


---

## 6. Additional Resources

- [GoogleTest Primer](../../getting-started/first-run-validation/primer-quickstart)
- [CMake Integration Guide](../../getting-started/installation-config/cmake-integration)
- [Platform Compatibility Troubleshooting](../../getting-started/troubleshooting-help/platform-compatibility-issues)
- [FAQ & Common Issues](../../getting-started/troubleshooting-help/faq-common-issues)

---

## 7. Troubleshooting Checklist

<AccordionGroup title="Installation & Setup Troubleshooting">
<Accordion title="Build System Errors">
- Confirm CMake version is 3.14 or later.
- Validate compiler supports C++17 (`set(CMAKE_CXX_STANDARD 17)`).
- Check for missing dependencies (e.g., pthreads on Unix).
</Accordion>
<Accordion title="Linker Errors">
- Ensure all test executables link with GoogleTest/GoogleMock libraries explicitly.
- Use shared vs static CRT consistently on Windows.
</Accordion>
<Accordion title="Runtime Test Failures or Initialization Issues">
- Verify proper invocation of `testing::InitGoogleMock()` or `InitGoogleTest()`.
- Check command line flags and environment for overrides.
- For embedded platforms, follow platform-specific `setup()` and `loop()` patterns.
</Accordion>
</AccordionGroup>

---

## 8. FAQs

**Q: Can I build GoogleMock separately?**

A: GoogleMock depends on GoogleTest and is usually built together. You can control this with the `BUILD_GMOCK` option in CMake.

**Q: How do I enable multi-threaded test support?**

A: GoogleTest uses pthreads when available. Override detection with `-DGTEST_HAS_PTHREAD=1` or `=0` as needed.

**Q: How do I build GoogleTest and GoogleMock as shared libraries?**

A: Pass `-DBUILD_SHARED_LIBS=ON` in CMake and add `-DGTEST_CREATE_SHARED_LIBRARY=1` to compiler flags. Link your tests with `-DGTEST_LINKED_AS_SHARED_LIBRARY=1`.

**Q: Why are some compiler warnings disabled by default?**

A: To prevent noisy outputs for unreachable code or non-critical warnings that are known safe, GoogleTest disables some specific warnings via CMake flags.

---

This FAQ page ensures you can diagnose and resolve most installation and setup challenges with GoogleTest and GoogleMock, paving your way for successful C++ unit testing.

---