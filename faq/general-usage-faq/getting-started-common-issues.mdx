---
title: "Getting Started and Common Issues"
description: "Answers to the most frequent questions users encounter when setting up or writing their first tests. Covers initial setup, common error messages, and basic test/lifecycle behaviors."
---

# Getting Started and Common Issues FAQ

This FAQ answers the most frequent questions new users encounter when setting up GoogleTest and GoogleMock, writing their first tests, and addressing common runtime issues. It offers clear guidance on initial setup, common error messages, and key behaviors during test execution and mock lifecycle management.

---

## 1. Initial Setup and Writing Your First Test

### How do I define a mock method correctly?
To mock a method in a class, use the `MOCK_METHOD` macro inside your mock class's `public` section. It requires:

- The return type
- The method name
- The argument types as a parameter list in parentheses
- Optional qualifiers like `const` or `override` inside an additional parameter list

**Example:**

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(void, Process, (int x, double y), (override));
};
```

If your return type or argument type contains commas (like a `std::pair`), wrap them in parentheses or create type aliases to avoid parsing issues:

```cpp
using BoolInt = std::pair<bool, int>;
MOCK_METHOD(BoolInt, GetPair, ());
```

### Which methods can I mock? Does the method have to be virtual?
Methods must be virtual to be mockable with the standard approach. GoogleMock can mock non-virtual methods only with advanced dependency injection techniques (see the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html#mocking-non-virtual-methods) for details).

### Can I mock overloaded methods and const methods?
Yes. For overloaded methods, mock each overload explicitly. If your method is `const`, specify `(const, override)` in the `MOCK_METHOD` qualifier.

Example:

```cpp
MOCK_METHOD(int, Add, (int x), (override));
MOCK_METHOD(int, Add, (Element x), (override));
MOCK_METHOD(int, GetID, (), (const, override));
```

### How do I create a "nice", "naggy" or "strict" mock?

- **NaggyMock** (default): warns on uninteresting calls.
- **NiceMock**: suppresses warnings on uninteresting calls.
- **StrictMock**: treats uninteresting calls as test failures.

Use them by wrapping your mock class:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

NiceMock<MockFoo> nice_mock;
NaggyMock<MockFoo> naggy_mock;
StrictMock<MockFoo> strict_mock;
```

---

## 2. Setting Expectations and Default Behaviors

### What is the difference between `EXPECT_CALL` and `ON_CALL`?

- `EXPECT_CALL` sets an expectation that a method will be called with specified arguments, a certain number of times, and possibly in order.
- `ON_CALL` sets the default behavior for method calls without enforcing any expectation about them actually occurring.

**Best practice:** Use `ON_CALL` to define usual default behavior and only use `EXPECT_CALL` to verify specific calls you care about.

### How do I specify argument matching?

In `EXPECT_CALL` and `ON_CALL`, you can use various matchers to specify the expected argument values, e.g., `_` (wildcard), `Eq(value)`, `Ge(5)`, or custom matchers. You can combine matchers to create complex expectations. If you omit the argument list for non-overloaded methods, it matches any arguments.

Example:

```cpp
EXPECT_CALL(foo, DoSomething(_));             // Matches any argument
EXPECT_CALL(foo, Process(Ge(1), Eq("ok"))); // Matches first arg >= 1 and second arg == "ok"
```

### How do I specify how many times a mock method should be called?

Use the `.Times()` clause with cardinalities like:

- `Times(1)` (default if unspecified)
- `Times(AnyNumber())`
- `Times(AtLeast(n))`
- `Times(AtMost(n))`
- `Times(Between(m, n))`

Example:

```cpp
EXPECT_CALL(foo, Bar()).Times(3);  // Expect call exactly 3 times
EXPECT_CALL(foo, Bar()).Times(AnyNumber());  // No limit
```

If you do not specify `Times()`, GoogleMock infers it based on your `WillOnce` and `WillRepeatedly` clauses.

### How do I specify what the mock method should do when called?

Use:

- `.WillOnce(action)` to specify the behavior on a single call.
- `.WillRepeatedly(action)` to specify behavior on all subsequent calls after `WillOnce` actions are exhausted.

Example:

```cpp
EXPECT_CALL(foo, GetSize())
    .WillOnce(Return(1))
    .WillOnce(Return(2))
    .WillRepeatedly(Return(3));
```

You can specify multiple actions, such as returning different values, invoking lambdas, setting output arguments, etc. See the [Actions Reference](https://google.github.io/googletest/reference/actions.html) for details.

### What does `.RetiresOnSaturation()` do?

This causes an expectation to become inactive once it has been satisfied the specified number of times (saturated). It allows later matching expectations to take effect.

Example:

```cpp
EXPECT_CALL(foo, Bar(7)).Times(2).RetiresOnSaturation();
EXPECT_CALL(foo, Bar(_)).Times(AnyNumber());
```

Here the first 2 calls to `foo.Bar(7)` match the first expectation; subsequent calls match the catch-all expectation.

---

## 3. Understanding Error Messages and Common Issues

### What does "Uninteresting mock function call" warning mean?

This message appears when a mock method without any `EXPECT_CALL` is called. By default, gMock allows such calls but warns that you might have forgotten to specify an expectation.

**How to handle it:**

- If the call is expected but you don't want to verify it, add an `EXPECT_CALL` with `Times(AnyNumber())` to suppress the warning.
- Alternatively, use a `NiceMock` to suppress such warnings entirely.

### What does "Unexpected mock function call" failure mean?

An unexpected call means a call was made to a mock method with arguments that do not match any active `EXPECT_CALL`. It is a failure because it violates the test's expectations.

Check your expectations to ensure all expected call patterns are covered.

### What is an "Excessive call" failure?

Occurs when a mock function is called more times than allowed by the `Times()` clause.

### What is an "Explicit actions ran out" warning?

If you specify fewer `WillOnce()` actions than the expected number of calls, and no `WillRepeatedly()`, gMock warns that some calls use the default action because explicit actions have run out.

To fix this, either provide enough `WillOnce()` clauses or add a suitable `WillRepeatedly()` action.

### What does "Retired expectation" failure mean?

It means the mock call matches an expectation that has been retired (after `RetiresOnSaturation()` or sequence rules), so it is not valid to match that expectation anymore.

### Why are expectations "sticky" by default?

Expectations remain active after saturation unless marked with `RetiresOnSaturation()`, to enable flexible test specifications without surprise.

### How important is call order, and how do I specify it?

By default, calls may occur in any order. Use `InSequence` or the `.After()` clause to enforce call order when needed.

```cpp
{
  InSequence s;
  EXPECT_CALL(foo, A());
  EXPECT_CALL(foo, B());
}
```

or

```cpp
Expectation e1 = EXPECT_CALL(foo, A());
EXPECT_CALL(foo, B()).After(e1);
```

---

## 4. Common Pitfalls and Troubleshooting

### I get linker or build errors after adding GoogleMock to my project. What should I check?
- Ensure you have included `gmock_main` or provided your own main.
- Verify that GoogleMock and GoogleTest are correctly compiled and linked.
- Check that compiler flags match requirements (C++ standard, platform).

### Why might the real method be called instead of the mock method?
Make sure the method you mock is virtual. Non-virtual functions cannot be mocked.

### How can I avoid memory leaks of mock objects?

Mock expectations are verified at mock object destruction. If the mock object is leaked, verification won't occur, leading to errors or silent failures.

To avoid this:

- Create mocks on the stack or ensure they are deleted.
- If you must leak, explicitly suppress warnings with `Mock::AllowLeak(&mock_obj);` but only if intentional.

### How can I debug why expectations aren't met?

Run your test with `--gmock_verbose=info` to see detailed mock call and expectation matching logs.

### Can I mock functions that accept or return move-only types?

Yes. Define mocks normally with `MOCK_METHOD`, and use lambdas or actions to handle move semantics appropriately. For example, to return a unique pointer, use `WillOnce([](){ return std::make_unique<...>(); })`.

### How can I verify mock expectations before the mock object is destructed?

Call `Mock::VerifyAndClearExpectations(&mock_obj);` explicitly. It returns `true` if all expectations are met.

### How do I deal with overloaded methods that share the same name?

Use `Const()` wrapper for const overloads, or help the compiler by casting or specifying the exact matcher type for function arguments.

### How do I suppress "uninteresting call" warnings selectively?

Use `NiceMock` to silence all warnings for a mock, or explicitly add `EXPECT_CALL(mock, Method(_)).Times(AnyNumber());` for specific methods.

---

## 5. Expected User Workflow Summary

1. Define your mock classes using `MOCK_METHOD` macros.
2. Create mock objects in your tests.
3. Use `ON_CALL` to set default behaviors for mock methods.
4. Use `EXPECT_CALL` to set expectations about how methods should be called.
5. Run your tests. gMock will verify that expectations are fulfilled.
6. Inspect errors or warnings. Increase verbosity if needed to debug.
7. Use sequences or `.After()` to fine-tune expected call order.

---

## 6. Practical Tips

- Always specify `.RetiresOnSaturation()` for expectations that represent ordered, one-shot events, especially when you have overlapping matchers.
- Use `NiceMock` to suppress warnings about calls you donâ€™t care about.
- Use `StrictMock` when you want to strictly disallow any unexpected or uninteresting calls.
- Prefer `ON_CALL` for defining usual behavior and reserve `EXPECT_CALL` for calls you want to validate.
- To avoid confusion with overloaded methods, use explicit cast or `Const()`.
- Clean up your mock objects properly or allow leaks explicitly to avoid subtle failures at program exit.

---

## 7. Where to Get More Help

- Consult the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for recipes and advanced workflows.
- Review the [Matchers Reference](https://google.github.io/googletest/reference/matchers.html) and [Actions Reference](https://google.github.io/googletest/reference/actions.html) for detailed API.
- Explore the [Core Mocking APIs](https://google.github.io/googletest/reference/core-mocking-apis.html).
- Enable `--gmock_verbose=info` to get rich diagnostic logs during test runs.

---

## Related Documentation

- [Writing Your First Test](../guides/getting-started-workflows/writing-first-test.md)
- [Building & Running Tests](../getting-started/first-test-usage-validation/building-running-tests.md)
- [Troubleshooting and Validation](../getting-started/first-test-usage-validation/troubleshooting-validation.md)
- [Mocking Reference](../docs/reference/mocking.md)

---

*This FAQ page is part of the "Getting Started" and "FAQ" sections, linking practical user concerns to deeper conceptual and reference material for effective mastery of GoogleTest and GoogleMock.*
