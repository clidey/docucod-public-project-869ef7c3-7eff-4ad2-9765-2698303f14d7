---
title: "Why are my tests failing or not being discovered?"
description: "Provides a troubleshooting guide for resolving issues related to test discovery and execution failures. Includes diagnostic steps and tips for pinpointing and fixing the most common causes."
---

# Why Are My Tests Failing or Not Being Discovered?

This troubleshooting guide addresses common reasons why GoogleTest or GoogleMock tests might fail unexpectedly or not be discovered during test execution. It helps you systematically diagnose and fix issues related to build setup, test registration, runtime failures, and environment compatibility.

---

## 1. Understanding Test Discovery

GoogleTest automatically discovers tests defined using `TEST()`, `TEST_F()`, and other macros by scanning registries maintained at runtime. Failures in discovery most often stem from one of the following:

- Incorrect linkage or compilation of source files containing tests
- Tests not being linked into the test executable
- Missing or incorrect test macros or initialization code
- Build system misconfiguration causing tests to be excluded

### Diagnostic Steps

- Verify that your test source files are compiled and linked into the executable.
- Ensure you use the GoogleTest macros (`TEST()`, `TEST_F()`, etc.) properly.
- Confirm you have called `testing::InitGoogleTest()` before calling `RUN_ALL_TESTS()`.
- Run your test binary with no filters to see if any tests are listed.

```bash
./your_test_binary --gtest_list_tests
```

If no tests are listed, your tests are not being registered properly.

---

## 2. Common Causes of Failing Tests

Failures in running tests can occur for diverse reasons. The guide below highlights common scenarios with tips to resolve them.

### 2.1 Build and Link Errors

- **Missing GoogleTest or GoogleMock libraries**: Link errors prevent successful build or test execution.
- **Incorrect linkage to main test runner**: Without linking to `gtest_main` or `gmock_main` (or providing your own `main()`), tests won't execute properly.

**Solution:**
- Confirm correct libraries (`gtest`, `gtest_main`, `gmock`, `gmock_main`) are linked.
- In CMake, use targets like `gtest::gtest_main`.
- Verify your build outputs the test executable with all necessary symbols.

### 2.2 Test Registration Failures

- Forgetting to call `testing::InitGoogleTest()` (or `testing::InitGoogleMock()` for mocking) results in tests not registering or command-line flags not being parsed.

**Solution:**
- Make sure your test `main()` calls `InitGoogleTest()` or `InitGoogleMock()` exactly once, before `RUN_ALL_TESTS()`.

Example:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes both gMock and gTest.
  return RUN_ALL_TESTS();
}
```

### 2.3 Test Filtering and Execution Flags

- Passing incorrect or overly restrictive filters with `--gtest_filter` can cause no tests to run.
- Flags like `--gtest_repeat=0` or filtering by a test name that does not exist.

**Solution:**
- Run without filters to verify tests run.
- Use `--gtest_list_tests` to confirm test names.
- Adjust filters for expected test names.

### 2.4 Runtime Failures and Crashes

- Tests may fail due to assertion failures, unexpected exceptions, or segmentation faults.
- Mock objects might trigger failures due to unsatisfied expectations or unexpected calls.

**Solution:**
- Review test output logs carefully to pinpoint failure points.
- Run with higher verbosity for detailed info:

```bash
./your_test_binary --gtest_verbose=info
```

- Use address sanitizers or debugging tools to trace crashes.
- For mocks, ensure expectations on mock methods are correctly set, following best practices for `EXPECT_CALL` and `ON_CALL`.

### 2.5 Test Suite or Fixture Configuration Issues

- Improper setup or teardown methods can cause early test failures.
- Test fixtures may not initialize resources properly.

**Solution:**
- Check your fixture `SetUp()` and `TearDown()` logic.
- Use `ASSERT_*` vs `EXPECT_*` appropriately to avoid invalid states.
- Verify resource allocation and cleanup.

---

## 3. Debugging Tips

### Using Verbosity Flags

GoogleTest and GoogleMock provide verbosity flags to increase output details and aid debugging.

```bash
--gtest_verbose=info
--gmock_verbose=info
```

These flags print detailed traces of test and mock calls, expectation matching, and internal decisions.

### Checking Expected vs Actual Calls in Mocks

Run your mock tests with verbose output to see which expectations match or fail, and diagnose mismatches.

### Stack Traces

GoogleTest prints failures with file and line information. Make sure your build supports debug symbols for clearer traces.

### Validate Test Registration

Use `--gtest_list_tests` to confirm that your tests are recognized by the framework:

```bash
./your_test_binary --gtest_list_tests
```

If tests are missing, revisit build and registration steps above.

### Isolate Problematic Tests

Run individual tests or test suites:

```bash
./your_test_binary --gtest_filter=TestSuiteName.TestName
```

To identify flaky or failing tests, and reduce noise.

---

## 4. Best Practices to Prevent Discovery and Execution Issues

- Always link your test executable with `gtest_main` or provide your own `main()` that initializes GoogleTest.
- Make sure source files with tests are included in your build targets.
- Use consistent test naming and macro usage.
- Avoid duplicate or conflicting macros.
- Use `ON_CALL` for default mock behaviors, and `EXPECT_CALL` only where strict expectations are intended.
- Update your build and CMake configurations as new versions of GoogleTest evolve.

---

## 5. Additional Resources and Links

- [Writing and Running Your First Test](../guides/core-workflows/getting-started-tests) - step-by-step test creation
- [Troubleshooting Common Issues](../../getting-started/troubleshooting-validation/common-issues) - detailed troubleshooting guide
- [GoogleMock Cookbook](../docs/gmock_cook_book.md) - advanced mocking tips and solutions
- [Official GoogleTest FAQ](../faq/usage-getting-started/faq-basic-usage) â€“ usage and setup guidance
- [Build System Integration Guide](../guides/integration-and-optimization/build-system-integration) - configuring with CMake or Bazel

---

If you still cannot resolve the issue after these steps, consider sharing detailed logs on community forums or reaching out to support channels listed in the [Getting Help & Support](../faq/advanced-performance-help/faq-getting-help-support) documentation page.

---

**Remember:** Effective troubleshooting starts with confirming your build and linkage, verifying test registration, checking runtime flags and observation with verbosity, and isolating individual test failures.

---