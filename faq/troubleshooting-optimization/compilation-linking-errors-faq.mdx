---
title: "Resolving Compilation & Linking Errors"
description: "Guidance on diagnosing and fixing common compiler and linker errors encountered when integrating GoogleTest or GoogleMock, including header and symbol issues, CMake/Bazel build troubleshooting, and misconfiguration of source or test files."
---

# Resolving Compilation & Linking Errors

This page guides you through diagnosing and fixing common compiler and linker errors encountered when integrating GoogleTest or GoogleMock into your C++ project. It addresses frequent issues related to missing headers, undefined symbols, build configuration problems with CMake and Bazel, and misconfiguration in including source or test files.

---

## Common Compilation Issues

### Missing GoogleTest or GoogleMock Headers

If your compiler cannot find `gtest/gtest.h` or `gmock/gmock.h`, verify:

- You have properly added GoogleTest and GoogleMock sources or libraries to your include path.
- When integrating using CMake, either GoogleTest is installed and found via `find_package(GTest)`, or you embedded it as a subdirectory via `add_subdirectory(googletest)`. 
- For Bazel users, ensure your BUILD files have correct `deps` on `@com_google_googletest//:gtest` or `:gmock`.

**Example Fix with CMake:**
```cmake
find_package(GTest REQUIRED)
target_link_libraries(your_test_target GTest::gtest GTest::gmock)
include_directories(${GTEST_INCLUDE_DIRS})
```

### Header File Inclusion Order

- Always include `<gtest/gtest.h>` before other GoogleTest or GoogleMock headers if including manually.
- Avoid circular or duplicate inclusion by relying on compiled libraries or recommended build setups.

### Unsupported C++ Standard

GoogleTest requires a C++17-compliant compiler. If you see errors related to language features:

- Confirm your compiler flags specify at least `-std=c++17`.
- When building GoogleTest as part of your project, ensure your project’s compile flags match.

---

## Linking Errors and Undefined Symbols

### Common Undefined Symbol Errors

- Undefined references to `testing::InitGoogleTest`, `RUN_ALL_TESTS()`, or GoogleMock symbols usually mean your linker hasn't linked against GoogleTest or GoogleMock libraries.

**How to Fix**:
- Link against `gtest`, `gtest_main` (if using the default main), or `gmock` accordingly. 
- Ensure binaries and libraries use the same runtimes and compiler settings.

**Example CMake snippet:**
```cmake
target_link_libraries(my_test_gtest gtest_main)  # or gtest if providing your own main
```

### Runtime Library Mismatches on Windows

If you see linker errors about mismatched runtime library flags (e.g., static vs dynamic CRT), 

- Use `gtest_force_shared_crt` CMake option to align with your project's runtime.

```bash
cmake -Dgtest_force_shared_crt=ON ..
```

- Rebuild GoogleTest with the same runtime linkage as your project.

### Source File Misconfiguration

Ensure your test sources are correctly configured:

- Include all your `.cc` or `.cpp` files implementing tests.
- Do not compile GoogleTest or GoogleMock source files twice if you build them as a library.
- Avoid mixing source files from different versions of GoogleTest.

---

## Troubleshooting Build Configurations

### CMake Build Troubleshooting

- Use CMake’s `FetchContent` feature to embed GoogleTest correctly:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.tar.gz
)
FetchContent_MakeAvailable(googletest)

target_link_libraries(my_test PRIVATE gtest_main)
```

- Verify that your compile options match GoogleTest’s.
- If using `gtest_main`, do not declare your own main().
- Use CMake flags like `GTEST_DONT_DEFINE_TEST` if macro conflicts occur.

### Bazel Build Troubleshooting

- Ensure BUILD files declare dependency on `@com_google_googletest//:gtest` or `:gmock` appropriately.
- Use `cc_test` rules and `deps` field to properly resolve GoogleTest and GoogleMock.

---

## Diagnosing Header and Symbol Issues

### Header Issues

- Missing symbols from headers often stem from not including the right GoogleTest or GoogleMock headers.
- For basic tests, include:

```cpp
#include <gtest/gtest.h>
```

- For mocking features, include:

```cpp
#include <gmock/gmock.h>  // includes gtest/gtest.h transitively
```

- Avoid including internal headers directly.

### Symbol Issues

- Undefined symbols indicate that GoogleTest or GoogleMock implementation files were not linked.
- When building GoogleTest from source, link against the compiled static or dynamic libraries provided.

### Avoiding Common Pitfalls

- Do not mix compilation of source files with static/dynamic libraries of GoogleTest.
- Ensure compiler and linker are consistent (debug vs. release builds).
- When using third-party build systems, verify that paths and dependencies are correctly set.

---

## Practical Tips and Best Practices

- **Build GoogleTest as Part of Your Project**: Embedding GoogleTest using CMake `FetchContent` or subdirectory avoids runtime mismatch issues.
- **Use `gtest_main` if You Don't Need a Custom `main()`**: Let GoogleTest provide an entry point.
- **Pass Proper Compiler Flags**: Set `-std=c++17` or equivalent for your compiler.
- **For Visual Studio Builds**: Use `-Dgtest_force_shared_crt=ON` to align runtimes.
- **Check for Duplicate Symbols**: Avoid including GoogleTest implementation files directly in your tests.
- **Always Link `gmock` alongside `gtest` if Using GoogleMock**.
- **Use the Latest Compatible GoogleTest Release**: Older versions may not support modern compiler standards.

---

## Example: Minimal CMake Setup for GoogleTest

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTests CXX)

# Enable C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_test test_main.cpp my_tests.cpp)
target_link_libraries(my_test PRIVATE gtest_main gmock)
# Enable pthread on Unix (if needed)
if(UNIX AND NOT APPLE)
  target_link_libraries(my_test PRIVATE pthread)
endif()
```

Ensure your test source files include:
```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>  // if mocking
```

---

## Troubleshooting Checklist

**If you encounter compilation or linking errors:**

1. Verify that GoogleTest/GoogleMock headers are included correctly.
2. Confirm compiler supports C++17 or later.
3. Ensure all necessary libraries (`gtest`, `gtest_main`, `gmock`) are linked.
4. Confirm consistent runtime library settings (static vs dynamic CRT).
5. For CMake projects, use `FetchContent` or `find_package` to manage GoogleTest.
6. For Bazel, verify BUILD dependencies are correctly declared.
7. Avoid compiling GoogleTest implementation files multiple times.
8. Check if your build system rearranged or excluded test source files unintentionally.

---

## Additional Resources

- [GoogleTest Primer](primer.md) – for basic usage and test writing.
- [Building and Using GoogleTest with CMake](googletest/README.md) – detailed build instructions.
- [Parameterized and Typed Tests](core-concepts/test-foundations/parameterized-and-typed-tests.mdx) – for advanced test configurations.
- [Integration Overview](overview/features-and-integration/integration-overview.mdx) – for integration best practices.
- [Common Installation & Setup Issues](getting-started/troubleshooting-common-issues/common-installation-issues.mdx) – for setup problems.

---

Remember, most compilation and linking issues stem from misconfigured build setups or missing library references. Carefully following the build and integration guidelines eliminates these errors effectively.