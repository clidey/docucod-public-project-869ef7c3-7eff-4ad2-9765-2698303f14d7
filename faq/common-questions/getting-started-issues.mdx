---
title: "Getting Started and Setup Issues"
description: "Covers frequent obstacles users face during initial setup, including installation issues, build system support, linking errors, and the minimum requirements for building and running GoogleTest and GoogleMock. Provides guidance for CMake, Bazel, and troubleshooting abnormal build or runtime errors."
---

# Getting Started and Setup Issues

This page guides you through the most frequent obstacles faced during the initial setup of GoogleTest and GoogleMock. It focuses on installation challenges, build system compatibility, linking errors, and minimum platform and tool requirements necessary to successfully build and run your tests. Whether you use CMake, Bazel, or other build systems, this FAQ helps you diagnose and resolve common build and runtime errors to get you testing faster.

---

## 1. Installation Issues

### What are common problems during installation?

- Missing or incorrect C++ compiler version (C++17 minimum required).
- Threading library missing or misconfigured (e.g., pthread).
- CMake version below 3.14 causing build failures.
- Platform-specific toolchain quirks (Linux, Windows, Mac differences).

### How can I ensure my environment supports GoogleTest?

- Confirm C++17 support with your compiler (GCC, Clang, MSVC 2015+).
- Verify pthread is installed and linked on Unix-like systems.
- Use CMake 3.14 or newer for smooth integration.
- Refer to the [System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/system-requirements.md) page for detailed compatibility.

### What if the installation fails with linker errors?

- Check that you link against the correct libraries: `gtest`, `gmock`, and `gmock_main` for main
- On Unix, ensure to include `-lpthread`.
- Review your build scripts or CMakeLists.txt for missing target link commands.
- Confirm library search paths are set correctly.

<Tip>
When integrating GoogleTest and GoogleMock into an existing project, always prefer the provided `gmock_main` or `gtest_main` targets or libraries to avoid writing your own `main()` function unless necessary.
</Tip>

---

## 2. Build System Support and Integration

### How do I integrate GoogleTest with CMake?

- Use `FetchContent` or add `googletest` as a subdirectory.
- Link your test executable against `gtest` and `gmock_main`.
- Example snippet:

```cmake
find_package(GTest REQUIRED)
add_executable(my_tests test_main.cpp my_tests.cpp)
target_link_libraries(my_tests PRIVATE GTest::gtest GTest::gmock_main pthread)
```

- Follow detailed instructions in the [Installation Methods](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/installation-methods.md) guide.

### What about Bazel integration?

- Use the official Bazel `rules_cc` and GoogleTest Bazel build files.
- Declare dependencies on `@com_google_googletest//:gmock` and `@com_google_googletest//:gmock_main`.
- Configure tests in the `BUILD` files accordingly.

### Can I use GoogleTest in embedded or Arduino environments?

- Yes, GoogleTest supports platforms like ESP8266, ESP32, and NRF52.
- On such platforms, the test entry points are adapted to use `setup()` and `loop()` instead of `main()`.
- See special handling in `gmock_main.cc` and `gtest_main.cc` for details.

---

## 3. Linking Errors and Runtime Failures

### What causes "undefined reference to main" errors?

- You may not be linking against `gtest_main` or `gmock_main` which provide default `main()` implementations.
- To fix, link your test executable with `gtest_main` or `gmock_main` or provide your own `main()` that calls `InitGoogleTest()` / `InitGoogleMock()` and `RUN_ALL_TESTS()`.

### How to resolve "multiple definition of main" errors?

- Linking both `gtest_main` and your own `main()` causes conflicts.
- Use one or the other, not both.
- To customize behavior, write your own `main()` and link just `gtest` and `gmock` libraries.

### What if I see runtime errors related to threading or synchronization?

- Verify that you properly link against supported thread libraries (e.g., pthread on Linux/macOS).
- On Windows, ensure usage of compatible Visual Studio versions.
- Read the [System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/system-requirements.md) page for platform-specific notes.

---

## 4. Minimum Requirements for Building and Running

| Component         | Minimum Version/Requirement                |
|-------------------|--------------------------------------------|
| C++ Standard      | C++17 or higher                            |
| Compiler          | GCC 5+, Clang 3.8+, MSVC 2015 or later     |
| CMake             | 3.14+ (for CMake builds)                    |
| Thread Library    | pthread (required on Unix-like systems)    |
| Operating Systems | Linux, Windows, macOS                       |

### Why is C++17 required?

- GoogleTest and GoogleMock use C++17 language features to offer safer, cleaner APIs and better compiler diagnostics.

### What if my platform is not officially supported?

- GoogleTest aims for broad portability, but some platforms might need manual adjustments.
- Review the [Portability and Configuration](https://github.com/google/googletest/tree/main/docs/api-reference/integration-advanced/portability-configuration.md) documentation.

---

## 5. Troubleshooting Tips

### How can I quickly validate my installation?

- Write a minimal test and run it with `RUN_ALL_TESTS()`.
- Check output for successful test registration and execution.
- Follow the [Validating Your Setup](https://github.com/google/googletest/tree/main/docs/getting-started/troubleshooting-validation/validating-setup.md) guide.

### What to do when EXPECT_CALL or MOCK_METHOD cause compiler errors?

- Ensure your compiler supports the required C++ features.
- Verify correct syntax and macro usage.
- Use parentheses around template arguments with commas.
- Consult [Mock Methods and Fixtures](https://github.com/google/googletest/tree/main/docs/api-reference/mocking-framework/mock-methods.md).

### Common pitfalls with command line flags

- `InitGoogleTest()` and `InitGoogleMock()` consume their respective flags; unrecognized flags are left.
- Remove or adjust custom CLI flags that conflict with GoogleTest.

### What does `gmock_main` provide?

- The `gmock_main` library supplies a `main()` function that initializes both GoogleTest and GoogleMock.
- Linking to `gmock_main` frees you from writing a custom `main()`.
- Refer to `googlemock/src/gmock_main.cc` for the implementation.

---

## 6. Best Practices

- Prefer linking against `gmock_main` or `gtest_main` when possible.
- Always check and respect platform and compiler minimum requirements.
- For custom initialization or command line processing, write your own `main()` following the boilerplate in the [GoogleTest Primer](https://github.com/google/googletest/tree/main/docs/primer.md).
- Use CMake configurations and targets for maximum compatibility.
- Verify passed flags and test discovery after setup to ensure correctness.

---

## 7. Example: Minimal main.cpp Using gmock_main

```cpp
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);  // Initializes GoogleMock and GoogleTest
  return RUN_ALL_TESTS();                  // Runs all registered tests
}
```

Or simply link your test executable with `-lgmock_main` and omit writing this `main()`.

---

## 8. Additional Resources

- [System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/system-requirements.md)
- [Installation Methods](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/installation-methods.md)
- [Validating Your Setup](https://github.com/google/googletest/tree/main/docs/getting-started/troubleshooting-validation/validating-setup.md)
- [Configuring Your Project](https://github.com/google/googletest/tree/main/docs/getting-started/project-setup-first-run/configuring-project.md)
- [Writing & Running Your First Test](https://github.com/google/googletest/tree/main/docs/getting-started/project-setup-first-run/writing-running-first-test.md)

---

If you encounter unresolved issues, consult the [Troubleshooting Common Issues](https://github.com/google/googletest/tree/main/docs/getting-started/troubleshooting-validation/troubleshooting-common-issues.md) guide for deeper diagnostics and solutions.


# Summary

This documentation covers common setup and installation challenges when beginning with GoogleTest and GoogleMock. Key topics include handling installation errors, build system integration with CMake and Bazel, resolving linking problems, and meeting minimum platform requirements. Practical tips for quick validation, common pitfalls, and best practices to ensure smooth initial setup are provided along with example usage. Links to essential related documentation ensure users have resources to address setup hurdles and move confidently into writing and running tests.

**Key Sections:**
- Installation Issues
- Build System Support
- Linking Errors and Runtime Failures
- Minimum Requirements
- Troubleshooting Tips
- Best Practices
- Example main() Usage

**Important Links:**
- [System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/system-requirements.md)
- [Installation Methods](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/installation-methods.md)
- [Validating Your Setup](https://github.com/google/googletest/tree/main/docs/getting-started/troubleshooting-validation/validating-setup.md)
- [Configuring Your Project](https://github.com/google/googletest/tree/main/docs/getting-started/project-setup-first-run/configuring-project.md)
- [Troubleshooting Common Issues](https://github.com/google/googletest/tree/main/docs/getting-started/troubleshooting-validation/troubleshooting-common-issues.md)

**Cross-References:**
- For custom test entry points and flags, see [Main Functions and Initialization](https://github.com/google/googletest/tree/main/docs/api-reference/integration-advanced/main-entry-points.md).
- For mocking setup and syntax errors, see [Mock Methods and Fixtures](https://github.com/google/googletest/tree/main/docs/api-reference/mocking-framework/mock-methods.md).
- For runtime behavior configuration, see [Mock Behavior Controls](https://github.com/google/googletest/tree/main/docs/api-reference/mocking-framework/mock-behavior-controls.md).

**Next Steps:**
- Proceed to [Writing & Running Your First Test](https://github.com/google/googletest/tree/main/docs/getting-started/project-setup-first-run/writing-running-first-test.md) to create your initial tests.
- Explore [Mocking Best Practices](https://github.com/google/googletest/tree/main/docs/guides/mocking-best-practices/creating-mocks.md) for effective test doubles.
- Review [Running and Configuring Tests](https://github.com/google/googletest/tree/main/docs/guides/writing-tests/running-and-configuring-tests.md) for test execution control.
