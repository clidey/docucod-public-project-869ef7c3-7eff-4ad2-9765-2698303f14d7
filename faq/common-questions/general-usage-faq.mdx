---
title: "General Usage and Feature Questions"
description: "Answers the most typical questions about daily use, such as writing basic and parameterized tests, using assertions and matchers, mocking functions and classes, and verifying expectations. Clarifies when to use specific features and how to avoid misuse."
---

# General Usage and Feature Questions

This page addresses the most typical questions encountered daily when using GoogleTest and GoogleMock. It covers writing basic and parameterized tests, using assertions and matchers, mocking functions and classes, and verifying expectations. This FAQ aims to clarify when and how to use specific features correctly and how to avoid common misuse pitfalls.

---

## 1. Writing Basic and Parameterized Tests

### Q: How do I write a basic test using GoogleTest?

Use the `TEST` macro to define a test case and test name. Inside, write assertions to verify behavior. Example:

```cpp
TEST(MyTestSuite, MyTestCase) {
  int result = Add(2, 3);
  EXPECT_EQ(result, 5);
}
```

This runs the test case `MyTestCase` within suite `MyTestSuite`, checking if `Add` returns 5.

### Q: What is the difference between `TEST` and `TEST_F`?

- `TEST` defines a simple test without fixture.
- `TEST_F` defines a test using a **test fixture**—a class that sets up a common environment for multiple tests.

Use fixtures to share setup and teardown among tests:

```cpp
class MyFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    // Common setup code
  }
};

TEST_F(MyFixture, Test1) { ... }
TEST_F(MyFixture, Test2) { ... }
```

### Q: How do I write parameterized tests?

GoogleTest supports [value-parameterized and type-parameterized tests](https://google.github.io/googletest/advanced.html#value-parameterized-tests).

- Value-parameterized tests run the same logic with various input values.
- Type-parameterized tests run with different types.

Use the macros and interfaces provided, such as `INSTANTIATE_TEST_SUITE_P`. Refer to the [Parameterized Tests guide](guides/advanced-usage-integration/parameterized-typed-tests.md) for syntax and examples.


---

## 2. Assertions and Matchers

### Q: How do I verify conditions in tests?

GoogleTest provides various assertion macros:

- Basic assertions like `EXPECT_EQ`, `EXPECT_TRUE` for simple checks.
- `EXPECT_THAT` to use **matchers** for more expressive checks, e.g.: 

```cpp
EXPECT_THAT(value, ::testing::StartsWith("Hello"));
```

Use assertions to check test outcomes clearly. Refer to the [Assertions Reference](reference/assertions.md) for full details.

### Q: What are matchers and how do I use them?

Matchers check whether function arguments meet conditions during mocking or assertions. Use built-in matchers like `_` (wildcard), `Eq`, `Ge`, and combine them:

```cpp
using ::testing::_;
EXPECT_CALL(mock, Foo(Ge(5)));
```

Custom matchers can be defined for specialized needs. See the [Matchers Reference](reference/matchers.md) and [Custom Assertions and Matchers](concepts/extensibility-strategy/custom-assertions-matchers.md).


---

## 3. Mocking Functions and Classes

### Q: How do I define a mock class?

Derive from the interface or class to mock, then use `MOCK_METHOD` macros inside the `public:` section to mock each virtual method. Example:

```cpp
class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
};
```

Check `MOCK_METHOD` details and qualifiers in [Mocking Reference](reference/mocking.md#MOCK_METHOD).

### Q: How do I set expectations on mock methods?

Use `EXPECT_CALL(mock_object, Method(matchers...))` before exercising code:

```cpp
EXPECT_CALL(turtle, Forward(100))
    .Times(AtLeast(1))
    .WillOnce(Return());
```

GoogleMock will verify that the mock method is called as expected, with the right arguments and orders.

### Q: What if I want default behavior but no call expectation?

Use `ON_CALL(mock_object, Method(matchers...)).WillByDefault(action)` to specify default behavior without requiring calls.

### Q: Can I mock const methods or overloaded methods?

Yes. Mock const-qualified methods with `(const, override)` qualifier. Mock overloaded methods by defining each overload separately. Use `Const()` wrapper to disambiguate calls.

### Q: How is argument matching done in expectations?

By default, arguments are matched exactly; use matchers (`_`, `Ge()`, etc.) to specify flexible matching.

### Q: What about controlling call counts?

The `.Times()` clause on `EXPECT_CALL` specifies how many times a call should happen.

- `Times(0)` means should **never** be called.
- `AnyNumber()`, `AtLeast(n)`, `Between(m, n)` offer flexible cardinalities.

If omitted, gMock infers call counts from `WillOnce` and `WillRepeatedly` usage.

---

## 4. Verifying Expectations and Controlling Mock Behavior

### Q: What happens if a mock method is called unexpectedly?

- If it matches no `EXPECT_CALL` rule, gMock reports an **unexpected call** failure.
- If called without any expectation set, but you have specified `ON_CALL`, the default action runs with a warning.

### Q: What is the difference between uninteresting, unexpected, and excessive calls?

- **Uninteresting call**: mock method with no expectation; allowed but warns by default.
- **Unexpected call**: mock method has expectations, but current call doesn’t match any — treated as error.
- **Excessive call**: mock method is called more times than the cardinality allows — error reported, default action executed.

### Q: How do I suppress warnings about uninteresting calls?

Use `NiceMock<MockClass>` wrapper to suppress warnings on uninteresting calls. Use `StrictMock<MockClass>` to treat uninteresting calls as errors.

### Q: How do I enforce call order?

Use the `InSequence` class or `.InSequence()` clause on `EXPECT_CALL` to require calls happen in a strict order:

```cpp
{
  InSequence seq;
  EXPECT_CALL(mock, FirstCall());
  EXPECT_CALL(mock, SecondCall());
}
```

Partial orderings can be built with multiple sequences or `.After()` clauses.

### Q: Can I have expectations retire once saturated?

Yes. Use `.RetiresOnSaturation()` on an `EXPECT_CALL` to make it inactive once the call count reaches the expected upper bound.

### Q: How do I verify and clear expectations manually?

Use `Mock::VerifyAndClearExpectations(&mock)` to verify expectations early; use `Mock::VerifyAndClear(&mock)` to verify and clear default actions as well.


---

## 5. Common Misuse and Understanding Errors

### Q: Why do I see warnings "Uninteresting mock function call" despite setting `ON_CALL`?

`ON_CALL` defines default action, not expectation. If you want to explicitly allow calls without warning, add a catch-all `EXPECT_CALL(mock, Method(_)).Times(AnyNumber())` or use a `NiceMock`.

### Q: Why does gMock match expectations in reverse order?

Later `EXPECT_CALL`s override earlier ones, enabling you to set default expectations first and specialize them later.

### Q: Why are some expectations "sticky" and causing upper bound errors?

By default, expectations remain active after saturation, to avoid surprises. Use `.RetiresOnSaturation()` or sequences to avoid this.

### Q: How do I handle mocks of classes without virtual destructors?

Always ensure the mocked base class has a virtual destructor to avoid undefined behavior and leaks.

### Q: How do I handle move-only types in mock methods?

Use the new `MOCK_METHOD` syntax with move-only types as usual. To return or accept move-only objects, use lambdas or functors in actions rather than `Return()`.

### Q: What's the difference between `EXPECT_CALL` and `ON_CALL`?

- `EXPECT_CALL` sets an expectation the method **will be called**.
- `ON_CALL` sets default behavior when a method **is called**, but does not expect the call.

Rely primarily on `ON_CALL` unless you want to verify call occurrences.


---

## 6. Advanced Usage Tips

### Q: How can I mock free (non-member) functions?

Wrap free functions in interfaces and mock the interface methods.

### Q: Can I delegate mock method calls to a real or fake implementation?

Yes. For example, specify `ON_CALL(mock, Method).WillByDefault([&real](args) { return real.Method(args); });` to forward calls.

### Q: How can I define custom matchers or actions?

Use `MATCHER`, `MATCHER_P*` macros or implement matcher classes. Use lambdas or define your own action classes for custom actions. See the [Matchers Reference](reference/matchers.md) and [gMock Cookbook](guides/mocking-best-practices/actions-matchers.md).

### Q: How to deal with overloaded methods in mocks?

Disambiguate using qualifiers and wrappers like `Const()` in expectations.

Example:

```cpp
EXPECT_CALL(Const(mock), Method(args));
```

### Q: How to handle mock method argument match failures?

Run tests with `--gmock_verbose=info` to get detailed traces of matching, including arguments and which expectation was matched or failed.

### Q: How to test mock calls invoked from multiple threads?

Set expectations and default actions before starting threads. gMock is thread-safe for calls, but setting expectations concurrently with calls is undefined behavior.


---

## 7. Troubleshooting Common Problems

<AccordionGroup title="Common Troubleshooting Topics">
<Accordion title="Uninteresting Calls and Warnings">
By default, uninteresting calls produce warnings. Use `NiceMock` to silence them or add catch-all `EXPECT_CALL(...).Times(AnyNumber())`.
</Accordion>
<Accordion title="Upper Bound Violations">
Check that the `Times()` matches number of calls. Use `.RetiresOnSaturation()` or sequences to avoid excessive call errors.
</Accordion>
<Accordion title="Unexpected Calls">
Verify argument matchers are correct. Use `--gmock_verbose=info` to trace calls and expected calls.
</Accordion>
<Accordion title="Mock Methods Not Being Called">
Make sure expectations are set before calls. Use proper matchers to match arguments.
</Accordion>
<Accordion title="Compilation Issues with MOCK_METHOD">
Use parentheses around argument types with commas. Check qualifiers (`const`, `override`, etc.) match base methods.
</Accordion>
</AccordionGroup>

---

## 8. Additional Tips and Best Practices

- Always set expectations prior to exercising mock objects.
- Avoid over-specifying arguments; use `_` and matchers leniently to make tests resilient.
- Use `InSequence` and `.After()` to enforce call order when needed.
- Clean up mocks to verify expectations manually when objects persist beyond test scope.
- Use `Mock::AllowLeak()` if you deliberately leak a mock object.


---

## 9. References and Related Pages

- [Mocking for Dummies guide](gmock_for_dummies.md)
- [Mocking Reference](reference/mocking.md)
- [Matchers Reference](reference/matchers.md)
- [Assertions Reference](reference/assertions.md)
- [gMock Cookbook](guides/mocking-best-practices/actions-matchers.md)
- [Setting Expectations guide](guides/mocking-best-practices/defining-expectations.md)
- [Controlling Mock Strictness](guides/mocking-best-practices/mock-strictness-modes.md)


---

For further workflow tips and troubleshooting, see the [Common Questions in FAQ](faq/common-questions/getting-started-issues.md) and [Troubleshooting Common Issues](getting-started/troubleshooting-validation/troubleshooting-common-issues.md).

<Role> Happy mocking and testing!
