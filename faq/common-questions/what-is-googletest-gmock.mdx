---
title: "What is GoogleTest and GoogleMock?"
description: "Get an overview of what GoogleTest and GoogleMock are, how they fit together, and why you might use them for C++ testing. Learn about the core capabilities and typical workflows supported by these frameworks."
---

# What is GoogleTest and GoogleMock?

GoogleTest and GoogleMock are foundational frameworks used in C++ development for writing robust, repeatable tests with support for mocking dependencies. This page provides an overview of these frameworks, how they interrelate, and the core capabilities and workflows they enable for C++ testing.

---

## Overview of GoogleTest

GoogleTest is a C++ testing framework developed by Google to help write better, faster, and more maintainable tests across platforms. It supports all types of tests, from simple unit tests to complex integration tests, ensuring tests are independent, repeatable, well-organized, and informative on failure. GoogleTest is designed to fit naturally into C++ development environments on Linux, Windows, and macOS.

## Overview of GoogleMock

GoogleMock (often referred to as gMock) is Google's framework for creating mock objects in C++. Mock objects are simulated versions of real objects that allow you to verify interactions and isolate your tests from external dependencies. gMock makes it easy to define mocks, set expectations, and control their behavior, turning the typically tedious task of writing mocks into an intuitive experience.

Together, GoogleTest and GoogleMock offer a powerful combination for testing C++ code:

- GoogleTest handles the framework and structure for test execution and assertions.
- GoogleMock provides tools to mock dependencies, set expectations, and verify interactions within tests.

---

## Why Use GoogleTest and GoogleMock?

When testing C++ code, especially large or complex systems, dependencies can be difficult to work with directly due to resource costs, external factors, or lack of predictability. Using mocks improves test speed, reliability, and clarity by allowing you to:

- Replace costly or fragile dependencies with mocks.
- Precisely specify which methods are called, with what arguments, and how often.
- Confirm the order of interactions between objects.
- Simulate error conditions that are hard to reproduce using real objects.
- Improve test isolation and diagnose failures more easily.

GoogleMock is specifically designed to address C++ language features and constraints, inspired by similar frameworks in other languages, but tailored for C++'s unique needs.

---

## Core Concepts

### Mock Objects

A mock object is a simulated class that implements the same interface as a real object but allows you to specify runtime expectations and behaviors. Using mocks, you can test not only the state but also interactions between components.

### Mock Class Definition

Defining a mock class involves inheriting from the interface or base class and using the `MOCK_METHOD` macro to specify virtual functions to be mocked. These methods will be implemented automatically by GoogleMock.

```cpp
#include <gmock/gmock.h>

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(void, Turn, (int degrees), (override));
  MOCK_METHOD(void, GoTo, (int x, int y), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
  MOCK_METHOD(int, GetY, (), (const, override));
};
```

### Setting Expectations with `EXPECT_CALL`

`EXPECT_CALL` is used to declare that a mock method will be called with specified arguments.

```cpp
EXPECT_CALL(mock_object, MethodName(Matcher1, Matcher2))
    .Times(AtLeast(1))
    .WillOnce(Return(value));
```

- **Matchers** can be specific values or wildcards.
- **Times()** controls how often the method is expected to be called.
- **WillOnce() / WillRepeatedly()** specify return values or actions.

Expectations must be set before the calls happen to enable immediate failure reporting.

### Controlling Mock Strictness

GoogleMock provides wrappers to control how mocks handle uninteresting calls (calls without explicit expectations):

- **NiceMock**: Suppresses warnings on uninteresting calls.
- **NaggyMock**: Warns on uninteresting calls (default behavior).
- **StrictMock**: Treats uninteresting calls as errors, failing the test.

Example:

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> nice_mock;
```

---

## Typical Workflow

1. **Define a Mock Class:** Use `MOCK_METHOD` to declare mock implementations for virtual methods in the interface.
2. **Create Mock Objects:** Instantiate mock classes in your tests.
3. **Set Expectations:** Use `EXPECT_CALL` to specify the methods expected to be called, their arguments, call count, order, and behavior.
4. **Run Code Under Test:** Exercise the functionality being tested with the mock supplied.
5. **Verification:** GoogleMock automatically checks if expectations are met when mocks are destructed, reporting any mismatches.

---

## Key Features Explained

### MOCK_METHOD Macro

Defines a mock method in a mock class.

Usage:
```cpp
MOCK_METHOD(ReturnType, MethodName, (Args...), (Qualifiers));
```
Qualifiers can include `const`, `override`, `noexcept`, and calling conventions.

### EXPECT_CALL Macro

Declares expectations on methods, including argument matchers and invocation rules.

Key clauses:
- `.Times()` to quantify calls
- `.WillOnce()` and `.WillRepeatedly()` to customize return values or side effects
- `.InSequence()` and `.After()` to impose ordering constraints
- `.RetiresOnSaturation()` to deactivate expectations after limits

Example:
```cpp
EXPECT_CALL(mock, Compute(_))
    .Times(3)
    .WillOnce(Return(1))
    .WillRepeatedly(Return(2));
```

### ON_CALL

Defines default behavior of mocks without setting call expectations. Useful for setting general fallback behavior.

---

## Practical Tips and Best Practices

- **Define expectations before exercising mock behaviors.** Setting expectations after the mock is called leads to undefined behavior.
- **Use matchers to specify only what you actually care about.** Overly strict expectations cause brittle tests.
- **Utilize StrictMock sparingly.** While useful for catching unexpected calls, it can make tests fragile.
- **Control call ordering when necessary.** Use `InSequence` or `After` to enforce method call order.
- **Delegate to Fakes or Real Objects when partial behavior is needed.** You can forward calls inside mocks to existing implementations.
- **Use `RetiresOnSaturation()` to simplify complex call pattern verification.** It removes expectations once saturated.
- **Leverage `NiceMock` during test development to reduce noise.** Switch to stricter mocks for final verification.

---

## Common Scenarios Illustrated

### Mocking an Interface

```cpp
class MockDatabase : public DatabaseInterface {
 public:
  MOCK_METHOD(bool, Connect, (const std::string& url), (override));
  MOCK_METHOD(void, Disconnect, (), (override));
};
```

### Setting Expectations

```cpp
using ::testing::Return;
MockDatabase db;
EXPECT_CALL(db, Connect("db_url"))
    .Times(1)
    .WillOnce(Return(true));

// Code under test uses db.Connect("db_url")
```

### Controlling Call Order

```cpp
using ::testing::InSequence;
{
  InSequence s;
  EXPECT_CALL(db, Connect(_));
  EXPECT_CALL(db, Disconnect());
}
```

---

## Where GoogleTest and GoogleMock Fit Together

- GoogleTest handles test discovery, reporting, assertions, and test lifecycle management.
- GoogleMock extends GoogleTest by enabling interaction-based testing through mocks.

This page introduces you to their synergy, while detailed API references, guides, and recipes are available for deep dives into specific features:

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) – Beginner-friendly intro to mocking
- [Mocking Reference](reference/mocking.md) – Detailed API reference on mocks
- [gMock Cookbook](gmock_cook_book.md) – Practical recipes
- [gMock Cheat Sheet](gmock_cheat_sheet.md) – Quick reference

---

## Troubleshooting and Support

Common issues like missing virtual destructors, unexpected call warnings, or failure to satisfy expectations can be diagnosed with verbose logging (`--gmock_verbose=info`). Ensure that mock methods are virtual and that expectations are set before exercising the mocks.

For support, consult the community forums and official documentation linked in the summary.

---

## Summary

GoogleTest and GoogleMock together offer a comprehensive environment for automated C++ testing with powerful mocking capabilities that facilitate both state-based and interaction-based testing.

Use GoogleTest to organize tests and assert conditions, and GoogleMock to create mocks that specify and verify expected interactions.

This page outlines the conceptual overview, core capabilities, typical user workflows, and best practices to get you started with these frameworks effectively.


<AccordionGroup title="Key Concepts at a Glance">
<Accordion title="Mock Creation with MOCK_METHOD">
Use the `MOCK_METHOD` macro to define mock methods in your subclass of the interface or base class. It replaces writing verbose mock implementations.
</Accordion><Accordion title="Setting Expectations with EXPECT_CALL">
`EXPECT_CALL` lets you specify which methods should be called, with what arguments, how many times, and what they return or do.
</Accordion><Accordion title="Mock Strictness Types">
Choose between `NiceMock`, `NaggyMock` (default), and `StrictMock` to control uninteresting call warnings and failures.
</Accordion><Accordion title="Using ON_CALL for Defaults">
Use `ON_CALL` to specify default mock method behaviors without setting call expectations.
</Accordion><Accordion title="Ordering Calls">
Sequence calls using `InSequence` or `After` to enforce call order for interaction verification.
</Accordion></AccordionGroup>

<Tip>
The most convenient way to get started is to first write your mock using `MOCK_METHOD`, then use `EXPECT_CALL` to set expectations, and finally run your tests using GoogleTest's `RUN_ALL_TESTS()`.
</Tip>

<Note>
Always declare and define a virtual destructor in interfaces you mock to ensure proper behavior and test reliability.
</Note>

<Warning>
Do not set expectations post invocation of mock methods; this can cause undefined behavior and confusing test outcomes.
</Warning>

---

## Additional Resources and Next Steps

- Explore the [GoogleTest Primer](primer.md) to learn test writing basics.
- Read [gMock for Dummies](gmock_for_dummies.md) for an approachable introduction to mocking.
- Use the [Mocking Reference](reference/mocking.md) for detailed API guidance.
- Consult the [gMock Cookbook](gmock_cook_book.md) for advanced mocking patterns.
- Review the [Nice, Naggy, and Strict Mocks](reference/mocking.md#NiceStrictNaggy) section for strictness control best practices.

---

## Illustration: How GoogleTest and GoogleMock Work Together

```mermaid
flowchart TD
  A[Write Test Cases & Setup Fixtures] --> B[Define Mock Classes using MOCK_METHOD]
  B --> C[Set Expectations with EXPECT_CALL/ON_CALL]
  C --> D[Run Tested Code with Mocks Injected]
  D --> E{Method Called on Mock}
  E -->|Matches Expectations| F[Invoke Specified Action (Return/Side Effect)]
  E -->|Violates Expectations| G[Report Failure Immediately]
  F --> H[Verify Expectations After Test Completion]
  H --> I{All Expectations Met?}
  I -->|Yes| J[Test Passes]
  I -->|No| K[Test Fails with Details]
```

This flow highlights:
- Test and mock preparation
- Runtime expectation matching
- Immediate failure reporting for deviations
- Final verification on test teardown

---