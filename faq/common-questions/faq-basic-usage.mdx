---
title: "How do I write and run my first test or mock?"
description: "A simple guide to creating your first test and mock class, running tests, and viewing outputs. Focuses on the essential test and mock class creation patterns with actionable code snippets."
---

# How do I write and run my first test or mock?

Welcome to your initial journey in writing and running tests with GoogleTest and GoogleMock! This guide provides clear, actionable steps to help you create your first test case and mock class, run your tests, and understand the outputs. Whether you’re aiming to verify simple functionality or isolate components with mocks, this page shows you the essential patterns and practical examples to get started.

---

## Writing Your First Test

Writing tests in GoogleTest is straightforward. You define tests using macros and assertions that describe what code you expect to run and what results you expect.

### Basic Test Syntax

Use the `TEST` macro to declare a test function:

```cpp
#include <gtest/gtest.h>

TEST(TestSuiteName, TestName) {
  // Arrange

  // Act

  // Assert
  EXPECT_EQ(1 + 1, 2);
}
```

- **TestSuiteName**: Groups related tests.
- **TestName**: Identifies the individual test.

### Running the Test

Build your test executable and run it from the terminal or your IDE. Successful tests print summaries indicating success. Failed tests show detailed messages to help diagnose what went wrong.

### Interpreting Test Results

- On success, you see messages like:
  ```
  [ RUN      ] TestSuiteName.TestName
  [       OK ] TestSuiteName.TestName (0 ms)
  ```
- On failure, GoogleTest reports:
  - The line number and file where the assertion failed
  - The expected and actual values

### Example: First Test

```cpp
#include <gtest/gtest.h>

TEST(ArithmeticTest, Addition) {
  EXPECT_EQ(2, 1 + 1);  // Verify 1 + 1 equals 2
}
```

This test passes if `1 + 1` is equal to `2` and fails otherwise.

---

## Creating Your First Mock Class

Mocks let you simulate and control behavior of dependencies, verifying how your code interacts with other components. GoogleMock helps automate the creation of mock classes.

### Defining a Mock Class

1. **Identify the interface to mock**. It should have virtual methods.
2. **Create a mock class that inherits from it.**
3. **Use the `MOCK_METHOD` macro** to define mocked methods.

### Basic Mock Class Example

Suppose you have an interface `Turtle`:

```cpp
class Turtle {
 public:
  virtual ~Turtle() = default;
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
  virtual int GetX() const = 0;
};
```

The mock class would be:

```cpp
#include <gmock/gmock.h>

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

### Notes

- Put `MOCK_METHOD` declarations in the `public:` section regardless of base method access.
- Add `(const, override)` if mocking a const method.

---

## Setting Expectations and Default Behaviors

Once your mock class is ready, you specify expectations on method calls using `EXPECT_CALL` and default behaviors using `ON_CALL`.

### EXPECT_CALL

Sets an expectation that a method will be called with specific arguments and how many times.

Example:

```cpp
using ::testing::_;  // wildcard matcher
using ::testing::Return;

MockTurtle turtle;
EXPECT_CALL(turtle, Forward(100))  // Expect Forward(100) call
    .Times(1);
```

### ON_CALL

Defines default behavior without expectations.

Example:

```cpp
ON_CALL(turtle, GetX())
    .WillByDefault(Return(42));  // When GetX() is called, return 42
```

### Using Actions

You can specify what the mock method should do when called:

- `Return(value)` to return a value.
- Lambdas or callable objects.

Example:

```cpp
EXPECT_CALL(turtle, GetX())
    .WillRepeatedly(Return(10));
```

or

```cpp
EXPECT_CALL(turtle, Forward(_))
    .WillOnce([](int dist) {
      // custom action
    });
```

---

## Running Your Test Suite

Build your test executable and **run it** in your environment.

### Command line

By default, simply execute the binary:

```
./my_test_executable
```

### Test Filtering

Run a subset of tests:

```
./my_test_executable --gtest_filter=TestSuiteName.TestName
```

### Test Output

- Passed tests print `[  PASSED  ]` lines
- Failed tests show detailed failure information

See [Running and Configuring Test Suites](/guides/writing-tests/running-and-configuring-tests) for more details on filtering, shuffling, repeating, and XML output.

---

## Practical Example: Writing and Running Your First Test and Mock

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

// Step 1: Define an interface.
class Widget {
 public:
  virtual ~Widget() = default;
  virtual int GetValue() const = 0;
  virtual void SetValue(int value) = 0;
};

// Step 2: Define a mock class.
class MockWidget : public Widget {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
  MOCK_METHOD(void, SetValue, (int value), (override));
};

// Step 3: Write test using the mock.
TEST(WidgetTest, SetValueThenGetValue) {
  MockWidget mock;

  // Set default behavior: GetValue returns 123.
  ON_CALL(mock, GetValue())
      .WillByDefault(testing::Return(123));

  // Expect SetValue to be called once with value 42.
  EXPECT_CALL(mock, SetValue(42))
      .Times(1);

  // Use the mock.
  mock.SetValue(42);
  EXPECT_EQ(mock.GetValue(), 123);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile and run this test. It verifies that `SetValue(42)` is called once, and `GetValue()` returns the default 123.

---

## Tips and Best Practices

- **Set expectations before exercising the mock object.**
- Use `_` wildcard matcher to ignore arguments you don't care about.
- Use `NiceMock` to suppress warnings from uninteresting calls.
- Use sequences (`InSequence`) when call order matters.
- Avoid overly strict expectations; verify only behavior relevant to the test.
- Use `RetiresOnSaturation()` if you want expectations to retire after usage.

---

## Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Your First Test and Mock">
  <Accordion title="Why is my mock method not called as expected?">
    Make sure:
    - You set `EXPECT_CALL` before invoking the code that calls the mock method.
    - Argument matchers are correct; if unsure, try `_` wildcard.
    - The mocked method is virtual, and `MOCK_METHOD` matches the signature correctly.
  </Accordion>
  <Accordion title='My test fails with "Unexpected mock function call" message.'>
    Check if:
    - There is an `EXPECT_CALL` matching the arguments.
    - Calls occur in the expected order if you use sequences.
    - You are not making calls to the mock after its lifetime has ended.
    Use the `--gmock_verbose=info` flag to get detailed call trace.
  </Accordion>
  <Accordion title="How do I suppress warnings for uninteresting calls?">
    Use `NiceMock<YourMockClass>` instead of `YourMockClass`. It suppresses warnings about calls without expectations.
  </Accordion>
  <Accordion title="I want to return different values on successive calls. How?">
    Chain `WillOnce()` calls:

    ```cpp
    EXPECT_CALL(mock, GetData())
        .WillOnce(Return(1))
        .WillOnce(Return(2))
        .WillRepeatedly(Return(3));
    ```

    This returns 1 on the first call, 2 on the second, and 3 for all later calls.
  </Accordion>
</AccordionGroup>

---

## Getting Help and Resources

- **gMock for Dummies:** [https://google.github.io/googletest/gmock_for_dummies.html](https://google.github.io/googletest/gmock_for_dummies.html)
- **gMock Cookbook:** [https://google.github.io/googletest/gmock_cook_book.html](https://google.github.io/googletest/gmock_cook_book.html)
- **Mocking Reference:** [docs/reference/mocking.md](docs/reference/mocking.md)
- **GoogleTest Primer:** [https://google.github.io/googletest/primer.html](https://google.github.io/googletest/primer.html)
- **Writing and Running Tests Guide:** [/guides/writing-tests/test-primer](guides/writing-tests/test-primer)

For community help, bug reports, and contributions, see **Support & Community Resources** in the FAQ section.

---

## Summary

Writing and running your first test with GoogleTest involves using the `TEST` macro and assertion functions to verify your code behavior. To isolate components or simulate dependencies, create mock classes using `MOCK_METHOD` macros and set method expectations using `EXPECT_CALL` and default behaviors with `ON_CALL`. Run your tests directly, inspect outputs for success and failures, and use advanced features like sequences and actions for precise control.

With practice, you’ll leverage these fundamental patterns to write robust, maintainable tests that improve software quality and developer confidence.

---

## Next Steps

- Explore **Writing Your First Test Case** for detailed test writing patterns.
- Dive into **Mocking Your First Class** to understand mock creation and usage.
- Learn about **Using Assertions Effectively** to write precise validation logic.
- Check out **Running and Configuring Test Suites** to customize test execution.
- Visit the **gMock Cookbook** and **Mocking Reference** for advanced mock patterns.

---

<Callout type="Tip">
To accelerate your learning, combine these basic steps with interactive coding and real-world examples. Avoid over-specifying mocks early; keep tests focused and concise.
</Callout>

---