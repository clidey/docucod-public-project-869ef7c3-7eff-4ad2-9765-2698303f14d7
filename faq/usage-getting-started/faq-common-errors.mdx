---
title: "What are the most common errors and how can I fix them?"
description: "Answers troubleshooting queries for frequent errors encountered during setup, compilation, and test execution. Offers practical steps for diagnosing and resolving these issues efficiently."
---

# What are the most common errors and how can I fix them?

This guide addresses frequent errors users encounter when setting up, compiling, or running tests with GoogleTest and GoogleMock. By understanding these common problems and their solutions, you can diagnose issues faster and maintain a productive testing workflow.

---

## 1. Compilation Errors

### Missing Headers or Include Paths
- **Problem:** Compiler cannot find `gtest/gtest.h` or `gmock/gmock.h` headers.
- **Cause:** GoogleTest and GoogleMock include paths are not added to your project or build system.
- **Solution:**
  - Verify your build configuration adds the correct include directories.
  - For CMake, link the targets properly and use `target_include_directories()`.
  - Confirm the installed package paths match your include paths.

### Linker Errors
- **Problem:** Undefined references to GoogleTest or GoogleMock symbols at link time.
- **Cause:** Missing linking with GoogleTest/GoogleMock libraries.
- **Solution:**
  - Link against the appropriate libraries: `gtest`, `gtest_main`, `gmock`, and `gmock_main` as needed.
  - Verify library search paths.

### Macro or Symbol Conflicts
- **Problem:** Name clashes due to macros defined by system headers (e.g., Windows API).
- **Cause:** Windows headers or other third-party headers may define macros conflicting with GoogleTest macros.
- **Solution:**
  - Define `NOMINMAX` or other preprocessor flags to limit Windows macros.
  - Include GoogleTest headers before system headers where practical.
  - Use namespace-scoped names or alias imports cautiously to avoid conflicts.

---

## 2. Runtime Failures

### Tests Not Being Discovered or Run
- **Problem:** Tests compile but do not execute.
- **Cause:**
  - Missing or incorrect `main()` function for test discovery.
  - Improper test registration.
- **Solution:**
  - Use `gtest_main` or `gmock_main` libraries to provide a main().
  - Initialize GoogleTest properly with `testing::InitGoogleTest(&argc, argv);`.
  - Check test macros (`TEST`, `TEST_F`) are properly used.

### Mock Function Called Without EXPECT_CALL
- **Problem:** Warning about "Uninteresting function call" or test failure due to unexpected mock calls.
- **Cause:** Mock method called without an associated `EXPECT_CALL`.
- **Solution:**
  - Add an `EXPECT_CALL` or an `ON_CALL` specifying the default behavior.
  - Use `NiceMock` to suppress warnings for uninteresting calls if appropriate.
  - Explicitly block calls by using `.Times(0)` if a method should never be called.

### Mismatched Expectation Arguments
- **Problem:** Test failure messages indicating argument mismatch.
- **Cause:** Passed arguments do not match expected matchers/values.
- **Solution:**
  - Review your matchers and arguments in `EXPECT_CALL` statements.
  - Use the `--gmock_verbose=info` flag to get detailed tracing of calls.
  - Simplify matchers or adjust them to match actual usage.

### Test Failures Due to Ordering
- **Problem:** Calls happen out of order, causing failures when sequences are used.
- **Cause:** `InSequence` or `.After()` clauses specify ordering that isn’t met.
- **Solution:**
  - Verify the order of expected calls matches the code under test.
  - Use sequences judiciously only when ordering matters.
  - Use plain expectations without ordering if order doesn't matter.

---

## 3. Mocking Pitfalls

### Not Mocking Virtual Methods
- **Problem:** Real object methods are invoked instead of mock methods.
- **Cause:** Mocked methods are not declared `virtual` in the base class.
- **Solution:**
  - Confirm methods you want to mock are virtual in the interface.
  - For non-virtual methods, consider template-based injection as described in the cookbook.

### Improper Use of `MOCK_METHOD`
- **Problem:** Compilation errors about wrong syntax or argument parsing.
- **Cause:** Commas inside argument types confuse the macro parser.
- **Solution:**
  - Wrap complex argument types containing commas in extra parentheses.
  - Define type aliases and use the aliases instead.

### Forgetting to Put Mock Methods in `public:`
- **Problem:** `EXPECT_CALL` or `ON_CALL` isn’t able to access mocked methods.
- **Cause:** Mock methods declared in `protected:` or `private:` sections.
- **Solution:**
  - Always place `MOCK_METHOD` declarations in the `public:` section, even if the original method is protected or private.

### Confusing Uninteresting vs Unexpected Calls
- **Problem:** Receiving warnings or failures but unsure why.
- **Cause:** Uninteresting calls happen when there’s no `EXPECT_CALL`. Unexpected calls occur if `EXPECT_CALL`s exist but arguments don’t match.
- **Solution:**
  - Use `NiceMock` to suppress uninteresting warnings.
  - Add catch-all `EXPECT_CALL` with `.Times(AnyNumber())` if other calls are permissible.
  - Use `--gmock_verbose=info` to trace matching decisions.

### Leaking Mock Objects
- **Problem:** Heap checker reports leaks or you observe tests passing without verification.
- **Cause:** Mock objects created with `new` but never deleted or verified.
- **Solution:**
  - Ensure mocks' lifetime is managed and delete them properly.
  - Use `Mock::VerifyAndClearExpectations(&mock_obj)` for manual verification.
  - Use `Mock::AllowLeak(&mock_obj)` if intentional.

---

## 4. Debugging and Diagnostic Tips

### Use Verbosity Flags
Run tests with:
```bash
--gmock_verbose=info
```
to produce detailed logs of mock calls, matching expectations, and stack traces.

### Enable Stack Trace Depth
Use:
```bash
--gtest_stack_trace_depth=10
```
to control how many stack frames are shown in failure messages.

### Check Mock Strictness
GoogleMock supports `NiceMock`, `NaggyMock`, and `StrictMock`:
- `NiceMock<T>` suppresses warnings for uninteresting calls.
- `NaggyMock<T>` (default today) warns on uninteresting calls.
- `StrictMock<T>` treats uninteresting calls as test failures.
Use the appropriate strictness to catch possible issues early or reduce noise.

### Use RetiresOnSaturation()
When expecting a sequence of calls that should be matched in order and retired once done, add `.RetiresOnSaturation()` to avoid "sticky" expectations blocking later calls.

### Verify Expectations Early
In complex tests, call:
```cpp
EXPECT_TRUE(Mock::VerifyAndClearExpectations(&mock_obj));
```
to verify and clear expectations before the mock object's destruction.

---

## 5. Summary of Common Fixes

| Symptom                              | Likely Cause                          | Fix Summary                               |
|------------------------------------|-------------------------------------|-------------------------------------------|
| Compile error: missing header       | Missing include paths                | Add correct include paths                  |
| Link error: undefined reference     | Missing linked libraries             | Link to `gtest`, `gmock`, `gmock_main`    |
| Warning: function macro conflict    | Windows or system macros override   | Define `NOMINMAX` or include gmock first  |
| Test not running or no output        | Missing main() or faulty setup       | Link `gtest_main` or provide main()        |
| Warning: uninteresting call          | No `EXPECT_CALL` for method          | Add `EXPECT_CALL`, or use `NiceMock`      |
| Failure: unexpected call             | Call does not match expectations    | Adjust matchers or expectations           |
| Failure: call ordering               | Use of sequences/order clauses       | Check call order and `InSequence` blocks  |
| Mock calls real methods              | Methods not virtual                   | Make base class methods virtual             |
| Mock method not accessible           | Mock method in non-public area       | Declare mock methods `public`               |
| Leaked mocks causing no verification | Mock object not deleted or verified  | Delete mocks or call `VerifyAndClear`      |

---

## 6. Additional Resources

- [GoogleTest Primer](../docs/primer.md) - Basics of writing tests
- [Mocking Basics](../guides/core-workflows/mocking-basics) - How to create mocks and expectations
- [gMock Cookbook](docs/gmock_cook_book.md) - Recipes for advanced mocking
- [gMock FAQ](docs/gmock_faq.md) - Frequently asked questions about mocking
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md) - Quick reference for mocking macros, matchers, and actions
- [Troubleshooting Common Issues](../getting-started/troubleshooting-validation/common-issues) - More detailed troubleshooting

<Tip>
Always set your mock expectations before exercising the code under test. Use verbose logging to identify mismatches and ordering issues rapidly.
</Tip>

<Note>
If you encounter build issues related to C++ standards or compiler versions, ensure you meet minimum requirements: C++17 compatible compiler (GCC 7+, MSVC 2015+, Clang).
</Note>

<Warning>
Do not ignore warnings about uninteresting or unexpected calls; they often indicate real issues in your tests that can cause false positives or brittle tests.
</Warning>

---

Feel free to consult the related documentation pages linked above for comprehensive guidance and examples on fixing common errors efficiently.
