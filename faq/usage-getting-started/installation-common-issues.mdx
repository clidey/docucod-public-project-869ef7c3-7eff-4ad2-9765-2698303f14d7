---
title: "Installation & Build Issues"
description: "Addresses frequent problems users encounter while setting up GoogleTest/GoogleMock, such as compiler requirements, C++ standard compatibility, build tool errors, and linking test binaries. Provides actionable guidance and clarifies minimum requirements."
---

# Installation & Build Issues

This page addresses frequent problems users encounter while setting up GoogleTest and GoogleMock, focusing on compiler requirements, C++ standard compatibility, build tool errors, and linking test binaries. It provides actionable guidance and clarifies the minimum requirements to help you successfully build and integrate these libraries into your project.

---

## Minimum Compiler and C++ Standard Requirements

GoogleTest and GoogleMock require a modern C++ compiler with support for at least the C++17 standard.

- **Compiler versions**: Ensure your compiler version matches or exceeds the following:
  - GCC 7 or higher
  - Clang 5 or higher
  - MSVC 2017 (version 15.7) or higher
- **C++ standard flag**: Your build system must set the compiler to use `-std=c++17` or an equivalent.

> Attempting to build with older compiler versions or lower C++ standards will lead to build failures or unexpected behavior.

## Common Build Failures and Their Fixes

### 1. Compiler Flags and Runtime Library Mismatch

GoogleTest's CMake macros actively configure compiler and linker flags for compatibility:

- When building statically, the runtime library flags must be consistent (e.g., MSVC's `/MT` vs `/MD`).
- The build scripts replace default `/MD` with `/MT` in static builds to avoid runtime conflicts.

**Issue:** Receiving multiple runtime library conflicts or linker errors about duplicate symbols.

**Action:**
- Ensure you are not mixing static and shared runtimes inconsistently.
- Verify that CMake's build configuration respects the default compiler flags.
- If you forcibly change flags in your build system, harmonize them with GoogleTest's expectations.

### 2. Build Tool Errors - Ninja with Clang on Windows

Users have reported that when using Ninja + Clang on Windows with static builds, the build may incorrectly pass `-D_DLL`, causing linkage errors.

**Action:**
- Upgrade to the latest CMake version where this issue is addressed.
- Review the CMake setup to ensure the replacement of `-D_DLL` flag is applied.

### 3. Slow or Failed Compilation on MSVC with /clr

If your compilation of mock classes with MSVC fails or runs out of memory, check if `/clr` is enabled.

**Action:**
- Avoid combining `/clr` with GoogleMock's native C++ code.
- Build GoogleMock and tests with `/clr` disabled.

### 4. Unexpected Linking Errors

- Make sure to link your test binaries with the appropriate libraries:
  - `gtest` or `gtest_main` for GoogleTest
  - `gmock` or `gmock_main` if you use GoogleMock features
- For CMake or Bazel users, follow the official linking instructions carefully.

**Typical linking flags:**
```sh
-L/path/to/libs -lgmock_main -lgmock -lgtest_main -lgtest -lpthread
```


## Build System Integration Tips

- **CMake:** Use the provided `FetchContent` or `ExternalProject` methods to incorporate GoogleTest/GoogleMock.
  - Ensure you configure to use `cxx_std_17` features.
  - Follow recommended usage of targets like `gtest`, `gtest_main`, `gmock`, and `gmock_main`.
- **Bazel:** Use prebuilt rules from the official GoogleTest repo.


## Troubleshooting Linking Test Binaries

- If your tests fail to link with `undefined reference` errors to GoogleTest or GoogleMock symbols:
  - Confirm that you link with `gtest_main` or provide your own `main()`.
  - Ensure the link order is correct: libraries providing symbols must appear after the objects using them.

- For issues linking with threading libraries:
  - Check that `-pthread` or equivalent is enabled on Linux/macOS.
  - On Windows, verify that threading support macros are set correctly.


## Verifying Build Environment

1. Confirm compiler version and C++ standard setting:

```bash
$ g++ --version
$ echo | g++ -std=c++17 -E -
```

2. Validate that CMake sets compiler flags correctly by inspecting verbose build logs.

3. Build sample tests from the GoogleTest repo with verbose output enabled to catch early errors.


## Practical Tips

- Use the latest stable versions of compilers and CMake for best build experience.
- Avoid mixing static and shared builds across your dependencies.
- Use GoogleTest's recommended compiler flags to prevent subtle runtime environment issues.
- Consult the `googletest/cmake/internal_utils.cmake` script to understand how flags are set when customizing builds.


## Summary

Build issues often stem from inconsistent compiler versions, missing links to test libraries, or incorrect compiler flags. By ensuring your environment meets the minimum requirements, linking correctly, and using recommended build configurations, you can streamline integration and avoid most setup pitfalls.


---

## Additional Resources

- [Setting Up and Installing GoogleTest](../guides/getting-started/setup-installation.md)
- [Troubleshooting Setup Issues](../getting-started/first-steps-usage/troubleshooting-setup.md)
- [Configuring GoogleTest in Your Project](../getting-started/prerequisites-installation/configuration-setup.md)
- [Mock Method Definition](../api-reference/mocking-apis/mock-methods.md)
- [Using Mocks: Patterns and Best Practices](../guides/mocking-and-advanced-techniques/using-mocks.md)


---

## Frequently Asked Questions (FAQs)

<AccordionGroup title="Installation & Build FAQs">
<Accordion title="What is the minimum C++ standard required to build GoogleTest and GoogleMock?">
GoogleTest and GoogleMock require C++17 or later. Older standards are not supported and will cause build failures.
</Accordion>
<Accordion title="Why do I see runtime library conflicts on MSVC when linking tests?">
Make sure your build flags are consistent: static libraries should use static runtime (/MT), and shared libraries use dynamic runtime (/MD). GoogleTest's CMake scripts default to consistent flags but check your build override flags.
</Accordion>
<Accordion title="How do I fix linker errors like undefined references to GoogleMock or GoogleTest?">
Verify that your test executable links against the correct GoogleTest and GoogleMock libraries (`gtest_main`, `gmock_main`, etc.). Also ensure the link order is correct and threading libraries are properly linked.
</Accordion>
<Accordion title="What should I do if my MSVC build runs out of memory compiling mock classes?">
If `/clr` is enabled, try disabling it for the native C++ mocking code as it increases memory usage drastically.
</Accordion>
<Accordion title="How do I verify that my compiler and build environment are properly set up for building GoogleTest?">
Check your compiler version supports C++17 and inspect compiler flags during build with verbose output enabled. Try building the GoogleTest samples to validate the setup.
</Accordion>
</AccordionGroup>


## Troubleshooting Common Issues

### Compiler Compatibility
- Upgrade compiler to ensure C++17 support.

### Linking Issues
- Confirm linkage against proper GoogleTest/GoogleMock libraries.
- Ensure correct link order.

### Runtime Library Mismatches
- Check for consistent runtime flags in MSVC.

### Build Tool Problems
- Avoid known issues with Ninja and Clang on Windows by upgrading tools.

### Excessive Memory Use
- Disable `/clr` in MSVC builds.


## Callouts

<Tip>
Building GoogleTest and GoogleMock requires modern compiler support. Always validate your C++ standard and compiler version first.
</Tip>

<Warning>
Mixing static and dynamic runtimes or incorrect link orders causes subtle runtime crashes or linker errors.
</Warning>

<Note>
CMake scripts included with GoogleTest handle most flag setup automatically; customize carefully.
</Note>