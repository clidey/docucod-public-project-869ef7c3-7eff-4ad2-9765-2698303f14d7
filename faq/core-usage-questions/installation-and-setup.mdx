---
title: "Installation and Setup Issues"
description: "Guidance for resolving common installation and setup problems with GoogleTest and GoogleMock, such as build errors, missing dependencies, and project integration. Includes platform-specific tips and relevant configuration details."
---

# Installation and Setup Issues

Guidance for resolving common installation and setup problems with GoogleTest and GoogleMock, including build errors, missing dependencies, and project integration. This page highlights platform-specific tips and configuration details to help you get your GoogleTest and GoogleMock environments up and running smoothly.

---

## 1. Common Installation Challenges

When setting up GoogleTest and GoogleMock, you may encounter various issues during installation and setup. These typically arise from missing dependencies, build system misconfiguration, incompatible compiler settings, or platform-specific quirks.

### Typical Problems

- Missing or incorrect installation of CMake or build tools
- Build errors due to incompatible or unsupported C++ standard versions
- Linker errors caused by incorrect library linkage or runtime mismatches
- Issues with integrating GoogleTest/GoogleMock into existing projects
- Platform-specific integration difficulties (Windows, macOS, Linux, embedded)

---

## 2. Step-by-Step Installation Guidance

### Using CMake to Build GoogleTest and GoogleMock

GoogleTest and GoogleMock provide easy cross-platform build integration through CMake:

<Steps>
<Step title="Clone the Repository">
Run the following command to clone the official repository at a specific stable version:
```bash
git clone https://github.com/google/googletest.git -b v1.17.0
```
Navigate to the cloned directory:
```bash
cd googletest
```
</Step>
<Step title="Prepare the Build Directory">
Create and enter a new build directory to keep build files clean:
```bash
mkdir build
cd build
```
</Step>
<Step title="Generate Build Files">
By default, GoogleMock is built alongside GoogleTest:
```bash
cmake ..
```
If you wish to build only GoogleTest, disable GoogleMock with:
```bash
cmake .. -DBUILD_GMOCK=OFF
```
</Step>
<Step title="Build the Libraries">
On Linux/macOS:
```bash
make
sudo make install
```
On Windows, open the generated solution file (e.g., `gtest.sln`) with Visual Studio and build the projects.
On macOS, an Xcode project is generated for building within Xcode.
</Step>
</Steps>

<Tip>
Make sure your system's C++ compiler supports at least C++17, as this is required to successfully build GoogleTest and GoogleMock.
</Tip>

### Incorporating GoogleTest and GoogleMock into an Existing CMake Project

You have two primary options:

- **Use Installed Libraries:** After building and installing, import the targets using `find_package(GTest CONFIG REQUIRED)` and link against `GTest::gtest`, `GTest::gmock`, or `GTest::gmock_main`.

- **Build as Part of Your Project:** Add GoogleTest and GoogleMock source code to your project and include them using `add_subdirectory()`. This ensures compiler and linker settings remain consistent.

Example to fetch GoogleTest during configuration:
```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # For Visual Studio runtime compatibility
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

<Note>
This fetch approach requires **CMake 3.14** or later.
</Note>

---

## 3. Platform-Specific Tips and Gotchas

### Windows

- Visual Studio defaults to dynamic CRT linkage, but GoogleTest links statically by default, possibly causing linker errors.
- Set `gtest_force_shared_crt` to `ON` in your CMake configuration to align runtimes.

### Linux/macOS

- Ensure `pthread` library is linked if your tests use multithreading. CMake build scripts handle this automatically.
- Define the macro `-DGTEST_HAS_PTHREAD=1` if pthread detection fails on your platform.

### Embedded and Special Platforms

- For Arduino-like platforms (ESP8266, ESP32, NRF52), the entry points differ (use `setup` and `loop` instead of `main`). GoogleMock initializes correctly when you call `testing::InitGoogleMock()` inside `setup()`.

---

## 4. Common Build and Link Errors

### Error: C++ Standard Not Supported

**Cause:** Compiler does not support C++17 which is a minimum requirement.

**Solution:**

- Upgrade your compiler.
- Explicitly specify `set(CMAKE_CXX_STANDARD 17)` and `set(CMAKE_CXX_STANDARD_REQUIRED ON)` in your project's `CMakeLists.txt`.

### Linker Errors Related to Runtime Library Mismatches (Windows)

**Cause:** Conflicting static vs dynamic runtime settings between your project and GoogleTest.

**Solution:** Enable dynamic CRT linkage for GoogleTest with `set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)`.

### Undefined References to GoogleTest / GoogleMock Symbols

**Cause:** Failure to link against required GoogleTest/GoogleMock libraries.

**Solution:**

- Ensure your executable links against `gtest_main`, `gtest`, `gmock_main`, or `gmock` targets as needed.
- When using CMakeâ€™s `find_package`, verify correct target usage (e.g., `target_link_libraries(your_test_target GTest::gtest_main)`).

---

## 5. Integration Best Practices

1. **Use `gmock_main` or `gtest_main` libraries to avoid writing custom `main()` functions.**

   These provide built-in `main()` implementations that initialize GoogleTest and GoogleMock properly.

2. **Initialize GoogleMock with `testing::InitGoogleMock(&argc, argv);` before running tests.**

3. **Keep the GoogleTest and GoogleMock versions in sync** to avoid compatibility issues.

4. **Avoid mixing debug and release builds of GoogleTest/GoogleMock with your project.** Always build everything in the same configuration.

---

## 6. Helpful Configuration Snippets

- **Example: Using `gmock_main` in CMake**

```cmake
add_executable(mytests test1.cpp test2.cpp)
target_link_libraries(mytests gmock_main)
add_test(NAME MyTests COMMAND mytests)
```

- **Force GoogleTest to use the dynamic runtime in Visual Studio:**

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

- **Specify C++17 standard explicitly:**

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- **Force pthread availability (if detection fails):**

```cmake
add_compile_definitions(GTEST_HAS_PTHREAD=1)
```

---

## 7. Troubleshooting Steps

If you hit problems during installation or setup, follow this approach:

<Steps>
<Step title="Verify C++ Standard Support">
Confirm your compiler supports C++17 or newer.
</Step>
<Step title="Check Build Tool Versions">
Ensure you have an up-to-date CMake (>= 3.13 recommended).
</Step>
<Step title="Review Build Logs for Errors">
Look for messages about missing headers, libraries, or configuration issues.
</Step>
<Step title="Confirm Linking Against Correct Targets">
Verify that your test binaries link to GoogleTest and/or GoogleMock libraries.
</Step>
<Step title="Inspect Runtime Library Settings (Windows)">
Align runtime linkage between your project and GoogleTest/GoogleMock.
</Step>
<Step title="Try Out the Provided Examples">
Build and run simple examples from the `googletest` repo to confirm your environment.
</Step>
<Step title="Consult Platform-Specific Notes">
Follow known workarounds for your platform if any exist.
</Step>
</Steps>

<Tip>
For quicker diagnosis, enable verbose build output (`cmake --build . --verbose`) to catch subtle issues.
</Tip>

---

## 8. Additional Resources

- [GoogleTest README and Build Instructions](https://github.com/google/googletest/blob/main/README.md)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [Building and Running Tests in Real Projects](https://github.com/google/googletest/blob/main/docs/integration.md)
- [Troubleshooting Setup Issues](https://github.com/google/googletest/blob/main/docs/troubleshooting.md)

---

## 9. Quick Reference to Configuration Files

Two pkg-config template files are installed when GoogleMock is built:

- **gmock.pc.in**: Configuration for linking to GoogleMock without a main() function.
- **gmock_main.pc.in**: Configuration for linking with GoogleMock which includes a main() function.

These files include variables for library directories, include paths, thread libraries, and versioning and can help automate discovery in environments using pkg-config.

---

## 10. Summary

By following the step-by-step build instructions, properly configuring your environment (notably C++17 support and runtime linkage), and integrating GoogleTest and GoogleMock correctly via CMake or your build system, you can avoid the most common installation and setup pitfalls. Use the tips and troubleshooting flow to resolve any unexpected issues, and leverage official examples for validation.

Always ensure that GoogleTest and GoogleMock libraries are built and linked consistently with your project settings to maintain a stable test environment.

---

<Check>
Remember: if you encounter issues not resolved here, consult the community forums, GitHub issues on the GoogleTest repository, or the related detailed documentation on build configuration and integration.
</Check>


---

## See Also

- [GoogleTest Primer for Writing Tests](https://github.com/google/googletest/blob/main/docs/primer.md)
- [Effective Mocking with GoogleMock](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md)
- [Continuous Integration Setup Guide](https://github.com/google/googletest/blob/main/docs/ci_integration.md)
- [Troubleshooting Common Error Messages](https://github.com/google/googletest/blob/main/docs/troubleshooting.md)

---

##### Source Files

- [googlemock/CMakeLists.txt](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt)
- [googletest/README.md](https://github.com/google/googletest/blob/main/googletest/README.md)
- [googlemock/src/gmock_main.cc](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc)
- [googletest/src/gtest_main.cc](https://github.com/google/googletest/blob/main/googletest/src/gtest_main.cc)

---

<hr/>