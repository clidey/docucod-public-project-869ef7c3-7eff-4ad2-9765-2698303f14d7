---
title: "Performance & Scalability Best Practices"
description: "Responds to user concerns about test speed, scaling, and parallel execution, giving tips on structuring tests for maintainability and speed. Points to relevant advanced configuration options and community tools."
---

# Performance & Scalability Best Practices

GoogleTest empowers you to create fast, scalable, and maintainable test suites. This page addresses common concerns about test execution speed, scaling tests to large codebases, and optimizing for parallelism. It also provides strategic advice on structuring your tests effectively to balance clarity, maintainability, and performance.

---

## Frequently Asked Questions

### How can I speed up my test execution?

- **Run tests in parallel:** GoogleTest supports sharding test runs across multiple machines or processors by using the environment variables `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX`. This divides your test workload, significantly reducing total test run time without changing test code.
- **Filter tests:** Use the `--gtest_filter` flag to run only subsets of tests during development or debugging.
- **Avoid expensive setup in each test:** Utilize `SetUpTestSuite()` and `TearDownTestSuite()` to share expensive setup or resources among all tests in a suite instead of repeating in each test case.
- **Disable or temporarily exclude slow or flaky tests:** Use the `DISABLED_` prefix on test or test suite names to prevent them from running.

### How do I structure tests to maintain speed as the suite grows?

- **Group related tests into test suites** that share setup and teardown, reducing redundant resource initialization.
- **Use Fixtures carefully:** Use test fixtures (`TEST_F`) to reuse setup code, but avoid bloating fixtures with unrelated setup that unnecessarily slows tests.
- **Employ Value-Parameterized and Typed Tests** to reduce redundant test code and enable scalable testing across multiple inputs and types.

### How does GoogleTest facilitate parallel execution and sharding?

GoogleTest does not natively run tests in parallel inside a single process, but it is designed to support test sharding across multiple processes or machines through environment variables:

- Set `GTEST_TOTAL_SHARDS` to the total number of shards (machines/processes).
- Set `GTEST_SHARD_INDEX` on each process to assign which subset of tests to run.

This approach ensures that each test is run once and only once across all shards.

### Which advanced configuration options help improve test suite performance?

- **Repeat and shuffle tests:** Use `--gtest_repeat` and `--gtest_shuffle` to identify flaky tests and test interdependencies.
- **Fail fast:** Use `--gtest_fail_fast` to halt execution on the first failure, saving debugging time.
- **Suppress excessive output:** Use `--gtest_brief` or related flags to minimize console output for smoother runs.

### Are there community tools that assist with scaling and performance?

- **Parallel test runners:** Tools like [gtest-parallel](https://github.com/google/gtest-parallel) allow running tests concurrently on multi-core machines, improving execution speed without modifying tests.
- **CI integrations:** Continuous Integration systems can distribute tests over multiple workers using GoogleTestâ€™s sharding capabilities.

---

## Best Practices for Structuring Fast and Maintainable Tests

### Organize Tests into Logical Suites

Group tests that share common dependencies or setup into test suites and fixtures. Use `SetUpTestSuite()` and `TearDownTestSuite()` for expensive, shared initialization and cleanup:

```c++
class DatabaseTest : public ::testing::Test {
 protected:
  static void SetUpTestSuite() {
    db_connection_ = new DatabaseConnection("test_db");
  }
  static void TearDownTestSuite() {
    delete db_connection_;
    db_connection_ = nullptr;
  }

  static DatabaseConnection* db_connection_;
};

DatabaseConnection* DatabaseTest::db_connection_ = nullptr;
```

This avoids unnecessary repeats of costly operations per test.

### Use Parameterized Tests for Broad Coverage

Value-Parameterized and Typed Tests enable writing concise tests that run across multiple data values or types:

- Use `TEST_P` and `INSTANTIATE_TEST_SUITE_P` for value-parameterized tests.
- Use `TYPED_TEST` and `TYPED_TEST_SUITE` for type-parameterized tests.

This reduces redundancy while improving test coverage and maintainability.

### Keep Tests Small and Focused

Smaller, focused tests usually run faster and isolate faults more clearly. Avoid combining multiple scenarios into one large test.

### Skip or Disable Expensive Tests When Appropriate

For slower tests, mark them with `DISABLED_` or selectively include them only in certain test runs or CI stages.

### Avoid Global or Shared State That Causes Contention

Parallel test execution benefits from tests that are independent. Make sure tests do not share mutable global state or resources that cause contention.

---

## Tips for Speed and Scalability

- **Reuse fixtures where possible:** Reduce repeated initialization costs.
- **Use the test filter for quick iteration:** Run only affected tests during development.
- **Combine with CI parallelization:** Let your CI distribute tests using sharding and parallel runners.
- **Monitor slow tests:** Identify and optimize tests that take disproportionately long.

---

## Troubleshooting Common Performance Issues

### Tests Run Too Slowly

- Check for redundant expensive operations in test setup.
- Use per-suite setup instead of per-test when possible.
- Make sure expensive I/O or network operations are mocked or stubbed.

### Tests Fail When Running in Parallel or Shards

- Ensure tests do not rely on shared file system state without proper isolation.
- Confirm that tests do not produce race conditions.
- Use `DISABLED_` prefix temporarily to isolate problematic tests.

### Test Output Is Noisy or Hard to Analyze

- Use `--gtest_brief=1` to suppress passes and show only failures.
- Generate XML reports with `--gtest_output=xml:` for automated parsing.
- Customize event listeners for tailored reporting.

---

## Related Advanced Configuration

For detailed options and flags affecting test performance and behavior, visit:

- [Optimizing Test Suite Performance](guides/integration-and-best-practices/test-performance.md)
- [Integrating GoogleTest with CI & Test Runners](guides/integration-and-best-practices/ci-and-test-runner-integration.md)

Community tools and extended workflows are discussed in those guides to help maximize scalability.

---

## Getting More Help

- Browse [GoogleTest FAQ - Performance & Scalability](faq/integration_and_performance/test-performance.md) for common concerns.
- Engage with community forums or GitHub issues for sharing tips and requesting assistance.


---

## Summary

This page equips you to design and run fast, scalable GoogleTest suites that grow reliably with your codebase. Employ sharding, test filtering, and parameterized tests to optimize test execution. Combine these with CI parallelism and selective running strategies to accelerate feedback cycles and maintain high quality.


---

##### Code Repositories & Further Reading

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Primer](primer.md)
- [Advanced GoogleTest Topics](advanced.md)
- [Test Performance Guide](guides/integration-and-best-practices/test-performance.md)
- [CI & Test Runner Integration Guide](guides/integration-and-best-practices/ci-and-test-runner-integration.md)
- [FAQ - Test Performance](faq/integration_and_performance/test-performance.md)