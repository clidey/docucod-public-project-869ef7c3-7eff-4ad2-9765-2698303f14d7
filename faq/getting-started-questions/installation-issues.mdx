---
title: "Installation and Setup Issues"
description: "Solutions for the most common installation and build problems, including compiler requirements, linking errors, and how to set up GoogleTest and GoogleMock using supported build tools (CMake, Bazel). Helps users resolve setup challenges and start creating tests effectively."
---

# Installation and Setup Issues

## Overview

This FAQ page provides clear, practical solutions to the most common challenges users face while installing and setting up GoogleTest and GoogleMock. It addresses compiler requirements, linking errors, build tool configurations, and step-by-step guidance on setting up GoogleTest and GoogleMock with supported build tools like CMake and Bazel. Whether you are building from source or integrating GoogleTest into an existing project, this guide helps you resolve setup pitfalls to start running tests swiftly and reliably.

---

## Frequently Asked Questions

### 1. What are the minimum compiler and platform requirements to build GoogleTest?

GoogleTest requires a C++ environment supporting the C++17 standard. This means your compiler must support `-std=c++17` or equivalent. Supported platforms include Linux, Windows, and Mac OS X as documented in the [Supported Platforms](https://github.com/google/googletest/blob/main/docs/platforms.md).

Ensure your build system uses a compatible compiler version with C++17 enabled, for example by setting `set(CMAKE_CXX_STANDARD 17)` in your CMake project.


### 2. How do I build and install GoogleTest using CMake?

Here’s a straightforward sequence for building GoogleTest standalone:

1. Clone the repository:
```bash
  git clone https://github.com/google/googletest.git -b v1.17.0
  cd googletest
```
2. Create and enter a build directory:
```bash
  mkdir build
  cd build
```
3. Generate build scripts (this builds GoogleMock as well by default):
```bash
  cmake ..
```
   - To build only GoogleTest and skip GoogleMock, run:
```bash
  cmake .. -DBUILD_GMOCK=OFF
```

4. Build the libraries:
```bash
  make
```

5. (Optional) Install GoogleTest system-wide (requires admin privileges):
```bash
  sudo make install
```

On Windows, use Visual Studio with the generated solution (`gtest.sln`). On macOS, use the generated Xcode project.


### 3. How do I integrate GoogleTest into my existing CMake project?

You have two recommended approaches:

- **Import installed libraries:** Use `find_package(GTest CONFIG REQUIRED)` after installing GoogleTest, then link with `GTest::gtest` or `GTest::gmock`.

- **Add GoogleTest as a subdirectory:** Include GoogleTest source directly in your project and add it with `add_subdirectory()`. This ensures consistent compiler and linker settings, avoiding runtime conflicts, especially on Windows.

Example snippet:
```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

Remember, this requires CMake 3.14 or higher.


### 4. What are common linking errors and how do I fix them?

Some frequent causes of linking errors include:

- **Runtime library mismatches on Windows:** Visual Studio projects often default to dynamic CRT (`MD`), but GoogleTest builds with static CRT (`MT`) by default.

  - Fix this by enabling the CMake option `gtest_force_shared_crt`:

  ```bash
  cmake .. -Dgtest_force_shared_crt=ON
  ```

- **Missing pthreads linkage on Unix-like systems:** GoogleTest detects pthread availability automatically if your environment supports it. If linking errors arise related to threading:

  - Add `-DGTEST_HAS_PTHREAD=1` to compiler flags.
  - Ensure the pthread library is linked by adding `-lpthread` or the equivalent in your build system.

- **Building shared library without correct definitions:** Use `-DGTEST_CREATE_SHARED_LIBRARY=1` when building GoogleTest as shared libs and add `-DGTEST_LINKED_AS_SHARED_LIBRARY=1` when compiling your tests.


### 5. How do I build GoogleMock and GoogleMock's main function?

By default, building GoogleTest with the included CMake scripts also builds GoogleMock.

If you want to separately build GoogleMock with its main(), link with the `gmock_main` library. This is especially useful if you want your test executable to use GoogleMock functionalities and have the test runner provided.

Example linking:
```cmake
target_link_libraries(your_test_executable gmock_main)
```

For custom `main()` functions, the [gmock_main.cc](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc) source provides a standard entry point, initializing both GoogleMock and GoogleTest.


### 6. What if my environment doesn’t have CMake, or I prefer Bazel?

GoogleTest and GoogleMock support Bazel as a build tool with configured BUILD files.

Consult the [Integration and Dependencies](https://github.com/google/googletest/blob/main/overview/architecture-and-integration/integration-and-dependencies.md) documentation for detailed instructions on setting up Bazel builds and handling platform-specific nuances.


### 7. How can I confirm my build environment is set up correctly before running tests?

- Ensure you have a compiler supporting C++17.
- Confirm CMake is version 3.13+ (ideally 3.14+ for FetchContent support).
- For Windows, verify CRT linkage modes align between GoogleTest libraries and your application.
- If using pthreads, ensure the appropriate compiler and linker flags enable pthread support.

Run a simple test executable linking with `gtest_main` or `gmock_main` and verify it passes.


### 8. How do I avoid macro name conflicts with GoogleTest?

Macros like `TEST` may collide with other frameworks or legacy code.

You can rename GoogleTest’s macros by defining flags like:
```bash
-DGTEST_DONT_DEFINE_TEST=1
```
which renames `TEST` to `GTEST_TEST`. This is useful to avoid conflicts but requires updating your test code accordingly.


## Common Issues & Gotchas

| Issue                              | Cause                                                     | Solution                                               |
|----------------------------------|-----------------------------------------------------------|--------------------------------------------------------|
| Link error: `mismatch detected for 'RuntimeLibrary'` | CRT mismatch between your project and GoogleTest | Enable `gtest_force_shared_crt` in CMake to match runtimes |
| Linker errors due to missing pthread | Pthreads not linked or not detected | Add `-DGTEST_HAS_PTHREAD=1` and link with pthread library |
| Tests fail to run or crash on Windows | Unicode settings or entry point conflicts | Use `gmock_main` or `gtest_main` to get a compatible main() |
| GoogleTest macros conflicting with other libraries | Macro name clashes | Use `-DGTEST_DONT_DEFINE_*` flags to rename GoogleTest macros |


## Troubleshooting Steps

### Step 1: Validate your environment
- Check compiler version and support for C++17.
- Verify CMake version.
- Confirm threading library support if using multi-threaded tests.

### Step 2: Review your build system configuration
- Check for consistent runtime linkage (`/MD` vs `/MT` on MSVC).
- Ensure proper flags for shared/static library builds.
- Verify linking order and presence of all required GoogleTest and GoogleMock libraries.

### Step 3: Build a minimal test
Create a minimal test executable:
```cpp
#include <gtest/gtest.h>

TEST(SimpleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```
Build and link with `gtest_main`.
If this runs successfully, your environment is correct.

### Step 4: Analyze errors and adjust
Use error messages to adjust compiler/linker flags accordingly. Refer to the solutions listed above.


## Best Practices

- Always specify C++17 support explicitly in your build system.
- Use GoogleTest CMake options to control shared/static library and runtime linkage.
- Prefer linking tests with `gtest_main` or `gmock_main` to avoid writing `main()` manually.
- Integrate GoogleTest via CMake’s FetchContent or add_subdirectory in your project to maintain build consistency.
- Set up continuous integration validations on clean environments to catch setup issues early.


## Additional Resources

- [GoogleTest README - Build Instructions](https://github.com/google/googletest/blob/main/googletest/README.md)
- [Supported Platforms](https://github.com/google/googletest/blob/main/docs/platforms.md)
- [Getting Started with CMake Installation](https://github.com/google/googletest/blob/main/getting-started/setup-prerequisites-installation/installation-cmake.md)
- [Integration and Dependencies Guide](https://github.com/google/googletest/blob/main/overview/architecture-and-integration/integration-and-dependencies.md)
- [Troubleshooting & Quick Validation](https://github.com/google/googletest/blob/main/getting-started/configuration-first-test-validation/troubleshooting-validation.md)

---

## Sample CMake Configuration Snippet for GoogleTest

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)

# Enable shared runtime to match default Visual Studio configurations
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_test test/my_test.cpp)

# Link with gtest_main for built-in main()
target_link_libraries(my_test gtest_main)

enable_testing()
add_test(NAME MyTest COMMAND my_test)
```

## Troubleshooting Common Linking Errors Example

If you get the following error on Windows:
```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```
Add the following CMake option:
```bash
cmake .. -Dgtest_force_shared_crt=ON
```
And rebuild.


## How to Build with Bazel

While this page focuses on CMake, GoogleTest supports Bazel with provided `BUILD` files.

Refer to the [Integration and Dependencies](https://github.com/google/googletest/blob/main/overview/architecture-and-integration/integration-and-dependencies.md) section for Bazel instructions and platform-specific workarounds.


## Summary

This FAQ page equips you to overcome common installation and setup hurdles with GoogleTest and GoogleMock. By following environment setup checks, build tool configurations, and best practices outlined here, you will confidently compile, link, and run tests leveraging GoogleTest’s powerful framework.

---