---
title: "How do I install and set up GoogleTest/GoogleMock?"
description: "Step-by-step guidance for installing and integrating GoogleTest and GoogleMock into C++ projects, including supported platforms, compilers, and links to quickstart guides. Addresses frequent confusion around build systems (CMake, Bazel), minimum requirements, and initial configuration."
---

# How do I install and set up GoogleTest/GoogleMock?

This guide provides detailed, step-by-step instructions to install, configure, and integrate GoogleTest and GoogleMock into your C++ projects. It covers supported platforms, compilers, build system integration with CMake and Bazel, minimum requirements, and initial configuration to get you started quickly and correctly.

---

## Supported Platforms and Compilers

GoogleTest and GoogleMock support all major desktop operating systems including Linux, Windows, and macOS. They are compatible with a wide range of C++ compilers that support at least C++17, which is a firm requirement for building these frameworks.

- **Operating Systems:** Linux, Windows, macOS
- **Compilers:** GCC 7 or later, Clang 5 or later, MSVC with C++17 support
- **C++ Standard Required:** C++17 (minimum)

Ensure your environment's compiler supports C++17 before proceeding with installation.

---

## Overview of Installation Methods

You can install GoogleTest and GoogleMock using the following methods:

- **Using CMake as a Standalone Project:** Clone the repository and build using CMake.
- **Embedding into Your CMake Project:** Include GoogleTest/GoogleMock source via `add_subdirectory()` or FetchContent.
- **Using Bazel:** Configure Bazel workspaces to integrate the libraries.
- **Manual Build:** Compile source files and link libraries manually (not recommended).

This page focuses mostly on the CMake integration, as it is the most common and flexible for typical projects.

---

## Step-by-Step Installation with CMake

### 1. Clone the Repository

Obtain the source code for GoogleTest which also includes GoogleMock by default:

```bash
git clone https://github.com/google/googletest.git -b main
cd googletest
```

### 2. Create a Build Directory

Create a dedicated directory to hold the build artifacts:

```bash
mkdir build
cd build
```

### 3. Generate Build Files

Run CMake to generate native build files. This step includes GoogleMock by default.

```bash
cmake ..
```

If you want to build only GoogleTest without GoogleMock, add this option instead:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

### 4. Build the Libraries

Depending on your platform, run the appropriate build command:

- On Linux/macOS:

```bash
make
```

- On Windows (Visual Studio):

Open the generated `.sln` solution file in Visual Studio and build.

- On macOS (Xcode):

Open the generated `.xcodeproj` file and build.

### 5. Install (Optional)

For system-wide installation (typically requires administrator rights):

```bash
sudo make install
```

Installs under `/usr/local/` by default.

---

## Incorporating GoogleTest/GoogleMock into Your CMake Project

GoogleTest is often embedded directly into your project to avoid compatibility issues.

### Using `add_subdirectory()`:

Place GoogleTest source in a subdirectory or add it as a git submodule and then:

```cmake
add_subdirectory(path/to/googletest)

add_executable(MyTest test_main.cpp my_tests.cpp)
target_link_libraries(MyTest gtest_main gmock_main)
```

### Using FetchContent:

A modern approach lets CMake download GoogleTest at configure time:

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  GIT_REPOSITORY https://github.com/google/googletest.git
  GIT_TAG main
)

FetchContent_MakeAvailable(googletest)

add_executable(MyTest test_main.cpp my_tests.cpp)
target_link_libraries(MyTest gtest_main gmock_main)
```

This ensures you use exactly the version you expect without manual cloning.

---

## Understanding the Main Executable Linkage

GoogleTest and GoogleMock provide two kinds of libraries:

- `gtest` / `gmock`: Core test and mock libraries without entry point.
- `gtest_main` / `gmock_main`: Libraries that include a default `main()` function for test execution.

Most users should link against `gtest_main` or `gmock_main` to avoid writing their own `main()` function, which is the recommended way.

### Custom `main()` Function

If you need to write your own `main()`, for instance to run custom initialization code or parse command-line options, the function must:

- Initialize GoogleTest/GoogleMock with `testing::InitGoogleTest(&argc, argv);` or `testing::InitGoogleMock(&argc, argv);`
- Return the result of `RUN_ALL_TESTS()`

Example from the codebase:

```c++
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

For GoogleMock, `InitGoogleMock()` initializes both GoogleMock and GoogleTest, so call it instead:

```c++
int main(int argc, char **argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Refer to the `googletest/src/gtest_main.cc` and `googlemock/src/gmock_main.cc` files for production examples.

---

## Integration with Bazel

GoogleTest and GoogleMock can be integrated into Bazel projects via workspace and BUILD file configurations. This allows Bazel to manage downloading, building, and linking the testing frameworks.

Detailed guides are available in the [Build System Integration](https://github.com/google/googletest/blob/main/googletest/Bazel.md) page and the [Integration and Dependencies](https://github.com/google/googletest/blob/main/docs/integration_and_dependencies.md) guide.

---

## Minimum Requirements and Missing Prerequisites

- Your compiler must support C++17.
- Ensure your linker can find GoogleTest and GoogleMock libraries.
- For multithreading support, verify thread libraries are available.

CMake automatically detects pthreads on Unix systems and links them if found. On Windows, native threading primitives are used.

---

## Common Questions About Setup and Configuration

<AccordionGroup title="Frequently Asked Questions">
  <Accordion title="Do I need to write a main() function for my tests?">
    Most users should link with `gtest_main` or `gmock_main` libraries, which provide a default `main()` function. This simplifies test setup significantly.

    Write your own `main()` only if you need special control before or after tests.
  </Accordion>
  <Accordion title="What build systems does GoogleTest support?">
    GoogleTest and GoogleMock support CMake and Bazel fully. You can also compile manually but that's cumbersome.

    CMake is the recommended approach for most projects.
  </Accordion>
  <Accordion title="Can I build and run tests on embedded platforms?">
    Yes, GoogleTest and GoogleMock support some embedded platforms like ESP8266, ESP32, and NRF52 with Arduino. For arcade-like entry points, `setup()` and `loop()` functions are used instead of `main()`.

    See `googletest/src/gtest_main.cc` and `googlemock/src/gmock_main.cc` for platform-specific adjustments.
  </Accordion>
  <Accordion title="How do I handle conflicting macros during builds?">
    If GoogleTest's macros conflict with other libraries, you can disable particular macros via compiler flags, for example:

    ```bash
    -DGTEST_DONT_DEFINE_TEST=1
    ```

    Then you'll need to use the prefixed macros like `GTEST_TEST()` instead.
  </Accordion>
  <Accordion title="What should I do if linker errors about main() occur?">
    This usually happens when linking both `gtest` and `gtest_main` or mixing different runtimes in Visual Studio. Use only one of `gtest` or `gtest_main`.

    On Windows, the `gmock_main` and `gtest_main` provide the main entry point; linking both is unnecessary.
  </Accordion>
</AccordionGroup>

---

## Practical Tips for Success

- Prefer integrating GoogleTest and GoogleMock via your project's build system rather than manual inclusion.
- Always link against `gtest_main`/`gmock_main` unless you have a strong reason for a custom `main()`.
- Use up-to-date versions to avoid build or compatibility issues.
- Verify your compiler flags include at least C++17 support (`-std=c++17`).
- Run sample tests early to confirm setup:

```c++
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertion) {
  EXPECT_EQ(1, 1);
}
```

Build and run this with the GoogleTest libraries linked to confirm success.

---

## Troubleshooting Installation

<AccordionGroup title="Common Problems and Solutions">
  <Accordion title="Build Fails Due to Missing pthreads or Threading Libraries">
    On Linux/macOS, ensure CMake detects pthreads. You can enforce detection with `-DGTEST_HAS_PTHREAD=1`.

    On Windows, threading primitives differ, and you likely don't need to do anything special.
  </Accordion>
  <Accordion title="Linker Errors about Undefined References to GoogleTest Symbols">
    Make sure your test target links against `gtest` or `gtest_main`. Check order and spelling of linked libraries.

    If using CMake, confirm `target_link_libraries` includes the correct targets.
  </Accordion>
  <Accordion title="Conflicts When Including Both GoogleTest and GoogleMock">
    GoogleMock depends on GoogleTest and their initializations overlap. Use only the GoogleMock initialization function `InitGoogleMock()` which calls `InitGoogleTest()` internally.
  </Accordion>
  <Accordion title="Issue: Running Tests but No Output or Tests Discovered">
    Confirm your test binaries link against the main libraries with a valid `main()` function.

    Call `RUN_ALL_TESTS()` once, and return its value from `main()`.
  </Accordion>
</AccordionGroup>

---

## Additional Resources

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md): Learn the fundamentals.
- [Build and Configure Project](https://github.com/google/googletest/blob/main/docs/build_and_configure.md) (see Getting Started).
- [Integrating with Build Systems](https://github.com/google/googletest/blob/main/docs/integration/build_system_integration.md) for detailed CMake and Bazel instructions.
- [GoogleMock README](googlemock/README.md) for mocking-specific documentation.
- [GoogleTest GitHub](https://github.com/google/googletest): Official repo with latest instructions and release notes.

---

By following these steps and tips, you ensure a solid foundation for writing, running, and managing C++ tests with GoogleTest and GoogleMock across platforms and build environments.

---