---
title: "Common Errors and How to Fix Them"
description: "Catalogs typical errors encountered during setup or test execution, such as assertion failures, unmet expectations in mocks, build environment mismatches, or test discovery issues. Provides actionable, step-by-step fixes."
---

# Common Errors and How to Fix Them

This page catalogs typical errors encountered during the setup or execution of tests using GoogleTest, including assertion failures, unmet mock expectations, build environment mismatches, and test discovery issues. It offers clear, actionable guidance to help you diagnose and resolve these common problems efficiently.

---

## 1. Assertion Failures

### What Are They?
Assertions verify expected conditions in your tests. Failures occur when these conditions do not hold, which either aborts the current test (fatal) or marks it failed but allows continuation (non-fatal).

### Common Causes
- Incorrect expectations of your code’s output.
- Misuse of assertion macros or passing arguments with unintended side effects.
- Comparing pointers incorrectly (e.g., comparing C strings with `EXPECT_EQ` instead of `EXPECT_STREQ`).

### How to Fix
- Review the failure message carefully; it includes the expected and actual values.
- Use the correct assertion macros: use `EXPECT_STREQ` for C string content comparison, not `EXPECT_EQ`.
- Inspect any custom failure messages added via streaming (`<<`) for clues.
- If assertions contain complex expressions, simplify or use predicate-format assertions (`EXPECT_PRED_FORMAT*`) for clearer diagnostics.
- Ensure expressions in assertions are free from side effects as they may be evaluated once or more.

### Example
```cpp
EXPECT_STREQ(expected_str, actual_str) << "Strings differ.";
ASSERT_TRUE(IsEven(value)) << "Value must be even.";
```

### Tips
- Surround your assertion code with `SCOPED_TRACE()` to add context if failures happen inside helper functions.
- Use `EXPECT_FATAL_FAILURE(statement, "message")` in testing utilities to verify that code correctly triggers fatal failures.


## 2. Unmet Mock Expectations

### What Are They?
When using GoogleMock, failures occur if mock method call expectations are not met (too few or too many calls) or if unexpected calls happen.

### Common Causes
- Forgetting to set an expectation with `EXPECT_CALL` or `ON_CALL`.
- Incorrect or overly strict argument matchers.
- Ordering issues when call sequences are enforced.

### How to Fix
- Check that all expected calls are set with correct matchers.
- Use `NiceMock` or `NaggyMock` wrappers during initial test development to suppress unwanted failure noise.
- Use action clauses like `WillOnce` or `WillRepeatedly` to specify mock method behaviors.
- Verify ordering clauses such as `.Times()`, `.InSequence()`, or `.After()` reflect intended usage.

### Tips
- Use `Mock::AllowLeak` to manage mock lifespan in death tests.
- Review the [Mock Expectations and Actions](../api-reference/gmock-mock-api/mock-expectations-and-actions) for detailed guidance.


## 3. Test Discovery Issues

### Symptoms
- No tests run despite defining tests using `TEST()` or `TEST_F()`.
- Tests are reported as skipped unexpectedly.

### Common Causes
- Not initializing GoogleTest properly by calling `InitGoogleTest()` before running tests.
- Missing test registration due to issues in macro usage.
- Filtering flags (`--gtest_filter`) exclude all tests.
- Using parameterized tests without corresponding instantiations (`INSTANTIATE_TEST_SUITE_P`).

### How to Fix
- Confirm `InitGoogleTest()` is called early in your `main()` function.
- Check filtering flags for unintended patterns.
- Ensure all parameterized tests have matching instantiations unless explicitly allowed.
- For parameterized tests without instantiations, add `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` if intentional.
- Use `--gtest_list_tests` to list tests available in the binary.


## 4. Build Environment Mismatches

### Symptoms
- Compilation or linking errors.
- Unexpected runtime failures or crashes in tests.

### Common Causes
- Incompatible compiler versions or C++ standards (GoogleTest requires C++17 or later).
- Mismatches in runtime libraries or conflicting macros.
- Misconfigured build system integration (CMake, Bazel).

### How to Fix
- Check compiler support and version compatibility.
- Verify build system setup conforms to official guides.
- Align runtime libraries, especially on Windows (e.g., consistent MSVC runtimes).
- Reconsult the [Installation Guide](../getting-started/setup-and-installation/installation-guide) and [Configuration and Initial Setup](../getting-started/setup-and-installation/configuration-setup).


## 5. Handling Fatal vs Non-fatal Failures

### Understanding Failure Types
- `ASSERT_` macros trigger fatal failures that abort the current function.
- `EXPECT_` macros generate non-fatal failures, allowing the test to continue.

### Common Mistakes
- Misusing `ASSERT_*` inside functions that return non-void types causes compilation errors or undefined behavior.
- Not checking for fatal failures after subroutine calls leads to unexpected behavior.

### How to Fix
- Use `EXPECT_*` in functions that return values.
- Use `ASSERT_*` only in void-returning functions or test bodies.
- Use `ASSERT_NO_FATAL_FAILURE()` or `EXPECT_NO_FATAL_FAILURE()` to verify no fatal failures occur in sub-calls.
- Check `HasFatalFailure()` after subroutine calls to conditionally abort test execution.


## 6. Test Skipping Issues

### Symptoms
- Tests being skipped unexpectedly.

### Common Causes
- Use of `GTEST_SKIP()` macro intentionally or accidentally.
- Setup or global environment conditions invoking skip.
- Filtering flags or environment causing certain tests to be skipped.

### How to Fix
- Review uses of `GTEST_SKIP()` and precondition checks.
- Check filters and disable them for troubleshooting.


## 7. Troubleshooting Tips

- **If tests do not run:** Run with `--gtest_list_tests` to inspect which tests are registered.
- **If all tests fail or skip:** Verify environment variables related to sharding (`GTEST_SHARD_INDEX`, `GTEST_TOTAL_SHARDS`).
- **If assertion messages are unclear:** Enable verbose output or use custom predicate-formatter assertions for more clarity.
- **Non-reproducible failures:** Consider using `--gtest_repeat` to catch flaky tests.
- **Issues with death tests:** Use recommended naming conventions ending test suites with `DeathTest` and understand the difference between `fast` and `threadsafe` death test styles.


## 8. Additional Resources

- [Running Tests](../getting-started/first-test-and-validation/running-tests) for execution options and filters.
- [Assertions Reference](../api-reference/gtest-core-api/assertions-reference) for comprehensive assertion macros.
- [Mock Expectations & Actions](../api-reference/gmock-mock-api/mock-expectations-and-actions) for mocks troubleshooting.
- [Getting Started - Installation Guide](../getting-started/setup-and-installation/installation-guide) for environment setup.
- [Test Failures & Status Codes](../api-reference/error-handling-and-integration/test-failures-and-status-codes) for failure interpretation.

---

<Tip>
Always capture and review the exact assertion failure messages and the associated stack trace, as they provide the most direct clues to root causes.
</Tip>

<Warning>
Do not mix `TEST` and `TEST_F` tests in the same test suite; this mismatch leads to failures and confusion in test registration.
</Warning>

<Note>
When writing death tests, leaks detected in mock objects will cause separate error codes; consider permitting mock leaks to avoid false failures.
</Note>

### Troubleshooting Example: Assertion Failure on Pointer Comparison
```cpp
// Incorrect - this compares pointers, not string content.
EXPECT_EQ("hello", some_c_string);

// Correct - use string comparison.
EXPECT_STREQ("hello", some_c_string);
```

### Troubleshooting Example: Missing Instantiations for Parameterized Tests
```cpp
TEST_P(MyParamTest, DoesThing) {
  // test logic
}

// Missing instantiation causes test not to run.
// Add this to fix:
INSTANTIATE_TEST_SUITE_P(InstantiationName, MyParamTest, testing::Values(1, 2, 3));
```

---

For rare or complex issues, enabling verbose logging and checking environment variables related to GoogleTest flags (e.g., `--gtest_break_on_failure`, `--gtest_catch_exceptions`) can provide deeper insight.

---

## Summary
GoogleTest’s rich assertion and mocking capabilities include detailed reporting that facilitates rapid diagnosis of test failures. This page helps interpret these failures and provides practical resolutions to errors commonly encountered during test setup and execution.


---