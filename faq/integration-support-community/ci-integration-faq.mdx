---
title: "How do I integrate GoogleTest with my CI/CD pipeline?"
description: "Provides guidance on adding GoogleTest to automated workflows, configuring test runners, interpreting test output/results, and handling failures appropriately in continuous integration environments."
---

# How do I integrate GoogleTest with my CI/CD pipeline?

Integrating GoogleTest into continuous integration (CI) and continuous deployment (CD) workflows is essential for automated quality assurance in your development lifecycle. This guide provides clear steps and best practices to add GoogleTest-based tests to your automated pipelines, configure the test runners effectively, interpret test outputs and results, and handle test failures appropriately to maintain high software quality.

---

## 1. Adding GoogleTest to Automated Workflows

Integrating GoogleTest with CI/CD systems involves ensuring your tests run automatically whenever code changes are pushed or merged, with proper reporting and status integration.

### Key Actions:

- **Build Integration:** Configure your build system (e.g., CMake or Bazel) to compile GoogleTest tests into test binaries as part of your build pipeline. Ensure tests are linked with `gtest_main` or provide a main function for GoogleTest.

- **Automated Test Execution:** Execute the test binary automatically in your CI pipeline. Typical environments include Jenkins, GitLab CI, GitHub Actions, Travis CI, or Azure DevOps.

- **Exit Codes and Status:** GoogleTest returns an exit code of `0` when all tests pass and non-zero otherwise, allowing CI systems to mark builds accordingly.

- **Report Generation:** Configure GoogleTest to emit XML or JSON test reports for consumption by CI/CD tools that provide test result dashboards.

### Practical Tip

Always enable XML or JSON report output to integrate with your CI system’s test report feature. Example command:

```bash
./my_test_binary --gtest_output=xml:report.xml
```

or for JSON output:

```bash
./my_test_binary --gtest_output=json:report.json
```


---

## 2. Configuring Test Runners for CI/CD

Test runners in CI environments must be configured to run tests efficiently and reliably.

### Recommended Practices:

- **Flag Usage:** Utilize GoogleTest flags to tailor test execution, for example:

  - `--gtest_filter` to run subsets of tests.
  - `--gtest_repeat` to catch flaky tests by repeating.
  - `--gtest_shuffle` to randomize test ordering and reveal dependencies.
  - `--gtest_fail_fast` to abort on first failure when quick feedback is preferred.

- **Parallel Execution:** Use external test runners or CI features to run tests in parallel shards by setting environment variables:

  - `GTEST_TOTAL_SHARDS` - Total number of parallel test shards.
  - `GTEST_SHARD_INDEX` - Index of the current shard.

- **CI Environment Variables:** Pass environment variables and flags consistently to your test executions for reproducibility.

### Example parallel shard setup:

```bash
export GTEST_TOTAL_SHARDS=4
export GTEST_SHARD_INDEX=0
./my_test_binary
```

Run shards 0 to 3 in parallel on different machines or CI agents.

---

## 3. Understanding Test Output and Results

Effective interpretation of GoogleTest output is crucial for diagnosing issues.

### Common Output Modes:

- **Textual Console Output:** Shows individual test run results highlighting successes and failures, with color coding if enabled.

- **XML Reports:** Structured JUnit-style XML for CI dashboards; includes detailed test suite and test case information.

- **JSON Reports:** Alternative structured output with rich metadata for integration with modern tools.

### Tips for Better Output Handling:

- Enable color output with `--gtest_color=yes` to improve human readability locally.
- Use test filters to reduce noise in output during debugging.
- Examine failure messages, expected vs actual values, and stack traces for failure root causes.

### Example snippet of test output:

```none
[----------] 2 tests from QueueTest
[ RUN      ] QueueTest.IsEmptyInitially
[       OK ] QueueTest.IsEmptyInitially
[ RUN      ] QueueTest.DequeueWorks
mytest.cc:45: Failure
Expected equality of these values:
  q2_.size()
    Which is: 1
  expected_size
    Which is: 0
[  FAILED  ] QueueTest.DequeueWorks
[----------] 2 tests from QueueTest (0 ms total)

[  PASSED  ] 1 test.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] QueueTest.DequeueWorks

 1 FAILED TEST
```

---

## 4. Handling Failures in CI/CD

Responsive handling of test failures is key to maintaining stability and developer productivity.

### Best Practices:

- **Fail the CI Build:** Use the test binary’s exit code to fail builds on test failures.

- **Report Failures Clearly:** Integrate XML/JSON reports into the CI system’s test result dashboards for clear visibility.

- **Flaky Test Detection:** Use `--gtest_repeat` or sharding to help identify flaky or unstable tests.

- **Early Failure Notifications:** Configure notifications (email, chat, or dashboards) on test failures to prompt fast reaction.

- **Debugging Flaky Tests:** Re-run failing tests locally with the same flags as CI to reproduce.

- **Use Fail Fast for Rapid Feedback:** When iterating rapidly, use `--gtest_fail_fast` to stop on first failure.

- **Skipped and Disabled Tests:** Monitor tests marked disabled (`DISABLED_` prefix) or skipped (`GTEST_SKIP()`) and plan to resolve or re-enable them.

### Handling Special Cases

- **Death Tests:** Configure your test environment to allow death tests to run smoothly, as these spawn child processes and might require isolation or specific flags.

- **Mocks and Leaks:** When using mocks in death tests, ensure mocks are allowed to leak via `Mock::AllowLeak()` to prevent false failure signals.

---

## 5. Recommended CI Integration Workflow Example (using CMake)

1. **Build Stage:**

   ```bash
   cmake -S . -B build
   cmake --build build
   ```

2. **Test Execution with Report:**

   ```bash
   cd build
   ./hello_test --gtest_output=xml:test_results.xml
   ```

3. **CI Tool Configuration:**

   - Upload `test_results.xml` to CI test dashboard.
   - Set build to fail if exit code is non-zero.

4. **Advanced:**

   - Configure sharding environment variables if using distributed agents.
   - Run test repeats to catch flaky tests early.

---

## 6. Troubleshooting Common CI Issues with GoogleTest

<AccordionGroup title="Common Issues in CI Pipelines">
<Accordion title="Tests Not Running or Being Discovered">

- **Problem:** Tests are silently not running.
- **Cause:** Test binaries missing GoogleTest registration or filtering out all tests.
- **Solution:**
  - Run with `--gtest_list_tests` to verify test discovery.
  - Check filters (`--gtest_filter`) to ensure they're not too restrictive.
  - Confirm that tests are linked properly and `InitGoogleTest()` is called.

</Accordion>
<Accordion title="XML Report Not Generated">

- **Problem:** No XML report file after test run.
- **Cause:** Incorrect `--gtest_output` flag or file system permissions.
- **Solution:**
  - Ensure `--gtest_output=xml:path/to/file.xml` is set correctly.
  - Check write permissions to the target directory.
  - Verify the test process exit status to ensure tests ran.

</Accordion>
<Accordion title="Flaky or Intermittent Failures">

- **Problem:** Tests pass locally but fail randomly in CI.
- **Cause:** Parallel execution side effects, timing issues, ordering dependencies.
- **Solution:**
  - Use `--gtest_shuffle` to detect test dependencies.
  - Run tests serially to isolate problematic tests.
  - Increase test repeat counts to reproduce.
  - Examine shared resource usage in tests for conflicts.

</Accordion>
<Accordion title="Death Tests Fail in CI but Pass Locally">

- **Problem:** Death tests fail or hang in CI environments.
- **Cause:** CI environment restrictions, threading conflicts.
- **Solution:**
  - Use `GTEST_FLAG_SET(death_test_style, "threadsafe")` to improve reliability.
  - Isolate death tests to dedicated runs.
  - Review CI agent capabilities and restrictions.

</Accordion>
</AccordionGroup>

---

## Related Documentation and Resources

- **Integration Build Systems:** [Integrating with Your Build System](https://google.github.io/googletest/getting-started/prerequisites-installation/integration-build-systems)
- **Running Tests:** [Writing and Running Your First Test](https://google.github.io/googletest/guides/gtest-core-workflows/writing-and-running-tests)
- **CI Pipeline Integration:** [Integration with Other Systems](https://google.github.io/googletest/overview/audience-usecases-integration/integration-with-other-systems)
- **Test Output and Reporting:** [Running Test Programs: Advanced Options](https://google.github.io/googletest/docs/advanced#running-test-programs-advanced-options)
- **Troubleshooting:** [Troubleshooting Common Build and Runtime Errors](https://google.github.io/googletest/faq/test-writing-execution/troubleshooting-common-errors)
- **Sample CI Configuration:** Refer to your CI platform’s documentation for consuming GoogleTest XML or JSON reports.

---

For comprehensive guidance, refer to the official [GoogleTest User's Guide](https://google.github.io/googletest/) which covers the full testing lifecycle and advanced techniques to optimize your CI/CD pipelines.

<Tip>
Automate test report collection and analysis in your CI pipeline to detect failures early and maintain code quality consistently.
</Tip>

<Tip>
Keep your test binaries and run commands up to date as your project evolves, ensuring smooth CI runs.
</Tip>