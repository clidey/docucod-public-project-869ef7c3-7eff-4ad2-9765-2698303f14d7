---
title: "Resolving Typical Build and Link Errors"
description: "Troubleshooting guidance for common build failures, including compiler requirements, C++ version mismatches, and platform-specific issues that may prevent your tests from running successfully."
---

# Resolving Typical Build and Link Errors

This troubleshooting guide focuses on the most common build failures encountered when compiling and linking GoogleTest and GoogleMock-based tests. It helps you identify and fix issues related to compiler compatibility, C++ version mismatches, platform-specific quirks, and linking pitfalls that may prevent your tests from building or running successfully.

---

## 1. Compiler and C++ Standard Requirements

### What compiler versions does GoogleTest require?

GoogleTest mandates a C++17-compliant compiler to build and run your tests successfully. The primary supported platforms require:

- GCC 7 or later
- Clang 5 or later
- Microsoft Visual Studio 2017/2019 or later

Older compilers may either fail compilation or exhibit unpredictable behavior.

### How do I ensure my project uses C++17?

Most build systems need to be explicitly instructed to use C++17. For example:

- **CMake:** Use `set(CMAKE_CXX_STANDARD 17)` and `set(CMAKE_CXX_STANDARD_REQUIRED ON)`.
- **Bazel:** Ensure your `.bazelrc` or build files include `--cxxopt='-std=c++17'`.

Without this, build errors related to standard library features, language constructs, or template support will occur.

### What happens if C++17 features are missing?

You may see errors such as:

- Undefined or missing headers (`<filesystem>`, `<optional>`, etc.)
- Template instantiation failures
- Compiler errors on `constexpr`, structured bindings, or `if constexpr`

These indicate your compiler is either outdated or your build configuration does not enforce C++17.

<Tip>
Always verify the compiler version and the applied C++ standard flags in your build logs before reporting build failures.
</Tip>


## 2. Common Compiler Errors During Build

### Unexpected errors in generated mock code

If you see cryptic errors in mock classes:

- Confirm you are using a supported compiler version.
- Ensure that all `MOCK_METHOD` macros are correctly used as per [Defining Mock Methods](https://google.github.io/googletest/reference/mocking.html#MOCK_METHOD).
- Remember that `MOCK_METHOD` must be placed in the `public:` section of your mock class.

### Issues with template and overloaded methods

Overloads and template mocks require exact matching of declarations and qualifiers. Consult [Mocking Class Templates & Overloads](https://google.github.io/googletest/gmock_cook_book.html#creating-mock-classes) for syntax guidance.

### Warnings about virtual destructors

GoogleTest relies on polymorphic destructors in interfaces that are mocked. If you get warnings or runtime errors related to destructors:

- Verify that all base classes have **virtual destructors**.
- If not, refactor the base classes to add them to avoid undefined behavior.

<Warning>
Mocking a class without a virtual destructor can lead to memory leaks or heap checker failures.
</Warning>


## 3. Linker Failures

### Missing symbols for GoogleTest or GoogleMock

- Confirm that your build includes linking against the GoogleTest and GoogleMock libraries.
- For CMake, link with `gtest`, `gtest_main`, and `gmock` as needed.
- Ensure you are not mixing static and shared libraries inconsistently.

### Multiple definition errors

- Check that mock class definitions are included only once.
- Avoid defining inline mock class constructors and destructors in header files included in multiple compilation units; instead, define them in source files to speed up compilation and prevent duplicate symbols.

### Runtime linking errors

- On some platforms, missing dependencies or runtime paths may cause test binaries to fail launching. Verify the runtime linker can find all shared libraries.


## 4. Platform-Specific Issues

### Windows-specific compiler and linking issues

- On Windows, ensure `STDMETHODCALLTYPE` calling conventions are correctly specified in mock declarations if your mocks override COM interface methods.
- Use the `(Calltype(STDMETHODCALLTYPE))` qualifier in `MOCK_METHOD` macros as needed.

### Cross-compilation and embedded targets

- For embedded or cross-compiled environments, verify that the standard library and threading support meet GoogleTest requirements.


## 5. Troubleshooting Workflow

<Steps>
<Step title="Verify Compiler Compatibility and C++ Standard Flags">
Ensure your compiler version meets GoogleTest requirements and that `-std=c++17` (or platform equivalent) is set in all compile commands.
</Step>
<Step title="Check Mock Class Declarations">
Make sure your mock classes use `MOCK_METHOD` correctly with appropriate qualifiers and place the macro inside the public section.
</Step>
<Step title="Confirm Linking Setup">
Verify linkage against `gtest`, `gmock`, and their dependencies. Examine build logs for missing or duplicated symbols.
</Step>
<Step title="Inspect Platform-Specific Settings">
For Windows, check calling conventions; for other platforms, check threading and system dependencies.
</Step>
<Step title="Run with Verbose Flags">
Use GoogleMock's `--gmock_verbose=info` flag to get more diagnostic output during test execution.
</Step>
</Steps>


## 6. Troubleshooting Common Error Messages

<AccordionGroup title="Common Build and Link Errors">
<Accordion title="'MOCK_METHOD' macro fails on methods with commas in types">
When mocking methods returning types with commas (e.g. `std::pair<bool,int>`), surround the entire type in parentheses or use a type alias. For example:

```cpp
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());
```
</Accordion>
<Accordion title="Linker error: undefined reference to 'gtest::InitGoogleTest'">
This usually means your test binary is not linked with GoogleTest library. Make sure to add `-lgtest` and/or `-lgmock` during link.
</Accordion>
<Accordion title="Compiler errors about missing 'override' or qualifiers">
Check `MOCK_METHOD` macro parameters to ensure the fourth parameter lists all required qualifiers: `(const, override)`, `(noexcept, override)`, etc.
</Accordion>
<Accordion title="Fatal error: error C4503: decorated name length exceeded, name was truncated">
On MSVC, this indicates that mock class or method names are very long. Simplify the types or split mocks into smaller mock classes.
</Accordion>
</AccordionGroup>


## 7. Best Practices and Tips

- **Use type aliases** to simplify complex method signatures in mocks.
- **Define constructor and destructor of mocks in source files** for faster builds and avoiding duplicate symbols.
- Always **mark destructors virtual** in classes intended to be mocked.
- Use GoogleMock's **NiceMock**, **NaggyMock**, or **StrictMock** wrappers to control how uninteresting calls are reported during tests.
- Make use of **ON_CALL** to set default behaviors separately from **EXPECT_CALL** which sets explicit expectations.
- If you get warnings about uninteresting calls, verify if you need to add `EXPECT_CALL(...).Times(AnyNumber())` or use `NiceMock` to suppress harmless warnings.

<Note>
Building GoogleTest and GoogleMock from source without correct flags or environment will manifest these common failures. Always verify your environment matches our [Prerequisites & System Requirements](../getting-started/setup-and-installation/prerequisites-system-requirements).
</Note>


## 8. Additional Support and Resources

If issues persist:

- Review the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for advanced mocking techniques and typical issues.
- Consult the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for details on mock APIs.
- Seek help from community channels linked in [Getting Help: Community and Support Channels](../faq/community-support/faq-getting-help).

---

### Related Documentation

- [Prerequisites & System Requirements](/getting-started/setup-and-installation/prerequisites-system-requirements)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [Common Installation and Integration Issues](/faq/getting-started-troubleshooting/faq-common-installation-issues)
- [Common Installation and Link Errors](../faq/getting-started-troubleshooting/faq-typical-build-errors)

---

### Example: Minimal Mock Class Setup to Avoid Build Errors

```cpp
#include <gmock/gmock.h>

class MockExample {
 public:
  MOCK_METHOD(int, DoSomething, (int arg), (override));

  // Virtual destructor to prevent heap checker errors.
  virtual ~MockExample() = default;
};
```

Ensure the above class is compiled with C++17 and linked with GoogleMock.

---

This guide empowers you to swiftly identify and resolve the majority of build and link failures associated with GoogleTest and GoogleMock usage, helping you get your tests compiling and running with confidence.