---
title: "How do I interpret assertion failures? Which types of assertions should I use?"
description: "Clarifies the difference between assertion types (fatal vs. non-fatal), output diagnostics, and how to customize assertions for clearer failure reportsâ€”an essential workflow for debugging failing tests."
---

# Understanding Assertion Failures in GoogleTest

This guide clarifies the difference between assertion types in GoogleTest, explains how to read assertion failure messages, and provides actionable guidance on using assertions effectively to diagnose and fix failing tests. Understanding assertions is key to getting the most out of GoogleTest and writing robust tests.

---

## 1. Types of Assertions: Fatal vs. Non-Fatal

GoogleTest supports two categories of assertions:

- **Fatal assertions (`ASSERT_` macros):**
  - Generate fatal failures on failure.
  - Immediately abort the current function.
  - Useful when continuing the test after a failure would be meaningless or dangerous (e.g., dereferencing null pointers).

- **Non-fatal assertions (`EXPECT_` macros):**
  - Generate non-fatal failures on failure.
  - Allow the current function to continue running.
  - Ideal for checking multiple conditions within the same test to get comprehensive feedback.

> **Best practice:** Use `EXPECT_` macros to continue running tests after failure and report multiple errors. Use `ASSERT_` macros where further test execution depends on the assertion being true.

## 2. Common Assertion Macros and Their Intent

### Basic Assertions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`: Verifies that the condition is `true`.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`: Verifies that the condition is `false`.

### Equality and Comparison

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)`: Checks *equality* (`==`).
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)`: Checks *inequality* (`!=`).
- `EXPECT_LT(val1, val2)` / `ASSERT_LT(val1, val2)`: Checks `val1 < val2`.
- `EXPECT_LE(val1, val2)` / `ASSERT_LE(val1, val2)`: Checks `val1 <= val2`.
- `EXPECT_GT(val1, val2)` / `ASSERT_GT(val1, val2)`: Checks `val1 > val2`.
- `EXPECT_GE(val1, val2)` / `ASSERT_GE(val1, val2)`: Checks `val1 >= val2`.

### String Comparisons

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)`: Compares C strings for equality.
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)`: Compares C strings for inequality.
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)`: Compares C strings ignoring case.
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)`: Checks inequality ignoring case.

### Floating-Point Comparisons

Because floating-point numbers have rounding errors, strict equality may not be meaningful. Use:

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`: Approximate equality for `float`s within 4 ULPs.
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`: Approximate equality for `double`s within 4 ULPs.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)`: Checks if difference between values does not exceed `abs_error`.

## 3. Understanding Assertion Failure Messages

When an assertion fails, GoogleTest prints informative diagnostic messages, including:

- The expression that was tested.
- The actual evaluation result and the expected condition.
- The actual values of operands involved, if printable.
- In case of string comparisons, differences are shown clearly.

Example of a failed `EXPECT_EQ` assertion:

```
Expected equality of these values:
  x.size()
    Which is: 3
  y.size()
    Which is: 5
```

For string comparisons, a line-based diff is automatically generated to highlight differences.

## 4. Custom Failure Messages

To improve clarity, you can append detailed failure messages to assertions using the stream operator `<<`:

```cpp
EXPECT_EQ(foo, bar) << "Foo and bar values differ at index " << i;
```

This message will appear appended to the standard assertion failure output.

## 5. Advanced Assertions

### Predicate Assertions

GoogleTest supports predicate functions to provide clear messages for complex conditions.

- `EXPECT_PRED1(predicate, val1)` - `ASSERT_PRED1(predicate, val1)`
- Up to `EXPECT_PRED5` macros are provided.

Example:

```cpp
bool IsEven(int n) { return n % 2 == 0; }
EXPECT_PRED1(IsEven, x);
```

If false, prints:

```
IsEven(x) evaluates to false, where
x evaluates to 3
```

### Predicate-Formatter Assertions

Use these for full control over assertion messages when predicates alone are insufficient:

- `EXPECT_PRED_FORMAT1(formatter, val1)`
- `ASSERT_PRED_FORMAT1(formatter, val1)`

A predicate-formatter returns `AssertionSuccess()` or `AssertionFailure()` with a custom message.

### Asserting with Matchers (`EXPECT_THAT`)

GoogleTest integrates with GoogleMock's matchers, allowing expressive assertions:

```cpp
EXPECT_THAT(value, StartsWith("Hello"));
```

Generates detailed failure messages describing how the value did not match the matcher.

### Exception Assertions

GoogleTest supports exception checks, if exceptions are enabled:

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`

## 6. Skipping Tests at Runtime

You can skip tests dynamically using the `GTEST_SKIP()` macro. For example:

```cpp
TEST(MyTest, SkippableTest) {
  if (some_condition) {
    GTEST_SKIP() << "Feature not supported on this platform.";
  }
  // test code...
}
```

Tests are reported as skipped if `GTEST_SKIP()` is invoked.

## 7. Assertion Placement Rules

- Fatal assertions (`ASSERT_*`) **must only be used inside void-returning functions**, since they abort the current function immediately.
- Using fatal assertions inside constructors and destructors **is not allowed**.
- For non-void functions, use non-fatal assertions (`EXPECT_*`) or handle failure propagation manually.

## 8. Debugging Tips and Best Practices

- Prefer expressive assertions that provide clear context when failing (use predicate and predicate-formatter assertions where appropriate).
- Use `SCOPED_TRACE()` or `testing::ScopedTrace` to add contextual messages when multiple calls to subroutines can produce failures.
- Use custom failure messages (`<< "message"`) to clarify failure reasons.
- Understand that `ASSERT_*` macros abort the current function, so place them where subsequent code depends on their success.
- To test private or complex conditions in assertions, consider defining custom matchers or predicate-formatters.

## 9. Common Pitfalls

- Using fatal assertions (`ASSERT_*`) inside constructors or non-void functions will cause compilation errors.
- Comparing C strings with `EXPECT_EQ` checks pointer equality, not string contents; use `EXPECT_STREQ` for content comparison.
- Floating-point equality requires approximate checks; do not use `EXPECT_EQ` for floats or doubles.
- Assertions evaluate their arguments exactly once; do not use expressions with side effects without care.

## 10. Example Usage

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  ASSERT_EQ(Factorial(0), 1) << "Factorial of zero should be one.";
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
}

// Using predicate assertion:
bool IsPrime(int n) { ... }
TEST(PrimeTest, SimpleCases) {
  EXPECT_PRED1(IsPrime, 7);
}

// Using predicate-formatter assertion:
testing::AssertionResult IsEven(const char*, int n) {
  if ((n % 2) == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << n << " is not even.";
}
TEST(EvenTest, CheckEvenNumber) {
  EXPECT_PRED_FORMAT1(IsEven, 5);
}
```

---

For more detailed guidance, please refer to [GoogleTest Primer](primer.md) and the [Assertions Reference](reference/assertions.md).

---

<AccordionGroup title="Assertion Types and Usage">
<Accordion title="Fatal vs Non-Fatal Assertions">
Fatal assertions abort the current function on failure and are suited to conditions that cannot be safely followed by further checks. Non-fatal assertions allow test continuation, enabling multiple failures to be reported per run.
</Accordion>
<Accordion title="Custom Failure Messages">
Append custom messages using the `<<` operator to provide additional context when assertions fail, improving debugging.
</Accordion>
<Accordion title="Predicate and Predicate-Formatter Assertions">
Use predicate assertions to check complex conditions with clear failure output. Predicate-formatters allow fully customized failure messages.
</Accordion>
<Accordion title="Exception Assertions">
Check for exceptions thrown or not thrown by code, enhancing error handling tests.
</Accordion>
<Accordion title="Skipping Tests">
Use `GTEST_SKIP()` to skip tests dynamically based on runtime conditions.
</Accordion>
</AccordionGroup>

<Tip>
Use `EXPECT_` macros for most checks to maximize test coverage and report multiple errors. Switch to `ASSERT_` when failures prevent meaningful continuation.
</Tip>

<Warning>
Avoid `ASSERT_*` in constructors and destructors; use `SetUp()` and `TearDown()` instead for fatal assertions.
</Warning>

<Note>
For comparing C strings, use `EXPECT_STREQ` instead of `EXPECT_EQ` to compare contents rather than pointers.
</Note>

---

## Related Documentation

- [Assertions Reference](reference/assertions.md): Complete list of assertion macros.
- [GoogleTest Primer](primer.md): Overview of writing tests.
- [Advanced GoogleTest Topics](advanced.md#assertions): Deep dive into assertion best practices.
- [Matchers Reference](api-reference/matchers-and-advanced-assertions/core-matchers.md): For expressive and advanced assertions.
- [Using Mocks](guides/essential-workflows/using-mocks.md): For mock objects and expectations.

## Next Steps

- Learn how to write tests combining assertions for robust validation.
- Explore predicate-formatters for custom assertion logic.
- Practice reading failure outputs and refining tests using custom messages.
- Explore death tests and exception assertions for fault-tolerant testing.

---

