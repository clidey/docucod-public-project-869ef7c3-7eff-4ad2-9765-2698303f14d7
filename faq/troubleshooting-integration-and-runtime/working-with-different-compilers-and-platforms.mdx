---
title: "How do I use GoogleTest/GoogleMock with my compiler or platform?"
description: "Addresses issues around supported compilers, platforms, and toolchains; covers best practices for cross-platform compatibility and references the platform support policy. Guides users on adapting tests for their environment."
---

# How do I use GoogleTest/GoogleMock with my compiler or platform?

This page helps you understand how to effectively use GoogleTest and GoogleMock with various compilers, platforms, and toolchains. It addresses concerns about supported environments, cross-platform compatibility, and best practices for adapting your tests to your development setup.

---

## Supported Compilers and Platforms

GoogleTest and GoogleMock are designed with broad platform compatibility in mind, supporting major operating systems and compilers with appropriate C++17 support.

- **Platform Coverage:** Linux, Windows, macOS, and many embedded or niche platforms are supported.
- **Compiler Requirements:** At minimum, a C++17-compliant compiler is required. Supported compilers include GCC (with versions supporting C++17), Clang, MSVC (Visual Studio 2015 and later), and Intel compilers.
- **Thread Safety:** GoogleTest is thread-safe on platforms where the pthread library is available and properly configured.

Check [Prerequisites & Supported Platforms](https://github.com/google/googletest/blob/main/docs/prerequisites.md) for the latest environment and compiler matrix.


## Cross-Platform and Toolchain Best Practices

### Environment Detection and Customization

GoogleTest auto-detects many platform features to tailor its behavior accordingly:

- Platform macros like `GTEST_OS_WINDOWS`, `GTEST_OS_LINUX`, `GTEST_OS_MAC`, etc., determine platform-specific code paths.
- Support for POSIX features and threading is detected using macros such as `GTEST_HAS_PTHREAD`.
- RTTI and exception availability are detected and used to adjust features and enable compatibility.

In some cases, especially with custom or embedded toolchains, automatic detection may fail. Users can define macros manually (e.g., `-DGTEST_HAS_PTHREAD=1` or `-DGTEST_HAS_RTTI=0`) to override defaults.

### Compiler Flags and Runtime Settings

- GoogleTest requires C++17 or higher. Set your compiler flags accordingly (for example, `-std=c++17` in GCC/Clang, or select C++17/C++latest in MSVC).
- On Windows using MSVC, special care is needed to align Runtime Library settings (static vs dynamic) between your project and GoogleTest. Use the CMake option `gtest_force_shared_crt` to match your runtime configuration and avoid conflicts.
- When building GoogleTest as a shared library (DLL), define `-DGTEST_CREATE_SHARED_LIBRARY=1` and link with `-DGTEST_LINKED_AS_SHARED_LIBRARY=1` in your test projects to ensure correct symbol exports.

### Integrating with Build Systems

GoogleTest integrates smoothly with popular build systems such as CMake and Bazel:

- **CMake:** You can use `find_package(GTest)` for installed versions or `add_subdirectory()` to build GoogleTest alongside your project, ensuring consistent compiler and linker settings.
- **Bazel:** GoogleTest and GoogleMock have native Bazel support.

Refer to [Installation & Build Integration](https://github.com/google/googletest/blob/main/docs/installation.md) and [Build System Integration](https://github.com/google/googletest/blob/main/docs/build.md) guides for detailed instructions.


## Practical Tips for Adapting to Your Environment

- **Multi-threading support:** If your platform does not have pthreads but supports another threading library, you may need to customize threading support or accept non-thread-safe behavior.
- **Embedded or minimal platforms:** For platforms with limited OS features (such as Windows Mobile, certain embedded OSes, or microcontrollers), GoogleTest disables some features (like stream redirection or death tests) to maintain compatibility.
- **Macro Conflicts:** If your project’s macros clash with GoogleTest's, you can define flags such as `-DGTEST_DONT_DEFINE_TEST=1` to rename conflicting macros.
- **Customizing Build Flags:** Adjust compiler and linker flags (e.g., warning levels, exception handling) in your build scripts to align with GoogleTest’s recommended settings and avoid warnings or errors.


## Example: Building GoogleTest with CMake on Windows Using Visual Studio

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build
cmake .. -DCMAKE_CXX_STANDARD=17 -Dgtest_force_shared_crt=ON
cmake --build . --config Release
```

- This will generate a Visual Studio solution matching your environment.
- `gtest_force_shared_crt=ON` ensures that GoogleTest uses the dynamic CRT to avoid runtime conflicts.


## Common Configuration Macros

| Macro                          | Description                                                                                 |
|-------------------------------|---------------------------------------------------------------------------------------------|
| `GTEST_HAS_PTHREAD`            | Enable POSIX pthreads support if your platform provides it (define as 1 or 0).              |
| `GTEST_HAS_EXCEPTIONS`         | Indicates whether exceptions are enabled in your compiler. (1 or 0)                        |
| `GTEST_HAS_RTTI`               | Indicates if RTTI is enabled. (Usually detected, but can be overridden)                     |
| `GTEST_CREATE_SHARED_LIBRARY`  | Defines that GoogleTest should be built as a shared library.                               |
| `GTEST_LINKED_AS_SHARED_LIBRARY` | Defines that GoogleTest is linked as a shared library in your tests.                     |
| `GTEST_DONT_DEFINE_TEST`       | Avoid macro name collision by renaming TEST() macro to GTEST_TEST().                      |


## Troubleshooting and Tips

- **Tests not discovered or run:** Verify that your tests are compiled with the correct compiler settings and linked properly with GoogleTest or gtest_main.
- **Linker errors:** Ensure runtime libraries and static/shared linkage configurations match in your GoogleTest build and your project.
- **Missing pthreads:** On some platforms (e.g., MinGW), pthread support is partial or absent; consider building without pthread support.
- **Compiler version errors:** GoogleMock requires at least Visual C++ 2015 or newer. Older compilers will fail.

For detailed troubleshooting, consult [Compiling and Linking Errors FAQ](https://github.com/google/googletest/blob/main/docs/faq.md#how-do-i-fix-compiling-or-linking-errors-with-googletestgooglemock) and [Installation & Build Integration Guide](https://github.com/google/googletest/blob/main/docs/installation.md).


## References and Further Reading

- [Prerequisites & Supported Platforms](https://github.com/google/googletest/blob/main/docs/prerequisites.md)
- [Installation & Build Integration](https://github.com/google/googletest/blob/main/docs/installation.md)
- [Build System Integration](https://github.com/google/googletest/blob/main/docs/build.md)
- [FAQ: Compiling and Linking Errors](https://github.com/google/googletest/blob/main/docs/faq.md#how-do-i-fix-compiling-or-linking-errors-with-googletestgooglemock)
- [GoogleTest Internal Portability Macros](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h)

---

If you encounter platform-specific quirks or need to debug build issues, consider defining relevant macros to explicitly configure GoogleTest for your environment. For embedded platforms or custom toolchains, some advanced configurations may be necessary.

This ensures you maximize GoogleTest’s portability and integration smoothness with your compiler and tools.

---

_Last updated: Consult the official GoogleTest [GitHub repository](https://github.com/google/googletest) for the latest compatibility status and best practices._
