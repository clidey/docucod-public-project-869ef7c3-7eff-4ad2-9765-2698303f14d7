---
title: "Platform and Compiler-Specific Issues"
description: "Advice for handling problems specific to operating systems, compilers, or architectures. Offers pointers for troubleshooting platform quirks and using framework portability features."
---

# Platform and Compiler-Specific Issues

GoogleTest and GoogleMock are designed to support a wide range of platforms, compilers, and architectures, enabling you to write tests and mocks in diverse environments confidently. However, due to varying system characteristics and compiler behaviors, specific issues may arise that require careful handling or configuration. This guide helps you navigate these platform- and compiler-specific challenges and leverage GoogleMock’s portability features effectively.

---

## 1. Supported Platforms and Environments

GoogleTest and GoogleMock support numerous operating systems including Linux, Windows (Desktop, MinGW, Mobile, RT), macOS, Android, iOS, and various Unix flavors like FreeBSD and Solaris. The frameworks also work on embedded platforms such as ESP8266, ESP32, and NR52 under Arduino environments with some adaptations.

### Key Points:
- Detection macros (e.g., `GTEST_OS_WINDOWS`, `GTEST_OS_LINUX`) enable conditional compilation for platform-appropriate code.
- Support for multi-threading depends on presence of pthreads and platform threading features.
- Some mobile or embedded platforms lack full filesystem or stream-redirection support.


## 2. Compiler Requirements and Compatibility

GoogleMock requires at least C++17 standard support. Supported compilers include recent versions of GCC, Clang, MSVC (Visual Studio 2015+), Intel LLVM, and some specialized compilers like Sun Pro or IBM VisualAge with suitable feature sets.

### Compiler Notes:
- MSVC must be version 14.0 or higher (Visual Studio 2015+) to successfully build GoogleMock.
- Compiler warning levels are set high (`-W4` on MSVC, `-Wall -Wshadow -Wconversion` on GCC/Clang) to catch errors early.
- Special flags like `-EHsc` (enable exceptions) are managed and can be toggled.
- Support for RTTI, exceptions, and standard library features is detected and tested automatically.


## 3. Threading and Synchronization

GoogleMock uses mutexes and thread-local storage to ensure safe concurrent execution of tests.

- On POSIX systems with pthreads, `pthread_mutex` and thread-local keys implement synchronization.
- Windows platforms use native Critical Section and TLS mechanisms.
- On platforms without threading support, dummy mutex and thread-local classes are used as no-ops.

If your environment lacks pthreads or proper thread support, be aware of potential restrictions when running tests in parallel.


## 4. Common Platform Issues and Workarounds

### 4.1 MSVC Runtime Library Conflicts

GoogleMock’s CMake build defaults to static CRT linkage (`/MT` flag), which can mismatch with projects using dynamic CRT (`/MD`). This causes linker errors or runtime crashes.

**How to handle:**
- Use the `gtest_force_shared_crt` option in CMake to force dynamic CRT linkage.
- Align your project’s runtime library settings with GoogleMock’s build.


### 4.2 Wide Character and Unicode Support

On Windows, wide character (`wchar_t`) and Unicode usage is standard. GoogleMock and GoogleTest provide `InitGoogleMock` overloads to parse command-line arguments in wide strings.

Beware of:
- Correctly initializing GoogleMock with `wchar_t** argv` on Windows Unicode builds.
- Platform-specific nuances, like MinGW’s limited wide-string support.


### 4.3 Lack of POSIX APIs on Some Platforms

Certain environments such as Windows Mobile, embedded boards (ESP8266/ESP32), or QURT lack full POSIX APIs (e.g., `fork()`, `clone()`, file system functions).

**Impact:**
- Limited support for features like death tests.
- No process isolation or stream redirection support.

**Workarounds:**
- Avoid using death tests on unsupported platforms.
- Use mocked alternatives or disable unsupported features.


### 4.4 Compiler-Specific Warning Suppressions

GoogleMock has built-in flags to suppress spurious compiler warnings on MSVC and Clang (e.g., unreachable code, deprecated declarations).

If you encounter unusual compiler warnings, ensure you build with recommended flags or adjust warning suppression macros in your configuration.


## 5. Portability Features in GoogleMock

GoogleMock provides internal utilities and macros to abstract platform differences:

- **Flag Macros:** Provide a uniform interface for command line flag definitions and access via `GMOCK_DEFINE_bool_`, `GMOCK_FLAG_GET()`, etc.
- **Threading abstractions:** `Mutex`, `MutexLock`, and `ThreadLocal` templates automatically use the best implementation depending on platform capabilities.
- **POSIX wrappers:** Functions like `posix::ChDir()`, `posix::IsDir()`, and `posix::GetEnv()` wrap platform differences, enabling consistent usage.

Use these provided abstractions when extending or customizing GoogleMock to maintain portability.


## 6. Diagnosing and Resolving Platform-Specific Issues

### Step-by-Step Approach:

<Steps>
<Step title="Verify Compiler Version and Flags">
Check that your compiler version meets minimum requirements and supports C++17. Ensure you use recommended compiler/linker flags as in the GoogleMock CMake scripts.
</Step>
<Step title="Check Platform Macros">
Confirm platform detection macros are correctly set (e.g., `GTEST_OS_WINDOWS` for Windows builds) to avoid incorrect conditional code.
</Step>
<Step title="Review Threading Support">
Make sure pthreads or equivalent threading APIs are available and enabled if your tests expect parallel execution.
</Step>
<Step title="Adjust Runtime Library Settings on MSVC">
Align your project’s CRT linkage with GoogleMock’s configuration (`/MT` vs `/MD`), or enable `gtest_force_shared_crt`.
</Step>
<Step title="Use Provided Portability Abstractions">
Avoid direct OS/system calls; use portability wrappers from internal headers to maximize compatibility.
</Step>
<Step title="Consult Build and Integration Logs">
Review warnings and errors closely for platform-specific issues, including missing headers, unsupported APIs, or macro conflicts.
</Step>
</Steps>


## 7. Best Practices for Cross-Platform Testing

- Always use `InitGoogleMock` to initialize test environment, passing native `argc` and `argv` types.
- Use GoogleMock-provided flags and feature detection instead of custom macros wherever possible.
- Isolate platform-specific code with clearly scoped `#ifdef` blocks based on verified macros.
- Regularly build and test on all target platforms to catch compatibility issues early.
- Document any manual tweaks or special build steps needed for specific platforms.


## 8. Additional Resources and Related Documentation

- [GoogleTest CMake Build Guidance](../getting-started/setup-prerequisites-installation/installing-googletest.md) — For platform-specific build instructions.
- [GoogleMock Internal Utilities and Portability Macros](../api-reference/advanced-mocking-features/internal-utilities-and-portability.md) — Detailed API for portability wrappers.
- [Integration and Ecosystem](../overview/feature-overview/integration-and-ecosystem.md) — Platform and build system integration points.
- [Build and Configuration Problems FAQ](../faq/troubleshooting-integration/build-issues.md) — Troubleshooting common build errors across platforms.


---

## Appendix: Example of Platform Detection Macros in Use

```cpp
#if defined(GTEST_OS_WINDOWS)
  // Windows-specific code here
#elif defined(GTEST_OS_LINUX)
  // Linux-specific code
#else
  #error Unsupported platform
#endif
```


---

This guidance ensures you harness GoogleMock’s power efficiently, regardless of the operating environment or compiler used.


---

# License Notice
All GoogleTest and GoogleMock code and associated documentation follow the BSD 3-Clause License as stated in each source file.


---