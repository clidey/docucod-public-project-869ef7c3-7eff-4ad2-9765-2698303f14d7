---
title: "Build and Configuration Problems"
description: "Solutions for build errors, linker issues, compiler compatibility, and C++ standard requirements. Includes tips for using CMake/Bazel and integrating with various toolchains."
---

# FAQ: Build and Configuration Problems

This page provides authoritative solutions and guidance for common build errors, linker issues, compiler compatibility problems, and C++ standard requirements encountered when building and integrating GoogleTest and GoogleMock. It also includes practical tips for using popular build systems like CMake and Bazel, and advice for integrating with various toolchains.

---

## 1. Common Build Errors and How to Fix Them

### Why am I getting linker errors when building my test binaries?

Linker errors often result from missing GoogleTest or GoogleMock libraries or improper linkage in your build configuration.

**Solution:**
- Ensure you link your test target against `gtest`, `gtest_main`, `gmock`, or `gmock_main` libraries (depending on what you use).
- Using CMake, target linkage might look like this:

```cmake
find_package(GTest CONFIG REQUIRED)
target_link_libraries(your_test_target PRIVATE GTest::gtest_main GTest::gmock_main)
```

- Verify your source files include the proper header and linkage of GoogleTest/GoogleMock, e.g., include `<gtest/gtest.h>` and `<gmock/gmock.h>`.

### What does the error about missing or incompatible C++ standard mean?

GoogleTest requires a modern C++ environment, typically C++17 or higher.

**Solution:**
- Configure your compiler to use the C++17 standard or newer.
- In CMake, set the standard explicitly:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- Ensure your compiler supports C++17, such as GCC 7+, Clang 5+, MSVC 2017+.

### How do I resolve issues related to pthreads on *nix systems?

If your build fails due to missing pthread libraries:

**Solution:**
- Make sure pthread development libraries are installed.
- Use CMake's FindThreads module to link appropriately:

```cmake
find_package(Threads REQUIRED)
target_link_libraries(your_test_target PRIVATE Threads::Threads)
```

- On MinGW and some Windows environments, pthread support is limited or differs; rely on native threading instead.

### What if I get errors related to `MOCK_METHOD` macros?

These errors often come from syntax issues, particularly with types containing commas.

**Solution:**
- Wrap template or comma-containing types in parentheses when using `MOCK_METHOD`:

```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
```

- Alternatively, define a type alias:

```cpp
using BoolIntPair = std::pair<bool, int>;
MOCK_METHOD(BoolIntPair, GetPair, ());
```

- Include `override`, `const`, or other qualifiers correctly.

## 2. Integration with Build Systems

### How to build GoogleTest and GoogleMock with CMake?

GoogleTest and GoogleMock provide CMake build scripts for easy integration.

**Standalone build steps:**

```bash
git clone https://github.com/google/googletest.git
mkdir build
cd build
cmake ..
make
sudo make install
```

- By default, `cmake ..` will build both GoogleTest and GoogleMock.
- To build only GoogleTest:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

- Link your test targets against `gtest_main` and/or `gmock_main`.

### How do I integrate GoogleTest/GoogleMock in my existing CMake project?

**Use these steps:**
- Use CMake’s `FetchContent` or add GoogleTest as a subdirectory.
- Use `find_package` if installed globally.

Example snippet in your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.tar.gz
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests my_tests.cc)
target_link_libraries(my_tests PRIVATE gtest_main gmock_main)
add_test(NAME my_tests COMMAND my_tests)
```

### Can I build GoogleTest and GoogleMock as shared libraries?

Yes. Use the CMake option:

```cmake
cmake .. -DBUILD_SHARED_LIBS=ON
```

- When building shared, be sure to define `GTEST_LINKED_AS_SHARED_LIBRARY=1` in dependent projects to avoid linkage issues.

### What about Bazel or other build systems?

- GoogleTest and GoogleMock provide Bazel build configurations (WORKSPACE, BUILD files).
- Follow the Bazel integration examples under the Integration & Ecosystem docs.
- Make sure your toolchain configuration supports C++17 or above.

## 3. Compiler Compatibility and Flags

### Which compilers and versions are supported?

- GCC 7+
- Clang 5+
- MSVC 2017 and later

They must support C++17 or newer.

### How to resolve MSVC runtime library conflicts?

If you see errors about runtime libraries such as `mismatch detected for 'RuntimeLibrary'`:

**Solution:**
- Use the `gtest_force_shared_crt` option in CMake:

```cmake
-Dgtest_force_shared_crt=ON
```

This instructs GoogleTest to link against the shared CRT to match most Visual Studio project defaults.

### I’m getting warnings or errors due to exceptions or RTTI settings.

GoogleTest requires exceptions and RTTI enabled by default.

**Solution:**
- Confirm your compiler flags enable exceptions (`-fexceptions` for GCC/Clang, `/EHsc` for MSVC).
- RTTI must be enabled unless you explicitly disable GoogleTest.
- Refer to GoogleTest's internal cmake utils on configuring compiler flags appropriately.

## 4. Common Pitfalls and Tips

### I’m seeing warnings about uninteresting mock function calls.

This means mocks are called on methods without expectations.

**Tip:**
- Use `NiceMock` to suppress such warnings when you intend such calls to be ignored.
- Alternatively, add a default catch-all expectation like:

```cpp
EXPECT_CALL(mock_obj, SomeMethod(_)).Times(AnyNumber());
```

### Setting expectations after method calls causes undefined behavior.

Always set `EXPECT_CALL` before exercising the mocks.

### Mocking methods with move-only types may cause compilation errors.

GoogleMock supports move-only types with `MOCK_METHOD` starting with newer versions.

**Tip:**
- If you have an older codebase, rewrite mocks to delegate move-only parameters to mockable methods using pointers.

### Build is slow when mocking many methods.

**Tip:**
- Define your mock class constructor and destructor out-of-line in .cc files to speed up compilation.

## 5. Troubleshooting Build Issues

### Problem: Test executable does not run or crashes on startup.

- Check that all required libraries (`gtest`, `gmock`) are linked and available in runtime library search paths.
- On Windows, ensure debug/release configurations and runtimes match.

### Problem: Upgrade to a new GoogleTest release leads to build breaks.

- Consult [Breaking Changes](../changelog/migration-changes/breaking-changes) for migration steps.
- Review your `MOCK_METHOD` usages for changes in syntax or requirements.

### Logs and Diagnostic Tips

- Increase verbosity to diagnose mock expectation matches:

```bash
--gmock_verbose=info
```

- For build configuration issues, enable verbose build logs:

```bash
cmake --build . -- VERBOSE=1
```

## 6. Best Practices

- Always specify compiler standards explicitly (C++17 or higher).
- Use `gmock_main` library if you want to use the default `main()` entry point.
- Link test executables with the correct GoogleTest/GoogleMock libraries for your scenario.
- Use `NiceMock` or `StrictMock` based on desired uninteresting call behavior.
- Organize your mocks and tests so that `EXPECT_CALL` expectations are always declared before usage.

---

<Info>
Tip: For detailed build instructions and tips, see the official [GoogleTest README](https://github.com/google/googletest/blob/main/README.md) and the [Mocking Reference](../docs/reference/mocking.md).
</Info>

<Info>
Note: This FAQ focuses specifically on build and configuration problems. For runtime test troubleshooting, refer to [Running and Interpreting Test Results](../guides/getting-started-workflows/running-interpreting-tests.mdx).
</Info>