---
title: "How do I resolve common build or linking errors?"
description: "A collection of answers and checklists for typical build, linking, and dependency errors encountered when integrating GoogleTest or GoogleMock into projects. Covers CMake, Bazel, missing files, incompatible C++ standards, and platform-specific traps."
---

# How do I resolve common build or linking errors?

This page provides practical answers and checklists to help you troubleshoot and resolve common build, linking, and dependency errors encountered when integrating GoogleTest or GoogleMock into your projects. You'll find guidance covering CMake and Bazel build systems, missing files, incompatible C++ standards, and platform-specific pitfalls, enabling you to fix issues efficiently and get your tests compiling and running smoothly.

---

## Frequently Asked Questions

### Why am I getting linking errors when using GoogleMock or GoogleTest?

Linking errors often occur due to missing library dependencies or incorrect linker flags. Ensure your build scripts explicitly link against both GoogleTest and GoogleMock libraries:

- For CMake, link your test executable with `gmock_main` or both `gmock` and `gtest`. For example:

  ```cmake
  target_link_libraries(your_test_target PRIVATE gmock_main)
  ```

- For Bazel, make sure your `BUILD` file depends on the appropriate targets such as `@com_google_googletest//:gmock_main`.

If you only link `gtest` without linking `gmock`, you will get unresolved symbols from mock-related code.

<Tip>
Always double-check your link dependencies to avoid missing any of the required GoogleTest or GoogleMock libraries.
</Tip>

---

### How do I build GoogleTest and GoogleMock with CMake?

GoogleTest ships with a comprehensive CMake build script that also includes GoogleMock. The recommended workflow to build with CMake is:

1. Clone the repository:

   ```sh
   git clone https://github.com/google/googletest.git -b main
   mkdir googletest/build && cd googletest/build
   ```

2. Configure and build:

   ```sh
   cmake ..
   make
   ```

3. Link your tests against the built `gmock_main` or `gmock` targets.

If you want only GoogleTest without GoogleMock, run:

```sh
cmake .. -DBUILD_GMOCK=OFF
```

The `googlemock/CMakeLists.txt` file provides detailed options and handles platform quirks such as Windows builds and shared/static libraries.

<Note>
The maintainers do not officially use CMake internally, so community support is the main source.
</Note>

---

### How do I build GoogleTest and GoogleMock with Bazel?

To integrate GoogleTest and GoogleMock in your Bazel project:

1. Declare the GoogleTest external repository in your `WORKSPACE`:

   ```bazel
   http_archive(
       name = "com_google_googletest",
       urls = ["https://github.com/google/googletest/archive/main.zip"],
       strip_prefix = "googletest-main",
   )
   ```

2. Use the `@com_google_googletest//:gmock_main` target as a dependency when defining your test targets.

3. Write your test with the normal GoogleTest and GoogleMock APIs.

4. Build and run your test using Bazel commands:

   ```sh
   bazel test //path/to:test_target
   ```

Refer to the `getting-started/prerequisites-installation/installation-bazel.mdx` for detailed steps and troubleshooting common issues.

---

### Why do I get complaints about incompatible C++ versions or missing `std::unique_ptr`?

GoogleTest and GoogleMock require **C++17 or later**. Your compiler or build environment must support C++17, and your compiler flags must specify it.

**To fix:**

- In CMake, ensure you specify:
  ```cmake
  set(CMAKE_CXX_STANDARD 17)
  set(CMAKE_CXX_STANDARD_REQUIRED ON)
  ```

- In Bazel, ensure your `cxx_standard` attribute is set to `17` or later.

- Verify your compiler version supports C++17 (GCC 7+, Clang 5+, MSVC 2017+).

- Check for proper standard library includes and linkage.

---

### Why does the linker complain about missing `WinMain` or entry point on Windows?

When using GoogleTest/Bazel in Windows GUI environment, you may get linker errors about missing `WinMain`.

**Solution:**

- Link against the `gmock_main` library instead of `gmock` alone, which provides a main function.

- Use `gmock_main` as your linked target in your build system.

- In CMake, link your tests against `gmock_main` target.

- Ensure your test binary is configured as a console application.

---

### How do I fix errors about missing header files, such as `gmock/gmock.h` or `gtest/gtest.h`?

This usually means your include paths are not correctly set.

**Fixes:**

- Verify you include the `include` directory of GoogleTest and GoogleMock in your compiler's include path.

- In CMake, the targets `gmock` and `gmock_main` propagate the include directories properly if used with `target_link_libraries()`.

- In Bazel, relying on the provided `gmock` rules manages the includes.

- If manual, add include paths to your compiler options, e.g. `-isystem path/to/googletest/include`.

---

### How can I resolve order or dependency problems in multi-module builds?

When you have separate components or shared libraries, order of linking matters.

- Ensure the GoogleMock/GoogleTest static or shared libraries are linked before user code that depends on them.

- For static libraries, the linker pulls only symbols needed from libraries appearing after user code. So, keep libraries in your `link` commands *after* your test objects.

- If you get unresolved symbols at link time, try adding GoogleMock libraries last.

- Verify no mixing of debug/release or CRT runtimes across different linked components.

---

## Troubleshooting Checklists

### Checklist for CMake Build Problems

- [ ] Confirm `gmock` and `gmock_main` targets are added via `add_subdirectory` or `find_package`.
- [ ] Link your test target with `gmock_main` or `gmock` and `gtest` explicitly.
- [ ] Set `CMAKE_CXX_STANDARD` to 17.
- [ ] Check compiler and linker flags in verbose mode.
- [ ] Ensure include paths include GoogleMock and GoogleTest headers.
- [ ] For Windows, check Runtime Library consistency (`/MD`, `/MT` flags) and prefer matching project settings.

---

### Checklist for Bazel Build Issues

- [ ] Verify `WORKSPACE` has GoogleTest properly declared.
- [ ] Use `@com_google_googletest//:gmock_main` or `:gmock` as dependencies.
- [ ] Confirm Bazel uses correct C++ version in `cc_toolchain`.
- [ ] Clean Bazel's cache with `bazel clean` and rebuild.
- [ ] Check for any conflicting rules or multiple versions of GoogleTest/Mock in workspace.

---

## Platform-Specific Notes

### Linux and macOS

- Ensure `pthread` library is linked, which GoogleTest requires.
- When using CMake, GoogleTest's CMake scripts handle this automatically.
- Without CMake, explicitly add `-lpthread` to linker flags.

### Windows

- Pay particular attention to the matching of runtime library settings between your project and GoogleTest/GoogleMock (static vs. dynamic CRT).
- If building with MSVC, avoid mixing `/MD` and `/MT` flags.
- Use `gmock_main` when linking test executables to provide `main` entry point.

---

## Best Practices for Integration

- Always use `EXPECT_CALL` and `ON_CALL` *before* exercising your tests to avoid undefined behavior.
- Use `NiceMock<T>` to suppress warnings about uninteresting calls if appropriate.
- Use diagnostic flags like `--gmock_verbose=info` to debug matching and call sequences.
- Regularly verify and clear expectations using `Mock::VerifyAndClearExpectations()` if you manage mock lifetime manually.

---

## Additional Resources

- [GoogleMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md): practical guides on writing mocks, managing expectations, actions, and matchers.
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md): detailed API doc on mock methods, expectations, and clauses.
- [Getting Started with CMake](https://github.com/google/googletest/blob/main/getting-started/prerequisites-installation/installation-cmake.mdx): step-by-step CMake build guidance.
- [Getting Started with Bazel](https://github.com/google/googletest/blob/main/getting-started/prerequisites-installation/installation-bazel.mdx): Bazel integration guidance.
- [Legacy FAQ](https://github.com/google/googletest/blob/main/docs/gmock_faq.md): answers to common integration questions.

---

By carefully following these checklists, verifying your build configuration, and consulting the related guides, you will be equipped to resolve the common build and linking errors that arise when integrating GoogleTest and GoogleMock.


---

### Example CMakeLists.txt snippet linking GoogleMock:

```cmake
cmake_minimum_required(VERSION 3.13)
project(MyTests CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Add GoogleTest and GoogleMock
add_subdirectory(path/to/googletest)

add_executable(my_test my_test.cc)
target_link_libraries(my_test PRIVATE gmock_main)
```


### Example Bazel BUILD file snippet:

```bazel
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = [
        "@com_google_googletest//:gmock_main",
    ],
)
```


---

If you encounter a build or linking error not covered here, enable verbose build logs, cross-check your include and linker flags, and consult the official GoogleTest and GoogleMock GitHub repositories for community support and issue tracking.

---

## Related Topics

- [Installation with CMake](../getting-started/prerequisites-installation/installation-cmake.mdx)
- [Installation with Bazel](../getting-started/prerequisites-installation/installation-bazel.mdx)
- [Mocking Reference](../api-reference/gmock-apis/mocking-api.mdx)
- [gMock Cookbook](../docs/gmock_cook_book.md)
- [Legacy gMock FAQ](../docs/gmock_faq.md)

---

If you need help, contact support or visit the community forums linked in the support section of the documentation.



