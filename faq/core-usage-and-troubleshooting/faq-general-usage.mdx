---
title: "General Usage FAQs"
description: "Answers to common questions about writing and running tests with GoogleTest and GoogleMock, covering basic workflows, test discovery, and foundational assertions."
---

# General Usage FAQs

This FAQ page addresses the most common questions and scenarios users encounter when writing and running tests with GoogleTest and GoogleMock. It focuses on essential workflows, test discovery methods, and foundational assertions to help you quickly write robust and maintainable tests.

---

## Frequently Asked Questions

### 1. How do I write and run a basic test using GoogleTest?

Start by creating a test case using the `TEST` macro, specifying a test suite and test name. Inside, use assertions like `EXPECT_EQ` or `ASSERT_TRUE` to verify behavior. Compile your test with GoogleTest libraries linked. Run the resulting executable; GoogleTest auto-discovers and runs all defined tests.

Example:

```cpp
#include <gtest/gtest.h>

TEST(MathTest, Add) {
  EXPECT_EQ(2 + 2, 4);
}
```

Compile and run this program, which will report success or failure.

### 2. What is the difference between `EXPECT_` and `ASSERT_` assertions?

- `EXPECT_` assertions are non-fatal failures; the test continues after failure allowing multiple checks within a test.
- `ASSERT_` assertions are fatal failures; the test aborts immediately on failure, preventing further code execution in that test.

Use `EXPECT_` when you want to perform multiple independent checks; use `ASSERT_` when further execution depends on a condition.

### 3. How does GoogleTest discover tests to run?

GoogleTest automatically discovers tests declared using macros like `TEST`, `TEST_F`, `TEST_P`, and `TYPED_TEST`. When you run the test executable, it runs all registered tests by default.

You can filter tests via command-line flags, for example:

```bash
./my_tests --gtest_filter=MathTest.*
```

Runs all tests in the `MathTest` suite.

### 4. How do I create mock classes with GoogleMock?

Define a mock class by inheriting from an interface or class with virtual methods and use the `MOCK_METHOD` macro in the public section. Specify the return type, method name, argument types, and qualifiers.

Example:

```cpp
class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
};
```

Use this mock in tests to set expectations and simulate behavior.

### 5. When should I use `ON_CALL` vs `EXPECT_CALL`?

- Use `ON_CALL` to define default behavior of mock methods without setting expectations on the number or presence of calls.
- Use `EXPECT_CALL` to define expectations about method calls, including count, order, and behavior.

Best practice: use `ON_CALL` for common default handling; use `EXPECT_CALL` sparingly where you want to verify interactions.

### 6. How do I control the strictness of mock objects?

GoogleMock provides wrappers to control warnings/errors on uninteresting calls:

- `NiceMock<T>` suppresses warnings for uninteresting calls.
- `NaggyMock<T>` (default behavior) warns on uninteresting calls.
- `StrictMock<T>` treats uninteresting calls as test failures.

Use these wrappers to tune verbosity and strictness per test.

Example:

```cpp
NiceMock<MockFoo> mock_foo;
EXPECT_CALL(mock_foo, DoSomething());
// Unexpected calls to other methods won't show warnings.
```

### 7. What does "uninteresting call" vs "unexpected call" mean?

- **Uninteresting call**: A call to a mock method without any `EXPECT_CALL` setup. These calls are allowed by default but cause warnings unless suppressed by `NiceMock`.
- **Unexpected call**: A call to a mock method that has `EXPECT_CALL` but no expectation matches the actual call arguments or the call happens more times than allowed. Always causes a test failure.

### 8. How do I specify that a method should never be called?

Set an expectation with `.Times(0)`:

```cpp
EXPECT_CALL(mock_obj, SomeMethod(_)).Times(0);
```

If the method is called, the test will fail.

### 9. How do I order expected calls?

Use the `InSequence` helper to enforce that calls occur in the order declared:

```cpp
{
  ::testing::InSequence seq;

  EXPECT_CALL(mock, FirstCall());
  EXPECT_CALL(mock, SecondCall());
}
```

Calls outside this order will cause failures.

Alternatively, use `EXPECT_CALL(...).After(...)` clauses for partial ordering.

### 10. What do I do if I get "Uninteresting function call" warnings but I intend those calls?

If the calls are expected but you don't want to verify parameters or enforce call count:

- Use `NiceMock` wrapper on your mock to suppress warnings.
- Or add a catch-all `EXPECT_CALL` with `Times(AnyNumber())`.

Example:

```cpp
EXPECT_CALL(mock, Foo(_)).Times(::testing::AnyNumber());
```

---

## Common Issues and Gotchas

### Slow compilation of large mock classes

Move the mock class constructor and destructor definitions out of the header file into a `.cc` file to speed up compile times.

### Mocking non-virtual methods

GoogleMock supports mocking non-virtual methods by creating unrelated mock classes with the same methods and using template-based dependency injection.

### Overloaded functions in mocks

When mocking overloaded functions, define mock methods for each overload and use `using BaseClass::MethodName` to avoid hiding overloads.

### Move-only types

GoogleMock supports mocking methods with move-only parameters and return types. Use lambdas or callable objects in actions when needed.

### Setting default values for return types

Use `::testing::DefaultValue<T>::Set()` to specify custom default return values for mock methods.

### Verifying mocks before destruction

If mocks are heap-allocated and might not be destroyed during test, use `Mock::VerifyAndClearExpectations(&mock)` to forcibly verify expectations.

---

## Troubleshooting

### Unexpected call failures

Run tests with `--gmock_verbose=info` to see detailed traces of all mock function calls and which expectations they matched.

### Uninteresting call warnings

If these warnings are unexpected, check if you forgot to set `EXPECT_CALL` or `ON_CALL` for the method.

### Compilation errors with const parameters on MSVC

MSVC sometimes warns when const is applied to function parameters. The recommended fix is to remove top-level const qualifiers on parameters.

### Excessive calls to mock methods

Make sure your `EXPECT_CALL` declares the correct call count using `.Times()` or controls with `WillOnce()` / `WillRepeatedly()`.

### Mock methods acting like real methods

Ensure the mocked methods are virtual; otherwise, GoogleMock will not intercept calls.

---

## Best Practices

- Use `ON_CALL` to define default behaviors; reserve `EXPECT_CALL` for actual call verification.
- Use sequences or `After` to express call order explicitly.
- Avoid over-specifying argument matchers to reduce test brittleness.
- Prefer `NiceMock` to suppress noisy warnings about uninteresting calls.
- Use `RetiresOnSaturation()` to make expectations retire after they are satisfied, reducing confusion.
- Set custom default values for complex return types when needed.

---

## Related Links

- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html): Detailed recipes for mock class design and usage.
- [Expectations and Actions Reference](../docs/reference/mocking.md): Deep dive into `EXPECT_CALL`/`ON_CALL` clauses.
- [Actions Reference](../docs/reference/actions.md): List of built-in actions for mocks.
- [Matchers Reference](../docs/reference/matchers.md): For crafting argument matchers in expectations.
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md): Intro to tests and assertions.

---

This page serves as your quick-access FAQ for the general usage of GoogleTest and GoogleMock, helping you get started with writing, running, and debugging tests efficiently.
