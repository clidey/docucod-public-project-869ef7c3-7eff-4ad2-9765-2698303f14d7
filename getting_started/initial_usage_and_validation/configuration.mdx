---
title: "Basic Configuration"
description: "Essential guidance on configuring your build system or project to use GoogleTest—including linking libraries, include paths, and integrating with your build workflow. Highlights CMake and Bazel usage, with pointers for other workflows."
---

# Basic Configuration Guide for GoogleTest

This guide provides essential steps to configure your build system or project for using GoogleTest effectively. It covers integrating GoogleTest with your existing build workflows, focusing primarily on CMake and Bazel usage, while also offering pointers for other build systems.

---

## 1. Overview of Configuration Needs

Before running your tests, your project must be configured to locate GoogleTest's headers and libraries, and to link them correctly during the build process. Correct configuration ensures your tests build reliably and run smoothly across platforms.

### Key Configuration Goals:

- Include directories for GoogleTest headers so your test code can compile.
- Link GoogleTest libraries into your test binaries to resolve symbols.
- Integrate GoogleTest build steps seamlessly with your build system.

---

## 2. Configuring with CMake

CMake is the primary recommended method for building and configuring GoogleTest in your projects. It supports both standalone and embedded usage.

### 2.1. Standalone GoogleTest Project

If you build GoogleTest separately, configure your project’s CMakeLists to find and link the installed libraries.

#### Steps:

1. **Find GoogleTest package:**

   Add this line to your `CMakeLists.txt` after installing GoogleTest:
   
   ```cmake
   find_package(GTest CONFIG REQUIRED)
   ```

2. **Include directories and link libraries:**

   Link against the libraries provided by the package:

   ```cmake
   target_link_libraries(your_test_target PRIVATE GTest::gtest GTest::gtest_main)
   ```

3. **Add your test executable:**

   ```cmake
   add_executable(your_test_executable test_main.cpp)
   target_link_libraries(your_test_executable PRIVATE GTest::gtest_main)
   add_test(NAME YourTest COMMAND your_test_executable)
   ```

---

### 2.2. Integrating GoogleTest Source into an Existing Project

For tighter integration, build GoogleTest as part of your project. This avoids compatibility issues such as mismatched compiler or linker flags.

#### Include GoogleTest using `add_subdirectory()`:

1. **Download GoogleTest source** to (or point to) a subdirectory in your project.

2. **Modify your `CMakeLists.txt`**:

   ```cmake
   add_subdirectory(googletest)   # Adjust path accordingly

   add_executable(your_test_executable test_main.cpp)
   target_link_libraries(your_test_executable PRIVATE gtest_main)
   add_test(NAME YourTest COMMAND your_test_executable)
   ```

3. **Configure C++ standard:**

   GoogleTest requires C++17. Ensure the following is in your `CMakeLists.txt`:

   ```cmake
   set(CMAKE_CXX_STANDARD 17)
   set(CMAKE_CXX_STANDARD_REQUIRED ON)
   ```

4. **Handle special compile options for Windows:**

   If you use Visual Studio and encounter runtime library conflicts, set the option:

   ```cmake
   set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
   ```

---

### 2.3. Sample Minimal `CMakeLists.txt` for Tests

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProjectTests CXX)

# Require C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Fetch GoogleTest as part of the build
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.16.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(MyTests test.cpp)
target_link_libraries(MyTests PRIVATE gtest_main)
add_test(NAME MyTests COMMAND MyTests)
```

This method ensures your project downloads and builds GoogleTest alongside your tests automatically.

---

## 3. Configuring with Bazel

GoogleTest integrates smoothly with Bazel as well.

- Add a `BUILD` file where you include GoogleTest sources as a dependency.
- Use the official `@com_google_googletest` repository in your `WORKSPACE` file.

Refer to the Bazel integration guide in the official [GoogleTest GitHub repo](https://github.com/google/googletest/tree/main/googletest).

---

## 4. Key Manual Configuration Pointers for Other Build Systems

If not using CMake or Bazel, manually configure the following:

- **Include path**: Add the path to the GoogleTest headers (e.g., `/path/to/googletest/include`).
- **Source files or libraries**: Link against `gtest` and optionally `gtest_main` binaries or include `.cc` files from GoogleTest source directly.
- **Compiler flags**: Ensure your compiler supports C++17.
- **Linker flags**: Add relevant threading libraries or platform-specific flags (e.g., `-lpthread` on Linux).

This manual setup is less common and requires careful management of library versions and compiler settings.

---

## 5. Common Pitfalls & Best Practices

- **Mismatch in compiler flags between your project and GoogleTest** can cause link errors or runtime issues; embedding GoogleTest in your project build avoids this.

- **Ensure C++17 support** explicitly: Not all environments default to this standard.

- **Handle runtime library linkage on Windows carefully** (static vs dynamic runtimes) using the `gtest_force_shared_crt` option in CMake.

- When **using Google Mock**, link `gmock_main` instead of `gtest_main`.

- Avoid mixing different versions of GoogleTest libraries across your project.

---

## 6. Verification & First Steps After Configuration

1. **Build your test executable** successfully.
2. **Run the tests** and confirm that GoogleTest’s default test runner output appears.
3. **See success indicators** such as reports of tests run and zero failures.

<Tip>
Use `ctest` in CMake projects to automatically run and verify your tests after building.
</Tip>

---

## 7. Troubleshooting Common Configuration Issues

<AccordionGroup title="Troubleshooting Configuration">
<Accordion title="Linker errors related to GoogleTest symbols">
Verify that you link your test target against `gtest` or `gtest_main` libraries correctly. In CMake, ensure:

```cmake
target_link_libraries(your_test_target PRIVATE gtest_main)
```

If building manually, confirm that `-lgtest` and `-lgtest_main` are passed to the linker.
</Accordion>

<Accordion title="Compiler version does not support C++17">
Ensure your compiler and build environment support C++17. Upgrade your compiler or specify the standard explicitly:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

If using GCC or Clang manually, add flags `-std=c++17`.
</Accordion>

<Accordion title="Conflicts with runtime libraries on Windows using Visual Studio">
Set the following CMake option to unify runtime libraries between your project and GoogleTest:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This avoids `LNK2038` errors and runtime incompatibilities.
</Accordion>
</AccordionGroup>

---

## 8. Additional Resources

- [GoogleTest on GitHub](https://github.com/google/googletest)
- [GoogleTest CMake Usage](https://github.com/google/googletest/blob/main/README.md#build-with-cmake)
- [GoogleMock Documentation](https://google.github.io/googletest/gmock_for_dummies.html) for mocking integration
- Related guides: [Installation & Build Options](../intro_and_setup/installation_options), [Write and Run Your First Test](../initial_usage_and_validation/your_first_test)

---

Successfully configuring your project with GoogleTest lays the foundation for reliable, automated C++ tests that integrate tightly with your build system and development workflow. Use this guide to confidently set up, then move on to authoring your first tests.
