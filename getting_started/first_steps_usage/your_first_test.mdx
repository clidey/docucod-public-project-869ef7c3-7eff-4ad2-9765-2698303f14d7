---
title: "Your First Test Case"
description: "Write and run your first test with GoogleTest and GoogleMock. Learn test file structure, essential macros, and the basics of compiling and running tests to validate everything is working as expected."
---

# Your First Test Case

Welcome to the first step in validating your C++ code with GoogleTest and GoogleMock. This guide will walk you through writing, compiling, and running your very first test case using GoogleTest’s core macros and basic test file structure. By the end, you'll verify your test environment works as expected, empowering you to build comprehensive tests.

---

## 1. Setting Up Your Test File Structure

To begin, create a new C++ source file for your tests. Conventionally, test files are named with a `_test.cc` or `_unittest.cc` suffix to distinguish them from production code.

**Example:** `sample_test.cc`

Inside this file, include the necessary GoogleTest header:

```cpp
#include <gtest/gtest.h>
```

If you intend to use mocking capabilities, also include GoogleMock:

```cpp
#include <gmock/gmock.h>
```

> Note: If you use GoogleMock, initialize it accordingly when running tests (covered later).


## 2. Writing Your First Simple Test Using GoogleTest

GoogleTest organizes tests into _test suites_ and _tests_. Use the `TEST(TestSuiteName, TestName)` macro to define an individual test inside a suite.

### Step-by-Step Example

```cpp
// Define a test suite named SampleTest with a test named DoesBasicAssertions
TEST(SampleTest, DoesBasicAssertions) {
  // Expect two values to be equal
  EXPECT_EQ(1 + 1, 2);
  // Expect a boolean condition to be true
  EXPECT_TRUE(3 > 2);
}
```

**Details:**
- `SampleTest` is the test suite name — group logically related tests here.
- `DoesBasicAssertions` is the individual test name inside the `SampleTest` suite.
- `EXPECT_EQ` checks equality; `EXPECT_TRUE` tests boolean expressions.

### What Happens When you Run This Test?
- The test passes if all assertions succeed.
- If an assertion fails, GoogleTest outputs file, line, and failure details.


## 3. Using Test Fixtures for Shared Setup

When multiple tests share the same context, use a test fixture class. This class inherits from `testing::Test` and allows you to initialize or clean up common data for all tests.

### Example Test Fixture and Tests

```cpp
class SampleFixture : public testing::Test {
 protected:
  void SetUp() override {
    data_ = 42;
  }

  int data_;
};

// Using the fixture defined above, write tests
TEST_F(SampleFixture, DataIsInitialized) {
  EXPECT_EQ(data_, 42);
}

TEST_F(SampleFixture, ArithmeticCheck) {
  EXPECT_GT(data_ + 8, 40);
}
```

- `SetUp()` runs before each test in the fixture.
- Use `TEST_F(FixtureName, TestName)` to write tests using the fixture.
- `data_` is accessible in all tests in `SampleFixture`.


## 4. Building and Compiling Your Test

### Prerequisites

- Ensure **GoogleTest and GoogleMock** are installed and accessible.
- If using CMake, link your test target against `gtest` and/or `gmock_main` (for main function).

### Example CMakeLists.txt snippet

```cmake
add_executable(SampleTest sample_test.cc)
target_link_libraries(SampleTest gtest_main gmock_main)
```

### Compile Command (without CMake)

```bash
clang++ -std=c++17 -isystem /path/to/googletest/include \
          -pthread sample_test.cc /path/to/libgtest.a /path/to/libgmock.a -o SampleTest
```

### Common Pitfall

- Failing to link `gtest_main` or provide your own `main()` function.
- Missing `-pthread` on Linux.


## 5. Running Your First Test

Once built, run your test executable from the command line:

```bash
./SampleTest
```

### Expected Sample Output

```
Running main() from gmock_main.cc
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from SampleTest
[ RUN      ] SampleTest.DoesBasicAssertions
[       OK ] SampleTest.DoesBasicAssertions (0 ms)
[ RUN      ] SampleTest.DataIsInitialized
[       OK ] SampleTest.DataIsInitialized (0 ms)
[----------] 2 tests from SampleTest (0 ms total)
[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

The message confirms that your tests passed.


## 6. Writing Your First Test with GoogleMock

GoogleMock extends GoogleTest with mocking capabilities.

### Defining a Mock Class

Begin by defining an interface (abstract class) and a mock implementation:

```cpp
#include <gmock/gmock.h>

class FooInterface {
 public:
  virtual ~FooInterface() = default;
  virtual int Bar(int x) = 0;
};

class MockFoo : public FooInterface {
 public:
  MOCK_METHOD(int, Bar, (int x), (override));
};
```

### Writing a Test Using the Mock

```cpp
TEST(FooTest, ReturnsExpectedValue) {
  MockFoo mock;

  // Expect Bar() to be called once with argument 5 and return 10
  EXPECT_CALL(mock, Bar(5))
      .Times(1)
      .WillOnce(::testing::Return(10));

  int result = mock.Bar(5);
  EXPECT_EQ(result, 10);
}
```

### Key Points

- `MOCK_METHOD` defines mocked methods.
- `EXPECT_CALL` sets expectations on mock behavior.
- `WillOnce(Return(value))` specifies return values.
- `Times(1)` indicates expected call count.


## 7. Understanding Test Outcomes

- Tests pass when no failure occurs.
- Failures detail which assertion failed, including expected vs actual.
- Use `ASSERT_*` for fatal assertions that abort the current test function.
- Use `EXPECT_*` for non-fatal assertions that continue after failure.


## 8. Helpful Tips and Best Practices

- Name test suites and test cases clearly and consistently without underscores.
- Use `TEST_F` with fixtures for tests sharing setup.
- Link with `gmock_main` for proper initialization and main function.
- Keep tests independent and isolated.
- Utilize `EXPECT_CALL` to verify interactions with mocks.


## 9. Troubleshooting Common Issues

<Accordion title="Test Not Running or Discovered">
Verify you included `testing::InitGoogleTest(&argc, argv);` or `testing::InitGoogleMock(&argc, argv);` before calling `RUN_ALL_TESTS()` in your `main()`.

Make sure test files are linked into your test executable.
</Accordion>

<Accordion title="Linker Errors Related to gtest_main or gmock_main">
Ensure your build links against `gtest_main` or `gmock_main` if you don't provide a main function yourself.

If linking manually, include `-lgtest_main -lgmock_main` in linker flags.
</Accordion>

<Accordion title="Compiler Errors with MOCK_METHOD">
Check that method signatures are correctly wrapped with parentheses if arguments contain commas. See the Mocking Reference for examples.

Ensure `override` is used if mocking virtual methods.
</Accordion>


## 10. Next Steps

Now that you have written and run your first test successfully, explore:

- Writing tests with _fixtures_ for shared setup.
- Defining complex expectations with GoogleMock.
- Integrating tests into your build system with CMake or Bazel.
- Understanding test assertions in depth.
- Managing test environments and custom event listeners.

You can proceed to detailed guides on [Writing Your First Test](../../guides/getting-started/writing-your-first-test) and [Mocking with GoogleMock](../../guides/advanced-testing/mocking-with-googlemock).

---

## Example Main Function for Custom Setup

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes both GoogleMock and GoogleTest
  return RUN_ALL_TESTS();                // Runs all registered tests
}
```


---

## References

- [GoogleTest Primer](../../docs/primer.md)
- [Installation & Build Integration](../../getting_started/essentials_setup/installation.md)
- [Matchers Reference](../../docs/reference/matchers.md)
- [Mocking with GoogleMock](../../guides/advanced-testing/mocking-with-googlemock.md)


---

For complete API details and advanced usage, consult the [GoogleTest API Reference](../../api-reference/core-testing-api/test-structure.md) and [GoogleMock Mock Classes](../../api-reference/mocking-apis/mock-classes.md).

---

<Info>
You are now equipped to write structured GoogleTest and GoogleMock tests. Remember, successful tests lay the foundation for reliable, maintainable software development.
</Info>


---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/primer.md", "range": "1-250"},{"path": "docs/reference/testing.md", "range": "1-210"},{"path": "docs/reference/mocking.md", "range": "1-150"}]} />
