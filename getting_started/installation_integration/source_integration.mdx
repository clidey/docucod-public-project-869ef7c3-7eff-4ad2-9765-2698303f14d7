---
title: "Source Inclusion & Manual Integration"
description: "Instructions for manually integrating GoogleTest into a project by adding source files directly. Suitable for custom build systems or environments without CMake/Bazel support. Explains which headers and sources are essential, and offers sample project structures."
---

# Source Inclusion & Manual Integration

This guide explains how to manually integrate GoogleTest into your C++ project by adding source files directly. This approach is ideal for projects that use custom build systems or environments where automated build tools like CMake or Bazel are unavailable.

Manual integration requires careful inclusion of headers and sources to ensure proper compilation and linking. This document will guide you through the essential files, recommended project structure, and key integration tips.

---

## 1. Why Manually Integrate GoogleTest?

Many projects do not use build systems with built-in support for external dependencies like CMake or Bazel. In these cases, GoogleTest's source code can be included directly in the project to allow compilation and linking with minimal dependencies.

Manual integration:

- Avoids dependency on external build tools.
- Provides flexibility to adapt GoogleTest in complex or legacy environments.
- Enables you to inspect and modify GoogleTest sources if necessary.

However, it requires a clear understanding of which files to include and how to organize them.

---

## 2. Required Headers and Source Files

GoogleTest consists of header files and source files that must be compiled and linked together. When manually including sources, these are the essentials:

### 2.1 Required Headers

At a minimum, your code needs to include:

```cpp
#include "gtest/gtest.h"
```

This header provides the full GoogleTest API including test macros, assertions, and the test runner interface.

### 2.2 Core Source Files

To compile the GoogleTest core framework, include these source files in your build:

- `googletest/src/gtest-all.cc` — The main implementation file that compiles all core GoogleTest source files internally.

Alternatively, if custom selective compilation is needed, you may include individual `.cc` files from `googletest/src/`, but `gtest-all.cc` is recommended for simplicity.

### 2.3 GoogleMock Sources (Optional)

If you intend to use GoogleMock (the mocking extension), manually include:

- `googlemock/src/gmock-all.cc` — This compiles GoogleMock and GoogleTest sources together along with mocking support.

For minimal mocking without main, `gmock-gtest-all.cc` can be used, but `gmock-all.cc` suffices for typical needs.

### 2.4 Main Function (Optional)

GoogleTest does not provide a `main()` function by default. For convenience, you can link with:

- `googlemock/src/gmock_main.cc` — Provides a basic `main()` that initializes and runs all tests.

This is useful if your project does not already define a `main()` for the test executable.

---

## 3. Sample Project Structure

Here's an example layout for manually integrated GoogleTest sources and headers:

```plaintext
/my_project
  /third_party
    /googletest
      /include
        /gtest
          gtest.h
          gtest_pred_impl.h
          ...
      /src
        gtest-all.cc
        gtest_main.cc
    /googlemock
      /include
        /gmock
          gmock.h
          gmock_nice_strict.h
          ...
      /src
        gmock-all.cc
        gmock_main.cc
  /tests
    sample_test.cc
  Makefile  # or build scripts
```

### Notes:

- Add the `/include` directories to your compiler's include path.
- Compile `gtest-all.cc` and/or `gmock-all.cc` along with your test source code.
- If using `gmock_main.cc` or `gtest_main.cc`, compile and link these as well to get the test runner executable.

---

## 4. Step-by-Step Manual Integration

Follow these steps to integrate GoogleTest manually:

<Steps>
<Step title="Step 1: Copy Source and Headers">
Download or clone the GoogleTest repository. From the `googletest` and `googlemock` directories, copy the `include` and `src` folders into your project or reference them via your build system.
</Step>
<Step title="Step 2: Configure Include Paths">
Add the `googletest/include` and `googlemock/include` directories to your compiler's include search paths. For example, pass `-I/path/to/googletest/include` to your compiler.
</Step>
<Step title="Step 3: Add Source Files to Build">
Add `gtest-all.cc` (for GoogleTest) or `gmock-all.cc` (for GoogleMock + GoogleTest) source files to your build system or compile commands.
If you want GoogleTest's default main, include `gtest_main.cc`. For GoogleMock main, include `gmock_main.cc`.
</Step>
<Step title="Step 4: Write Your Tests">
Create your test files — for example, in `/tests/sample_test.cc` — and include GoogleTest headers:
```cpp
#include "gtest/gtest.h"

TEST(SampleTest, Example) {
  EXPECT_EQ(1, 1);
}
```
</Step>
<Step title="Step 5: Build and Link Your Test Executable">
Compile all source files together:

```bash
# Example using g++
g++ -std=c++17 -I/path/to/googletest/include \
    -I/path/to/googlemock/include \
    tests/sample_test.cc \
    /path/to/googletest/src/gtest-all.cc \
    /path/to/googlemock/src/gmock-all.cc \
    -pthread -o sample_test
```

Adjust paths according to your project setup.
</Step>
<Step title="Step 6: Run Your Tests">
Execute your test binary:

```bash
./sample_test
```

You should see GoogleTest running and reporting results.
</Step>
</Steps>

---

## 5. Best Practices and Tips

- **Use `gtest-all.cc` and `gmock-all.cc` for simplicity.** They aggregate sources internally.
- **Link with `-pthread` on Linux/macOS** to ensure threading support.
- **If your environment does not support exceptions, make sure to disable them** as appropriate to your build.
- **Use `gmock_main.cc` if you want a main function provided**; otherwise define your own main that calls `testing::InitGoogleTest()` and `RUN_ALL_TESTS()`.
- **Keep GoogleTest source files separate** in your version control for clarity and easier updates.
- **Refer to GoogleTest documentation if using advanced flags or custom environment setup.**

---

## 6. Troubleshooting

<AccordionGroup title="Common Issues & Solutions">
<Accordion title="Compilation Errors Related to Include Paths">
Ensure the compiler include paths explicitly include GoogleTest's and GoogleMock's `include/` directories. For example, missing `gtest/gtest.h` indicates your include path is not set correctly.
</Accordion>
<Accordion title="Linker Errors for GoogleTest Symbols">
Verify that `gtest-all.cc` or `gmock-all.cc` is compiled and linked with your test binary. Missing this will cause undefined references.
</Accordion>
<Accordion title="Multiple Definition Errors for main()">
If you link both `gtest_main.cc` and `gmock_main.cc` or define your own `main()`, you will get conflicts. Use only one main function.
</Accordion>
<Accordion title="Thread Support Errors (e.g., undefined pthread) on Unix">
Add `-pthread` to your compiler and linker flags when building.
</Accordion>
<Accordion title="Test Executable Runs but Finds No Tests">
Confirm your test source files include GoogleTest macros such as `TEST()` and that the symbols are linked.
</Accordion>
</AccordionGroup>

---

## 7. Additional Resources

- [GoogleTest Official GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/googletest/docs/primer.md)
- [Installing with CMake](../installation_integration/install_cmake)
- [Installing with Bazel](../installation_integration/install_bazel)
- [Writing Your First Test](../../first_test_run_validation/write_first_test)
- [GoogleMock Integration](https://github.com/google/googletest/tree/main/googlemock)

---

Manual source inclusion gives you full control over GoogleTest integration in any build environment. By following these instructions, you can build and run your first tests with confidence even in custom or legacy setups.

For complete onboarding, consider exploring automated installation through build systems for easier maintenance as your project grows.

---