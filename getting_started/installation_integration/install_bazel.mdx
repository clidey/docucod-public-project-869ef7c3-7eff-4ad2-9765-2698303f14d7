---
title: "Installing with Bazel"
description: "Step-by-step guidance for incorporating GoogleTest into a Bazel project. Highlights include workspace changes, build rule configuration, and running sample test targets. This page builds confidence for users relying on Bazel or transitioning to it."
---

# Installing with Bazel

This guide provides clear, step-by-step instructions to incorporate GoogleTest into your Bazel project. Whether you are starting fresh with Bazel or transitioning from another build system, this documentation will help you configure your workspace, write Build rules, and successfully build and run your first GoogleTest targets using Bazel.

---

## 1. Prerequisites & System Requirements

Before you begin, ensure your development environment meets the following requirements:

- **Operating System**: Linux, macOS, or Windows
- **Compiler**: A C++ compiler supporting at least C++17 (e.g., GCC, Clang, MSVC)
- **Bazel**: Version 7.0 or later installed ([Get Bazel here](https://bazel.build/install))

Refer to the [Prerequisites & Supported Platforms](../setup_requirements/prerequisites_platforms) page for a detailed overview.

---

## 2. Setting Up Your Bazel Workspace

Your Bazel workspace is the root directory where you will define your project's build configurations.

### Step 1: Create Workspace Directory

Open a terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Create the MODULE.bazel File

Within your workspace root, create a file named `MODULE.bazel` with the following content:

```bazel
# MODULE.bazel

# Specifies the version of the googletest module to use.
bazel_dep(name = "googletest", version = "1.17.0")
```

> Replace `1.17.0` with the latest GoogleTest version from the [Bazel Central Registry](https://registry.bazel.build/modules/googletest).

This configuration declares GoogleTest as a dependency using Bazel's module system (Bzlmod).

<Tip>
Using Bzlmod (`MODULE.bazel`) is the current recommended way to consume GoogleTest in Bazel 7.0+ environments.
</Tip>

---

## 3. Writing Your First Test

Create a C++ test file in your workspace directory. For example, create `hello_test.cc` with the following code:

```cpp
#include <gtest/gtest.h>

// A simple test case demonstrating basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Strings are not equal
  EXPECT_EQ(7 * 6, 42);              // Numeric equality
}
```

---

## 4. Writing a Bazel BUILD File

To build your test, you need a `BUILD` file that instructs Bazel how to compile and link your test.

Create a file named `BUILD` in the same directory as your source file with:

```bazel
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

Explanation:

- `cc_test` declares a C++ test target with the name `hello_test`.
- `srcs` lists the source files to compile.
- `deps` links the GoogleTest library and its main function provided by the module dependency declared in `MODULE.bazel`.

---

## 5. Building and Running Your Test

### Build the Test

Run the following command to build and test your `hello_test` target, specifying C++17 standards explicitly:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

Expected output highlights:

- Bazel analyzes the target and dependencies.
- Compilation completes successfully.
- Test runs and reports 1 passed test.

Example snippet of successful test output:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
```

<Tip>
For MSVC compilers on Windows, the equivalent C++17 flag is `--cxxopt=/std:c++17`.
</Tip>

---

## 6. Understanding Bazel Workspace and Build Rules

### GoogleTest Modules

- In your `MODULE.bazel`, the `bazel_dep` entry imports GoogleTest and its dependencies automatically.

- GoogleTest’s Bazel `BUILD` files define libraries like `gtest`, `gtest_main`, and test targets such as sample unit tests.

### Dependencies and Linking

- The `@googletest//:gtest` library contains the core GoogleTest framework.

- The `@googletest//:gtest_main` library provides the entry point (main function) for the test executable.

By linking both in your `BUILD` file, Bazel handles compilation and linkage appropriately.

---

## 7. Best Practices & Tips

- **Use Bzlmod** (`MODULE.bazel`) whenever possible rather than the old `WORKSPACE` approach, as it improves dependency management.

- **Set Compiler Options** explicitly via Bazel flags (`--cxxopt`) to ensure C++17 standard compliance.

- Keep GoogleTest versions up-to-date in your `MODULE.bazel` file by checking the [Bazel Central Registry](https://registry.bazel.build/modules/googletest).

- For larger projects, organize your tests into subdirectories with their own `BUILD` files, each linking to `@googletest` as needed.

- Explore linking with `@googletest//:gtest_for_library` if you need test-only dependencies for libraries.

---

## 8. Troubleshooting Common Issues

<AccordionGroup title="Common Problems & Solutions">
<Accordion title="Bazel version too low or missing">
Ensure you have Bazel 7.0 or later installed by running:

```bash
bazel version
```

If Bazel is not installed or outdated, install or upgrade it through the official [installation guide](https://bazel.build/install).
</Accordion>
<Accordion title="Compiler does not support C++17">
Verify your compiler supports C++17. For GCC, Clang, or MSVC, check your version:

```bash
g++ --version
clang++ --version
cl.exe
```

Set `--cxxopt=-std=c++17` (or MSVC equivalent) when running Bazel to enforce C++17.
</Accordion>
<Accordion title="BUILD file reports missing dependencies">
Double-check that your `BUILD` file includes `@googletest//:gtest` and `@googletest//:gtest_main` in the `deps` field.

If you modified `MODULE.bazel`, run `bazel sync` to reload dependencies.
</Accordion>
<Accordion title="Tests are not discovered or run">
Make sure your test targets use `cc_test` rather than `cc_binary`.

Run Bazel with `--test_output=all` to see detailed test logs.
</Accordion>
</AccordionGroup>

---

## 9. Next Steps

- Write your own test cases exploring [GoogleTest assertions](../../guides/getting-started/essential-assertions).
- Learn how to organize tests with fixtures, parameterized tests, and mocks.
- Explore [Using GoogleTest with CMake](../installation_integration/install_cmake) if your project uses that build system.
- Check out the [Writing Your First Test](../../first_test_run_validation/write_first_test) and [Building and Running Tests](../../first_test_run_validation/build_run_test) tutorials to deepen your understanding.

---

## Useful References

- [GoogleTest Bazel Central Registry Module](https://registry.bazel.build/modules/googletest)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)
- [GoogleTest Prerequisites & Platforms](../setup_requirements/prerequisites_platforms)
- [GoogleTest Primer](../../guides/getting-started/setup-environment)

---

Congratulations! You are now equipped to add GoogleTest into your Bazel build, write and run tests confidently, and proceed to extend your test suite with GoogleTest’s powerful features.
