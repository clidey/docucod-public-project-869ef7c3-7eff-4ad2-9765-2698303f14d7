---
title: "Integration with C++ Environments"
description: "Explains how GoogleTest can be integrated into build systems and development workflows, including support for CMake, Bazel, and various compilers and platforms. Briefly touches on future dependencies such as Abseil."
---

# Integration with C++ Environments

## Seamless Build System Integration for GoogleTest

Integrating GoogleTest into your C++ development workflow unlocks powerful automated testing with minimal friction. This page guides you through how GoogleTest fits into common build environments, enabling you to focus on writing and maintaining reliable tests rather than on build complexities.

Whether you use CMake, Bazel, or other build systems, GoogleTest is designed to adapt and integrate smoothly, supporting diverse compilers and platforms. We also touch on future dependencies such as Abseil, helping you prepare for more advanced features down the line.

---

## Why Integration Matters

Integrating GoogleTest effectively with your build system means:

- **Consistent, repeatable test builds** from source,
- **Simplified dependency management,**
- **Access to pre-built test runners,** and
- **Cross-platform compilation compatibility.**

This foundation enables rapid test development and seamless Continuous Integration (CI) pipelines.

---

## Supported Build Systems and Methods

### Building with CMake

GoogleTest is shipped with a robust CMake configuration that works out-of-the-box for many platforms:

1. **Standalone Build:**
   - Clone the GoogleTest repository:

   ```bash
   git clone https://github.com/google/googletest.git -b v1.17.0
   cd googletest
   mkdir build
   cd build
   cmake ..
   make
   sudo make install
   ```

   This build includes GoogleMock by default. To build GoogleTest only, run:

   ```bash
   cmake .. -DBUILD_GMOCK=OFF
   ```

2. **Including in Your Existing CMake Project:**
   Use CMake's `FetchContent` module to pull GoogleTest at configure time:

   ```cmake
   include(FetchContent)
   FetchContent_Declare(
     googletest
     URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
   )
   set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For matching runtime library settings on Windows
   FetchContent_MakeAvailable(googletest)

   add_executable(my_test test.cpp)
   target_link_libraries(my_test gtest_main)  # or gtest
   add_test(NAME MyTest COMMAND my_test)
   ```

   This method ensures full compatibility by using the same compiler and linker settings.

3. **C++ Standard Version:**
   GoogleTest requires at least C++17. Specify this in your `CMakeLists.txt`:

   ```cmake
   set(CMAKE_CXX_STANDARD 17)
   set(CMAKE_CXX_STANDARD_REQUIRED ON)
   ```

4. **Multithreaded Environment:**
   If you're running tests on systems with `pthread`, GoogleTest automatically uses it. Otherwise, you can override with:

   ```bash
   -DGTEST_HAS_PTHREAD=1
   ```

5. **Shared Library Builds:**
   To build GoogleTest as a DLL/shared library, define:

   ```bash
   -DGTEST_CREATE_SHARED_LIBRARY=1
   ```

   Then compile your tests with:

   ```bash
   -DGTEST_LINKED_AS_SHARED_LIBRARY=1
   ```

### Building with Bazel

Although not covered in detail here, GoogleTest supports Bazel builds. Ensure you refer to your project's Bazel configuration files where GoogleTest is defined as a dependency. Bazel's sandboxing and hermetic builds enhance test reproducibility.

### Other Build Systems

You can also integrate GoogleTest with Makefiles, Visual Studio projects, Xcode, and other custom build scripts by adding the GoogleTest source code or linking against installed libraries. The key is directing your compiler and linker to the correct headers and static/shared libraries.

---

## Using GoogleMock with Your Build

GoogleMock is included by default in GoogleTest builds started via CMake. It is provided as two libraries:

- `gmock` — GoogleMock without a main function.
- `gmock_main` — GoogleMock including a main function that calls `RUN_ALL_TESTS()`.

Example CMake linking:

```cmake
target_link_libraries(my_test gmock_main)
```

This simplifies your test executable setup.

---

## Compiler and Platform Support

GoogleTest supports a wide range of compilers such as GCC, Clang, MSVC, and others on Linux, Windows, and macOS. It is compatible with environments where exceptions may be disabled and supports varying runtime libraries.

Ensure the C++ standard requirements and threading options are properly configured to avoid integration issues.

---

## Preparing for Future Dependencies (Abseil)

GoogleTest plans to incorporate the Abseil library for certain utilities and abstractions. While this is not mandatory yet, future versions may require Abseil as a dependency.

It's advisable to be aware of this if you maintain strict dependency policies or use custom build systems, so you can plan accordingly.

---

## Best Practices for Integration

- **Isolate test builds:** Keep tests separate from production code in your build system for clarity.
- **Use provided CMake targets:** Link against `gtest`, `gtest_main`, `gmock`, and `gmock_main` rather than manual source files.
- **Match compiler flags:** Ensure GoogleTest is built with the same compiler flags and C++ standard as your application.
- **Leverage your CI:** Configure your Continuous Integration pipeline to build and run tests automatically using the integration methods here.
- **Monitor dependencies:** Stay updated on GoogleTest releases for changes in dependencies like Abseil.

---

## Troubleshooting Integration Issues

<Tip>
Verify that your compiler command line includes the correct `-I` paths to GoogleTest headers, and link against the right libraries. Linking errors usually indicate a mismatch here.
</Tip>

<Tip>
If you experience runtime issues, ensure your test runner correctly initializes GoogleTest using `testing::InitGoogleTest()` before calling `RUN_ALL_TESTS()`.
</Tip>

<Tip>
On Windows with Visual Studio, use `gtest_force_shared_crt` CMake option to avoid runtime library conflicts.
</Tip>

---

## Example: Basic CMake Integration

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp my_tests.cpp)
target_link_libraries(my_tests gtest_main gmock_main)
add_test(NAME MyTests COMMAND my_tests)
```

Setup your test entry point in `test_main.cpp`:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This minimal setup compiles and runs your tests seamlessly.

---

## Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/docs/primer.html) — Understand basic concepts and test writing.
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md) — For mocking-related integration.
- [CMakeLists.txt in GoogleTest repository](https://github.com/google/googletest/blob/main/CMakeLists.txt) — View the official build configuration.

---