---
title: "Integration with Build Systems"
description: "Learn how GoogleTest integrates with popular build systems (CMake, Bazel, etc.), and how it can be brought into modern C++ projects through simple configuration. Point to quickstart guides for immediate hands-on testing."
---

# Integration with Build Systems

Integrating GoogleTest into your C++ projects is straightforward and flexible, thanks to built-in support for popular build systems like CMake and Bazel. This page guides you through how to incorporate GoogleTest into modern C++ workflows, enabling you to run automated tests effortlessly as part of your build process.

---

## Why Integrate GoogleTest with Your Build System?

Seamless build system integration allows you to:

- **Automate test discovery and execution** within your existing build commands.
- **Maintain consistent compiler and linker settings** between production code and tests.
- **Easily configure dependencies** without manual file management.
- **Leverage modern build tools** for scalable, maintainable projects.

By embedding GoogleTest in your build, you create a reliable test environment where every code change can be validated automatically, improving code quality and developer productivity.

---

## GoogleTest Integration with CMake

CMake offers a cross-platform way to build GoogleTest, whether as a standalone project or integrated into your existing codebase.

### Standalone GoogleTest Build

1. **Clone the GoogleTest repository** with the stable version tag:

   ```bash
   git clone https://github.com/google/googletest.git -b v1.17.0
   cd googletest
   ```

2. **Create a Build Directory** and generate the build system files:

   ```bash
   mkdir build
   cd build
   cmake ..
   ```

   > To build *only* GoogleTest (without GoogleMock), run:

   ```bash
   cmake .. -DBUILD_GMOCK=OFF
   ```

3. **Build and install:**

   ```bash
   make
   sudo make install
   ```

   For Windows, use Visual Studio to open the generated solution (`gtest.sln`) and build.

### Using GoogleTest in Your Existing CMake Project

You can either link against an installed GoogleTest or build GoogleTest as part of your project. The latter ensures consistent compiler flags and environment.

#### Recommended: Add GoogleTest as a Subdirectory

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# Required for Windows dynamic runtime compatibility
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp my_code.cpp)
target_link_libraries(my_tests PRIVATE gtest_main)
add_test(NAME my_tests COMMAND my_tests)
```

#### Key Points

- Requires **CMake 3.14+** for `FetchContent_MakeAvailable()`.
- The option `gtest_force_shared_crt` helps resolve runtime linkage problems on Windows.
- Link your test targets against `gtest` or `gtest_main` for convenience.

### Practical Example

`CMakeLists.txt` snippet in your project:

```cmake
cmake_minimum_required(VERSION 3.16)
project(MyProject LANGUAGES CXX)

---

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/v1.17.0.tar.gz
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test/test_example.cpp)

# Link GoogleTest libraries
target_link_libraries(my_tests PRIVATE gtest_main)

enable_testing()
add_test(NAME RunMyTests COMMAND my_tests)
```

Arrange your source structure with tests in `test/` and include GoogleTest as shown.

---

## GoogleTest Integration with Bazel

Bazel users can integrate GoogleTest using the provided BUILD configurations.

### Using the Provided Bazel Targets

- The `gtest` library is available via the `//:gtest` target.
- For test executables, link against `gtest_main` to get the `main()` function.

Example BUILD file:

```starlark
cc_test(
    name = "my_tests",
    srcs = ["test_example.cc"],
    deps = [":gtest_main"],
)
```

### Key Bazel BUILD Targets for GoogleTest

| Target         | Description                                           |
|----------------|-------------------------------------------------------|
| `:gtest`       | Library with GoogleTest source code                    |
| `:gtest_main`  | Includes `main()` function to run tests               |
| `:gtest_for_library` | Alias for `:gtest`, marked as `testonly`         |

### Practical Tips

- The library includes both GoogleTest and GoogleMock sources.
- Bazel adds appropriate compiler and linker flags, including pthread where relevant.
- Test your integration by running `bazel test //:my_tests`.

---

## Quick-Start Links

For immediate hands-on usage, see:

- [Writing and Running Your First Test](/getting-started/first-steps-validation/writing-first-test)
- [Installation (CMake, Bazel, Manual)](/getting-started/setup-overview/installation-guide)

---

## Best Practices & Troubleshooting

- Always match your compiler and standard settings between your project and GoogleTest.
- On Windows, set `gtest_force_shared_crt` to avoid Runtime Library mismatches.
- If tests are not discovered or linked correctly, ensure proper target dependencies.
- Prefer integrating GoogleTest as a subdirectory in CMake rather than relying on installed system versions for stability.

---

## Summary

Integrating GoogleTest with your build system leverages its full power to automate and enforce quality in your C++ projects. Whether using CMake or Bazel, straightforward configuration enables test execution as a natural part of the build process, boosting confidence and accelerating development cycles.

---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest CMake Build Instructions](https://github.com/google/googletest/blob/main/googletest/README.md#build-with-cmake)
- [GoogleTest Bazel BUILD file](https://github.com/google/googletest/blob/main/BUILD.bazel)
- [Writing and Running Your First Test](/getting-started/first-steps-validation/writing-first-test)
- [Installation Guide](/getting-started/setup-overview/installation-guide)


---

<AccordionGroup title="Additional Build System Integration Details">
<Accordion title="CMake Project Incorporation Details">
GoogleTest can be added to your CMake project via `add_subdirectory()` or FetchContent method, allowing your tests to build with the same compiler flags and environment settings. Use targets like `gtest` and `gtest_main` for linking your test executables. Set `gtest_force_shared_crt` option on Windows to align runtimes.
</Accordion>
<Accordion title="Bazel Build Configuration">
The Bazel `BUILD.bazel` file defines `cc_library` targets for `gtest` and `gtest_main`. Link your test targets to `:gtest_main` to get an executable with a `main()` entry point that runs all tests. Bazel automatically manages dependencies and platform-specific flags.
</Accordion>
</AccordionGroup>

---

<Steps>
<Step title="Clone GoogleTest repository">
Clone the desired release branch, e.g., v1.17.0.
</Step>
<Step title="Build GoogleTest">
Use CMake or Bazel according to your build system, following the prescribed commands.
</Step>
<Step title="Integrate into Project">
Link against GoogleTest libraries and add test execution commands.
</Step>
<Step title="Run Tests">
Build and run your tests as part of your regular build process.
</Step>
</Steps>

---

<Tip>
To avoid runtime linkage errors on Windows in CMake, always set `gtest_force_shared_crt` to ON if your main project uses dynamic runtime libraries.
</Tip>

<Note>
Ensure that your C++ compiler supports at least C++17 to successfully build GoogleTest.
</Note>

<Warning>
Mixing different versions of GoogleTest libraries or mismatched compiler flags between your project and GoogleTest can cause build or linkage failures.
</Warning>
