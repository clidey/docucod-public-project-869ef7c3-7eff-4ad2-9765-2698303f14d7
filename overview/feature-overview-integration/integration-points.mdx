---
title: "Integration & Build System Support"
description: "Learn how GoogleTest and GoogleMock connect with C++ build systems like CMake and Bazel, and how they fit into automated workflows. Discover entry points and reference files for seamless integration into your existing development process."
---

# Integration & Build System Support

Harness the full power of GoogleTest and GoogleMock by seamlessly integrating them with your C++ build systems like CMake and Bazel. This guide explains how these testing frameworks fit naturally within automated build and continuous integration (CI) workflows, enabling you to embed robust tests effortlessly.

---

## Why Integration Matters

Testing frameworks are only as valuable as their ease of use within your existing development process. GoogleTest and GoogleMock are designed to plug right into modern C++ build systems. When properly integrated, they enable:

- **Automated Test Execution:** Run tests with your builds automatically, catching issues early.
- **Consistent Build Environments:** Ensure tests run predictably in varied development and CI setups.
- **Modular Inclusion:** Incorporate testing only where needed, without bloating your build targets.

Understanding how to connect GoogleTest and GoogleMock to the build system you use empowers you to maintain high code quality with minimal manual overhead.

---

## How GoogleTest & GoogleMock Plug Into C++ Build Systems

### CMake Integration

CMake users benefit from straightforward mechanisms to add GoogleTest and GoogleMock to their test suites. To integrate:

1. **Include GoogleTest in Your Project:** Typically via `add_subdirectory()` if you have the source, or by linking against pre-built libraries.
2. **Add GoogleTest Includes:** Use `target_include_directories()` to ensure your test targets can find GoogleTest and GoogleMock headers.
3. **Link GoogleTest and GoogleMock Targets:** Link your test executables with `gtest`, `gtest_main`, and `gmock` libraries.
4. **Register Tests:** Employ CMake's `add_test()` command to let CTest discover and run your tests.

This setup creates a seamless automated environment where pressing "build" both compiles and runs your tests.

### Bazel Integration

For teams using Bazel, GoogleTest and GoogleMock integration is natural and well-supported through:

- **BUILD Files:** Define test targets with `cc_test` rules, specifying dependencies on `@com_google_googletest` and `@com_google_googlemock`.
- **Parameterization:** Pass test-specific arguments to control execution behaviors.
- **Automatic Test Discovery:** Bazel's test runner detects and executes test targets during continuous integration.

This ensures your tests become a first-class citizen in Bazel’s build and test pipelines.

---

## Entry Points and Reference Files

Understanding the reference files and entry points helps you connect GoogleTest and GoogleMock effectively:

- **Header Files:**
  - For tests: include `<gtest/gtest.h>`
  - For mocks: include `<gmock/gmock.h>`

- **Initialization:**
  - Call `testing::InitGoogleTest(&argc, argv);` early in your `main()` function to parse flags and initialize the framework.

- **Test Registration:**
  - Use macros like `TEST()`, `TEST_F()`, `TEST_P()`, and their mocking counterparts to define test cases.
  - Instantiate parameterized tests using `INSTANTIATE_TEST_SUITE_P()` with parameter generators such as `Values()`, `Range()`, and `Combine()`.

- **Test Execution:**
  - Call `RUN_ALL_TESTS()` from `main()` to trigger the tests.

Detailed reference to these macros and APIs is available in the [Testing Reference](https://github.com/google/googletest/blob/main/docs/reference/testing.md).

---

## Integrating Into Automated Workflows

GoogleTest and GoogleMock have been crafted to plug seamlessly into automated environments:

- **Build Automation:** Your build system can compile tests as part of the normal build step.
- **Continuous Integration:** Tests can run automatically on every commit, pull request, or scheduled build.
- **Custom Test Filters:** Use flags like `--gtest_filter` to select subsets of tests.
- **Test Result Reporting:** GoogleTest supports output in formats like XML and JSON for CI dashboard integration.

This integration ensures that quality gates are automated, reducing manual intervention and accelerating feedback.

---

## Practical Tips for Smooth Integration

- **Avoid Underscores in Test Names:** Follow GoogleTest rules on naming to avoid conflicts in generated class names (see [GoogleTest FAQ](https://github.com/google/googletest/blob/main/docs/faq.md#why-should-test-suite-names-and-test-names-not-contain-underscore)).

- **Place `INSTANTIATE_TEST_SUITE_P` at Global Scope:** It must not be inside functions for proper test generation.

- **Maintain Static Linking or Shared Library Consistency:** When building GoogleTest as shared library or static, ensure your build config matches accordingly.

- **Use Custom Parameter Generators:** Harness parameterized tests for combinatorial coverage.

- **Leverage Event Listeners:** For custom reporting or integration, use the event listener API.

- **Check Common Pitfalls:** Consult the [Troubleshooting Guide](https://github.com/google/googletest/blob/main/docs/faq.md) for common integration hiccups.

---

## Example Workflow with CMake

```cmake
cmake_minimum_required(VERSION 3.10)
project(MyProject CXX)

# Add GoogleTest subdirectory
add_subdirectory(googletest)

# Define your test executable
add_executable(my_tests test_main.cpp test_foo.cpp)

# Link against GoogleTest and GoogleMock
target_link_libraries(my_tests gtest gmock gtest_main pthread)

enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

In your main test file:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## Automating with Bazel

In your `BUILD` file:

```python
cc_test(
    name = "my_tests",
    srcs = ["test_main.cpp", "test_foo.cpp"],
    deps = [
        "@com_google_googletest//:gtest",
        "@com_google_googlemock//:gmock",
    ],
)
```

Bazel will automatically detect and run this test target during `bazel test`.

---

## Summary

With clear entry points, support for popular build systems, and strong alignment with automated workflows, GoogleTest and GoogleMock provide comprehensive support for integrating reliable, maintainable unit tests into your C++ projects. Follow the above integration points, leverage parameterized tests, and harness test environment controls to build a robust testing pipeline.

For detailed API usage and advanced topics, consult the [Testing Reference](https://github.com/google/googletest/blob/main/docs/reference/testing.md) and the [Advanced Topics](https://github.com/google/googletest/blob/main/docs/advanced.md).

---

[Back to Navigation](../../../docs/_data/navigation.yml)

---

## References

- [Testing Reference](https://github.com/google/googletest/blob/main/docs/reference/testing.md) — for macros, classes, and parameters
- [FAQ: Common Integration Issues](https://github.com/google/googletest/blob/main/docs/faq.md) — for naming rules and typical problems
- [Advanced Topics](https://github.com/google/googletest/blob/main/docs/advanced.md) — for fine-grained control and event listener APIs
- [Installation and Setup Guides](../../../getting-started/environment-setup/prerequisites-platform-support.html) — for configuring on different platforms
- [CMake Quickstart](../../../getting-started/installation-configuration/install-cmake.html)
- [Bazel Quickstart](../../../getting-started/installation-configuration/install-bazel.html)
