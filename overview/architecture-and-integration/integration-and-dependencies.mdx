---
title: "Integration Points & Platform Support"
description: "Explains how GoogleTest integrates with other systems and build tools, its supported platforms, and mechanisms for configuration. Covers how CMake/Bazel and platform abstractions interact with GoogleTest, and highlights extensibility and dependency plans (e.g., planned Abseil integration)."
---

# Integration Points & Platform Support

GoogleTest seamlessly integrates with popular build systems and supports a wide variety of platforms, providing flexible configuration options to adapt to your development environment. This guide details how GoogleTest works with CMake and Bazel, describes platform abstractions that ensure broad compatibility, and discusses planned and existing extensibility points including future integration with Abseil libraries.

---

## Build System Integration

### Building GoogleTest with CMake

GoogleTest includes a comprehensive CMake build script that supports multiple platforms, allowing you to either build GoogleTest as a standalone project or incorporate it into your existing CMake build.

- **Standalone build**:

  1. Clone the repo:
  ```bash
  git clone https://github.com/google/googletest.git -b v1.17.0
  cd googletest
  mkdir build
  cd build
  ```

  2. Generate build files:
  ```bash
  cmake ..           # Builds GoogleTest and GoogleMock (default).
  cmake .. -DBUILD_GMOCK=OFF  # Build only GoogleTest.
  ```

  3. Build and optionally install:
  ```bash
  make
  sudo make install  # Default install path /usr/local/
  ```

- **Integration into an existing CMake project**:

  The recommended ways to integrate GoogleTest are:

  - Import installed GoogleTest using `find_package(GTest CONFIG REQUIRED)`.
  - Build GoogleTest as part of your project source tree using `add_subdirectory()`. This ensures consistent compiler and linker flags.
  
  A convenient modern approach is using CMake's `FetchContent` module to automatically download and configure GoogleTest as part of your build:

  ```cmake
  include(FetchContent)
  FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
  )
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # On Windows, match runtimes.
  FetchContent_MakeAvailable(googletest)

  add_executable(example example.cpp)
  target_link_libraries(example gtest_main)
  add_test(NAME example_test COMMAND example)
  ```

  > Requires CMake 3.14 or later.

#### Visual Studio Runtime Considerations

By default, Visual Studio uses dynamic runtimes, whereas GoogleTest links the runtime statically. To resolve linking errors due to mismatched runtimes, enable the `gtest_force_shared_crt` CMake option to use dynamic runtimes consistently.

#### C++ Standard Requirement

GoogleTest requires at least C++17 support in the build environment. Set your project’s `CMAKE_CXX_STANDARD` to 17 and enforce it with `CMAKE_CXX_STANDARD_REQUIRED ON`, or specify compiler flags manually.

### Bazel Integration

While this page focuses primarily on CMake, GoogleTest also integrates with Bazel build systems. Use the provided Bazel BUILD files to add GoogleTest as a dependency in your Bazel projects. Consult the Bazel-specific documentation for detailed integration patterns.

---

## Platform Support & Abstractions

GoogleTest supports major platforms including Linux, Windows, macOS, and embedded targets such as ESP8266, ESP32, and NRF52 (commonly used in Arduino environments).

- The multi-platform support is achieved through careful use of platform abstractions that handle threading, file I/O, synchronization, and other OS-specific details transparently.
- Thread safety is ensured when using pthreads or platform equivalents. If pthread is not detected correctly, users can override detection macros to enable or disable threading explicitly.

### Thread Safety

GoogleTest is thread-safe where pthread is available. To focus threading support in your environment:

```bash
-DGTEST_HAS_PTHREAD=1   # Force enable
-DGTEST_HAS_PTHREAD=0   # Force disable
```

Compiler and linker flags for pthread are generally handled automatically by CMake but may require manual specification in custom build scripts.

### Shared Library (DLL) Usage

GoogleTest is typically linked as a static library but can be built as a shared library if preferred.

- To build GoogleTest as a shared library, define the macro `-DGTEST_CREATE_SHARED_LIBRARY=1` during compilation.
- For your tests linking against the shared GoogleTest library, also define `-DGTEST_LINKED_AS_SHARED_LIBRARY=1`.

Note that while some compilers tolerate omission of these flags, including them explicitly prepares for future binary compatibility and faster library loading.

---

## Configuration & Customization

### Tweaking GoogleTest

GoogleTest exposes a suite of control macros (`GTEST_*`) to adapt its behavior for special environments, allowing enabling or disabling features to address conflicts, bugs, or compatibility issues. For the full list, see [gtest-port.h](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h).

### Preventing Macro Name Clashes

If GoogleTest’s macros conflict with those from other libraries, you can rename GoogleTest macros by defining `-DGTEST_DONT_DEFINE_<MACRO>=1`. For example:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

This requires you to prefix the original macro names with `GTEST_`. For instance, use `GTEST_TEST()` instead of `TEST()`.

---

## Extensibility and Planned Integrations

GoogleTest is architected for long-term extensibility:

- The build and platform abstraction layers are modular, facilitating custom extension or replacement.
- Plans include integrating Abseil libraries for enhanced utility and portability.

These efforts aim to improve configuration flexibility and provide better dependency management in the future.

---

## Summary Diagram of Integration Flow

```mermaid
flowchart TD
  subgraph Build Systems
    CMake[CMake Build Script]
    Bazel[Bazel Build Files]
  end
  subgraph Platforms
    Linux[Linux]
    Windows[Windows]
    MacOS[MacOS]
    Embedded[Embedded (ESP32, ESP8266, NRF52)]
  end
  subgraph GoogleTest
    Core[GoogleTest Core]
    Mock[GoogleMock]
  end

  CMake --> Core
  Bazel --> Core
  Core -->|Includes| Mock

  Platforms --> Core
  Platforms --> Build Systems

  Core --> Config[Configuration Macros & Flags]
  Config --> Core
  Core -.-> Extensibility[Planned Abseil Integration & Modular Extensions]
```

---

## Practical Tips

- Use CMake’s FetchContent or `find_package` to manage GoogleTest dependencies reliably.
- Explicitly specify C++17 or later in your project to avoid build errors.
- When integrating on Windows, pay attention to runtime linkage compatibility (`gtest_force_shared_crt`).
- Use macro renaming options to resolve conflicts in projects with multiple testing or utility frameworks.
- For multi-threaded tests, ensure proper compiler and linker flags (especially for pthread).
- Keep GoogleTest updated to leverage upcoming extensibility enhancements.

---

## Troubleshooting Common Integration Issues

<AccordionGroup title="Integration Troubleshooting">
<Accordion title="Build Failures on Windows due to Runtime Mismatch">
Use the CMake option `-Dgtest_force_shared_crt=ON` to align Google's Test runtime with your project. This avoids linker errors involving mismatched static/dynamic runtimes.
</Accordion>
<Accordion title="Missing pthread Support on Non-pthread Platforms">
Force pthread usage detection with `-DGTEST_HAS_PTHREAD=0` or enable it with `-DGTEST_HAS_PTHREAD=1` if detection is failing. Add appropriate compiler and linker flags accordingly.
</Accordion>
<Accordion title="Macro Name Conflicts in Large Projects">
Use `-DGTEST_DONT_DEFINE_<MACRO>=1` to rename conflicting macros, then prefix usages with `GTEST_` to avoid clashes.
</Accordion>
<Accordion title="C++ Standard Compatibility Errors">
Ensure `CMAKE_CXX_STANDARD` is set to at least 17 or pass appropriate compiler flags for your environment.
</Accordion>
</AccordionGroup>

---

## Additional Resources

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleMock Guide](https://google.github.io/googletest/gmock_for_dummies.html)
- [GoogleTest Primer](overview/introduction-and-value/core-concepts.md)
- [Building GoogleTest with CMake](docs/getting-started/setup-prerequisites-installation/installation-cmake.md)
- [System Architecture Overview](overview/architecture-and-integration/system-architecture.md)

---