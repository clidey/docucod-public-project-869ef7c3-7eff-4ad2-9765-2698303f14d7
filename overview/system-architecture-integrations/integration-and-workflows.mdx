---
title: "Integration & Typical Workflows"
description: "Learn how to set up and integrate GoogleTest and GoogleMock with C++ build systems like CMake and Bazel, and how they seamlessly support test discovery and execution within continuous integration pipelines. Highlights extension points for third-party tools."
---

# Integration & Typical Workflows

## Seamless Integration with C++ Build Systems

GoogleTest and GoogleMock are designed to integrate effortlessly with popular C++ build systems like **CMake** and **Bazel**, empowering developers to embed testing into their existing build pipelines efficiently. This page guides you through setting up these integrations, enabling smooth test discovery, execution, and reporting within your continuous integration (CI) environments.

### Why Integrate GoogleTest and GoogleMock?

Integration unlocks the full potential of automated testing by ensuring:

- **Automatic test discovery:** Tests are detected without manual registration.
- **Consistent build and test runs:** Tests are built and run as part of the regular build.
- **Seamless CI pipeline support:** Test results can be processed in CI/CD workflows.
- **Extensibility:** Easily extend to third-party tools and custom workflows.

### Supported Build Systems

- **CMake:** A widely adopted open-source, cross-platform build system.
- **Bazel:** A high-performance build and test tool from Google supporting large-scale projects.

## Setting Up GoogleTest and GoogleMock with CMake

Integrating GoogleTest into your CMake project enables direct execution of your tests through CMake commands and integration with your CI.

### Basic Setup

1. **Fetch GoogleTest:** Use CMake's `FetchContent` or add it as a subdirectory.

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.12.1.zip
)
FetchContent_MakeAvailable(googletest)
```

2. **Add Your Test Executable:** Link your tests with `gtest` and optionally `gmock`.

```cmake
add_executable(my_tests test_main.cc my_test.cc)
target_link_libraries(my_tests gtest gtest_main gmock gmock_main pthread)
```

3. **Enable Testing and Add Tests:**

```cmake
enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

### Utilizing Test Discovery

GoogleTest automatically discovers tests defined with `TEST`, `TEST_F`, `TEST_P`, etc. When your test executable runs (e.g., via `ctest`), it executes all registered tests without further manual steps.

### Running Tests Through CMake

- Command line: `ctest
`
- Integration in IDEs that support CMake testing.

### Best Practices

- Use separate targets for test code to avoid shipping test binaries with production.
- Use CMake build type flags to configure tests (e.g., debug, coverage).
- Use GoogleTest's XML output option (`--gtest_output=xml:result.xml`) for CI report parsing.

## Setting Up GoogleTest and GoogleMock with Bazel

Bazel is optimized for large and fast build/test cycles.

### Basic Setup

```python
cc_test(
    name = "my_tests",
    srcs = ["test_main.cc", "my_test.cc"],
    deps = ["@com_google_googletest//:gtest", "@com_google_googletest//:gmock"],
)
```

### Running Tests

- Run tests with `bazel test //path/to:my_tests`.
- Bazel executes the test binaries associated with the Bazel targets and collects results.

### Test Discovery

Bazel automatically runs the test executable; GoogleTest discovers registered tests internally.

### Using Third-Party Extensions

GoogleTest supports extension points to integrate with additional tooling:

- Custom event listeners can report tests to external dashboards or monitoring tools.
- Third-party wrappers can hook into GoogleTest’s event listener API for enhanced reporting.
- Integration with code coverage tools and static analyzers.

## Testing Workflows in Continuous Integration

Integrating GoogleTest into your CI pipelines streamlines quality assurance with automated test runs and thorough reporting.

### Test Execution

- Call your test binary as part of CI build steps.
- Use GoogleTest flags to control execution, for example:
  - `--gtest_filter` to run subsets of tests.
  - `--gtest_repeat` to rerun tests for flakiness detection.
  - `--gtest_shuffle` to run tests in random order revealing inter-test dependencies.

### Reporting

- Generate XML or JSON output with `--gtest_output=xml:<file>` or `--gtest_output=json:<file>`.
- Use XML/JSON reports in CI tools for test result display and trend monitoring.

### Handling Test Failures

- CI systems detect failed tests by return codes (`RUN_ALL_TESTS()` returns 0 for success).
- Failed tests can be configured to stop builds or alert teams.

### Extending with Third-Party Tools

- Integrate custom reporters by creating GoogleTest event listeners.
- Use external test management integrations (Jenkins, GitHub Actions, GitLab CI).

## Typical User Workflow for Setting Up Integration

### 1. Prepare Your Build System

- Add GoogleTest as a dependency (via CMake or Bazel).
- Link your test libraries with GoogleTest and GoogleMock.

### 2. Write Your Tests

- Use standard GoogleTest macros (`TEST`, `TEST_F`, `TEST_P`).
- Organize tests into suites.

### 3. Build Your Test Executable

- Build via your chosen build system.

### 4. Configure Your CI Pipeline

- Add a stage to run the test executable.
- Collect and parse test results output.

### 5. Extend as Needed

- Add custom event listeners for special reporting.
- Integrate with code coverage or other quality tools.

## Practical Tips & Common Pitfalls

- Never mix test registration methods improperly; use GoogleTest macros consistently.
- Ensure your `main()` calls `::testing::InitGoogleTest()` before `RUN_ALL_TESTS()`.
- Use `GTEST_SKIP()` responsibly to conditionally skip tests without failure.
- When generating parameterized tests (`TEST_P` + `INSTANTIATE_TEST_SUITE_P`), always instantiate all used param tests to avoid warnings/errors.
- Always manage test dependencies to run all tests successfully in CI pipelines.

## Troubleshooting in Integration

<AccordionGroup title="Common Integration Issues & Solutions">
<Accordion title="Test Discovery Fails">
If your test executable is not running tests as expected:
- Confirm your test cases use GoogleTest macros correctly.
- Ensure the test executable is linked against `gtest_main` or has a proper `main()`.
- Check for missing `InitGoogleTest()` calls.
</Accordion>
<Accordion title="Tests Not Running in CI">
- Verify CI is invoking the right test binary with proper arguments.
- Confirm environment supports the executable (OS, libraries).
- Ensure build artifacts include test binaries.
</Accordion>
<Accordion title="Test Results Not Reporting Correctly">
- Use GoogleTest’s `--gtest_output=xml:filename.xml` for CI friendly reports.
- Confirm CI system can parse and display these reports.
- Check file permissions and paths for log files.
</Accordion>
</AccordionGroup>

## How GoogleTest Fits into Your Development Cycle

GoogleTest serves as the backbone for your C++ automated testing inside your build and CI environments. Its deep integration with build tools ensures that your tests become a natural, effortless step in verifying your code quality continuously. By following the workflows above, you unlock reliable, maintainable, and scalable testing in your C++ projects.

---

## References

- [GoogleTest Testing Reference](reference/testing.md)
- [Advanced GoogleTest Topics](advanced.md)
- [GoogleTest API Reference](api-reference/gtest-api/test-and-fixture-api.md)
- [Integrating with Build Systems](guides/scenarios-and-best-practices/integrating-with-build-systems.md)
- [Parameterized and Typed Tests](guides/advanced-testing-patterns/parameterized-and-typed-tests.md)

---

## Next Steps

Proceed to the [Installing and Setting Up GoogleTest & GoogleMock](guides/getting-started/installing-and-setting-up.md) guide for detailed step-by-step setup instructions.

Use [Writing Your First Unit Tests](guides/getting-started/writing-your-first-tests.md) to familiarize with writing tests effectively.

Explore [Extending GoogleTest](concepts/extensibility-integration/custom-extensions.md) to customize and enhance your testing workflows.


---

<Mermaid>
flowchart TD
  A[Developer writes tests using GoogleTest macros] --> B[Build system integrates with GoogleTest]
  B --> C{Choose build system}
  C -->|CMake| D[CMake fetches and links GoogleTest]
  C -->|Bazel| E[Bazel declares GoogleTest dependencies]
  D --> F[Test executable discovers tests automatically]
  E --> F
  F --> G[Run tests locally or in CI]
  G --> H[Test results generated (console, XML, JSON)]
  H --> I[CI parses reports and acts on results]
  I --> J[Custom extensions via event listeners]
  J --> G
</Mermaid>