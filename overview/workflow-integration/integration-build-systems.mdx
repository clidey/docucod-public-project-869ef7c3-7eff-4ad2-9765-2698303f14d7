---
title: "Integrating with Build Systems"
description: "Summarizes typical workflows for integrating GoogleTest and GoogleMock into projects using Bazel, CMake, and other tools. Clarifies where to find starter guides, highlights ease of including headers and runners, and calls out platform compatibility."
---

# Integrating with Build Systems

GoogleTest and GoogleMock offer seamless integration with popular build systems, making it effortless to add robust testing capabilities to your C++ projects. This page summarizes typical workflows for incorporating these frameworks into builds managed by Bazel, CMake, and other common tools. You'll find clear guidance on starter resources, header and runner inclusion strategies, and platform compatibility notes to ensure a smooth setup tailored to your environment.

---

## Why This Matters

Integrating GoogleTest and GoogleMock with your build system allows you to automate unit testing effortlessly and enforce high-quality code. By using standard build tools like Bazel or CMake, you can achieve consistent test execution, simplify dependency management, and leverage native platform support. This page helps you navigate the initial integration steps while highlighting platform coverage to avoid common pitfalls.

---

## Supported Build Systems

### Bazel

Bazel users can quickly incorporate GoogleTest and GoogleMock using pre-existing Bazel packages. Typical workflows involve:

- Adding `cc_test` or `cc_binary` rules for your tests.
- Declaring dependencies on the `@com_google_googletest` repository targets.
- Including GoogleTest and GoogleMock headers and linking against the appropriate libraries.

For example:

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main", "@com_google_googlemock//:gmock_main"],
)
```

This configuration automatically links necessary runners and sets up test infrastructure with minimal fuss.

### CMake

GoogleTest and GoogleMock provide official CMake support that simplifies integration:

- Build GoogleTest (which includes GoogleMock) as part of your project or install it separately.
- Use `find_package(GTest REQUIRED)` to locate installed libraries.
- Link your tests against `GTest::gtest` and `GTest::gmock_main` targets.

A standard CMake integration snippet looks like:

```cmake
find_package(GTest REQUIRED)

add_executable(my_test my_test.cc)
target_link_libraries(my_test GTest::gmock_main GTest::gtest_main pthread)
add_test(NAME MyTest COMMAND my_test)
```

This harness includes headers and a main runner seamlessly, and enables straightforward cross-platform builds.

### Other Build Systems

While Bazel and CMake have the most direct support, GoogleTest and GoogleMock can be integrated into other build systems like Make or Ninja by:

- Manually specifying header include directories.
- Compiling and linking GoogleTest and GoogleMock source files or static libraries.
- Providing a main function if not using `gmock_main` or `gtest_main` libraries.

Detailed starter guides for alternative build tools can be found in related documentation.

---

## Key Integration Considerations

### Including Headers

Adding the appropriate include paths ensures your tests see GoogleTest and GoogleMock API declarations. For package-based systems (Bazel/CMake), this usually happens automatically via dependency declarations or imported targets.

### Test Runners

Use the provided runners like `gtest_main` or `gmock_main` where possible to avoid writing your own `main()`. These runners initialize the frameworks and invoke all registered tests.

### Platform Compatibility

GoogleTest and GoogleMock support a broad range of platforms including Windows, Linux, macOS, and several embedded environments. When integrating with your build system, confirm target platform support and threading options. Some platforms may require special build flags or initialization sequences.

---

## Practical Workflow Summary

<Tip>
For new projects, start with the official Bazel or CMake integration guides in the "Getting Started" section for the fastest setup.
</Tip>

Hereâ€™s a step-by-step integration overview:

<Steps>
<Step title="Choose Your Build System">
Identify your project's build tool (Bazel, CMake, or other).
</Step>
<Step title="Add GoogleTest/GoogleMock Dependencies">
Declare dependencies by adding Bazel targets or using CMake's `find_package`.
</Step>
<Step title="Include Headers">
Ensure your build config points to the installed or sourced GoogleTest/GoogleMock header directories.
</Step>
<Step title="Link Test Executables">
Link against `gtest`, `gmock`, and their main runners (`gtest_main`, `gmock_main`) with threading libraries if required.
</Step>
<Step title="Build and Run Tests">
Compile your test code along with the dependencies and execute test binaries managed by your build system.
</Step>
</Steps>

---

## Common Pitfalls

<AccordionGroup title="Integration Challenges">
<Accordion title="Missing Headers or Libraries">
Ensure dependency declarations are correctly set in your build files. Missing or incorrect paths cause compile/link errors.
</Accordion>
<Accordion title="Incorrect Runner Usage">
Use `gmock_main` if you use mocking features which depends on GoogleTest. Avoid defining your own `main()` unless necessary.
</Accordion>
<Accordion title="Platform-Specific Flags">
Some platforms require special compiler flags (e.g., `-DGTEST_HAS_PTHREAD=1` on some Linux variants) or runtime support for pthreads. Verify these when using multi-threaded tests.
</Accordion>
<Accordion title="Version Mismatches">
Use consistent GoogleTest/GoogleMock versions across dependencies to avoid incompatibility.
</Accordion>
</AccordionGroup>

---

## Next Steps

- For detailed Bazel integration, refer to the [Bazel Installation Guide](/getting-started/set-up-prerequisites-installation/installation-bazel).
- For full CMake details, see [Installing with CMake](/getting-started/set-up-prerequisites-installation/installation-cmake).
- Consult [Supported Platforms and Environments](/overview/workflow-integration/supported-platforms) to confirm your target.

Explore example projects to see integration samples in action and troubleshoot typical setup errors in the troubleshooting guides.

---

## Additional Resources

- [GoogleTest & GoogleMock Official GitHub Repository](https://github.com/google/googletest)
- [GoogleTest CMake Integration](https://cmake.org/cmake/help/latest/module/FindGTest.html)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [Bazel Official Documentation](https://bazel.build)

---

## Summary Diagram of Typical Build Integration

```mermaid
flowchart TD
  A[Your Project Source Code] --> B[Build System (Bazel/CMake/Other)]
  B --> C{Add Dependencies}
  C -->|Bazel| D[Declare @com_google_googletest//:gtest_main and gmock_main]
  C -->|CMake| E[Use find_package(GTest) and link targets]
  C -->|Other| F[Manually add headers/libs and link sources]
  D --> G[Compile & Link Test Executable]
  E --> G
  F --> G
  G --> H[Run Tests with Runner]
  H --> I[Output Test Results]
  subgraph Platform Support
    J[Windows]
    K[Linux]
    L[macOS]
    M[Embedded]
  end
  B---J
  B---K
  B---L
  B---M
```
