---
title: "Integration & Dependencies"
description: "Explains how GoogleTest can be incorporated into existing C++ projects, its relationship to GoogleMock, and typical integration scenarios (e.g., Bazel and CMake). Covers planned and current third-party integrations (such as Abseil) and how these enable broader adoption."
---

# Integration & Dependencies

GoogleTest is designed to seamlessly integrate into your existing C++ projects and adapt to your build environment, whether you're using common build systems like Bazel or CMake or leveraging third-party libraries like Abseil to extend functionality. This page walks you through how to incorporate GoogleTest effectively, its relationship with GoogleMock, and how popular dependencies enable GoogleTest's wide adoption.

---

## Incorporating GoogleTest Into Your Projects

Bringing GoogleTest into your C++ project is straightforward. The framework provides flexible options that accommodate different build system setups and project structures.

### Using CMake

GoogleTest comes with its own CMake build scripts that work across platforms. Depending on your needs, you can either build GoogleTest as a standalone project or embed it directly into your existing CMake build.

#### Standalone Build

To build GoogleTest on its own, you typically clone the repository, create a build directory, and run CMake:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build
cmake ..
make
sudo make install
```

By default, GoogleMock is included in this build. If you want to build only GoogleTest (without GoogleMock), pass the option `-DBUILD_GMOCK=OFF` to CMake:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

This approach generates native project files suitable for your platform and compiler (Makefiles on Linux, Visual Studio projects on Windows, Xcode projects on Mac OS X).

#### Embedding in an Existing CMake Project

For projects that already use CMake, you have two preferred methods:

- **Link to Installed GoogleTest:** Assuming GoogleTest is installed on your system, you can use CMake's `find_package` to import GoogleTest. For example:

  ```cmake
  find_package(GTest CONFIG REQUIRED)

  add_executable(my_test main_test.cpp)
  target_link_libraries(my_test GTest::gtest GTest::gtest_main)
  add_test(NAME my_test COMMAND my_test)
  ```

- **Build GoogleTest as Part of Your Project:** You can add GoogleTest source to your project using `add_subdirectory()`, ensuring consistent compiler and linker settings to avoid issues, especially on Windows.

  To do this, you can add the following in your `CMakeLists.txt` to download and configure GoogleTest dynamically:

  ```cmake
  include(FetchContent)
  FetchContent_Declare(
      googletest
      URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
  )
  set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
  FetchContent_MakeAvailable(googletest)

  add_executable(example example.cpp)
  target_link_libraries(example gtest_main)
  add_test(NAME example_test COMMAND example)
  ```

This flexible approach ensures you can keep GoogleTest up to date and consistent with your project's build configuration.

### Using Bazel

GoogleTest also supports Bazel, a fast and extensible build and test system. When using Bazel, GoogleTest and GoogleMock are typically added as external dependencies, managed via Bazel WORKSPACE and BUILD files.

With Bazel, integration is simplified due to its hermetic builds and dependency management. GoogleTest's Bazel setup ensures you always have consistent builds and test runs.

> For details on Bazel integration, please consult your project's Bazel documentation or GoogleTest's Bazel examples repository.

---

## Relationship with GoogleMock

GoogleMock (often referred to as gMock) is closely tied with GoogleTest. It offers a powerful and expressive mocking framework for C++ that helps you write tests focusing on interactions between objects.

- GoogleMock is bundled with GoogleTest and is included by default when you build GoogleTest.
- The two share similar design goals: enabling reliable, maintainable, and fast C++ tests.
- You can choose to build only GoogleTest without GoogleMock if you don't need mocking capabilities.

The tight integration means you use both in a complementary fashion:

- Use **GoogleTest** for organizing and running tests and making assertions on results.
- Use **GoogleMock** for creating mock objects that simulate parts of your system that are complicated, slow, or unavailable.

Our [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) and [Mocking Reference](reference/mocking.md) documents provide practical examples and guidance.

---

## Third-Party Integrations

GoogleTest leverages and interoperates with several third-party libraries to enhance its capabilities and fit well in larger ecosystems.

### Abseil

Abseil provides a collection of C++ common libraries designed to augment the STL. GoogleTest depends on select components of Abseil, providing:

- Compatibility layers for platform-specific features.
- Utilities for managing flags and synchronization.
- Enhanced string handling and memory management helpers.

Using GoogleTest in projects that already use Abseil is often seamless. GoogleTest’s compatibility with Abseil broadens its reach and adoption among teams relying on Google's C++ foundational libraries.

> For specifics on GoogleTest’s dependencies on Abseil and usage recommendations, refer to the Integration & Dependencies section of GoogleTest’s repository.

---

## Ensuring Compatibility and Tweaks

GoogleTest requires a minimum environment that supports C++17. You can enforce this in your build system, for example in CMake:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### Tweaking GoogleTest Behavior

GoogleTest allows advanced users to customize its behavior through compiler-defined macros typically prefixed by `GTEST_`. These controls enable fine-tuning such as:

- Enabling or disabling pthread usage for thread safety.
- Adjusting linking of runtime libraries, important especially on Windows concerning dynamic versus static CRT linkage.
- Renaming GoogleTest macros to avoid clashes with macros from other libraries.

Refer to GoogleTest’s internal header [`include/gtest/internal/gtest-port.h`](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/gtest-port.h) for a full list of control macros.

---

## Summary: Bringing it All Together

Whether you are starting fresh or integrating GoogleTest into a large existing C++ codebase, the framework offers flexibility and best-in-class compatibility:

- Build system integration through CMake and Bazel supports most workflows.
- GoogleMock’s inclusion provides robust mocking alongside assertion support.
- Third-party dependencies like Abseil underscore GoogleTest’s reliability and compatibility.
- Practical guidelines ensure smooth builds and test runs across platforms.

By following the examples and recommendations here, you can make GoogleTest a natural part of your testing process.

---

## Troubleshooting Common Integration Issues

<AccordionGroup title="Integration Troubleshooting">
<Accordion title="Build Errors on Windows with Visual Studio Runtime Library Mismatch">
GoogleTest links the C runtime (CRT) statically by default, while many new Visual Studio projects link it dynamically. This mismatch causes linker errors such as `LNK2038`.

**Solution:** Enable dynamic linking of the CRT in GoogleTest by passing `-Dgtest_force_shared_crt=ON` to your CMake configuration.

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

This makes GoogleTest link to the CRT dynamically, matching typical Visual Studio projects.
</Accordion>
<Accordion title="GoogleTest’s C++ Standard Requirements Not Met">
GoogleTest requires C++17 support. If your build fails due to missing C++17 features:

- Ensure your compiler supports C++17.
- Configure your build system to set the C++ standard accordingly.

For example, in CMake:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

If you use another build environment, check its documentation on specifying the C++ standard.
</Accordion>
<Accordion title="Linker Errors Due to Multiple Definitions or Missing Symbols">
This usually happens when GoogleTest is built multiple times inconsistently or when mixing debug and release builds.

**Tips:**

- Ensure the same compiler and linker flags are used for GoogleTest and for your tests.
- Build GoogleTest as part of your project to keep build parameters in sync.
- On Windows, be cautious with runtime library linkage options (`MT` vs `MD`).
</Accordion>
</AccordionGroup>

---

## Next Steps

- To get started writing tests after integrating GoogleTest, see [Your First Test: Basic Usage](/getting-started/project-setup/first-test).
- For details on configuring test execution options, visit [Configuring Test Execution](/getting-started/project-setup/configuration-options).
- To explore how GoogleTest and GoogleMock interact during test runs, check [System Architecture Overview](/overview/architecture-concepts/system-architecture).


<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googletest/README.md", "range": "1-200"},{"path": "docs/gmock_for_dummies.md", "range": "1-180"},{"path": "docs/gmock_cheat_sheet.md", "range": "1-150"}]}/>