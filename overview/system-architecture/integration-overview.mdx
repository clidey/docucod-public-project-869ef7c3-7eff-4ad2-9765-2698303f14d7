---
title: "Integration & Extensibility"
description: "Overview of how GoogleTest integrates with common build systems (e.g., CMake, Bazel), as well as available extension points for users (custom assertions, matchers, actions)."
---

# Integration & Extensibility

Welcome to the Integration & Extensibility page for GoogleTest. Here, you'll explore how GoogleTest seamlessly integrates with popular build systems such as CMake and Bazel, enabling you to incorporate robust C++ testing into your development workflows effortlessly. Additionally, this page covers the extension points available within GoogleTest, empowering you to customize the testing framework by creating your own assertions, matchers, and actions.

---

## Why Integration & Extensibility Matter

In modern C++ projects, automated testing is most effective when it plugs directly into your build and development pipelines. Without smooth integration, running tests, collecting results, or adapting the framework to your specific needs can become cumbersome and error-prone. GoogleTest’s integration mechanisms allow you to run, discover, and manage tests consistently within your build system environment.

On the extensibility side, testing needs evolve as your project grows. GoogleTest recognizes this by providing extension points that let you bring your own domain-specific logic into assertions and mocks, making tests not just reusable but also expressive and maintainable.

---

## Integration with Build Systems

### CMake Integration

GoogleTest ships with a first-class CMake build script that simplifies both standalone builds and incorporation into your existing CMake projects.

**Standalone Build Workflow:**

```bash
# Clone the GitHub repository
$ git clone https://github.com/google/googletest.git -b v1.17.0
$ cd googletest
$ mkdir build && cd build

# Generate build files (with GoogleMock included by default)
$ cmake ..

# Build the library and tests
$ make

# (Optional) Install GoogleTest system-wide
$ sudo make install
```

If you only require GoogleTest without GoogleMock, simply add the flag `-DBUILD_GMOCK=OFF` to the cmake command.

**Embedded Integration in Existing Projects:**

To seamlessly integrate GoogleTest within your project, you can add it as a subdirectory and link it as a dependency:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # For Windows runtime compatibility
FetchContent_MakeAvailable(googletest)

add_executable(MyTests tests.cpp)
target_link_libraries(MyTests GTest::gtest_main)
add_test(NAME MyTests COMMAND MyTests)
```

This approach ensures that your test suite builds with GoogleTest using the same compiler settings and linkage, minimizing compatibility issues.

### Bazel Integration

While GoogleTest does not provide an official Bazel workspace repository, it can be integrated using Bazel's `http_archive` rule to download the source and build it as part of your workspace.

Users typically set up `cc_test` targets with `gtest` and `gmock` as dependencies, leveraging Bazel's native test discovery and parallel test execution to speed up testing cycles.

---

## Extension Points

GoogleTest’s design encourages extending its capabilities to better model your testing needs. You can create custom assertions, matchers, and mock actions to express intricate verification logic succinctly.

### Writing Custom Assertions

When you need to check conditions not covered by built-in assertions, you can write custom assertions by returning `testing::AssertionResult`.

Here is a simple example:

```cpp
#include <gtest/gtest.h>

// Custom assertion to check if a number is even
::testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0) {
    return ::testing::AssertionSuccess();
  } else {
    return ::testing::AssertionFailure() << "The number " << n << " is not even.";
  }
}

TEST(CustomAssertionTest, CheckEvenNumbers) {
  EXPECT_TRUE(IsEven(4));       // Passes
  EXPECT_TRUE(IsEven(5));       // Fails, prints: The number 5 is not even.
}
```

This approach gives you fine-grained control over the failure message and integrates naturally with GoogleTest's assertion framework.

### Creating Custom Matchers

GoogleTest supports defining custom matchers that work with `EXPECT_THAT()` macros, using GoogleMock’s matcher facilities.

Here is a brief example of a custom matcher that checks if a string starts with a given prefix:

```cpp
#include <gmock/gmock.h>

using ::testing::MatcherInterface;
using ::testing::MatchResultListener;
using ::testing::Matcher;

class StartsWithMatcher : public MatcherInterface<const std::string&> {
 public:
  explicit StartsWithMatcher(const std::string& prefix) : prefix_(prefix) {}

  bool MatchAndExplain(const std::string& str,
                       MatchResultListener* listener) const override {
    return str.compare(0, prefix_.size(), prefix_) == 0;
  }

  void DescribeTo(::std::ostream* os) const override {
    *os << "starts with '" << prefix_ << "'";
  }

  void DescribeNegationTo(::std::ostream* os) const override {
    *os << "does not start with '" << prefix_ << "'";
  }

 private:
  const std::string prefix_;
};

inline Matcher<const std::string&> StartsWith(const std::string& prefix) {
  return MakeMatcher(new StartsWithMatcher(prefix));
}

// Usage in tests
TEST(CustomMatcherTest, StringPrefix) {
  EXPECT_THAT("GoogleTest", StartsWith("Google"));  // Passes
  EXPECT_THAT("GoogleMock", StartsWith("Test"));    // Fails
}
```

### Adding Custom Mock Actions

GoogleMock allows you to specify what happens when a mocked method is called via built-in actions. You can also define custom actions when you want mock methods to perform specific tasks.

For example, you might define an action that increments a global counter every time a mock function is called.

```cpp
#include <gmock/gmock.h>

using ::testing::Action;
using ::testing::ActionInterface;
using ::testing::MockFunction;
using ::testing::MatchResultListener;

class IncrementCounterAction
    : public ActionInterface<void()> {
 public:
  explicit IncrementCounterAction(int* counter) : counter_(counter) {}

  void Perform(const void* /*args*/) override {
    ++(*counter_);
  }

 private:
  int* counter_;
};

inline Action<void()> IncrementCounter(int* counter) {
  return Action<void()>(new IncrementCounterAction(counter));
}

// Usage in tests
TEST(CustomActionTest, CountCalls) {
  int call_count = 0;
  MockFunction<void()> mock;

  EXPECT_CALL(mock, Call())
      .WillRepeatedly(IncrementCounter(&call_count));

  mock.Call();
  mock.Call();

  EXPECT_EQ(call_count, 2);
}
```

This lets you deeply customize the behavior of mocks beyond simple return values.

---

## Practical Tips & Best Practices

- **Leverage your build system’s test integration:** Use CMake’s `add_test()` or Bazel's native test rules to automate running your GoogleTest suite during CI builds.
- **Define reusable custom assertions and matchers:** Share them across your projects to improve test readability and reduce boilerplate.
- **Keep custom extensions simple:** Complex custom code can reduce maintainability; aim for clear and concise extension implementations.
- **Use `RecordProperty()` for metadata tracking:** Log test metadata that can be exported to XML reports and consumed by build systems or dashboards.

---

## Troubleshooting Common Integration Issues

- **Build failures related to mismatched C++ standards or runtimes:** Ensure your project and GoogleTest use the same compiler flags and runtime libraries, especially on Windows. Use the `gtest_force_shared_crt` option for CMake if needed.
- **Test discovery problems in build systems:** Confirm that test executables are registered properly with the build system’s test runner.
- **Link errors due to missing GoogleTest symbols:** Make sure to link against the correct GoogleTest libraries (`gtest` or `gtest_main`), and that your build includes GoogleTest's headers and sources.

---

## Where to Go Next

- For a deep dive on GoogleTest’s core features and assertion macros, visit the [Core Features](../getting-started/core-features.md) page.
- To learn about defining and using mocks, explore the [Mocking Reference](../reference/mocking.md).
- For hands-on examples on custom assertions and matchers, start with the [Custom Matchers and Actions Extension API](../api-reference/extension-and-internals/custom-matchers-and-actions.md).
- To understand the system architecture and how components integrate, see [Main System Components](../system-architecture/system-components.md).

---

## Additional Resources

- GitHub Repository: [https://github.com/google/googletest](https://github.com/google/googletest)
- GoogleTest Primer: [/overview/getting-started/product-overview](../getting-started/product-overview)
- GoogleMock Cookbook: [https://google.github.io/googletest/gmock_cook_book.html](https://google.github.io/googletest/gmock_cook_book.html)

---

Embracing GoogleTest’s integration and extensibility capabilities will empower your testing workflows and make your test code more powerful and adaptable. Begin integrating today, and tailor the framework precisely to your needs!