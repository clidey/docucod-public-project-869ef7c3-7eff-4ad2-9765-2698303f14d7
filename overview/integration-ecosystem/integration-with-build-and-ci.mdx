---
title: "Integration with Build Tools and CI"
description: "Learn how GoogleTest and GoogleMock integrate with popular C++ build systems and CI platforms. See how supported platforms, compiler requirements, and configuration options help you embed testing into automated pipelines."
---

# Integration with Build Tools and CI

GoogleTest and GoogleMock provide seamless integration with widely-used C++ build systems and Continuous Integration (CI) platforms, enabling you to embed reliable and automated testing directly into your development pipelines. This guide helps you understand supported platforms, compiler prerequisites, and configuration options so you can efficiently incorporate GoogleTest and GoogleMock into your build and CI workflows.

---

## Why Integrate GoogleTest and GoogleMock into Your Build and CI Systems?

Embedding tests within your build system and CI infrastructure ensures every code change is automatically validated, preventing regressions and improving software reliability. With integration:

- Tests run consistently across environments without manual intervention.
- Build failures clearly reflect test failures, speeding up feedback.
- Automated test execution fosters Continuous Integration and Continuous Delivery (CI/CD) best practices.

This page focuses on practical setup guidance to help you achieve these outcomes with GoogleTest and GoogleMock.

---

## Supported Platforms and Compiler Requirements

GoogleTest and GoogleMock support a broad range of platforms, including Linux, Windows, and Mac OS X. The projects require a C++17 compatible compiler to build and run tests successfully.

### Compiler and Standard Requirements

- Ensure your compiler supports **C++17** (or later).
- If your project already specifies the C++ version in your build configuration (e.g., setting `CMAKE_CXX_STANDARD` in CMake), confirm it's set to 17 or higher.
- On environments not specifying C++ standard explicitly, add compiler flags such as `-DCMAKE_CXX_STANDARD=17` or `-DCMAKE_CXX_FLAGS="-std=c++17"`.

---

## Integrating with CMake

CMake is a cross-platform build system generator widely used in C++ projects. GoogleTest and GoogleMock provide first-class support for CMake integration.

### Building GoogleTest and GoogleMock as Standalone Projects

Typically, integration starts by cloning the repository and building the libraries:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build
cd build
cmake ..
make
sudo make install
```

By default, this builds both GoogleTest and GoogleMock. If you only want GoogleTest, use:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

On Windows, Visual Studio project files (`.sln`) are generated; on Mac OS X, `.xcodeproj` files are generated.

### Using GoogleTest and GoogleMock Within an Existing CMake Project

For seamless integration with your project that already uses CMake:

- **Find installed GoogleTest libraries:** Use `find_package(GTest CONFIG REQUIRED)` to locate installed GoogleTest libraries and include directories.

- **Link with GoogleTest and GoogleMock libraries:** Link your tests against target libraries such as `GTest::gtest` and `GTest::gmock`.

Here is an example snippet:

```cmake
find_package(GTest CONFIG REQUIRED)
add_executable(my_tests test1.cpp test2.cpp)
target_link_libraries(my_tests PRIVATE GTest::gtest GTest::gmock_main)
add_test(NAME my_tests COMMAND my_tests)
```

### Building GoogleTest and GoogleMock as Part of Your Project

To avoid compatibility issues between different compiler or linker settings (such as debug vs. release mismatches), include GoogleTest as part of your build:

- Use `add_subdirectory()` in your project's `CMakeLists.txt` to add GoogleTest source.
- Use CMake's `FetchContent` module to fetch and build GoogleTest during configuration:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # For Windows dynamic CRT
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example PRIVATE gtest_main gmock_main)
add_test(NAME example_test COMMAND example)
```

This approach ensures that the same build options are shared between your code and GoogleTest.

### Threading Support and Pthread Flags

GoogleTest and GoogleMock support thread-safe tests on platforms with pthread libraries.

If your build system does not configure pthread automatically, define:

```bash
-DGTEST_HAS_PTHREAD=1
```

and add the required compiler and linker flags (e.g., `-pthread`) to avoid linking errors.

If you are using the provided CMake scripts, these flags and detection are usually handled automatically.

---

## Integration with Other Build Systems

While CMake is the most commonly used, GoogleTest and GoogleMock can be integrated into other environments such as Bazel or manual build scripts by including headers and linking the libraries similarly.

Refer to the [Manual Installation & Source Integration](https://github.com/google/googletest/tree/main/googletest) guide for instructions on manual setups.

---

## Continuous Integration (CI) Platform Integration

GoogleTest's design facilitates easy inclusion in CI pipelines like Jenkins, GitHub Actions, GitLab CI, Travis CI, and more.

Key tips:

- **Use GoogleTest's return codes:** GoogleTest returns `0` on success and non-zero on failures, making it straightforward for CI systems to detect test results.

- **Configure your CI to run tests:** Use the commands you normally use in your environment (`ctest`, `make test`, or running your test binaries) as part of CI steps.

- **Generate XML test reports:** Many CI systems support JUnit-style XML reports. Use GoogleTest's built-in flag:

  ```
  --gtest_output=xml:path/to/report.xml
  ```

  This enables your CI to parse and present test results with detailed reports.

- **Parallel and incremental builds:** Configure your build and test execution stages for parallelism supported by your CI platform.

- **Handling test flakiness:** Isolate flaky tests using GoogleTest's features such as filtering and repeated runs.

---

## Practical Tips and Best Practices

- Always verify your build's compiler flags ensure C++17 compatibility.
- Prefer integrating GoogleTest as a submodule or via FetchContent for maximum compatibility.
- For Windows, consider enabling the `gtest_force_shared_crt` option to avoid runtime library conflicts.
- Use `gmock_main` as the linker target when you want an executable with the default `main()` function linked in.
- Separate test and production build configurations cleanly to prevent accidental inclusion of test-only code in production.

---

## Summary

Integrating GoogleTest and GoogleMock into your build and CI systems empowers efficient, repeatable C++ testing. Leveraging CMake's support or incorporating GoogleTest sources directly ensures consistent builds, while platform and compiler requirements guarantee compatibility. Proper CI configuration enables automated, reliable test execution and reporting, advancing your project's code quality and development velocity.

For detailed code examples, configuration options, and platform nuances, consult the referenced resources below.

---

## Related Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) - Basics of writing and running tests.
- [GoogleMock README](googlemock/README.md) - Introduction to mocking framework.
- [CMakeLists.txt for GoogleMock](googlemock/CMakeLists.txt) - Insight into the build script.
- [GoogleTest README](googletest/README.md) - Generic build instructions.
- [Integration & Best Practices Guides](https://github.com/google/googletest/tree/main/docs/guides/integration-best-practices) - For scalable setups.

---

## Example: Integrate GoogleTest via CMake FetchContent

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # Match Visual Studio runtime linkage
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)
target_link_libraries(my_test PRIVATE gtest_main gmock_main)
add_test(NAME my_test COMMAND my_test)
```

---

## Troubleshooting Integration Issues

<Tip>
If your tests fail to build or link:
- Verify your compiler supports C++17 and the standard flag is properly set.
- Check that required pthread or threading libraries are linked on your platform.
- On Windows, ensure consistent runtime library linkage with `gtest_force_shared_crt`.
- If you include GoogleTest sources directly, confirm the sources are reachable by the build.
</Tip>

<Warning>
Mismatched compiler flags between your project and GoogleTest libraries can cause subtle runtime issues or link errors. Always strive to build GoogleTest with the same settings your application uses.
</Warning>

---