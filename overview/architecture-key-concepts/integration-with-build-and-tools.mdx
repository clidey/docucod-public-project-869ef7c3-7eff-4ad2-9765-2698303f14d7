---
title: "Integration & Compatibility"
description: "See how GoogleTest and GoogleMock integrate with common build systems (like CMake and Bazel), and where they fit in the C++ software toolchain. Briefly cover supported platforms, minimum requirements (C++17+), and how to include and configure the libraries in your projects."
---

# Integration & Compatibility

GoogleTest and GoogleMock are designed to seamlessly integrate with popular C++ build systems and fit naturally within the modern C++ software development toolchain. Understanding how to include and configure these libraries in your projects ensures smooth setup, reliable builds, and consistent behavior across platforms.

---

## Supported Build Systems

### CMake

GoogleTest and GoogleMock include native support for [CMake](https://cmake.org/), one of the most widely used cross-platform build systems in C++ development. The provided CMake scripts enable straightforward configuration and linking.

- **Usage:**
  - You can build GoogleTest and GoogleMock as standalone projects or include their source directly into your project using `add_subdirectory()`.
  - Targets such as `gtest`, `gtest_main`, `gmock`, and `gmock_main` are available for linking your test executables.
  - The libraries are designed to be compatible out-of-the-box with common toolchains and platforms using CMake version 3.13 or later.

- **Typical workflow:**

  ```cmake
  # Find installed GoogleTest/GMock packages
  find_package(GTest CONFIG REQUIRED)

  # Add your test executable
  add_executable(my_tests test_main.cpp my_tests.cpp)

  # Link against GoogleTest or GoogleMock libraries
  target_link_libraries(my_tests PRIVATE GTest::gtest_main GTest::gmock)

  # Enable testing
  enable_testing()
  add_test(NAME MyTest COMMAND my_tests)
  ```

- **Customization:**
  - Options like building shared libraries (`BUILD_SHARED_LIBS`) and toggling test builds are configurable.
  - Appropriate compiler flags and pthread integration are handled internally.

### Bazel

While this documentation mainly covers CMake, GoogleTest and GoogleMock also support [Bazel](https://bazel.build/), Google’s own build tool, through official Bazel rules and workspaces available on the GitHub repository.

- Bazel users can include the GoogleTest and GoogleMock repositories as external dependencies in their Bazel WORKSPACE.
- Usage follows standard Bazel testing conventions, invoking test rules defined in the BUILD files.

*Refer to the project GitHub repository for up-to-date Bazel usage instructions.*

---

## Platform Compatibility and Requirements

GoogleTest and GoogleMock are designed for **maximum portability** across major platforms.

- Supported operating systems include Linux, Windows, and Mac OS X.
- Support extends to embedded platforms like ESP8266, ESP32, and NRF52 with Arduino SDK, as reflected by conditional initialization code.
- The minimum C++ standard requirement is **C++17** to leverage modern language features for safety, performance, and clarity.

---

## Integration into Your Projects

### Including Headers and Linking

To use GoogleTest and GoogleMock, include the appropriate headers and link against either the static or shared libraries provided:

- Include headers:

  ```cpp
  #include <gtest/gtest.h>    // Core GoogleTest API
  #include <gmock/gmock.h>    // For mocking support
  ```

- Link against libraries:

  - `gtest` for GoogleTest alone
  - `gtest_main` for GoogleTest with a main() function provided
  - `gmock` for GoogleMock (depends on GoogleTest)
  - `gmock_main` for GoogleMock with main() function

- Your build system should specify include directories and link libraries, managing dependencies such as pthreads automatically.

### Using pkg-config Files

For projects using pkg-config, GoogleMock provides `.pc.in` templates (`gmock.pc.in` and `gmock_main.pc.in`) that define:

- Library and include paths
- Required dependencies
- Version and description metadata

When properly configured, pkg-config facilitates compiler and linker flag retrieval:

```bash
pkg-config --cflags gmock_main
pkg-config --libs gmock_main
```

This ensures correct linking especially with thread libraries and include paths.

---

## Where GoogleTest and GoogleMock Fit in the C++ Toolchain

GoogleTest and GoogleMock operate primarily at the **testing stage** of the C++ development lifecycle:

- They integrate after the code compilation steps.
- They work alongside code coverage tools, static analyzers, and profilers.
- By providing automated testing capabilities, they enable continuous integration workflows to verify correctness on every change.

Typical workflow:

1. Write C++ code.
2. Write test cases using GoogleTest and mock objects using GoogleMock.
3. Compile your production code and tests, linking against the GoogleTest/GoogleMock libraries.
4. Run tests locally and in CI pipelines.
5. Use test results to identify bugs early and ensure code quality.

---

## Practical Tips for Smooth Integration

- **Consistent C++ standard:** Ensure your project is set to compile with at least C++17 to avoid compatibility issues.
- **Threading support:** GoogleTest detects pthread availability; ensure your linker settings include threading libraries as needed.
- **Use provided main functions:** Unless you have special needs, link against `gtest_main` or `gmock_main` to avoid writing your own `main()` function.
- **Avoid macro conflicts:** GoogleTest macros can clash with other libraries; use compiler flags (`-DGTEST_DONT_DEFINE_TEST=1`) if needed to rename macros.
- **Version consistency:** When using both GoogleTest and GoogleMock, ensure versions match to prevent runtime incompatibilities.

---

## Summary Diagram of Integration Flow

```mermaid
flowchart TD

  subgraph "Development"
    Code["Your C++ Code"]
    Tests["Test Source Files"]
  end

  subgraph "Build System"
    CMake["CMake or Bazel"]
    FindGTest["Find GoogleTest/GoogleMock"]
    Compile["Compiler"]
    Link["Linker"]
  end

  subgraph "Libraries"
    GTestLib["libgtest.a" / "gtest.lib"]
    GTestMain["libgtest_main.a" / "gtest_main.lib"]
    GMockLib["libgmock.a" / "gmock.lib"]
    GMockMain["libgmock_main.a" / "gmock_main.lib"]
    PThreads["PThreads or Threading Lib"]
  end

  Code --> Compile
  Tests --> Compile
  FindGTest --> Compile
  Compile --> Link
  Link --> GTestLib
  Link --> GTestMain
  Link --> GMockLib
  Link --> GMockMain
  Link --> PThreads

  RunTests["Run Test Executable"]
  Link --> RunTests

  %% Styling
  classDef libFill fill:#e3f2fd,stroke:#2196f3,stroke-width:2px;
  class Libraries libFill
```

---

## Troubleshooting Common Integration Issues

<AccordionGroup title="Integration Troubleshooting">
<Accordion title="Linker Errors Related to pthreads">
Often caused by missing thread libraries on the linker command line. Make sure your build system links against `-lpthread` (Linux) or equivalent threading library.

In CMake, enable with:
```cmake
target_link_libraries(your_target PRIVATE Threads::Threads)
```
</Accordion>
<Accordion title="Missing main() Function">
If you see errors about missing `main()`, verify you are linking against `gtest_main` or `gmock_main` if you don’t provide your own `main()` function.
</Accordion>
<Accordion title="Version and Compatibility Conflicts">
Ensure GoogleTest and GoogleMock libraries are from the same release version to avoid symbol conflicts.
</Accordion>
<Accordion title="Macro Clashes with Other Libraries">
Use the compiler flags like `-DGTEST_DONT_DEFINE_TEST=1` to avoid macro collisions with other frameworks.
</Accordion>
</AccordionGroup>

---

## Next Steps

- For detailed build instructions, see [Installation (CMake & Bazel)](/getting-started/setup-installation/installation-methods).
- To learn how to write and run your first test, visit [Writing & Running Your First Test](/getting-started/first-steps-validation/writing-your-first-test).
- For best practices integrating GoogleTest in larger projects, refer to [Integrating GoogleTest with Your Project](/guides/integration-and-best-practices/test-integration).

---