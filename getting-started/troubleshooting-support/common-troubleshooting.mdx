---
title: "Troubleshooting Installation and Configuration"
description: "Lists typical installation and integration errors, describes their root causes, and provides actionable, proven fixes. Example topics include missing headers, linking failures, and C++ standard issues."
---

# Troubleshooting Installation and Configuration

This guide helps you quickly identify and resolve common installation and integration issues when setting up GoogleMock. It covers typical error scenarios such as missing headers, linking failures, and C++ standard mismatches, providing you with actionable, proven fixes to get your GoogleMock environment running smoothly.

---

## 1. Common Installation Issues and Solutions

### 1.1 Missing or Incorrect Headers

**Symptom:** Compiler errors indicating missing files such as `gmock/gmock.h` or related headers.

**Cause:** Include paths not properly configured or GoogleMock source/code not correctly installed or referenced.

**Fix:**

1. Verify your include paths include the directory where GoogleMock headers reside.
2. If integrating via source, ensure `googlemock/include` is added to your compiler include directories.
3. If using installed packages, check package installation correctness.
4. Confirm you are including GoogleMock using `#include <gmock/gmock.h>` exactly.

<Tip>
Ensure you do not use relative paths like `"gmock.h"` without the appropriate include search directories set up. Always prefer angle brackets for system or third-party headers.
</Tip>

---

### 1.2 Linking Failures

**Symptom:** Linker errors complaining about `undefined reference` to GoogleMock symbols or functions.

**Cause:** The GoogleMock library is not linked properly with your test executable.

**Fix:**

1. Link against the GoogleMock static or shared library, typically named `libgmock.a` or `libgmock.so`.
2. When using CMake, link with `gmock` and potentially `gmock_main` target.
3. If building from source, ensure you build GoogleMock and GoogleTest libraries properly before linking.
4. Make sure GoogleMock and GoogleTest versions are compatible.

<Note>
GoogleMock depends on GoogleTest internally. The linking order should generally list GoogleMock first, then GoogleTest.
</Note>

---

### 1.3 C++ Standard Version Issues

**Symptom:** Compilation errors regarding unsupported language features or standard library inconsistencies.

**Cause:** GoogleMock requires at least **C++17** standard to compile correctly; older compiler settings may cause this.

**Fix:**

1. Ensure your compiler is invoked with `-std=c++17` or equivalent flag (e.g., `/std:c++17` in MSVC).
2. Verify your compiler version supports C++17 features:
   - GCC >= 7
   - Clang >= 5
   - MSVC >= Visual Studio 2017 v15.3
3. For MSVC, Visual Studio 2015 or later is required. Earlier versions will raise a compile-time error.

<Warning>
Building GoogleMock with unsupported compilers or incorrect standards results in obscure errors. Always verify compiler capabilities before integration.
</Warning>

---

## 2. Integration Pitfalls

### 2.1 Mixing Runtime Libraries (Windows Visual C++)

**Symptom:** Link errors or runtime crashes when using GoogleMock on Windows with MSVC.

**Cause:** Mismatched C runtime libraries between your project and GoogleMock.

**Fix:**

1. Ensure both your project and GoogleMock compile using the same runtime settings (Multi-threaded DLL `/MD` or Multi-threaded static `/MT`).
2. Inconsistent settings cause symbol mismatches and runtime failures.

<Tip>
Use CMake's `MSVC_RUNTIME_LIBRARY` variable to unify runtimes across all builds.
</Tip>

---

### 2.2 Undefined Flags or Macros

**Symptom:** Errors related to flags like `GMOCK_FLAG_SET` or warnings about missing macros.

**Cause:** GoogleMock flags and macros depend on included header `gmock/internal/gmock-port.h` and related configuration. Improper inclusion or build environment may cause missing definitions.

**Fix:**

1. Always include the public interface header `#include <gmock/gmock.h>` and avoid including internal headers directly.
2. When using GoogleMock's flags programmatically, include `gmock/gmock.h` and initialize GoogleMock with `InitGoogleMock()`.

---

## 3. Runtime and Usage Troubleshooting

### 3.1 Expectation Failures and Mismatched Calls

**Symptom:** Tests fail with messages indicating unexpected calls, argument mismatches, or unsatisfied expectations.

**Cause:** Expectations may be set incorrectly, calls made with unexpected arguments, or ordering constraints violated.

**Fix:**

1. Check the order of `EXPECT_CALL` statements. Expectations must be set *before* exercising the mock.
2. Use the `--gmock_verbose=info` flag when running tests to gain insights into expectation usages and call matching.
3. If necessary, adjust expectations to allow any arguments using `_` matcher, or edit cardinalities using `Times()`.
4. Ensure sequences (`InSequence`) and prerequisite expectations (`After`) are maintained correctly.

<Check>
Misconfigured expectations cause tests to fail. Use verbose output and review calls carefully to adjust mock setup.
</Check>

---

### 3.2 Leaked Mock Objects Warning

**Symptom:** Warning or errors about leaked mocks even after test completes.

**Cause:** Mock object allocated on the heap and not deleted, or test did not finalize mocks before exiting.

**Fix:**

1. Use RAII principles: allocate mocks as stack variables or use smart pointers.
2. Explicitly delete heap mocks at test end.
3. Enable `--gmock_catch_leaked_mocks=true` to have GoogleMock report leaks.

---

## 4. Best Practices for Avoiding Errors

- Include `<gmock/gmock.h>` exclusively for GoogleMock functionality; avoid internal header exposure.
- Always build GoogleMock and GoogleTest with consistent compiler flags and versions.
- Set expectations before code exercises mocks.
- Use `ON_CALL()` to define default mock behaviors where exact call counts or arguments are not important.
- Use `NiceMock` or `StrictMock` to control behavior towards uninteresting calls.
- For complex tests, enable verbose logging with `--gmock_verbose=info` and adjust stack trace depth with `--gtest_stack_trace_depth`.

---

## 5. Additional Resources

- [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) for beginner-friendly tutorial.
- [gMock Cheatsheet](https://google.github.io/googletest/gmock_cheat_sheet.html) for quick syntax reference.
- [GoogleMock GitHub Repository](https://github.com/google/googletest) â€” official source and issue tracker.
- [Assertions Reference](../../docs/reference/assertions.md) for test validation methods.
- [Mocking Reference](../../docs/reference/mocking.md) for in-depth mocking techniques.

---

## 6. Troubleshooting Quick Checklist

| Issue                         | Check/Action                                           |
|------------------------------|--------------------------------------------------------|
| Missing headers               | Include paths, correct `#include <gmock/gmock.h>`     |
| Linking failures             | Link against `gmock` and `gtest` libraries             |
| C++ Standard errors          | Compile with `-std=c++17` or equivalent                 |
| Mismatched runtime (Windows) | Use consistent MSVC runtime settings                    |
| Unexpected mock calls        | Review expectations and argument matchers              |
| Leaked mocks                | Delete heap mocks, or use `--gmock_catch_leaked_mocks` |

---

If you encounter issues beyond these common scenarios, please consult the GoogleTest GitHub repository's issue tracker or community forums for additional troubleshooting support.

<Check>
Be sure to keep your GoogleMock and GoogleTest versions aligned and updated to avoid compatibility issues.
</Check>

---

This documentation will help you resolve frequent obstacles encountered during GoogleMock installation and configuration, empowering you to build reliable and maintainable C++ tests efficiently.

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googlemock/include/gmock/internal/gmock-port.h", "range": "1-120"},{"path": "googlemock/README.md", "range": "1-38"}]} />