---
title: "Common Installation Issues"
description: "Lists the most frequent installation or build problems users encounter, from compiler compatibility problems to linking errors, and provides clear solutions or workarounds."
---

# Common Installation Issues

This guide lists the most frequent installation or build problems users encounter when setting up GoogleTest and GoogleMock, including compiler compatibility problems, linking errors, and common runtime problems. Each section provides concrete solutions or workarounds to help you get past common pitfalls quickly.

---

## 1. Compiler Compatibility Issues

### Problem: Unsupported or Too Old Compiler

GoogleTest and GoogleMock require a C++17-compliant compiler. Using older compilers may result in build failures or unexpected runtime errors.

**Symptoms:**
- Compiler errors related to modern C++ features
- Failing to compile certain headers like `<optional>`, `<variant>`, or template errors

**Solution:**
- Upgrade your compiler to a supported version:
  - GCC 7.3 or later
  - Clang 5 or later
  - MSVC 2017 15.7 or later
- Verify your build environment targets C++17 or higher (e.g., add `-std=c++17` for GCC/Clang, or `/std:c++17` for MSVC).

**Tip:** Check your compiler version with:

```bash
gcc --version
clang --version
cl.exe  # for MSVC
```

---

## 2. Linking Errors

### Problem: Undefined Reference or Linker Errors Related to GoogleTest or GoogleMock Symbols

These often happen if:
- GoogleTest or GoogleMock libraries are not linked properly
- Mixing static and shared versions incorrectly
- Including source files manually without corresponding object files

**Typical Errors:**
```text
undefined reference to `testing::InitGoogleMock(int*, char**)`
undefined reference to `testing::Test::Test()`
```

**Solution:**
- Confirm you have linked the appropriate GoogleTest and GoogleMock libraries.
- With CMake, ensure you link to `gtest` and `gmock` targets correctly.
- If using Bazel, depend on `@com_google_googletest//:gmock` and `@com_google_googletest//:gtest` targets.
- Avoid mixing static and dynamic libraries for GTest/GMock in the same build.

**Best Practice:** Build GoogleTest/GMock separately and link against the resulting libraries instead of including source files directly.

---

## 3. Missing Virtual Destructors in Mock Interfaces

### Problem: Runtime Heapcheck Failures or Crashes Reported When Deleting Mock Objects

GoogleMock requires the base class you mock to have a virtual destructor. Failing to do so can cause undefined behavior and difficult-to-debug runtime errors.

**Example Symptom:**
- Memory leaks reported
- Program crashes at object destruction

**Solution:**
- Ensure all interfaces meant to be mocked have a **virtual destructor**.

Example:

```cpp
class Foo {
 public:
  virtual ~Foo() {}  // Must be virtual!
  virtual void Bar() = 0;
};
```

---

## 4. Build Failures Due to Commas in Template Arguments

### Problem: Errors When Using `MOCK_METHOD` Macro With Types That Contain Commas

Because `MOCK_METHOD` macro parses its arguments by commas, if you use template types with commas unprotected, compilation will fail.

**Example Failure:**
```cpp
MOCK_METHOD(std::pair<bool, int>, GetPair, ());  // Won't compile!
MOCK_METHOD(bool, CheckMap, (std::map<int, double>, bool));  // Won't compile!
```

**Solutions:**
- Wrap the type with parentheses:

```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
MOCK_METHOD(bool, CheckMap, ((std::map<int, double>), bool));
```

- Or define type aliases:

```cpp
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());
using MapIntDouble = std::map<int, double>;
MOCK_METHOD(bool, CheckMap, (MapIntDouble, bool));
```

---

## 5. Linking and Using with Older or Customized Build Systems

### Problem: Linking problems or missing symbols when building GoogleTest manually or integrating with non-standard build tools.

**Solution:**
- Follow best practices to use GoogleTest with supported build systems such as CMake or Bazel.
- Explicitly compile and link the GoogleTest and GoogleMock sources as separate libraries.
- Consult `Installing with CMake` or `Installing with Bazel` guides for configuration details.

---

## 6. Multiple Definitions or Symbol Conflicts

### Problem: Linker errors about multiple definitions

This can happen if the GoogleTest or GoogleMock sources are included in more than one translation unit without proper `extern` declarations or if static linking is done improperly.

**Solution:**
- With CMake, use GoogleTest as a library dependency, not by adding source files multiple times.
- Avoid including `.cc` files directly in multiple places.
- Use proper `testonly` build rules if using Bazel to avoid multiple definitions.

---

## 7. Runtime Warning: Uninteresting Mock Calls

### Problem: Console warnings like `Uninteresting mock function call - returning default value.`

This is a warning that a mock method was called without an explicit expectation.

**To Fix or Suppress:**
- Use `ON_CALL()` to specify default mock behaviors without setting call count expectations.
- Use `NiceMock` to suppress warnings on uninteresting calls.

**Example:**
```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> mock_foo;
EXPECT_CALL(mock_foo, DoThis());
```

See [Knowing When to Expect](gmock_cook_book.md#UseOnCall) for best practices.

---

## 8. MSVC-Specific Compiler Warnings

### Problem: Warnings C4301 or C4373 When Mocking Methods with `const` Parameters

Visual Studio sometimes warns about overriding virtual functions that differ only by const on parameters.

**Solution:**
- Remove top-level const qualifiers on value parameters in interface and mock method declarations, as they are ignored by the compiler.

---

## 9. Slow Compilation Performance

### Problem: Building mocks is slow, memory-intensive, or fails with out-of-memory errors

**Cause:** Mocks generate a lot of code, and compiling mock classes inline can cause issues.

**Solution:**
- Move mock class constructors and destructors definitions to a `.cc` file.
- This reduces per-translation unit compilation and greatly improves build speed.

Example:
```cpp
// In mock_foo.h
class MockFoo : public Foo {
 public:
  MockFoo();
  ~MockFoo();
  MOCK_METHOD(...);
};

// In mock_foo.cc
MockFoo::MockFoo() {}
MockFoo::~MockFoo() {}
```

---

## 10. GoogleMock and Multi-threading

### Problem: Deadlocks or race conditions when using mocks in multi-threaded tests

**Guidelines:**
- Always manipulate and set expectations on mocks in a single thread.
- Calls to mocks can occur in any thread safely.
- Synchronize actions explicitly if order matters between threads.

---

## 11. Verbosity and Debugging

### Problem: Too many or too few gMock diagnostic messages

Control verbosity using the `--gmock_verbose` flag:

| Level   | Description                                         |
|---------|-----------------------------------------------------|
| info    | Most verbose, prints all calls and stack traces    |
| warning | Default, prints warnings and errors without stack trace |
| error   | Only print errors                                   |

Example:
```bash
./my_test --gmock_verbose=info
```

---

# Summary
This document helps users quickly diagnose and remedy the most common build and installation issues with GoogleTest and GoogleMock. It covers compiler compatibility, linking errors, macro usage nuances, runtime warnings, and build performance tips. Additionally, it addresses platform-specific quirks and best practices for multi-threaded usage.

---

# References
- [Installing with CMake](getting-started/installation/install-cmake)
- [Installing with Bazel](getting-started/installation/install-bazel)
- [Configuring Your Project](getting-started/installation/initial-configuration)
- [gMock Cookbook](docs/gmock_cook_book.md)
- [gMock for Dummies](docs/gmock_for_dummies.md)
- [General Usage FAQ](docs/gmock_faq.md)
- [Supported Platforms](getting-started/setup-requirements/supported-platforms)
