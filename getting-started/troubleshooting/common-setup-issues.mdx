---
title: "Troubleshooting Common Setup Issues"
description: "Identify and resolve frequent installation, configuration, and compilation errors. Provides practical solutions for errors encountered during initial setup and first test runs."
---

# Troubleshooting Common Setup Issues

This guide helps you identify and resolve frequent installation, configuration, and compilation issues encountered during your initial setup and first test runs with GoogleTest. Clear, step-by-step solutions target common problems to get your testing environment running smoothly.

---

## 1. Common Installation Problems

### Symptom: Build fails or GoogleTest libraries not found

- **Cause:** GoogleTest source or binaries are not properly downloaded or built.
- **Solution:**
  1. Verify you cloned the complete GoogleTest repository:
     ```bash
     git clone https://github.com/google/googletest.git
     ```
  2. Follow platform-specific build steps as per the [Installation Methods guide](/getting-started/prerequisites-installation/installation-methods):
     - **CMake:** Configure and build with `cmake` and `make` or your IDE.
     - **Bazel:** Use `bazel build //googletest:all`.
  3. Make sure to link your tests against the compiled GoogleTest libraries, including `gtest` and optionally `gtest_main`.

### Symptom: Linking errors or undefined references to GoogleTest symbols

- **Cause:** Missing or incorrect linking of GoogleTest libraries.
- **Solution:**
  - Ensure your build system links against `gtest` and, if using the default main, `gtest_main`.
  - For CMake projects, use:
    ```cmake
    target_link_libraries(your_test_target PRIVATE gtest gtest_main)
    ```
  - For manual compilation, compile your test source together with GoogleTest sources or link against compiled static/shared libraries.

<Note>
Common pitfall: Linking only against `gtest_main` without `gtest` will cause unresolved symbols.
</Note>

## 2. Configuration Issues

### Symptom: Tests are not discovered or executed

- **Cause:** Improper test suite or test case setup, or filter flags excluding tests.
- **Solution:**
  1. Confirm your test cases use proper macros (`TEST()`, `TEST_F()`, `TEST_P()`) with valid, underscore-free suite and test names.
  2. Avoid mixing `TEST()` and `TEST_F()` in the same test suite.
  3. Verify that you call `testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS()` in your `main()` function.
  4. Check for the use of `--gtest_filter` or environment variable `GTEST_FILTER` blocking the execution.
     - Run without filters to verify all tests run.
  5. If your test suite uses parameterized tests (`TEST_P()`), ensure you use `INSTANTIATE_TEST_SUITE_P()` to instantiate them.
  6. For a test suite with `SetUpTestSuite()` or `TearDownTestSuite()`, ensure these are `public` for parameterized tests.

<Warning>
If a parameterized test suite is defined without instantiation, GoogleTest generates a failing test suite report. Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST(YourSuiteName);` to suppress if intentional.
</Warning>

## 3. Compilation and Runtime Errors

### Symptom: Compilation errors such as "no matching function for call to..."

- **Cause:** Typically arises from spelling errors, missing default constructors, or misuse of test macros.
- **Solution:**
  - For test fixture classes, ensure a default constructor exists. GoogleTest requires it to create test instances.
  - Double-check the spelling of `SetUp()` and `TearDown()`. They are case-sensitive (`Setup()` is invalid).
  - Avoid using fatal assertions (`ASSERT_*`, `FAIL()`) inside constructors or destructors, as they can cause compilation failures or undefined behavior. Use `SetUp()` and `TearDown()` for setup and teardown logic.

### Symptom: Fatal failure inside setup or teardown prevents tests from running

- **Cause:** `SetUpTestSuite()`, `SetUp()`, `TearDown()`, or similar lifecycle methods may contain assertions that fail fatally.
- **Solution:**
  1. Use non-fatal assertions (`EXPECT_*`) inside `SetUp()` and `TearDown()` when possible.
  2. For `SetUpTestSuite()` or `TearDownTestSuite()`, be cautious: fatal failures here cause the entire suite to skip.
  3. Examine test logs for fatal failure details in these lifecycle functions.
  4. If a test suite fails to initialize in `SetUpTestSuite()`, GoogleTest will skip the suite. Use the test output to diagnose the cause.

<Check>
Refer to the example in [googletest-setuptestsuite-test_.cc](https://github.com/google/googletest/blob/main/googletest/test/googletest-setuptestsuite-test_.cc) demonstrating failures in setup and teardown.
</Check>

## 4. Common Pitfalls and How to Fix Them

### Mixing `TEST()` and `TEST_F()` in the same test suite

- GoogleTest expects all tests in a suite to use the same fixture. Mixing these will cause runtime failures.
- Fix by converting all tests in the suite to use the same macro, typically `TEST_F()` with a fixture.

### Using Underscores in Test Suite or Test Names

- GoogleTest reserves underscores `_` for special internal use and disallows them in test and test suite names.
- Rename your test suites and test cases to remove underscores to avoid compilation and linker issues.

### Tests Returning Non-void or Using Fatal Assertions in Functions That Return Non-void

- GoogleTest asserts with fatal failures (`ASSERT_*`) can only be used in `void` returning functions.
- Refactor functions with assertions to return `void` or avoid fatal assertions in non-void functions.

### Death Tests Not Working or Hanging

- Death tests (`ASSERT_DEATH`, etc.) run in separate processes. They may hang or crash if concurrent threads exist outside the death test.
- Use `GTEST_FLAG_SET(death_test_style, "threadsafe");` to enable thread-safe death test style.
- Avoid creating threads before death tests, or encapsulate thread creation inside the death test statement.

### Global Environments Setup and TearDown Failures

- Failures in global test environments cause early termination or test skips.
- Check your subclass of `testing::Environment::SetUp()` and `TearDown()` for fatal or non-fatal failures.
- Keep global environment setup lightweight to avoid test interruption.

## 5. Diagnosing Test Failures and Output Issues

- Enable verbose output by running your tests with the `--gtest_print_time=1` flag to see per-test timings.
- Use `--gtest_list_tests` to list all discovered tests; absence of your tests here indicates discovery issues.

## 6. Helpful Debugging Tips

- Redirect test output to a file to analyze large logs:
  ```bash
  ./your_test_binary --gtest_output=xml:report.xml > output.log 2>&1
  ```
- Check for mismatched GoogleTest library and header versions, which can cause odd runtime issues.
- Use `--gtest_break_on_failure` to drop into a debugger immediately when a failure occurs.
- Examine stack traces printed on failure to identify root causes.

---

## Appendix: Useful Commands

```bash
# Cloning GoogleTest repository
git clone https://github.com/google/googletest.git

# Build with CMake (Linux/macOS)
mkdir build && cd build
cmake ..
make

# Running tests with all tests:
./your_test_binary

# Running tests with filtered names:
./your_test_binary --gtest_filter=YourTestSuite.*

# Listing all tests:
./your_test_binary --gtest_list_tests

# Run with verbose timings:
./your_test_binary --gtest_print_time=1
```

---

For further help, consult these documentation pages:

- [Installation Methods](/getting-started/prerequisites-installation/installation-methods)
- [Initial Configuration](/getting-started/prerequisites-installation/initial-configuration)
- [GoogleTest Primer](../primer.md)
- [Testing Reference](../reference/testing.md)

<Tip>
Adding a failure listener that throws exceptions can help catch subroutine assertion failures:

```cpp
class ThrowListener : public testing::EmptyTestEventListener {
 public:
  void OnTestPartResult(const testing::TestPartResult& result) override {
    if (result.type() == testing::TestPartResult::kFatalFailure) {
      throw testing::AssertionException(result);
    }
  }
};

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  testing::UnitTest::GetInstance()->listeners().Append(new ThrowListener);
  return RUN_ALL_TESTS();
}
```

This ensures fatal failures in subroutines don't get silently ignored.
</Tip>

<Warning>
Avoid misusing `SetUpTestSuite` and `TearDownTestSuite` for per-test setup or teardown logic. These are run once per suite, not per test, and improper use can cause unexpected failures.
</Warning>
