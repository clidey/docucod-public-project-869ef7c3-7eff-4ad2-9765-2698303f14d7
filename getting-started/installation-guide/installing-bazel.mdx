---
title: "Installing with Bazel"
description: "Guide users to set up and build using Bazel, with steps for adding GoogleTest to a Bazel project. Note any repository rules or essential .bzl files that must be referenced."
---

# Installing with Bazel

This guide walks you through setting up and building GoogleTest using Bazel, Google's supported build system. You'll learn how to add GoogleTest to your Bazel project, configure dependencies, build test binaries, and run your first test with Bazel.

---

## 1. Prerequisites & Environment Setup

Before starting, ensure your development environment meets these requirements:

- **Operating System**: Linux, macOS, or Windows.
- **C++ Compiler**: Must support at least C++17 standards.
- **Bazel Version**: Bazel 7.0 or newer.

If Bazel is not installed, follow the [Bazel installation guide](https://bazel.build/install) to set it up.

Check the [Supported Platforms & Compilers](../getting-started/setup-introduction/platforms.md) for detailed compatibility.

<Tip>
You can verify your Bazel version by running:

```bash
bazel version
```

Make sure it reports version 7.0 or higher.
</Tip>


## 2. Setting Up Your Bazel Workspace

Bazel requires a workspace directory containing a `MODULE.bazel` file to manage your dependencies.

### Steps:

1. Create and enter your workspace directory:

    ```bash
    mkdir my_workspace && cd my_workspace
    ```

2. Create a `MODULE.bazel` file in the root of your workspace that declares GoogleTest as a dependency.

    ```python
    # MODULE.bazel

    # Use the latest stable version of GoogleTest from Bazel Central Registry
    bazel_dep(name = "googletest", version = "1.17.0")
    ```

This setup will instruct Bazel to fetch GoogleTest from the official registry and manage any necessary transitive dependencies.

<Note>
GoogleTest's Bazel module also declares essential bzl files and repository rules internally, so you do not need to manually include them.
</Note>

## 3. Creating a GoogleTest Target

You can now create your C++ test using GoogleTest within the Bazel workspace.

### Example: A Basic Test

1. Create a test source file named `hello_test.cc` in your workspace:

```cpp
#include <gtest/gtest.h>

// A simple test to demonstrate basics
TEST(HelloTest, BasicAssertions) {
  // Asserts that two strings are not equal.
  EXPECT_STRNE("hello", "world");
  // Asserts that two values are equal.
  EXPECT_EQ(7 * 6, 42);
}
```

2. Create a `BUILD` file alongside your source file to define the Bazel test target:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

- `cc_test`: Bazel rule that builds and runs C++ tests.
- `deps`: Links GoogleTest library and its `main()` implementation.

## 4. Building and Running Your Test

With your workspace and test defined, build and run your test using:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures the compiler uses the C++17 standard as required by GoogleTest.
- `--test_output=all` prints complete test output.
- `//:hello_test` targets the test rule in the workspace root.

### Expected Output Snippet

```text
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)

[  PASSED  ] 1 test.
```

This confirms your GoogleTest test binary was correctly built and executed.

## 5. Behind the Scenes: Key Bazel Files and Repository Rules

GoogleTest's Bazel integration is thoroughly managed and includes:

- **`MODULE.bazel`**: Declares dependencies such as Abseil, RE2, and platforms.
- **Repository Rules & Build Files**: All required `.bzl` and build files are bundled within the GoogleTest repo and automatically handled by Bazel when depending on GoogleTest.

You do not need to create or reference these manually.

## 6. Best Practices & Tips

- Always specify `--cxxopt=-std=c++17` or the appropriate C++ standard flag matching your compiler when invoking Bazel builds using GoogleTest.
- Link both `@googletest//:gtest` and `@googletest//:gtest_main` to your `cc_test`. The latter provides the implementation of `main()`.
- Use the Bazel Central Registry for stable and up-to-date dependency versions.

## 7. Troubleshooting Common Issues

<AccordionGroup title="Common Bazel Installation Issues">
<Accordion title="Test Not Found or Not Running">
Ensure your BUILD file is correctly named as `BUILD` (case-sensitive) and contains a `cc_test` rule referencing `@googletest//:gtest` and `@googletest//:gtest_main` dependencies.
</Accordion>
<Accordion title="Compiler Errors About C++ Standard">
Pass the flag `--cxxopt=-std=c++17` explicitly with your Bazel build or test command. For MSVC, use `--cxxopt=/std:c++17`.
</Accordion>
<Accordion title="Dependency Fetch Failures">
Check your internet connection and that Bazel's module registry is enabled (`--enable_bzlmod=true`). Confirm no proxy or firewall blocks Bazel.
</Accordion>
</AccordionGroup>

## 8. Next Steps

- Explore writing your own tests; see the [GoogleTest Primer](../getting-started/first-test-experience/writing-first-test.md).
- Look into integrating GoogleTest into existing Bazel-based projects.
- Dive deeper into test execution and reporting with Bazel in [Building and Running Tests](../getting-started/first-test-experience/building-running-tests.md).

---

For a comprehensive overview of GoogleTest features and concepts, visit the [Overview & Core Concepts](../../overview/introduction-core/what-is-googletest.md) section.


---

### Summary

This guide details how to set up GoogleTest within a Bazel workspace. It covers preparing your environment, defining Bazel dependencies via `MODULE.bazel`, creating test targets, building and running tests, and addresses common pitfalls.

**Main Sections:**
- Prerequisites
- Workspace & Module Configuration
- Creating and Building Tests
- Running Tests with Bazel
- Repository & Build File Notes
- Troubleshooting

**Related Documentation:**
- [Quickstart: Building with Bazel](../getting-started/installation-guide/installing-bazel.md)
- [GoogleTest Primer](../getting-started/first-test-experience/writing-first-test.md)
- [Supported Platforms](../getting-started/setup-introduction/platforms.md)

**Next Steps:** Explore test writing and running, and dive into advanced Bazel integration techniques.