---
title: "Writing and Running Your First Test"
description: "A hands-on tutorial for writing the first basic test case in C++, compiling it, and running it. This includes tips for using main entry points and command-line options to validate the setup."
---

# Writing and Running Your First Test

Welcome to your first step in using GoogleTest! This guide takes you through writing a simple, foundational test case in C++, compiling it, and running it to verify that your setup works correctly. By the end, you will have created a basic test program, learned how to run tests with the default main entry point, and explored essential command-line options for verification.

---

## 1. Prerequisites

Before you begin, ensure the following prerequisites are met:

- **GoogleTest Installed**: GoogleTest is either installed on your system or included in your project source via appropriate methods (see [Installing with CMake](../../getting-started/prerequisites-installation/installation-cmake)).
- **C++17 or Later Compiler**: Your compiler must support at least the C++17 standard.
- **Build System Setup**: A build system like CMake or other that compiles your test code linking against GoogleTest and (optionally) gtest_main.

<Tip>
If you haven't set up GoogleTest yet, start with the [Requirements and Supported Platforms](../../getting-started/prerequisites-installation/requirements-supported-platforms) and [Installing with CMake](../../getting-started/prerequisites-installation/installation-cmake) guides.
</Tip>

## 2. Writing Your First Test

A GoogleTest test consists of one or more independent test functions grouped in a test suite. Each test verifies a specific behavior with *assertions*.

### Step 1: Create a Test Source File

Write a simple C++ test source file, e.g., `sample1_unittest.cc`:

```cpp
#include "gtest/gtest.h"

// A simple function to test
int Factorial(int n) {
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}

// Define a test case named FactorialTest and a test within it named HandlesZeroInput
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Another test function in the same suite
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

### Key Points:

- Use the `TEST(test_suite_name, test_name)` macro.
- The function body contains assertions (e.g., `EXPECT_EQ`) that validate code behavior.
- The first argument is the test suite name grouping related tests (e.g., `FactorialTest`).
- The second argument is the individual test name.

<Tip>
Test names and suites must be valid C++ identifiers without underscores for best compatibility.
</Tip>

## 3. Building the Test Program

Use your existing build system or manually compile the test file, linking against GoogleTest libraries.

### Using CMake (if applicable):

1. Include your test source file in your `CMakeLists.txt`.
2. Link against GoogleTest and optionally `gtest_main` which provides the main() function.

Example CMake snippet:

```cmake
add_executable(sample1_unittest sample1_unittest.cc)
target_link_libraries(sample1_unittest gtest_main)

include(GoogleTest)
gtest_discover_tests(sample1_unittest)
```

### Manual Compile Example with GCC:

```bash
clang++ -std=c++17 sample1_unittest.cc -lgtest -lgtest_main -pthread -o sample1_unittest
```

<Tip>
Linking `-pthread` is required on Linux and macOS for thread safety.
</Tip>

## 4. Running Your First Test

Your test executable can be run directly:

```bash
./sample1_unittest
```

### What Happens:

- GoogleTest automatically discovers the tests defined via the `TEST` macro.
- Runs each test independently.
- Reports which tests passed or failed in the console output.

Expected output snippet:

```
Running main() from gtest_main.cc
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

<Tip>
If some tests fail, GoogleTest will provide details including the file, line, and failure message.
</Tip>

## 5. Understanding the Test Execution Flow

GoogleTest test programs follow this process:

1. **Initialization:** `testing::InitGoogleTest(&argc, argv)` is called first to parse flags.
2. **Test Discovery:** GoogleTest locates all `TEST` and `TEST_F` instances.
3. **Running Tests:** `RUN_ALL_TESTS()` runs each discovered test, printing results.

Example `main` (usually unnecessary if linking with `gtest_main`):

```cpp
#include "gtest/gtest.h"

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Note

- By linking with `gtest_main`, this `main` is supplied automatically.
- If you need custom initialization, implement your own `main` using the above pattern.

## 6. Running Tests with Useful Command-Line Flags

GoogleTest supports various flags to control test execution.

- **List all tests without running:**

  ```bash
  ./sample1_unittest --gtest_list_tests
  ```

  Lists test suites and individual tests.

- **Filter tests to run:**

  ```bash
  ./sample1_unittest --gtest_filter=FactorialTest.HandlesZeroInput
  ```

  Runs only the matching tests.

- **Run disabled tests:**

  ```bash
  ./sample1_unittest --gtest_also_run_disabled_tests
  ```

- **Stop on first failure:**

  ```bash
  ./sample1_unittest --gtest_fail_fast
  ```

- **Generate XML report:**

  ```bash
  ./sample1_unittest --gtest_output=xml:report.xml
  ```

<Tip>
Run `./sample1_unittest --help` to see the full list of supported flags.
</Tip>

## 7. Common Pitfalls and Tips

- Ensure you call `testing::InitGoogleTest` before running tests.
- Always return the result of `RUN_ALL_TESTS()` from your `main` function.
- Avoid underscores `_` in test suite and test names.
- Use `EXPECT_*` to continue tests on failures and `ASSERT_*` to abort tests early when necessary.

<Tip>
Read the [GoogleTest Primer](../../docs/primer.md) for a detailed walkthrough of writing and structuring tests.
</Tip>

## 8. Next Steps

Once comfortable with writing and running simple tests:

- Explore test fixtures with `TEST_F()` for shared setup.
- Learn about assertions in detail in the [Assertions Reference](../../docs/reference/assertions.md).
- Try value-parameterized tests using `TEST_P()` and instantiation.
- Configure your projectâ€™s build system to incorporate GoogleTest smoothly.
- Read the [Project Configuration and Setup](../configuration-setup) page to ensure project-level integration.

---

## Appendix: Minimal Complete Example

Here is the complete minimal test file and main function if you need to write your own:

```cpp
#include "gtest/gtest.h"

int Factorial(int n) {
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---