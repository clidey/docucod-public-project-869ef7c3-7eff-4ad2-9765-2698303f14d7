---
title: "Project Configuration and Setup"
description: "Walks users through configuring their project for GoogleTest, including how to include the necessary headers, link required libraries, and ensure build files are correct for C++ projects."
---

# Project Configuration and Setup

This guide helps you configure your C++ project to use GoogleTest effectively. You'll learn how to include necessary headers, link the required libraries, and set up your build files correctly to compile and run tests with GoogleTest.

---

## 1. Adding GoogleTest Headers to Your Project

GoogleTest exposes its APIs through its public headers, which you must include in your source files that contain tests.

- Include the main GoogleTest header in your test source files:

```cpp
#include <gtest/gtest.h>
```

- GoogleMock users will also include:

```cpp
#include <gmock/gmock.h>
```

- Ensure your build system knows where to find the GoogleTest headers. This typically involves adding the include directory (e.g., `/path/to/googletest/include`) to your compiler's include path.

### Example

If you installed GoogleTest system-wide, the include path might be `/usr/local/include`. If you build it from source as part of your project, the headers are usually relative to your GoogleTest repo location.

---

## 2. Linking GoogleTest Libraries

For successful test compilation and linking, you need to link your test executables against GoogleTest libraries.

### Available libraries:

- `gtest`: The core GoogleTest library without a `main()` function.
- `gtest_main`: The GoogleTest library that includes a ready-made `main()` function to run tests.

If you use GoogleMock, additional libraries are provided:

- `gmock`: GoogleMock library.
- `gmock_main`: GoogleMock and GoogleTest combined with a `main()` function.

### Linking Strategies

- Link with `gtest_main` or `gmock_main` if you want to use pre-defined `main()` (recommended for quick setup).
- Link with `gtest` or `gmock` if you plan to provide your own `main()` function.

### Example Linker Flags

- Using pkg-config:

```bash
pkg-config --libs gtest_main
# Outputs linker flags such as -lgtest_main -lpthread
```

- Manually specifying libraries:

```cmake
target_link_libraries(your_test_target PRIVATE gtest_main)
```

---

## 3. Configuring Your Build System

### Using CMake

GoogleTest integrates well with CMake. Follow these steps to configure:

#### A. Using Installed GoogleTest

If you have installed GoogleTest on your system, you can find it using CMake's `find_package`:

```cmake
find_package(GTest CONFIG REQUIRED)

add_executable(your_test test_file.cpp)

target_link_libraries(your_test PRIVATE GTest::gtest_main)

enable_testing()
add_test(NAME your_test COMMAND your_test)
```

#### B. Adding GoogleTest as a Subdirectory

For consistent compiler, linker, and build settings, add GoogleTest source directly to your project build:

1. Clone GoogleTest into your project directory or add it as a submodule.
2. Add the following to your `CMakeLists.txt`:

```cmake
add_subdirectory(googletest)

add_executable(your_test test_file.cpp)

target_link_libraries(your_test PRIVATE gtest_main)

enable_testing()
add_test(NAME your_test COMMAND your_test)
```

This method avoids mismatches between your build and GoogleTest settings and is especially useful on Windows.

#### C. Using FetchContent (CMake 3.14+)

You can configure your project to automatically download GoogleTest during the build configuration:

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)

FetchContent_MakeAvailable(googletest)

add_executable(your_test test_file.cpp)

target_link_libraries(your_test PRIVATE gtest_main)

enable_testing()
add_test(NAME your_test COMMAND your_test)
```

This is the most flexible approach for CI environments and up-to-date integration.

---

## 4. Important Build Options and Macros

- GoogleTest requires **C++17** support in your compiler.
  - Ensure you set `set(CMAKE_CXX_STANDARD 17)` and `set(CMAKE_CXX_STANDARD_REQUIRED ON)` in your `CMakeLists.txt`.

- On Windows with Visual Studio, consider enabling the `gtest_force_shared_crt` option if you encounter runtime library conflicts.

- To build GoogleTest as a shared library (.dll), define `GTEST_CREATE_SHARED_LIBRARY=1` and link your test executables with `GTEST_LINKED_AS_SHARED_LIBRARY=1`.

- To avoid macro name clashes, you can disable GoogleTest's macro definitions by defining flags like `-DGTEST_DONT_DEFINE_TEST=1` and using the prefixed versions such as `GTEST_TEST`.

---

## 5. Example CMake Configuration for a Test Target

```cmake
cmake_minimum_required(VERSION 3.16)
project(MyProjectTests)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Add GoogleTest as subdirectory or use installed libraries
add_subdirectory(googletest)

add_executable(my_tests my_test_file.cpp)

target_link_libraries(my_tests PRIVATE gtest_main)

enable_testing()
add_test(NAME my_tests COMMAND my_tests)
```

Replace `my_test_file.cpp` with your test source file.

---

## 6. Testing Your Configuration

Once configured, build your project and run the test executable. For example:

```bash
mkdir build
cd build
cmake ..
cmake --build .

./my_tests
```

You should see GoogleTest's standard output indicating test discovery and results.

<Tip>
If you see linker errors about missing pthreads on Linux or incorrect runtime libraries on Windows, revisit your build flags and required threading libraries.
</Tip>

---

## 7. Troubleshooting Common Issues

<AccordionGroup title="Common Configuration Issues">
<Accordion title="Include Path Not Found">

- Ensure the GoogleTest include directory is added to your compiler include paths.
- If using CMake with `add_subdirectory`, headers are included automatically.

</Accordion>
<Accordion title="Linker Errors (Undefined References)">

- Check that you linked `gtest` or `gtest_main`.
- For multi-threaded errors, ensure pthread (`-lpthread`) is linked on POSIX systems.
- On Windows, set `gtest_force_shared_crt` if runtime mismatches occur.

</Accordion>
<Accordion title="Runtime Library Conflicts on Visual Studio">

- Set `-Dgtest_force_shared_crt=ON` in your CMake configuration.
- Confirm that your whole project and GoogleTest use the same runtime linkage (dynamic or static).

</Accordion>
<Accordion title="Building with Older Compilers">

- GoogleTest needs a compiler supporting C++17.
- Upgrade your compiler or adjust your project to use a supported environment.

</Accordion>
</AccordionGroup>

---

## 8. Next Steps

- Proceed to [Writing and Running Your First Test](/getting-started/first-test-configuration/writing-first-test) to create your initial test cases.
- Review [Requirements and Supported Platforms](/getting-started/prerequisites-installation/requirements-supported-platforms) to ensure your environment is compatible.
- Visit [Installing with CMake](/getting-started/prerequisites-installation/installation-cmake) for detailed installation instructions.


---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest CMakeLists.txt Source](https://github.com/google/googletest/blob/main/CMakeLists.txt)
- [GoogleTest Pkg-config Usage](docs/pkgconfig.md)

---

By following this guide, your project will be correctly configured to build and run tests using GoogleTest with minimal friction and maximum reliability.