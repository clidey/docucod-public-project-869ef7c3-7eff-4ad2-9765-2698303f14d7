---
title: "Basic Configuration & Project Setup"
description: "Guidance on configuring GoogleTest and GoogleMock within a C++ project—covering adding dependencies, using CMake targets, and initial project structure. This page clarifies essential configuration steps so users can focus on writing their first tests rather than struggling with setup."
---

# Basic Configuration & Project Setup

This guide provides clear instructions on how to configure GoogleTest and GoogleMock within your C++ project. By following these essential configuration steps, you'll quickly integrate the testing framework and focus on writing your first tests without setup hurdles.

---

## 1. Adding GoogleTest and GoogleMock Dependencies

Before writing tests, ensure your project is configured to find and link GoogleTest and GoogleMock.

### Using CMake

GoogleTest and GoogleMock provide convenient CMake targets to help integrate them into your build.

1. **Add GoogleTest as a dependency:**

   In your `CMakeLists.txt`, include GoogleTest with `FetchContent` or add it as a subdirectory if you have it locally.

   ```cmake
   include(FetchContent)
   FetchContent_Declare(
     googletest
     URL https://github.com/google/googletest/archive/refs/tags/release-1.14.0.zip
   )
   FetchContent_MakeAvailable(googletest)

   enable_testing()
   ```

2. **Link your test target with GoogleTest and GoogleMock:**

   ```cmake
   add_executable(MyTests test_main.cc my_class_test.cc)

   target_link_libraries(MyTests
      GTest::gtest
      GTest::gmock
      GTest::gtest_main
   )

   include(GoogleTest)
   gtest_discover_tests(MyTests)
   ```

### Using Bazel

If using Bazel, add the GoogleTest and GoogleMock dependencies in your `WORKSPACE` and link them in your `BUILD` files. Refer to [integration and ecosystem documentation](/overview/feature-architecture-and-integration/integration-and-ecosystem) for detailed Bazel integration.

---

## 2. Basic Configuration Options

GoogleTest and GoogleMock support configuration both via code and command-line flags for flexible behavior.

### Initialization

In your test driver (usually a `main` function), initialize GoogleMock (which also initializes GoogleTest):

```cpp
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This step parses command-line flags and sets up the framework for test discovery and execution.

### Configuration Macros & Flags

- `--gmock_verbose`: Controls logging verbosity. Values can be `info`, `warning` (default), or `error`.
- `--gmock_catch_leaked_mocks=0|1`: Whether GoogleMock checks for leaked mocks, enabled by default.

You can set these flags on the test command line or programmatically:

```cpp
::testing::FLAGS_gmock_verbose = "info";
```

Refer to [Configuration Macros & Flags](/api_reference/platform_integration_and_utilities/configuration_macros_flags) for more options.

---

## 3. Initial Project Structure

Organizing your test project enables scalable and maintainable test code. Here's a common starting layout:

```
project-root/
├── src/                 # Production code
│   └── my_class.cc
│   └── my_class.h
├── tests/               # Test code
│   ├── CMakeLists.txt
│   ├── test_main.cc     # Test runner with InitGoogleMock
│   └── my_class_test.cc # Unit tests for MyClass
└── CMakeLists.txt       # Project build
```

### Writing a Test Runner (`test_main.cc`)

Define the entry point that initializes GoogleMock and runs all tests:

```cpp
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This file compiles into an executable that discovers and runs all defined tests.

### Test Files

Each production source file (`my_class.cc`) should have a corresponding test file (`my_class_test.cc`) that:

- Includes `gmock/gmock.h` and `gtest/gtest.h`
- Defines test suites and test cases
- Uses mocks and assertions

Example minimal test file:

```cpp
#include <gmock/gmock.h>
#include "my_class.h"

using ::testing::Test;

TEST(MyClassTest, DoesThingCorrectly) {
  MyClass obj;
  EXPECT_TRUE(obj.DoThing());
}
```

---

## 4. Using GoogleMock Targets and Linking

In CMake, GoogleTest provides the following targets:

- `GTest::gtest` - The Google Test framework
- `GTest::gtest_main` - Main function for tests
- `GTest::gmock` - Google Mock framework

Link your test executable against these targets as shown above to have all dependencies resolved properly.

---

## 5. Practical Tips & Best Practices

- Use `NiceMock` to suppress warnings on uninteresting calls, and `StrictMock` to catch unexpected calls early.
- Always initialize GoogleMock in your test main function.
- Structure your project so production code and test code are cleanly separated.
- Favor `ON_CALL` to set default mock behaviors and `EXPECT_CALL` for calls you want to strictly verify.
- Link only the targets you need - for most tests, linking `GTest::gtest`, `GTest::gmock`, and `GTest::gtest_main` suffices.

---

## 6. Troubleshooting Common Setup Issues

- **Issue:** Tests don't build due to missing GoogleMock headers or libraries.

  - Verify that GoogleMock is correctly downloaded or installed.
  - Ensure your include paths and linker settings correctly point to GoogleMock.

- **Issue:** Tests run but no tests are discovered.

  - Make sure `InitGoogleMock()` is called in `main`.
  - Check that your test source files contain properly defined test cases.

- **Issue:** Link errors unresolved symbols related to GoogleMock.

  - Confirm that you linked `GTest::gmock` and `GTest::gtest` in your test executable.

For more help, consult [Troubleshooting & Common Setup Issues](/getting-started/first-steps-validation/troubleshooting).

---

# Summary
By following this guide for Basic Configuration & Project Setup, you will have a clean, properly linked C++ testing project with GoogleTest and GoogleMock ready to write and run tests. This foundation enables a frustration-free start focused on test development.


---

## Useful Links
- [Installation on Linux, macOS, and Windows](/getting-started/setup-requirements/install-platforms)
- [Using Mocks in Tests](https://google.github.io/googletest/gmock_for_dummies.html#using-mocks-in-tests)
- [Mocking Reference](reference/mocking.md)
- [Configuration Macros & Flags](/api_reference/platform_integration_and_utilities/configuration_macros_flags)
- [Troubleshooting & Common Setup Issues](/getting-started/first-steps-validation/troubleshooting)

---