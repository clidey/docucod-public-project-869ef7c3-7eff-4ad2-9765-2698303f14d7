---
title: "Troubleshooting Common Setup Issues"
description: "Quick troubleshooting for frequent setup challenges, such as unsupported compilers, CMake errors, or linking failures, with actionable solutions and references to FAQ resources."
---

# Troubleshooting Common Setup Issues

Quickly resolve frequent setup challenges encountered when preparing GoogleTest and GoogleMock for your C++ projects. This guide addresses common issues such as unsupported compilers, CMake configuration errors, and linking failures with targeted, actionable solutions. Additionally, it points you to FAQ resources for further exploration.

---

## 1. Unsupported Compiler or Compiler Version

GoogleTest and GoogleMock require a C++17-compatible compiler or newer. If you receive errors related to unsupported language features or find build failures during compilation, verify your compiler version first.

### How to Check Your Compiler Version

Run the following commands according to your platform:

```bash
# GCC
gcc --version

# Clang
clang --version

# MSVC
cl
```

GoogleTest requires at least:

- GCC 7 or later
- Clang 5 or later
- Microsoft Visual Studio 2017 Update 3 or later

### Solution

- Upgrade your compiler to meet these minimums.
- On Linux/macOS, use your package manager or install newer toolchains.
- On Windows, update Visual Studio or install the latest Build Tools.

<Tip>
Always verify your build environment matches these compiler requirements before proceeding. Using unsupported compilers leads to subtle bugs or build failures.
</Tip>

---

## 2. CMake Errors or Misconfiguration

GoogleTest and GoogleMock primarily use CMake for building, and common setup problems arise from CMake misconfigurations.

### Common Symptom: “Could NOT find GoogleTest” or “No rule to make target” Errors

This usually indicates that GoogleTest sources or the CMakeLists.txt are not properly located or referenced.

### Step-by-Step Fix

1. **Confirm CMake Version**

Make sure you have CMake 3.10 or higher:

```bash
cmake --version
```

2. **Verify GoogleTest Source Placement**

If including GoogleTest as a submodule or downloaded package, ensure the path is correct in your `CMakeLists.txt`, for example:

```cmake
add_subdirectory(path/to/googletest)
```

3. **Use the Recommended GoogleTest Configuration**

The GoogleTest build system uses targets `gtest` and `gmock` that you should link against.

Example snippet:

```cmake
find_package(GTest REQUIRED)

target_link_libraries(my_test PRIVATE GTest::gtest GTest::gmock)
```

4. **Clear CMake Cache and Reconfigure**

Run:

```bash
rm -rf build/
mkdir build && cd build
cmake ..
make
```

5. **Custom Flags**

If you set any special flags in CMakeLists (e.g., disabling exceptions), ensure these flags are compatible with GoogleTest.

<Tip>
Run CMake with `--trace-expand` to get detailed logs if configuration fails.
</Tip>

---

## 3. Linking Failures

Errors about undefined references to GoogleTest or GoogleMock symbols typically stem from missing link libraries or incorrect linkage order.

### Common Causes

- Forgetting to link `gtest`, `gmock`, or their main libraries.
- Linking incorrect library versions.
- Mixing static and dynamic libraries improperly.

### How to Fix

1. **Link Proper Targets in Your Build System**

For CMake, link against imported targets:

```cmake
target_link_libraries(my_test PRIVATE GTest::gtest GTest::gmock_main)
```

`gmock_main` contains the ready-to-use main function provided by GoogleMock.

2. **Check Build Order**

Ensure dependencies order is correct; libraries that depend on others should be linked after their dependencies.

3. **Verify Library Paths**

If using pre-built binaries, confirm that the linker can find `.lib`, `.a`, or `.so` files and their paths are properly set.

4. **Use Provided Main or Create Your Own**

GoogleMock provides `gmock_main` which defines `main()` suitable for most use cases. If you define your own `main()`, link against `gmock` (not `gmock_main`).

<Tip>
If you see multiple definition errors, it may mean linking both `gmock` and `gmock_main`. You should link only one.
</Tip>

---

## 4. Common Pitfalls and How to Avoid Them

| Issue | Symptom | Solution |
|-------|---------|----------|
| Missing Virtual Destructor in Mocked Class | Heap checker failures or memory leaks | Ensure interfaces and classes intended for mocking have virtual destructors. |
| Compiler Warnings About Const Parameters | Warnings C4301 or C4373 on MSVC | Remove top-level `const` from parameters as it's ignored in declarations and causes MSVC issues. |
| Uninteresting Calls Warnings | Warnings for mocks without expectations | Use `NiceMock<>` to suppress, or explicitly add `.Times(AnyNumber())` expectations for those methods. |
| Setting Expectations After Calls | Undefined behavior, failed expectations | Always set `EXPECT_CALL` before exercising the mock.

---

## 5. Where to Go Next

If the above steps don’t resolve your issue, consult these resources:

- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) — In-depth answers for common questions.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Detailed recipes for usage.
- [System Requirements](../prerequisites-installation/system-requirements.md) — Verify your environment matches all requirements.
- [Installation Overview](../prerequisites-installation/installation-overview.md) — Stepwise installation instructions.

<Tip>
Run your tests with `--gmock_verbose=info` to get detailed logs on mock calls and enable easier debugging of expectations.
</Tip>

---

## Summary

Set up environment with supported compiler and proper CMake version, carefully configure your build system to include and link GoogleTest and GoogleMock libraries, and mind common pitfalls like virtual destructors and expectation timing. Follow up with official FAQ and cookbook to deepen your understanding and troubleshoot effectively.

---

## Additional References

- [GoogleTest Primer](../primer.md) — Concepts and example-based introduction.
- [Mocking Reference](../reference/mocking.md) — Comprehensive reference for mocking macros and classes.
- [gMock Cheat Sheet](../gmock_cheat_sheet.md) — Quick syntax and usage overview.

---

<Source url="https://github.com/google/googletest" paths={[{"path": "docs/gmock_faq.md", "range": "1-300"},{"path": "docs/gmock_cook_book.md","range": "1-1200"},{"path": "docs/reference/mocking.md","range": "1-300"}]}/>
