---
title: "Configuring GoogleTest"
description: "Explains essential configuration steps after installation, including environment setup, compiler flags, and linking requirements. Helps users validate correct integration before writing their first test."
---

# Configuring GoogleTest

After successfully installing GoogleTest, the next critical step is configuring the environment to ensure your tests compile, link, and run correctly. This guide walks you through essential configuration tasks including setting environment variables, applying necessary compiler flags, and linking requirements. Completing these steps validates your integration and prepares you for writing and running tests effectively.

---

## 1. Environment Setup

Before including GoogleTest in your test projects, ensure your environment is configured properly to locate headers, libraries, and necessary threading support.

### 1.1 Include Paths and Library Directories
- Verify that your compiler's include path (`-I`) points to GoogleTest's installed headers (usually `include/gtest` and `include/gtest/internal`).
- Set the library search path (`-L`) to where the compiled GoogleTest libraries (`libgtest.a`, `libgtest_main.a`, or their platform equivalents) reside.

If you installed GoogleTest using system-wide mechanisms (e.g., `make install`), these paths commonly reside under `/usr/local/include` and `/usr/local/lib`.

### 1.2 Threading Libraries
GoogleTest depends on pthreads or platform threading libraries to enable thread safety.

- Confirm that the `-pthread` compiler and linker flags are included.
- On some platforms, you may need to explicitly link against `pthread` (e.g., add `-lpthread` to your linker flags).

<Tip>
Always verify your build system passes the `-pthread` flag for both compiling and linking to avoid subtle runtime failures.
</Tip>

### 1.3 Defining Macros for Thread Support

GoogleTest auto-detects pthread availability but sometimes requires manual intervention.

- To force enable pthread support, define the macro `GTEST_HAS_PTHREAD=1` in your compiler flags.
- To disable pthreads, define `GTEST_HAS_PTHREAD=0`.

Example:

```bash
-DGTEST_HAS_PTHREAD=1
```

---

## 2. Compiler Flags and Macros

GoogleTest requires certain compiler flags and macros to be defined for correct operation and integration.

### 2.1 C++ Standard Version
- Ensure your compiler uses **C++17** or higher.
- In your build files, set:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

or add:

```bash
-std=c++17
```

in the compiler flags.

### 2.2 Shared Library Flags

If you are building GoogleTest as a shared library (DLL), you must:

- Define `GTEST_CREATE_SHARED_LIBRARY=1` when building GoogleTest itself.
- When compiling your tests linking against shared GoogleTest libraries, define `GTEST_LINKED_AS_SHARED_LIBRARY=1`.

Adding these ensures proper export/import declarations and runtime behavior.

### 2.3 Avoiding Macro Conflicts

To prevent macro name clashes with other libraries, GoogleTest can prefix its test-related macros.

Define `GTEST_DONT_DEFINE_TEST=1`, etc., to disable the original macro names, requiring you to use prefixed names like `GTEST_TEST`.

Example:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

Note that disabling macros requires updating your test code accordingly.

---

## 3. Linking Requirements

Your test binaries must link against the correct GoogleTest libraries.

### 3.1 Libraries to Link
- **gtest**: Core GoogleTest library (without main function).
- **gtest_main**: GoogleTest library that also provides a `main()` function.

For most users, linking with `gtest_main` simplifies test execution as it supplies the entry point.

### 3.2 Linking Thread Libraries
- Add `-lpthread` or equivalent to linker flags if your platform requires explicit linking for pthread support.

### 3.3 Using pkg-config (Recommended Setup)

If you installed GoogleTest with `.pc` files for pkg-config, use it to get all required flags:

```bash
pkg-config --cflags gtest_main
pkg-config --libs gtest_main
```

In CMake, you can use pkg-config as:

```cmake
find_package(PkgConfig REQUIRED)
pkg_search_module(GTEST REQUIRED gtest_main)

target_compile_options(your_test_target PRIVATE ${GTEST_CFLAGS})
target_link_libraries(your_test_target PRIVATE ${GTEST_LDFLAGS})
```

This method guarantees you get consistent flags and library paths.

<Tip>
If `pkg-config` cannot find GoogleTest, ensure the environment variable `PKG_CONFIG_PATH` includes the directory containing GoogleTestâ€™s `.pc` files, typically `/usr/local/lib/pkgconfig` or `/usr/lib/pkgconfig`.
</Tip>

---

## 4. Validating Your Configuration

To confirm the setup, compile and link a minimal test executable.

### 4.1 Minimal Test Code Example

Create `sample_test.cpp`:

```cpp
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1, 1);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### 4.2 Compile and Link Command (Example)

```bash
c++ -std=c++17 sample_test.cpp -lgtest_main -lpthread -o sample_test
```

Adjust paths as needed.

### 4.3 Run the Test

```bash
./sample_test
```

Expected output:

```plaintext
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SampleTest
[ RUN      ] SampleTest.BasicAssertions
[       OK ] SampleTest.BasicAssertions (0 ms)
[----------] 1 test from SampleTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

If this runs and passes, your configuration is correctly set.

---

## 5. Troubleshooting Common Configuration Issues

### Problem: Undefined Reference to pthread functions
- Ensure you pass the `-pthread` flag to both compiler and linker.
- If using a custom build system, explicitly add `-lpthread` in linker flags.

### Problem: Macro redefinition errors
- Check for conflicting macro definitions.
- Use `-DGTEST_DONT_DEFINE_TEST=1` if needed and update test code accordingly.

### Problem: Linking errors with shared libraries
- Confirm that `GTEST_CREATE_SHARED_LIBRARY` and `GTEST_LINKED_AS_SHARED_LIBRARY` macros are defined appropriately.
- Verify runtime library settings on Windows to avoid conflicts between dynamic/static CRT.

### Problem: Compiler does not support C++17
- Upgrade your compiler or adjust your build environment.
- Set the C++ standard explicitly with `-std=c++17`.

<Tip>
Refer to the [System Requirements](../setup-overview/system-requirements) and [Platform-specific Notes](../installation/platform-specific-notes) documentation for platform-dependent nuances.
</Tip>

---

## 6. Next Steps

Now that your environment is configured and tested:

- Proceed to [Writing Your First Test](../first-steps/writing-your-first-test) to start creating test cases.
- Use [Verifying Your Setup](../first-steps/verifying-setup) to confirm the complete integration.
- Explore [Integration with Build and CI Systems](../../overview/integration-adoption/integration-workflow) for advanced incorporation in your development workflow.

---

## References

- [GoogleTest Primer](primer.md)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [System Requirements](../setup-overview/system-requirements)
- [Using pkg-config with GoogleTest](../../docs/pkgconfig.md)

---

This configuration ensures GoogleTest is correctly integrated into your build environment, enabling you to focus quickly on writing robust and maintainable tests.


---

<Info>
For detailed CMake integration examples, see the [Install with CMake](../installation/installation-cmake) page.
</Info>