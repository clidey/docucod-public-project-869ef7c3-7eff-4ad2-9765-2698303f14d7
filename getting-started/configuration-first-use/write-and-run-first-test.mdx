---
title: "Write and Run Your First Test"
description: "A practical walkthrough for writing your first unit test with GoogleTest, compiling it, and executing the test suite. Demonstrates usage of the main testing macros and showcases what success looks like."
---

# Write and Run Your First Test

This guide walks you through the practical steps of writing, compiling, and executing your first unit test with GoogleTest. You'll learn how to structure a simple test case, understand the key testing macros, and recognize what success looks like when running your tests.

---

## 1. Writing Your First Test

The first step in using GoogleTest is to create a test case using the `TEST` macro. This macro defines a test function within a test suite where you place assertions to verify your code's behavior.

### Step-by-Step: Create a Simple Test

1. **Include the GoogleTest header** at the top of your test source file:

   ```cpp
   #include <gtest/gtest.h>
   ```

2. **Define a test** using the `TEST` macro. It takes two arguments: the test suite name and the test name. Both must be valid C++ identifiers without underscores:

   ```cpp
   TEST(FactorialTest, HandlesZeroInput) {
     EXPECT_EQ(Factorial(0), 1);
   }
   ```

   This example assumes you have a function `Factorial()` and verifies that `Factorial(0)` returns `1`.

3. **Add additional tests** in the same suite or other suites to cover more cases:

   ```cpp
   TEST(FactorialTest, HandlesPositiveInput) {
     EXPECT_EQ(Factorial(1), 1);
     EXPECT_EQ(Factorial(2), 2);
     EXPECT_EQ(Factorial(3), 6);
   }
   ```

### Understanding Key Macros

- `TEST(test_suite_name, test_name)`: Defines an independent test.
- `EXPECT_EQ(val1, val2)`: Asserts non-fatal equality between two expressions. On failure, outputs a message but continues the test.
- `ASSERT_EQ(val1, val2)`: Similar to `EXPECT_EQ`, but aborts the test if the assertion fails.

Use `EXPECT_*` when you want all assertions to run, and `ASSERT_*` when a failure means there's no point continuing the test function.

## 2. Compiling Your Test

To compile your test program, ensure that it is linked against GoogleTest libraries (usually `gtest` and optionally `gtest_main` if you don't write your own `main`).

### Typical Compilation Command with CMake

GoogleTest integrates smoothly with CMake. A minimal example:

```cmake
add_executable(MyTest test_file.cc)
target_link_libraries(MyTest gtest_main)
add_test(NAME MyTest COMMAND MyTest)
```

If you build manually or with another system, you must:

- Include the GoogleTest headers in your compiler include path.
- Link against the compiled GoogleTest (`gtest`) and GoogleMock (`gmock`) libraries if used.
- Link pthread when necessary on POSIX systems.

### Writing Your Own main() (Optional)

If you do not link with `gtest_main`, write a simple `main()`:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This initializes GoogleTest and runs all the tests you defined.

## 3. Running Your Test Suite

Once compiled, running the resulting executable will perform all the registered tests.

### Expected Output Example

A successful test run displays progress and conveys the results:

```
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)

[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

If a test fails, GoogleTest will print detailed information, including the file and line number, expected and actual values, and a stack trace if enabled.

### Command-Line Flags to Control Execution

- You can run a subset of tests using `--gtest_filter=TestSuiteName.TestName`.
- Increase verbosity or control output using flags such as `--gtest_verbose`.

## 4. Practical Tips

- **Name your test suites and tests clearly** to reflect what behavior they verify.
- **Use `EXPECT_` macros for non-fatal checks**, allowing tests to continue and detect multiple failures.
- **Use `ASSERT_` macros when further test steps depend on a successful condition.**
- **Avoid underscores in test names** to comply with GoogleTest naming conventions.
- **Compile with the same C++ standard as GoogleTest requires** (C++17 minimum).

## 5. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Your First Test">
<Accordion title="Test Registration Failure or Executable Runs with No Tests">
Ensure you have included `testing::InitGoogleTest(&argc, argv);` before calling `RUN_ALL_TESTS()`. Without initialization, tests are not registered.
</Accordion>
<Accordion title="Linker Errors for gtest Symbols">
Verify that you link your test executable against the `gtest` and/or `gtest_main` libraries properly. Use CMake targets or link with the correct library files.
</Accordion>
<Accordion title="Compilation Failures Due to Missing Headers">
Make sure the include path includes the directory where GoogleTest headers live (`<gtest/gtest.h>`).
</Accordion>
<Accordion title="Tests Failing Unexpectedly">
Run the executable with `--gtest_filter` to isolate failing tests. Inspect assertion messages for clues.<br>If you compiled GoogleTest yourself, ensure it matches the compiler and settings for your test code.
</Accordion>
</AccordionGroup>

## 6. Next Steps

- Explore [GoogleTest Primer](../guides/getting-started/primer-basics.md) for detailed basics on authoring tests.
- Learn to use [Test Fixtures](../guides/core-testing-workflows/test-fixtures-best-practices.md) for sharing initialization.
- Review [Project Setup & Configuration](../getting-started/configuration-first-use/project-setup.md) for advanced build integration.
- Try writing your first mock objects with [gMock for Dummies](../gmock_for_dummies.md).

---

For more in-depth learning, the GoogleTest user guide provides extensive details, examples, and best practices.

---

# Example: Your First Complete Test File

```cpp
#include <gtest/gtest.h>

// Sample function under test
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Test case
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}

// Optional main if not linked with gtest_main
// int main(int argc, char **argv) {
//   testing::InitGoogleTest(&argc, argv);
//   return RUN_ALL_TESTS();
// }
```

Compile, execute, and see results as shown before.
