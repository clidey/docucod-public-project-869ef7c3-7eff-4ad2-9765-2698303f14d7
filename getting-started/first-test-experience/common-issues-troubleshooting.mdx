---
title: "Troubleshooting & Common Issues"
description: "Helps users quickly diagnose and solve frequent setup issues, such as build errors, linker issues, header not found problems, and version mismatches. Provides guidance on where to find additional help and how to validate a correct installation."
---

# Troubleshooting & Common Issues

This guide helps you quickly diagnose and resolve common setup problems with GoogleTest and GoogleMock. Whether you're encountering build errors, linker failures, header not found issues, or mismatches between versions, this page provides practical solutions to get you back on track. It also guides you on how to verify a correct installation and where to find further assistance.

---

## 1. Common Build Errors

### 1.1 Missing Dependencies or Headers

**Problem:**
You get compiler errors such as `fatal error: gtest/gtest.h: No such file or directory` or similar for `gmock` headers.

**Cause:**
Include paths are not correctly configured, or the dependencies are not properly installed.

**Solution:**
- Verify you've installed GoogleTest and GoogleMock correctly (see [Installing GoogleTest and GoogleMock](getting-started/installation-setup/installation-methods)).
- Ensure your build system (CMake, Bazel, or manual) sets up include paths to the source or installed directories where `gtest` and `gmock` headers live.
- For CMake, ensure you `find_package(GTest REQUIRED)` and link to `GTest::gmock` or `GTest::gtest` targets.
- Check your include directives use the correct relative paths, e.g., `#include <gtest/gtest.h>`, `#include <gmock/gmock.h>`.

### 1.2 Macro or Syntax Errors with MOCK_METHOD

**Problem:**
Compilation errors around `MOCK_METHOD` macro usage.

**Cause:**
Incorrect macro parameters, unprotected commas in return types or arguments, or missing qualifiers.

**Solution:**
- Wrap complex return types or argument types containing commas in parentheses.

```cpp
// Incorrect (won't compile)
MOCK_METHOD(std::pair<bool, int>, GetPair, ());

// Correct (wrap with extra parentheses)
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
```

- Use type aliases to simplify method signatures.
- Remember to add `(override)` and/or `(const, override)` correctly when overriding virtual or const methods.
- Refer to the [MOCK_METHOD documentation](docs/reference/mocking.md#MOCK_METHOD) for detailed syntax.

---

## 2. Linker Errors

### 2.1 Undefined References to GoogleTest or GoogleMock Symbols

**Problem:**
Linker errors complaining about undefined symbols from gtest or gmock.

**Cause:**
GoogleTest or GoogleMock libraries are not linked to your test executable.

**Solution:**
- Link your test binary against the GoogleTest and GoogleMock libraries.
- For CMake, add `${GTEST_LIBRARIES}` or `GTest::gmock_main` to your target link libraries.
- For Bazel, make sure your target depends on `//third_party/googletest:gmock_main` or similar.
- If you built GoogleTest/Mock manually, link against `libgmock.a` and `libgtest.a` or their shared equivalents.

---

## 3. Runtime Issues

### 3.1 Tests Are Not Discovered or Run

**Problem:**
No tests appear to run, or GoogleTest reports zero tests.

**Cause:**
- Tests are defined but not compiled or linked into the test binary.
- The test function names don't follow the `TEST()` or `TEST_F()` macros.
- The test executable does not invoke `RUN_ALL_TESTS()`.

**Solution:**
- Verify your tests are compiled and linked in the test binary.
- Confirm you use `TEST` or `TEST_F` macros properly.
- Ensure your `main()` function calls `testing::InitGoogleTest()` and returns `RUN_ALL_TESTS()`.

### 3.2 Mismatched Expectations

**Problem:**
Your mock tests fail with errors about unmet expectations or unexpected calls.

**Cause:**
- Expectations set via `EXPECT_CALL()` are not matched because they were not set before the mock calls.
- Calls with unexpected arguments occur.
- Overly strict or incorrect ordering of expectations.

**Solution:**
- Set all expectations with `EXPECT_CALL()` *before* any code that calls the mocks.
- Use matchers such as `_` to allow flexible matching if exact arguments are not important.
- To enforce call order, use `InSequence` or `After` as needed.
- If you want to ignore uninteresting calls, consider wrapping mocks in `NiceMock`.

Refer to the [Mocking FAQ](docs/gmock_faq.md) and [gMock for Dummies](docs/gmock_for_dummies.md) for detailed troubleshooting.

---

## 4. Version Compatibility

Make sure that:

- You use compatible versions of GoogleTest and GoogleMock since they are bundled.
- When building from source, avoid mixing pre-built GoogleTest libraries with source-built ones.
- Use the latest stable release for best compatibility.

---

## 5. Common Pitfalls

- **Lack of Virtual Destructors:** Classes you mock must have virtual destructors to avoid undefined behavior. See [Legacy gMock FAQ - Destructor Issues](docs/gmock_faq.md#my-program-crashed-heapcheck-failure).

- **Mocking Non-Virtual Methods:** This requires more advanced techniques described in [Mocking Non-virtual Methods](docs/gmock_cook_book.md#MockingNonVirtualMethods).

- **Uninteresting Calls Warning:** If you see warnings about uninteresting calls, either suppress them with `NiceMock`, or explicitly set expectations with `.Times(AnyNumber())`.

- **MSVC Compiler Warnings:** Avoid using `const` in parameters of mocked methods as some MSVC versions generate warnings despite the C++ standard ignoring top-level `const` in parameters.

---

## 6. Validating Your Installation

1. Write a simple test program using GoogleTest and GoogleMock. For example:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

using ::testing::Return;

class MockFoo {
 public:
  MOCK_METHOD(int, GetValue, (), ());
};

TEST(SimpleTest, BasicMock) {
  MockFoo mock;
  EXPECT_CALL(mock, GetValue()).WillOnce(Return(42));
  EXPECT_EQ(mock.GetValue(), 42);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

2. Compile and link with `gmock` and `gtest` libraries.
3. Run the test binary. It should pass without errors.

---

## 7. Where to Get Help

- Review the [GoogleTest Primer](docs/primer.md) for basics.
- Consult the [Mocking Reference](docs/reference/mocking.md) for API details.
- Explore the [gMock Cookbook](docs/gmock_cook_book.md) for advanced approaches.
- Check the [Mocking FAQ](docs/gmock_faq.md) for answers to common questions.
- Join the [GoogleTest issue tracker and community forums](https://github.com/google/googletest/issues) for support.

---

## 8. Additional Tips

- Use `--gmock_verbose=info` flag when running tests to get detailed mock call traces, which help diagnose expectation failures.
- Remember to write your `EXPECT_CALL`s before exercising mocks, as setting them afterwards has undefined behavior.
- For complex setups, use `ON_CALL()` to specify default behavior without setting expectations.

<Callout title='Pro Tip'>Avoid over-specifying expectations: focusing only on the calls that matter leads to resilient, maintainable tests.</Callout>

---

**By following these troubleshooting steps, you should be able to swiftly resolve common issues and ensure a smooth experience with GoogleTest and GoogleMock.**
