---
title: "Writing Your First Test"
description: "Walk through creating a minimal test file, writing basic assertions, and introducing simple mock objects. This hands-on approach ensures new users get immediate feedback and foundational skills."
---

# Writing Your First Test

Welcome to your first hands-on experience with GoogleTest and GoogleMock! This guide walks you through creating a minimal test file, writing your first assertions, and introducing simple mock objects to help you understand the basics of testing and mocking in C++ with GoogleTest.

---

## 1. Setting Up Your First Test File

Before jumping into mocking, let's start by writing and running a straightforward test to familiarize yourself with the framework.

### Step 1: Include GoogleTest Header

At the top of your C++ test file, include the main GoogleTest header:

```cpp
#include <gtest/gtest.h>
```

### Step 2: Writing a Simple Test

Use the `TEST()` macro to define a test. The macro takes two arguments: the test suite name and the test name. Keep names descriptive yet concise.

```cpp
TEST(SampleTestSuite, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);  // Expects 1+1 to equal 2
  EXPECT_NE(0, 1);      // Expects 0 to not equal 1
}
```

### Step 3: Implementing `main()`

Usually, you can link with the `gtest_main` library, which provides a main function. If you need to define your own (for example, to do custom setup), use the following pattern:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Step 4: Compile and Run

Compile your test program linking against GoogleTest and GoogleMock. When you run it, all tests will execute, reporting success or failure per test case.

<Tip>
If your build system integrates CMake or Bazel, consult the relevant installation guides for setting up your environment and linking correctly.
</Tip>

---

## 2. Writing Basic Assertions

Assertions are the core of any test, validating the behavior of your code.

### Common Assertion Macros:

- `EXPECT_EQ(val1, val2)`: Verifies that `val1 == val2`.
- `EXPECT_NE(val1, val2)`: Verifies that `val1 != val2`.
- `EXPECT_TRUE(condition)`: Checks if condition is `true`.
- `EXPECT_FALSE(condition)`: Checks if condition is `false`.
- `ASSERT_*` variants: Like `EXPECT_*` but abort the current test on failure.

Example:

```cpp
TEST(ArithmeticTest, SimpleEqualities) {
  EXPECT_EQ(3 * 3, 9);
  EXPECT_TRUE(5 > 4);
  ASSERT_FALSE(4 > 5) << "4 is not greater than 5, so this should pass.";
}
```

<Tip>
Use `EXPECT_` when you want tests to continue even if an assertion fails, and `ASSERT_` when further execution depends on a test condition.
</Tip>

---

## 3. Introducing Mock Objects

gMock enables you to create mock classes for interfaces or classes with virtual methods, letting you observe and control interactions.

### Step 1: Define a Mock Class

Suppose you have the following interface:

```cpp
class Turtle {
 public:
  virtual ~Turtle() = default;
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
  virtual int GetX() const = 0;
};
```

Define a mock for this interface:

```cpp
#include <gmock/gmock.h>

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

### Step 2: Using Your Mock Object in a Test

```cpp
TEST(TurtleTest, MovesForward) {
  MockTurtle mock_turtle;

  // Expect PenDown() to be called at least once.
  EXPECT_CALL(mock_turtle, PenDown()).Times(testing::AtLeast(1));

  // Expect Forward() to be called with argument 100 once.
  EXPECT_CALL(mock_turtle, Forward(100)).Times(1);

  // Test code using mock_turtle...
  mock_turtle.PenDown();
  mock_turtle.Forward(100);

  // Optional: Verify that GetX() returns 42 by default
  ON_CALL(mock_turtle, GetX()).WillByDefault(testing::Return(42));
  EXPECT_EQ(mock_turtle.GetX(), 42);
}
```

<Tip>
Remember, `EXPECT_CALL` must be set before calling the mock methods under test. This way, gMock can verify calls in real-time.
</Tip>

---

## 4. Understanding the Output

When you run your tests, GoogleTest will provide a summary of successes and failures.

- Successful tests display `[       OK ]`.
- Failures or unexpected mock method calls will be clearly indicated with descriptive messages including file and line number.

If a mock method is called with unexpected arguments or too many times, gMock will fail the test immediately, showing the mismatch.

<Tip>
Use the flag `--gmock_verbose=info` to get detailed trace of mock calls if you want to debug complicated expectations.
</Tip>

---

## 5. Practical Tips and Best Practices

- **Set Expectations Early:** Call `EXPECT_CALL` before exercising the mocks.
- **Use Matchers:** If you donâ€™t care about certain arguments, use `_` to match any value.
- **Keep Tests Focused:** Write each test to verify one piece of behavior for clarity.
- **Control Mock Behavior:** Use `ON_CALL` to specify default mock method behavior without asserting that the method must be called.
- **Avoid Over-Specification:** Do not verify every call if unnecessary; tests should check *intent*, not internal implementation details.

---

## 6. Troubleshooting Common Issues

### Test Doesn't Run or Finds No Tests
- Verify that your test files are properly included in your build.
- Confirm you called `testing::InitGoogleTest` in your `main()`.

### Mock Methods Not Called as Expected
- Ensure your `EXPECT_CALL` statements run **before** the code exercising the mocks.
- Check argument matchers are correct and not overly restrictive.

### Unexpected Mock Call Errors
- Add catch-all expectations like `EXPECT_CALL(mock, Method(_)).Times(testing::AnyNumber());` if appropriate.
- Use `NiceMock<T>` to suppress warnings about uninteresting calls.

<Tip>
Visit the [Common Setup Issues](../setup-troubleshooting/common-setup-issues) page for more on build and runtime troubleshooting.
</Tip>

---

## 7. Next Steps

After you've mastered writing and running your first test:

- Explore writing more complex tests with fixtures using `TEST_F()`.
- Learn advanced mock behaviors, matchers, and actions with the [gMock Cookbook](../gmock_cook_book.md).
- Understand how to write expectations with cardinalities, sequences, and actions in the [Mocking Reference](../reference/mocking.md).
- Try integrating GoogleTest with your build system by following the installation guides for CMake or Bazel.

Check out the next documentation page [Running and Understanding Test Output](/getting-started/first-test-experience/running-and-understanding-tests) to learn how to interpret detailed test reports.

---

## References & Resources

- [gMock Cookbook](../gmock_cook_book.md): Recipes for advanced mocking patterns
- [GoogleTest Primer](../docs/primer.md): Detailed introduction and concepts
- [gMock Cheat Sheet](../docs/gmock_cheat_sheet.md): Quick mock syntax reference
- [Mocking Reference](../reference/mocking.md): API details for mocks
- [Integration & Ecosystem](../../overview/feature-highlights-integration/integration-ecosystem.mdx): How to plug GoogleTest into your development environment

---

Congratulations on taking this crucial first step towards effective automated testing with GoogleTest and GoogleMock! Your journey to robust, maintainable, and expressive C++ tests begins here.