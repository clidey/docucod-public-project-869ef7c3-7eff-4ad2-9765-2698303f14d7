---
title: "Writing Your First Test"
description: "Walk users through creating a minimal test source file, including the test macro, a dummy function, and assertions. Explain test file structure and best practices for naming and organization."
---

# Writing Your First Test

Welcome to the first step in becoming proficient with GoogleTest! This guide walks you through creating a minimal test source file to verify your code behaves as expected. Along the way, you'll learn about the test macro, structuring a test, and writing assertions — the building blocks for robust C++ testing.

---

## 1. Setting up a Minimal Test Source File

A test source file typically:

- Includes the necessary GoogleTest header
- Defines one or more tests using the `TEST()` macro
- Contains assertions that verify your code’s correctness

Here is a minimal, complete example:

```cpp
#include <gtest/gtest.h>  // GoogleTest header

// A simple function to test
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Defines a test named HandlesZeroInput in the test suite FactorialTest
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);  // Assertion: Factorial(0) should return 1
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);  // Initializes GoogleTest
  return RUN_ALL_TESTS();                 // Runs all defined tests
}
```

### What Happens Here?

- `TEST(FactorialTest, HandlesZeroInput)`: Defines a test function under the suite `FactorialTest`. GoogleTest will automatically find and run it.
- `EXPECT_EQ`: An assertion that checks if two values are equal (nonfatal failure if it isn't).
- The `main()` function initializes GoogleTest and triggers all tests.

---

## 2. Understanding the Test Macro Structure

### Naming Conventions

- The first parameter to `TEST()` is the **test suite name** — group related tests logically.
- The second parameter is the **individual test name** within that suite.
- Names should be valid C++ identifiers and avoid underscores for consistency.

Example:

```cpp
TEST(MathFunctions, PositiveInput) {
  EXPECT_GT(Factorial(3), 0);  // Check if factorial of 3 is greater than 0
}
```

### Test Flow

Each `TEST()` defines a function with no return value. Inside it, you write any code needed along with GoogleTest assertions. Test success depends on assertions passing without fatal failures or crashes.

---

## 3. Writing Assertions

Assertions are checks that verify expected conditions in your code. GoogleTest provides two primary groups:

- `EXPECT_*`: Reports failure but continues the test.
- `ASSERT_*`: Reports failure and aborts the current function immediately.

### Example Assertions

```cpp
ASSERT_EQ(Factorial(1), 1);                  // Fatal check if factorial(1) equals 1
EXPECT_NE(Factorial(2), 0);                   // Nonfatal: factorial(2) is not zero
EXPECT_LT(Factorial(3), 100);                 // factorial(3) less than 100
EXPECT_TRUE(Factorial(0) == 1) << "Factorial of 0 must be 1";  // Custom message
```

Use `EXPECT_*` unless continuing beyond failure does not make sense.

---

## 4. File Organization and Best Practices

- Place related tests in the same test suite (first parameter).
- Keep test names descriptive about the aspect they are verifying.
- Write each test to check a single behavior or condition.
- Avoid underscores in test suite and test names to maintain consistent style.
- Keep your `main()` function simple by delegating to `RUN_ALL_TESTS()`.

Example test file layout:

```cpp
// Includes
#include <gtest/gtest.h>
#include "your_code_header.h"

// Function or class under test implementations (or include separate files)

// Test suite 1
TEST(MathTests, FactorialOfZero) { ... }
TEST(MathTests, FactorialOfPositive) { ... }

// Test suite 2
TEST(StringTests, EmptyString) { ... }

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## 5. Running Your Test

Compile your test program linking with GoogleTest (and GoogleMock if needed).

```bash
# Example using g++
g++ -std=c++17 your_test.cc -lgtest -lpthread -o your_test
./your_test
```

You should see output showing your tests run, similar to:

```text
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[----------] 1 test from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

Congratulations, you’ve written and run your first GoogleTest!

---

## Troubleshooting Common Issues

- **Linker errors:** Ensure you link against `-lgtest` and `-lpthread` (Linux) or the appropriate GoogleTest libraries on your platform.
- **Missing `main()`:** If you link only with `gtest` but not `gtest_main`, you need to provide your own `main` function as shown above.
- **Assertions not running:** Confirm tests are defined with `TEST()` macro and that you call `RUN_ALL_TESTS()` in `main()`.
- **Unexpected failures:** Check that `EXPECT_CALL()` or `ON_CALL()` setups for mocks are done before exercising code.

---

## Next Steps

* Explore the [GoogleTest Primer](primer.md) to deepen your knowledge of writing more tests.
* Learn about [Test Fixtures](primer.md#same-data-multiple-tests) for sharing data between tests.
* Investigate [Assertions Reference](reference/assertions.md) for a comprehensive list of assertions.
* Progress to the [GoogleMock Guides](guides/mocking-techniques/creating-mocks) to start writing mocks.

<Tip>
Make sure to always keep your test suites focused, clear, and maintainable by writing tests that verify one behavior each and use descriptive names.
</Tip>

<Note>
Remember: GoogleTest automatically finds all tests defined using `TEST()` macros in your binary and runs them. No explicit registration is needed.
</Note>