---
title: "Sample Tests and Common Workflows"
description: "Highlights available sample test files, with example patterns for assertions, mocks, and expectations. Gives users working patterns they can copy and adapt, boosting productivity from the first session."
---

# Sample Tests and Common Workflows

This page introduces you to a variety of sample test files and practical coding patterns for writing assertions, setting up mocks, and defining expectations with GoogleTest and GoogleMock. These examples serve as proven templates that you can copy, adapt, and extend to accelerate your testing productivity from the very first session.

---

## 1. Using Sample Test Files

GoogleTest comes bundled with numerous well-commented sample tests. Browsing these samples is one of the fastest ways to learn effective testing techniques and coding styles.

- The [googletest samples directory](https://github.com/google/googletest/tree/main/googletest/samples) hosts tests targeting different features and levels of complexity.
- Try running some samples by compiling and executing their test programs.
- Modify them in small ways and run again to see the effects.

By studying these samples, you will:

- Understand key GoogleTest _patterns_ and API usages.
- Learn how to write assertions, use test fixtures, and employ mocks.
- Discover best practices for organizing and maintaining tests.

## 2. Common Assertion Patterns

Assertions are the backbone of verifying your code’s behavior.

### Basic Equality and Relational Assertions

Use `EXPECT_EQ`/`ASSERT_EQ` to compare values. Prefer `EXPECT_` over `ASSERT_` when continued test execution is valuable.

Example: verifying a factorial function:

```cpp
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

### String and Container Assertions

Use string-specific assertions to get detailed error output, such as `EXPECT_STREQ` for C strings or `EXPECT_THAT` with matchers for containers.

For example, verifying expected contents of a vector:

```cpp
using ::testing::ElementsAre;

EXPECT_THAT(my_vector, ElementsAre(1, 2, 3));
```

### Custom Failure Messages

Provide context for failing assertions by streaming messages:

```cpp
ASSERT_EQ(x.size(), y.size()) << "Vectors differ in length.";
```

This helps in quickly diagnosing the cause of failure when tests break.

## 3. Patterns for Mocking and Expectations

GoogleMock enables interaction-based testing by allowing you to specify expected method calls on mock objects.

### Defining Mock Classes

Use the `MOCK_METHOD` macro inside a mock class to declare mocked methods. For example:

```cpp
class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
};
```

Mock methods must be public regardless of the base class access specifier.

### Setting Expectations with `EXPECT_CALL`

Set clear expectations on mock methods before exercising code. For example:

```cpp
MockTurtle turtle;
EXPECT_CALL(turtle, PenDown()).Times(AtLeast(1));
```

This expects the `PenDown()` method to be called at least once.

### Using Matchers in Expectations

Matchers allow flexible argument verification. For example:

```cpp
EXPECT_CALL(turtle, GoTo(50, _));
```

The underscore `_` means "accept any value" for that argument.

### Controlling Call Counts with Cardinalities

Use `Times()`, `AtLeast()`, `AtMost()`, or `Exactly()` to specify how many times a method should be called.

```cpp
EXPECT_CALL(mock, Foo()).Times(2);  // Called exactly twice
EXPECT_CALL(mock, Foo()).Times(AnyNumber());  // Called any number of times
```

### Specifying Call Order

Use `InSequence` to enforce calls happen in order:

```cpp
{
  InSequence seq;
  EXPECT_CALL(mock, Step1());
  EXPECT_CALL(mock, Step2());
}
```

Calls must occur in that sequence, or the test will fail.

### Handling Multiple Expectations and Sticky Behavior

By default, expectations remain active until their call count is met and they can cause errors if violated. Use `.RetiresOnSaturation()` on expectations that should become inactive after use:

```cpp
EXPECT_CALL(mock, Foo(7)).Times(2).RetiresOnSaturation();
```

### Default Actions with `ON_CALL`

Set default behaviors without imposing call count expectations using `ON_CALL`:

```cpp
ON_CALL(mock, Foo(_)).WillByDefault(Return(true));
```

This supports mocks used in many tests where only selective expectations are asserted.

## 4. Sample Test Workflows

### Writing Simple Tests

Use the `TEST()` macro with a test suite and test name:

```cpp
TEST(MathTest, SumPositive) {
  EXPECT_EQ(Add(1, 2), 3);
}
```

### Using Test Fixtures

When multiple tests share setup and teardown, define a fixture:

```cpp
class QueueTest : public ::testing::Test {
 protected:
  Queue<int> queue_;

  void SetUp() override {
    queue_.Enqueue(1);
  }
};

TEST_F(QueueTest, IsNotEmpty) {
  EXPECT_GT(queue_.size(), 0);
}
```

`TEST_F()` tells GoogleTest to use the fixture.

### Mocking Collaborators

Create mock objects and set expectations to guide behavior and verify interactions:

```cpp
MockTurtle turtle;
EXPECT_CALL(turtle, PenDown()).Times(1);
Painter painter(&turtle);
painter.DrawCircle(0, 0, 10);
```

If `PenDown()` is not called as expected, the test will fail.

## 5. Adapting and Copying Patterns

You can copy these patterns directly into your tests and adapt names, arguments, and conditions relevant to your project. Use them as building blocks to handle complex testing scenarios like parameterized tests, typed tests, and death tests.

## 6. Tips & Best Practices

- **Name your test suites and tests clearly:** Use camel case and avoid underscores to prevent naming conflicts.
- **Use `EXPECT_` when continuing testing after failure is beneficial; use `ASSERT_` when failure should abort the test immediately.**
- **Group related tests in test suites or fixtures for maintainability.**
- **Set only necessary expectations:** Overly strict mocks cause brittle tests.
- **Use default actions with `ON_CALL` for uninteresting methods to reduce warnings and noise.**
- **Use sequences and cardinalities to enforce call order and count only when crucial.**

## 7. Troubleshooting Common Issues

- **Expectations not met:** Confirm your code calls mocked methods as expected, arguments match, and calls occur the required number of times.
- **Unexpected calls:** If methods are called with arguments you didn’t expect, check matcher usage; add catch-all expectations if necessary.
- **Compilation errors:** Check for correct macro usage, especially with `MOCK_METHOD` argument parentheses when commas are involved.
- **Test fixture construction errors:** Ensure your test fixture class has a default constructor.

## 8. Where to Go Next

Now that you have seen practical example patterns for tests and mocks:

- Visit [Writing and Running Your First Test](../configuration-first-run/write-first-test.md) to learn how to write actual test code step-by-step.
- Explore the [gMock for Dummies](../../gmock_for_dummies.md) guide to deepen your understanding of mock class creation and usage.
- Use the [Matchers Reference](../../reference/matchers.md) and [Mocking Reference](../../reference/mocking.md) to master argument expectations.
- Look into the [Sample Tests](../samples.md) for more detailed examples.

---

**Pro Tip:** Incrementally build your tests starting from simple assertions and gradually add mocks and complex expectations. This approach reduces bugs and simplifies debugging.

---