---
title: "Quick Start: Using GoogleMock"
description: "Introduces mocking with a minimal example, guiding users to create and use a mock with GoogleMock. Highlights how to extend from basic GoogleTest usage into more powerful test scenarios without complexity overload."
---

# Quick Start: Using GoogleMock

Welcome to GoogleMock, the powerful mocking framework bundled within GoogleTest. This guide will introduce you to creating and using mocks with a minimal example. If you have successfully run a basic GoogleTest test, this is your natural next step to author more expressive, reliable, and maintainable tests by simulating your dependencies.

---

## 1. What Is GoogleMock?

GoogleMock lets you define mock classes that imitate real classes or interfaces for C++ programs. Rather than testing the complete environment or relying on real objects, GoogleMock allows you to verify that components interact correctly by specifying:

- What methods you expect to be called
- How many times they'll be called
- What arguments they should receive
- What values or behaviors they produce

This creates fast, reliable, and intent-revealing tests by controlling and observing interactions precisely.

## 2. Prerequisites

Before using GoogleMock:

- You should have GoogleTest installed and integrated into your build.
- Your compiler must support C++11 or later.
- Your class's methods to be mocked must be declared `virtual`.

If you need installation guidance, see [Installing GoogleTest and GoogleMock with CMake](getting-started/prerequisites-installation/installation-cmake.md) or [Installing with Bazel](getting-started/prerequisites-installation/installation-bazel.md).

## 3. Writing Your First Mock Class

A mock class derives from the interface or base class you want to mock, replacing virtual functions with mock methods using the `MOCK_METHOD` macro.

### Example: Mocking a Simple Interface

Suppose you have an interface `Turtle`:

```cpp
class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
  virtual void Turn(int degrees) = 0;
  virtual void GoTo(int x, int y) = 0;
  virtual int GetX() const = 0;
  virtual int GetY() const = 0;
};
```

Define a mock class `MockTurtle` extending `Turtle`:

```cpp
#include <gmock/gmock.h>  // For MOCK_METHOD

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(void, Turn, (int degrees), (override));
  MOCK_METHOD(void, GoTo, (int x, int y), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
  MOCK_METHOD(int, GetY, (), (const, override));
};
```

**Tips:**
- Put all `MOCK_METHOD` declarations in the `public:` section.
- Use parentheses around return types or argument types that contain commas, or use type aliases to avoid parsing errors.

## 4. Creating and Using Mocks in Tests

Here is an end-to-end example illustrating how to use your mock:

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

// Assume MockTurtle from previous section.

using ::testing::AtLeast;

class Painter {
 public:
  explicit Painter(Turtle* t) : turtle_(t) {}
  bool DrawCircle(int x, int y, int radius) {
    turtle_->GoTo(x, y + radius);
    turtle_->PenDown();
    for (int i = 0; i < 360; ++i) {
      turtle_->Forward(1);
      turtle_->Turn(1);
    }
    turtle_->PenUp();
    return true;
  }

 private:
  Turtle* turtle_;
};

TEST(PainterTest, DrawsCircle) {
  MockTurtle mock_turtle;

  // 1. Set expectations before exercising the code under test.
  EXPECT_CALL(mock_turtle, GoTo(0, 1));
  EXPECT_CALL(mock_turtle, PenDown()).Times(AtLeast(1));
  EXPECT_CALL(mock_turtle, Forward(1)).Times(360);
  EXPECT_CALL(mock_turtle, Turn(1)).Times(360);
  EXPECT_CALL(mock_turtle, PenUp()).Times(AtLeast(1));

  // 2. Create code under test, passing in mock.
  Painter painter(&mock_turtle);

  // 3. Run the test subject.
  EXPECT_TRUE(painter.DrawCircle(0, 0, 1));
}
```

**Important:**
- Always set your expectations *before* running the code that calls the mocks.
- The test will fail immediately if an unexpected call happens or if expected calls are missing by test end.

## 5. Setting Default Behavior with ON_CALL

You can specify default mock method behaviors for calls that have no explicit expectations with `ON_CALL()`. This is useful for stubbing responses without enforcing expectations.

```cpp
ON_CALL(mock_turtle, GetX())
    .WillByDefault(testing::Return(0));
```

This means that unless you explicitly set an expectation for `GetX()`, calling it will return zero.

## 6. Best Practices

- Use `ON_CALL()` to provide general default method responses.
- Use `EXPECT_CALL()` when you want to verify a method call with specific arguments or number of times.
- Use the matcher `_` to indicate "any argument" if you don't care about a particular parameter.
- To ignore uninteresting methods and suppress warnings, wrap your mock in `NiceMock<>`.
- Make your mocks `StrictMock<>` if you want failures on unexpected calls.

Example:

```cpp
using ::testing::NiceMock;
NiceMock<MockTurtle> mock_turtle;
EXPECT_CALL(mock_turtle, PenDown());
// No warning for other uninteresting calls.
```

## 7. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Tips">
<Accordion title="Mock Methods Not Called or Unexpected Calls">
- Ensure you set `EXPECT_CALL` before exercising the mock.
- Check if argument matchers correctly match the calls.
- Use `--gmock_verbose=info` to trace mock calls.
</Accordion>
<Accordion title="Compilation Errors with MOCK_METHOD">
- Wrap argument types with commas in extra parentheses or use type aliases.
- Add `(override)` or `(const, override)` qualifiers as required.
</Accordion>
<Accordion title="Uninteresting Call Warnings">
- Use `NiceMock` to suppress them.
- Add catch-all `EXPECT_CALL(mock, Method(_)).Times(AnyNumber());` to explicitly allow.
</Accordion>
<Accordion title="Default Action Not Triggering">
- Use `ON_CALL` to specify default behavior.
- Return values for non-void functions must be defined to avoid crashes.
</Accordion>
</AccordionGroup>

## 8. Next Steps

After mastering this quick start:

- Explore ways to write flexible expectations using various matchers and argument predicates in [Writing Flexible Expectations and Matchers](/guides/mocking_and_advanced_patterns/writing_flexible_expectations.md).
- Learn advanced behaviors and actions for mocks in [Advanced Mock Behaviors and Actions](/guides/mocking_and_advanced_patterns/advanced_mock_behaviors.md).
- Check out the complete [Mocking Reference](docs/reference/mocking.md) for full API details.
- Read more about integrating mocks into your continuous integration and build environment.

---

## Summary
In this guide, you created your first mock class, set expectations on its usage, and integrated it into a test scenario. GoogleMock helps you focus on verifying interactions efficiently without the complexity and fragility of real dependencies.

----

# Additional Resources
- [GoogleTest Primer](getting-started/configuration-first-run/write-first-test.md)
- [GoogleMock for Dummies](docs/gmock_for_dummies.md)
- [Mocking Cookbook](docs/gmock_cook_book.md)
- [Mocking Cheat Sheet](docs/gmock_cheat_sheet.md)

---

# Quick Reference Commands

| Macro/Function        | Purpose                         |
|----------------------|--------------------------------|
| `MOCK_METHOD`         | Define mock method in mock class |
| `EXPECT_CALL`         | Set expectation on mock calls  |
| `ON_CALL`             | Set default action on mock method|
| `NiceMock<T>`         | Suppress warnings on uninteresting calls |
| `StrictMock<T>`       | Fail on uninteresting calls    |