---
title: "Basic Configuration"
description: "Set up your project for testing: including GoogleTest headers, linking libraries, and integrating with your build system. This page focuses on typical CMake and Bazel usage, with guidance for source inclusion, target setup, and linking practices."
---

# Basic Configuration

This page guides you through setting up your C++ project to use GoogleTest. It focuses on integrating the GoogleTest headers, linking the GoogleTest libraries, and configuring your build system with common tools like CMake and Bazel. By following these steps, youâ€™ll be ready to write and run your first tests efficiently.

---

## 1. Include GoogleTest Headers

To write tests using GoogleTest, your source files must include the primary header:

```cpp
#include <gtest/gtest.h>
```

This header provides all core macros, assertions, and test fixtures.

<Check>
Always use angle brackets `<gtest/gtest.h>` to include GoogleTest headers, ensuring proper system include paths.
</Check>


## 2. Link GoogleTest Libraries

Your test binaries need to link against GoogleTest libraries to access its implementation. The recommended libraries are:

- **gtest** - The core GoogleTest library.
- **gtest_main** - An optional library that provides a main() function which handles test initialization and execution.

If you link with `gtest_main`, you typically do *not* need to provide your own `main()`.

<Note>
Linking against the `gtest_main` target is simpler for most projects. Use `gtest` alone if you want to write a custom main.
</Note>


## 3. Configuring with CMake

CMake is the most common build system GoogleTest supports. It provides multiple ways to integrate GoogleTest source and binaries into your project.

### Option A: Using Installed GoogleTest

If you have installed GoogleTest on your system (e.g., via `sudo make install`), you can find and link it with `find_package`.

```cmake
find_package(GTest REQUIRED)

add_executable(my_tests test1.cpp test2.cpp)
# Link with GoogleTest libraries
target_link_libraries(my_tests GTest::gtest_main)
```

This method automatically sets the include directories and libraries.

### Option B: Adding GoogleTest Source as a Subdirectory

Download the GoogleTest source and add it as a subdirectory in your project:

```cmake
add_subdirectory(googletest)

add_executable(my_tests test1.cpp test2.cpp)
target_link_libraries(my_tests gtest_main)
```

This approach builds GoogleTest with your project, sharing compiler settings and avoiding compatibility issues.

### Option C: FetchContent to Download at Configure Time

CMake 3.14+ supports `FetchContent` for downloading GoogleTest during configuration:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.12.1.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test1.cpp test2.cpp)
target_link_libraries(my_tests gtest_main)
```

This is a robust and flexible approach, especially in CI environments.

<Warning>
Ensure your CMake version is 3.14 or higher to use `FetchContent_MakeAvailable()`.
</Warning>


## 4. CMake Configuration Tips

- **C++17 Required:** GoogleTest requires C++17 or newer. Make sure your project configures the standard accordingly:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- **Runtime Library Compatibility:** On Windows, you may need to reconcile runtime library settings between your project and GoogleTest, especially when using dynamic vs static CRT. You can control that via the `gtest_force_shared_crt` variable.

- **Shared Libraries:** By default, GoogleTest libraries are static. To build as shared libraries, set `BUILD_SHARED_LIBS=ON`.


## 5. Configuring with Bazel

If your project uses Bazel, you can include GoogleTest via Bazel's native support. The rules for configuring may look like:

```bazel
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

Consult the Bazel documentation for version details and repository setup.


## 6. Writing Your Own main() Function

If you choose not to link with `gtest_main`, you need to provide a main function that initializes GoogleTest before running tests.

Example main function:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

`InitGoogleTest` will parse command-line flags to control test behavior.


## 7. Verifying Your Setup

After configuring build and linking GoogleTest, ensure everything is properly set up by writing a very simple test:

```cpp
#include <gtest/gtest.h>

TEST(SanityCheck, BasicAssertions) {
  EXPECT_EQ(1, 1);
}
```

Build and run your test target; success is indicated by GoogleTest's output showing all tests passing.


## 8. Common Pitfalls & Troubleshooting

<AccordionGroup title="Common Configuration Issues">
<Accordion title="Header Not Found Errors">
- Ensure the GoogleTest include directory is in your compiler's include path.
- Check your `find_package` or include directory settings.
</Accordion>

<Accordion title="Linker Errors (Undefined Symbols)">
- Confirm you linked against `gtest` or `gtest_main`.
- Double-check your target link libraries in CMake or build scripts.
</Accordion>

<Accordion title="Runtime Errors or Tests Not Running">
- Make sure your main function calls `InitGoogleTest` and `RUN_ALL_TESTS()`.
- If using `gtest_main`, do not define your own main.
- Review any custom linker flags or runtime dependencies.
</Accordion>
</AccordionGroup>


## 9. Next Steps

- Once configured, move to writing your first real tests: [Writing & Running Your First Test](../configuration-first-run/first-test).
- Explore advanced flags and runtime options: [Advanced GoogleTest Topics](../../docs/advanced.md).
- Consider integrating GoogleMock for mock-based testing.


---

<Note>
For detailed integration with CMake, including build options and shared library support, see the CMake build instructions in the official repository.
</Note>

<Source url="https://github.com/google/googletest" paths={[{"path": "googletest/README.md", "range": "10-164"}, {"path": "googlemock/CMakeLists.txt", "range": "1-160"}]} />