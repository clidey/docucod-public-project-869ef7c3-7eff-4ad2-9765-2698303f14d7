---
title: "Writing and Running Your First Test"
description: "Leads the user through creating their first simple test, building it, and running it—covering both unit tests (GoogleTest) and a mock-enabled test (GoogleMock). Delivers immediate validation that everything is working."
---

# Writing and Running Your First Test

Welcome to your first hands-on with GoogleTest and GoogleMock. This guide walks you through creating a simple test, building it, and running it successfully, providing immediate validation that everything is set up correctly. You will write a test manually using GoogleTest and a mock-enabled test using GoogleMock to understand both core workflows.

---

## 1. Prerequisites Before Writing Tests

Before writing your first test:

- Ensure your project is configured to find GoogleTest and GoogleMock headers and libraries.
- Confirm you have either linked against the `gtest_main` or `gmock_main` target (which provide a main entry point), or that you plan to provide your own `main()`.
- Your build setup should support C++17 and be compatible with GoogleTest’s requirements.

If you need help with configuration, see the [Configuring Your Project](https://example.com/getting-started/configuration-first-run/configure-project) guide.

---

## 2. Writing a Simple GoogleTest Test

Create a new C++ source file, for example, `simple_test.cpp`. Then follow these steps:

### Step 1: Include GoogleTest Header

```cpp
#include <gtest/gtest.h>
```

### Step 2: Write the Tested Code (Example Function)

For demonstration, we'll test a simple factorial function:

```cpp
int Factorial(int n) {
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}
```

### Step 3: Define Tests Using `TEST` Macro

Use the `TEST(TestSuiteName, TestName)` macro. For example:

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
}
```

### Step 4: Build Your Test

If you linked your test executable with `gtest_main` or `gmock_main`, the main entry point is provided, so no need to write it yourself.

If you need to provide `main()`, use:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Step 5: Run the Test

Execute your test binary. Expect output like:

```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

Success means your test passed and your environment is correctly configured!

---

## 3. Writing a GoogleMock-Enabled Test

GoogleMock extends GoogleTest by allowing you to create mock classes and set expectations on their methods.

### Step 1: Include GoogleMock Header

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>
```

### Step 2: Define an Interface to Mock

For example, imagine a simple `Database` interface:

```cpp
class Database {
 public:
  virtual ~Database() = default;
  virtual bool Connect(const std::string& url) = 0;
  virtual int GetRecordCount() const = 0;
};
```

### Step 3: Define a Mock Class

Use the `MOCK_METHOD` macro inside your mock class:

```cpp
class MockDatabase : public Database {
 public:
  MOCK_METHOD(bool, Connect, (const std::string& url), (override));
  MOCK_METHOD(int, GetRecordCount, (), (const, override));
};
```

### Step 4: Write a Test Using the Mock

Set expectations using `EXPECT_CALL` and test interactions:

```cpp
TEST(DatabaseTest, ConnectAndCount) {
  MockDatabase mock_db;

  // Expect Connect() to be called once with "db://localhost" and return true
  EXPECT_CALL(mock_db, Connect("db://localhost")).WillOnce(::testing::Return(true));

  // Expect GetRecordCount() to be called once and return 42
  EXPECT_CALL(mock_db, GetRecordCount()).WillOnce(::testing::Return(42));

  // Exercise the mock
  EXPECT_TRUE(mock_db.Connect("db://localhost"));
  EXPECT_EQ(mock_db.GetRecordCount(), 42);
}
```

### Step 5: Build and Run Your Mock Test

Link with `gmock_main` or provide your own `main` as described previously, then run the executable.

Output on success will confirm your mock expectations are met.

---

## 4. Understanding Test Outputs

GoogleTest and GoogleMock provide detailed console output.

- `[ RUN      ]` shows each test starting.
- `[       OK ]` shows a test passed.
- `[  FAILED  ]` shows a test failed, followed by an error message and stack trace.
- Mocks will report expectation violations as failures.

If all tests pass, your setup is verified and you can start expanding your test suite.

---

## 5. Troubleshooting Common Issues

<AccordionGroup title="Common Issues When Writing and Running Your First Test">
<Accordion title="Test Binary Fails to Link Due to Missing main()">
If you get link errors about `main()`, confirm you:

- Are linking against **gtest_main** or **gmock_main** for automatic main implementation.
- Or have written your own `main()` calling `InitGoogleTest()` and `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="Tests Are Not Being Discovered or Run">
Make sure:

- Your test source files are compiled and linked into the test binary.
- You are not disabling tests intentionally (e.g., test names starting with `DISABLED_`).
- You call `RUN_ALL_TESTS()` exactly once.
</Accordion>
<Accordion title="Mock Expectations Fail Unexpectedly">

- Verify that every expected call via `EXPECT_CALL` happens at least as many times as specified.
- Use `WillRepeatedly()` if a call may be invoked multiple times beyond initial expectations.
- Check for parameter mismatches in your expectations.
</Accordion>
</AccordionGroup>

<Note>
If you encounter build or runtime errors beyond these, consult the [Troubleshooting Common Issues](https://example.com/getting-started/troubleshooting-validation/common-issues) guide.
</Note>

---

## 6. Next Steps

- Explore advanced assertions and test fixtures in the [GoogleTest Primer](https://example.com/docs/primer).
- Learn mocking strategies and advanced matching in the [Mocking Basics](https://example.com/guides/core-workflows/mocking-basics) guide.
- Review the [Feature Highlights](https://example.com/overview/feature-glance/feature-highlights) to understand the full capability of GoogleTest.

Begin building comprehensive test suites to improve your C++ project’s reliability confidently.

---

## Appendix: Full Minimal Example

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

// Function to test.
int Factorial(int n) {
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}

// Interface to mock.
class Database {
 public:
  virtual ~Database() = default;
  virtual bool Connect(const std::string& url) = 0;
  virtual int GetRecordCount() const = 0;
};

class MockDatabase : public Database {
 public:
  MOCK_METHOD(bool, Connect, (const std::string& url), (override));
  MOCK_METHOD(int, GetRecordCount, (), (const, override));
};

// Simple GoogleTest.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
}

// GoogleMock-enabled test.
TEST(DatabaseTest, ConnectAndCount) {
  MockDatabase mock_db;

  EXPECT_CALL(mock_db, Connect("db://localhost")).WillOnce(::testing::Return(true));
  EXPECT_CALL(mock_db, GetRecordCount()).WillOnce(::testing::Return(42));

  EXPECT_TRUE(mock_db.Connect("db://localhost"));
  EXPECT_EQ(mock_db.GetRecordCount(), 42);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## References

- [GoogleTest Primer](https://example.com/docs/primer) for detailed test writing
- [Configuration Guide](https://example.com/getting-started/configuration-first-run/configure-project)
- [Mocking Basics Guide](https://example.com/guides/core-workflows/mocking-basics)
- [Feature Highlights](https://example.com/overview/feature-glance/feature-highlights)
- [Troubleshooting Guide](https://example.com/getting-started/troubleshooting-validation/common-issues)

---

Embrace TDD with GoogleTest and GoogleMock by expanding your test suites from here. Your first tests are your gateway to robust, maintainable C++ code.
