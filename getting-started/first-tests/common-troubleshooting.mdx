---
title: "Troubleshooting & Common Setup Issues"
description: "Solutions for typical installation, configuration, or compilation problems new users may face. Includes tips for diagnosing build errors, resolving missing dependencies, and validating that GoogleTest/GoogleMock is detected in your project."
---

# Troubleshooting & Common Setup Issues

This guide addresses frequent problems users encounter when installing, configuring, or compiling GoogleTest for the first time. It provides concrete steps to diagnose build errors, resolve missing dependencies, and verify that GoogleTest and GoogleMock are properly detected in your project.

---

## 1. Diagnosing Build Errors

Build errors frequently arise from missing dependencies, incorrect include paths, or incompatible compiler settings. Follow these steps to identify and fix common issues:

### Step 1: Verify Include Directives

- Ensure your test source files include the GoogleTest header explicitly:

  ```cpp
  #include <gtest/gtest.h>
  ```

- If you use GoogleMock, also include:

  ```cpp
  #include <gmock/gmock.h>
  ```

Incorrect or missing includes prevent the compiler from finding essential macros and classes.

### Step 2: Check Your Build System Configuration

- Confirm that the GoogleTest source or compiled libraries are correctly linked in your project.
- If using CMake, confirm you have:

  ```cmake
  find_package(GTest REQUIRED)
  target_link_libraries(your_test_target GTest::gtest GTest::gtest_main)
  ```

- For Bazel or custom builds, ensure source or library paths for GoogleTest and GoogleMock are accessible.

### Step 3: Confirm Compiler Compatibility

- GoogleTest requires a C++17 (or newer) compatible compiler.
- The build system should enable C++17 standard flags (e.g., `-std=c++17` for GCC/Clang).

### Step 4: Inspect Error Messages for Clues

- Search error output for missing headers or undefined references to `ASSERT_`, `EXPECT_` macros.
- Reference file names and lines can pinpoint if the issue is related to GoogleTest integration.

---

## 2. Resolving Missing Dependencies

GoogleTest depends on a few components for successful compilation:

### 2.1 CMake and Build Tools

- CMake 3.14 or later is recommended for building GoogleTest.
- Ensure `make`, `ninja`, or your preferred build tool is installed and accessible.

### 2.2 Threading Support

- GoogleTest uses threading features. Verify your platform supports threading and the compiler flags are set correctly.

### 2.3 GoogleMock (if needed)

- If your tests use GoogleMock, ensure you build and link GoogleMock sources. They are included in the GoogleTest repository.

### Practical Tip

If the build system complains about missing files like `gtest/gtest.h` or `gmock/gmock.h`, check the following:

- Your `include_directories` or equivalent build settings include the root directory where GoogleTest headers reside.
- For out-of-source builds, confirm that paths to `googletest/include` and `googlemock/include` are correctly mapped.

---

## 3. Validating GoogleTest and GoogleMock Detection

Once the build succeeds, confirm that GoogleTest and GoogleMock are detected and working properly.

### Step 1: Use a Basic Test Case

Create a simple test file, for example `simple_test.cc`:

```cpp
#include <gtest/gtest.h>

TEST(SimpleTest, TrueIsTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile and run this test with the same build configuration you use normally.

### Step 2: Confirm the Test Runs and Passes

- The test framework should run your test and report `1 test from 1 test suite ran` and [`[  PASSED  ]`].
- If GoogleMock is involved, add a mock class with `MOCK_METHOD` declarations and verify that tests linking GoogleMock are detected and reported correctly.

### Step 3: Check Test Output for GoogleTest Version and Messages

- GoogleTest prints startup banners indicating the framework version, test counts, and results.
- Failure or missing output can indicate the test is not linked or the test suite is not registered properly.

---

## 4. Common Pitfalls & Solutions

| Problem                                  | Symptom/Message                                                | Solution                                                                              |
|------------------------------------------|----------------------------------------------------------------|---------------------------------------------------------------------------------------|
| Missing `gtest/gtest.h` or `gmock/gmock.h` | Compile errors: No such file or directory                      | Ensure correct include paths; add `googletest/include` and `googlemock/include`.       |
| Linking errors for GoogleTest symbols     | Unresolved external symbol errors                              | Link with `gtest` and `gtest_main` libraries properly; verify linker inputs.           |
| Tests not found or run                     | No tests reported after run                                     | Call `InitGoogleTest(&argc, argv)` before `RUN_ALL_TESTS()`; register tests properly.  |
| Mixing `TEST` and `TEST_F` in a suite     | Runtime errors about different fixtures in the same test suite | Use the same fixture class throughout a test suite; avoid mixing macros improperly.    |
| Missing instantiations for parameterized tests | Runtime failure about uninstantiated parameterized test       | Ensure `INSTANTIATE_TEST_SUITE_P` is present for all `TEST_P` test suites or allow using `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` macro.|
| Build errors with `C++17` global commands | Errors related to missing compiler support                    | Check compiler version and build flags; update compiler to support C++17.              |

---

## 5. Verifying Failures in Test Helpers

If your tests use helper functions or subroutines and encounter unexpected failures or crashes:

- Use the `SCOPED_TRACE` macro to add trace messages that help identify which call triggered a failure.
- Use `HasFatalFailure()` to check if a fatal failure occurred and act accordingly to avoid undefined behaviors.

Example:

```cpp
void Helper(int n) {
  SCOPED_TRACE(testing::Message() << "Helper called with: " << n);
  EXPECT_EQ(n, 42);
}

TEST(MyTest, UsesHelper) {
  Helper(5);  // Failure will include trace info.
  if (HasFatalFailure()) return;
  // Further test code.
}
```

---

## 6. Using `EXPECT_FATAL_FAILURE` and `EXPECT_NONFATAL_FAILURE` in Setup

To test that certain code paths in your test invoke expected fatal or non-fatal failures (such as in the GoogleTest internal tests), use the macros provided in `gtest/gtest-spi.h`:

```cpp
// Asserts that the statement generates exactly one fatal failure with a message containing 'substring'.
EXPECT_FATAL_FAILURE(statement, "substring");

// Asserts that the statement generates exactly one non-fatal failure containing 'substring'.
EXPECT_NONFATAL_FAILURE(statement, "substring");
```

Note these macros:

- Only capture failures in the current thread. For multi-threaded tests, use the `_ON_ALL_THREADS` variants.
- Cannot be used with statements returning values or referencing non-static local variables.

---

## 7. Troubleshooting Installation in CI/CD or Containers

Some common contexts cause problems when running GoogleTest builds in CI or containerized environments:

- Missing environment variables or file permissions causing failures opening output files.
- Lack of terminal detection may cause color output or test listing issues.

### Tips

- Redirect output to known writable directories.
- Disable colors (`--gtest_color=no`) if terminal detection fails.
- Generate XML reports explicitly using `--gtest_output=xml` flag and verify output location.

---

### Summary

This page guides you through diagnosing build failures, resolving dependencies, validating successful setup, and avoiding common pitfalls when getting started with GoogleTest. Using the concrete examples and macro features for failure detection will accelerate your development and testing experience.

# Additional Resources

- [GoogleTest Assertions Reference](../reference/assertions.md)
- [Getting Started Guide](../getting-started/first-tests/quickstart-example.md)
- [Advanced GoogleTest Topics](../advanced.md)
- [Testing Reference](../reference/testing.md)
- [Integration & Ecosystem](../../overview/architecture-features/integration-and-dependencies.mdx)

---

<Tip>
If you encounter failures related to parameterized tests not running, check that all `TEST_P` tests are instantiated with `INSTANTIATE_TEST_SUITE_P`. Use `GTEST_ALLOW_UNINSTANTIATED_PARAMETERIZED_TEST` to suppress errors if your test suite is intentionally uninstantiated.
</Tip>

<Warning>
Avoid mixing `TEST` and `TEST_F` (or different fixtures) in the same test suite to prevent runtime errors about fixture class mismatches.
</Warning>

<Note>
For robust detection of GoogleTest setup integrity, employ a simple `TEST` that uses basic assertions and verify test execution output.
</Note>

<AccordionGroup title="Common Error Scenarios and Solutions">
<Accordion title="Compilation errors: Cannot find gtest/gtest.h">
Make sure to add the `googletest/include` directory to your compiler's include path.
In CMake, this is typically done via `target_include_directories(your_target PRIVATE ${GTEST_INCLUDE_DIRS})`.
</Accordion>
<Accordion title="Linker errors: Undefined references to GoogleTest symbols">
Verify that your test executable links with `gtest` and `gtest_main` libraries.
In CMake:

```cmake
target_link_libraries(your_test_target GTest::gtest GTest::gtest_main)
```
</Accordion>
<Accordion title="Tests not running or no output">
Ensure `testing::InitGoogleTest(&argc, argv);` is called before `RUN_ALL_TESTS();` in your `main()`.
Check test suite and test names are properly registered.
</Accordion>
</AccordionGroup>

