---
title: "Common Errors and How to Fix Them"
description: "Catalogs frequent errors (installation, linkage, runtime) with practical advice on solving them. Equips users to resolve issues independently, speeding up the learning curve and boosting confidence with the framework."
---

# Common Errors and How to Fix Them

This page catalogs frequent errors encountered by users of GoogleTest and GoogleMock during installation, linkage, and runtime. Each section provides practical advice for resolving specific issues, empowering you to troubleshoot independently and accelerate your mastery of the framework.

---

## 1. Installation Errors

### 1.1 Compiler Errors

- **Cause**: Using an unsupported compiler version or lacking C++17 support.

- **Fix**:
  - Verify your compiler meets the minimum required version that supports C++17.
  - Ensure compilation flags specify the C++17 standard (e.g., `-std=c++17` for GCC/Clang).
  - Consult the [System Requirements](../getting-started/prerequisites-installation/system-requirements.md) page for detailed supported environments.

<Tip>
If you encounter cryptic template errors or language feature not found messages, your compiler likely lacks full C++17 compliance.
</Tip>

### 1.2 Build Failures

- **Cause**: Missing dependencies or misconfigured build tools.

- **Fix**:
  - Confirm CMake is installed and at least version 3.14.
  - Check for pthread library presence on Unix-like systems.
  - Run CMake configuration commands carefully and review output logs for missing packages.
  - Refer to platform-specific installation instructions:
    - [Installation on Linux/macOS](../getting-started/prerequisites-installation/installing-on-linux-macos.md)
    - [Installation on Windows](../getting-started/prerequisites-installation/installing-on-windows.md)

<Warning>
On Unix systems, failure to link pthreads can cause mysterious linker errors.
</Warning>

### 1.3 Macro Parsing Issues When Using Mocks

- **Cause**: Macros defined in your code or third-party headers (e.g., Win32 API) interfere with GoogleMock macros.

- **Fix**:
  - Undefine conflicting macros before including GoogleMock headers.
  - Use explicit `MOCK_METHOD` syntax and carefully manage include order.
  - Consult [Mocking Reference](../docs/reference/mocking.md#MOCK_METHOD) for syntax details.

<Note>
If you see errors related to `MOCK_METHOD` expansion or unexpected tokens, check for macro collisions in your source files.
</Note>

## 2. Linkage Issues

### 2.1 Runtime Library Mismatches on Windows

- **Cause**: Mixing different C++ runtime libraries between your project and GoogleTest/GoogleMock.

- **Fix**:
  - Ensure all linked components use the same CRT (e.g., Multi-threaded DLL `/MD`).
  - Verify Visual Studio project settings for runtime library consistency.
  - Rebuild dependencies and tests with aligned settings.

<Tip>
Runtime mismatches often cause obscure crashes or link errors. Running dependency analysis tools can help identify mismatches.
</Tip>

### 2.2 Shared Library vs. Static Library Confusion

- **Cause**: Building GoogleTest/GoogleMock as shared but linking as static, or vice versa.

- **Fix**:
  - Decide on static or shared usage upfront.
  - Use CMake options `-DBUILD_SHARED_LIBS=ON/OFF` consistently.
  - Link your test binaries against the appropriate library versions.

<Warning>
Inconsistent linkage may cause missing symbols or multiple definition linker errors.
</Warning>

## 3. Runtime Errors and Test Failures

### 3.1 "Method for Real Object Is Invoked Instead" in Mocks

- **Cause**: The mocked method is not declared `virtual` in the base class.

- **Fix**:
  - Ensure all methods you want to mock are declared `virtual` in the base interface.
  - For non-virtual methods, consider the high-perf dependency injection pattern from the [Mocking Cookbook](../docs/gmock_cook_book.md#mocking-non-virtual-methods).

### 3.2 "Uninteresting Function Call Encountered â€“ Default Action Taken"

- **Cause**: Calling mock methods without `EXPECT_CALL` or suitable default behavior.

- **Fix**:
  - If calls are expected but not verified, add `EXPECT_CALL(...).Times(AnyNumber())` to suppress warnings.
  - For general default actions, configure `ON_CALL(...).WillByDefault(...)`.
  - Alternatively, use `NiceMock<>` wrappers to suppress uninteresting call warnings.

<Tip>
Beware: suppressing warnings by adding `EXPECT_CALL` without intent to verify can make tests brittle.
</Tip>

### 3.3 "Unexpected Mock Function Call"

- **Cause**: Code calls mock methods in a way or frequency not covered by `EXPECT_CALL`.

- **Fix**:
  - Review and correct the mock expectations.
  - Ensure more general or catch-all expectations exist if calls are expected but less important.
  - Use `EXPECT_CALL(...).Times(AnyNumber())` for catch-all cases as appropriate.

### 3.4 "Mock Function Called More Times Than Expected"

- **Cause**: Calls exceed `Times()` upper bounds.

- **Fix**:
  - Adjust `Times()` cardinality to match expected usage.
  - Use `.RetiresOnSaturation()` to retire expectations after their upper bound is reached.
  - Consider flexible cardinalities like `AtLeast(n)`, `AnyNumber()`.

### 3.5 "Heapcheck Failure Using Mock Objects"

- **Cause**: Base class lacks a `virtual` destructor.

- **Fix**:
  - Always add a `virtual` destructor to any base class used in mocks.

<Warning>
Failure to do so causes resource leaks and undefined behavior during test runtime.
</Warning>

### 3.6 "Warnings When Defining Mock Methods with Const Parameters"

- **Cause**: Some compilers (especially MSVC) warn because top-level `const` on parameters is ignored in overriding.

- **Fix**:
  - Remove `const` from top-level parameters in method and mock declarations.
  - Keep `const` on pointer/reference parameters as it is meaningful.

## 4. Debugging Tips

### 4.1 Enable Verbose Logging

Run tests with `--gmock_verbose=info` to get detailed traces of mock calls, matched expectations, and stack traces that help diagnose failing expectations.

### 4.2 Use `--gmock_catch_leaked_mocks=1`

Helps detect mock objects leaked without proper destruction, which can cause tests to silently miss expectation verification.

### 4.3 Use `Mock::VerifyAndClearExpectations(&mock_obj)`

Manually verify mock expectations if the object's lifecycle is long or managed externally.

### 4.4 Use Sequences and `.InSequence()`

To test ordered calls effectively and avoid unexpected order violations, use these constructs to assert call sequences precisely.

### 4.5 Match Arguments Effectively

Use built-in and custom matchers to specify argument expectations without over-specifying.

See [Matchers Reference](../docs/reference/matchers.md) for comprehensive guidance.

## 5. Preventing Common Pitfalls

- Set expectations **before** invoking mock methods.
- Use `NiceMock`, `NaggyMock`, or `StrictMock` wisely to control uninteresting call behavior.
- Avoid using `EXPECT_CALL` for suppressing warnings unless verifying those calls.
- Avoid mocking non-virtual methods unless using recommended patterns.
- Delegate calls to fakes or real objects when beneficial for complex behaviors.

## 6. More Help and Resources

- [Troubleshooting Setup Issues](../getting-started/troubleshooting-faq/troubleshooting-setup-issues.md)
- [gMock Cookbook](../docs/gmock_cook_book.md) for recipes and best practices
- [Mocking Reference](../docs/reference/mocking.md) for detailed API usage
- [Legacy gMock FAQ](../docs/gmock_faq.md) for answers to common user questions

---

By understanding and addressing these common errors, you will reduce setup headaches and create robust, maintainable test suites leveraging GoogleTest and GoogleMock with confidence.


---