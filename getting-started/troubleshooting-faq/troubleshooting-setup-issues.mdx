---
title: "Troubleshooting Setup Issues"
description: "Lists the most common installation and configuration problems, such as compiler errors, missing dependencies, and build failures, with concise solutions and references to deeper resources. Guides users from problem identification through resolution."
---

# Troubleshooting Setup Issues

This page helps you identify and resolve the most common installation and configuration problems encountered with GoogleTest and GoogleMock. From compiler errors to build failures and missing dependencies, you will find actionable solutions to get your testing environment running smoothly.

---

## 1. Common Compiler Errors

### a. Runtime Library Mismatch on Windows

**Problem:** Linker error indicating a mismatch between dynamic and static runtime libraries, such as:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

**Cause:** GoogleTest defaults to statically linking the C runtime, while Visual Studio projects usually link dynamically.

**Solution:** Use the CMake option `-Dgtest_force_shared_crt=ON` when configuring the build to make GoogleTest link with the dynamic runtime, matching your project.

```sh
cmake .. -Dgtest_force_shared_crt=ON
```

> This is essential on Windows to prevent such linkage errors.

### b. C++17 Standard Not Enabled

**Problem:** Build errors related to missing C++17 features or syntax errors caused by older standards.

**Cause:** GoogleTest requires a compiler with C++17 support.

**Solution:** Make sure your build system explicitly enables C++17. For example, in CMake, add:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Or pass compiler flags manually:

```sh
cmake .. -DCMAKE_CXX_FLAGS='-std=c++17'
```

### c. Missing pthread Library on Unix-like Systems

**Problem:** Linker errors such as `undefined reference to pthread_create`.

**Cause:** GoogleTest requires pthread support to be enabled.

**Solution:** Pass the pthread flag explicitly when building manually:

```sh
g++ -pthread ...
```

If using CMake, it typically handles this automatically, but verify your environment.

### d. Comma-related Macro Parsing Errors in `MOCK_METHOD`

**Problem:** Errors when mocking methods with complex argument types containing commas, for example:

```cpp
MOCK_METHOD(std::pair<int, bool>, GetPair, ()); // Does not compile
```

**Solution:** Wrap the method return type or argument types that have commas in additional parentheses or define aliases:

```cpp
MOCK_METHOD((std::pair<int, bool>), GetPair, ());
using PairIntBool = std::pair<int, bool>;
MOCK_METHOD(PairIntBool, GetPair, ());
```

## 2. Build Failures

### a. Incomplete or Incorrect Build Configuration

**Problem:** Build fails due to missing source files or headers.

**Cause:** Your build system may not be configured to find GoogleTest source and header files correctly.

**Solutions:**

- **Standalone build:** Follow the official guide to clone the repo, create a build directory, run `cmake ..` or `cmake .. -DBUILD_GMOCK=OFF`.
- **Integration:** Use CMakeâ€™s `FetchContent` or `add_subdirectory()` to incorporate GoogleTest to your project.
- Verify that your include paths point to `googletest/include` and source files from `googletest/src`.
- Ensure you are linking against the correct libraries like `gtest`, `gtest_main`, `gmock`, or `gmock_main` as required.

### b. Visual Studio Project Issues

**Problem:** Build issues in Visual Studio such as unresolved external symbols or configuration mismatches.

**Solution:**

- Generate Visual Studio solution with CMake.
- Match runtime libraries settings across your project and GoogleTest by using `-Dgtest_force_shared_crt=ON`.
- Use `gtest_main` to get a ready-to-use main entry point unless you write your own.

## 3. Missing Dependencies

### a. Missing CMake

GoogleTest relies on CMake 3.14 or later for building.

**Solution:**

- Install CMake from [https://cmake.org/download/](https://cmake.org/download/).
- Verify by running `cmake --version`.

### b. Missing Compiler or Unsupported Compiler Version

GoogleTest requires a compiler that supports C++17.

**Solution:**

- Update your compiler to a recent version that supports C++17.
- For GCC, version 7 and above; for Clang, version 5 and above; for MSVC, Visual Studio 2017 version 15.7 or later.

## 4. Miscellaneous Issues

### a. Link Errors Related to Shared Libraries

If you build GoogleTest as a shared library (DLL), you must:

- Add `-DGTEST_CREATE_SHARED_LIBRARY=1` to compiler flags when building GoogleTest.
- Add `-DGTEST_LINKED_AS_SHARED_LIBRARY=1` when building tests that link against it.

Refer to your linker's documentation for producing shared libraries.

### b. Macro Name Clashes

GoogleTest macros like `ASSERT_EQ` can clash with other libraries.

**Solution:** Define compiler macros to rename GoogleTest macros, e.g.,

```sh
-DGTEST_DONT_DEFINE_ASSERT_EQ=1
```

Then use macros with `GTEST_` prefix explicitly.

### c. Thread Safety

GoogleTest is thread-safe when pthreads are available.

**Issue:** You encounter thread-related errors.

**Solution:**

- Confirm pthread support and compile/link with pthreads.
- Specify `-DGTEST_HAS_PTHREAD=1` if automatic detection fails.

## 5. Verification and Debugging Tips

- Always run the provided GoogleMock test suite to verify installation (`tests/*.cc`).
- Use `--gmock_verbose=info` to see detailed mock invocation logs helpful in debugging.
- Use verbose output with `--gtest_print_time` to diagnose slowness or skips.

## 6. Helpful References

- [GoogleTest Primer](overview/introduction-core-value/what-is-googletest) for basics.
- [Installation on Windows](getting-started/prerequisites-installation/installing-on-windows) for detailed Windows-specific setup.
- [Alternative Build Systems](getting-started/prerequisites-installation/alternative-build-systems) for Bazel and pkg-config integrations.
- The GoogleTest GitHub repository for the latest updates and issues: [https://github.com/google/googletest](https://github.com/google/googletest)

---

<Tip>
If you encounter an error not described here, try running `cmake` and your build commands with verbose flags (e.g., `cmake --trace-expand`, `make VERBOSE=1`) to get detailed information.
It can help pinpoint environment or configuration issues.
</Tip>

<Warning>
Do not ignore compiler or linker warnings during setup; they often hint at critical misconfiguration issues.
Always fix warnings to avoid subtle runtime problems.
</Warning>


<AccordionGroup title="Common Problems and Solutions">
<Accordion title="Linker errors about RuntimeLibrary mismatch on Windows">
Enable dynamic runtime linkage with CMake option:

```sh
cmake .. -Dgtest_force_shared_crt=ON
```

This ensures that GoogleTest and your project use the same runtime library.
</Accordion>
<Accordion title="Undefined references to pthread functions on Unix">
Link against pthread explicitly. Use compiler flags:

```sh
g++ -pthread ...
```

or ensure CMake handles it correctly.
</Accordion>
<Accordion title="MOCK_METHOD parsing errors due to commas in types">
Wrap complex return types or argument types with parentheses, or create using-aliases to simplify.

Example:

```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
using Pair = std::pair<bool, int>;
MOCK_METHOD(Pair, GetPair, ());
```
</Accordion>
<Accordion title="Build errors due to missing C++17 support">
Set C++ standard explicitly in your build system:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Update your compiler to a recent version supporting C++17.
</Accordion>
</AccordionGroup>
