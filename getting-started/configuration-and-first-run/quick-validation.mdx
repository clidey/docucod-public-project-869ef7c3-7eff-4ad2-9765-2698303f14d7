---
title: "Quick Validation & Common Pitfalls"
description: "Offers practical steps for verifying a successful installation and highlights frequent issues new users encounter. Empowers users to quickly identify and resolve basic misconfigurations or environment problems."
---

# Quick Validation & Common Pitfalls

This guide helps you quickly verify that your GoogleTest and GoogleMock setup is successful and highlights frequent issues encountered by new users. Following these practical steps ensures your environment is correctly configured and empowers you to identify and resolve common misconfigurations or environment problems efficiently.

---

## 1. Verifying Your Installation

Follow these steps to confirm that GoogleTest and GoogleMock are properly installed and linked in your project.

### Step 1: Run a Basic Test

Create a minimal test file, e.g., `basic_test.cc`, with the following content:

```cpp
#include <gtest/gtest.h>

TEST(BasicTest, VerifySetup) {
  EXPECT_EQ(1, 1);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile and link this against GoogleTest and GoogleMock libraries as per your build system configuration.

### Step 2: Execute the Test Binary

Run the resulting executable. You should see output similar to:

```text
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from BasicTest
[ RUN      ] BasicTest.VerifySetup
[       OK ] BasicTest.VerifySetup (0 ms)
[----------] 1 test from BasicTest (0 ms total)

[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

If the test runs and passes, then GoogleTest and GoogleMock are installed correctly.

### Step 3: Confirm GoogleMock Is Active

Create a mock class and a simple expectation as described in the [Using and Creating Mock Objects](https://google.github.io/googletest/gmock_for_dummies.html#using-mocks) guide to verify mock setup.

Example:

```cpp
#include <gmock/gmock.h>

class MockFoo {
 public:
  MOCK_METHOD(void, Bar, (), ());
};

TEST(MockTest, BarIsCalled) {
  MockFoo mock;
  EXPECT_CALL(mock, Bar()).Times(1);
  mock.Bar();
}
```

Compile and run this test alongside the previous basic test.

---

## 2. Common Pitfalls & How to Resolve Them

Even after successful installation, users frequently encounter routine issues. Here’s how to detect and fix them.

### 2.1 Missing or Incorrect Linkage

**Symptoms:**
- Linker errors mentioning undefined references to GoogleTest or GoogleMock symbols.
- Compilation succeeds but tests fail to run properly.

**Resolutions:**
- Verify that your build system links against both `gtest` and `gmock` (and often `pthread` on Linux).
- Follow the instructions in [Configuring Your Project](https://google.github.io/googletest/getting-started/configuration-and-first-run/project-setup) for your build tool.

### 2.2 Not Calling `InitGoogleTest` Before Running Tests

**Symptoms:**
- Flags are undefined or tests behave unexpectedly.

**Resolution:**
- Always call `::testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS()`.
- This function parses GoogleTest flags and initializes internal state.

### 2.3 Failure to Include Required Headers

**Symptoms:**
- Compiler errors about missing types or undefined macros like `MOCK_METHOD`.

**Resolution:**
- Include `<gtest/gtest.h>` for test assertions.
- Include `<gmock/gmock.h>` when defining mocks.

### 2.4 Incorrect Use of `MOCK_METHOD`

**Symptoms:**
- Compilation errors due to bad macro usage.

**Resolution:**
- See [Creating Mock Classes](https://google.github.io/googletest/gmock_cook_book.html#CreatingMockClasses) for proper usage.
- Wrap return or argument types containing commas in extra parentheses or use type aliases to avoid macro parsing errors.

### 2.5 Tests Not Running or Reporting Incorrect Number of Tests

**Symptoms:**
- Tests silently skipped or the number of reported tests is zero.

**Resolution:**
- Ensure tests use the `TEST` or `TEST_F` macros correctly.
- Verify that test functions are linked and not removed by the linker.

### 2.6 Multiple Expectations Shadowing Each Other

**Problem:** Later expectations override earlier ones during mock matching.

**Resolution:**
- Place more specific `EXPECT_CALL`s **after** general ones.
- Use `.RetiresOnSaturation()` or sequences (`InSequence`) to enforce order or prevent sticky expectations.

### 2.7 Spurious "Uninteresting Mock Function Call" Warnings

**Explanation:** This warning appears when a mock method is called without an `EXPECT_CALL` set.

**Resolution:**
- Add `EXPECT_CALL(mock_object, Method(_)).Times(AnyNumber())` if calls are expected but not specifically validated.
- Use `NiceMock<T>` to suppress these warnings on nuisance calls.

### 2.8 Incorrect Use of `EXPECT_CALL` and `ON_CALL`

**Explanation:** `ON_CALL` sets default behavior but does not imply expectations; `EXPECT_CALL` sets expected calls.

**Resolution:** Use `ON_CALL` only for behavior, and add `EXPECT_CALL` for call verification.

### 2.9 Mock Objects Not Being Deleted

**Symptom:** Final verification of expectations does not happen.

**Resolution:**
- Use stack-based mock objects for automatic verification on destruction.
- If heap-allocated, ensure proper deletion or use `Mock::AllowLeak()` if intentional.

---

## 3. Troubleshooting Quick Tips

### Enabling Verbose Logs

Run your tests with the flag: `--gmock_verbose=info` to print detailed info about mock calls and expectations. This can help trace why expectations are not met.

### Searching for Expectation Failures

Look for messages mentioning:
- "Unexpected mock function call"
- "Actual function call count doesn't match"
- "Uninteresting mock function call"

They indicate the nature of the mismatch.

### Typical Fixes for Common Errors

| Error Message                          | Fix or Explanation                                      |
|--------------------------------------|--------------------------------------------------------|
| "Undefined reference to ..."        | Link against gtest and gmock libraries correctly       |
| "Uninteresting mock function call"  | Add explicit `EXPECT_CALL` or use `NiceMock`           |
| "Mock function called more times..."| Adjust `.Times()` cardinality or sequence expectations |

---

## 4. Best Practices to Avoid Pitfalls

- **Set Expectations Before Use:** Always arrange your `EXPECT_CALL` statements before exercising the mock.
- **Use Sequences for Ordered Calls:** Use `InSequence` or `After` to enforce call order.
- **Avoid Overspecification:** Only constrain interaction details you really want to verify.
- **Suppress Noise with NiceMock:** Use `NiceMock<T>` when uninteresting calls are legitimate.
- **Delegate Complex Behavior:** Use `ON_CALL` and `WillByDefault` for default stubs.

---

## 5. Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — For core testing concepts and writing tests.
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) — Detailed recipes for mocks.
- [Using and Creating Mock Objects](https://google.github.io/googletest/gmock_for_dummies.html) — Beginner-friendly introduction.
- [Configuration & First Run: Project Setup](https://google.github.io/googletest/getting-started/configuration-and-first-run/project-setup.html) — Guidance on build system integration.
- [Troubleshooting Installation & Build Problems](https://google.github.io/googletest/getting-started/support-and-troubleshooting/troubleshooting-setup.html) — For common installation issues.

---

If you run into issues beyond the common problems, consult the [GoogleTest FAQ](https://google.github.io/googletest/gmock_faq.html) and the [GitHub issues page](https://github.com/google/googletest/issues) for community support and known issues.
