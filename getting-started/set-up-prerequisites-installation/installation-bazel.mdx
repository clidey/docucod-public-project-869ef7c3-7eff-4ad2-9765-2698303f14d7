---
title: "Installing with Bazel"
description: "Guides Bazel users through adding GoogleTest and GoogleMock to their WORKSPACE, configuring dependencies, and running tests via Bazel. Highlights differences from CMake-based setup and refers to quick validation instructions."
---

# Installing with Bazel

This guide helps you integrate GoogleTest and GoogleMock into your Bazel workspace, configure necessary dependencies, and run your first tests using Bazel's build system. It highlights how this setup differs from CMake-based workflows and provides practical validation steps to achieve a successful test run.

---

## 1. Prerequisites & System Requirements

Before starting, ensure your environment meets the following requirements:

- **Supported Operating Systems:** Linux, macOS, Windows
- **C++ Compiler:** Must support at least C++17
- **Bazel Version:** 7.0 or higher

> See the [System Requirements & Supported Platforms](https://github.com/google/googletest/blob/main/getting-started/set-up-prerequisites-installation/system-requirements.md) page for detailed compatibility.


## 2. Setting Up Your Bazel Workspace

To use GoogleTest with Bazel, you first need a Bazel workspace where your code and dependencies live.

### Step 1: Create your Bazel workspace directory

Open your terminal and run:

```sh
mkdir my_workspace && cd my_workspace
```

This creates and navigates into a new directory for your Bazel project.

### Step 2: Add GoogleTest as a dependency in your MODULE.bazel

Create a file called `MODULE.bazel` in your workspace root and add the following:

```python
# MODULE.bazel

# Use the Bazel Central Registry to get GoogleTest version 1.17.0
bazel_dep(name = "googletest", version = "1.17.0")
```

This declares that your project depends on GoogleTest via Bazel's module system.

<Tip>
Ensure you choose the latest available version of GoogleTest from the [Bazel Central Registry](https://registry.bazel.build/modules/googletest) to access the latest fixes and features.
</Tip>


## 3. Writing and Building Your First GoogleTest with Bazel

With your workspace configured, let's create a basic test to verify the setup.

### Step 3: Create a test source file

Inside `my_workspace`, create a file named `hello_test.cc` with this content:

```cpp
#include <gtest/gtest.h>

// Basic GoogleTest example with simple assertions
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Expect strings not to be equal
  EXPECT_EQ(7 * 6, 42);               // Expect equality
}
```

### Step 4: Define the Bazel test target

Create a file named `BUILD` (no extension) in the same directory with this content:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

- `cc_test` declares a C++ test target.
- It links against GoogleTest's libraries.


### Step 5: Build and run your test

Run the following Bazel command in your workspace root:

```sh
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures compilation with C++17 standard.
- `--test_output=all` displays all test output logs.

You should see output similar to:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
```

<Tip>
For MSVC users, replace `--cxxopt=-std=c++17` with `--cxxopt=/std:c++17`.
</Tip>


## 4. Understanding Bazel's Role with GoogleTest and GoogleMock

- Dependencies like GoogleTest and GoogleMock are retrieved automatically via `MODULE.bazel`.
- Bazel handles compilation, linking, and running tests in isolated sandboxes.
- Bazel's `cc_test` rule simplifies creating test binaries that link to GoogleTest's core library and its `main()` wrapper.

## 5. Differences Compared to CMake Setup

| Aspect                  | Bazel Setup                                  | CMake Setup                                                |
|-------------------------|---------------------------------------------|-----------------------------------------------------------|
| Dependency management   | Via `MODULE.bazel` and Bazel Central Registry | Manual or `FetchContent` commands in `CMakeLists.txt`     |
| Build configuration     | Using `cc_test` targets and `BUILD` files    | Use of `CMakeLists.txt` with `add_subdirectory()` or `find_package()` |
| Running tests           | `bazel test` runs tests automatically        | Tests run via CTest or direct executable invocation       |
| Compiler flags          | Passed as command-line options (e.g., `--cxxopt`) | Set via `CMAKE_CXX_STANDARD` and related commands          |

These differences reflect Bazel's philosophy of fast, hermetic builds with centralized dependency management.


## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Basics">
<Accordion title="Build fails due to missing dependencies">
Check that your `MODULE.bazel` has the correct GoogleTest version specified and that your workspace syncs dependencies with `bazel sync`.
</Accordion>
<Accordion title="Compiler errors about C++ version">
Ensure your Bazel build command includes `--cxxopt=-std=c++17` (or equivalent for your compiler) to enforce C++17.
</Accordion>
<Accordion title="Test not running or no output visible">
Verify you are using `bazel test` and include the `--test_output=all` flag to view test logs.
</Accordion>
</AccordionGroup>

<Tip>
If issues persist, refer to the [Troubleshooting Common Setup Errors](https://github.com/google/googletest/blob/main/getting-started/troubleshooting-common-issues/troubleshooting-setup-errors.md) guide.
</Tip>


## 7. Next Steps and Recommendations

- Explore writing more complex tests with fixtures and mocks by visiting the [Getting Started: Your First Test](https://github.com/google/googletest/blob/main/googletest-guides/core-workflows/getting-started-tests.md) and [Introduction to Mocking with GoogleMock](https://github.com/google/googletest/blob/main/googletest-guides/core-workflows/mocking-basics.md).
- Review [Quick Validation & Sample Projects](https://github.com/google/googletest/blob/main/getting-started/configuration-first-run-validation/quick-validation.md) to confirm your environment setup.
- Consult Bazel's official [C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html) for enhanced BUILD file techniques.


---

## References

- [Bazel Central Registry for GoogleTest](https://registry.bazel.build/modules/googletest)
- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Bazel Installation Guide](https://bazel.build/install)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/primer.md)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)


---

This guide is part of the larger onboarding documentation to seamlessly integrate GoogleTest and GoogleMock into Bazel projects and accelerate your journey to writing robust C++ tests.


---

# Additional Tip

GoogleMock is included automatically when you depend on the standard GoogleTest Bazel labels (`@googletest//:gtest` and `@googletest//:gtest_main`). There is no additional setup beyond the WORKSPACE and BUILD configuration described here.



---

# Quick Validation (Summary)

1. Ensure your Bazel workspace has `MODULE.bazel` with the correct googletest dependency.
2. Write a simple test (`hello_test.cc`) and `BUILD` target.
3. Run `bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test`.
4. Confirm you see test passed output.


Congratulations! You're now set up with GoogleTest and GoogleMock via Bazel and ready to develop sophisticated tests.