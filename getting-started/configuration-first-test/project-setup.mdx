---
title: "Configuring Your Project for GoogleTest"
description: "Set up your build environment to use GoogleTest. Covers adding GoogleTest to your project, linking necessary libraries, and incorporating the correct headers to enable C++ testing in your workflow."
---

# Configuring Your Project for GoogleTest

Set up your build environment to use GoogleTest. This guide covers adding GoogleTest to your C++ project, linking necessary libraries, and incorporating the correct headers to enable testing within your development workflow.

---

## 1. Prerequisites & System Requirements

- **C++17 Support**: Ensure your compiler supports the C++17 standard, as GoogleTest requires it for successful builds.
- **Build System**: A working build environment such as CMake (version 3.14 or newer is recommended) is required.
- **Network Access**: To fetch GoogleTest sources automatically during build configuration, an internet connection might be needed.

<Tip>
If you do not have CMake installed, download it for free from https://cmake.org/.
</Tip>

## 2. Adding GoogleTest to Your Project

GoogleTest can be integrated in two main ways depending on your project setup.

### 2.1. Use Installed GoogleTest Libraries

If GoogleTest is installed on your system, you can include it by using CMake's `find_package`:

```cmake
find_package(GTest CONFIG REQUIRED)
```

Then link your test executables against the imported targets:

```cmake
target_link_libraries(your_test_target PRIVATE GTest::gtest GTest::gtest_main)
```

This method uses pre-built binaries and headers as a dependency.

### 2.2. Build GoogleTest as Part of Your Project

For consistency across platforms and compiler settings (especially on Windows), building GoogleTest from source within your project is recommended.

1. Add the following to your `CMakeLists.txt` to fetch the GoogleTest source code automatically:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# When using MSVC, ensure shared CRT linkage to avoid runtime conflicts
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)
```

2. Add your test executable:

```cmake
add_executable(your_test_exe test_main.cpp your_test_files.cpp)
```

3. Link GoogleTest libraries:

```cmake
target_link_libraries(your_test_exe PRIVATE gtest_main)
add_test(NAME your_test COMMAND your_test_exe)
```

<Tip>
This approach requires CMake 3.14 or higher due to the use of `FetchContent_MakeAvailable()`.
</Tip>

## 3. Include Headers in Your Test Code

To write tests, include GoogleTest headers in your C++ source code:

```cpp
#include <gtest/gtest.h>
```

For using GoogleMock functionalities (mocking features), include:

```cpp
#include <gmock/gmock.h>
```

This gives you access to testing macros, assertions, and mocking capabilities.

## 4. Linking and Compiling Your Tests

- When linking your test executable, link against either the installed GoogleTest libraries or the `gtest_main` target if built within your project.
- The `gtest_main` library provides a default `main()` function for running all tests. Use this unless you need to customize your `main()`.

### Visual Studio Runtime Note

On Windows with Visual Studio, GoogleTest by default links the C runtime statically, which can cause linker errors if your project uses dynamic linking.

To fix this, enable dynamic CRT linkage in GoogleTest with:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

in your CMake project, prior to fetching or adding GoogleTest.

## 5. Verifying Your Setup

After configuration and build, verify your setup by creating a simple test:

```cpp
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertion) {
  EXPECT_EQ(1, 1);
}
```

Build and run this test executable. Successful execution and output indicating tests passed confirm correct configuration.

---

## Troubleshooting Tips

- If you see linker errors related to `gtest.lib`, verify the linkage to GoogleTest and runtime CRT settings.
- If your compiler does not support C++17, update or configure it to the correct standard.
- For multi-threading support issues, ensure that the pthread library is linked on *nix systems. CMake scripts handle this automatically.
- Use verbose CMake output (`cmake --trace` or similar) to diagnose issues during configuration.

---

## Best Practices and Recommendations

- Prefer building GoogleTest within your project to maintain consistent build settings.
- Use `gtest_main` to avoid writing your own `main()` unless customization is required.
- Always specify the C++ standard in your `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- On Windows, always set `gtest_force_shared_crt` to `ON` to match your build flags and avoid runtime conflicts.

- Separate test code and mock definitions clearly, and avoid mocking frameworks or versions mismatched with your GoogleTest installation.

---

## Next Steps

Once configured, proceed to:

- [Writing and Running Your First Test](../configuration-first-test/first-successful-run) — Learn how to write and execute your initial tests.
- [Mocking Workflow](../../effective-testing-techniques/mocking-workflows) — Explore how to use mock objects for isolating dependencies and testing interactions.
- [Troubleshooting and Quick Validation](../troubleshooting-validation/common-setup-issues) — For resolving common setup and build errors.

---

## Additional Resources

- Official GoogleTest GitHub: https://github.com/google/googletest
- GoogleTest Primer and Tutorial: [docs/primer.md](../../getting-started/primer.md)
- GoogleMock Cookbook: [docs/gmock_cook_book.md](../../guides/effective-testing-techniques/mocking-workflows)
- CMake Documentation: https://cmake.org/cmake/help/latest/

---

<Check>
Ensure `CMakeLists.txt` includes C++17 standard specification.
</Check>

<Check>
Verify GoogleTest is either built from source using `FetchContent` or found using `find_package`.
</Check>

<Check>
Confirm linkage to `gtest_main` library for default main function.
</Check>

<Check>
On Windows, confirm `gtest_force_shared_crt` option is set for consistent runtime linkage.
</Check>


---

###### Source Reference

<Source url="https://github.com/google/googletest" paths={[{"path": "googletest/README.md", "range": "0-140"}]} branch="main" />



