---
title: "Your First Test & Mock"
description: "Write and run your first test and mock using GoogleTest and GoogleMock. Follow a minimal working example and explanation, creating real value by verifying your setup works from both the test and mocking perspectives."
---

# Your First Test & Mock with GoogleTest and GoogleMock

Welcome to the essential starting point for verifying your GoogleTest and GoogleMock installation: writing and running your first test and mock. This guide walks you through creating a minimal working example that confirms your setup works correctly and introduces core mock and test concepts with practical code illustrations.

---

## 1. Prerequisites & Setup Verification
Before you begin, ensure you have:

- Installed GoogleTest and GoogleMock libraries correctly on your system. Refer to the [Installation (All Platforms) Guide](/getting-started/setup-prerequisites/installation-platforms) for details on setup.
- A suitable C++ build environment configured to compile and link against the GoogleTest and GoogleMock libraries.
- Familiarity with writing and compiling basic C++ code.

<Check>
If you're unsure, try compiling and running a simple "hello world" C++ program first.
</Check>

---

## 2. Writing Your First Test
This section shows you how to write a simple test using GoogleTest's `TEST()` macro, which organizes your code into test suites and test cases.

### Step 2.1: Basic Test Without Mocks
Create a test file (e.g., `factorial_test.cpp`) and add the following:

```cpp
#include <gtest/gtest.h>

// Simple factorial function for demonstration
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Test suite named FactorialTest, with individual tests
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(5), 120);
}
```

### Step 2.2: How to Run
Compile the test file linking with GoogleTest and GoogleMock (if needed).

```bash
# Example compilation using g++ and pkg-config
# Adjust paths and flags according to your system setup

g++ factorial_test.cpp -lgtest -lgtest_main -pthread -o factorial_test
./factorial_test
```

The output should indicate the tests ran and passed successfully.

---

## 3. Writing Your First Mock
GoogleMock allows you to create mock objects for interfaces or abstract classes, helping you test interactions precisely.

### Step 3.1: Define an Interface to Mock
Consider a simple interface:

```cpp
class Foo {
 public:
  virtual ~Foo() {}
  virtual int GetSize() const = 0;
  virtual std::string Describe(const char* name) = 0;
};
```

### Step 3.2: Define the Mock Class
Use `MOCK_METHOD` macros inside a subclass:

```cpp
#include <gmock/gmock.h>

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(std::string, Describe, (const char* name), (override));
};
```

### Step 3.3: Write a Test Using the Mock

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

using ::testing::Return;

TEST(MockFooTest, TestMockBehavior) {
  MockFoo mock;

  // Define default behavior
  ON_CALL(mock, GetSize()).WillByDefault(Return(42));

  // Expect Describe to be called once with "example" and return "desc"
  EXPECT_CALL(mock, Describe("example"))
      .Times(1)
      .WillOnce(Return("desc"));

  // Exercise the mock
  EXPECT_EQ(mock.GetSize(), 42);
  EXPECT_EQ(mock.Describe("example"), "desc");
}
```

### Step 3.4: Run the Mock Test
Compile and run it the same way as before, ensuring you link against `gmock` libraries.

```bash
g++ mockfoo_test.cpp -lgmock -lgmock_main -lgtest -lgtest_main -pthread -o mockfoo_test
./mockfoo_test
```

You should see all expectations satisfied with detailed output in case of failures.

---

## 4. Understanding the Test and Mock Output

- Tests that pass will be marked with `[       OK ]`.
- Failed tests show detailed error messages including the location and reason.
- GoogleMock verifies all `EXPECT_CALL` expectations automatically when mocks go out of scope.

<Tip>
If tests fail, the error output typically shows which expectation was unmet or which call was unexpected.
Use this information to adjust your expectations or test code.
</Tip>

---

## 5. Best Practices & Tips
- Use `EXPECT_CALL` sparingly to verify only the calls important for your test; over-specification can make tests brittle.
- Use `ON_CALL` to set default mock behaviors without enforcing call expectations.
- Prefer `NiceMock<MockFoo>` if you want to ignore uninteresting calls to suppress warnings.
- The `TEST()` macro creates independent tests without shared setup, while `TEST_F()` uses test fixtures for shared code.
- Name your test suites and tests clearly to communicate intent.

---

## 6. Troubleshooting

<AccordionGroup title="Common Issues and Solutions">
<Accordion title="Mock Method Not Called Error">
If your test fails because a mocked method was not called as expected:

- Verify that the method is indeed called in the code under test.
- Check that `EXPECT_CALL` was set before the code execution.
- Confirm arguments passed to the mock match those in expectations or use matchers such as `_` for wildcards.
</Accordion>
<Accordion title="Linker Errors When Compiling Tests">
- Confirm that your build command links against both `gtest` and `gmock` libraries.
- Ensure you include compiler flags for pthread if on Linux/macOS (`-pthread`).
- Check library search paths if you have a custom install location.
</Accordion>
<Accordion title="Uninteresting Calls Warnings">
- These warnings appear when the mock receives calls with no matching `EXPECT_CALL`.
- Use `NiceMock<T>` if these warnings are not useful during normal test runs.
- Alternatively, explicitly expect uninteresting calls with `.Times(::testing::AnyNumber())` if you desire.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

After confirming your first test and mock work correctly, explore:

- Writing test fixtures for reuse: [TEST Fixtures](/getting-started/first-run-usage/configuration-integration)
- Using matchers for argument validation: [Matchers Reference](/api_reference/mocking_apis/mock_matchers_cardinalities)
- Advanced mock behaviors and actions: [Actions and Expectations](/guides/mocking-and-advanced-techniques/creating-and-using-mocks)
- Integrating tests into your build and CI system: [Integration with Build Systems](/guides/integration-and-real-world-scenarios/integrating-with-build-systems)

---

By following this guide, you verify your setup is functional from both a testing and mocking perspective, setting the foundation for comprehensive, robust C++ unit testing with GoogleTest and GoogleMock.


---

### Reference Links

- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [gMock Tutorial and CookBook](https://google.github.io/googletest/gmock_cook_book.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)

---

## Example Minimal Complete Code for Copy-Paste

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

// Interface to mock
class Foo {
 public:
  virtual ~Foo() {}
  virtual int GetSize() const = 0;
  virtual std::string Describe(const char* name) = 0;
};

// Mock class
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(std::string, Describe, (const char* name), (override));
};

// Simple factorial function to test basic TEST
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Simple TEST without mocks
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(3), 6);
}

// Test using the mock
using ::testing::Return;

TEST(MockFooTest, MockBehavior) {
  MockFoo mock;
  ON_CALL(mock, GetSize()).WillByDefault(Return(42));
  EXPECT_CALL(mock, Describe("example"))
      .Times(1)
      .WillOnce(Return("desc"));

  EXPECT_EQ(mock.GetSize(), 42);
  EXPECT_EQ(mock.Describe("example"), "desc");
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile with the appropriate flags and run to see immediate confirmation of valid setup.

---