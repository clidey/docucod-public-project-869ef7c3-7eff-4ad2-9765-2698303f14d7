---
title: "Building and Running Tests"
description: "Build your test binary and execute it using your chosen platform and build tool. Learn how to interpret test runner output and locate your test results. Includes tips for test discovery and filtering."
---

# Building and Running Tests

Build your test binary and execute it on your chosen platform and build system. This guide explains how to compile your tests, run them with test runners, interpret output, and locate detailed results. It also covers useful tips on test discovery and filtering to streamline your testing workflow.

---

## 1. Prerequisites Before Building Tests

Before building and running your tests:

- Ensure your build environment is configured to include GoogleMock and GoogleTest headers and sources.
- Integrate GoogleMock libraries into your project build scripts (see related build integration guides).
- Verify compiler supports C++17 or later, as required by GoogleTest.
- Confirm that all test source files are properly linked.

<Tip>
If you are using CMake, enable the `gmock_build_tests` option to build Google Mock's own test binaries. For typical user tests linking with GoogleMock, make sure to link against `gmock_main` or `gmock` and `gtest` as appropriate.
</Tip>

---

## 2. Building Your Test Binary

### For CMake Users

1. Configure your build directory:

```bash
mkdir build
cd build
cmake .. -Dgmock_build_tests=ON
```

2. Build the GoogleMock library and tests using:

```bash
make
# or use your platform's preferred build command
```

3. If you have your own tests, link your executable against `gmock_main` or `gmock` + `gtest`.

### General Guidelines

- To build your own test executable, include `gmock_main.cc` in your link step if you want the standard `main()` function provided by GoogleMock, which runs `RUN_ALL_TESTS()`.
  - Alternatively, provide your own custom `main()` and initialize using `testing::InitGoogleMock(&argc, argv);`.
- Make sure your test source files include `<gmock/gmock.h>`.

<Tip>
GoogleMock depends on GoogleTest. Using `gmock_main` provides convenience by initializing both GoogleTest and GoogleMock and defining the `main()` function.
</Tip>

---

## 3. Running Your Tests

Once the test binary is built, run it from your command line or test runner environment.

```bash
./your_test_binary [test_options]
```

### Common command line flags:

- `--gtest_filter=...` to run a subset of tests by name (supports wildcards).
- `--gtest_output=xml:filename.xml` to generate XML test reports.
- `--gmock_verbose=info|warning|error|fatal` to control verbosity of mock output.
- `--gmock_catch_leaked_mocks=1` to enable detection of leaked mocks.

### Expected Workflow

- The executable runs `RUN_ALL_TESTS()`.
- Output logs each test status (passed, failed, skipped).
- Upon completion, a summary with number of tests run, failures, and elapsed time appears.

<Tip>
Always check the exit code of your test binary: `0` means all tests passed; any non-zero value indicates failures.
</Tip>

---

## 4. Interpreting Test Runner Output

### Understanding Output Messages

- **Expected Calls**: Logs for mocked calls that match your expected behavior.
- **Unexpected Calls**: Warnings/errors when a mock is called in an unexpected manner.
- **Excessive Calls**: Occur when a mock is called more times than specified.
- **Uninteresting Calls**: Calls to mocks without explicit expectations.
- **Retired Expectations**: Expectations no longer active after their cardinality is fulfilled.
- **Unsatisfied Prerequisites**: Calls invoking mocks out of declared call order.

### Output Verbosity Levels

- Use the `--gmock_verbose` flag to control the amount of logged details.
- `info` for full details including expected and unexpected calls.
- `warning` or `error` to limit output to potential problems.

<Tip>
Verbose output (set to `info`) is invaluable when diagnosing test failures involving mocks.
</Tip>

---

## 5. Locating Test Results

- By default, GoogleTest/GoogleMock outputs results to the standard output.
- Use `--gtest_output=xml:<path>` to generate JUnit-style reports suitable for CI systems.

Example to generate XML report:

```bash
./your_test_binary --gtest_output=xml:test_results.xml
```

- Review XML files with any compatible viewer or CI dashboards.

---

## 6. Test Discovery and Filtering

### Automatic Test Discovery

- GoogleTest automatically registers tests defined with `TEST()` and `TEST_F()` macros.
- All tests compiled into the binary will be discovered and runnable.

### Filtering Tests

Use `--gtest_filter` to select which tests to run.

- Run a specific test suite or test:

```bash
./test_binary --gtest_filter=MySuite.MyTest
```

- Run multiple patterns (separate with `:`):

```bash
./test_binary --gtest_filter=MySuite.*:OtherSuite.Test1
```

- Exclude patterns by prefixing with `-`:

```bash
./test_binary --gtest_filter=-*SlowTest
```

<Tip>
Filtering tests reduces execution time for large test suites and facilitates debugging focused tests.
</Tip>

---

## 7. Common Tips and Best Practices

- Link with `gmock_main` library if you do not need a custom `main()` function.
- Call `testing::InitGoogleMock(&argc, argv);` early in your `main()` before `RUN_ALL_TESTS()`.
- Use the `RUN_ALL_TESTS()` macro only once.
- Set `--gmock_catch_leaked_mocks=1` to detect mocks that are created but never deleted (helps prevent memory leaks).
- For embedded or non-standard platforms, refer to platform-specific init methods as shown in `gmock_main.cc`.

---

## 8. Troubleshooting

### Test Binary Does Not Build

- Verify all required GoogleMock and GoogleTest source files are included.
- Ensure your compiler supports C++17.
- Check linker errors related to missing `main()` and link with `gmock_main` if you need the default main.

### Tests Do Not Run or Discover

- Confirm tests are registered using `TEST()`, `TEST_F()`, or mock expectations.
- Validate command-line filters do not exclude all tests accidentally.

### Verbose Output Shows Unexpected Calls

- Review your mock expectations `EXPECT_CALL` — add or adjust call counts and actions.
- Use `.RetiresOnSaturation()` when certain expectations should no longer match after being fulfilled.

### Leaked Mocks Detected

- Set the flag `--gmock_catch_leaked_mocks=1`.
- Ensure all dynamically allocated mocks are properly deleted or use smart pointers.

---

## 9. Related Documentation and Next Steps

- [Writing Your First Test](https://your-docs-domain/getting-started/first-test-run/create-first-test) — Learn test creation basics.
- [Mocking Reference](https://your-docs-domain/api-reference/mocking-apis/defining-mocks) — Deep dive into mocks and actions.
- [Using Assertions Effectively](https://your-docs-domain/guides/getting-started/using-assertions) — Improve test accuracy.
- [Integration with Build Systems](https://your-docs-domain/guides/real-world-guidance/project-integration) — How to incorporate with CMake, Bazel, etc.
- [Troubleshooting Common Issues](https://your-docs-domain/getting-started/troubleshooting-qa/common-issues) — Tips for common pitfalls.

-----------

<Check>
Building and running tests is a fundamental step to validate your C++ code with GoogleMock and GoogleTest. Following these steps ensures a smooth test execution experience and reliable results interpretation.
</Check>

<Source url="https://github.com/google/googletest" paths={[{"path": "googlemock/src/gmock_main.cc", "range": "1-65"}]} />