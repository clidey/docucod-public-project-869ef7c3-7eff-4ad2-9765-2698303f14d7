---
title: "Writing and Running Your First Test"
description: "Leads users step-by-step through creating a minimal test case, compiling the example code, and executing the resulting tests. Reinforces core concepts like test discovery and assertion basics."
---

# Writing and Running Your First Test

Welcome to GoogleTest! This guide walks you through creating your first test using GoogleTest, helping you understand how to write simple tests, compile them, and run to verify your setup.

---

## 1. Prerequisites & Setup

Before writing your first test, ensure your development environment meets these basic requirements:

- **Compiler Support**: A C++ compiler that supports C++11 or later.
- **GoogleTest Installed**: GoogleTest (and GoogleMock if needed) source or binaries available.
- **Build System Configured**: CMake, Bazel, or another build system properly configured to build test executables with GoogleTest.

> <Note> If you have not set up GoogleTest yet, refer to the [Build, Configure, and Validate Your Installation](https://github.com/google/googletest/blob/main/docs/getting-started/prerequisites-installation-setup/build-configure-validate.md) guide for detailed setup instructions. </Note>

---

## 2. Writing Your First Test

GoogleTest organizes tests into *test suites* (groups of related tests) and *tests* (individual test cases). To get started:

### Step 1: Include GoogleTest Header

Add this include at the top of your test source file:

```cpp
#include <gtest/gtest.h>
```

### Step 2: Define a Simple Test Using the `TEST` Macro

`TEST` takes two arguments: the test suite name and the test name. Both must be valid C++ identifiers without underscores.

Example:

```cpp
// A function to be tested
int Factorial(int n) {
    return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Define a test suite 'FactorialTest' and a test 'HandlesZeroInput'
TEST(FactorialTest, HandlesZeroInput) {
    EXPECT_EQ(Factorial(0), 1); // Assert factorial(0) == 1
}

// Another test in the same suite
TEST(FactorialTest, HandlesPositiveInput) {
    EXPECT_EQ(Factorial(1), 1);
    EXPECT_EQ(Factorial(2), 2);
    EXPECT_EQ(Factorial(3), 6);
    EXPECT_EQ(Factorial(8), 40320);
}
```

> <Tip> Use `EXPECT_*` for non-fatal assertions to allow a test to continue after failure, and `ASSERT_*` for fatal failures where continuing makes no sense. </Tip>

### Step 3: Run the Test

You can compile and run this test executable. When run, GoogleTest will report results for each test suite and test.

---

## 3. Compiling Your Test

Use your build tool to compile the test source file and link against GoogleTest libraries.

### Using CMake (example `CMakeLists.txt` snippet):

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTests)

# Find GoogleTest package
find_package(GTest REQUIRED)

add_executable(runTests my_test.cc)
target_link_libraries(runTests GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(runTests)
```

Build and run:

```shell
mkdir build
cd build
cmake ..
make
./runTests
```

### Using Bazel (example `BUILD` snippet):

```starlark
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

Run:

```shell
bazel test //:my_test
```

---

## 4. Running Your First Test and Understanding Output

Run your test executable directly or via your build system's test runner. Typical output looks like:

```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)
[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

The messages enumerate test suites and individual tests. Each test reports success (`OK`) or failure.

### Simulating a Test Failure

Try changing an assertion to a failing condition to see failure reporting.

```cpp
TEST(FactorialTest, FailsForBadInput) {
    EXPECT_EQ(Factorial(4), 12);  // Intentional failure
}
```

The output will include:

```
[ RUN      ] FactorialTest.FailsForBadInput
/path/to/my_test.cc:25: Failure
Expected equality of these values:
  Factorial(4)
    Which is: 24
  12
[  FAILED  ] FactorialTest.FailsForBadInput (0 ms)
```

This shows the file and line number, the expected and actual values, and marks the test as failed.

---

## 5. Using Test Fixtures with `TEST_F` for Reusable Setup

When multiple tests require shared setup or cleanup, use test fixtures.

### Define a Test Fixture Class

```cpp
class QueueTest : public ::testing::Test {
 protected:
  void SetUp() override {
    queue_.Enqueue(1);
    queue_.Enqueue(2);
  }

  // Queue class is your production class
  Queue<int> queue_;
};
```

### Write Tests Using the Fixture

```cpp
TEST_F(QueueTest, DequeueReturnsFirstElement) {
  int* val = queue_.Dequeue();
  ASSERT_NE(val, nullptr);
  EXPECT_EQ(*val, 1);
  delete val;
}

TEST_F(QueueTest, SizeIsCorrect) {
  EXPECT_EQ(queue_.size(), 2);
}
```

GoogleTest creates a fresh fixture instance for each `TEST_F` to ensure isolation.

---

## 6. Best Practices and Tips

- **Name your tests clearly:** Use descriptive test and test suite names reflecting behavior.
- **Keep tests isolated:** Avoid shared state across tests to ensure repeatability.
- **Use fixtures to avoid redundancy:** Put common objects and setup in fixtures.
- **Check failures early:** Use `ASSERT_*` for prerequisites to avoid crashes.
- **Leverage matchers:** Use GoogleTest matchers to express flexible expectations.
- **Use `EXPECT_CALL` and mocks for dependencies:** For testing code with interactions, explore mocking with GoogleMock.

---

## 7. Troubleshooting Common Issues

### Test Not Running
- Ensure `RUN_ALL_TESTS()` is called from `main()` after initializing GoogleTest.

### Compilation Errors
- Confirm include paths and links for GoogleTest.
- Verify C++11 or newer compiler is used.

### Tests Always Passing or Failing
- Check assertion syntax and logic.
- Verify your test source files are compiled and linked.

### GoogleTest Output Too Verbose or Too Quiet
- Use command-line flag `--gtest_output` and verbosity flags to adjust output.

### Mismatched Expectations and Calls (with Mocks)
- Read errors carefully; use verbose flag `--gmock_verbose=info` for detailed call traces.

---

## 8. Next Steps

- Explore setting up mock objects and expectations using GoogleMock.
- Learn about parameterized tests for running tests over data sets.
- Utilize test discovery and advanced test features (typed, value-parameterized tests).

For detailed next steps, see:
- [Writing Effective Tests](https://github.com/google/googletest/blob/main/docs/guides/core-workflows/using-assertions.md)
- [Mocking Basics](https://github.com/google/googletest/blob/main/docs/guides/core-workflows/mocking-basics.md)
- [Parameterized Tests](https://github.com/google/googletest/blob/main/docs/guides/advanced-patterns/parameterized-tests.md)

---

## Sample Complete `main` Function with Test

GoogleTest provides a main function builtin via `gtest_main` library, but if you need customization:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This initializes GoogleTest and runs all registered tests.

---

Congratulations, you have written and run your first GoogleTest test suite! You are now ready to build more complex and comprehensive test coverage with confidence.
