---
title: "Writing Your First Test"
description: "A hands-on walkthrough for creating, building, and running your first unit test using GoogleTest. Introduces essential test case structure, assertion macros, and expected test outcomes."
---

# Writing Your First Test

Welcome to your first hands-on experience writing a unit test with GoogleTest. This guide will walk you through creating, building, and running simple tests to verify your C++ code using the core testing macros and APIs provided by GoogleTest.

---

## 1. Understanding the Test Structure

GoogleTest organizes tests into *test suites* and *tests*. A test suite groups logically related tests, and each test verifies a single behavior.

- Use the `TEST(TestSuiteName, TestName)` macro to define a test.
- Both `TestSuiteName` and `TestName` must be valid C++ identifiers without underscores.
- Tests are independent and isolated.

### Example: Simple Test Definition

```cpp
#include <gtest/gtest.h>

// Function to test
int Factorial(int n) { ... }

// Test suite named FactorialTest with individual test HandlesZeroInput
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);  // Expect factorial(0) to be 1
}

// Another test in the same suite
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

In this example, each `TEST` defines a test function that uses *assertions* like `EXPECT_EQ` to verify expected outcomes.

<Check>
TIP: GoogleTest automatically discovers and registers all `TEST()` macros, so there's no need for manual test registration.
</Check>

---

## 2. Running Your Tests

To execute your tests, you typically write a `main` function that initializes GoogleTest and runs all tests:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);  // Initialize GoogleTest
  return RUN_ALL_TESTS();                // Run all tests and return result
}
```

Alternatively, if you link your program with the `gtest_main` library, GoogleTest provides a default `main()`, so you may not need to write one.

---

## 3. Using Assertions to Verify Behavior

Assertions are the statements inside tests that confirm code behaves as expected. GoogleTest provides many assertion macros; the most common are binary comparisons.

- Assertions come in pairs: `EXPECT_*` (non-fatal, continues after failure) and `ASSERT_*` (fatal, aborts current function).
- Use `EXPECT_*` to allow a test to check multiple conditions, and `ASSERT_*` when failing early is necessary to prevent crashes.

### Common Assertions Examples

```cpp
EXPECT_EQ(val1, val2);  // Checks val1 == val2
ASSERT_NE(ptr, nullptr); // Checks ptr != nullptr
EXPECT_TRUE(condition);  // Checks condition is true
EXPECT_STREQ(cstr1, cstr2); // Checks C strings for equality
```

<Warning>
Avoid using underscores (`_`) in test suite and test names; this prevents naming collisions and reserved identifier conflicts.
</Warning>

---

## 4. Reusing Setup with Test Fixtures

For tests needing shared setup or multiple related tests using common objects, use *test fixtures*. They allow code reuse and improve maintainability.

### Steps for a Fixture

1. Derive a class from `testing::Test`.
2. Declare shared objects and define the constructor and/or `SetUp()` method for setup.
3. Use `TEST_F(TestFixtureName, TestName)` to define tests using this fixture.

### Fixture Example

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {  // Constructor runs before each test
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;  // Empty queue
  Queue<int> q1_;  // One element
  Queue<int> q2_;  // Two elements
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

Each test receives a fresh fixture instance, keeping tests isolated and independent.

---

## 5. Building and Running Your First Test Program

1. Create your test source file, e.g., `factorial_test.cc`, with your tests and `main()`.
2. Compile the test with GoogleTest libraries.

Example using `g++` and CMake (assuming GoogleTest installed):

```bash
# Compile
g++ -std=c++17 -isystem /usr/include/gtest -pthread factorial_test.cc -lgtest -lgtest_main -o factorial_test

# Run
./factorial_test
```

Alternatively, integrate GoogleTest in your CMake build following the instructions in the [Installing GoogleTest](https://github.com/google/googletest/blob/main/googletest/README.md).

---

## 6. Interpreting Test Results

When you run your test executable, GoogleTest prints a concise report:

```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)
[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

- `[  PASSED  ]` indicates success for individual tests and the overall run.
- Failures appear with `[  FAILED  ]` and relevant error messages and file/line locations.

---

## 7. Practical Tips and Best Practices

- Always check the return value of `RUN_ALL_TESTS()` in your `main()` to indicate test success/failure properly.
- Prefer `EXPECT_*` over `ASSERT_*` to detect multiple failures in one run, except where continuation is unsafe.
- Avoid underscores in test and suite names to prevent conflicts.
- Use test fixtures (`TEST_F`) when multiple tests share common objects or setup.
- Name your test suites and tests clearly and meaningfully.
- Use `SCOPED_TRACE` to add helpful context in nested test code or helper functions.

---

## 8. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Your First Test">
<Accordion title="Tests Not Discovered or Run">
- Ensure your tests use the `TEST` or `TEST_F` macros correctly.
- Verify that GoogleTest is properly linked to your test binary.
- Confirm that your executable calls `testing::InitGoogleTest(&argc, argv)` before `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="Compilation or Linking Errors">
- Specify the correct include paths (`-isystem /path/to/gtest`) and link with `-lgtest -lgtest_main`.
- Use C++17 or later.
- On Windows, ensure runtime libraries are consistent between your build and GoogleTest.
</Accordion>
<Accordion title="Assertion Macro Misuse">
- Don’t use `ASSERT_*` macros in functions that return non-void; use `EXPECT_*` instead.
- Check your test and suite names for illegal underscores as they cause hard-to-debug errors.
</Accordion>
</AccordionGroup>

---

## 9. Next Steps

- Explore [Writing Your First Test](../guides/getting-started/writing-your-first-test) for more detailed explanations and examples.
- Learn to use test fixtures and parameterized tests to write more scalable test suites.
- Consult the [Assertions Reference](reference/assertions.md) for a complete list of assertion macros.
- Review [Configuring Your Project](../getting-started/setup-and-installation/configuring-your-project) to integrate GoogleTest smoothly in your build.

---

## References and Further Reading

- [GoogleTest Primer](primer.md) — foundational concepts
- [Assertions Reference](reference/assertions.md) — detailed assertion usage
- [Core Testing Concepts](../overview/core_fundamentals/core_concepts)
- [Test Discovery and Execution](../overview/core_fundamentals/test_discovery_execution)
- [Sample Projects and Examples](samples.md)

---

Welcome to effective, maintainable C++ testing powered by GoogleTest!


---

*This page focuses specifically on writing your first test with GoogleTest — creating test suites and test cases using `TEST()` and `TEST_F()`, basic assertion usage, and interpreting test outcomes. For installation and setup of GoogleTest, see related documents under Getting Started > Setup and Installation. For running and interpreting test results, see Getting Started > Running and Interpreting Test Results.*
