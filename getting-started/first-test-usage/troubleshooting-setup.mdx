---
title: "Troubleshooting & Common Pitfalls"
description: "Addresses common issues users encounter during setup and first build/run, such as missing dependencies, compiler errors, or misconfiguration. Provides troubleshooting steps, how to read error messages, and where to find additional help."
---

# Troubleshooting & Common Pitfalls

This guide helps you troubleshoot common issues experienced during GoogleTest setup and first builds or test runs. It explains how to identify missing dependencies, resolve compiler errors, fix misconfigurations, and interpret error messages. Follow these steps to quickly address the blockers that prevent your tests from compiling or running successfully.

---

## 1. Diagnosing Setup Issues

### 1.1 Missing Dependencies

GoogleTest requires a C++17 compliant compiler and CMake for building. If you see errors about missing headers or undefined C++17 features, verify the following:

- You have installed **CMake 3.14 or newer**.
- Your compiler supports C++17 (e.g., GCC 7+, Clang 5+, MSVC 2017+).
- Your build scripts or IDE projects specify `-std=c++17` or equivalent.

If building on Windows with Visual Studio, ensure your **runtime libraries are consistent** between GoogleTest and your project (look for errors about `RuntimeLibrary` mismatch). You may need to set the CMake flag `gtest_force_shared_crt=ON`.

### 1.2 Library and Header Locations

Ensure your build system can locate GoogleTest headers and compiled libraries:

- If using CMake externally, verify you've run `FetchContent` or added GoogleTest as a subdirectory properly.
- For manual builds, install GoogleTest using `make install` or Visual Studio build.
- Update your include and linker paths as necessary.

### 1.3 Multi-threading Limitations

GoogleTest is thread-safe on platforms with pthreads but may be unsafe on some Windows configurations. If you experience random failures or race conditions:

- Try using only single-threaded tests during early development.
- On Windows, synchronize test threads manually or build with the `-DGTEST_HAS_PTHREAD=0` flag if appropriate.

---

## 2. Common Compilation and Build Errors

### 2.1 Incorrect Macro Usage

- GoogleTest macros like `TEST()`, `TEST_F()`, and `EXPECT_CALL()` require valid C++ identifiers without underscores in test or test suite names.
- When using `TEST_F()`, ensure the test fixture class is fully defined before use.
- `MOCK_METHOD` declarations must appear in the `public:` section of a mock class.

### 2.2 Linking Errors

Link errors related to GoogleTest often occur when:

- Mixing static and shared runtime libraries. Fix by setting CMake flag `gtest_force_shared_crt=ON` or ensuring all projects use the same runtime.
- Forgetting to link to `gtest` or `gtest_main`.
  - Link with `gtest_main` to use the default main entry point.
  - Alternatively, write your own `main()` and link with `gtest`.

### 2.3 Deprecated or Conflicting Flags

- Avoid using deprecated functions like `ParseGUnitFlags()`; use `InitGoogleTest()` exclusively.
- If you have conflicts with macro names (such as `ASSERT_EQ` defined elsewhere), use the compile flag `-DGTEST_DONT_DEFINE_FOO=1` for the conflicting macro.

---

## 3. Debugging Runtime Test Failures

### 3.1 Understanding GoogleTest Error Messages

GoogleTest clearly marks the test file, line number, failing assertion, and provides messages if you supplied custom failure streams.

Tips for reading error output:

- Identify whether a failure is **fatal** (aborts the current test) or **nonfatal** (allows continuation).
- Look for the test suite and test name to locate the source in your code.
- Use flagged output (`--gtest_verbose=info`) for more insight during test execution.

### 3.2 Assertion Failures vs. Crashes

- Assertions report failed conditions but keep the test executable running.
- Unexpected crashes (segfaults, exceptions) cause the test to fail immediately.
- Check that your test does not dereference null pointers or access invalid memory.

### 3.3 Handling `ASSERT_*` vs `EXPECT_*`

Remember:

- `ASSERT_*` abort the current function immediately on failure, which may skip cleanup or further checks.
- `EXPECT_*` records the failure but continues, allowing multiple errors to be reported simultaneously.

Use `ASSERT_*` only when further execution is unsafe (like dereferencing pointers).

### 3.4 Common Pitfall: Fatal Assertions in Constructors or Destructors

GoogleTest disallows fatal assertions inside constructors or destructors. Instead:

- Put them inside `SetUp()` or `TearDown()` methods of your test fixture.
- If you violate this, compiler errors or undefined test behavior will occur.

---

## 4. Fixes for Misconfiguration

### 4.1 Tests Not Discovered or Running

- Confirm your test files are included in your build and linked.
- Ensure test names conform to required naming rules (no underscores).
- Use `--gtest_list_tests` to confirm test detection.
- If tests are disabled (prefixed with `DISABLED_`), they won't run unless you specify `--gtest_also_run_disabled_tests`.

### 4.2 Mocking Issues

If mock methods generate warnings or errors:

- Ensure `MOCK_METHOD` declarations are correct.
- Specify expectations with `EXPECT_CALL` before exercising mocks.
- Use `NiceMock` to suppress warnings on unexpected calls.
- Use `StrictMock` to enforce stricter call expectations.

### 4.3 Death Tests Fail or Hang

- Validate your environment supports fork or process spawning correctly.
- Set death test style explicitly via `GTEST_FLAG_SET(death_test_style, "fast")` or `"threadsafe"`.
- Avoid creating threads before death tests run.
- Name test suites containing death tests with `*DeathTest` suffix to help ordering.

---

## 5. Troubleshooting Tips and Resources

### 5.1 Stepwise Troubleshooting

1.  Confirm your compiler and build toolchain meet prerequisites.
2.  Check header and library paths.
3.  Build GoogleTest standalone first, to verify basic setup.
4.  Verify linking to correct GoogleTest targets (`gtest`, `gtest_main`).
5.  Run tests with verbose flags:
    ```
    ./your_test --gtest_verbose=info
    ```
6.  Use `--gtest_list_tests` to confirm test cases detected.
7.  Examine error outputs line-by-line to locate source problem.

### 5.2 Useful Flags to Know

| Flag                          | Purpose                                |
| ----------------------------- | ------------------------------------- |
| `--gtest_list_tests`           | Lists all tests detected, without running |
| `--gtest_filter=PATTERN`       | Run only tests matching PATTERN       |
| `--gtest_repeat=N`             | Repeat all tests N times               |
| `--gtest_break_on_failure`     | Break into debugger on first failure |
| `--gtest_also_run_disabled_tests` | Run disabled tests too                |
| `--gmock_verbose=LEVEL`        | Control GoogleMock verbosity (error, warning, info) |

### 5.3 Support and Documentation

- Consult the [GoogleTest Primer](primer.md) for foundational concepts.
- Review the [Assertions Reference](reference/assertions.md) to understand failure types.
- Use the [Mocking Reference](reference/mocking.md) and [gMock Cookbook](gmock_cook_book.md) for mocking troubleshooting.
- Check the [Advanced Guide](advanced.md) for complex scenarios like death tests and parameterized tests.
- Join GoogleTest community forums or consult the GitHub repository issues for additional help.

---

## 6. Summary

By carefully following the above guidelines, you can quickly identify and solve the majority of setup and runtime issues with GoogleTest. Always ensure prerequisites, correct build system configuration, and proper test/mocking conventions. Use available verbose flags to debug execution and refer to official guides for deep dives into failure causes.


---

## Additional Resources

- [GoogleTest Primer](primer.md): Learn how to write tests and assertions.
- [Assertions Reference](reference/assertions.md): Understand assertion macros and failure handling.
- [Mocking Reference](reference/mocking.md): Guidelines for mocks and expectations.
- [Advanced Guide](advanced.md): For sophisticated features and troubleshooting.
- [GoogleTest GitHub Repo](https://github.com/google/googletest): Source code, issues, and releases.


---

## Contact & Help

If you cannot resolve an issue, consider opening a detailed ticket on the GoogleTest GitHub Issues page with your environment details, error messages, and steps tried. For community support, examine Stack Overflow with the [googletest](https://stackoverflow.com/questions/tagged/googletest) tag.


---

<Check>
Ensure that you run `RUN_ALL_TESTS()` only once in your test program. Calling it multiple times creates conflicts and errors.
</Check>

<Check>
Always review compiler errors related to `MOCK_METHOD` usage, as incorrect signatures or macro usage is a common source of failures.
</Check>

<Check>
When writing death tests, follow naming conventions (`*DeathTest`) to guarantee order of execution and reduce flaky tests.
</Check>

<Note>
Remember, GoogleTest and GoogleMock have extensive online documentation and sample tests that serve as practical references during debugging.
</Note>
