---
title: "Minimal Configuration"
description: "Walks through the basic setup needed to integrate GoogleTest and GoogleMock with your build system, including header inclusion and linker settings."
---

# Minimal Configuration for GoogleTest and GoogleMock

This guide walks you through the essential steps required to integrate GoogleTest and GoogleMock into your build system with a minimal setup. It focuses on the core configuration needed for including the headers and setting the linker options, enabling you to write and run your first unit tests and mocks with minimal overhead.

---

## 1. Overview of Minimal Configuration

GoogleTest and GoogleMock are designed to work seamlessly once integrated correctly with your project's build system. This minimal configuration ensures that:

- All necessary headers are included correctly.
- Linkage settings properly combine GoogleTest and GoogleMock libraries.
- Initialization routines are correctly called before running tests.

This setup acts as your foundation before customizing or expanding test configurations.

---

## 2. Prerequisites

Before proceeding with the minimal configuration, ensure the following:

- GoogleTest and GoogleMock source or prebuilt libraries are available in your project or system.
- Your compiler supports at least C++17 as required by GoogleTest.
- Your build system can properly reference include directories and link libraries.
- You have basic familiarity with your build system's configuration files (e.g., CMakeLists.txt for CMake).

---

## 3. Include Headers

In your test source files, add the following includes to use GoogleTest and GoogleMock features:

```cpp
#include "gtest/gtest.h"
#include "gmock/gmock.h"
```

- `gtest/gtest.h` provides GoogleTest testing macros and fixtures.
- `gmock/gmock.h` extends with mocking capabilities.

**Tip:** Always include GoogleMock after GoogleTest to ensure correct symbol resolution.

---

## 4. Linker Settings

Your test binaries must link against both the GoogleTest and GoogleMock libraries to resolve symbols correctly.

### Using CMake

If using CMake to build your tests, link your test executable with the following targets:

```cmake
find_package(GTest REQUIRED)  # If installed system-wide

add_executable(my_test_suite test_main.cpp my_tests.cpp)

target_link_libraries(my_test_suite GTest::gmock_main)  # Includes gtest, gmock, and main

add_test(NAME my_test_suite COMMAND my_test_suite)
```

- `GTest::gmock_main` is a special GoogleMock-provided main function that initializes both GoogleTest and GoogleMock.
- If unavailable, you may link with `GTest::gmock` and define your own `main()`.

### Manual Linking

If you manage linking manually, make sure to link against the following libraries in order:

- `gmock_main` (preferred) or `gmock` + `gtest_main`
- `gtest`
- pthread or threading libraries if required by your platform

Example linker flags (Unix-like systems):

```sh
-lgmock_main -lgmock -lgtest -lpthread
```

---

## 5. Initialization

Before running the tests, you must initialize GoogleMock (which also initializes GoogleTest). This is typically done in your `main()` function:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

**Notes:**
- Use `InitGoogleMock()` instead of `InitGoogleTest()` to ensure both frameworks initialize properly.
- If you use `gmock_main` library target, it provides a default `main()` so you don't need to write one.

---

## 6. Sample Minimal Test Example

Here is a simple example integrating GoogleTest and GoogleMock with minimal configuration:

```cpp
#include "gtest/gtest.h"
#include "gmock/gmock.h"

using ::testing::Return;

// Interface to mock
class Foo {
 public:
  virtual ~Foo() = default;
  virtual int GetValue() const = 0;
};

// Mock class
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
};

TEST(FooTest, ReturnsMockedValue) {
  MockFoo mock;
  EXPECT_CALL(mock, GetValue()).WillOnce(Return(42));

  EXPECT_EQ(mock.GetValue(), 42);
}

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## 7. Best Practices and Tips

- **Use `gmock_main` when possible:** It simplifies initialization by providing the test runner main function.
- **Keep linkage order consistent:** Incorrect library order can cause linker errors.
- **Pass command-line arguments:** `InitGoogleMock()` parses GoogleMock and GoogleTest flags.
- **Avoid multiple initializations:** Call the init function only once, usually in `main()`.

---

## 8. Common Pitfalls and Troubleshooting

<AccordionGroup title="Common Setup Issues">  
<Accordion title="Linker Errors for Undefined GoogleTest or GoogleMock Symbols">  
Check that you linked all required libraries (`gmock`, `gtest`) and that your linker order is correct. Use `gmock_main` to avoid manual main function conflicts.  
</Accordion>  
<Accordion title="GoogleMock Flags Not Parsed in Command Line">  
Verify that `InitGoogleMock(&argc, argv)` is called before `RUN_ALL_TESTS()`. GoogleMock removes flags it recognizes from `argv`.  
</Accordion>  
<Accordion title="Multiple `main()` Definitions Found">  
If linking with `gmock_main` target, do not define your own `main()`. For custom `main()`, link with `gmock` and `gtest_main` instead.  
</Accordion>  
<Accordion title="Compilation Fails Due to Missing C++17 Support">  
Ensure your compiler is set to C++17 or higher (e.g., `-std=c++17`). GoogleTest requires this minimum standard.  
</Accordion>  
</AccordionGroup>

---

## 9. Next Steps

With this minimal configuration complete, you can:

- Write more advanced tests using fixtures and parameterized tests.
- Explore GoogleMock's powerful mocking features for complex interactions.
- Integrate GoogleTest and GoogleMock with your CI pipelines and build systems.
- Refer to additional guides for installation details and troubleshooting if needed.

---

## 10. References

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) - Learn to write basic tests
- [Integration with Build Tools and CI](../overview/integration-ecosystem/integration-with-build-and-ci) - Build environment setup
- [Writing and Running Your First Test](../getting-started/first-test-usage/writing-first-test) - Example test creation
- [Using GoogleMock](../getting-started/first-test-usage/using-googlemock) - Introduction to mocking

---

For additional details, please browse related Getting Started sections or the full API reference.

---

*This guide aligns with GoogleTest's minimal configuration intent, ensuring new users get up and running quickly with foundational setup.*