---
title: "Building and Running Tests"
description: "Details how to compile and run test programs, including setting up test entry points and leveraging main function entry via provided code (e.g., gmock_main.cc or gtest_main.cc). Explains command-line options and interpreting test results."
---

# Building and Running Tests

This guide explains how to compile and run your test programs using GoogleTest and GoogleMock, including setting up test entry points with provided main functions (`gmock_main.cc` or `gtest_main.cc`), using command-line options, and understanding the test results output.

---

## 1. Prepare Your Test Program

Before building and running tests, ensure your C++ test sources are ready and that you've written your test cases using `TEST()` or `TEST_F()` macros according to the [Writing Your First Test](https://google.github.io/googletest/primer.html) guide.

You have two main ways to set up the test executable's entry point:

### Option A: Use Provided Main Function (`gtest_main` or `gmock_main`)

- Link your test binaries against the provided helper libraries:

  - `gtest_main` for GoogleTest-only tests.
  - `gmock_main` for tests that also use GoogleMock.

- These libraries contain a default `main()` function that initializes the framework and runs tests.

**Example:**

```cmake
add_executable(my_test test_file.cc)
target_link_libraries(my_test gmock_main)
```

This removes the need to write your own `main()` — it's the easiest and recommended approach.

### Option B: Write Your Own Main Function

If you want to customize initialization or perform setup before tests run, you can write your own `main()`:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>  // Include if GoogleMock is used

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Initializes GoogleMock AND GoogleTest
  return RUN_ALL_TESTS();
}
```

- Use `InitGoogleMock(&argc, argv)` to parse command-line flags and initialize GoogleMock and GoogleTest.
- Call `RUN_ALL_TESTS()` once to execute all registered tests; its return value indicates success (`0`) or failure (`non-zero`).


## 2. Build Instructions

Depending on your build system, compile your test program as usual.

### Using CMake

Ensure you link your test target with GoogleTest/GoogleMock libraries and optionally `gmock_main` for easy setup:

```cmake
cmake_minimum_required(VERSION 3.10)
project(MyTestProject)

find_package(GTest REQUIRED)
find_package(GMock REQUIRED)

add_executable(my_tests test_file.cc)
target_link_libraries(my_tests GTest::gmock_main)
```

### Using Bazel

Bazel users add `@com_google_googletest//googletest` and `@com_google_googlemock//gmock` as dependencies in your `BUILD` file and link accordingly.

### Verification

After building, you should have an executable binary (e.g., `my_tests`) ready to run.


## 3. Running Tests

### Basic Execution

Run your test binary from the command line:

```shell
./my_tests
```

This will execute all registered tests and print a summary:

- Passed tests
- Failed tests with detailed error messages and stack traces

The exit code will be `0` if all tests pass, otherwise non-zero.

### Using Command-Line Options

GoogleTest and GoogleMock support a variety of flags to control test execution behavior. Some commonly used options:

| Flag                                       | Description                                         |
| ------------------------------------------ | --------------------------------------------------- |
| `--gtest_filter=FILTER`                     | Run only tests matching the filter pattern          |
| `--gtest_list_tests`                        | List all available tests without running them       |
| `--gtest_shuffle`                           | Randomize test execution order                       |
| `--gtest_repeat=N`                          | Repeat all tests N times                             |
| `--gmock_verbose=LEVEL`                     | Set GoogleMock message verbosity (info, warning, error) |

**Example:** Run only `FooTest.Bar`:

```shell
./my_tests --gtest_filter=FooTest.Bar
```

For a full list of options, visit the [Test Runner and Invocation documentation](https://google.github.io/googletest/reference/testrunner_and_invocation.html).


## 4. Understanding Test Results

When you run your tests, GoogleTest outputs:

- `[ RUN      ]` lines indicating which test is currently running
- `PASS` or `FAILED` status per test
- `[  PASSED  ]` and `[  FAILED  ]` summaries after all tests run

### Interpreting Failures

- Detailed failure messages show the file and line number of the failed assertion
- Stack traces provide context about where and why the failure happened
- If your executable exits with a non-zero code, one or more tests failed

### Sample Output

```text
Running main() from gmock_main.cc
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
/path/to/test.cc:42: Failure
Expected equality of these values:
  Factorial(8)
    Which is: 40320
  40321
[  FAILED  ] FactorialTest.HandlesPositiveInput (1 ms)
[----------] 2 tests from FactorialTest (1 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (1 ms total)
[  PASSED  ] 1 test.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] FactorialTest.HandlesPositiveInput

 1 FAILED TEST
```


## 5. Tips and Best Practices

- **Use `gmock_main` or `gtest_main` whenever possible:** Saves time and avoids mistakes in setting up tests.
- **Always check the exit code:** The return value from `RUN_ALL_TESTS()` drives automated test success/failure.
- **Use filtering for targeted testing:** When debugging or developing, run only tests relevant to your current work.
- **Leverage GoogleMock flags for verbosity:** Use `--gmock_verbose=info` for detailed mock call logs.
- **Call `InitGoogleMock()` with command-line arguments:** Ensures flags are correctly parsed and applied.


## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Build and Run Problems">
<Accordion title="Tests are not discovered or run">
- Ensure tests are compiled and linked into the test executable.
- Verify test macros `TEST` or `TEST_F` are correctly used.
- Check initialization calls: use `InitGoogleMock()` or link with `gmock_main`.
</Accordion>
<Accordion title="Test executable fails to run or crashes">
- Look for missing dependencies or mismatched library versions.
- Run with `--gtest_break_on_failure` to break at failing assertions if a debugger is attached.
- Consult the output logs for clues about the failure.
</Accordion>
<Accordion title="Command-line flags are ignored">
- Check that `InitGoogleMock()` or `InitGoogleTest()` is called before `RUN_ALL_TESTS()`.
- Ensure no wrapper script or shell alias alters command line arguments.
</Accordion>
</AccordionGroup>


## 7. Additional Resources
- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — Learn how to write tests.
- [Writing Your First Test](https://google.github.io/googletest/primer.html#writing-your-first-test)
- [Test Runner and Invocation Control](https://google.github.io/googletest/reference/testrunner_and_invocation.html)
- [GoogleMock User Guide](https://google.github.io/googletest/gmock_for_dummies.html)
- [Common Setup Issues and Solutions](https://google.github.io/googletest/setup-troubleshooting.html)

---

This page fits into the overall Getting Started documentation under the First Test and Validation group, complementing introductory guides on prerequisites, installation, configuration, and writing your first tests. After you build and run tests successfully, proceed to the Validation and Troubleshooting pages to deepen your testing practice and resolve any setup problems.
