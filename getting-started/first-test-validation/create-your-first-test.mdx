---
title: "Create Your First Test"
description: "Step-by-step instructions for writing and running your first unit test (and optional mock) using GoogleTest/GoogleMock. Uses a minimal, copy-pasteable code sample, emphasizing best practices and essential concepts."
---

# Create Your First Test

Welcome to your journey with GoogleTest and GoogleMock! This guide walks you through writing and running your very first unit test using the GoogleTest framework. Along the way, we introduce fundamental testing concepts, demonstrate mock usage with GoogleMock, and provide a minimal, copy-pasteable example so you gain hands-on experience immediately.

---

## 1. Setup and Prerequisites

Before writing your first test, ensure you have:

- A working C++ environment supporting at least C++17.
- GoogleTest and GoogleMock installed or integrated into your project. (Refer to the [Installing with CMake and Bazel](https://github.com/google/googletest/blob/main/googletest/README.md) guide for setup.)
- Basic knowledge of your platform's build system.

<Tip>
If you have not installed GoogleTest yet, see the "Installing with CMake and Bazel" guide to get up and running quickly.
</Tip>

## 2. Writing Your First Test

You will write a very simple test that checks whether your code behaves as expected. GoogleTest uses macros to create tests, asserting conditions, and reporting success or failure.

### Example: HelloWorldTest

Create a test file named `hello_world_test.cc` with the following content:

```cpp
#include <gtest/gtest.h>

// This is your first test case.
// The TEST macro takes two parameters: 
// 1) the test suite name, 2) the test name
TEST(HelloWorldTest, BasicExpectations) {
  // Basic assertion that always passes.
  EXPECT_TRUE(true);

  // Assert equality.
  int expected_value = 42;
  int actual_value = 40 + 2;
  EXPECT_EQ(expected_value, actual_value);
}
```

### Explanation

- `TEST` defines a test named `BasicExpectations` in the `HelloWorldTest` suite.
- `EXPECT_TRUE` asserts that a condition is true.
- `EXPECT_EQ` asserts that two values are equal.

### Building the Test

Compile the test file linking against GoogleTest and GoogleMock. For example (assuming pkg-config is installed and configured):

```bash
g++ hello_world_test.cc -lgtest -lgmock -lpthread -o hello_world_test
```

Alternatively, use your build system or IDE accordingly.

### Running the Test

Execute:

```bash
./hello_world_test
```

Expected output:

```text
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloWorldTest
[ RUN      ] HelloWorldTest.BasicExpectations
[       OK ] HelloWorldTest.BasicExpectations (0 ms)
[----------] 1 test from HelloWorldTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

Congratulations, you just wrote and ran your first test!

## 3. Introducing a Mock Object

Often, you want to test your component's interaction with dependencies rather than their actual behavior. GoogleMock enables this by letting you create **mock classes** that simulate complex dependencies.

### Example: Mocking a Simple Interface

Given an interface:

```cpp
class Foo {
 public:
  virtual ~Foo() {}
  virtual int GetValue() const = 0;
  virtual void SetValue(int value) = 0;
};
```

Create a mock class:

```cpp
#include <gmock/gmock.h>

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetValue, (), (const, override));
  MOCK_METHOD(void, SetValue, (int value), (override));
};
```

### Using the Mock in a Test

```cpp
#include <gtest/gtest.h>

using ::testing::AtLeast;
using ::testing::Return;

TEST(MockFooTest, CanSetAndGetValue) {
  MockFoo mock_foo;

  // Set default behavior for GetValue() to return 10 whenever called.
  ON_CALL(mock_foo, GetValue())
      .WillByDefault(Return(10));

  // Expect SetValue to be called with 42 at least once.
  EXPECT_CALL(mock_foo, SetValue(42))
      .Times(AtLeast(1));

  // Exercise mock.
  mock_foo.SetValue(42);
  EXPECT_EQ(mock_foo.GetValue(), 10);
}
```

### Explanation

- `MOCK_METHOD` defines mocked versions of the virtual functions.
- `ON_CALL` sets default behavior for mock methods without setting call expectations.
- `EXPECT_CALL` sets expectations on method invocations and argument matchers.

### Running the Mock Test

Compile with GoogleTest and GoogleMock libraries, then run as before.

## 4. Key Concepts and Best Practices

- **Define all mock methods in the `public:` section.** Even if the base class methods are `protected` or `private`.
- **Expectations (`EXPECT_CALL`) should always be declared *before* calling the mock methods.**
- **Use matchers to capture expected arguments.** For arguments you don't care about, use the wildcard matcher `_`.
- **Use `NiceMock` to suppress warnings on uninteresting calls, and `StrictMock` to treat them as errors.**
- **Use `WillOnce()` and `WillRepeatedly()` to define return values or actions.**

## 5. Troubleshooting Tips

<Tip>
If your test fails unexpectedly or doesn't behave as expected, consider running it with the command line flag `--gmock_verbose=info` to see detailed mock call traces.
</Tip>

<Tip>
Remember that mock objects verify their expectations upon destruction. If you allocate mocks on the heap, ensure they get properly deleted or explicitly call `Mock::VerifyAndClearExpectations()` to verify before deletion.
</Tip>

<Tip>
If your compiler doesn't like `MOCK_METHOD` syntax due to unprotected commas, wrap the types with extra parentheses or use type aliases.
</Tip>

## 6. Additional Resources

For detailed usage, advanced patterns, and mock customization, explore:

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html)

---

Now that you've successfully created and run your first GoogleTest and GoogleMock test, you're ready to start writing robust, meaningful tests that verify both state and behavior. Happy testing!
