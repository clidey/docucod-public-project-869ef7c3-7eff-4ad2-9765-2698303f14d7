---
title: "Creating Your First Test"
description: "Define and implement your initial test case with GoogleTest and GoogleMock. Walk through test code structure, file setup, and integration into your project—providing concrete examples for immediate hands-on success."
---

# Creating Your First Test

Define and implement your initial test case with GoogleTest and GoogleMock. This guide walks you through the test code structure, file setup, and integration into your project—providing concrete examples for immediate hands-on success.

---

## 1. Overview

Creating your first test with GoogleTest involves writing test code in C++, organizing it into properly named test suites and test cases, compiling with the GoogleTest framework, and running the tests to validate your code's behavior. If you want to mock dependencies or collaborators, GoogleMock provides powerful tools to create mock objects and expectations.

This guide assumes you have installed GoogleTest and GoogleMock and configured your project to compile and link against them. For installation instructions, see [Installing with CMake](../getting-started/installation-initialization/installation-cmake).

---

## 2. Setup Your Test File

Tests are typically placed in files named with `_test.cc` or `_test.cpp` suffixes in your project.

### Step 1: Include the GoogleTest and/or GoogleMock Headers

Start your test file with the necessary headers:

```cpp
#include <gtest/gtest.h>    // For GoogleTest
#include <gmock/gmock.h>    // For GoogleMock, optional if you use mocks
```

### Step 2: Write a Simple Test Case

GoogleTest provides two main macros for tests:

- `TEST(TestSuiteName, TestName)`: Defines a simple test.
- `TEST_F(FixtureName, TestName)`: Defines a test that uses a test fixture class (shared setup and teardown).

Here is an example of a simple test that verifies basic functionality:

```cpp
// Simple test example verifying an arithmetic expression.
TEST(FactorialTest, HandlesZeroInput) {
    EXPECT_EQ(1, 1);  // Expect equality to 1
}
```

**Key points:**
- The first argument, `FactorialTest`, is the test suite name grouping related tests.
- The second argument `HandlesZeroInput` is the specific test name.
- Use `EXPECT_*` assertions for checks that allow the test to continue, or `ASSERT_*` for fatal checks.

### Step 3: Use Test Fixtures for Sharing Setup

When multiple tests require common objects or initialization, define a test fixture class derived from `testing::Test`:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Setup code, e.g., enqueue elements
    q1_.Enqueue(1);
  }

  Queue<int> q1_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(0, q1_.size());
}

TEST_F(QueueTest, DequeueReturnsCorrectValue) {
  int* value = q1_.Dequeue();
  ASSERT_NE(nullptr, value);
  EXPECT_EQ(1, *value);
  delete value;
}
```

---

## 3. Creating Your First Mock Class

GoogleMock makes it easy to create mock classes to isolate and verify behavior of your classes under test.

### Step 1: Define a Mock Class

Mock classes are normal C++ classes that use the `MOCK_METHOD` macro to declare mock methods.

Example:

```cpp
class MockFoo {
 public:
  MOCK_METHOD(int, GetSize, (), (const));
  MOCK_METHOD(void, Clear, ());
};
```

Notes:
- Place `MOCK_METHOD` declarations in `public:` regardless of base class accessibility.
- Use the method signature split into return type, method name, and argument types.
- Add qualifiers like `(const)`, `(override)`, `(noexcept)` if needed.

### Step 2: Use the Mock in Your Test

You can now instantiate your mock object and set expectations or default behaviors:

```cpp
using ::testing::Return;

TEST(MockTest, UsesMock) {
  MockFoo mock;
  EXPECT_CALL(mock, GetSize())
      .WillOnce(Return(42));

  EXPECT_EQ(42, mock.GetSize());
}
```

---

## 4. Write Your First Complete Test Example

Here's a minimal example combining GoogleTest and GoogleMock:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

class Foo {
 public:
  virtual ~Foo() = default;
  virtual int GetSize() const = 0;
  virtual void Clear() = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
  MOCK_METHOD(void, Clear, (), (override));
};

TEST(FooTest, SizeTest) {
  MockFoo mock;
  EXPECT_CALL(mock, GetSize())
      .WillOnce(::testing::Return(10));

  EXPECT_EQ(mock.GetSize(), 10);
}
```

**Expected Outcome:**
- The test passes with `mock.GetSize()` returning 10.
- Any call to `GetSize()` outside expectation will cause failure.

---

## 5. Compiling and Running Your Test

1. Ensure your build system includes GoogleTest and GoogleMock sources or links to installed libraries.
2. Compile your test file with the appropriate compiler flags (`-std=c++17` or later).
3. Link against `gtest`, `gmock`, and their dependencies.

Example using CMake:

```cmake
add_executable(my_test my_test.cc)
target_link_libraries(my_test GTest::gtest_main GTest::gmock_main)

include(GoogleTest)
gtest_discover_tests(my_test)
```

Build and run:

```sh
cmake -S . -B build
cmake --build build
ctest --output-on-failure
```

---

## 6. Tips and Best Practices

- **Keep tests small and focused.** Each test should verify one logical aspect.
- **Use fixtures to share setup/teardown, but isolate state changes.** Each test runs with a fresh fixture instance.
- **Use mocks to isolate system under test and verify interactions.**
- **Prefer `EXPECT_` assertions for non-fatal verification to see multiple failures in one test run.**
- **Name test suites and tests clearly to describe what they verify.**
- **Run tests frequently to validate correctness incrementally.**

---

## 7. Troubleshooting Common Issues

- **Test not running:** Confirm your main calls `RUN_ALL_TESTS()`, and tests are linked properly.
- **Linker errors:** Verify GoogleTest and GoogleMock libraries are linked and compatible C++ standards used.
- **Mock methods not being called or matching:** Check your `EXPECT_CALL` statements precede code that triggers calls, and matcher arguments are correct.
- **Unexpected calls warnings:** Use `NiceMock<YourMockClass>` to suppress uninteresting calls or add explicit expectations.

---

## 8. Next Steps

- Explore the [GoogleTest Primer](../guides/getting-started/primer-overview) to deepen your understanding of basic testing.
- Learn about advanced mocking with [Mocking for Dummies](../gmock_for_dummies.md) and [gMock Cookbook](../gmock_cook_book.md).
- Master building and running tests efficiently in your environment with [Quickstart: Building with CMake](../getting-started/installation-initialization/installation-cmake).
- Discover writing more expressive assertions and matchers.

---

Happy testing with GoogleTest and GoogleMock!

<Source url="https://github.com/google/googletest" paths={[{"path": "docs/primer.md", "range": "1-150"},{"path": "docs/reference/mocking.md", "range": "1-400"},{"path": "docs/quickstart-cmake.md", "range": "1-88"},{"path": "docs/testing.md", "range": "1-350"}]} />