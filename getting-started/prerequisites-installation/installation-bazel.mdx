---
title: "Install with Bazel"
description: "Instructions for adding GoogleTest and GoogleMock to your Bazel workspace, including dependency setup and example usage. Ideal for Bazel-centric or large polyglot codebases."
---

# Install with Bazel

This guide provides clear instructions to add **GoogleTest** and **GoogleMock** to your Bazel workspace. It covers dependency setup, workspace configuration, build file declarations, and running your first test. This page is ideal for users working with Bazel-centric or large polyglot codebases aiming for seamless C++ testing integration.

---

## 1. Prerequisites & System Requirements

Before you start, ensure your environment meets the following:

- **Operating System:** Linux, macOS, or Windows
- **C++ Compiler:** Supports at least C++17 (e.g., GCC, Clang, MSVC)
- **Bazel Version:** 7.0 or higher

If you need to install Bazel, visit the official [Bazel installation guide](https://bazel.build/install).

> See the [System Requirements](getting-started/prerequisites-installation/system-requirements) page for comprehensive platform compatibility and compiler notes.

---

## 2. Setting Up Your Bazel Workspace

A Bazel workspace organizes your source files and defines external dependencies needed during build.

### Step 1: Create a Workspace Directory

Open your terminal and execute:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Create the `MODULE.bazel` File

This file declares your GoogleTest dependency via Bazel's Central Registry.

Create a file named `MODULE.bazel` with the following content:

```python
# MODULE.bazel

# Declare the GoogleTest dependency with the latest stable version
bazel_dep(name = "googletest", version = "1.17.0")
```

> **Tip:** Check the [Bazel Central Registry](https://registry.bazel.build/modules/googletest) for the most recent version of GoogleTest.

---

## 3. Writing Your First Test

Create a simple test source file to verify setup.

### Step 1: Create `hello_test.cc`

In your workspace directory, create a file named `hello_test.cc` and add:

```cpp
#include <gtest/gtest.h>

// Demonstrates basic assertions
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Check that strings are not equal
  EXPECT_EQ(7 * 6, 42);               // Check that multiplication is as expected
}
```

### Step 2: Create the Bazel Build File

Create a file named `BUILD` in the same directory with the contents:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This `cc_test` rule defines a C++ test target that links against GoogleTest libraries.

> **Note:**
> - The `gtest` library contains GoogleTest code.
> - The `gtest_main` library provides the default `main()` function for test executables.

---

## 4. Building and Running Your Test

### Step 1: Build and Test with Bazel

Run the following command to build and execute your test:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures the use of C++17 standard.
- `--test_output=all` prints all test output immediately.

### Expected Output Snippet:

```
INFO: Analyzed target //:hello_test ...
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

When you see `[  PASSED  ] 1 test.`, your setup is successful!

---

## 5. Best Practices and Tips

- **Use Recent Versions:** Frequently check for updates on GoogleTest and Bazel to benefit from new features and fixes.
- **Configure C++ Std Version:** Always specify `--cxxopt=-std=c++17` (or equivalent) to enforce C++17 compatibility.
- **Dependency Versions:** Pin GoogleTest versions explicitly in your `MODULE.bazel` for reproducibility.
- **Link Test Binaries Properly:** Always include both `@googletest//:gtest` and `@googletest//:gtest_main` in your `deps` for tests with default main.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting GoogleTest with Bazel">
<Accordion title="Error: Unsupported C++ Standard">
Check that your compiler supports C++17 and use the flag `--cxxopt=-std=c++17` during build and test.
</Accordion>
<Accordion title="Test Does Not Run or Finds No Tests">
Ensure your test functions use the `TEST` macro and that your `cc_test` target correctly includes GoogleTest dependencies.
</Accordion>
<Accordion title="Linker Errors Related to pthread or Threading">
Make sure to build with a compiler and platform that supports pthreads, and confirm Bazel's toolchain settings include threading support.
</Accordion>
<Accordion title="Bazel Version Incompatibility">
Confirm you use Bazel 7.0 or higher. Older versions may lack the Central Registry support required for `bazel_dep`.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Explore the [Primer](primer.md) to learn writing more sophisticated tests.
- Browse [Sample Tests](samples.md) for real-world GoogleTest usage patterns.
- Visit the [Writing and Running Your First Test](getting-started/first-test-setup/writing-running-first-test) page for deeper guidance on test workflows.
- Review [Integration Overview](overview/architecture-features-integration/integration-overview) for details on incorporating GoogleTest in complex ecosystems.

---

**You've successfully integrated GoogleTest into your Bazel workspace and run your first testâ€”solid foundations for building robust C++ test suites!**

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/quickstart-bazel.md", "range": "1-104"},{"path": "BUILD.bazel", "range": "1-80"},{"path": "MODULE.bazel", "range": "1-50"}]} />