---
title: "Installing with Bazel"
description: "Guidance for integrating GoogleTest with your Bazel build, including relevant WORKSPACE setup and best practices for dependency management. Tailored for teams standardizing on Bazel for builds."
---

# Installing with Bazel

This guide provides clear, actionable steps for integrating GoogleTest into your C++ project using the Bazel build system. It covers workspace setup, specifying dependencies, and best practices for managing your Bazel build environment. This page targets teams standardizing on Bazel to streamline testing workflows.

---

## 1. Prerequisites & Environment Setup

Before starting, ensure your environment meets the following criteria:

- **Operating System:** Linux, macOS, or Windows.
- **Compiler:** A C++ compiler supporting at least C++17.
- **Bazel Version:** 7.0 or newer to support current GoogleTest Bazel integration.

If Bazel is not installed, follow the [Bazel installation guide](https://bazel.build/install) for your platform.

<Check>
Verify Bazel is at least version 7.0:
```bash
bazel version
```  
Look for a version `>= 7.0` in the output.
</Check>

---

## 2. Setting Up Your Bazel Workspace

Your Bazel workspace manages source files and dependencies. Follow these steps to configure it for GoogleTest:

### Step 2.1: Create your workspace directory

Open your terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

This directory will hold your source code and Bazel configuration.

### Step 2.2: Define Dependencies with `MODULE.bazel`

Bazel 7.0+ recommends using the Bazel Central Registry for handling external dependencies.

Create a `MODULE.bazel` file in your workspace root with the following content:

```python
# MODULE.bazel

# Specify the GoogleTest version to use (update if needed):
bazel_dep(name = "googletest", version = "1.17.0")
```

This tells Bazel to fetch and manage GoogleTest version 1.17.0.

<Note>
Keep your GoogleTest version up to date by checking the [Bazel Central Registry for googletest](https://registry.bazel.build/modules/googletest).
</Note>

---

## 3. Creating and Building Your First Test

Now that your workspace and dependencies are ready, create a simple test to verify GoogleTest is correctly integrated.

### Step 3.1: Write a sample test file

Create a file `hello_test.cc` in the workspace root with this content:

```cpp
#include <gtest/gtest.h>

// Basic test example
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Assert strings are not equal
  EXPECT_EQ(7 * 6, 42);               // Assert arithmetic correctness
}
```

This code includes GoogleTest headers and demonstrates basic assertions.

### Step 3.2: Define the Bazel build rule

Create a `BUILD` file in the same directory with the following content:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This declares a C++ test binary:
- `hello_test` is the target name.
- It builds from `hello_test.cc`.
- It depends on GoogleTest libraries (`gtest` and `gtest_main`) fetched via `MODULE.bazel`.

<Info>
Linking with `gtest_main` provides the default `main()` function for your tests. No need to write your own unless customization is required.
</Info>

### Step 3.3: Build and run your test

Run the following Bazel command to build and execute your test:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

Explanation:
- `--cxxopt=-std=c++17` ensures the C++17 standard is used.
- `--test_output=all` streams all output to your terminal, helpful for debugging.

### Expected output snippet:

```
INFO: From Testing //:hello_test:
==================== Test output for //:hello_test:
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

Once you see `[  PASSED  ] 1 test.`, your installation and configuration are successful.

<Check>
If the test does not build or fails, verify:
- Bazel version is updated.
- `MODULE.bazel` syntax is correct.
- Your compiler supports C++17.
- You link with `gtest_main` (provides `main()`).
</Check>

---

## 4. Best Practices for Bazel Integration

- **Explicit Dependencies:** Always declare GoogleTest dependencies explicitly in your `BUILD` files to ensure reproducible builds.
- **Use Latest Versions:** Regularly update the GoogleTest version in your `MODULE.bazel` to benefit from bug fixes and new features.
- **C++ Standard Consistency:** Use `--cxxopt=-std=c++17` consistently in build and test commands to avoid ABI or compatibility issues.

---

## 5. Next Steps

- Explore the [GoogleTest Primer](primer.md) to learn how to write effective test cases.
- Review the [Writing and Running Your First Test](//getting-started/first-test-configuration/writing-first-test) for detailed examples.
- Consult [Troubleshooting and Installation Validation](//getting-started/first-test-configuration/troubleshooting-validation) if you encounter issues.

---

## Troubleshooting

<AccordionGroup title="Common Issues When Installing GoogleTest with Bazel">
<Accordion title="Test Fails to Link: Undefined Reference to main">
Make sure your `BUILD` file links against `@googletest//:gtest_main`. This target supplies the default `main()` function for tests.
</Accordion>
<Accordion title="Bazel Cannot Find googletest Dependency">
Verify your `MODULE.bazel` file syntax and ensure that you run Bazel commands in the workspace root (where `MODULE.bazel` is located).
</Accordion>
<Accordion title="Compiler Version or Standard Errors">
Confirm your C++ compiler supports C++17. Pass `--cxxopt=-std=c++17` on Bazel commands, or configure `.bazelrc` accordingly.
</Accordion>
<Accordion title="Tests Do Not Run or Output is Missing">
Use `--test_output=all` to stream test output directly to your terminal and diagnose runtime issues.
</Accordion>
</AccordionGroup>

---

Congratulations on successfully integrating GoogleTest using Bazel. Happy testing!

---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Official GoogleTest Documentation](https://google.github.io/googletest/)
- [Bazel Central Registry: googletest Module](https://registry.bazel.build/modules/googletest)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)
- [GoogleTest Primer](primer.md)


---

<Info>
This page fits within the Getting Started > Prerequisites & Installation section of the GoogleTest documentation, complementing the CMake installation page and first test guides.
</Info>


---

