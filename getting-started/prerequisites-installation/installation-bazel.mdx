---
title: "Installing with Bazel"
description: "Demonstrates how to add GoogleTest and GoogleMock as dependencies in Bazel-based projects, including repository setup and relevant Bazel build rule configuration."
---

# Installing with Bazel

This guide demonstrates how to add **GoogleTest** and **GoogleMock** as dependencies in Bazel-based projects. You will learn how to set up the Bazel workspace properly, configure Bazel build rules, and successfully build and run your first test binary using GoogleTest.

---

## 1. Prerequisites & System Requirements

Before integrating GoogleTest with Bazel, ensure the following prerequisites are met:

- **Operating System**: Linux, macOS, or Windows
- **C++ Compiler**: Supports at least C++17 (GCC, Clang, MSVC, etc.)
- **Bazel**: Version 7.0 or higher installed and operational

> For Bazel installation instructions, see the [Bazel installation guide](https://bazel.build/install).


## 2. Setup Your Bazel Workspace

A Bazel workspace is a directory where your source files and build files reside.

### Step 1: Create a workspace directory

Open your terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Define the `MODULE.bazel` file

To consume GoogleTest via Bazel Central Registry, create a file named `MODULE.bazel` in your workspace root with the following content:

```python
# MODULE.bazel

# Specify the version of GoogleTest to use
bazel_dep(name = "googletest", version = "1.17.0")
```

This declares GoogleTest as a dependency for your Bazel project.

<Tip>
Always check the [Bazel Central Registry](https://registry.bazel.build/modules/googletest) for the most current GoogleTest version before declaring dependencies.
</Tip>


## 3. Create Your First Test Binary

With your workspace set up, you can now write and build a simple test.

### Step 1: Write a basic test file

Create a file named `hello_test.cc` in your workspace directory with the following content:

```cpp
#include <gtest/gtest.h>

// A simple test case demonstrating GoogleTest assertions.
TEST(HelloTest, BasicAssertions) {
  // Expect that "hello" and "world" are not equal.
  EXPECT_STRNE("hello", "world");
  // Expect that 7 multiplied by 6 equals 42.
  EXPECT_EQ(7 * 6, 42);
}
```

### Step 2: Define the Bazel BUILD file

In the same directory, create a file called `BUILD` with the following rules:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This declares a test binary named `hello_test` which links against GoogleTest and sets up the entry point with `gtest_main`.

### Step 3: Build and run the test

Execute the following command to build and run the test with C++17 standard:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

You should see output indicating the test was run and passed:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.

//:hello_test                                                     PASSED in 0.1s
```

<Note>
Set the `--cxxopt` flag according to your compiler. For MSVC, use `--cxxopt=/std:c++17`.
</Note>


## 4. Understanding Bazel Build Rule Configuration

- **`cc_test` rule** creates an executable for your tests.
- The `deps` attribute points to the GoogleTest libraries provided by the Bazel Central Registry with labels:
  - `@googletest//:gtest` — GoogleTest core library
  - `@googletest//:gtest_main` — Provides the `main()` function to launch tests
- The `srcs` attribute lists source files compiled into this test binary.

Get familiar with Bazel build specifications and `cc_test` rule in the [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html).

<Tip>
If you want to use only GoogleTest as a library without the main function, depend on `@googletest//:gtest` alone and supply your own `main()` implementation.
</Tip>


## 5. Best Practices & Tips

- Always specify the C++ standard (`--cxxopt=-std=c++17` or equivalent) to avoid compatibility issues.
- Use a recent Bazel version (7.0+) to ensure compatibility with the module system and dependency management.
- Keep `MODULE.bazel` and workspace dependencies in sync with the supported versions listed in the Bazel Central Registry.
- Check the Bazel and GoogleTest documentation for platform-specific compiler flags, especially on Windows.


## 6. Troubleshooting Common Issues

<AccordionGroup title="Common Bazel Integration Issues">
<Accordion title="Build fails due to C++ standard mismatch">
Ensure you pass the correct compiler flag for C++17 in the Bazel test command:

```bash
bazel test --cxxopt=-std=c++17 //:hello_test
```

For MSVC, use:

```bash
bazel test --cxxopt=/std:c++17 //:hello_test
```

Missing this often leads to compilation errors or runtime failures.
</Accordion>

<Accordion title="Cannot find GoogleTest dependencies">
Verify that your `MODULE.bazel` includes the correct `bazel_dep` statement.

Make sure you are using Bazel 7.0 or newer, as prior versions do not support the Bazel Central Registry dependency declaration.

Also, ensure your `WORKSPACE` or module files do not conflict or redundantly declare GoogleTest dependencies.
</Accordion>

<Accordion title="Tests do not run or no output shown">
Use the `--test_output=all` flag when running tests to see complete output and diagnose failures:

```bash
bazel test --test_output=all //:hello_test
```

If tests still do not run, double-check that your `cc_test` rule and source files are correctly specified.
</Accordion>
</AccordionGroup>


## 7. Next Steps

- Explore writing your own tests using the [GoogleTest Primer guide](primer.md).
- Learn about advanced mocking techniques in [Writing Your First Mock](../guides/getting-started/writing-your-first-mock).
- Dive deeper into Bazel integration best practices in [Integrating with Build Systems](../guides/integration-and-best-practices/integrating-with-build-systems).


---

By following this guide, you have successfully added GoogleTest and GoogleMock to your Bazel project, built a test binary, and executed your first test. Continue expanding your tests and integrating them into your development workflow with confidence.

---

## Related Documentation

- [Quickstart: Building with Bazel](docs/quickstart-bazel.md)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)
- [Supported Platforms](platforms.md)
- [Installing with CMake](installation-cmake)
- [Writing Your First Test](writing-basic-test)
