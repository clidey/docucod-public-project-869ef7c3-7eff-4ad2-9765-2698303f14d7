---
title: "Installing with Bazel"
description: "Covers how to add GoogleTest as a dependency using Bazel build system. Ideal for users in organizations or open-source projects standardizing on Bazel for managing dependencies and builds."
---

# Installing with Bazel

This guide walks you through how to add GoogleTest as a dependency using the Bazel build system. It is tailored for users in organizations or open-source projects that standardize on Bazel for managing their dependencies and builds.

---

## 1. Prerequisites

Before you start, ensure your environment meets these requirements:

- **Operating system:** Compatible with Linux, macOS, or Windows.
- **Compiler:** A C++ compiler that supports at least C++17.
- **Bazel version:** Bazel 7.0 or newer.

For details on platform support, see the [Supported Platforms](platforms.md) page.

If Bazel is not installed, follow the [Bazel installation guide](https://bazel.build/install).

<Note>
The instructions use Unix shell style commands, but they also work on Windows command prompt.
</Note>

---

## 2. Set Up a Bazel Workspace

A Bazel workspace is a directory where you manage your source files and build configuration.

### Step 1: Create your workspace directory

Open a terminal and enter:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Configure GoogleTest dependency

Create a file named `MODULE.bazel` in your workspace root directory with the following content:

```python
# MODULE.bazel

# Specify the GoogleTest version to use
bazel_dep(name = "googletest", version = "1.17.0")
```

This configuration tells Bazel to fetch GoogleTest version 1.17.0 from the Bazel Central Registry.

---

## 3. Create and Run a Test Binary

Now you can write and execute tests using GoogleTest in your Bazel workspace.

### Step 1: Write a simple test

Create a file named `hello_test.cc` in the workspace root with this content:

```cpp
#include <gtest/gtest.h>

// A simple test case checking basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Strings should not be equal
  EXPECT_EQ(7 * 6, 42);              // Arithmetic equality
}
```

### Step 2: Create a Bazel BUILD file

Create a `BUILD` file in the same directory with the following content:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This defines a Bazel test target compiling your test file and linking against GoogleTest libraries.

### Step 3: Build and run the test

Run the following Bazel command to build and execute your test:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures the compiler uses C++17.
- `--test_output=all` shows all test logs.

### Expected output snippet:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
```

Your test binary should compile and run successfully, confirming GoogleTest is set up correctly.

<Check>
If the build or test fails:
- Verify Bazel and your compiler meet version requirements.
- Ensure `MODULE.bazel` and `BUILD` files have correct syntax.
- Confirm your environment supports C++17.
</Check>

---

## 4. Advanced Notes and Tips

### Setting the C++ standard

Bazel does not enforce C++17 by default. The `--cxxopt=-std=c++17` option instructs the compiler to use C++17, which is required by GoogleTest.

For MSVC users, use `--cxxopt=/std:c++17` instead.

### Dependency on `@googletest//:gtest_main`

The `gtest_main` target provides a main() function that initializes and runs the tests. If you want to write your own main(), link only against `@googletest//:gtest`.

### Workspace Layout

Use a consistent Bazel workspace layout as your project grows:

```
my_workspace/
├── MODULE.bazel
├── BUILD
├── hello_test.cc
└── <other source files>
```

### Continuous Integration

Integrate Bazel builds into your CI pipelines by caching Bazel output and running tests with `bazel test` commands similar to the above.

---

## 5. Next Steps

- Explore writing more complex tests by visiting the [GoogleTest Primer](primer.md).
- Learn about mock objects and using GoogleMock with GoogleTest.
- See the [Quickstart for CMake](quickstart-cmake.md) if using CMake instead.

---

## References and Further Reading

- [GoogleTest on Bazel Central Registry](https://registry.bazel.build/modules/googletest)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)
- [Supported Platforms](platforms.md)
- [GoogleTest Primer](primer.md)
- [GoogleTest Assertions](primer.md#assertions)

---

## Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Bazel Setup">
<Accordion title="Tests fail to compile due to C++ version errors">
Make sure you pass `--cxxopt=-std=c++17` for Clang or GCC, or `--cxxopt=/std:c++17` for MSVC when running Bazel commands.
</Accordion>
<Accordion title="Cannot find GoogleTest libraries or headers">
Verify that your `MODULE.bazel` file exists and contains the correct `bazel_dep` statement. Run `bazel sync` to fetch dependencies.
</Accordion>
<Accordion title="Linker errors related to runtime library mismatch on Windows">
This usually happens due to mismatch between static/dynamic CRT linking. Configure your build options to match GoogleTest's settings or customize compiler/linker flags accordingly.
</Accordion>
</AccordionGroup>

---

Congratulations on successfully adding GoogleTest to your Bazel workspace! Your next goal is to start writing comprehensive unit tests to improve code reliability and maintainability.

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/quickstart-bazel.md", "range": "1-108"}]} />