---
title: "Building and Configuring Your Project"
description: "Integrate GoogleTest and GoogleMock into your C++ build system. Learn about project configuration using CMake/Bazel or manual set up, and how to reference the necessary header files and libraries in your test projects."
---

# Building and Configuring Your Project

Integrating GoogleTest and GoogleMock into your C++ build system enables you to write and run effective tests for your code. This guide walks you through the steps to configure your test projects using popular build systems such as CMake and Bazel, as well as how to reference the required header files and link against the necessary libraries.

---

## 1. Prerequisites

Before configuring your project, ensure the following prerequisites are met:

- You have a working C++ development environment (compiler, linker, etc.)
- GoogleTest and GoogleMock source code is downloaded and accessible
- Familiarity with your build system (CMake or Bazel) or willingness to set up a manual build


## 2. Integration Using Build Systems

### 2.1 Using CMake

GoogleTest and GoogleMock can be integrated into your project as external dependencies or by including their source folders.

#### Step 1: Add GoogleTest to Your Project

You can add GoogleTest/GoogleMock as a subdirectory if you have the sources locally:

```cmake
add_subdirectory(path/to/googletest)  # Adjust path accordingly
```

This will build the gtest and gmock libraries.


#### Step 2: Link Your Test Target

Create your test executable and link against the gtest and gmock libraries:

```cmake
add_executable(my_test test_main.cpp my_tests.cpp)
target_link_libraries(my_test PRIVATE gtest gmock gtest_main)
```

- `gtest` and `gmock` provide the core testing and mocking functionality.
- `gtest_main` supplies a default `main()` function that initializes and runs all tests.


#### Step 3: Include Headers

Ensure your test source files include GoogleTest and GoogleMock headers:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>
```

The CMake build will automatically configure the include directories.


#### Step 4: Build and Run

Build your project with CMake as usual:

```bash
mkdir build && cd build
cmake ..
cmake --build .
./my_test
```


### 2.2 Using Bazel

GoogleTest and GoogleMock are supported out of the box by Bazel. Here's how to integrate:

#### Step 1: Declare Dependencies

In your `BUILD` file, declare dependencies on `@com_github_google_googletest`:

```starlark
cc_test(
    name = "my_test",
    srcs = ["my_test.cpp"],
    deps = [
        "@com_github_google_googletest//:gtest",
        "@com_github_google_googletest//:gmock",
        "@com_github_google_googletest//:gtest_main",
    ],
)
```


#### Step 2: Include Headers

Include the headers the same way as in CMake:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>
```


#### Step 3: Build and Run

Run your tests with Bazel:

```bash
bazel test //path/to:test_target
```


## 3. Manual Setup

If you are not using CMake or Bazel, manually add the GoogleTest and GoogleMock sources and headers to your project:


### Step 1: Add Source Files

Add the GoogleTest and GoogleMock source files to your build. You can find these in the `googletest` and `googlemock` directories respectively.


### Step 2: Update Include Paths

Reference the GoogleTest and GoogleMock include paths so your test project can find these headers:

- `-I path/to/googletest/include`
- `-I path/to/googlemock/include`


### Step 3: Link Libraries

Link against the compiled GoogleTest and GoogleMock object files or static libraries.


### Step 4: Include Headers in Your Tests

Include the following headers in your test files:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>
```


## 4. Referencing Headers and Libraries

For your test source files to recognize GoogleTest and GoogleMock symbols, make sure the following are true:

- Your include path must contain the `include` directories of both `googletest` and `googlemock`.
- Your link step must link against the `gtest`, `gmock`, and optionally `gtest_main` libraries (or their static/static equivalents).


## 5. Verifying Your Setup

Once configured and built:

- Write a simple test using `TEST()` or `TEST_F()` macros.
- Ensure your test compiles and links.
- Run the test binary, verifying all tests pass.

Example minimal test:

```cpp
#include <gtest/gtest.h>

TEST(SimpleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```


Troubleshooting:
- If the linker complains about missing GoogleTest symbols, verify correct library linkage.
- If includes fail, check include paths.


## 6. Best Practices and Tips

- Use `gtest_main` if you do not want to write your own `main()` function.
- Prefer build system integration to manual setup for maintainability.
- Organize your tests logically in your build files (CMakeLists.txt or BUILD).
- Use `target_link_libraries` or Bazel deps for clean dependency management.
- Watch out for version mismatches if using system-installed GoogleTest/GoogleMock.


## 7. Related Documentation

- [GoogleTest Primer](../primer.md) — For understanding GoogleTest basics.
- [GoogleMock for Dummies](../gmock_for_dummies.md) — Introduction to mocking.
- [gMock Cookbook](../gmock_cook_book.md) — Advanced mocking tips.
- [Integration and Dependencies Overview](../../overview/architecture-integration-usecases/integration-and-dependencies.mdx) — In-depth integration guidance.



---

**_Embedding this page in your test project build flow will give you a solid foundation to create, configure, and run tests leveraging GoogleTest and GoogleMock._**


---

<Check>
Double-check that your test binary can include `<gtest/gtest.h>` and `<gmock/gmock.h>`, link to the `gmock` and `gtest` libraries, and run a basic test without errors.
</Check>