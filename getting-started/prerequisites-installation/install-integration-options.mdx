---
title: "Installation & Integration Options"
description: "Detailed, step-by-step instructions for installing GoogleTest and GoogleMock using CMake or Bazel, with guidance for build integration. Covers fetching the code, configuring builds, and best practices for integrating with your project's build system."
---

# Installation & Integration Options

This guide provides detailed, step-by-step instructions for installing GoogleTest and GoogleMock using CMake or Bazel, along with advice for integrating these frameworks into your own project builds. Whether you want to build the libraries standalone, embed them within your project, or fetch them dynamically during build, this document will help you navigate the options and best practices.

---

## 1. Prerequisites & Requirements

Before installing GoogleTest and GoogleMock, ensure your environment meets the following:

- **C++ Standard**: Your compiler must support **C++17** or higher.
- **Supported Compilers & Platforms**: Refer to the [System Requirements & Supported Platforms](https://example.com/getting-started/prerequisites-installation/system-requirements) page to confirm compatibility.
- **Build Tools**:
  - For CMake builds: CMake version 3.13 or newer is required (CMake 3.14+ is needed if using `FetchContent_MakeAvailable`).
  - For Bazel: Ensure Bazel is installed and properly configured.
- **Network Access**: Required only if you fetch GoogleTest via CMakeâ€™s `FetchContent` or similar dynamic methods.

---

## 2. Installing GoogleTest and GoogleMock with CMake

GoogleTest and GoogleMock come with built-in CMake support enabling easy build and integration.

### 2.1 Standalone Build

Use this method if you want to compile the libraries separately and link them manually.

<Steps>
<Step title="Clone Repository">
Run:
```bash
  git clone https://github.com/google/googletest.git -b main
  cd googletest
```
</Step>
<Step title="Create and Enter Build Directory">
```bash
mkdir build
cd build
```
</Step>
<Step title="Generate Build Files with CMake">
- To build both GoogleTest and GoogleMock (default):
  ```bash
  cmake ..
  ```
- To build only GoogleTest (no GoogleMock):
  ```bash
  cmake .. -DBUILD_GMOCK=OFF
  ```
</Step>
<Step title="Build">
- On Unix-like systems:
  ```bash
  make
  ```
- On Windows Visual Studio:
  Open generated `gtest.sln` or `.vcxproj` files and build with your IDE.
- On Mac with Xcode:
  Open generated `.xcodeproj` project.
</Step>
<Step title="Optional: Install (Admin Required)">
```bash
sudo make install # Installs to /usr/local/ by default
```
</Step>
</Steps>

### 2.2 Embedding GoogleTest/GoogleMock Using `add_subdirectory()`

This method integrates GoogleTest directly into your project's CMake build:

1. Place GoogleTest source code in a subdirectory inside your project source tree, e.g., `third_party/googletest`.
2. In your `CMakeLists.txt`, add:
```cmake
add_subdirectory(third_party/googletest)
```
3. Link your test executable to the GoogleTest or GoogleMock targets:
```cmake
add_executable(my_tests tests.cpp)
target_link_libraries(my_tests gtest_main)   # For GoogleTest
# Or for GoogleMock
# target_link_libraries(my_tests gmock_main)
```

This approach ensures consistent compiler and linker settings between your project and GoogleTest.

### 2.3 Dynamic Fetching with `FetchContent`

For modern CMake projects (3.14+), GoogleTest can be downloaded automatically during configuration:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
# Prevents overriding compiler/linker settings on Windows
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_test tests.cpp)
target_link_libraries(my_test GTest::gtest_main)
add_test(NAME my_test COMMAND my_test)
```

<Tip>
Replace the URL with the release or commit you depend on and update regularly.
</Tip>

---

## 3. Installing with Bazel

GoogleTest and GoogleMock can be integrated into Bazel builds by referencing their Bazel targets. Refer to GoogleTest's Bazel documentation for detailed setup. Generally, you include the external dependencies in your Bazel workspace and reference their targets in your BUILD files.

---

## 4. Build Integration Best Practices

### 4.1 Linking Options

- Link test executables with either `gtest_main` or `gmock_main` to get a ready-made `main()` function.
- If you write your own `main()`, link with `gtest` or `gmock` instead.

### 4.2 Handling Shared vs Static Libraries on Windows

- By default, GoogleTest builds static libraries.
- To build shared libraries (DLLs), set the CMake option `BUILD_SHARED_LIBS=ON`.
- On Windows, you may need to adjust the runtime linkage via the `gtest_force_shared_crt` option to match your project settings.

### 4.3 Compiling with the Correct C++ Standard

Ensure your project and GoogleTest are both compiled with C++17 enabled.
For example, add the following CMake commands in your project to enforce:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### 4.4 Using pkg-config

GoogleTest installs pkg-config files to simplify integration:

```bash
pkg-config --cflags gtest
pkg-config --libs gtest
```

You can use these flags in any build system that supports pkg-config to compile and link against GoogleTest efficiently. See the [Pkg-config integration documentation](https://example.com/docs/pkgconfig) for details.

---

## 5. Troubleshooting Common Build Issues

<AccordionGroup title="Common Installation Issues">
<Accordion title="CMake Fails to Find GoogleTest">
- Verify the `googletest` directory path is correct if using `add_subdirectory()`.
- Make sure you have run `cmake` to generate build files before building.
- For `FetchContent`, ensure internet access and that you are using CMake 3.14+.
</Accordion>
<Accordion title="Runtime Library Mismatch on Windows">
- Use `-Dgtest_force_shared_crt=ON` with CMake to enable dynamic CRT linkage when your project uses dynamic runtimes.
- Ensure all parts of your project and GoogleTest use compatible runtime settings (static vs dynamic).
</Accordion>
<Accordion title="Compiler Errors Related to C++ Standard">
- Confirm compiler supports C++17.
- Explicitly set `CMAKE_CXX_STANDARD` to 17 or higher.
</Accordion>
</AccordionGroup>

---

## 6. Summary

By following the methods described above, developers can quickly install and integrate GoogleTest and GoogleMock with their projects using CMake or Bazel. These options provide flexibility for different workflows, from standalone builds to embedded or dynamically fetched dependencies.

For more examples on running your first tests and configuring projects, see the Getting Started guides and integration options in this documentation.

---

## 7. Additional Resources

- [GoogleTest Getting Started Guide](https://example.com/overview/quickstart-integration/getting-started)
- [Integration with Build Systems](https://example.com/overview/quickstart-integration/integration-options)
- [GoogleMock Introduction and Usage](https://example.com/guides/getting-started/first-mock-example)
- [Pkg-config Integration](https://example.com/docs/pkgconfig)
- Official GitHub Repository: [googletest](https://github.com/google/googletest)

---

## Appendix: Example CMakeLists.txt Snippet Embedding GoogleTest

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject LANGUAGES CXX)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp)
target_link_libraries(my_tests GTest::gtest_main)

enable_testing()
add_test(NAME my_tests COMMAND my_tests)
```

<Tip>
Replace `test_main.cpp` with your test source file(s). This example sets up an isolated environment where GoogleTest is fetched and linked automatically.
</Tip>
