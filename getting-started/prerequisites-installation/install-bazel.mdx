---
title: "Install with Bazel"
description: "Guidance for integrating GoogleTest and GoogleMock into your Bazel-based projects, including adding dependencies and configuring build files for the most seamless developer experience."
---

# Install with Bazel

Integrate GoogleTest and GoogleMock smoothly into your Bazel-based C++ projects with this step-by-step guide. Whether you're setting up a new workspace or incorporating testing into an existing one, these instructions cover adding dependencies, configuring build files, and running your first test binary using Bazel.

---

## 1. Prerequisites & System Requirements

Before proceeding, ensure you have:

- **Supported Platforms:** Linux, macOS, Windows are compatible.
- **C++ Compiler:** Must support at least C++17 (see [Supported Platforms](platforms.md)).
- **Bazel:** Version 7.0 or higher installed. Refer to [Bazel installation guide](https://bazel.build/install) if needed.

<Tip>
Ensure Bazel is correctly installed and accessible from your command line by running `bazel version` before starting.
</Tip>

---

## 2. Set Up Your Bazel Workspace

A Bazel workspace is a project directory where Bazel manages builds. Follow these steps to prepare it for GoogleTest:

<Steps>
<Step title="Create Workspace Directory">
Open your terminal and create a new directory for your workspace:

```bash
mkdir my_workspace && cd my_workspace
```
</Step>

<Step title="Create MODULE.bazel File">
To specify the GoogleTest dependency, create a file named `MODULE.bazel` in the workspace root. Add the following content:

```python
# MODULE.bazel

# Use the latest available version from https://registry.bazel.build/modules/googletest
bazel_dep(name = "googletest", version = "1.17.0")
```

This declares GoogleTest as a dependency via Bazel Central Registry.
</Step>
</Steps>

<Note>
If your project already uses a `WORKSPACE` file or other dependency management methods, Bazel's modern recommendation is to switch to the `MODULE.bazel` format for external dependencies for better modularity and version control.
</Note>

---

## 3. Create and Build Your First Test

After setting up the workspace, write your first test and configure Bazel to build it.

<Steps>
<Step title="Write a Simple Test">
In your workspace directory, create a file named `hello_test.cc` with this example code:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

This test confirms two basic assertions using GoogleTest.
</Step>

<Step title="Create BUILD File">
In the same directory, create a file named `BUILD` with the following content to define the test target:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This declares a C++ test target that compiles `hello_test.cc` and links against GoogleTest libraries.
</Step>

<Step title="Build and Run the Test">
Build and run the test with Bazel:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures the compiler uses C++17 standard.
- `--test_output=all` displays full test output on the console.

Upon success, you will see output confirming the test ran and passed.
</Step>
</Steps>

<Tip>
For MSVC users, replace `--cxxopt=-std=c++17` with `--cxxopt=/std:c++17` to specify the C++ version.
</Tip>

---

## 4. Best Practices & Tips for Bazel Integration

- **Keep GoogleTest Updated:** Regularly update the version in `MODULE.bazel` to benefit from bug fixes and new features.

- **Use Central Registry Versions:** Always use versions from the Bazel Central Registry for better compatibility.

- **Set Consistent C++ Standards:** Enforce C++17 in your whole project to avoid compatibility issues.

- **Run Tests Frequently:** Integrate test running into your CI pipelines using Bazel for continuous validation.

---

## 5. Troubleshooting Common Bazel Issues

<AccordionGroup title="Common Bazel Integration Issues">
<Accordion title="Bazel Command Not Found">
Ensure Bazel is installed and added to your system's PATH. Verify installation with:

```
bazel version
```

If this fails, install Bazel from https://bazel.build/install.
</Accordion>

<Accordion title="Compilation Errors Related to C++ Standard">
Make sure `--cxxopt=-std=c++17` is specified during `bazel test` or configured in your `.bazelrc` to enforce C++17 standard.
</Accordion>

<Accordion title="Dependency Not Found or Build Target Missing">
Check the `MODULE.bazel` file for correct dependency declaration and ensure your `BUILD` file references dependencies correctly with `@googletest//:gtest` and `@googletest//:gtest_main`.
</Accordion>
</AccordionGroup>

<Warning>
Bazelâ€™s caching might cause stale builds. Use `bazel clean` if you experience unexpected behavior.
</Warning>

---

## 6. Next Steps

- Explore the [GoogleTest Primer](primer.md) to learn how to write effective tests.
- Visit [Writing and Running Tests](../basic-setup-first-test/write-first-test.md) for deeper guidance on test coding and execution.
- For mocking dependencies, check [Add Your First Mock](../basic-setup-first-test/using-googlemock.md).

<Tip>
Consider adding your test commands to CI pipelines to automate quality checks on every change.
</Tip>

---

By following this guide, you have established a solid Bazel workspace with GoogleTest integration and built a working test case. This foundation enables you to build robust, maintainable C++ test suites powered by GoogleTest and Bazel.