---
title: "Installation: Bazel"
description: "Details installation using Bazel, tailored for users who use Google's preferred build tool. Walks through WORKSPACE setup, dependency management, and integrating tests with Bazel targets."
---

# Installation: Bazel

GoogleTest provides seamless integration with Bazel, Google’s preferred build system, enabling you to build, test, and manage dependencies efficiently. This guide walks you through setting up Bazel for GoogleTest, configuring your workspace, managing dependencies, and running your first test using Bazel targets.

---

## 1. Prerequisites

Before beginning the Bazel installation and setup, ensure you have the following:

- **Operating System:** A supported OS such as Linux, macOS, or Windows.
- **C++ Compiler:** One that supports at least C++17.
- **Bazel:** Version 7.0 or higher installed on your system. See Bazel’s official [installation guide](https://bazel.build/install) if you need to install.

<Tip>
If you haven't installed Bazel yet, follow the instructions specific to your OS on Bazel's documentation site to get started quickly.
</Tip>

---

## 2. Setting Up Your Bazel Workspace

A Bazel workspace is the root directory where you manage your project sources and dependencies.

### Step 1: Create Your Workspace Directory

Open your terminal or command prompt and execute:

```bash
mkdir my_workspace && cd my_workspace
```

This creates a new directory named `my_workspace` and navigates into it.

### Step 2: Define Dependencies Using `MODULE.bazel`

Starting from Bazel 7.0, use the Bazel Central Registry for dependency management, which replaces manually managing a `WORKSPACE` file.

Create a new file named `MODULE.bazel` in your `my_workspace` root directory with the following entry:

```python
# MODULE.bazel

bazel_dep(name = "googletest", version = "1.17.0")
```

This instructs Bazel to fetch GoogleTest version 1.17.0 automatically.

<Note>
Ensure that the version number is up-to-date by checking the [Bazel Central Registry for googletest](https://registry.bazel.build/modules/googletest).
</Note>

---

## 3. Creating and Running Your First Bazel Test

### Step 1: Write a Sample Test File

In the root of your workspace (`my_workspace`), create a file called `hello_test.cc` with the following content:

```cpp
#include <gtest/gtest.h>

// Demonstrate some basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Strings are not equal
  EXPECT_EQ(7 * 6, 42);              // Multiplication check
}
```

This simple test demonstrates GoogleTest’s basic assertion functionality.

### Step 2: Create a Bazel Build Target

Create a `BUILD` file in the same directory with the following specification:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

- `cc_test` declares the Bazel target as a testable C++ binary.
- The `deps` attribute links to GoogleTest’s `gtest` library and its test runner `gtest_main`.

### Step 3: Build and Run Your Test

Run the following command in your terminal:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

This command tells Bazel to build and test the target `hello_test` with C++17 standard, outputting all test log details.

### Expected Output

If successful, you will see an output similar to this excerpt:

```
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
INFO: Build completed successfully...
```

Congratulations! You've successfully built and run your first GoogleTest test using Bazel.

---

## 4. Managing Dependencies with WORKSPACE and `googletest_deps`

While using `MODULE.bazel` is recommended for Bazel 7.0+, some projects may still rely on a `WORKSPACE` file for dependency management:

### Sample `WORKSPACE` Snippet

```python
workspace(name = "googletest")

load("//:googletest_deps.bzl", "googletest_deps")
googletest_deps()

http_archive(
    name = "rules_python",
    sha256 = "2cc26bbd53854ceb76dd42a834b1002cd4ba7f8df35440cf03482e045affc244",
    strip_prefix = "rules_python-1.3.0",
    url = "https://github.com/bazelbuild/rules_python/releases/download/1.3.0/rules_python-1.3.0.tar.gz",
)

load("@rules_python//python:repositories.bzl", "py_repositories")
py_repositories()

http_archive(
  name = "bazel_skylib",
  sha256 = "cd55a062e763b9349921f0f5db8c3933288dc8ba4f76dd9416aac68acee3cb94",
  urls = ["https://github.com/bazelbuild/bazel-skylib/releases/download/1.5.0/bazel-skylib-1.5.0.tar.gz"],
)

http_archive(
    name = "platforms",
    urls = [
        "https://mirror.bazel.build/github.com/bazelbuild/platforms/releases/download/0.0.11/platforms-0.0.11.tar.gz",
        "https://github.com/bazelbuild/platforms/releases/download/0.0.11/platforms-0.0.11.tar.gz",
    ],
    sha256 = "29742e87275809b5e598dc2f04d86960cc7a55b3067d97221c9abbc9926bff0f",
)
```

This file will:

- Setup the `googletest_deps` repository helper to download dependencies
- Add important Bazel rules required for Python and platforms integration

<Tip>
Using the modern `MODULE.bazel` approach is preferred for new projects and better supports Bazel's module system (`bzlmod`).
</Tip>

---

## 5. Integrating Tests with Bazel Targets

GoogleTest includes multiple Bazel targets that simplify building and testing:

- `@googletest//:gtest` – The core GoogleTest library.
- `@googletest//:gtest_main` – Defines the main() function for tests.
- `@googletest//:gtest_for_library` – Alias for linking `gtest` in test-only libraries.

When defining your test targets, link to these appropriately as in the previous example.

---

## 6. Running Bazel Tests with Common Options

Use these recommended Bazel command options for building and testing:

| Option              | Description                                         |
|---------------------|-----------------------------------------------------|
| `--cxxopt=-std=c++17` | Enforce using C++17 standard for compatibility      |
| `--test_output=all`  | Show all test output, including passing tests       |
| `--enable_bzlmod=true`| Enable Bazel's module system for dependency management |
| `--keep_going`      | Continue building other targets when some fail      |

Example command:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all --enable_bzlmod=true //:hello_test
```

This ensures strict C++ standards and detailed logs during test runs.

---

## 7. Windows-Specific Notes

On Windows, Bazel requires additional setup for handling path lengths and toolchain specifics.

- Use the `--output_user_root` flag to specify a short Bazel output directory (e.g., `C:\tmp`) to avoid long path issues.
- Use the MSVC-compatible compilation flags such as `/std:c++17`.
- Optionally, enable Bazel Vendor mode with a local cached dependency archive to improve build stability and reduce external downloads.

A Windows-specific bazel test command might look like:

```batch
bazel test ... --output_user_root=C:\tmp --compilation_mode=dbg --copt=/std:c++17 --enable_bzlmod=true --keep_going --test_output=errors
```

---

## 8. Troubleshooting Bazel Installation

### Common Issues and Solutions

| Issue                                     | Solution                                             |
|-------------------------------------------|------------------------------------------------------|
| Bazel not found or command fails          | Make sure Bazel is installed and added to your PATH. |
| Build fails due to missing dependencies    | Verify `MODULE.bazel` or `WORKSPACE` is configured properly.
| Path-length errors on Windows              | Use `--output_user_root` with a short path.           |
| Test output is missing or incomplete       | Use `--test_output=all` or `--test_output=errors` for detailed logs.

<Warning>
If you encounter permission errors or unexpected build failures, run Bazel with elevated privileges or verify your developer environment installation.
</Warning>

---

## 9. Next Steps

- Explore [Writing and Running Your First Test](../initial-configuration-validation/writing-first-test.md) to learn test authoring.
- Review [Validating Your Setup](../initial-configuration-validation/validating-installation.md) to confirm test environment correctness.
- Consult the [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html) for advanced Bazel rules and workspace management.

---

For detailed usage, patterns, and integration examples, navigate the documentation hierarchy starting from the [Getting Started](../../getting-started/) section.


---

*Documentation generated with GoogleTest Bazel integration best practices.*