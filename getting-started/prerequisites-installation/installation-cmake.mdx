---
title: "Installing with CMake"
description: "Follow practical steps to install GoogleTest and GoogleMock using CMake, the preferred build system for most C++ users. This page includes quick commands, sample configuration, and validation steps to confirm a successful install."
---

# Installing with CMake

This guide walks you through installing **GoogleTest** and **GoogleMock** using **CMake**, the preferred and most widely used build system among C++ users. Follow these actionable steps to clone the repository, configure your build, compile the libraries, and verify your installation.

---

## 1. Prerequisites

Before starting, ensure your environment meets these requirements:

- **Supported Platforms:** Linux, macOS, Windows (see [Supported Platforms & Environments](https://github.com/google/googletest/blob/main/README.md#supported-platforms))
- **C++ Compiler:** Must support C++17 or later
- **CMake Version:** Minimum 3.13 (3.16 recommended for full compatibility)
- **Build Tools:** Make, Ninja, or your platform's native build system

<Tip>
If you need to install CMake, visit https://cmake.org/install for detailed installation instructions.
</Tip>

---

## 2. Clone the Repository

Start by cloning the GoogleTest repository from GitHub. You can pick a specific release tag or use the main branch.

```bash
# Clone the repository at the latest stable release (adjust version as needed)
git clone https://github.com/google/googletest.git -b main
cd googletest
```

---

## 3. Configure the Build with CMake

Create a separate build directory (to keep source and binary files organized) and run CMake to generate the build system files.

```bash
mkdir build
cd build
cmake ..
```

### Optional: Disable GoogleMock

If your use case requires **only GoogleTest**, disable GoogleMock with the following command:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

<Tip>
Use `ccmake ..` or `cmake-gui` if you prefer a graphical interface to toggle options like `BUILD_GMOCK` or `BUILD_SHARED_LIBS`.
</Tip>

---

## 4. Build the Libraries

Once configured, build the project using your chosen build tool. For example, with Make:

```bash
make
```

On Windows, open the generated Visual Studio solution file (`.sln`) and build.

---

## 5. Install (Optional)

If you want to install the libraries system-wide (requires appropriate permissions):

```bash
sudo make install
```

This will place headers and libraries in default system directories (usually `/usr/local`).

<Tip>
Installing allows other projects to find GoogleTest and GoogleMock via `find_package` commands.
</Tip>

---

## 6. Verify Your Installation

You can confirm that the libraries are built and installed correctly:

- Built binaries and libraries appear in your `build` directory.
- Headers are installed in standard include paths after installation.
- Run tests (GoogleTest’s own test suite) to ensure the build integrity.

### Run GoogleTest’s internal tests

This is a strong indication everything works:

```bash
ctest
```

or

```bash
make test
```

---

## 7. Use GoogleTest and GoogleMock in Your Projects

### Adding GoogleTest/GoogleMock as a subdirectory

Include GoogleTest or GoogleMock in your own CMake project by adding:

```cmake
add_subdirectory(path/to/googletest)
```

Then link your test executable with the targets `gtest_main`, `gtest`, `gmock_main`, or `gmock` as required:

```cmake
add_executable(my_tests tests.cpp)
target_link_libraries(my_tests gtest_main gmock)
```

### Alternatively, use `find_package`

If installed system-wide, you can find the package like this:

```cmake
find_package(GTest REQUIRED)
target_link_libraries(my_tests GTest::gtest_main GTest::gmock)
```

---

## 8. Common Configuration Options

- `BUILD_SHARED_LIBS` (default OFF): Build shared libraries instead of static.
- `gtest_force_shared_crt` (default OFF): On Windows, link runtime dynamically to match Visual Studio defaults.
- `gmock_build_tests` and `gtest_build_tests` (default OFF): Enable building GoogleMock/GoogleTest’s own tests.

Use these options with `-D` when running `cmake`, for example:

```bash
cmake .. -DBUILD_SHARED_LIBS=ON -Dgtest_build_tests=ON
```

---

## 9. Troubleshooting

<AccordionGroup title="Common Issues & Solutions">
<Accordion title="CMake Can't Find C++ Compiler or Incorrect Version">
Ensure your compiler supports C++17. Run `g++ --version` or `clang++ --version` to verify. Update your compiler if needed.
</Accordion>
<Accordion title="Linking Errors on Windows Related to Runtime Libraries">
Try enabling `gtest_force_shared_crt`:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```
This forces GoogleTest to link dynamically with the CRT to prevent mismatches.
</Accordion>
<Accordion title="Tests Don't Run After Building">
Make sure you have enabled testing with `enable_testing()` in your project CMakeLists.txt and run `ctest` or `make test` from your build directory.
</Accordion>
<Accordion title="Build Fails Due to Pthreads on MinGW">
GoogleTest disables pthread support on MinGW by default. You can disable pthreads explicitly with:

```bash
cmake .. -Dgtest_disable_pthreads=ON
```
</Accordion>
</AccordionGroup>

---

## Additional Resources

- [google/googletest GitHub Repository](https://github.com/google/googletest)
- [Getting Started: Integration & Your First Test](https://github.com/google/googletest/blob/main/docs/quickstart-cmake.md)
- [Pkg-config Support & Usage](https://github.com/google/googletest/blob/main/docs/pkgconfig.md)
- [CMake Tutorial](https://cmake.org/cmake/help/latest/guide/tutorial/index.html)


---

## Summary

This page provides a clear, step-by-step walkthrough on installing GoogleTest and GoogleMock using CMake. You'll learn how to clone sources, configure builds, compile, install, and verify your installation. Troubleshooting tips and usage patterns ensure a smooth onboarding.

Start here if you want to effortlessly add unit testing support to your C++ projects with GoogleTest.

---