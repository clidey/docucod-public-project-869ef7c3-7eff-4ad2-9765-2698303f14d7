---
title: "Installation: CMake & Bazel"
description: "Follow clear, platform-specific instructions to install GoogleTest and GoogleMock with CMake or Bazel. Includes cloning the repository, configuring your build system, and linking the libraries. Covers quick validation steps for each method."
---

# Installation: CMake & Bazel

This guide helps you install and integrate GoogleTest and GoogleMock using the two main build systems supported: **CMake** and **Bazel**. Follow the platform-specific instructions to clone the source, configure your build environment, and validate your setup by building and running a test binary.

---

## Table of Contents

1. [Prerequisites](#prerequisites)
2. [Installing with CMake](#installing-with-cmake)
   - Standalone Build
   - Incorporating GoogleTest in Your Project
   - Building and Running Your First Test
3. [Installing with Bazel](#installing-with-bazel)
   - Setting Up Bazel Workspace
   - Creating and Running Test Binaries
4. [Troubleshooting and Tips](#troubleshooting-and-tips)
5. [Next Steps](#next-steps)

---

## Prerequisites

Before you begin, ensure the following:

- **Operating System:** Linux, macOS, or Windows
- **Compiler:** C++ compiler supporting **C++17** or later
- **Build tools:**
  - For CMake: [CMake](https://cmake.org/) ≥ 3.13 and a compatible build tool (Make, Ninja, Visual Studio, Xcode)
  - For Bazel: [Bazel](https://bazel.build/) ≥ 7.0

See the [Supported Platforms](https://github.com/google/googletest/blob/main/docs/platforms.md) page for detailed platform and compiler compatibility.

<Tip>
Ensure your compiler supports C++17. If your build system defaults to an older standard, be sure to explicitly request C++17 (instructions shown below).
</Tip>

---

## Installing with CMake

### 1. Clone the Repository

Download the stable release (example uses v1.17.0):

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
git clone outputs folder `googletest`
```

### 2. Build GoogleTest and GoogleMock Standalone

From the `googletest` directory, create a build directory, then generate build files and compile:

```bash
cd googletest
mkdir build
cd build
cmake ..
```

- To build **only GoogleTest (excluding GoogleMock)**, run:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

#### Build & Install

- On **Linux/macOS** (with Make):

```bash
make
sudo make install  # Installs to /usr/local/ by default
```

- On **Windows** with Visual Studio:

Open the generated `.sln` file in the build directory and build the solution.

- On **macOS** with Xcode:

Open the generated `.xcodeproj` file in Xcode and build.

### 3. Integrate GoogleTest into Your Own CMake Project

To add GoogleTest as a dependency to an existing project, use one of these approaches:

#### A. Use Installed GoogleTest Libraries

Add this to your `CMakeLists.txt`:

```cmake
find_package(GTest CONFIG REQUIRED)

add_executable(your_test your_test.cc)
target_link_libraries(your_test GTest::gtest_main)
enable_testing()
gtest_discover_tests(your_test)
```

This assumes GoogleTest is installed on your system.

#### B. Fetch GoogleTest During Configure Step

This approach downloads GoogleTest automatically during your build configure.

Add the following to your `CMakeLists.txt`:

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
# For Windows: Use shared CRT to avoid runtime conflicts
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

> **Note:** This requires CMake 3.14 or later.

### 4. Build and Run Your First Test Binary with CMake

Assuming you have an example test source (e.g., `hello_test.cc`):

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

Add the following snippet to your `CMakeLists.txt`:

```cmake
enable_testing()

add_executable(hello_test hello_test.cc)
target_link_libraries(hello_test GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

Then build and test:

```bash
cmake -S . -B build
cmake --build build
cd build
ctest
```

Expected output:

```
Test project /path/to/build
 1/1 Test #1: HelloTest.BasicAssertions .......   Passed    0.00 sec

100% tests passed, 0 tests failed
```

Congratulations — your CMake setup with GoogleTest is working!

---

## Installing with Bazel

### 1. Set Up a Bazel Workspace

Create a new directory and initialize your Bazel workspace:

```bash
mkdir my_workspace && cd my_workspace
```

Create a file named `MODULE.bazel` with this content:

```python
# MODULE.bazel
bazel_dep(name = "googletest", version = "1.17.0")
```

This will declare GoogleTest as a dependency using Bazel's Central Registry.

### 2. Add a Test Source File

Create `hello_test.cc` with the following contents:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

### 3. Create a Bazel BUILD File

Create a `BUILD` file alongside `hello_test.cc` with the following:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This rule defines a C++ test executable linked to GoogleTest libraries.

### 4. Build and Run the Test

Build and run the test with:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

You should see output similar to:

```
INFO: Analyzed target //:hello_test (26 packages loaded, 362 targets configured).
INFO: Found 1 test target...
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
================================================================================
//:hello_test                                                     PASSED in 0.1s
```

Success! Your Bazel workspace is configured to build and run GoogleTest tests.

---

## Troubleshooting and Tips

### Common Issues

- **Compiler errors about C++ standard:**
  - Explicitly set C++17 support in CMake with `set(CMAKE_CXX_STANDARD 17)`.
  - For Bazel, add `--cxxopt=-std=c++17` when building.

- **Runtime linkage conflicts on Windows:**
  - When using Visual Studio, use the `gtest_force_shared_crt` CMake option to match runtime linkage.

- **Missing pthread library errors:**
  - For custom builds, make sure to link pthread (Linux/macOS).
  - GoogleTest CMake scripts manage pthread flags automatically.

- **Build tool not found:**
  - Verify CMake installation and your system PATH.
  - For Bazel, ensure Bazel is installed and correctly configured.

### Best Practices

- Always isolate GoogleTest as part of your project dependencies via `FetchContent` or external Bazel dependencies.
- Build GoogleTest and your project with consistent compiler flags to avoid runtime conflicts.
- Use CMake's `gtest_discover_tests()` for seamless test detection and execution.

<Tip>
If you encounter linker errors about conflicting runtimes on Visual Studio, enabling `gtest_force_shared_crt` resolves most issues by forcing dynamic runtime linkage.
</Tip>

---

## Next Steps

- Explore the [Write and Run Your First Test](https://github.com/google/googletest/blob/main/docs/primer.md) guide to learn test construction and assertions.
- Visit the [Integration with Your Build System](getting-started/prerequisites-installation/integration-build-systems) page to tailor GoogleTest integration to different build environments.
- Review [Troubleshooting Installation & Running Tests](getting-started/first-steps-validation/troubleshooting-common-issues) for help on common build and runtime problems.
- Dive into advanced usage with [Parameterized Tests](guides/gtest-core-workflows/parameterized-testing) and [Mocking with GoogleMock](guides/gmock-mocking-patterns/creating-mocks).


---

For comprehensive platform support and detailed compiler requirements, see [Supported Platforms](https://github.com/google/googletest/blob/main/docs/platforms.md).

For additional examples and feature deep-dives, the [Feature Overview](overview/core-concepts-and-capabilities/feature-overview) is an excellent resource.


---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [CMake Official Site](https://cmake.org/)
- [Bazel Official Site](https://bazel.build/)
- [CMake FetchContent Documentation](https://cmake.org/cmake/help/latest/module/FetchContent.html)
- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [GoogleTest Quickstart: CMake](docs/quickstart-cmake.md)
- [GoogleTest Quickstart: Bazel](docs/quickstart-bazel.md)