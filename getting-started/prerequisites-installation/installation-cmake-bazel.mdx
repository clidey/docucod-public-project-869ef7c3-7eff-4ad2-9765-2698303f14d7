---
title: "Installation (CMake, Bazel, and Manual)"
description: "Step-by-step installation instructions for the most common build systems: CMake and Bazel. Includes guidance for manual builds and explains how to incorporate GoogleTest and GoogleMock into a new or existing C++ project. Highlights typical file structures and build invocation."
---

# Installation (CMake, Bazel, and Manual)

This guide leads you through installing GoogleTest and GoogleMock using the most common build systems: CMake and Bazel. There are also instructions for manual builds and guidance on integrating these testing libraries into new or existing C++ projects. Follow these step-by-step instructions to set up your environment effectively.

---

## 1. Prerequisites & System Requirements

Before you begin, ensure your system meets the following requirements:

- **Operating System:** Linux, macOS, Windows, or other supported platforms.
- **C++ Compiler:** Must support **C++17** standard or later.
- **Build Tools:** 
  - For CMake: CMake 3.13 or later, plus a compatible native build tool such as Make, Ninja, Visual Studio, or Xcode.
  - For Bazel: Bazel 7.0 or higher.

> See the [System Requirements & Prerequisites](../prerequisites-installation/system-requirements) page for detailed compatibility and setup.

---

## 2. Installing with CMake

GoogleTest can be built either as a standalone project or integrated into your existing CMake projects. Below are comprehensive instructions for both scenarios.

### 2.1 Standalone Installation

Follow these steps to build and install GoogleTest and GoogleMock using CMake:

<Steps>
<Step title="Clone GoogleTest Repository">
Open a terminal and clone the GoogleTest repository with a stable release tag:

```bash
$ git clone https://github.com/google/googletest.git -b v1.17.0
downloads the source code.
$ cd googletest
```
</Step>

<Step title="Create and Enter Build Directory">
Create a dedicated build output directory to keep build files separate:

```bash
$ mkdir build
$ cd build
```
</Step>

<Step title="Generate Build Files">
Run CMake to configure the project.

To build both GoogleTest and GoogleMock (default):

```bash
$ cmake ..
```

Or to build only GoogleTest (without GoogleMock samples):

```bash
$ cmake .. -DBUILD_GMOCK=OFF
```

If you use Visual Studio on Windows, CMake will generate `.sln` solution files.
</Step>

<Step title="Build the Libraries">
Start the build process using Make or your native build tool.

On Unix-like systems:

```bash
$ make
```

On Windows with Visual Studio:

Use the generated solution file or run:

```bash
$ cmake --build . --config Release
```
</Step>

<Step title="(Optional) Install Libraries">
You can install the built libraries system-wide. Administrator or root privileges are required.

```bash
$ sudo make install
```
This installs headers and libraries typically under `/usr/local/`.
</Step>
</Steps>

#### Verifying CMake Installation

Verify successful installation by checking the existence of libraries and header files in your install prefix (e.g., `/usr/local/lib/libgtest.a`, `/usr/local/include/gtest/gtest.h`).

<Tip>
If your build fails due to missing pthreads or threading libraries, ensure your system has developer tools installed and you invoke CMake using a compatible compiler.
</Tip>

---

### 2.2 Integrating GoogleTest into an Existing CMake Project

You have two main options for incorporating GoogleTest as a dependency:

1. **Use Installed GoogleTest via find_package**

If you installed GoogleTest system-wide, add to your `CMakeLists.txt`:

```cmake
find_package(GTest CONFIG REQUIRED)
```

Then link your tests with `GTest::gtest` or `GTest::gtest_main`:

```cmake
add_executable(my_test my_test.cc)
target_link_libraries(my_test PRIVATE GTest::gtest_main)
```

2. **Add GoogleTest as a Subdirectory Using FetchContent**

This approach downloads GoogleTest automatically during your project build to ensure version consistency:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
# On Windows, avoid conflicts with runtime linkage
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_test my_test.cc)
target_link_libraries(my_test PRIVATE gtest_main)
```

This requires CMake version 3.14 or above.

---

### 2.3 Common CMake Configuration Options

- `gtest_force_shared_crt` (Default OFF): Use shared runtime libraries on Windows to match your project settings.
- `gtest_build_tests` (Default OFF): Build GoogleTest's own tests.
- `gtest_build_samples` (Default OFF): Build sample programs demonstrating usage.

Customize these options by passing `-D` flags during CMake configuration.

---

## 3. Installing with Bazel

Bazel is Google's official supported build system for GoogleTest. Follow these steps to set it up.

### 3.1 Setup Bazel Workspace

Create a workspace directory:

```bash
$ mkdir my_workspace && cd my_workspace
```

Create a `MODULE.bazel` file with the following content to declare the dependency:

```python
# MODULE.bazel

bazel_dep(name = "googletest", version = "1.17.0")
```

### 3.2 Write Your Test Source and BUILD File

Create a simple test source file `hello_test.cc` in your workspace containing:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

Create a `BUILD` file referencing the GoogleTest dependencies:

```
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

### 3.3 Build and Run Tests

From the workspace root, run:

```bash
$ bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

You should see output confirming the test ran and passed successfully.

<Tip>
Use `--cxxopt=/std:c++17` on Windows with MSVC to specify the C++17 standard.
</Tip>

---

## 4. Manual Build (Without CMake or Bazel)

If you prefer to compile GoogleTest manually, here is the minimal process:

1. **Download or clone the source:**

```bash
$ git clone https://github.com/google/googletest.git
$ cd googletest
```

2. **Compile the GoogleTest source files:**

Using your compiler, build `src/gtest-all.cc`:

```bash
$ g++ -std=c++17 -isystem ./include -pthread -c src/gtest-all.cc -o gtest-all.o
```

3. **Archive into a static library:**

```bash
$ ar -rv libgtest.a gtest-all.o
```

4. **Compile your test source and link:**

```bash
$ g++ -std=c++17 -isystem ./include -pthread your_test.cc libgtest.a -o your_test
```

5. **Run your test executable:**

```bash
$ ./your_test
```

<Tip>
Manual builds require you to manage all compiler flags and dependencies explicitly. It is recommended to use CMake or Bazel for easier and consistent builds.
</Tip>

---

## 5. Running Your First Test

After installation, itâ€™s critical to verify your setup with a simple test binary.

Using CMake or Bazel, compile the simple test example as shown in sections 2 and 3.

Once built, run your test executable or invoke the test runner:

- For CMake:

```bash
$ ctest
```

- For Bazel:

```bash
$ bazel test //:hello_test
```

A successful run will show test passing results.

---

## 6. Troubleshooting Common Issues

<Tip>
If you encounter build failures:

- Ensure your compiler supports C++17.
- For CMake, confirm you are using an appropriate build generator (e.g., Ninja, Makefiles, Visual Studio).
- On Windows, check runtime library mismatch errors and try setting `-Dgtest_force_shared_crt=ON`.
- Confirm required threading libraries (like pthread) are installed and linked.
</Tip>

---

## 7. Next Steps

- Explore the [Writing and Building Your First Test](../first-steps/writing-first-test) guide to start writing productive tests.
- Learn interpretation of [Running Test Results](../first-steps/running-tests).
- Consult the [Common Installation Issues](../troubleshooting-common-issues/common-installation-issues) for more troubleshooting.


---

## References and Additional Resources

- Official GoogleTest repo: [https://github.com/google/googletest](https://github.com/google/googletest)
- CMake documentation: [https://cmake.org/cmake/help/latest/](https://cmake.org/cmake/help/latest/)
- Bazel build system: [https://bazel.build/](https://bazel.build/)

---

## See Also

- [System Requirements & Prerequisites](../prerequisites-installation/system-requirements)
- [Quickstart: Building with CMake](../../docs/quickstart-cmake.md)
- [Quickstart: Building with Bazel](../../docs/quickstart-bazel.md)
- [Writing and Building Your First Test](../first-steps/writing-first-test)
- [Common Installation & Setup Issues](../troubleshooting-common-issues/common-installation-issues)
