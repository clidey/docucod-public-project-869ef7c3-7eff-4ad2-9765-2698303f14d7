---
title: "Using Alternative Build Systems"
description: "Details options for integrating GoogleTest and GoogleMock with build systems such as Bazel, and pkg-config. Addresses workflows for existing projects that use different build tools, helping users adopt GoogleTest into diverse environments with minimal friction."
---

# Using Alternative Build Systems

This guide helps you integrate GoogleTest and GoogleMock with alternative build systems such as Bazel and pkg-config. It is designed for existing projects that use different build tools and want to adopt GoogleTest with minimal disruption.

---

## 1. Overview

GoogleTest and GoogleMock are flexible C++ testing and mocking frameworks that can be incorporated into diverse build environments. While CMake is the officially supported build system and provides the most straightforward integration, many projects have their own build infrastructures like Bazel or pkg-config-based setups.

This page provides detailed workflows and recommendations to enable seamless integration of GoogleTest into your preferred build system, ensuring you can write, build, and run tests effectively.

---

## 2. Using GoogleTest and GoogleMock with Bazel

Bazel is a popular build system that manages dependencies and builds for projects with large codebases.

### Step 1: Add GoogleTest as an External Dependency

- Add GoogleTest and GoogleMock repositories as external dependencies in your `WORKSPACE` file:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.17.0.tar.gz"],
    strip_prefix = "googletest-release-1.17.0",
)
```

### Step 2: Reference GoogleTest Targets

- In your `BUILD` files, depend on `@com_google_googletest//:gtest` and `@com_google_googletest//:gmock` as needed:

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main", "@com_google_googletest//:gmock"],
)
```

### Step 3: Write Tests as Usual

- Use your GoogleTest and GoogleMock headers (e.g., `#include <gtest/gtest.h>`, `#include <gmock/gmock.h>`) in your test code.

### Step 4: Build and Run

- Run `bazel test //path/to:my_test`.


<Note>
Bazel's hermetic environment helps avoid library mismatches, but ensure that your Bazel toolchain supports C++17 standard to build GoogleTest successfully.
</Note>

---

## 3. Using pkg-config with GoogleTest/GoogleMock

GoogleTest and GoogleMock come with `.pc` files (`gtest.pc`, `gmock.pc`, `gmock_main.pc`) that can facilitate integration into pkg-config enabled build systems.

### Step 1: Install GoogleTest Libraries and pkg-config Files

- After building GoogleTest/GoogleMock via CMake or your preferred method, run `make install` or your equivalent install command.
- The pkg-config files will be installed into a directory like `/usr/local/lib/pkgconfig/`.

### Step 2: Configure Your Build to Use pkg-config

- Use `pkg-config` to query compile and link flags in your build scripts. For example:

```bash
pkg-config --cflags gmock_main
pkg-config --libs gmock_main
```

- Include the cflags and libs output from pkg-config in your compile and link steps.

### Step 3: Sample Compile Command

```bash
g++ my_test.cc $(pkg-config --cflags --libs gmock_main) -pthread -o my_test
```

### Step 4: Linking Notes

- Use `gmock_main.pc` if you want to link the GoogleMock library along with the main() function provided by the library to simplify your test binary.
- If you provide your own main(), link with `gmock.pc` or `gtest.pc` as appropriate.


<Tip>
When using pkg-config, verify that the `PKG_CONFIG_PATH` environment variable includes the directory containing GoogleTest `.pc` files if they are installed in a non-standard location.
</Tip>

---

## 4. Incorporating GoogleTest Into Other Build Systems

### General Guidance

- Locate GoogleTest/GoogleMock headers and libraries in your environment.
- Add include paths for headers: usually under `include/gtest` and `include/gmock` subdirectories.
- Link against the appropriate libraries: `gtest`, `gtest_main`, `gmock`, and/or `gmock_main`.
- Remember to define `-DGTEST_HAS_PTHREAD=1` when compiling if your environment uses pthreads.
- If your build system supports environment or macro definitions, use them to control features such as shared vs static library builds (`GTEST_CREATE_SHARED_LIBRARY`), exception support, etc.

### Example Using Static Linking

- Specify include path:

```
-I/path/to/googletest/include
```

- Link libraries:

```
-L/path/to/googletest/lib -lgmock_main -lpthread
```

- Compile flags:

```
-DGTEST_HAS_PTHREAD=1
```

---

## 5. Verification and Troubleshooting

### Verify Linkage

After integration, build a test that uses GoogleTest or GoogleMock and check that:

- The compiler finds all necessary headers.
- The linker resolves all GoogleTest/GoogleMock symbols.

### Common Pitfalls

- **Missing pthread flag:** GoogleTest requires pthread support on POSIX systems. Omitting `-pthread` or equivalent linker flags will cause unresolved references.
- **Mismatched runtimes (Windows):** Ensure that runtime linkage (static vs dynamic) matches between your tests and GoogleTest libraries.
- **Pkg-config paths:** If pkg-config cannot locate GoogleTest `.pc` files, you must update `PKG_CONFIG_PATH` accordingly.

### Troubleshooting Steps

- Check your compiler's include and library paths.
- Enable verbose build output to trace compiler and linker commands.
- Confirm that GoogleTest version matches across your project.
- For Bazel, verify that the external repository is correctly declared and reachable.

---

## 6. Additional Tips and Best Practices

- Whenever possible, prefer building GoogleTest and GoogleMock from source as part of your build system to ensure ABI compatibility and consistent compile options.
- Keep GoogleTest updated in your external dependencies to access the latest features and patches.
- Use the `gmock_main` library to simplify test main() integration unless you have a custom main.
- Use C++17 or later as GoogleTest requires this standard.
- Review build system documentation for exact methods to consume pkg-config or external repository dependencies.

---

## 7. References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest CMake Integration Guide](https://github.com/google/googletest/blob/main/README.md)
- [GoogleMock Framework Overview](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [GoogleTest Primer and Guides](https://google.github.io/googletest/)
- [GoogleTest Troubleshooting Guide]( /getting-started/troubleshooting-faq/troubleshooting-setup-issues)

---

This page fits into the Getting Started documentation under Prerequisites & Installation, complementing platform-specific installation guides and core build instructions, ensuring users can adopt GoogleTest regardless of their project's build environment.


