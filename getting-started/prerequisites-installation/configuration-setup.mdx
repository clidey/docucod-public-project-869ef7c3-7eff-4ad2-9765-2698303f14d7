---
title: "Configuring GoogleTest in Your Project"
description: "Set up GoogleTest within your project, including recommended directory structure and necessary CMake or build file modifications. Learn how to link GoogleTest, organize your tests, and prepare for building and running them reliably."
---

# Configuring GoogleTest in Your Project

Set up GoogleTest within your project, including recommended directory structure and necessary CMake or build file modifications. Learn how to link GoogleTest, organize your tests, and prepare for building and running them reliably.

---

## 1. Preparing Your Project Structure

Before integrating GoogleTest, arrange your project directory for clear separation between production code and tests. This promotes consistency, maintainability, and easy build configuration.

### Recommended Directory Layout
```plaintext
/project-root
  /src               # Your production source code
  /include           # Headers for your production code
  /tests             # All your test code, including GoogleTest files
    /googletest      # GoogleTest source (if vendored)
    /your_tests      # Your test implementations
  CMakeLists.txt     # Root CMake build file
```

Having `/tests` as the dedicated test folder keeps test code isolated and makes it easier to manage dependencies specific to testing.

<Check>
Keeping tests in a dedicated folder simplifies build integration and prevents accidental mixing of production code and test code.
</Check>

## 2. Integrating GoogleTest into Your Build System

This guide focuses on using CMake, the recommended and widely supported build system for GoogleTest projects.

### 2.1 Adding GoogleTest to Your CMake Build

You have two main options to include GoogleTest:

- **Vendored Source**: Include the GoogleTest source inside your `/tests/googletest` directory.
- **External Fetch**: Use CMakeâ€™s `FetchContent` module to clone and build GoogleTest at configure time.

### 2.2 Vendored Source Setup

Add GoogleTest source code into your repository under `/tests/googletest`.

In your root `CMakeLists.txt`, add:
```cmake
# Add the GoogleTest subdirectory.
add_subdirectory(tests/googletest)

# Create your test executable.
add_executable(your_test_exe tests/your_tests/your_test.cc)

# Link GoogleTest libraries.
target_link_libraries(your_test_exe gtest gtest_main)

# Enable testing features.
enable_testing()
add_test(NAME YourTest COMMAND your_test_exe)
```

### 2.3 FetchContent Setup (External Download)

If you prefer CMake to download GoogleTest automatically:
```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.12.1.tar.gz
)

# For Windows: Prevent overriding the parent project's compiler/linker settings
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

add_executable(your_test_exe tests/your_tests/your_test.cc)
target_link_libraries(your_test_exe gtest_main)

enable_testing()
add_test(NAME YourTest COMMAND your_test_exe)
```

<Note>
Replace the version URL with the desired stable GoogleTest release.
</Note>

## 3. Linking GoogleTest Properly

GoogleTest provides two main libraries to link:

- **gtest**: The core GoogleTest library.
- **gtest_main**: Provides the main function (`main`) for test binaries with default setup.

### Best Practice: Link to `gtest_main` for Convenience

Link your test executable against `gtest_main` unless you plan to provide your own `main()`.

```cmake
target_link_libraries(your_test_exe gtest_main)
```

If you wish to customize test initialization, link only `gtest` and define your own `main()` calling `InitGoogleTest()`.

## 4. Organizing Your Test Files

### Location

Place your test source files under `/tests/your_tests/`. This can include both unit tests and any integration tests.

### Typical Test File Naming

Use a consistent naming scheme like `*_test.cc` or `*_unittest.cc`.

Example:
```plaintext
/tests/your_tests/calculator_test.cc
/tests/your_tests/parser_unittest.cc
```

### Include GoogleTest in Test Files

Each test source file typically starts with:
```cpp
#include <gtest/gtest.h>
```

Or if you also use GoogleMock features:
```cpp
#include <gmock/gmock.h>
```

## 5. Building and Running Your Tests

### CMake Build

1. From your project root, create a build directory:

```bash
mkdir build
cd build
cmake ..
cmake --build .
```

2. After build, run your tests:

```bash
./your_test_exe
``` 

or with CTest:

```bash
ctest
```

This will execute all tests added via `add_test()` in your CMake configuration.

## 6. Advanced Configuration Tips

### Custom User `main()`

If your test binary needs to do special setup or pass arguments before GoogleTest runs, define your own `main()`:

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  // Additional setup here
  return RUN_ALL_TESTS();
}
```

In this case, link only `gtest`, not `gtest_main`.

### Linking GoogleMock

If you use GoogleMock features, also link `gmock` and `gmock_main` (similar to `gtest` and `gtest_main`).

Example:
```cmake
target_link_libraries(your_test_exe gmock_main)
```

### Using External Build Tools

If your project builds with tools other than CMake (e.g., Bazel, Make), ensure you:

- Add GoogleTest or GoogleMock source tree or packages as dependencies
- Include necessary compiler flags (C++11 or higher)
- Link the relevant GoogleTest and GoogleMock libraries

Refer to the official GoogleTest installation guide for platform-specific guidance.

## 7. Common Pitfalls and How to Avoid Them

<AccordionGroup title="Troubleshooting Configuration Issues">
<Accordion title="GoogleTest Not Found or Cannot Link">
- Ensure you added GoogleTest source or FetchContent in CMake correctly.
- Confirm `target_link_libraries()` includes `gtest` and/or `gtest_main`.
- Verify you are using a compatible compiler and C++ standard (C++11 or newer).
</Accordion>
<Accordion title="Tests Compile but Do Not Run or Show No Output">
- Check that you enabled testing in CMake with `enable_testing()`.
- Make sure `add_test()` is called for your test executables.
- Confirm you run the correct test binary.
</Accordion>
<Accordion title="Multiple Definition of Main Function">
- Only link `gtest_main` or `gmock_main` **or** provide your own `main()`; not both.
</Accordion>
<Accordion title="Header Not Found Errors">
- Confirm the include path contains GoogleTest headers.
- If vendoring GoogleTest, include its root directory in your project's include paths.
</Accordion>
</AccordionGroup>

## 8. Example CMakeLists.txt Snippet

```cmake
cmake_minimum_required(VERSION 3.10)
project(ExampleProject LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Fetch GoogleTest
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.12.1.tar.gz
)
FetchContent_MakeAvailable(googletest)

enable_testing()

# Add your test executable
add_executable(example_test tests/example_test.cc)

target_link_libraries(example_test gtest_main)

add_test(NAME ExampleTest COMMAND example_test)
```

---

<Info>
For detailed instructions about installation, system requirements, and building from sources, see the [Installation (All Platforms)](/getting-started/prerequisites-installation/installation-platforms) and [System Requirements](/getting-started/prerequisites-installation/system-requirements) pages.
</Info>


---

## Further Reading & Next Steps

- **Writing Your First Test**: Learn how to write and run your first GoogleTest-based test case.
- **Using GoogleMock**: Set up and use GoogleMock for mocking dependencies in tests.
- **Troubleshooting Setup Issues**: Common issues and their solutions during setup.

Refer to the [Quickstart & Typical Workflow](/overview/getting-started-integration/quickstart-workflow) page for a fast onboarding guide.

---