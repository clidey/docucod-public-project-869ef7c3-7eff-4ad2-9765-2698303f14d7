---
title: "Configuration Basics"
description: "Explains essential configuration and environment setup, including integrating GoogleTest into projects, necessary include paths, build flags, and linking libraries. Provides baseline code snippet for initializing GoogleTest in a new or existing project."
---

# Configuration Basics

This page provides essential guidance on configuring GoogleTest and GoogleMock within your C++ projects. You will learn how to properly point your build system to the required include paths, set necessary compiler and linker flags, and integrate the GoogleTest framework into new or existing projects. A baseline example shows how to initialize GoogleTest in your test source files.

---

## 1. Include Paths and Build Flags

To successfully compile and link your tests using GoogleTest and GoogleMock, the following configuration steps are essential:

- **Include Directories:** Ensure that the compiler can locate GoogleTest and GoogleMock header files. Your build system needs to include the paths to the `googletest/include` and `googlemock/include` directories.

- **Compile-Time Flags:** When compiling your test sources, include flags to identify the C++ standard compliance (at least C++17) and any platform-specific definitions compatible with GoogleTest.

- **Linker Flags:** Link against the GoogleTest and optionally GoogleMock libraries (`gtest`, `gmock`, or their `_main` variants). This includes adding the appropriate linker inputs and library search paths.

### Typical Include and Link Example with CMake

```cmake
# Assume GoogleTest is installed or added as a subdirectory
find_package(GTest REQUIRED)

add_executable(my_tests my_tests.cpp)
target_include_directories(my_tests PRIVATE ${GTEST_INCLUDE_DIRS} ${GMOCK_INCLUDE_DIRS})
target_link_libraries(my_tests PRIVATE GTest::gtest GTest::gmock_main)

# Enable C++17 standard
set_target_properties(my_tests PROPERTIES CXX_STANDARD 17 CXX_STANDARD_REQUIRED YES)
```

<Tip>
For standalone projects, adding GoogleTest and GoogleMock as git submodules or using FetchContent in CMake ensures consistent versions and simplifies include path management.
</Tip>

## 2. Linking Libraries

GoogleTest provides multiple linking options depending on the entry point of your test executable:

- **`gtest_main` / `gmock_main` libraries:** These provide a default `main()` function that initializes GoogleTest/GoogleMock. Linking against these lets you skip writing your own `main` in the test source.

- **`gtest` / `gmock` libraries:** If you want to customize test initialization or integrate with other frameworks, link against these and write your own `main()`.

### Linking Options:

| Option               | Usage                                    | Notes                                  |
|----------------------|------------------------------------------|----------------------------------------|
| `gtest_main`         | Link to use default main from GoogleTest | Simplest when no custom setup needed   |
| `gmock_main`         | Link to use default main with GoogleMock | Includes mocking features by default   |
| `gtest` / `gmock`    | Link to core libraries only                | Requires user to provide main()        |

<Note>
If you link your test executable with `gtest_main` or `gmock_main`, you should avoid defining your own `main()` function to prevent linker errors.
</Note>

## 3. Baseline Code Snippet: Initializing GoogleTest

When writing your own test source file (particularly if not linking `gtest_main` or `gmock_main`), you must initialize GoogleTest properly to parse command-line flags and prepare the environment.

```cpp
#include <gtest/gtest.h>

int main(int argc, char** argv) {
  // Initialize GoogleTest and remove recognized flags
  ::testing::InitGoogleTest(&argc, argv);

  // Run all tests and return the result
  return RUN_ALL_TESTS();
}
```

### With GoogleMock Support

If you use GoogleMock features, initialize GoogleMock instead:

```cpp
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

<Warning>
Be sure to call `InitGoogleTest()` or `InitGoogleMock()` before running the tests. Failing to do so will result in uninitialized flags and undefined behavior.
</Warning>

## 4. Integrating GoogleTest into Existing Projects

When adding GoogleTest to an existing code base:

1. **Add GoogleTest Source or Find Installed Package:** Either include GoogleTest sources in your build tree or configure your build system to find installed GoogleTest packages.

2. **Configure Your Build Scripts:** Add include directories for GoogleTest and GoogleMock headers.

3. **Link Test Executables:** Link against the appropriate GoogleTest and GoogleMock libraries.

4. **Choose Initialization Approach:** Decide whether to use the provided `gtest_main`/`gmock_main` or write a custom `main()`.

5. **Adjust Compiler Flags:** Ensure C++17 or higher is enabled, and any platform-specific defines are set.

## 5. Common Pitfalls and Best Practices

- **Avoid Mixing Multiple Versions:** Use consistent GoogleTest versions across the build to prevent ABI incompatibilities.

- **Respect the Macro Initialization:** Always pass `argc` and `argv` to `InitGoogleTest` or `InitGoogleMock`.

- **Use `gtest_main` When Possible:** Simplifies setup and lessens boilerplate code.

- **Link Order Matters:** `gmock_main` depends on `gmock` and `gtest`, so linker order can affect successful linkage.

- **Enable Thread Safety if Needed:** GoogleTest supports thread-safe execution where pthreads are available; check platform compatibility if multi-threaded tests are used.

## 6. Verification: Confirming Correct Setup

After configuring your build and writing your test executable, verify the setup with these steps:

1. **Compile the Test Executable:** Confirm no compilation or linker errors related to GoogleTest.
2. **Run the Tests:** Execute the test binary with the command line.
3. **Observe Outputs:** You should see test progress and summary output formatted by GoogleTest.

If you see errors such as missing symbols or runtime errors, review include and linking setup.

## 7. Troubleshooting Configuration Issues

<AccordionGroup title="Troubleshooting Configuration">
<Accordion title="Header Files Not Found">
 - **Cause:** Incorrect include paths.
 - **Fix:** Ensure your build system points to `googletest/include` and `googlemock/include`.
</Accordion>
<Accordion title="Linker Errors (Undefined References)">
 - **Cause:** Missing GoogleTest/Mock libraries or incorrect link order.
 - **Fix:** Link against `gtest`, `gmock`, and optionally `gtest_main`/`gmock_main`. Check link order.
</Accordion>
<Accordion title="Flags Not Parsed Properly">
 - **Cause:** `InitGoogleTest` or `InitGoogleMock` call missing or misplaced.
 - **Fix:** Call initialization functions at the very start of `main()`.
</Accordion>
<Accordion title="Tests Not Running or Empty Output">
 - **Cause:** Linking to libraries without a `main()` or using multiple definitions.
 - **Fix:** Use `gtest_main` or define your own `main`; avoid duplicate `main()` definitions.
</Accordion>
</AccordionGroup>

---

For detailed examples and platform-specific build instructions, see the [Installation Methods](https://github.com/google/googletest/blob/main/docs/getting-started/prereqs-installation/installation-methods.md) page.


---

## References

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — for foundational GoogleTest usage
- [GoogleMock Cheat Sheet](https://github.com/google/googletest/blob/main/docs/gmock_cheat_sheet.md) — for mocking details
- [Integration Points](https://github.com/google/googletest/blob/main/overview/integration-platforms/integration-points.mdx) — configuring GoogleTest with build tools and IDEs
- [Troubleshooting Setup Problems](https://github.com/google/googletest/blob/main/getting-started/troubleshooting-faq/setup-troubleshooting.mdx) — common configuration issues

---

For community support and further assistance, visit [Where Can I Get Help?](https://github.com/google/googletest/blob/main/faq/support-and-resources/where-to-get-help.mdx).