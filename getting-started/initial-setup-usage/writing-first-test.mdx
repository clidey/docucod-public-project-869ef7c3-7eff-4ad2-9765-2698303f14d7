---
title: "Writing and Running Your First Test"
description: "A beginner-friendly tutorial on creating and running your first test suite. This page walks through core API usage, leveraging real-world samples to illustrate standard patterns for both GoogleTest and GoogleMock."
---

# Writing and Running Your First Test

A beginner-friendly tutorial on creating and running your first test suite. This page walks through core API usage, leveraging real-world samples to illustrate standard patterns for both GoogleTest and GoogleMock.

---

## Introduction

Welcome to your first step in mastering GoogleTest and GoogleMock! This guide helps you write simple, effective C++ test cases and mock classes, run them, and understand the results. Whether you're verifying basic logic or mocking complex behaviors, this tutorial shows you the core techniques with clear, practical examples.

By the end of this page, you'll confidently create test suites, write assertions, use test fixtures, and apply mocks to test interactions â€” all essential skills for reliable C++ testing.

---

## 1. Writing Basic Tests with GoogleTest

### Step 1: Include the GoogleTest Header

Start by adding the primary GoogleTest header in your test source:

```cpp
#include <gtest/gtest.h>
```

### Step 2: Define Your First Simple Test

Use the `TEST()` macro to create a test. This defines a test suite and an individual test name.

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

This example tests a `Factorial` function for correct values. Each `EXPECT_EQ` assertion checks an expected outcome without aborting the test on failure, showing all issues at once.

### Step 3: Understanding Test Suites and Tests

- **Test Suite**: Group related tests under a suite name (e.g., `FactorialTest`).
- **Test**: Individual named test cases (e.g., `HandlesZeroInput`).

Names should avoid underscores and follow standard C++ naming conventions.

### Step 4: Running the Tests

Call `RUN_ALL_TESTS()` inside your `main()` function to run all registered tests:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

> **Tip:** In most cases, linking with `gtest_main` provides a suitable `main()` so you don't need to write it manually.

### Outcome:

If all assertions pass, your tests succeed. Otherwise, GoogleTest gives detailed output showing which assertions failed and where.

---

## 2. Using Test Fixtures for Shared Setup

When multiple tests share common setup, use test fixtures with `TEST_F()`.

### Step 1: Define a Fixture Class

Inherit from `testing::Test` and set up shared data:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Prepare queues with different contents
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;  // empty
  Queue<int> q1_;  // single item
  Queue<int> q2_;  // two items
};
```

### Step 2: Write Tests Using the Fixture

Use `TEST_F()` with the fixture to access shared data:

```cpp
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

Each test uses a fresh instance of the fixture, ensuring isolated and repeatable tests.

---

## 3. Creating Mock Classes with GoogleMock

Mocking allows you to test interactions with dependencies by defining how mock methods should behave and verifying the calls they receive.

### Step 1: Include GoogleMock

```cpp
#include <gmock/gmock.h>
```

### Step 2: Define a Mock Class

Mock methods use the `MOCK_METHOD` macro, specifying return type, method name, argument types, and optional qualifiers.

Example: mocking a simple interface

```cpp
class Foo {
 public:
  virtual ~Foo() = default;
  virtual void DoThis() = 0;
  virtual int DoThat(bool flag) = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, DoThis, (), (override));
  MOCK_METHOD(int, DoThat, (bool flag), (override));
};
```

> **Tip:** Mock methods must be declared in the `public:` section.

### Step 3: Using a Mock Object in Your Test

Set expectations describing which calls should happen:

```cpp
using ::testing::Return;
using ::testing::_;  // wildcard matcher

TEST(FooTest, CallsDoThis) {
  MockFoo mock_foo;
  EXPECT_CALL(mock_foo, DoThis()).Times(1);
  EXPECT_CALL(mock_foo, DoThat(_)).WillOnce(Return(42));

  mock_foo.DoThis();  // satisfies expectation
  int result = mock_foo.DoThat(true);
  EXPECT_EQ(result, 42);
}
```

> **Note:** If a mock method is called without an `EXPECT_CALL` set, a warning for an "uninteresting call" is generated by default.

### Step 4: Using NiceMock and StrictMock Wrappers

You can control how uninteresting calls are handled:

- `NiceMock<MockFoo>` suppresses warnings for uninteresting calls.
- `StrictMock<MockFoo>` causes uninteresting calls to fail the test.

Example:

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> nice_mock;
EXPECT_CALL(nice_mock, DoThis());

nice_mock.DoThis();  // No warnings on other mock method calls
```

---

## 4. Running Your First Test Suite

### Full Example

Here's a complete example combining GoogleTest and GoogleMock:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

// Production interface
class Foo {
 public:
  virtual ~Foo() = default;
  virtual void DoThis() = 0;
  virtual int DoThat(bool flag) = 0;
};

// Mock class
class MockFoo : public Foo {
 public:
  MOCK_METHOD(void, DoThis, (), (override));
  MOCK_METHOD(int, DoThat, (bool), (override));
};

TEST(FooTest, DoThisIsCalled) {
  MockFoo mock_foo;

  // Expect DoThis called once
  EXPECT_CALL(mock_foo, DoThis()).Times(1);

  // Setup default return for DoThat
  ON_CALL(mock_foo, DoThat(_)).WillByDefault(testing::Return(10));

  mock_foo.DoThis();
  int res = mock_foo.DoThat(true);
  EXPECT_EQ(res, 10);
}

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Running the Test

Compile and run your tests; GoogleTest will discover the test cases automatically, execute them, and report the results.

You should see output like:

```text
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from FooTest
[ RUN      ] FooTest.DoThisIsCalled
[       OK ] FooTest.DoThisIsCalled (0 ms)
[----------] 1 test from FooTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

---

## 5. Best Practices and Troubleshooting Tips

- **Use `EXPECT_*` vs `ASSERT_*` thoughtfully:**
  - Use `EXPECT_*` to allow a test to continue after failure to gather more info.
  - Use `ASSERT_*` when continuing the test makes no sense (e.g., dereferencing a null pointer).

- **Names matter:**
  - Name your test suites after the component being tested.
  - Name your tests after the specific behavior or case.

- **Isolate tests:**
  - Each test has a fresh fixture instance.
  - Avoid dependencies between tests to prevent flakiness.

- **Control mock behavior carefully:**
  - Use `ON_CALL` for default behavior.
  - Use `EXPECT_CALL` to set expectations and verify calls.

- **Handling uninteresting calls:**
  - Use `NiceMock` to silence warnings.
  - Explicitly specify `.Times(AnyNumber())` to mark allowed calls.

- **Troubleshooting:**
  - If tests do not run, ensure you link with `gtest_main` or provide `main()` appropriately.
  - For failing mocks, verify your `EXPECT_CALL` matchers are correct.
  - Use `--gmock_verbose=info` flag to get detailed mock call diagnostics.

---

## 6. Additional Resources

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md): Core concepts and detailed getting started
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md): Complete guide to mock API
- [gMock Cheat Sheet](https://github.com/google/googletest/blob/main/docs/gmock_cheat_sheet.md): Quick reference for mocking syntax
- [Using Matchers](https://github.com/google/googletest/blob/main/docs/reference/matchers.md): Guide on argument matchers
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html): A tutorial style guide on mocks

---

By following this guide, you've taken your first confident steps in writing effective and maintainable C++ tests with GoogleTest and GoogleMock.

Happy testing!
