---
title: "Troubleshooting Common Issues"
description: "Addresses frequent setup problems (compilation errors, linking failures, incorrect configurations) and offers quick solutions, empowering new users to resolve issues and achieve a successful first run."
---

# Troubleshooting Common Issues

Welcome to the troubleshooting guide designed to swiftly resolve common setup and configuration problems encountered when getting started with GoogleTest. Whether you face compilation errors, linking failures, or unexpected runtime behaviors, this guide empowers you to identify root causes and apply precise fixes, ensuring a smooth first test run.

---

## 1. Compilation Errors

When compiling your GoogleTest-based tests, you may encounter errors that prevent successful builds. Follow these steps to diagnose and fix frequent issues:

### 1.1 Ensure Proper Compiler Support
- **Requirement**: Your compiler **must support C++17 or later**. GoogleTest relies on C++17 features.
- Check compiler version and flags:
  - GCC: version 7 or higher
  - Clang: version 5 or higher
  - MSVC: Visual Studio 2017 Update 3 or later
- **Tip:** If you see errors related to unsupported language features, upgrade your compiler or adjust your project settings to use C++17.

### 1.2 Verify Include Paths
- Confirm that the **GoogleTest/GMock headers** are accessible via your projectâ€™s include directories.
- In CMake, use `target_include_directories()` or `include_directories()` correctly.

### 1.3 Handle Commas in `MOCK_METHOD` Macros
- If compiler errors reference the `MOCK_METHOD` macro, particularly related to template types with commas (e.g., `std::pair` or `std::map`), apply one of these solutions:
  - Wrap the argument type in additional parentheses. Example:

```cpp
MOCK_METHOD((std::pair<bool, int>), GetPair, ());
// or
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());
```

### 1.4 Include Correct Headers
- Always include `<gtest/gtest.h>` for GoogleTest and `<gmock/gmock.h>` for GoogleMock.
- Ensure these headers are included before your test code.

### 1.5 Resolve Macro Conflicts
- If you experience errors due to macro name clashes (e.g., `EXPECT_CALL` or `TEST` macros), verify that no other library or header defines conflicting macros.
- Use compiler flags to rename macros if necessary (see [Avoiding Macro Name Clashes](docs/reference/mocking.md#macros)).

---

## 2. Linking Failures

GoogleTest and GoogleMock provide libraries that need to be linked correctly with your test executable.

### 2.1 Link Against the Correct Libraries
- Link against **`gtest` and `gmock` libraries** (and optionally `gtest_main` or `gmock_main` for the main function).
- For CMake, use:

```cmake
find_package(GTest REQUIRED)
find_package(GMock REQUIRED)
add_executable(mytest ...)
target_link_libraries(mytest GTest::gtest GMock::gmock GTest::gtest_main)
```

### 2.2 Consistent Runtime Libraries
- On **Windows MSVC**, ensure that runtime library linkage flags are consistent across your project and GoogleTest/GMock:
  - GoogleTest defaults to static CRT: add `-MT` or match your project's runtime setting.
  - You can override this in CMake using `gtest_force_shared_crt` option.

### 2.3 Shared vs Static Library
- If using **shared libraries (DLLs)**, remember to define `GTEST_CREATE_SHARED_LIBRARY=1` when building GoogleTest.
- For the test binary, define `GTEST_LINKED_AS_SHARED_LIBRARY=1`.

### 2.4 Missing Symbols on Link
- If you see unresolved symbol errors related to GoogleTest internals, confirm you have:
  - Built GoogleTest and GoogleMock libraries.
  - Linked all required libraries, including `gtest_main` if you are using the provided main function.

---

## 3. Incorrect Configuration or Runtime Issues

Sometimes tests compile and link but fail to run as expected or behave incorrectly.

### 3.1 Initialize GoogleTest Properly
- **Always** call `testing::InitGoogleTest(&argc, argv);` before `RUN_ALL_TESTS()` in your `main()`.
- If using GoogleMock, call `testing::InitGoogleMock(&argc, argv);` which also initializes GoogleTest.

Example `main()`:

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### 3.2 Avoid Multiple Calls to `RUN_ALL_TESTS()`
- Calling `RUN_ALL_TESTS()` more than once leads to undefined behavior.
- Ensure it is called exactly once.

### 3.3 Test Fixture Initialization
- If using test fixtures (`TEST_F`), verify that your `SetUp()` and `TearDown()` methods are correctly spelled and implemented.
- Use the `override` keyword in C++11 and later for better compile-time checks.

### 3.4 Handling Uninteresting and Unexpected Calls in Mocks
- By default, gMock warns on uninteresting method calls.
- Use `NiceMock<T>` to suppress warnings for methods without explicit expectations.
- Use `StrictMock<T>` to make uninteresting calls fail as errors.

### 3.5 Debugging Failing Expectations
- Run tests with `--gmock_verbose=info` to trace mock invocation and expectation matching.
- This reveals which calls matched which expectations or why certain calls failed.
- Use `--gtest_stack_trace_depth=0` to hide stack traces if desired.

---

## 4. Quick Solutions for Frequent Problems

| Problem                                   | Solution                                                                                   |
|-------------------------------------------|--------------------------------------------------------------------------------------------|
| Compilation fails on `MOCK_METHOD` macro | Wrap types with commas in extra parentheses or use type aliases (see 1.3).                  |
| Linker errors unresolved symbols          | Link with `gtest`, `gmock`, and `gtest_main` or `gmock_main` appropriately (see 2.1).      |
| Tests don't run or skip all tests          | Check proper initialization with `InitGoogleTest` or `InitGoogleMock` (see 3.1).          |
| Warnings on uninteresting mock calls      | Use `NiceMock` or add explicit `EXPECT_CALL(...).Times(AnyNumber())` (see 3.4).            |
| Overly strict test failures on mocks      | Use `NaggyMock` or adjust expectations to allow unexpected calls as needed (see 3.4).      |
| Build fails due to C++ standard            | Make sure compiler flags request at least `-std=c++17` or equivalent (see 1.1).            |

---

## 5. Additional Tips and Best Practices

- Use **CMake configuration** best practices: prefer `find_package` with imported targets (`GTest::gtest`) for reliable builds.
- Keep GoogleTest and GoogleMock versions in sync; mismatched versions may cause build issues.
- For complex mocking scenarios, consult the [gMock Cookbook](docs/gmock_cook_book.md) to refine your mock expectations and behaviors.
- Regularly update your build tools and dependencies to ensure compatibility.

---

## 6. Getting Help

- Check the [GoogleTest Primer](docs/primer.md) for foundational guides.
- Refer to the [Assertions Reference](docs/reference/assertions.md) for test validation techniques.
- Visit the [Mocking Reference](docs/reference/mocking.md) and [gMock Cookbook](docs/gmock_cook_book.md) for advanced mocking guidance.
- Explore the [GoogleTest GitHub Repository](https://github.com/google/googletest) for issues, discussions, and updates.

---

By following this troubleshooting guide, you will quickly overcome the common pitfalls in setting up and running your first GoogleTest and GoogleMock tests, enabling you to focus on writing effective C++ tests and improving code quality.

---