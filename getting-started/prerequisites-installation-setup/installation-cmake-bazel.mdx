---
title: "Installation with CMake and Bazel"
description: "Step-by-step installation guides tailored for both CMake and Bazel users, covering dependency setup, fetching GoogleTest, and integrating into user projects. Offers shortcuts for both new and experienced users to get the library built and linked quickly."
---

# Installation with CMake and Bazel

This guide walks you through clear, step-by-step instructions to install GoogleTest using two of the most popular build systems: **CMake** and **Bazel**. Whether you are starting fresh or integrating into an existing project, follow the section that matches your preferred toolchain to get GoogleTest up and running quickly.

---

## Prerequisites

Before proceeding, ensure you have the following:

- A supported operating system: Linux, macOS, or Windows
- A C++ compiler supporting C++17 or later (GCC, Clang, MSVC)
- Installed build tool for your chosen system:
  - **CMake** (version 3.14 or higher) with Make, Ninja, or other compatible generators
  - **Bazel** (version 7.0 or higher)

> For detailed platform and compiler compatibility, please see the [System Requirements & Supported Platforms](../prerequisites-installation-setup/system-requirements-supported-platforms) page.

---

## Installing GoogleTest with CMake

This section guides you through installing and building GoogleTest via CMake, ideal for users familiar with CMake-based projects.

### Step 1: Create a New Project Directory

Open your terminal or command prompt and run:

```bash
mkdir my_project && cd my_project
```

### Step 2: Create Your CMakeLists.txt File

In your project root, create a file named `CMakeLists.txt` with the following content:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Require C++17 standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Use FetchContent module to download GoogleTest
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
# For Windows: ensure runtime library consistency
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

# Enable testing support
enable_testing()

# Define the test executable
add_executable(
  hello_test
  hello_test.cc
)

# Link the test executable against GoogleTest
target_link_libraries(
  hello_test
  GTest::gtest_main
)

# Register tests with CTest
include(GoogleTest)
gtest_discover_tests(hello_test)
```

### Step 3: Add a Sample Test Source File

Create a file named `hello_test.cc` with this sample test code:

```cpp
#include <gtest/gtest.h>

// Sample basic assertions to validate GoogleTest setup
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

### Step 4: Build Your Project

Generate build files and compile the test executable:

```bash
cmake -S . -B build
cmake --build build
```

### Step 5: Run Your Tests

Use CTest to run the tests and verify everything works:

```bash
cd build && ctest
```

Expected output:

```
Test project /path/to/my_project/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

### Tips and Best Practices for CMake

- **Update the Git commit hash regularly** when using the `FetchContent_Declare` URL to stay current with GoogleTest improvements.
- Use the option `gtest_force_shared_crt` on Windows to prevent runtime conflicts between your tests and GoogleTest libraries.
- If your project already uses CMake, consider adding GoogleTest as a subdirectory with `add_subdirectory()` for tighter integration and consistent compiler flags.

---

## Installing GoogleTest with Bazel

If you prefer Bazel as your build system, follow these concise steps to set up GoogleTest.

### Step 1: Create Your Bazel Workspace

In your terminal:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Declare GoogleTest Dependency

Create a `MODULE.bazel` file in your workspace root with this content:

```python
# MODULE.bazel

bazel_dep(name = "googletest", version = "1.17.0")
```

### Step 3: Add a Sample Test Source File

Create `hello_test.cc` with this code:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

### Step 4: Create a BUILD File

Create a `BUILD` file alongside your test source with the following contents:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

### Step 5: Build and Run Your Tests

Run this command from your workspace root:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

You should see test execution output confirming that your test passed.

### Tips and Notes for Bazel

- Use the `--cxxopt=-std=c++17` flag to ensure GoogleTest uses the C++17 standard.
- Bazel Central Registry manages GoogleTest versions; update the version string in `MODULE.bazel` as newer releases become available.
- Bazel advantages include finer-grained dependency control and integrated caching, ideal for large-scale projects.

---

## Troubleshooting Common Installation Issues

<Tip>
If CMake cannot find `FetchContent`, make sure your CMake version is 3.14 or higher.
</Tip>

<Warning>
On Windows, incompatible runtime library settings between your project and GoogleTest cause linking errors. Use `set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)` in your `CMakeLists.txt` to fix this.
</Warning>

<Note>
If Bazel test runs show compilation errors related to C++ standards, verify you are passing `--cxxopt=-std=c++17` or the appropriate flag for your compiler.
</Note>

If tests do not execute after building, check that your test registration commands (`gtest_discover_tests` for CMake or `cc_test` in Bazel) are correctly specified.

---

## Whatâ€™s Next?

After successfully installing and running your first test:

- Explore the [Writing and Running Your First Test](../first-test-debugging/writing-running-first-test) guide to learn how to author more tests.
- Dive into [Test Discovery Workflow](../../guides/getting-started/test-discovery-workflow) to understand how tests are discovered and executed.
- Visit the [Troubleshooting Common Installation & Build Issues](../first-test-debugging/troubleshooting-common-issues) for advanced help.
- Review the [GoogleTest Primer](../primer) for practical examples and a deeper introduction to assertions.

---

This guide equips you to confidently build GoogleTest with your preferred build system, setting a solid foundation for reliable and scalable C++ testing.

---

## References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [CMake Official Site](https://cmake.org/)
- [Bazel Official Site](https://bazel.build/)
- [GoogleTest Primer](../primer)
- [System Requirements & Supported Platforms](../prerequisites-installation-setup/system-requirements-supported-platforms)

---

<Source url="https://github.com/google/googletest" paths={[{"path": "docs/quickstart-cmake.md", "range": "1-100"}, {"path": "docs/quickstart-bazel.md", "range": "1-90"}]} />