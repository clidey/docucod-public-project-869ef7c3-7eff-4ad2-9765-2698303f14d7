---
title: "Configure Your Project"
description: "Learn how to add GoogleTest and GoogleMock headers and libraries to your project, set up includes, and structure source files for effective test authoring."
---

# Configure Your Project

Learn how to add GoogleTest and GoogleMock headers and libraries to your project, set up include paths, and organize your source files to write and run your tests effectively.

---

## 1. Setting Up Include Paths

To write tests with GoogleTest and GoogleMock, your project must include the appropriate headers. GoogleTest headers are located under `gtest/include/gtest/`, and GoogleMock headers are under `gmock/include/gmock/`.

### What to Include in Your Source Files

- **GoogleTest main header:** Include `<gtest/gtest.h>` in any test file where you want to use GoogleTest assertions and test constructs.
- **GoogleMock main header:** Include `<gmock/gmock.h>` to use GoogleMock features alongside GoogleTest.


### How to Add Include Directories

When setting up your project's build system, add the relevant include directories so your compiler finds the headers.

- Add `googletest/include` and `googlemock/include` directories to your compiler's include path.

- The CMake build scripts already configure these include directories for you. For example, in the [`googlemock/CMakeLists.txt`](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt), the include directories for both GoogleMock and GoogleTest are added:

```cmake
include_directories(
  "${gmock_SOURCE_DIR}/include"
  "${gmock_SOURCE_DIR}"
  "${gtest_include_dirs}")
```

where `${gtest_include_dirs}` corresponds to GoogleTest's includes.


## 2. Linking Libraries

Link your test targets against the following libraries depending on your needs:

- **gtest:** GoogleTest library
- **gtest_main:** GoogleTest library that includes a standard `main()` implementation
- **gmock:** GoogleMock library (depends on GoogleTest)
- **gmock_main:** GoogleMock library including a `main()` implementation suited for tests that combine GoogleMock and GoogleTest


### Typical Linkage Patterns

| Use Case                              | Link Against    |
|-------------------------------------|----------------|
| GoogleTest tests with custom main() | gtest          |
| GoogleTest tests with default main  | gtest_main     |
| GoogleMock tests with custom main() | gmock + gtest  |
| GoogleMock tests with default main  | gmock_main     |


### Using CMake

If your project uses CMake and you add GoogleTest/GoogleMock as subdirectories, you can link against the targets `gtest`, `gtest_main`, `gmock`, or `gmock_main` directly.

Example:

```cmake
add_executable(my_test test/my_test.cc)
target_link_libraries(my_test gtest_main)
```

When using GoogleMock features:

```cmake
add_executable(my_mock_test test/my_mock_test.cc)
target_link_libraries(my_mock_test gmock_main)
```

---

## 3. Organizing Source & Test Files

Structure your project source and test files to keep your tests organized and easy to maintain.

### Recommended Source File Layout

- Keep your production source files separate from test sources.
- Place test files under a `test/` directory or alongside production files using a naming convention like `*_test.cc`.

Example project layout:

```
/project-root
  /src
    example.cc
    example.h
  /test
    example_test.cc
    mock_example_test.cc
```

### Including Headers in Test Files

In your test files, include the headers you need to test and GoogleTest/GoogleMock headers:

```cpp
#include "example.h"
#include <gtest/gtest.h>
#include <gmock/gmock.h>  // Only if using GoogleMock
```

### Writing `main()` Function for Your Tests

Most users do not need to write their own `main()` function, since:

- GoogleTest provides a `gtest_main` library that implements a suitable main.
- GoogleMock provides `gmock_main` which initializes both GoogleMock and GoogleTest.


If you choose to define your own `main()` (for example, for custom setup), use the following pattern:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>  // If using GoogleMock

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## 4. Example: Minimal Test Setup

Here is a minimal example assuming you want to write a test using GoogleMock.

```cpp
// test/sample_test.cc
#include <gmock/gmock.h>
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1, 1);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleMock(&argc, argv);  // Initializes GoogleMock and GoogleTest
  return RUN_ALL_TESTS();
}
```

Note: If you link against `gmock_main`, you don't need to define this main manually.

---

## 5. Customization Points

GoogleTest offers macros for fine customizations during integration. These may be used if your environment has special requirements.

Some notable macros that can be defined before including GoogleTest headers include:

- `GTEST_OS_STACK_TRACE_GETTER_` — for custom stack trace implementations
- `GTEST_CUSTOM_TEMPDIR_FUNCTION_` — to override the default temporary directory
- Logging macros such as `GTEST_LOG_`, `GTEST_CHECK_`
- Threading support macros like `GTEST_HAS_NOTIFICATION_` and `GTEST_HAS_MUTEX_AND_THREAD_LOCAL_`
- Export macros like `GTEST_API_` for symbol visibility

For details, see the `custom/README.md` inside the `googletest/include/gtest/internal` directory or visit the internal documentation for `gtest-port.h` and `gtest-printers.h`.

---

## 6. Troubleshooting & Best Practices

- **Include Path Issues:** Ensure you add the headers' root folders (`googletest/include` and `googlemock/include`) to your compiler's include paths.
- **Linker Errors:** Confirm you link against the correct GoogleTest or GoogleMock libraries (`gtest`, `gmock`, `gtest_main`, or `gmock_main`).
- **Main Function Conflicts:** Don’t define your own `main()` if linking with `gtest_main` or `gmock_main` to avoid duplicate symbol errors.
- **Order of Initialization:** Always call `InitGoogleTest()` or `InitGoogleMock()` in your `main()` before running tests.
- **File Naming:** Use consistent naming, e.g., `*_test.cc` for test files, to maintain clarity and avoid confusion.

---

## 7. Next Steps

- Write and run your first test using `TEST()` or a test fixture with `TEST_F()`.
- Optionally add mocks and expectations using GoogleMock.
- Explore configuring test execution, filtering, and custom assertions.

---

## References

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [GoogleTest & GoogleMock CMake Integration](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt)
- [GoogleMock `gmock_main.cc` Source](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc)
- [Internal Customization Points](https://github.com/google/googletest/blob/main/googletest/include/gtest/internal/custom/README.md)

---

This guide helps you effectively set up your C++ project to write robust tests using GoogleTest and GoogleMock. Proper inclusion of headers, linking libraries, and organizing your source files will streamline your testing workflow and reduce integration friction.