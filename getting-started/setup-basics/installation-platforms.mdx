---
title: "Installation (CMake, Bazel & More)"
description: "Guides users through installing GoogleTest and GoogleMock using common build tools such as CMake and Bazel, with platform-specific steps for Linux, macOS, and Windows. Provides links to sample build scripts and advice for integrating with existing codebases."
---

# Installation (CMake, Bazel & More)

This guide walks you through installing GoogleTest and GoogleMock using popular build systems, including CMake and Bazel. It covers platform-specific steps for Linux, macOS, and Windows, ensuring you can integrate these testing frameworks seamlessly into your existing C++ projects.

---

## 1. Installation Overview

GoogleTest and GoogleMock provide robust C++ testing and mocking capabilities. Installing them with established build tools ensures compatibility, ease of use, and maintainability.

You have two main approaches:

- **Standalone build:** Build GoogleTest/GoogleMock independently and link your tests to the compiled libraries.
- **In-tree build:** Incorporate GoogleTest/GoogleMock source code directly into your project’s build, allowing unified compiler and linker settings.

This guide focuses on CMake and Bazel, the most commonly used build tools with GoogleTest.

---

## 2. Installing with CMake

GoogleTest includes a comprehensive CMake build script that supports building both GoogleTest and GoogleMock across platforms.

### Prerequisites

- Have CMake installed (version 3.13 or later recommended).
- C++17 compatible compiler (GCC, Clang, MSVC, or similar).
- Git installed for cloning repository (or download the source ZIP).

### 2.1 Cloning the Repository

Clone the official GoogleTest repo at the stable version:

```bash
  git clone https://github.com/google/googletest.git -b main
  cd googletest
```

### 2.2 Building Standalone GoogleTest and GoogleMock

Create a dedicated build directory and generate build files:

```bash
  mkdir build
  cd build
  cmake ..
```

> By default, GoogleMock is included. To build only GoogleTest, add `-DBUILD_GMOCK=OFF`:
>
```bash
  cmake .. -DBUILD_GMOCK=OFF
```

#### Build and Install

On Linux/macOS:

```bash
  make
  sudo make install  # Installs in /usr/local/ by default
```

_On Windows with Visual Studio:_

- Open the generated `gtest.sln` solution.
- Build the solution via Visual Studio’s IDE.

_On macOS with Xcode:_

- Open the generated `.xcodeproj` file.
- Build it through Xcode.

### 2.3 Using GoogleTest in Your Existing CMake Project

#### Option 1: Find Installed Package

If installed system-wide, use `find_package`: 

```cmake
find_package(GTest CONFIG REQUIRED)

add_executable(your_tests test.cpp)
target_link_libraries(your_tests GTest::gtest GTest::gtest_main)
```

#### Option 2: Add as Subdirectory (In-tree Build)

Add GoogleTest sources to your project and include it:

```cmake
add_subdirectory(path/to/googletest)

add_executable(your_tests test.cpp)
target_link_libraries(your_tests gtest gtest_main)
```

This method ensures consistent compiler and linker settings.

### 2.4 Important Compiler Options

- To enable pthread support explicitly on some Linux environments, add `-DGTEST_HAS_PTHREAD=1` to `CXXFLAGS`.
- On Windows, to resolve runtime mismatches between static and dynamic CRTs, use the `gtest_force_shared_crt` CMake option:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

### 2.5 Sample CMakeLists.txt Snippet

```cmake
cmake_minimum_required(VERSION 3.13)
project(MyTests CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Add GoogleTest as a subdirectory
add_subdirectory(googletest)

add_executable(MyTests test_main.cpp test_sample.cpp)
target_link_libraries(MyTests gtest gtest_main pthread)

enable_testing()
add_test(NAME MyTests COMMAND MyTests)
```

### 2.6 Troubleshooting Common CMake Issues

<Accordion title="Common Build Issues and Fixes">
- **Missing pthread symbols on Linux:** Ensure compiler flags link the pthread library. The CMake script automatically includes this if detected; otherwise, link manually with `-lpthread`.
- **Visual Studio runtime conflicts:** Use the `gtest_force_shared_crt` option to align with your project’s runtime settings.
- **Older CMake versions:** CMake 3.13+ is recommended for compatibility. Upgrade if errors occur.
</Accordion>

---

## 3. Installing with Bazel

GoogleTest supports Bazel as a build system. Although detailed Bazel setup is beyond this guide’s scope, key points follow:

- Use Google's published Bazel `WORKSPACE` entries to pull in GoogleTest and GoogleMock.
- Define your test targets with dependencies on `@com_google_googletest//:gtest` and `@com_google_googletest//:gmock`.
- Run tests via `bazel test //your/package:your_test`.

For full Bazel integration samples and tips, consult the [GoogleTest Bazel integration documentation](https://github.com/google/googletest/tree/main/bazel).

---

## 4. Platform-Specific Notes

### Linux / macOS

- Ensure you have the necessary build tools: `gcc` or `clang`, `make`, `cmake`.
- `sudo make install` requires root privileges to place headers and libs in system locations.
- On macOS, `brew install cmake` if CMake is not present.

### Windows

- Use Visual Studio or MSBuild for compiling the solution.
- CMake generates `.sln` and `.vcxproj` files.
- For MinGW or MSYS, standard Unix-like instructions with `make` may apply.

---

## 5. Integrating GoogleMock

GoogleMock is automatically included when you build GoogleTest with default CMake settings.

- Link your test executables with `gmock` and `gmock_main` to get mocking support and the default main function.
- If you only want GoogleMock without GoogleTest main, link to `gmock`.

Example CMake linking:

```cmake
target_link_libraries(MyMockedTests gmock gmock_main)
```

### Build GoogleMock tests (Optional)

To build GoogleMock’s own tests, enable the option:

```bash
cmake .. -Dgmock_build_tests=ON
make
test
```

---

## 6. Sample Build Scripts and Examples

### Sample CMakeLists.txt for a Minimal Test

```cmake
cmake_minimum_required(VERSION 3.13)
project(SampleTestProject CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

add_subdirectory(googletest)  # GoogleTest source

add_executable(sample_test sample_test.cpp)

target_link_libraries(sample_test gtest_main)

enable_testing()
add_test(NAME sample_test COMMAND sample_test)
```

**sample_test.cpp** snippet:

```cpp
#include <gtest/gtest.h>

TEST(SampleTest, Truth) {
  EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

---

## 7. Additional Tips and Best Practices

- Always ensure your compiler and build system target C++17 or newer.
- Use the in-tree build method (`add_subdirectory`) for consistent compiler flags and easier upgrades.
- For CI/CD pipelines, caching the built GoogleTest binaries speeds up the build process.
- Review [GoogleTest’s official README](https://github.com/google/googletest/blob/main/README.md) for the latest setup notes and advanced configuration.

---

## 8. Where to Go From Here

After installation, proceed to:

- [Writing and Running Your First Test](/getting-started/running-first-test/your-first-test) - create your first test cases.
- [Configuration and Project Setup](/getting-started/setup-basics/configuration-setup) - configure more advanced project settings.
- [Troubleshooting Common Setup Issues](/getting-started/running-first-test/troubleshooting-setup) - resolve potential installation and setup problems.

---

<Check>
Make sure your development environment meets the prerequisites before starting installation to avoid integration issues.
</Check>

---

## References and Further Reading

- Official GoogleTest Repository: https://github.com/google/googletest
- [GoogleTest CMakeLists.txt](https://github.com/google/googletest/blob/main/CMakeLists.txt)
- [GoogleMock CMakeLists.txt](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt)
- [Supported Platforms and Compilers](docs/platforms.md)

---