---
title: "Basic Configuration"
description: "Guides users through essential initial configuration for GoogleTest/GoogleMock, such as linking libraries, including headers, and integrating with their build system. This ensures the framework is correctly wired into the user’s development environment."
---

# Basic Configuration Guide for GoogleTest & GoogleMock

Welcome to the essential guide for configuring GoogleTest and GoogleMock in your C++ development environment. This document is designed to walk you through the core initial steps required to link libraries, include headers, and integrate the framework seamlessly into your build system. By following these instructions, you'll ensure GoogleTest and GoogleMock are correctly set up to help you write and run effective tests.

---

## 1. Overview of Basic Configuration Needs

Before writing your first test, GoogleTest and GoogleMock require correct wiring into your project. This involves:

- Including the proper headers to access the testing and mocking APIs.
- Linking against the appropriate compiled GoogleTest/GoogleMock libraries.
- Integrating these steps into your build system for smooth compilation and execution.

Getting this setup right guarantees your test code can find the necessary interfaces and the test binaries execute correctly.

---

## 2. Including GoogleTest/GoogleMock Headers

To use GoogleTest and GoogleMock APIs in your source files, include the primary header:

```cpp
#include <gtest/gtest.h>
```

This header is your gateway to all testing macros, assertions, fixtures, matchers, mocks, and test runners. It automatically includes GoogleMock when enabled, unifying the functionality for both testing and mocking.

### Tips:
- Include this header **only once per test file** to avoid redundancy.
- The header defines core classes such as `testing::Test`, `testing::TestSuite`, and all assertion macros like `EXPECT_EQ`.

---

## 3. Linking GoogleTest and GoogleMock Libraries

After including headers, your compiled test executable must link against the GoogleTest and optionally GoogleMock libraries.

### Link Libraries:
- For **GoogleTest only**, link with:
  - `gtest` (static library)
  - or `gtest_main` (for main function included)

- For **GoogleMock (which includes GoogleTest)**, link with:
  - `gmock` and `gmock_main`

#### Example linker flags:

```bash
-lgtest -lpthread            # for GoogleTest (Linux example)
-lgmock -lgtest -lpthread    # for GoogleMock
```

### Integration with Build Systems:
- **CMake:**
  - Find installed package or add GoogleTest as a subdirectory.
  - Link targets with `GTest::gtest`, `GTest::gtest_main`, `GMock::gmock` appropriately.

- **Manual Builds:**
  - Build GoogleTest and GoogleMock as described in [Installation Methods](/getting-started/setup-basics/installation-methods).
  - Ensure library paths are correctly specified.

---

## 4. Integrating GoogleTest/GoogleMock with Your Build System

GoogleTest supports various build systems. The most common integration steps involve:

### 4.1 Adding Include Paths
Make sure your compiler can find the GoogleTest headers. For example:

```bash
-I/path/to/googletest/include
```

### 4.2 Adding Library Paths
Make sure your linker can find the compiled libraries:

```bash
-L/path/to/googletest/lib
```

### 4.3 Linking Against the Libraries
Add the libraries as linker inputs:

```bash
-lgtest -lgmock -lpthread
```

### 4.4 Using CMake to Simplify

With CMake, you can handle all of the above via commands:

```cmake
# Find GoogleTest package if installed
find_package(GTest REQUIRED)

# If using GoogleMock
find_package(GMock REQUIRED)

add_executable(my_test test.cpp)
target_link_libraries(my_test GTest::gtest_main)
# or for GoogleMock
# target_link_libraries(my_test GMock::gmock_main)
```

### Practical Notes:
- Linking with `gtest_main` or `gmock_main` provides a ready-made `main` function.
- If you want to define a custom `main()`, link only with `gtest` or `gmock`.

---

## 5. Writing Your Main Function

If you do not use the provided `gtest_main` or `gmock_main`, you must define your own entry point that initializes GoogleTest.

Here is a minimal example of a `main()`:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- `InitGoogleTest()` parses command line flags used by the framework.
- `RUN_ALL_TESTS()` runs all registered tests and returns 0 on success or 1 on failure.

### Best Practices:
- Call `InitGoogleTest()` before `RUN_ALL_TESTS()` to ensure flags are processed.
- Return the result of `RUN_ALL_TESTS()` from your `main()`.

---

## 6. Verifying Your Configuration

### 6.1 First Test Compilation
Try building a minimal test file:

```cpp
#include <gtest/gtest.h>

TEST(SimpleTest, BasicAssertion) {
  EXPECT_EQ(1, 1);
}
```

Compile and link following your build system’s instructions including GoogleTest.

### 6.2 Successful Run Output
Running your test binary should produce an output similar to:

```
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SimpleTest
[ RUN      ] SimpleTest.BasicAssertion
[       OK ] SimpleTest.BasicAssertion (0 ms)
[----------] 1 test from SimpleTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

If you see this output, your basic setup and configuration is working.

---

## 7. Troubleshooting

### Common Issues

| Issue                              | Cause                                  | Solution                                           |
|-----------------------------------|---------------------------------------|----------------------------------------------------|
| Compiler cannot find `gtest/gtest.h` | Include path is missing or incorrect  | Add correct include path to compiler flags         |
| Linker errors for GoogleTest symbols | Libraries not linked or wrong linker order | Link with `gtest` and `gmock` properly           |
| Multiple definition errors on main | Linking with both `gtest_main` and own `main()` | Remove one of the `main()` definitions           |
| Unresolved pthread symbols         | Missing pthread flags on Linux         | Link with `-lpthread`                              |

### Tips
- Verify library and header paths.
- Confirm consistent compiler and linker flags.
- Ensure that the GoogleTest binaries were built with the same compiler settings.

If problems persist, consult the [Troubleshooting Common Setup Issues](/getting-started/first-tests-validation/troubleshooting).

---

## 8. Best Practices for Configuration

- **Always link pthreads (`-lpthread`)** on POSIX systems.
- Use `gtest_main` or `gmock_main` if you do not need a custom `main()` - it reduces boilerplate.
- Define your own `main()` if initialization logic beyond GoogleTest's flags parsing is needed.
- Organize your test code and sources logically to avoid confusion between production and test sources.
- Regularly consult the [Supported Platforms & Requirements](/overview/adoption-and-integration/supported-platforms-and-requirements) to verify compatibility.

---

## 9. Additional Resources

- Read the [GoogleTest Primer](/docs/primer.md) for conceptual understanding.
- Explore [Installation (Bazel, CMake, Manual)](/getting-started/setup-basics/installation-methods) for project-specific build instructions.
- Review [Integrating with CMake and Bazel](/guides/test-automation-and-integration/integrating-with-build-systems) for more advanced build integration.
- Use [Running and Controlling Tests API](../api-reference/testing-apis/test-execution-api) for programmatic test run control.

---

By completing these steps, you'll have successfully configured GoogleTest and GoogleMock, setting a solid foundation for writing and running your first tests efficiently.

For further code samples and in-depth API usage, see the [Testing Reference](../docs/reference/testing.md).

---