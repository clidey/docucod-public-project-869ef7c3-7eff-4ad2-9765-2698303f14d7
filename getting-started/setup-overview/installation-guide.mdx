---
title: "Installation (CMake, Bazel, Manual)"
description: "Step-by-step instructions for installing GoogleTest and GoogleMock using different build systems like CMake and Bazel, or by manual setup. Choose the method best suited for your workflow and platform."
---

# Installation (CMake, Bazel, Manual)

Step-by-step instructions for installing GoogleTest and GoogleMock using different build systems like CMake and Bazel, or by manual setup. Choose the method best suited for your workflow and platform.

---

## 1. Prerequisites & Preparation

Before starting the installation, ensure your environment meets the following:

- **Supported Operating Systems:** Linux, Windows, macOS.
- **Compiler Requirements:** A C++ compiler with C++17 support.
- **Build Tools:** CMake (version 3.13 or later recommended) or Bazel.

> **Tip:** Refer to the [Prerequisites & Supported Platforms](/getting-started/setup-overview/system-requirements) documentation for detailed hardware and software requirements.

---

## 2. Installing with CMake

CMake is the most commonly used and flexible way to build GoogleTest and GoogleMock across platforms.

### 2.1. Clone the Repository

Start by cloning the official GoogleTest repository:

```bash
git clone https://github.com/google/googletest.git -b main
cd googletest
```

### 2.2. Create and Enter Build Directory

Organize your build files:

```bash
mkdir build
cd build
```

### 2.3. Configure the Build

By default, this will build both GoogleTest and GoogleMock. If you want to build only GoogleTest, disable GoogleMock explicitly.

```bash
cmake ..
# Or to build only GoogleTest:
cmake .. -DBUILD_GMOCK=OFF
```

This command generates native makefiles or project files suitable for your platform.

### 2.4. Build the Libraries

On Unix-like systems:

```bash
make
```

On Windows with Visual Studio:

- Open the generated solution file (e.g., `gtest.sln`) inside the `build` directory.
- Build the solution using Visual Studio.

On macOS with Xcode:

- Open the generated `.xcodeproj` file and build using Xcode.

### 2.5. Install (Optional)

To install GoogleTest and GoogleMock system-wide (requires admin/sudo privileges):

```bash
sudo make install
```

This installs libraries, headers, and pkg-config files, typically under `/usr/local`.

### 2.6. Verify Installation

Confirm libraries and header files are correctly installed or built:

- Check the existence of header files in the install/include directory.
- Check static/shared libraries in install/lib directory.

Run the GoogleTest and GoogleMock tests (if built) to verify:

```bash
./test/gtest*      # Runs GoogleTest tests
./test/gmock*      # Runs GoogleMock tests
```

> **Warning:** Ensure that `cmake` generated build files use the same compiler and standard settings as your project to avoid ABI conflicts.

---

## 3. Installing with Bazel

Bazel users can incorporate GoogleTest and GoogleMock as external dependencies or use them in their Bazel workspace.

### 3.1. Workspace Setup

Add GoogleTest and GoogleMock to your `WORKSPACE` file:

```starlark
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/main.zip"],
    strip_prefix = "googletest-main",
)
```

### 3.2. BUILD File Integration

In your BUILD files, you can declare dependencies on GoogleTest targets:

```starlark
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//googletest"
            "@com_google_googletest//googlemock"],
)
```

### 3.3. Build and Run Tests

Run your tests with Bazel:

```bash
bazel test //path/to:my_test
```

> **Tip:** Consult Bazel's official documentation for advanced integration and version compatibility.

---

## 4. Manual Setup

If you prefer not to use a build system, you can manually compile GoogleTest and GoogleMock.

### 4.1. Download Source Files

Either clone the repository or download the zip/tarball from GitHub.

### 4.2. Include Headers

Make sure your compiler can find the GoogleTest and GoogleMock header directories, typically under `googletest/include` and `googlemock/include`.

### 4.3. Compile Source Files

Compile the following source files along with your tests:

- `googletest/src/gtest-all.cc`
- `googlemock/src/gmock-all.cc`

Example compilation command with g++:

```bash
g++ -std=c++17 -I/path/to/googletest/include -I/path/to/googlemock/include \
  -c googletest/src/gtest-all.cc

g++ -std=c++17 -I/path/to/googletest/include -I/path/to/googlemock/include \
  -c googlemock/src/gmock-all.cc
```

### 4.4. Link Objects

Link the compiled objects into your test executable:

```bash
g++ -std=c++17 my_test.o gtest-all.o gmock-all.o -lpthread -o my_test_executable
```

### 4.5. Handling Main Function

- To avoid writing your own `main()`, link with the ready-to-use GoogleTest or GoogleMock main objects:

  - GoogleTest main: `googletest/src/gtest_main.cc`

  - GoogleMock main: `googlemock/src/gmock_main.cc`

- For example, compile and link with `gmock_main.cc` to have the entry point built-in:

```bash
g++ -std=c++17 my_test.o gtest-all.o gmock-all.o gmock_main.o -lpthread -o my_test_executable
```

> **Note:** `gmock_main.cc` initializes both GoogleMock and GoogleTest.

---

## 5. Post-Installation Tips

- Prefer using `gmock_main` or `gtest_main` libraries for automatic initialization and `main()`.
- Match your compiler C++ standard and settings between GoogleTest/GoogleMock code and your tests to avoid linkage or runtime errors.
- Explore CMake options like `BUILD_SHARED_LIBS` and `gtest_force_shared_crt` for custom build behaviors.

---

## 6. Troubleshooting Common Installation Issues

<AccordionGroup title="Troubleshooting Common Problems">
<Accordion title="Linker Errors on Windows with Visual Studio">
If you encounter linker errors related to runtime libraries (e.g., mismatch between dynamic and static CRT), ensure to enable the CMake option `gtest_force_shared_crt`:

```bash
cmake .. -Dgtest_force_shared_crt=ON
```

This matches runtime library linkage between your project and GoogleTest.
</Accordion>
<Accordion title="Compilation Fails Due to Incorrect Main Definition">
Ensure you don't define `main()` yourself if linking with `gtest_main` or `gmock_main` libraries. When writing your own main, initialize GoogleTest or GoogleMock with:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Or use `testing::InitGoogleMock(&argc, argv);` if using GoogleMock.
</Accordion>
<Accordion title="Missing pthreads or Linking Issues on Linux">
GoogleTest depends on pthreads for thread safety. Ensure pthread library is installed and linked:

```bash
sudo apt-get install libpthread-stubs0-dev
```

And link your executable with `-lpthread` when compiling manually.
</Accordion>
<Accordion title="Inconsistent Compiler Settings">
Verify that your project and GoogleTest/GoogleMock are compiled with the same compiler version and flags, especially the C++ standard version (C++17).
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

After installation, get started by writing your first tests:

- Follow [Initial Project Configuration](/getting-started/setup-overview/first-project-setup) to set up your project to use GoogleTest.
- Learn how to write and run your first tests at [Writing and Running Your First Test](/getting-started/first-steps-validation/writing-first-test).

---

## Additional Resources

- [GoogleTest Primer](primer.md) - Learn the fundamentals of writing tests.
- [Integration with Build Systems](/overview/integrations/integration-with-build-systems) - Detailed instructions for CMake and Bazel integrations.
- [Supported Platforms & Compatibility](/overview/integrations/supported-platforms) - Clarifications on platform support.

---

## Summary
This page provides detailed, actionable instructions on how to install GoogleTest and GoogleMock across different development workflows—via CMake, Bazel, or manual setup—helping users prepare their environment, build the libraries, and troubleshoot common issues for successful integration.


---

### Code References
- [googletest/README.md](https://github.com/google/googletest/blob/main/README.md)
- [googlemock/CMakeLists.txt](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt)
- [googlemock/src/gmock_main.cc](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc)


---

### Example: Minimal CMake Build snippet

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTests LANGUAGES CXX)

# Fetch GoogleTest (and GoogleMock) during configure
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/main.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)
target_link_libraries(my_test GTest::gtest_main GMock::gmock_main)

include(GoogleTest)
gtest_add_tests(TARGET my_test)
```

This snippet downloads GoogleTest and GoogleMock during CMake configure and sets up your test executable linked properly.


---

**End of Installation Guide.**