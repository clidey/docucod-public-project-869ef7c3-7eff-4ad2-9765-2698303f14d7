---
title: "Initial Project Configuration"
description: "Configure your development project to use GoogleTest and GoogleMock. This page walks you through linking libraries, setting up include paths, and getting your build system ready for writing and running tests."
---

# Initial Project Configuration

Configure your C++ development project to integrate GoogleTest and GoogleMock for writing and running tests. This guide walks you through linking GoogleTest and GoogleMock libraries, setting up necessary include paths, and preparing your build system for testing.

---

## 1. Overview

GoogleTest and GoogleMock work together to provide a unified framework for writing unit tests and creating mock objects in C++. For your project to use these frameworks effectively, you need to properly configure your build environment.

This page explains how to link the testing libraries properly, set include directories for headers, and prepare your build system (with CMake as the primary example) to write and run your first tests.


## 2. Prerequisites

- Make sure you have GoogleTest and GoogleMock source code downloaded or installed.
- Ensure your compiler supports C++17 or later.
- Use CMake version 3.13 or higher to utilize the provided build scripts.


## 3. Linking GoogleTest and GoogleMock Libraries

### 3.1 Choose the Correct Library

GoogleTest provides multiple libraries:

- **gtest**: The basic GoogleTest library.
- **gmock**: GoogleMock library, built on top of GoogleTest.
- **gmock_main**: GoogleMock library that includes a main() function to run all tests.

For most projects using mocks, linking with `gmock_main` is sufficient and recommended. It provides an entry point (`main()`) and all required components out of the box.


### 3.2 How to Link

- Link your test executables against `gmock_main`.
- If you prefer to provide your own `main()`, link against `gmock` and write your `main()` as usual using `testing::InitGoogleMock`.


## 4. Setting up Include Paths

Include paths must point to the GoogleTest and GoogleMock headers so your source files can access them.

GoogleMock also includes GoogleTest headers, so include both these directories:

- `<path-to-gmock>/include`
- `<path-to-gmock>/`
- `<path-to-gtest>/include`

With CMake, these paths are included automatically when you link with the targets, as shown in the sample CMake configuration below.


## 5. Preparing Your Build System Using CMake

GoogleMock provides an example `CMakeLists.txt` script you can adapt to your project. The core ideas are:

- Add GoogleTest as a subdirectory or ensure it is installed and findable using `find_package`.
- Add GoogleMock as a subdirectory or ensure it is installed and findable.
- Link your test targets with `gmock_main`.


### 5.1 Sample CMakeLists.txt Snippet

```cmake
cmake_minimum_required(VERSION 3.13)
project(MyTestProject LANGUAGES CXX)

# Enable C++17 standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Path to googletest and googlemock source
add_subdirectory(path/to/googletest) # This will include both gtest and gmock

# Your test executable
add_executable(my_tests test_main.cpp my_class_test.cpp)

# Link with gmock_main for automatic main() and mocks
target_link_libraries(my_tests gmock_main)

# Include directories are automatically handled by gmock_main target properties
```


### 5.2 Notes

- If you want to build GoogleMock tests themselves, enable the `gmock_build_tests` option.
- On platforms requiring pthread support, linking is handled by the build scripts.
- You can customize compile options or flags if needed.


## 6. Writing Your Own main() Function

If you choose not to link with `gmock_main` and instead link only with `gmock` or `gtest`, you need to provide a `main()` function in one of your test sources.

Example `main()` for GoogleMock:

```cpp
#include "gmock/gmock.h"

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This initializes both GoogleMock and GoogleTest and runs all registered tests.


## 7. Verifying Your Setup

After configuration:

1. Build your test executable.
2. Run it.
3. Verify it prints test framework initialization messages and runs zero tests (if none are defined).


## 8. Common Pitfalls and Troubleshooting

<AccordionGroup title="Troubleshooting Common Setup Issues">
<Accordion title="Include Directories Missing">
Ensure the path to GoogleMock and GoogleTest headers is correctly specified or that the linked targets export include directories.

If using CMake, linking `gmock_main` target will set include directories automatically.
</Accordion>
<Accordion title="Linker Errors about Missing GoogleMock Symbols">
Verify that your test target links explicitly against `gmock_main` or `gmock` targets.

Check that GoogleMock sources are properly built and linked in your build.
</Accordion>
<Accordion title="Wrong main() Function"
>
Linking both your own `main()` and the `gmock_main` library can cause duplicate symbol errors.

Use either link `gmock_main` which provides main, or provide your own main and link with `gmock`.
</Accordion>
<Accordion title="Thread Support Errors">
On POSIX platforms, if you get undefined references related to `pthread`, ensure your build links with pthread.

CMake's GoogleMock integration sets this correctly.
</Accordion>
</AccordionGroup>


## 9. Next Steps

- Proceed to [Writing and Running Your First Test](/getting-started/first-steps-validation/writing-first-test) to validate your setup.
- Learn [Using Mocks with GoogleMock](https://google.github.io/googletest/gmock_for_dummies.html) to write mock-based unit tests.
- Explore build system integration guides for more complex setups.


---

## Appendix: Key Build Artifacts

- `gmock_main`: Provides GoogleMock & GoogleTest with a built-in `main()`.
  - Use when you want a quick start without writing a custom `main()`.

- `gmock`: GoogleMock library without `main()`.
  - Use when you supply your own `main()` method.

- Include directories:
  - `gmock/include`
  - `gtest/include`


---

## References

- [GoogleMock Source: gmock_main.cc](https://github.com/google/googletest/blob/main/googlemock/src/gmock_main.cc)
- [GoogleMock CMakeLists.txt](https://github.com/google/googletest/blob/main/googlemock/CMakeLists.txt)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [GoogleTest CMake Guide](https://github.com/google/googletest/blob/main/googletest/README.md)


---

This configuration ensures your development environment is fully compatible with GoogleTest and GoogleMock frameworks, enabling you to focus on writing effective, maintainable tests immediately.
