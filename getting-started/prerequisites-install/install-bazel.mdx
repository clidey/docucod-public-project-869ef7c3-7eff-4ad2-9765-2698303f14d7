---
title: "Installing with Bazel"
description: "Set up GoogleTest and GoogleMock in Bazel-based projects with practical configuration examples and explanations of common setup cases."
---

# Installing with Bazel

Set up GoogleTest and GoogleMock in Bazel-based projects with practical configuration examples and explanations of common setup cases.

---

## 1. Prerequisites & Setup

Before starting Bazel integration for GoogleTest, ensure you have:

- **Bazel Version:** 7.0 or higher is required.
- **Operating System:** Compatible OS such as Linux, macOS, or Windows.
- **C++ Compiler:** Must support at least C++17 standard.
- **Workspace Directory:** A dedicated directory to manage your Bazel project files.

If Bazel is not installed, visit the [Bazel installation guide](https://bazel.build/install) to set it up.

<Tip>
GoogleTest and GoogleMock require C++17 features; ensure your compiler flags enable this standard explicitly.
</Tip>

---

## 2. Configure Your Bazel Workspace

All Bazel projects rely on a workspace indicated by a file named `MODULE.bazel` at the root.

### Step 1: Create Your Workspace

Open your terminal and create a directory for your project:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Add the `MODULE.bazel` Dependency

Create a file named `MODULE.bazel` in the root with the following content to specify GoogleTest as a dependency:

```python
# MODULE.bazel

bazel_dep(name = "googletest", version = "1.17.0")
```

This imports GoogleTest from Bazel Central Registry, streamlining dependency management.

<Note>
Keep this version updated as new releases become available to benefit from bug fixes and features.
</Note>

---

## 3. Create Your First Test Using Bazel

### Step 1: Write a Test Source File

Create a file called `hello_test.cc` in your workspace folder:

```cpp
#include <gtest/gtest.h>

// A basic GoogleTest example demonstrating assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Strings should not be equal.
  EXPECT_EQ(7 * 6, 42);               // 7 * 6 should equal 42.
}
```

### Step 2: Create a `BUILD` File

Place a `BUILD` file in the same directory to define the Bazel build target:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This declares a test binary named `hello_test` that links against GoogleTest libraries.

<Warning>
Make sure to include both `gtest` and `gtest_main` in `deps`; `gtest_main` provides the test entry point.
</Warning>

---

## 4. Build and Run Your Test

Use Bazel to build and execute the test with outputs displayed directly in your terminal.

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

You should see output similar to:

```
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
```

A successful run confirms your Bazel integration with GoogleTest is correctly configured.

<Tip>
Use the `--test_output=all` flag to view all logs; this helps diagnose failures during test runs.
</Tip>

---

## 5. Customize Bazel Build Options

### Compiler Options

- **C++ Standard:** Ensure your build uses C++17 or newer. For GCC/Clang, use
  `--cxxopt=-std=c++17`. For MSVC, the flag is `--cxxopt=/std:c++17`.

### Vendor Mode

- GoogleTest supports Bazel Vendor mode to reduce external dependencies, improving build stability.
- This is toggled via specific flags such as `--vendor_dir` and requires a vendor archive.

---

## 6. Practical Tips and Best Practices

- **Workspace Cleanliness:** Keep your workspace organized, isolating test files and BUILD files.
- **Version Pinning:** Always specify explicit versions for `googletest` in `MODULE.bazel` to avoid unexpected upgrades.
- **Testing Flags:** Use `--test_tag_filters` and `--test_output` to control test runs efficiently.
- **Incremental Builds:** Bazel caches build artifacts; re-running tests after source changes is fast.

<Tip>
Run `bazel clean` if you encounter stale build issues to force a full rebuild.
</Tip>

---

## 7. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Bazel Integration">
<Accordion title="Build fails due to missing dependencies">
Ensure your `MODULE.bazel` includes GoogleTest and its dependencies correctly. Verify network connectivity if Bazel fails to fetch external modules.
</Accordion>
<Accordion title="Compiler errors related to C++ standard">
Explicitly add `--cxxopt=-std=c++17` or equivalent for your compiler to enforce C++17 support.
</Accordion>
<Accordion title="Tests do not run or output is missing">
Include the flag `--test_output=all` when running tests for comprehensive logs and error messages.
</Accordion>
<Accordion title="Path or environment issues on Windows">
Windows users may need to configure Bazel's output root path with
`--output_user_root=C:\tmp` to avoid path length restrictions.
</Accordion>
</AccordionGroup>

---

## 8. Additional Resources & Next Steps

- Review the [Quickstart: Building with Bazel](https://github.com/google/googletest/blob/main/docs/quickstart-bazel.md) tutorial for a more comprehensive workflow.
- Explore [Your First Test: Basic Usage](../project-setup/first-test.md) to deepen understanding of creating effective tests.
- For advanced build configuration, consult [Integrating with Your Build System](../project-setup/project-integration.md).
- If you encounter issues, see [Troubleshooting Common Issues](../validation-troubleshooting/troubleshooting.md).

<Check>
Successfully running your first Bazel-powered GoogleTest confirms that testing is integrated. Next, write richer test suites and explore mocking capabilities.
</Check>

---

## Summary Diagram: Basic Bazel Workflow

```mermaid
flowchart TD
  A[Create Workspace Directory] --> B[Create MODULE.bazel with googletest]
  B --> C[Write test source file (hello_test.cc)]
  C --> D[Add BUILD file with cc_test rule]
  D --> E[Run `bazel test` command]
  E --> F[Test executes and outputs results]
  F --> G{Test Passed?}
  G -->|Yes| H[Start writing more tests]
  G -->|No| I[Troubleshoot build or test issues]
```

---

By following these steps carefully, you establish a stable foundation for using GoogleTest and GoogleMock in Bazel-based C++ projects.


---

For detailed commands and environment-specific notes, refer to the official Bazel and GoogleTest documentation links provided.


---