---
title: "Troubleshooting Installation & Build Problems"
description: "Lists frequent setup and build errors with clear, actionable solutions. Empowers users to independently resolve issues such as incompatible compilers, linking errors, or missing dependencies."
---

# Troubleshooting Installation & Build Problems

When setting up GoogleTest and GoogleMock, encountering build or installation issues can disrupt your progress. This guide empowers you to independently identify, diagnose, and resolve the most frequent errors related to compiler incompatibilities, linking problems, and missing dependencies.

---

## 1. Common Setup Issues and Solutions

### 1.1 Compiler Incompatibility

GoogleTest requires a compiler that supports **C++17** or newer. Errors indicating missing C++17 features or unsupported language constructs usually point to an incompatible compiler.

**How to fix:**

- Verify your compiler version supports C++17. For example:
  - GCC ≥ 7.0
  - Clang ≥ 5.0
  - MSVC ≥ Visual Studio 2017 (15.3)

- Explicitly set the C++ standard in your build system to C++17:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

- If your environment defaults to an older standard, add the flag manually, e.g., `-std=c++17`.

<Tip>
Many build errors referencing C++17 features stem from missing or incorrect compiler flags. Always check your build configuration to ensure the C++17 standard is enabled.
</Tip>

### 1.2 Missing or Incorrect GoogleTest/GMock Libraries

Errors like "undefined reference to ..." or "cannot find -lgmock" indicate that the linker cannot find required GoogleTest or GoogleMock libraries.

**How to fix:**

- Confirm that GoogleTest and GoogleMock libraries are built successfully.
- Link the appropriate target in your project (`gtest`, `gmock`, or `gmock_main`) matching your setup.

Example linking with CMake:

```cmake
find_package(GTest REQUIRED) # or use FetchContent to add googletest

target_link_libraries(your_test_target PRIVATE gmock_main)  # Includes GoogleMock and main()
```

- Make sure library search paths are configured correctly if using manual or legacy build systems.

- If using precompiled binaries, verify they match your compiler and linkage setup (static vs dynamic).

### 1.3 Conflicts with the C Runtime on Windows

On Windows, linking errors referencing mismatched 'RuntimeLibrary' settings in Visual Studio happen when your project and GoogleTest use different runtime types (static vs dynamic).

**How to fix:**

- Use the `gtest_force_shared_crt` option in CMake when incorporating GoogleTest:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This forces GoogleTest to link the runtime dynamically, matching typical Visual Studio project settings.

- Ensure all projects and dependencies consistently use either static or dynamic CRT.

<Tip>
Inconsistent runtime linkage is a common pitfall on Windows. Aligning this on all components prevents linker errors and subtle runtime issues.
</Tip>

### 1.4 Multiple Definitions or Linker Errors with `main()`

If you see linker errors about multiple definitions of `main()` or unresolved `main()` symbols, this usually means conflicting or missing entry points.

**How to fix:**

- Decide whether you want to use GoogleTest or GoogleMock's provided `main()`.
- Link with either `gtest_main`/`gmock_main` which provide `main()` or provide your own `main()` function.

- Avoid linking both `gtest_main` and `gmock_main` simultaneously.

- For specialized platforms (e.g., embedded systems), follow platform-specific instructions on defining `main()`.

### 1.5 Missing Dependencies or Headers

Build errors indicating missing headers such as `gtest/gtest.h` or `gmock/gmock.h` occur when include paths are not set correctly.

**How to fix:**

- Ensure your build system includes the directories:
  - `${googletest_SOURCE_DIR}/include`
  - `${googlemock_SOURCE_DIR}/include`

Example for CMake:

```cmake
include_directories(${gtest_SOURCE_DIR}/include ${gmock_SOURCE_DIR}/include)
```

- If using FetchContent or `add_subdirectory`, these are usually set automatically.

### 1.6 Threading and Link Errors for PThread

GoogleTest supports multi-threaded tests if the pthread library is available, but missing linker flags cause unresolved external symbols.

**How to fix:**

- Set the appropriate compile and link flags for pthread, like `-pthread` on Linux.

- If CMake is used, it often manages this automatically.

- For some environments, you may need to define:

```cmake
-DGTEST_HAS_PTHREAD=1
```

in your C++ flags.

### 1.7 CMake Version Requirements

GoogleTest’s build scripts require **CMake 3.13** or later. Using older versions can result in configuration failures.

**How to fix:**

- Update your CMake installation to the minimum required version.

- Verify your environment’s PATH and CMake version via:

```bash
cmake --version
```

## 2. Step-by-Step Diagnosis Checklist

Following this workflow helps efficiently resolve build problems:

<Steps>
<Step title="Verify Compiler Version and Settings">
Check that your compiler supports C++17 and that the build system enables it.
</Step>
<Step title="Confirm GoogleTest/GMock Source or Binaries">
Ensure you have cloned or downloaded the correct gtest and gmock source versions.
</Step>
<Step title="Build GoogleTest/GMock Libraries">
Follow the official instructions to build the libraries with your compiler and verify that output libraries are generated.
</Step>
<Step title="Configure Include and Link Paths">
Make sure your project includes headers and links to the built libraries properly.
</Step>
<Step title="Check for Multiple `main()` Definitions">
If you provide your own `main()`, do not link `gtest_main` or `gmock_main`.
</Step>
<Step title="Resolve Platform-Specific Settings">
Adjust threading, runtime libraries, and other platform-specific build flags as needed.
</Step>
<Step title="Clean and Rebuild">
Perform a full clean build to ensure no stale artifacts cause conflicts.
</Step>
</Steps>

## 3. Troubleshooting Examples

### Example 1: Undefined reference to testing::InitGoogleMock

- Cause: Linking test does not include GoogleMock libraries.
- Solution: Link against `gmock` or `gmock_main`.

```cmake
target_link_libraries(your_test_target PRIVATE gmock_main)
```

### Example 2: "mismatch detected for 'RuntimeLibrary'" on Windows

- Cause: Mixing static and dynamic CRT linkage.
- Solution: Enable `gtest_force_shared_crt` in CMake or unify runtime linkage across your project.

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

### Example 3: "fatal error: gtest/gtest.h: No such file or directory"

- Cause: Missing include directories.
- Solution: Add path to GoogleTest headers in your build configuration.

```cmake
include_directories(${gtest_SOURCE_DIR}/include)
```

### Example 4: Multiple definitions of `main`

- Cause: Linking both `gtest_main` and defining your own `main` function.
- Solution: Either remove your own `main()` or do not link `gtest_main`.

### Example 5: Linker errors with pthread symbols on Linux

- Cause: Missing pthread linkage or compiler flags.
- Solution: Add `-pthread` to compiler and linker flags.

```cmake
set(THREADS_PREFER_PTHREAD_FLAG ON)
find_package(Threads REQUIRED)
target_link_libraries(your_test_target PRIVATE Threads::Threads)
```

## 4. Best Practices to Avoid Build Issues

- Use CMake to manage builds, as it handles dependencies and system differences robustly.
- Match compiler and library build configurations, especially debug/release modes and runtime linkage.
- Regularly update your compiler and build tools to supported versions.
- Utilize GoogleTest's `gmock_main` if you prefer not to write a custom `main()`.
- Perform clean builds when switching configurations to avoid stale conflicts.

## 5. Additional Resources

- [GoogleTest Installation Methods](../../getting-started/prerequisites-and-installation/installation-methods)
- [System Requirements & Supported Platforms](../../getting-started/prerequisites-and-installation/system-requirements)
- [Project Setup with CMake](../../getting-started/configuration-and-first-run/project-setup)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [CMake Official Website](https://cmake.org/)

---

If you continue to experience issues beyond those covered here, consult community forums or Google's GitHub repository issues page for more nuanced help.

<Check>
Verifying your build environment and systematically following these troubleshooting steps will resolve the majority of installation and build problems with GoogleTest and GoogleMock.
</Check>
