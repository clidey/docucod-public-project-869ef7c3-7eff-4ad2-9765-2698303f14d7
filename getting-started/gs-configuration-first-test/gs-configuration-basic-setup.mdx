---
title: "Configuring Your Project"
description: "Covers how to add GoogleTest and GoogleMock includes and link the necessary libraries. Explains basic project structure and typical configuration flags to get started painlessly."
---

# Configuring Your Project

This guide walks you through configuring your C++ project to correctly include and link GoogleTest and GoogleMock. It explains the basic project structure, how to add the necessary include paths and libraries, and the typical flags and settings needed for a smooth and painless setup.

---

## 1. Understanding the Basic Project Structure

GoogleTest and GoogleMock provide testing functionality built on top of C++. To use them effectively, your project needs to:

- Include the GoogleTest and GoogleMock header files.
- Link against the appropriate GoogleTest and GoogleMock libraries.

### Typical Layout

Your project directory may look like this:

```
/project-root/
  ├── src/
  │    └── your_code.cc
  ├── tests/
  │    ├── your_tests.cc
  │    └── CMakeLists.txt (or build files)
  ├── googletest/   # optionally, GoogleTest source (if vendored)
  ├── googlemock/   # optionally, GoogleMock source (if vendored)
  └── CMakeLists.txt
```

- Header files from GoogleTest and GoogleMock must be added to your include path.
- Your test source files should include the proper GoogleTest / GoogleMock headers:

```cpp
#include <gtest/gtest.h>   // For GoogleTest
#include <gmock/gmock.h>   // For GoogleMock
```


---

## 2. Adding Includes and Linking Libraries

### Header Includes

Add the include directories for GoogleTest (`googletest/include`) and GoogleMock (`googlemock/include`) to your compiler's search path. If installed system-wide or via package manager, these paths are usually configured automatically.

Example for CMake:

```cmake
# Assuming googletest and googlemock are fetched or installed
find_package(GTest REQUIRED) # Provides gtest and gmock targets

include_directories(${GTEST_INCLUDE_DIRS})
```

Or if integrated as a subdirectory:

```cmake
add_subdirectory(googletest)
add_subdirectory(googlemock)

include_directories(
  ${PROJECT_SOURCE_DIR}/googletest/include
  ${PROJECT_SOURCE_DIR}/googlemock/include
)
```


### Libraries to Link

Link your test executables against these libraries:

- `gtest`  : GoogleTest library
- `gmock`  : GoogleMock library
- `gtest_main` or `gmock_main` : libraries providing a default `main()` function to run tests

For most cases, linking with `gmock_main` is recommended when using GoogleMock, as it includes `main()` and GoogleTest.

Example linking in CMake:

```cmake
add_executable(your_tests your_tests.cc)
target_link_libraries(your_tests gmock_main)
add_test(NAME YourTests COMMAND your_tests)
```

For GoogleTest-only projects, link with `gtest_main` instead.

---

## 3. Typical Configuration Flags

To ensure correct and consistent builds, use the following common flags:

### C++ Standard

GoogleTest and GoogleMock require at least C++17 support.

In CMake:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### Threading

GoogleTest can leverage the pthread library for thread safety where available.
If your environment does not detect pthread automatically, add:

```cmake
add_definitions(-DGTEST_HAS_PTHREAD=1)
```

and link pthread when needed:

```cmake
find_package(Threads REQUIRED)
target_link_libraries(your_tests Threads::Threads)
```

### Shared Libraries

If you choose to build or link GoogleTest/GoogleMock as shared libraries, define the following:

```cmake
add_definitions(-DGTEST_CREATE_SHARED_LIBRARY=1)
add_definitions(-DGTEST_LINKED_AS_SHARED_LIBRARY=1)
```

Note that in most cases static linking simplifies your build and usage.

### Macro Name Clashes

If you have macro collisions with GoogleTest macros, you can rename them by disabling default definitions and using the prefixed macros (e.g., `GTEST_TEST` instead of `TEST`):

```cmake
add_definitions(-DGTEST_DONT_DEFINE_TEST=1)
```

---

## 4. Minimal Example of a CMakeLists.txt for Tests

```cmake
cmake_minimum_required(VERSION 3.16)
project(MyProjectTests)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Add GoogleTest and GoogleMock
find_package(GTest REQUIRED)

add_executable(my_tests tests/your_tests.cc)

# Link against gmock_main (includes GoogleTest and main())
target_link_libraries(my_tests gmock_main Threads::Threads)

# Add the test to CTest
enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

---

## 5. Summary: Steps to Get Started with Configuration

1. Ensure C++17 or higher is enabled in your build system.
2. Add GoogleTest and GoogleMock include directories.
3. Link your test executable against `gmock_main` (or `gtest_main` for GoogleTest only).
4. Include `<gtest/gtest.h>` and optionally `<gmock/gmock.h>` in your test source files.
5. Use `RUN_ALL_TESTS()` as the entry point for running tests (usually via `gmock_main`).
6. Configure threading support as needed.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Common Setup Issues">
<Accordion title="Compiler Errors: Missing Headers">
Make sure your include directories point to the correct GoogleTest and GoogleMock headers. Check your include paths and confirm that the packages are installed or submodules are properly added.
</Accordion>

<Accordion title="Linker Errors: Undefined References">
Ensure you link your test executables against the correct GoogleTest and GoogleMock libraries, especially `gmock_main` if you rely on the provided `main()` function.
</Accordion>

<Accordion title="C++ Standard Errors">
If the compiler complains about unsupported C++ features, verify that C++17 or higher is set in your compiler flags.
</Accordion>

<Accordion title="Threading Issues">
If GoogleTest reports missing pthread support or linker errors related to pthreads, add the pthread library to your linker settings and define `GTEST_HAS_PTHREAD=1` if needed.
</Accordion>
</AccordionGroup>

---

## 7. Additional Resources

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — foundational guide on writing tests.
- [Setting Up and Running Your First Test](https://github.com/google/googletest/blob/main/docs/guides/getting-started/setup-quickstart.md) — walkthrough for first test execution.
- [Mocking with GoogleMock](https://github.com/google/googletest/blob/main/docs/guides/getting-started/gs-mock-first-steps.md) — introduction to mocks.
- [Using GoogleTest with CMake](https://github.com/google/googletest/blob/main/README.md) — official CMake build tips.

---

By carefully adding include paths and linking the appropriate libraries, setting your compiler to C++17, and configuring threading support, you ensure that your project is correctly set up for using GoogleTest and GoogleMock with minimal friction.


---

<Check>Ensure your test executables link against `gmock_main` or `gtest_main` to avoid writing your own `main()` unless customization is needed.</Check>

<Check>Always call `testing::InitGoogleMock()` or `testing::InitGoogleTest()` before `RUN_ALL_TESTS()` (the provided main functions do this for you).</Check>


<section><Note>Including GoogleMock implies GoogleTest linkage as well — linking `gmock_main` covers both automatically.</Note></section>
