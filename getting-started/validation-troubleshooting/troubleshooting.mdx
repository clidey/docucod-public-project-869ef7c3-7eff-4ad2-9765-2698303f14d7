---
title: "Troubleshooting Common Issues"
description: "Identify and resolve common installation and configuration errors that may occur while setting up GoogleTest and GoogleMock. Find quick solutions to typical build, linkage, or runtime problems."
---

# Troubleshooting Common Issues

Setting up GoogleTest and GoogleMock can occasionally present challenges related to installation, build, linkage, or runtime behavior. This guide helps you identify and resolve typical issues swiftly, ensuring your test framework runs smoothly.

---

## 1. Build and Installation Problems

### Problem: Compilation Fails or Crashes

- **Verify your C++ compiler version** meets the minimum requirements as listed in [System Requirements & Supported Platforms](https://github.com/google/googletest/blob/main/getting-started/prerequisites-install/system-requirements.mdx).
- **Avoid using the `/clr` compiler flag in MSVC** when compiling mocks, as it significantly increases memory usage and can cause failures.
- If your mock class is very large, **split your mock class definitions** into `.h` and `.cc` files to reduce compile time (see [gmock_cook_book#MakingTheCompilationFaster](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#MakingTheCompilationFaster)).

### Problem: Linking Errors with GoogleMock

- Make sure you include the `gmock` library properly in your build dependencies (follow instructions in [Integrating with Your Build System](https://github.com/google/googletest/blob/main/getting-started/project-setup/project-integration.mdx)).
- Link with `gmock_main` if you want a default main function.
- Check that your source files include the correct headers: `#include <gmock/gmock.h>` before using mocking macros.

---

## 2. Runtime Issues and Unexpected Behavior

### Problem: Real Method Called Instead of Mock

- Confirm that methods you want to mock are declared `virtual`. GoogleMock requires methods to be virtual to mock them directly.
- If you want to mock non-virtual methods, see the technique described in the Cookbook's [Mocking Non-virtual Methods](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#MockingNonVirtualMethods).

### Problem: "Uninteresting function call encountered" Warning

This warning indicates a mock method was called but no expectation (`EXPECT_CALL`) was set.

- **Solution:** If you want to ignore such calls, use `ON_CALL` to set a default action or wrap your mock object with `NiceMock<>` to suppress warnings.
- If you expect calls but don't care about arguments or number, add a catch-all expectation:

```cpp
EXPECT_CALL(mock_obj, Method(_)).Times(AnyNumber());
```

- **Avoid suppressing warnings by blindly adding many `EXPECT_CALL`s** without intent.
- More details: [Understanding Uninteresting vs Unexpected Calls](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#uninteresting-vs-unexpected).

### Problem: Unexpected Calls Leading to Test Failures

- Unexpected calls happen when calls to a mock method do not match any declared expectation.
- Ensure all expected calls have a corresponding `EXPECT_CALL` with the right matchers.
- To relax strictness, add catch-all expectations or use `NiceMock`.

### Problem: Excessive Calls Fail Tests

- Excessive calls occur when a mock method is called more times than its expectation's cardinality.
- For sequential or exact call counts, see usage of `.RetiresOnSaturation()` and `InSequence()` to make expectations retire when saturated.
- See [Expectation Ordering](https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md#expectation-ordering) and [RetiresOnSaturation](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#ControllingWhenAnExpectationRetires) for solutions.

---

## 3. Common Mistakes and How to Avoid Them

### Using `EXPECT_CALL` after the Mock Has Been Called

GoogleMock requires expectations to be set *before* invoking mock methods; setting expectations after calls results in undefined behavior and missed errors.

**Best practice:** Set all expectations immediately after creating the mocks and before user code runs.

### Mock Methods Hidden Due to Overloads

When mocking some overloads but not others, the base class overloads may be hidden, causing compiler warnings or errors.

**Fix:** Use `using` to bring base class overloads into scope:

```cpp
class MockFoo : public Foo {
 public:
  using Foo::Add;
  MOCK_METHOD(int, Add, (Element x), (override));
};
```

### Forgetting to Mark Mocked Methods as `override` or `const`

- Use the fourth parameter of `MOCK_METHOD` to specify `const`, `override`, and other qualifiers.
- For example:

```cpp
MOCK_METHOD(int, GetValue, (), (const, override));
```

Helps maintain correctness and compatibility.

### Copying Mock Objects

- Copying mocks is generally not supported; avoid it to prevent subtle bugs.

### Leaked Mock Objects

- If mocks are dynamically allocated but never deleted, final verification won't occur, leading to false positives.
- Enable heap checking and delete mocks properly.
- To mark an intentional leak, call:

```cpp
Mock::AllowLeak(mock_ptr);
```

### Debugging with Verbose Output

Run your tests with `--gmock_verbose=info` to see detailed traces of mock calls and expectations. Combine with `--gtest_stack_trace_depth=0` to suppress stack traces if desired.

---

## 4. Debugging Output Examples

The GoogleMock test suite includes coverage of many error scenarios that illustrate typical messages you might encounter:

- Unexpected calls
- Excessive calls
- Uninteresting calls
- Unsatisfied prerequisites

See [GoogleMock Output Test](https://github.com/google/googletest/blob/main/googlemock/test/gmock_output_test_.cc) and the corresponding golden logs for sample diagnostic messages.

---

## 5. Recommended Next Steps

- Review your tests and expectations to ensure **all mock calls are anticipated with `EXPECT_CALL` or covered with `ON_CALL`**.
- Use `NiceMock<>` or `StrictMock<>` wrappers judiciously to manage verbosity and strictness.
- Utilize `InSequence` to enforce call orders where needed.
- For complex expectations, leverage diagnostic tools like the `--gmock_verbose=info` flag.
- Consult the following documentation for deeper understanding and examples:
  - [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md)
  - [gMock for Dummies](https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md)
  - [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md)

---

For unresolved or unusual errors, consider seeking help via community channels or raise an issue referencing your scenario and error messages.

---

<Note>
Always ensure your mock methods correspond exactly to the intended signatures and that expectations are set prior to test execution to avoid subtle runtime errors or silent test passes.
</Note>