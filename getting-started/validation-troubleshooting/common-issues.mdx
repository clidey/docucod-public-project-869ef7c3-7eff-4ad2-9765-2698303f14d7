---
title: "Troubleshooting Common Setup Issues"
description: "Address frequent problems such as missing dependencies, build errors, linker problems, and configuration mistakesâ€”empowering users to quickly recover and proceed."
---

# Troubleshooting Common Setup Issues

When setting up GoogleTest and GoogleMock for the first time, it is common to encounter obstacles related to missing dependencies, build errors, linker problems, and configuration mistakes. This guide addresses frequent setup issues and empowers you to diagnose and resolve them quickly, so you can proceed confidently with writing and running your tests.

---

## 1. Missing Dependencies

### Problem
You might see errors like `No such file or directory` or `cannot find -lgtest` when building your test programs.

### Causes
- GoogleTest or GoogleMock is not installed or not properly included in your project.
- Include directories or library paths are not correctly specified.
- Required compiler or C++ standard library versions are not met.

### Solutions
1. **Verify Installation**:
   - Confirm that GoogleTest and GoogleMock sources are downloaded or installed.
   - If using package managers (like apt, brew), check the package installation.

2. **Check Include Paths**:
   - Ensure your compiler's include directories (`-I` flags) point to the locations of the `gtest` and `gmock` headers.

3. **Specify Linker Flags**:
   - Link against the correct libraries, e.g., `-lgtest -lgmock -lpthread`.
   - If libraries are in non-standard locations, specify `-L` flags with the path.

4. **C++ Standard**:
   - Confirm your compiler supports C++11 or higher (recommended GCC 7+, Clang 3.4.1+, MSVC 2017+).
   - Pass the appropriate compiler flags (`-std=c++11` or similar).

<Tip>
Refer to the [System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/system-requirements.md) guide to verify supported platforms and compiler versions.
</Tip>

---

## 2. Build Errors

### Problem
Compilation fails with errors such as missing symbols, template errors, or macro expansion issues.

### Common Causes & Fixes
- **Unprotected Commas in Mock Methods**
  - If `MOCK_METHOD` parameters include template types with commas (e.g., `std::pair<int, int>`), use one of the following:

```cpp
MOCK_METHOD((std::pair<int, int>), GetPair, ());
// Or
using IntPair = std::pair<int, int>;
MOCK_METHOD(IntPair, GetPair, ());
```

- **Incorrect Use of MOCK_METHOD Qualifiers**
  - Check that if the mocked method is `const`, the macro includes `(const, override)`.
  - For example:

```cpp
MOCK_METHOD(int, GetValue, (), (const, override));
```

- **Virtual Destructor Requirement**
  - Ensure base classes you mock have virtual destructors to prevent compilation and runtime issues.

- **Missing Macro Usage in Right Access Section**
  - Always place `MOCK_METHOD` in the `public` section of your mock class, even for mocking protected/private methods.

- **Compiler Compatibility Issues**
  - Use recommended compiler versions with proper flags.

<Tip>
Review [Defining Mocks and Mocked Methods](https://github.com/google/googletest/tree/main/docs/api-reference/mocking-api/defining-mocks-and-methods.md) and [gMock Cookbook](https://github.com/google/googletest/tree/main/docs/gmock_cook_book.md) for detailed guidance on common pitfalls.
</Tip>

---

## 3. Linker Errors

### Problem
Linker fails with `undefined reference` errors for GoogleTest or GoogleMock symbols.

### Causes
- GoogleTest/GoogleMock libraries were not linked in.
- Multiple conflicting versions of libraries.
- Building only header files without compiling the sources.

### Solutions
1. **Link All Required Libraries**:

```bash
-lpthread -lgtest -lgmock
```

If you built GoogleTest/GoogleMock from source, ensure you compile and link to the generated static or shared libraries.

2. **Static vs Dynamic Linking**:
  - If you want static linking, build `libgtest.a` and `libgmock.a`.
  - For dynamic linking, ensure that correct `.so` or `.dll` files are found.

3. **Build GoogleTest/GoogleMock Libraries Properly**:
  - With CMake:
    
```bash
cmake .
make
sudo make install  # Optional, for system-wide install
```

4. **Avoid Multiple Definitions**:
  - Don't include GoogleTest sources directly multiple times in different compilation units.

5. **Verify Library Paths**:
  - Add linker flags `-L/path/to/libs` if needed.

6. **Build from Source Integration**:
  - Consider manual compilation of GoogleTest sources alongside your tests if not using prebuilt libraries.

<Tip>
Consult [Installation Guides](https://github.com/google/googletest/tree/main/docs/getting-started/prerequisites-installation/manual-installation.md) for manual source integration and linking.
</Tip>

---

## 4. Configuration Mistakes

### Problem
Tests compile but crash, fail unexpectedly, or produce confusing errors related to test environment or runtime.

### Issues and Resolution
- **Missing `testing::InitGoogleTest()` call**
  - Always invoke `InitGoogleTest(&argc, argv)` before calling `RUN_ALL_TESTS()` in your `main()`.

```cpp
int main(int argc, char** argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- **Improper Test Fixture Setup**
  - Use `SetUp()` and `TearDown()` properly; don't confuse `SetUp` with `Setup` (case-sensitive).

- **Disabled Tests not Running**
  - Tests prefixed with `DISABLED_` are skipped by default. Use `--gtest_also_run_disabled_tests` to include them.

- **Command Line Flags Neglected**
  - GoogleTest parses command line arguments for its flags; unrecognized flags might interfere if `InitGoogleTest` is missing.

- **Running Tests in Multi-threaded Context Unsafely**
  - GoogleTest is thread-safe in POSIX with pthreads but avoid assertions from multiple threads on unsupported platforms (like Windows).

- **Incorrect Usage of Assertions in Non-void Functions**
  - Fatal assertions like `ASSERT_*` must be in void-returning functions; use non-fatal assertions otherwise.

<Tip>
See [GoogleTest Primer](https://github.com/google/googletest/tree/main/docs/primer.md) for test structure and proper initialization.
</Tip>

---

## 5. Common Pitfalls and Best Practices

- **Setting Expectations Before Use**
  - Always set `EXPECT_CALL` on mock objects before exercising the code under test to avoid undefined or surprising behavior.

- **Handling Complex Return Actions**
  - For complex or stateful return actions in mocks, consider using lambdas or custom actions rather than simple `Return()`.

- **Suppressing Uninteresting Call Warnings**
  - Use `NiceMock` to avoid warnings for uninteresting calls, or write wildcard expectations.

- **Understanding Cardarity Inference in EXPECT_CALL**
  - If you omit `Times()`, GoogleTest infers the number of expected calls from presence of `WillOnce()` and `WillRepeatedly()`.

- **Name Testing Suites and Tests Properly**
  - Avoid underscores; follow C++ naming conventions for clarity and consistency.

<Tip>
Refer to [gMock for Dummies](https://github.com/google/googletest/tree/main/docs/getting-started/first-test-usage/using-googlemock.md) and [gMock FAQ](https://github.com/google/googletest/tree/main/docs/gmock_faq.md) for deeper mock usage and troubleshooting.
</Tip>

---

## 6. Troubleshooting Steps Summary

Use this checklist when facing setup issues:

1. **Verify installation and source availability** of GoogleTest/GoogleMock.
2. **Confirm All Include and Library Paths** are correctly specified.
3. **Validate compiler compatibility and C++ version** settings.
4. **Ensure proper usage of macros and test initialization code**.
5. **Check linking commands and library presence**.
6. **Run with increased verbosity**: use `--gmock_verbose=info` or `--gtest_verbose=info` for detailed logs.
7. **Use minimal test samples** to isolate and reproduce setup problems.

---

## 7. Where to Get Help

- **Official Documentation**: Review the following resources:
  - [GoogleTest Primer](primer.md)
  - [API References](reference/testing.md, reference/mocking.md, reference/assertions.md)
  - [gMock Cookbook](gmock_cook_book.md)
  - [gMock Cheat Sheet](gmock_cheat_sheet.md)

- **Community and Issue Tracker**: Check GitHub issues or community forums for help.

- **Integration and Build Guides**: Review platform-specific instructions for build tools and CI integration.

<Tip>
Debugging tips include running tests with `--gmock_verbose=info` for extensive mock call tracebacks and using `--gtest_list_tests` to verify test discovery.
</Tip>