---
title: "Troubleshooting Common Issues"
description: "Eliminate friction with tips for resolving frequent setup and execution errors, like linking issues, missing headers, version mismatches, or unsupported compilers. Quickly find practical solutions so you can move forward with testing."
---

# Troubleshooting Common Issues

Eliminate friction with these practical tips for resolving frequent GoogleTest setup and execution errors. Whether you face linking issues, missing headers, version mismatches, or unsupported compilers, this guide directs you to quick solutions so you can move forward with testing confidently.

---

## 1. Linking Errors

### Symptoms
- Undefined references to GoogleTest symbols during the linking phase.
- Linker cannot find symbols such as `RUN_ALL_TESTS()`, test fixtures, or GoogleMock mock methods.

### Causes
- GoogleTest or GoogleMock libraries are not linked properly.
- Missing or incorrect link flags in your build system (e.g., CMake, Bazel).
- Mixing static and shared library linkage improperly.

### Solutions
1. **Verify Link Libraries:**
    - Ensure you link against `gtest` and, if using mocks, `gmock` libraries.
    - For CMake, include `target_link_libraries(your_target gtest gmock)`.
    - For Bazel, confirm dependencies on `//external:com_google_googletest` or `//external:com_google_gmock` are declared.

2. **Check Build Configurations:**
    - Confirm your build system knows where library files and headers reside.
    - Check for typos or misconfigurations in include directories and link directories.

3. **Use Provided Targets:**
    - Prefer linking with `gtest::gtest` and `gtest::gmock` targets in modern CMake setups.

4. **Example - Linking in CMake:**

    ```cmake
    find_package(GTest REQUIRED)
    add_executable(my_tests test_main.cpp my_test.cpp)
    target_link_libraries(my_tests GTest::gtest GTest::gmock)
    ```

5. **Static vs Shared:**
    - Mixing static and shared libraries can cause issues; unify linkage types when possible.

<Note>
Linking errors can often be traced to missing or incorrectly specified link dependencies. Careful validation of your build configuration mitigates the majority of such issues.
</Note>

---

## 2. Missing Headers or Include Failures

### Symptoms
- Compiler errors indicating missing `gtest/gtest.h` or `gmock/gmock.h` files.
- Include file not found errors.

### Causes
- Include directories are not set correctly.
- Source files cannot find the GoogleTest headers.

### Solutions
1. **Set Include Paths Properly:**
    - In CMake, use `target_include_directories()` or `find_package(GTest)` which sets these automatically.

2. **Confirm Installation:**
    - Ensure GoogleTest/GoogleMock headers are installed or present in your project tree.

3. **Example - CMake Target Include:**

    ```cmake
    target_include_directories(my_tests PRIVATE ${GTEST_INCLUDE_DIRS})
    ```

4. **Use `GTest::gtest` Target:**
    - This target in CMake automatically configures include directories.

<Warning>
Avoid manually copying headers or modifying system include directories unless absolutely necessary, as this can cause version conflicts.
</Warning>

---

## 3. Compiler Version or Standard Mismatch

### Symptoms
- Compilation errors related to C++ features or standard library availability.
- Unexpected warnings or errors regarding language features.

### Causes
- GoogleTest requires at least a C++17 compatible compiler.
- Using incompatible compiler versions or incorrect language standard flags.

### Solutions
1. **Verify Compiler Support:**
    - Confirm your compiler supports C++17 or later (GoogleTest requires C++17 minimum).

2. **Set Language Standard in Build:**
    - For CMake:
      ```cmake
      set(CMAKE_CXX_STANDARD 17)
      set(CMAKE_CXX_STANDARD_REQUIRED ON)
      ```

3. **Update Compiler if Necessary:**
    - Upgrade to GCC 7+, Clang 5+, MSVC 2017 (15.7)+ or later.

4. **Cross-Platform Considerations:**
    - Ensure all build tools and IDEs respect the language standard flag.

<Note>
Mismatch in compiler versions or standard flags often causes cryptic errors and subtle bugs. Adhering to GoogleTest’s minimum C++17 standard is mandatory.
</Note>

---

## 4. Runtime Errors and Test Execution Issues

### Symptoms
- Tests do not run or exit prematurely.
- `RUN_ALL_TESTS()` returns failure without clear reason.
- Errors related to GoogleTest initialization.

### Causes
- Failure to correctly initialize GoogleTest runtime.
- Missing or incorrect `main()` function.
- Incorrect use of `TEST` or `TEST_F` macros.

### Solutions
1. **Initialize GoogleTest Before Running:**
   Always invoke:

   ```cpp
   testing::InitGoogleTest(&argc, argv);
   return RUN_ALL_TESTS();
   ```

2. **Use `gtest_main` if Possible:**
    - Link against `gtest_main` to avoid writing your own `main()`.

3. **Check `TEST` and `TEST_F` Usage:**
    - Use `TEST` for simple tests.
    - Use `TEST_F` when using fixtures.

4. **Diagnostic Build:**
    - Run tests with verbosity flags, e.g., `--gtest_verbose=info` to gain more insights.

<Info>
For typical test programs, linking with `gtest_main` greatly simplifies test execution setup.
</Info>

---

## 5. GoogleMock Specific Issues

### Symptoms
- Mock methods not behaving as expected.
- Unexpected calls or uninteresting call warnings.
- Failure to link against GoogleMock.

### Causes
- GoogleMock headers not included properly.
- Expectations not set before mock method calls.
- Strictness level of mocks causing unexpected test failures.

### Solutions
1. **Include `gmock/gmock.h`:**
    - For mocking functionality, always include `<gmock/gmock.h>`.

2. **Set Expectations Before Use:**
    - Define `EXPECT_CALL` or `ON_CALL` before exercising mock methods.

3. **Control Mock Strictness:**
    - Use `NiceMock` to suppress warnings on uninteresting calls.
    - Use `StrictMock` to enforce calls only match expectations.

4. **Default Actions:**
    - Use `ON_CALL` to specify default behavior and avoid unexpected call failures.

5. **Verbose Diagnostics:**
    - Run tests with `--gmock_verbose=info` to trace mock interactions.

6. **Example - Using NiceMock:**

    ```cpp
    using ::testing::NiceMock;
    NiceMock<MockFoo> mock_foo;
    EXPECT_CALL(mock_foo, DoSomething());
    ...
    ```

---

## 6. Version Mismatch and Third-Party Integration

### Symptoms
- Compiler or linker errors referencing multiple versions of GoogleTest.
- Conflicts when GoogleTest is bundled in dependencies.

### Causes
- Different versions of GoogleTest/GoogleMock included in the same build.
- Prebuilt binaries or libraries linked against incompatible versions.

### Solutions
1. **Single Version Policy:**
    - Ensure all dependencies use the same GoogleTest/GoogleMock version.

2. **Use Submodule or Package Manager:**
    - Manage dependencies via a consistent package version.

3. **Isolate GoogleTest in Testing Scope:**
    - Link GoogleTest only with test binaries; exclude from production binaries.

4. **Clean Rebuild:**
    - Perform a clean build after updating or changing versions.

---

## 7. Common Pitfalls & Best Practices

- **Don’t set expectations after the code that calls the mock method executes.**
- **Be mindful of sticky expectations:** they remain active after being satisfied unless `.RetiresOnSaturation()` is used.
- **Use `.RetiresOnSaturation()` to avoid upper bound call errors in sequences or multiple calls.**
- **Avoid mocking non-virtual methods unless using advanced high-perf injection or templates.**
- **Ensure destructors in mocked base classes are virtual to avoid leaks.**

---

## 8. Debugging Tips

- Run tests with `--gmock_verbose=info` to get detailed mock call traces.
- Use `EXPECT_NONFATAL_FAILURE` and similar GoogleTest features to isolate and test expectations.
- Check that all expectations are satisfied by the end of the test.
- Verify that your mock objects are destroyed properly at end of tests to trigger final verification.

---

## 9. Useful Links

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md) — Getting started with basic testing concepts.
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md) — Details on mocking API.
- [GoogleMock for Dummies](https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md) — Beginner’s guide to mocking.
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md) — Recipes for advanced mocking.
- [Quick Validation Checklist](../../getting-started/validation-troubleshooting/validate-setup.md) — Confirm your installation and setup.

---

## 10. When to Get Help

If troubleshooting with this guide doesn’t resolve your issue:

- Search or post on community forums like Stack Overflow using the `googletest` tag.
- Consult official GitHub issues: https://github.com/google/googletest/issues
- Review [Support & Community Resources](../../faq/support-community/community-help-channels.md) for guidance.

---

By understanding these common pitfalls and applying these pragmatic solutions, you can vastly reduce friction and get productive with GoogleTest and GoogleMock quickly.


---