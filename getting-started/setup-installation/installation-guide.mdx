---
title: "Installation Guide (CMake, Bazel, Manual)"
description: "Step-by-step instructions for installing GoogleTest and GoogleMock using CMake, Bazel, or manual integration. Learn how to add GoogleTest to your project based on your build system and platform, ensuring a smooth installation whatever your workflow."
---

# Installation Guide (CMake, Bazel, Manual)

Welcome to the step-by-step installation guide for adding GoogleTest and GoogleMock to your C++ project. Regardless of whether you prefer CMake, Bazel, or manual integration, this guide will walk you through how to properly install and configure these testing frameworks to work smoothly with your build environment.

---

## 1. Prerequisites & System Requirements

Before you start, ensure the following prerequisites are met:

- **Supported Platforms:** Linux, macOS, Windows, and embedded platforms with C++17 support.
- **Compiler:** A C++ compiler compatible with at least C++17 standard.
- **Build Tools:**
  - For CMake: CMake 3.14 or later, with a generator like Make, Ninja, or Visual Studio.
  - For Bazel: Bazel build system installed.
- **Network Access:** Required if downloading dependencies automatically (e.g., via CMake's FetchContent).

<Tip>
Check your compiler and build tool versions first to avoid common installation issues. For CMake, verify by running `cmake --version` and for Bazel, run `bazel version`.
</Tip>

---

## 2. Installation Instructions

### 2.1 Installing using CMake

GoogleTest works seamlessly with CMake. This method is flexible and works well on most platforms.

#### 2.1.1 Standalone GoogleTest Build

1. Clone the GoogleTest repository:

```bash
mkdir googletest_install && cd googletest_install
git clone https://github.com/google/googletest.git -b v1.17.0
dcd googletest
```

2. Create and enter a build directory:

```bash
mkdir build && cd build
```

3. Generate build files (include GoogleMock by default):

```bash
cmake ..
```

Or to build only GoogleTest without GoogleMock:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

4. Build the libraries:

```bash
make
```

5. Install GoogleTest and GoogleMock system-wide (requires admin access):

```bash
sudo make install
```

This installs the libraries and headers, typically under `/usr/local/`.

#### 2.1.2 Incorporating GoogleTest into Your Own CMake Project

You have two options:

- Use the installed version by calling `find_package(GTest CONFIG REQUIRED)`.
- Build GoogleTest as part of your project via `add_subdirectory()` or using CMake's FetchContent module.

Example using FetchContent in your `CMakeLists.txt`:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Require C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)  # Windows only
FetchContent_MakeAvailable(googletest)

add_executable(my_test test.cpp)
target_link_libraries(my_test GTest::gtest_main)

enable_testing()
include(GoogleTest)
gtest_discover_tests(my_test)
```

*Note:* Replace the URL and commit hash regularly to use the latest version.

---

### 2.2 Installing using Bazel

If your project uses Bazel as the build system, GoogleTest and GoogleMock are available as external dependencies within Bazel's ecosystem. To add GoogleTest using Bazel:

1. Add GoogleTest to your `WORKSPACE` file:

```starlark
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/release-1.11.0.tar.gz"],
    strip_prefix = "googletest-release-1.11.0",
)
```

2. In your Bazel `BUILD` file, declare a dependency on the GoogleTest targets:

```starlark
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

3. Build and run tests with Bazel commands:

```bash
bazel test //:my_test
```

---

### 2.3 Manual Integration

For projects not using CMake or Bazel, or for custom build environments, you can manually add GoogleTest and GoogleMock source files into your build system.

1. Clone or download the GoogleTest sources:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
```

2. Add the following directories to your compiler's include paths:

- `googletest/include`
- `googlemock/include`

3. Include the relevant source files from `googletest/src` and `googlemock/src` in your build:

- For GoogleTest: Add all `.cc` files under `googletest/src/`
- For GoogleMock: Add all `.cc` files under `googlemock/src/`

4. Link your test target against these sources.

<Tip>
Remember to compile your test binaries with the `-pthread` flag on POSIX systems to enable thread safety, as GoogleTest relies on pthread when available.
</Tip>

---

## 3. Configuration & Setup

### 3.1 Initial Configuration

- Ensure your compiler flags include `-std=c++17` or equivalent to support C++17 features required by GoogleTest.
- If building shared libraries with Visual Studio, set `gtest_force_shared_crt` to ON in CMake to avoid runtime library conflicts.

### 3.2 Credentials & Permissions

- No special credentials required.
- Installing system-wide typically requires administrative privileges.

### 3.3 Build System Configuration

- For CMake projects, prefer `target_link_libraries(your_test PRIVATE GTest::gtest_main)` to link GoogleTest.
- For Bazel, link tests against `@com_google_googletest//:gtest_main`.

<Tip>
Using `gtest_main` links GoogleTest’s main() implementation that automatically calls `RUN_ALL_TESTS()`, letting you focus on test code without writing your own main function.
</Tip>

---

## 4. First Operation Walkthrough

Let’s walk through building and running your first GoogleTest test binary using CMake.

### 4.1 Create a Simple Test Source

In your project directory, create `hello_test.cc` with this content:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

This test checks that "hello" is not equal to "world" and verifies a numeric equality.

### 4.2 Update Your `CMakeLists.txt`

Add the following to your `CMakeLists.txt` after fetching GoogleTest as shown earlier:

```cmake
enable_testing()

add_executable(hello_test hello_test.cc)
target_link_libraries(hello_test PRIVATE GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

### 4.3 Build Your Test

From your project root directory:

```bash
cmake -S . -B build
cmake --build build
```

### 4.4 Run Your Test Suite

Navigate to the build directory and run tests:

```bash
cd build
ctest
```

Expected output:

```
Test project /path/to/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

<Tip>
If you want to write a custom main() instead of linking with `gtest_main`, call `testing::InitGoogleTest()` and return `RUN_ALL_TESTS()` in your main function. However, linking with `gtest_main` saves time and reduces boilerplate.
</Tip>

---

## 5. Next Steps & Verification

### 5.1 Success Indicators

- Your test binary compiles and links without errors.
- Running `ctest` or executing your test binary runs all tests and returns zero exit code on success.
- Test results appear grouped by test suites in the output.

### 5.2 Common First Tasks

- Explore writing different types of tests using `TEST()` and `TEST_F()` macros (see [GoogleTest Primer](primer.md)).
- Try adding GoogleMock integration for mocks and stubs if required by your testing design.
- Learn about assertions, fixtures, and advanced test scenarios.

### 5.3 Troubleshooting

- **Linking Errors:** Ensure build links against `gtest`, `gtest_main`, or `gmock` libraries.
- **Pthread Errors:** On Unix-like systems, add `-pthread` to compiler and linker flags.
- **Runtime Errors:** Check your compiler supports C++17 and recompile with appropriate flags.

### 5.4 Where to Get Help

- Review [GoogleTest FAQ](faq.md) for common solutions.
- Visit [GoogleTest GitHub Issues](https://github.com/google/googletest/issues) for community help.
- Explore official guides: [GoogleTest Primer](primer.md), [Quickstart: Building with CMake](quickstart-cmake.md).

---

## Additional Resources

- [GoogleTest Primer](primer.md) — Learn how to write your first tests.
- [Quickstart Bazel Guide](quickstart-bazel.md) — For Bazel-based projects.
- [Mocking with GoogleMock](googlemock/README.md) — Add mocking to your tests.
- [Configuration & Initial Project Setup](configuration-setup.md) — Fine-tune your project setup.

Happy Testing!

---

## Appendix: Notes on `gmock_main` and `gtest_main` Libraries

GoogleTest provides two convenient libraries:

- `gtest_main`: Defines a `main()` function running all tests.
- `gmock_main`: Defines a `main()` function supporting GoogleMock alongside GoogleTest.

When linking, choose according to whether your tests use GoogleMock features.

Refer to `googlemock/src/gmock_main.cc` and `googletest/src/gtest_main.cc` for reference implementations.



---

<Check>
Ensure you have the correct C++ standard, build tools, and dependencies installed before starting.
</Check>

<Warning>
Link errors related to runtime libraries in Visual Studio can be resolved by enabling shared CRT via `gtest_force_shared_crt` in CMake.
</Warning>

<Info>
GoogleTest automatically detects pthread availability; override with `-DGTEST_HAS_PTHREAD=1` if necessary.
</Info>

