---
title: "Installation (CMake & Bazel)"
description: "Walks users through installing GoogleTest and GoogleMock using CMake and Bazel, the two primary build systems officially supported. Provides stepwise instructions for downloading, integrating, and building the libraries, ensuring users can get up and running regardless of their toolchain preference."
---

# Installation (CMake & Bazel)

This guide walks you through installing GoogleTest and GoogleMock using the two primary build systems officially supported: **CMake** and **Bazel**. Whether you're integrating testing into a new or existing project, you'll find step-by-step instructions to download, build, and link the libraries smoothly with your toolchain.

---

## Prerequisites & System Requirements

Before proceeding, ensure your environment meets the following prerequisites:

- **C++17 Compatible Compiler**: GoogleTest requires a compiler that supports the C++17 standard.
- **Build Tools**:
  - For CMake: Ensure CMake (3.14 or newer recommended) is installed.
  - For Bazel: Have Bazel installed with a compatible version for your platform.
- **Network Access**: To clone the repository or download source archives.
- **Permissions**: Sufficient permissions to build and, if needed, install the libraries.

For detailed system requirements, see the [Prerequisites & System Requirements](https://github.com/google/googletest/tree/main/docs/getting-started/setup-installation/system-requirements) page.

---

## Installation via CMake

GoogleTest includes GoogleMock by default when building via CMake. Follow these steps to set up:

### 1. Download the Source

Clone the repository or download a release archive:

```bash
git clone https://github.com/google/googletest.git -b main
cd googletest
```

### 2. Create and Enter a Build Directory

It's best practice to build out-of-source:

```bash
mkdir build
cd build
```

### 3. Generate Build Files

Run CMake to generate native build files.

- To build both GoogleTest and GoogleMock:

  ```bash
  cmake ..
  ```

- To build only GoogleTest (exclude GoogleMock):

  ```bash
  cmake .. -DBUILD_GMOCK=OFF
  ```

*Note*: On Windows, CMake will create Visual Studio project files by default.

### 4. Build the Libraries

- On Unix-like systems (Linux/macOS):

  ```bash
  make
  ```

- On Windows with Visual Studio:

  Open the generated solution file and build the `ALL_BUILD` project.

### 5. Optional: Install the Libraries

If you have sufficient permissions and want to install the built libraries and headers system-wide or to a custom directory:

```bash
sudo make install
```

or specify a prefix during configuration:

```bash
cmake -DCMAKE_INSTALL_PREFIX=/your/install/path ..
make
make install
```

### 6. Verify Installation

Check for the installation artifacts, typically:

- Headers in `/usr/local/include/gtest` and `/usr/local/include/gmock`
- Static/shared libraries like `libgtest.a`, `libgmock.a`, or equivalent.

You can also compile a simple test program linked against these libraries to confirm everything works.

---

## Installation via Bazel

Bazel offers integrated support for GoogleTest and GoogleMock. Use the following guide to build and run tests with Bazel.

### 1. Clone or Reference the Source

If you want to embed GoogleTest in your Bazel project:

- Add GoogleTest as an external repository or submodule.

- Alternatively, include it directly in your workspace.

### 2. Writing BUILD Targets

Use the provided Bazel BUILD files under the `googletest` directory. A typical test target depends on `@com_google_googletest//:gtest` and `@com_google_googletest//:gmock`.

Example snippet in your `BUILD` file:

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = [
        "@com_google_googletest//:gtest",
        "@com_google_googletest//:gmock",
    ],
)
```

### 3. Building and Running Tests

Run your tests with Bazel:

```bash
bazel test //path/to:my_test
```

This command will build the test target and run it immediately.

### 4. Managing External Dependencies

For projects that don't include GoogleTest directly, configure your `WORKSPACE` file to pull GoogleTest from GitHub using `http_archive` or use Bazel's `rules_git`.

Example `WORKSPACE` snippet:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/main.zip"],
    strip_prefix = "googletest-main",
)
```

Then run `bazel fetch //...` to download dependencies before building.

### 5. Verify Bazel Setup

Ensure your Bazel version is compatible (consult Bazel's documentation). Verify that test runs produce expected outputs.

---

## Integration Tips

- GoogleTest requires C++17 support. Confirm your compiler's version and build settings accommodate this.
- When configuring CMake or Bazel, ensure your project's compiler flags propagate properly to the testing libraries.
- For CMake projects integrating GoogleTest and GoogleMock, linking against `gtest` and `gmock` targets is usually sufficient.
- Check for thread library linkage if building on UNIX systems; CMake usually handles this automatically.

---

## Common Pitfalls & Troubleshooting

- **Missing Virtual Destructors**: Ensure mocked classes have virtual destructors to avoid runtime errors.
- **Incorrect Mock Method Signatures**: Use the `MOCK_METHOD` macro exactly with the original method signatures, including `const` and `override` qualifiers.
- **Compiler Errors with Templated or Complex Types**: Wrap return types or argument types with commas inside extra parentheses or use type aliases to avoid macro parsing errors.
- **Build Errors on Windows**: Use `gtest_force_shared_crt` CMake option to fix runtime library mismatches.

---

## Resources and Further Reading

- [GoogleTest CMake Installation Guide](https://github.com/google/googletest/tree/main/googletest/README.md)
- [GoogleMock Cookbook](https://github.com/google/googletest/tree/main/googlemock/docs/gmock_cook_book.md)
- [Integration with Build Systems](https://github.com/google/googletest/tree/main/docs/overview/architecture-key-concepts/integration-with-build-and-tools.md)
- [Getting Started with GoogleMock](https://github.com/google/googletest/tree/main/docs/guides/getting-started-workflows/mocking-basics.md)

---

For detailed build customization and advanced integration scenarios, please refer to the [Integration & Compatibility guide](https://github.com/google/googletest/tree/main/docs/overview/architecture-key-concepts/integration-with-build-and-tools.md).

---

### Quick Checklist

- Confirm C++17 compiler and tools
- Clone/download the source
- Choose build system: CMake or Bazel
- Follow stepwise build instructions
- Link your test targets correctly
- Verify build and test success

With these clear steps, you will have GoogleTest and GoogleMock installed and ready within your chosen build system.
