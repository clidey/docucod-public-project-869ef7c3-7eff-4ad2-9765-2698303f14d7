---
title: "Installation Methods"
description: "Guides users through supported installation approaches—including usage with CMake and Bazel—across different platforms. Covers obtaining the source, integrating into a project, and verifying successful library installation."
---

# Installation Methods

This guide walks you through the supported installation approaches for GoogleTest, focusing primarily on building and integrating GoogleTest and GoogleMock using CMake, across different platforms. It also covers obtaining the source code and verifying successful installation.

---

## 1. Obtaining the GoogleTest Source

Start by cloning the GoogleTest repository to get the source code and build scripts:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
googletest/
```

This repository includes both GoogleTest and GoogleMock sources.

---

## 2. Building GoogleTest with CMake

GoogleTest provides a cross-platform CMake build script to generate native build projects.

### 2.1 Prerequisites

- Ensure you have [CMake](https://cmake.org/download/) version 3.14 or later installed.
- A C++17-compatible compiler is required.

### 2.2 Building as a Standalone Project

This workflow is for building GoogleTest independently.

<Steps>
  <Step title="Clone the repository and prepare your build directory">
  ```bash
  git clone https://github.com/google/googletest.git -b v1.17.0
  cd googletest
  mkdir build
  cd build
  ```
  </Step>
  <Step title="Generate build files with CMake">

  By default, this will build both GoogleTest and GoogleMock:
  ```bash
  cmake ..
  ```

  To build only GoogleTest (without GoogleMock), use:

  ```bash
  cmake .. -DBUILD_GMOCK=OFF
  ```
  </Step>
  <Step title="Build the libraries">

  On Unix-like systems:
  ```bash
  make
  ```

  On Windows with Visual Studio:

  - Open the `gtest.sln` solution file generated in the `build` directory.
  - Build the projects using Visual Studio.

  On Mac OS with Xcode:

  - Open the `.xcodeproj` file generated.
  - Build using Xcode.

  </Step>
  <Step title="(Optional) Install GoogleTest">

  If you have administrative rights and want to install GoogleTest system-wide:

  ```bash
  sudo make install
  ```

  This installs libraries and headers under `/usr/local/` by default.
  </Step>
</Steps>

### 2.3 Incorporating GoogleTest Into an Existing CMake Project

You have two main options:

#### Option A: Use Installed Libraries

If GoogleTest is installed on the system, import it in your `CMakeLists.txt`:

```cmake
find_package(GTest CONFIG REQUIRED)  # Searches for installed GoogleTest

add_executable(my_tests test.cpp)
target_link_libraries(my_tests PRIVATE GTest::gtest GTest::gmock)
```

#### Option B: Build as a Subdirectory

Integrate GoogleTest source directly into your project build, ensuring consistent compiler and linker settings:

1. Download the GoogleTest source to a known location or add as a git submodule.
2. Add this to your `CMakeLists.txt`:

```cmake
add_subdirectory(path/to/googletest)

add_executable(my_tests test.cpp)
target_link_libraries(my_tests PRIVATE gtest gmock)
```

This approach helps prevent linking and runtime incompatibilities, especially on Windows.

#### Option C: Download Automatically with FetchContent (Recommended for CMake ≥ 3.14)

Add this snippet to your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)
# On Windows, use shared CRT to fix runtime mismatch errors
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test.cpp)
target_link_libraries(my_tests PRIVATE gtest_main)
add_test(NAME my_tests COMMAND my_tests)
```

This downloads and builds GoogleTest as part of your project during configuration.

---

## 3. Important Build Configuration Notes

### 3.1 C++ Standard

GoogleTest requires a C++17 standard environment. Set in your top-level `CMakeLists.txt`:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

### 3.2 Visual Studio Runtime Library Setting

By default, Visual Studio projects link the C runtime dynamically (`MD`), but GoogleTest links it statically (`MT`). This causes linker errors like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

**Resolution:** Enable `gtest_force_shared_crt` in CMake to force GoogleTest to use dynamic CRT:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

### 3.3 Multi-threaded Tests

GoogleTest is thread-safe on platforms that support pthreads. If detection fails, you can force pthread usage:

```bash
-DGTEST_HAS_PTHREAD=1
```

Use the CMake build system to automatically handle pthread linkage.

---

## 4. Building GoogleMock

GoogleMock builds on GoogleTest and follows a similar process.

- The `googlemock` directory contains its own `CMakeLists.txt`.
- It automatically includes GoogleTest's source, either from `gtest` or `googletest`.

Typical steps:

```bash
cd googlemock
mkdir build && cd build
cmake ..
make
```

> Note: The GoogleMock maintainers do not rely on CMake internally, so this support is community based.

You can control building GoogleMock's own tests using the option `-Dgmock_build_tests=ON`.

---

## 5. Verifying Installation

After building or installing:

- Check that `libgtest.a` (or `.lib`, `.dll`) and `libgmock.a` are created.
- Ensure header files `gtest/gtest.h` and `gmock/gmock.h` are accessible.
- Run example tests or your own test targets linked against GoogleTest to confirm successful compilation and linking.

For standalone builds:

```bash
./example/example_test  # or your own test executable
```

It should produce output indicating test progress and results.

---

## 6. Troubleshooting

- **Build fails due to C++ standard version:** Verify your compiler supports C++17, and your CMake config sets `CMAKE_CXX_STANDARD` to 17.

- **Link errors on Visual Studio regarding runtime libraries:** Set `gtest_force_shared_crt` option.

- **Missing pthread-related symbols on Linux:** Ensure pthreads development libraries installed and properly linked.

- **Test executables fail to run or link:** Confirm linker paths and include directories are correctly set.

- **GoogleMock tests not building:** Set `-Dgmock_build_tests=ON` explicitly if you want them.

---

## 7. Additional Resources

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Primer](../getting-started/first-test-execution/writing-your-first-test)
- [Mocking Basics Guide](../googletest-guides/advanced-mocking/mocking-basics)
- [GoogleMock Cookbook](../docs/gmock_cook_book.md)

---

By following this guide, you will successfully install and integrate GoogleTest and GoogleMock using CMake, setting up a solid foundation for writing and running your C++ tests.


---

<Note>
Remember to always build GoogleTest and your tests with the same compiler settings to avoid runtime and linking errors, especially on Windows systems. If using an existing project, prefer embedding GoogleTest via `add_subdirectory` for consistency.
</Note>