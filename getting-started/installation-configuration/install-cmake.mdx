---
title: "Install with CMake"
description: "Follow detailed instructions to install and integrate GoogleTest/GoogleMock into your project using CMake. Covers fetching sources, adding as a subdirectory, using package configuration, and verifying your CMake setup."
---

# Install with CMake

Follow detailed instructions to install and integrate GoogleTest and GoogleMock into your C++ projects using CMake. This guide covers fetching sources, adding GoogleTest/GoogleMock as a subdirectory in your build, using package configuration for linking, and verifying your CMake setup with a simple test.

---

## 1. Prerequisites

Before starting, ensure you have the following ready:

- **Operating System:** Linux, macOS, or Windows compatible with your toolchain.
- **C++ Compiler:** Supports at least C++17 standard.
- **CMake:** Version 3.14 or higher. Download from [https://cmake.org/](https://cmake.org/).
- **Build Tool:** Compatible with chosen generator (e.g., Make, Ninja, Visual Studio).

<Tip>
Using CMake 3.14 or above is essential for smooth integration, especially leveraging the FetchContent module.
</Tip>

---

## 2. Fetching and Building GoogleTest Standalone

This method builds GoogleTest (and optionally GoogleMock) as a separate project.

### Steps:

<Steps>
<Step title="Clone the GoogleTest repository">
Run:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
git checkout main  # Optional: to get the latest main branch
```

This clones the official repository at the specified release tag.
</Step>

<Step title="Create a build directory">

```bash
cd googletest
mkdir build && cd build
```

Keep build output isolated for cleanliness.
</Step>

<Step title="Configure with CMake">

By default, both GoogleTest and GoogleMock are built:

```bash
cmake ..
```

To build only GoogleTest, disable GoogleMock:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

This generates platform native build files (Makefile, Visual Studio solution, etc.).
</Step>

<Step title="Build the project">

On Linux/macOS:

```bash
make
```

On Windows, use Visual Studio to build the generated solution.
</Step>

<Step title="(Optional) Install the libraries">
If you have admin permissions and want system-wide access:

```bash
sudo make install
```

This will install headers and libraries to `/usr/local/` by default.
</Step>
</Steps>

<Note>
When building manually, confirm that your compiler supports C++17 and adjust your environment accordingly.
</Note>

---

## 3. Incorporate GoogleTest Into Your Existing CMake Project

Embed GoogleTest sources directly or use the installed package for seamless integration.

### 3.1 Using Installed GoogleTest Package

If GoogleTest is installed on your system, import it via CMake:

```cmake
find_package(GTest CONFIG REQUIRED)

add_executable(my_test my_test.cpp)
target_link_libraries(my_test GTest::gtest_main)
enable_testing()
add_test(NAME my_test COMMAND my_test)
```

This method requires installed CMake config files and .pc files.

---

### 3.2 Fetch GoogleTest at Configure Time via `FetchContent`

Add the following snippet to your projectâ€™s `CMakeLists.txt`:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)

# On Windows, ensure runtimes match
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

enable_testing()

add_executable(hello_test hello_test.cpp)
target_link_libraries(hello_test GTest::gtest_main)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

This downloads and builds GoogleTest transparently during your build configuration.

<Tip>
Regularly update the commit hash URL to use the latest Googletest version.
</Tip>

---

## 4. Building and Running Your First GoogleTest

1. Create a test source file (`hello_test.cpp`) in your project directory:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

2. Build the test executable with CMake:

```bash
cmake -S . -B build
cmake --build build
```

3. Run tests using CTest:

```bash
cd build
ctest
```

Expected output:

```
Test project /path/to/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

<Check>
Seeing the single passing test confirms your CMake integration and GoogleTest setup are correct.
</Check>

---

## 5. Useful Configuration Options

- **Build GoogleMock alongside GoogleTest (default ON):**
  - Use `-DBUILD_GMOCK=ON` or `OFF` to control this.

- **Shared vs Static Libraries:**
  - Control with `BUILD_SHARED_LIBS` option.
  - On Windows, use `gtest_force_shared_crt` to align runtime linkage.

- **C++ Standard Version:**
  - GoogleTest requires at least C++17.
  - Set with `set(CMAKE_CXX_STANDARD 17)` and `set(CMAKE_CXX_STANDARD_REQUIRED ON)`.

- **PThread Support:**
  - Automatically handled by CMake script.
  - You can disable with `-Dgtest_disable_pthreads=ON` if needed.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting GoogleTest CMake Integration">
<Accordion title="Compiler Does Not Support C++17">

Make sure your compiler version supports C++17. On GCC, version >=7 is recommended. On MSVC, Visual Studio 2017 or later is needed.

</Accordion>
<Accordion title="CMake Version Too Low">

GoogleTest's FetchContent mandates CMake 3.14+. Upgrade CMake to at least this version.

</Accordion>
<Accordion title="Linker Errors Related to Runtime Libraries on Windows">

Enable `gtest_force_shared_crt` in your `CMakeLists.txt`:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

to ensure consistent runtime linkage.

</Accordion>
<Accordion title="Tests Not Found or Not Run by CTest">

Make sure you include:

```cmake
include(GoogleTest)
gtest_discover_tests(target_name)
```

and run `ctest` inside the build directory.

</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Explore [Writing Your First Test Case](../guides/getting-started/writing-your-first-test) for an in-depth test authoring guide.
- Review [Project Structure Overview](../getting-started/environment-setup/project-structure-overview) for understanding the repo layout.
- Learn about [Pkg-config and Other Installation Methods](./pkg-config-and-other-methods) for alternate build integrations.
- Browse example tests and samples in the `samples/` directory for real-world usage.

---

For full details, see the [GoogleTest repository CMakeLists.txt](https://github.com/google/googletest/blob/main/CMakeLists.txt) and the official [googletest README](https://github.com/google/googletest/blob/main/googletest/README.md).

---

<Info>
This page focuses exclusively on installing and integrating GoogleTest/GoogleMock via CMake. For Bazel users, refer to the [Quickstart for Bazel](quickstart-bazel.md).
</Info>

---