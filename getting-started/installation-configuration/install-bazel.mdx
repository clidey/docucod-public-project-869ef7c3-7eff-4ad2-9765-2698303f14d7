---
title: "Install with Bazel"
description: "Get started building and running GoogleTest-based tests using Bazel. Outlines dependency setup, basic BUILD targets, and initial tests."
---

# Install with Bazel

Get started building and running GoogleTest-based tests using Bazel. This guide walks you through setting up Bazel dependencies, creating BUILD targets, and running your first test with GoogleTest.

---

## 1. Prerequisites & Requirements

- **Operating System**: Linux, macOS, or Windows.
- **C++ Compiler**: Must support at least C++17.
- **Bazel Version**: Bazel 7.0 or higher. Install Bazel from [https://bazel.build/install](https://bazel.build/install).

<Tip>
Ensure your compiler is properly configured to support C++17 standards. For GCC or Clang, you will use standard compiler flags as part of the Bazel build.
</Tip>

---

## 2. Setting up Your Bazel Workspace

Follow these steps to configure your Bazel workspace for GoogleTest:

### a. Create a Workspace Directory

Open your terminal or command prompt and run:

```bash
mkdir my_workspace && cd my_workspace
```

### b. Add a `MODULE.bazel` File

Create a file named `MODULE.bazel` in the root of your workspace with the following content:

```python
# MODULE.bazel

# Load GoogleTest dependency version from Bazel Central Registry
bazel_dep(name = "googletest", version = "1.17.0")
```

This line instructs Bazel to automatically fetch GoogleTest version 1.17.0 and manage its dependencies for you.

<Warning>
Make sure to update the `version` string in `MODULE.bazel` to the latest release if needed. You can check versions at the [Bazel Central Registry](https://registry.bazel.build/modules/googletest).
</Warning>

---

## 3. Creating Your First Test

You are now ready to build and run tests that use GoogleTest.

### a. Write a Source File

Create a test file named `hello_test.cc` inside your `my_workspace` directory with the following code:

```cpp
#include <gtest/gtest.h>

// Simple test case demonstrating basic assertions
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Strings are not equal
  EXPECT_EQ(7 * 6, 42);               // Arithmetic equality
}
```

### b. Create a BUILD File

In the same directory, create a file named `BUILD` with this content:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This `cc_test` target defines a small test binary named `hello_test`, linking it against GoogleTest and GoogleTest's `main()` function.

<Tip>
If you are using MSVC on Windows, ensure that Bazel compiler flags enable C++17 with `/std:c++17`. For GCC/Clang, use `--cxxopt=-std=c++17` when building.
</Tip>

---

## 4. Building and Running Your Test

Run the following command in your workspace directory:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

### Expected Output Summary:

You should see output similar to this:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)
[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

The command confirms successful compilation and test execution.

<Check>
If your test fails to build or run:
- Confirm Bazel is installed and at least version 7.0.
- Verify your compiler supports C++17.
- Make sure your files (`MODULE.bazel`, `BUILD`, and `hello_test.cc`) are correctly named and located.
</Check>

---

## 5. Best Practices & Tips for Bazel with GoogleTest

- **Use Bazel Central Registry**: Managing dependencies via `MODULE.bazel` leverages Bazel's module system, ensuring consistent and repeatable builds.
- **Set C++17 Explicitly**: Use `--cxxopt=-std=c++17` (or `/std:c++17` on MSVC) to guarantee correct standard version during build.
- **Separate Tests from Main Code**: Organize test targets (`cc_test`) separately from your main application code for clarity.
- **Use `gtest_main`**: Including `@googletest//:gtest_main` provides the GoogleTest main function, saving you from writing one.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Bazel Setup and Build Issues">
<Accordion title="GoogleTest Not Found or Dependency Errors">
Make sure your `MODULE.bazel` file is correctly placed in the workspace root and specifies the correct googletest version. Run `bazel sync` to refresh dependencies.
</Accordion>
<Accordion title="Build Fails Due to C++ Standard Errors">
Ensure that your compiler options explicitly enable C++17 by adding `--cxxopt=-std=c++17` to `bazel test` or `bazel build` commands.
</Accordion>
<Accordion title="Tests Not Running or Test Output Not Visible">
Pass `--test_output=all` to your Bazel test command to see detailed test logs.
Also, verify `cc_test` target names and dependencies are correctly set.
</Accordion>
<Accordion title="Linker Errors on Windows with MSVC">
Ensure your Bazel command includes `/std:c++17` in `--cxxopt` and that your environment uses compatible runtime libraries.
Consider running via the MSVC Developer Command Prompt.
</Accordion>
</AccordionGroup>

---

## 7. Where to Go Next

- Learn to write tests using [TEST and TEST_F macros](https://google.github.io/googletest/primer.html#writing-the-first-test).
- Explore GoogleTest's rich [assertion APIs](https://google.github.io/googletest/primer.html#assertions).
- Check out [Sample Code](samples.md) for more complete examples.
- For other build systems, see the [Install with CMake](install-cmake.md) guide.

---

## References

- Bazel Official Site: [https://bazel.build/](https://bazel.build/)
- Bazel Central Registry for googletest: [https://registry.bazel.build/modules/googletest](https://registry.bazel.build/modules/googletest)
- GoogleTest Primer: [https://google.github.io/googletest/primer.html](https://google.github.io/googletest/primer.html)
- GoogleTest GitHub Repo: https://github.com/google/googletest

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/quickstart-bazel.md", "range": "1-102"}]} />