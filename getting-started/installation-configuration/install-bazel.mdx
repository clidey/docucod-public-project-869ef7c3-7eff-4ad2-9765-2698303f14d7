---
title: "Install with Bazel"
description: "Get started with Bazel as your build system. This page provides practical instructions and ready-to-use code snippets for adding the GoogleTest repository to your WORKSPACE file and defining your test targets."
---

# Install with Bazel

Get started with Bazel as your build system to incorporate GoogleTest in your C++ projects. This guide provides practical, step-by-step instructions and ready-to-use code snippets to add the GoogleTest repository to your Bazel `WORKSPACE` file and define test targets in your `BUILD` files.

---

## 1. Prerequisites & System Requirements

- **Supported Platforms:** Linux, macOS, Windows, and other platforms supported by Bazel.
- **Compiler:** A C++ compiler with C++17 support is mandatory.
- **Bazel Version:** Bazel 7.0 or higher.
- **Network Access:** Required to download remote dependencies the first time.

<Tip>
Ensure your environment uses C++17 or higher, as GoogleTest requires this standard for build and operation.
</Tip>

---

## 2. Setting Up Your Bazel Workspace

A Bazel workspace is the root directory of your project where Bazel tracks source files, dependencies, and build commands.

### Step 1: Create Your Workspace Directory

Run the following commands to create and enter a new workspace:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Add the `MODULE.bazel` File

Bazel now recommends managing external dependencies through `MODULE.bazel`. Create this file at the root of your workspace with the following content:

```python
# MODULE.bazel

# Specify a stable release version of GoogleTest from the Bazel Central Registry
bazel_dep(name = "googletest", version = "1.17.0")
```

This configuration tells Bazel to fetch the GoogleTest libraries as a dependency.

<Tip>
Check for newer GoogleTest versions at https://registry.bazel.build/modules/googletest to keep your tests up to date.
</Tip>

---

## 3. Adding GoogleTest Dependencies in `WORKSPACE`

If your project does not use Bazel modules, you can still add GoogleTest by modifying your `WORKSPACE` file.

### Example: `WORKSPACE` Setup

Add these snippets to include the GoogleTest repository and its dependencies.

```starlark
workspace(name = "googletest")

load("//:googletest_deps.bzl", "googletest_deps")
googletest_deps()

load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")

http_archive(
    name = "rules_python",
    sha256 = "2cc26bbd53854ceb76dd42a834b1002cd4ba7f8df35440cf03482e045affc244",
    strip_prefix = "rules_python-1.3.0",
    url = "https://github.com/bazelbuild/rules_python/releases/download/1.3.0/rules_python-1.3.0.tar.gz",
)

py_repositories()

http_archive(
    name = "platforms",
    urls = [
        "https://mirror.bazel.build/github.com/bazelbuild/platforms/releases/download/0.0.11/platforms-0.0.11.tar.gz",
        "https://github.com/bazelbuild/platforms/releases/download/0.0.11/platforms-0.0.11.tar.gz",
    ],
    sha256 = "29742e87275809b5e598dc2f04d86960cc7a55b3067d97221c9abbc9926bff0f",
)
```

<Tip>
Refer to the provided `WORKSPACE` file inside the GoogleTest repository for the latest dependency configurations.
</Tip>

---

## 4. Writing Your First Test with Bazel

### Step 1: Create a Test Source File

Create a C++ test file `hello_test.cc` in your workspace:

```cpp
#include <gtest/gtest.h>

// Demonstrate some basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Check strings are not equal
  EXPECT_EQ(7 * 6, 42);              // Check equality
}
```

### Step 2: Define a `BUILD` File

Create a `BUILD` file in the same directory with the following content to declare your test target:

```starlark
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This tells Bazel to build a test binary named `hello_test` linking with GoogleTest libraries.

<Tip>
If you are using a compiler other than GCC or Clang, adjust the C++ standard flag accordingly using `--cxxopt=/std:c++17` for MSVC.
</Tip>

---

## 5. Building and Running Your Test

### Step 1: Compile and Test Using Bazel

Run Bazel with the following command in your workspace root:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

### Expected Output Snippet:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)
[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

This confirms that Bazel successfully compiled and executed your GoogleTest test case.

---

## 6. Best Practices & Tips

- **Use Bazel Modules (`MODULE.bazel`) When Possible:** This is the modern approach and simplifies dependency management.
- **Stay Updated:** Regularly verify you use the latest GoogleTest version compatible with Bazel.
- **Compiler Flags:** Always specify C++17 or higher using `--cxxopt` to avoid compatibility issues.
- **Link `gtest_main` Unless Providing Your Main:** Depending on your setup, link with `@googletest//:gtest_main` to get the default main function for tests.

<Tip>
When cross-platform support is required, validate builds on all target environments you support to catch platform-specific quirks early.
</Tip>

---

## 7. Troubleshooting

<AccordionGroup title="Common Issues Setting Up GoogleTest with Bazel">
<Accordion title="Bazel cannot find GoogleTest dependencies">
Check that your `MODULE.bazel` or `WORKSPACE` file correctly includes GoogleTest and its dependencies. Run `bazel sync` to refresh external repos.
</Accordion>

<Accordion title="Test build fails due to C++ standard errors">
Confirm you pass the C++17 flag on build and test commands as `--cxxopt=-std=c++17` for Clang/GCC or equivalent for MSVC.
</Accordion>

<Accordion title="Linker errors about main function missing">
Ensure your `BUILD` file links with `@googletest//:gtest_main` unless providing a custom `main()`.
</Accordion>
</AccordionGroup>

<Tip>
If problems persist, consult the [Common Issues and Fixes](https://example.com/getting-started/troubleshooting-support/common-issues-and-fixes) guide in this documentation.
</Tip>

---

## 8. Next Steps

- Explore writing your own tests using the [Primer guide](../first-test-and-validation/write-run-your-first-test).
- Review example usage in the GoogleTest samples directory.
- Learn more about advanced test features like mocks, assertions, and parameterized tests.
- Check out [Integration & Build System Support](../../../overview/feature-overview-integration/integration-points) for deeper integration insights.
- For alternate build systems, see the [Install with CMake](../installation-configuration/install-cmake) page.

---

## References

- [GoogleTest Repository on GitHub](https://github.com/google/googletest)
- [Bazel Official Site](https://bazel.build)
- [Bazel Central Registry - GoogleTest module](https://registry.bazel.build/modules/googletest)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)


---

This page is part of the Getting Started with GoogleTest documentation under Installation & Configuration.

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "WORKSPACE", "range": "1-65"},{"path": "MODULE.bazel", "range": "1-48"},{"path": "docs/quickstart-bazel.md", "range": "1-87"}]} />
