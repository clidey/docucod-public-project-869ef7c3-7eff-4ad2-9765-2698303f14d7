---
title: "Project Configuration Essentials"
description: "Review critical first-time configurations—include paths, library linking, and build flags. Covers how to add GoogleTest/GoogleMock to your project’s build scripts and directory structure, ensuring your environment is ready for first tests."
---

# Project Configuration Essentials

Preparing your development environment for GoogleTest and GoogleMock requires careful configuration of your project's build system and directory structure. This guide walks you through the essential first-time setup tasks—adding include paths, linking libraries, and setting necessary flags—so your environment is fully primed for authoring and running your first tests.

---

## 1. Directory Structure and Source Organization

Before integrating libraries and configuring your build, consider organizing your project files clearly:

- **Third-party Libraries**: Store GoogleTest and GoogleMock sources in a well-defined location such as `/third_party/googletest`.
- **Include Paths**: Ensure headers from both GoogleTest and GoogleMock are accessible to your compiler. Usually, you should include the top-level directory containing `gtest` and `gmock` headers.
- **Source Files**: Add source files `gtest-all.cc` and `gmock-all.cc` (or their compiled archive equivalents) to your build for linking unless you use precompiled binaries.

### Example folder layout
```text
/my_project
  /src
  /tests
  /third_party
    /googletest
      /include
        /gtest
        /gmock
      /src
        gtest-all.cc
        gmock-all.cc
```


## 2. Include Paths Setup

In your build configuration, add the include paths for GoogleTest and GoogleMock. Typically, these paths are:

- `third_party/googletest/include`
- `third_party/googletest`


### Example (CMake)
```cmake
include_directories(
  ${PROJECT_SOURCE_DIR}/third_party/googletest/include
  ${PROJECT_SOURCE_DIR}/third_party/googletest
)
```

Ensure these paths encompass the directory containing the `gmock` and `gtest` headers so that your code can include `<gmock/gmock.h>` and `<gtest/gtest.h>` seamlessly.


## 3. Linking GoogleTest and GoogleMock Libraries

You must link your test binaries against the GoogleTest and GoogleMock libraries to resolve their implementations.

### Link Options
- If building from source, compile and link `gtest-all.cc` and `gmock-all.cc` along with your test sources.
- Alternatively, link against precompiled static or shared libraries provided by GoogleTest.


### Example (CMake)
```cmake
add_executable(my_test test_main.cc my_tests.cc)

# Link with pthread if necessary (platform dependent).
set(THREADS_PREFER_PTHREAD_FLAG ON)
find_package(Threads REQUIRED)

# Linking with gtest and gmock libraries
target_link_libraries(my_test
  ${PROJECT_SOURCE_DIR}/third_party/googletest/lib/libgtest.a
  ${PROJECT_SOURCE_DIR}/third_party/googletest/lib/libgmock.a
  Threads::Threads
)
```


## 4. Required Compiler and Build Flags

- **C++17 or later**: GoogleTest and GoogleMock requires a compiler that supports at least C++17. Ensure your compiler flags include `-std=c++17` or equivalent.
- **Threading Support**: Enable threading support as GoogleTest uses multiple threads internally. For Unix-like systems, linking with pthread (`-pthread`) is necessary.
- **Position Independent Code (PIC)**: If building shared libraries, ensure `-fPIC` is set.


### Example (GCC/Clang command-line flags)
```bash
g++ -std=c++17 -pthread -Ithird_party/googletest/include -Ithird_party/googletest src/*.cc tests/*.cc \
    third_party/googletest/src/gtest-all.cc third_party/googletest/src/gmock-all.cc \
    -o my_tests
```


## 5. Configuring Build Scripts for GoogleMock

GoogleMock is distributed as part of GoogleTest but requires some additional setup:

- Include both GoogleMock and GoogleTest source files or use libraries.
- Add the `gmock` include directory so your mocks can include `<gmock/gmock.h>`.
- Confirm your test sources link against both `libgmock` and `libgtest`.


## 6. Integrating with Popular Build Systems

### CMake
- Use `FetchContent` or `ExternalProject` to pull GoogleTest/GoogleMock if preferred.
- Otherwise, add GoogleTest/GoogleMock includes and sources to your project manually.

Here is a minimal CMake snippet to add GoogleTest and GoogleMock manually:

```cmake
# Add gtest and gmock sources
add_subdirectory(third_party/googletest)

# Your test executable
add_executable(my_tests test_main.cc ...)

# Link against gmock and gtest
target_link_libraries(my_tests gmock gtest pthread)
```

### Bazel
- Use the official GoogleTest and GoogleMock Bazel targets.
- Declare dependencies on `@com_google_googletest//:gmock` and `@com_google_googletest//:gtest` in your BUILD files.


## 7. Verification: Confirming Setup is Correct

Once your include paths, linking, and build flags are configured, verify setup by:

1. Writing a simple test program that includes `<gtest/gtest.h>` and/or `<gmock/gmock.h>`.
2. Define a minimal mock class as per GoogleMock syntax.
3. Compile and run the test.

Example minimal test:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

class MockFoo {
 public:
  MOCK_METHOD(int, Bar, (), ());
};

TEST(MockTest, Responds) {
  MockFoo mock;
  EXPECT_CALL(mock, Bar()).WillOnce(::testing::Return(42));
  EXPECT_EQ(mock.Bar(), 42);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile with the configured environment and confirm the output shows tests pass.


## 8. Common Pitfalls and Tips

<Tip>
- Always verify your compiler and standard flags before adding GoogleTest.
- Use explicit link libraries `gmock` and `gtest` in correct order.
- When facing linker errors, check that you compiled the `gmock-all.cc` and `gtest-all.cc` sources.
- On Linux and macOS, ensure you link to pthread.
- Use `InitGoogleMock` (instead of `InitGoogleTest`) when using GoogleMock in your main function.
</Tip>

<Warning>
- Do not mix older GoogleTest/GoogleMock versions without rebuilding the sources.
- Avoid setting expectations or calling mock methods before properly linking and initializing GoogleMock.
</Warning>

---

## Further Reading and Resources

- [Installing with CMake](/getting-started/installation-initialization/installation-cmake)
- [Manual and Advanced Installation](/getting-started/installation-initialization/installation-manual)
- [Creating Your First Test](/getting-started/first-test-validation/creating-first-test)
- [Using Mocks in Tests](https://google.github.io/googletest/gmock_for_dummies.html#Using-mocks-in-tests)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)

---

By following the steps in this guide, you'll ensure your project is properly configured to leverage GoogleTest and GoogleMock efficiently, minimizing integration issues and speeding up your testing workflow.