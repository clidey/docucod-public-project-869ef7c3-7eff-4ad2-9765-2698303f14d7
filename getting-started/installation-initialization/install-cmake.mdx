---
title: "Installing with CMake"
description: "Step-by-step instructions for integrating GoogleTest into a CMake project, covering fetching, building, and linking, as well as validating installation with a sample test. Focuses on recommended modern workflows."
---

# Installing with CMake

This guide provides clear, actionable steps to integrate GoogleTest into your CMake-based C++ project using modern workflows. You'll learn how to fetch GoogleTest automatically, build it alongside your project, link your test binaries, and verify your setup with a sample test.

---

## 1. Prerequisites & System Requirements

Before proceeding, ensure your environment meets these requirements:

- **Operating System:** Compatible with Linux, macOS, or Windows.
- **Compiler:** A C++ compiler supporting at least C++17 (e.g., GCC 7+, Clang 6+, MSVC 2017+).
- **CMake:** Version 3.14 or later.
- **Build Tools:** Compatible tools such as Make, Ninja, or Visual Studio build tools.

> For detailed platform and compiler compatibility, see the [System Requirements](../setup-requirements/system-prerequisites) page.

---

## 2. Setting Up Your CMake Project to Use GoogleTest

### Step 1: Create Your Project Directory

Open a terminal or command prompt and create a new directory for your project:

```bash
mkdir my_project && cd my_project
```

### Step 2: Create `CMakeLists.txt` with FetchContent to Grab GoogleTest

In your `my_project` directory, create a file named `CMakeLists.txt` with the following minimal content:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Enforce C++17 standard (required by GoogleTest)
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Include FetchContent to download dependencies
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)

# For Windows: Ensure the runtime linkage matches your parent project
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)
```

> **Tip:** Update the `URL` hash regularly to use the latest GoogleTest release.

### Step 3: Add Your Test Source File

Create a simple test file named `hello_test.cc` in the project directory with the following content:

```cpp
#include <gtest/gtest.h>

// Basic example test
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Checks strings are not equal.
  EXPECT_EQ(7 * 6, 42);              // Checks integer equality.
}
```

### Step 4: Extend `CMakeLists.txt` to Build and Run the Test

Append the following lines to your `CMakeLists.txt` file:

```cmake
# Enable testing support
enable_testing()

# Declare a test executable
add_executable(hello_test hello_test.cc)

# Link test executable to GoogleTest's main library
target_link_libraries(hello_test GTest::gtest_main)

# Enables discovery of tests for CTest and IDEs
include(GoogleTest)
gtest_discover_tests(hello_test)
```

---

## 3. Building and Running Your First Test

### Step 1: Generate Build Files

From your project root directory, run:

```bash
cmake -S . -B build
```

This command configures your build system and generates all necessary build files inside a `build` directory.

### Step 2: Build the Test Executable

Next, build your test executable with:

```bash
cmake --build build
```

You should see output indicating compilation of GoogleTest and your test.

### Step 3: Running the Tests

Run your tests with:

```bash
cd build
ctest
```

You will see output indicating passing or failing tests. For the example test above, it should show:

```
Test project /path/to/my_project/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

Congratulations! Your GoogleTest framework is now integrated and working with CMake.

---

## 4. Understanding Key Configuration Elements

- **FetchContent:** Automates fetching GoogleTest source code during the CMake configure step. Simplifies dependency management.
- **`gtest_force_shared_crt`:** Ensures that on Windows your GoogleTest library links against the same Visual Studio runtime as your project, preventing linker errors.
- **`gtest_discover_tests()`:** Automatically finds all tests in your executable and registers them with CTest, streamlining test execution.

---

## 5. Best Practices and Tips

- **Keep CMake updated:** GoogleTest requires CMake 3.14+ for `FetchContent_MakeAvailable()`. Verify your version with `cmake --version`.
- **Isolate test code:** Place tests in dedicated folders (e.g., `tests/`) for maintainability.
- **Consistent C++ standard:** Ensure your project and GoogleTest use the same C++ standard (C++17 minimum).
- **Regularly update GoogleTest:** Periodically update the commit hash or version in `FetchContent_Declare` to benefit from fixes and features.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Common CMake Integration Issues">
<Accordion title="CMake version too low">
Ensure you have version 3.14 or newer. Older versions lack `FetchContent_MakeAvailable()` support.

Run `cmake --version` to verify. Upgrade CMake if needed from https://cmake.org/install/.
</Accordion>
<Accordion title="Linker errors on Windows about runtime mismatch">
This usually occurs if `gtest_force_shared_crt` is not set to `ON`.

Add to your `CMakeLists.txt`:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

Reconfigure and rebuild.
</Accordion>
<Accordion title="Tests not being discovered by CTest">
Make sure that you call `include(GoogleTest)` after linking your test executable to `GTest::gtest_main` and run `gtest_discover_tests`.

If you override test runners or customize test discovery, check that the executable actually contains tests.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Explore [Writing Your First Test](../first-test-experience/write-your-first-test) to learn how to write effective tests with GoogleTest assertions.
- Review [Primer](../../primer.md) for in-depth guidance on GoogleTest fundamentals.
- If you need to integrate GoogleMock as well, refer to the [Mocking with GoogleMock](../../guides/core-workflow/writing-mocks) guide.

For advanced CMake integration scenarios and options, see [Integration & Ecosystem](../../overview/framework-architecture-concepts/integration-and-dependencies).

---

## 8. References

- [GoogleTest on GitHub](https://github.com/google/googletest)
- [CMake FetchContent Documentation](https://cmake.org/cmake/help/latest/module/FetchContent.html)
- [GoogleTest CMake Module](https://cmake.org/cmake/help/latest/module/GoogleTest.html)
- [Getting Started Setup Requirements](../setup-requirements/system-prerequisites)
- [Troubleshooting Common Issues](../troubleshooting-support/common-issues)

---

By following the above steps, you will have a robust, modern CMake-based GoogleTest setup, ready for reliable and scalable C++ testing.


<Check>
Ensure your C++ compiler fully supports C++17 and your platform has all necessary build tools before beginning this integration.
</Check>

<Note>
This documentation focuses on recommended modern CMake workflows. Older or alternative build systems may require different approaches.
</Note>
