---
title: "Configuration & Project Integration"
description: "Guides users through integrating GoogleTest into their own project, focusing on linking, include path setup, and minimal configuration for both GoogleTest and GoogleMock. Notes common pitfalls such as header locations and project structure considerations."
---

# Configuration & Project Integration

This guide helps you integrate GoogleTest and GoogleMock into your own C++ project. You will learn how to correctly configure include paths, link libraries, and set up minimal configuration to run tests and mocks. It also highlights common pitfalls to avoid with header locations and project structure.

---

## 1. Prerequisites for Integration

Before starting integration, ensure the following:

- You have built or installed GoogleTest and GoogleMock libraries.
- Your compiler supports C++17 standard.
- Your build system is capable of linking external libraries and specifying include directories.

If not yet built, refer to the [Installation Methods guide](https://github.com/google/googletest/tree/main/README.md#getting-started-installation-setup-installation-methods).

---

## 2. Include Path Setup

GoogleTest and GoogleMock headers are organized under the `googletest/include` and `googlemock/include` directories respectively.

### Key include directories to add for your project:

- `googletest/include`
- `googlemock/include`

### Example for CMake

```cmake
# Assume GOOGLE_TEST_ROOT points to Googletest source directory
include_directories(
  ${GOOGLE_TEST_ROOT}/googletest/include
  ${GOOGLE_TEST_ROOT}/googlemock/include
)
```

### Notes

- Make sure your include paths point exactly to these include directories. Avoid including from the `src` or any other internal directories.
- Including internal or implementation files directly can cause build errors.

---

## 3. Linking GoogleTest and GoogleMock Libraries

Your project needs to link against GoogleTest and optionally GoogleMock libraries.

### Typical libraries:

- `gtest` (GoogleTest without main)
- `gtest_main` (GoogleTest with supplied main function)
- `gmock` (GoogleMock)
- `gmock_main` (GoogleMock with main function)

### When to link which libraries:

| Use Case                        | Required Libraries       |
|--------------------------------|-------------------------|
| Only GoogleTest tests           | `gtest_main` or `gtest` |
| GoogleTest tests with GoogleMock | `gmock_main` or `gmock` and `gtest` |

### Linking Example with CMake

```cmake
find_package(PkgConfig REQUIRED)
pkg_search_module(GTEST REQUIRED gtest_main)

add_executable(mytests test/mytests.cc)
target_link_libraries(mytests PRIVATE ${GTEST_LDFLAGS})
target_compile_options(mytests PRIVATE ${GTEST_CFLAGS})

enable_testing()
add_test(NAME MyTests COMMAND mytests)
```

<Note>
Using `pkg-config` ensures you get all necessary include paths, macros (e.g., for pthread usage), linker flags, and can simplify cross-platform support.
</Note>

### Manual Linking
If not using `pkg-config`, add the library locations manually:

- Add library search paths (e.g., `-L/path/to/lib`)
- Link against `-lgtest`, `-lgmock`, and possibly `-lpthread`

### Common Pitfalls

- Linking only against `gtest` without `gtest_main` or providing your own `main()` can cause unresolved symbols.
- Linking `gmock` requires also linking against `gtest`.
- On platforms with pthread, missing `-pthread` or equivalent can cause linker errors.

---

## 4. Minimal Configuration Example

A minimal test file using GoogleTest and GoogleMock looks like this:

```cpp
#include "gtest/gtest.h"
#include "gmock/gmock.h"

using ::testing::Return;

class MockFoo {
 public:
  MOCK_METHOD(int, GetValue, (), ());
};

TEST(FooTest, ReturnsExpectedValue) {
  MockFoo mock;
  EXPECT_CALL(mock, GetValue()).WillOnce(Return(5));
  EXPECT_EQ(mock.GetValue(), 5);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Steps:

1. Include both `<gtest/gtest.h>` and `<gmock/gmock.h>` for test and mock support.
2. Define mock classes with `MOCK_METHOD` macros.
3. Write test cases with `TEST` or `TEST_F`.
4. In `main()`, initialize GoogleMock with `InitGoogleMock()`.
5. Run all tests with `RUN_ALL_TESTS()`.

<Check>
Make sure your build links with `gmock_main` or provides your own `main()`.
</Check>

---

## 5. Building and Running Tests

### Using CMake

- Add your test source files.
- Link against GoogleTest and GoogleMock as described above.
- Enable testing and create test targets.

```cmake
add_executable(mytest test/mytest.cpp)
target_link_libraries(mytest PRIVATE gmock_main)
enable_testing()
add_test(NAME MyTestCommand COMMAND mytest)
```

### Command line run

```bash
./mytest --gtest_output=xml:report.xml
```

- Optionally use GoogleTest flags like `--gtest_filter=` to run selected tests.

---

## 6. Common Pitfalls & Best Practices

<AccordionGroup title="Common Pitfalls and How to Avoid Them">
<Accordion title="Incorrect include paths">
Avoid including headers from internal directories or `src`. Always include from `googletest/include` and `googlemock/include`.
</Accordion>
<Accordion title="Linking errors due to missing libraries">
Always link both GoogleTest and GoogleMock libraries when using mocks. Link the `main` variant if you don't provide your own `main()`.
</Accordion>
<Accordion title="Mismatched C++ standards">
Ensure your project and GoogleTest/GoogleMock are built with the same C++ standard (C++17 required).
</Accordion>
<Accordion title="Missing pthread flags">
If on POSIX platforms with pthread, ensure `-pthread` or equivalent is passed for both compile and link.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Explore writing your first tests with the [Writing and Running Your First Test](../first-test-experience/create-run-first-test) guide.
- Learn about advanced mocking in the [Mocking Reference](../reference/mocking.md).
- Consult [Supported Platforms](../../overview/integration-and-ecosystem/supported-platforms) for platform-specific considerations.

<Tip>
Integration starts simply with setting correct include paths and linking, but grows with your test complexity. Keep your build environment consistent to avoid subtle issues.
</Tip>