---
title: "Writing Your First Test"
description: "Provides a narrative, hands-on walkthrough of writing and organizing your first test case. Introduces the GoogleTest test macros and structure, focusing on practical example scenarios."
---

# Writing Your First Test

Welcome to your hands-on journey writing your first test case using GoogleTest! This guide introduces you to the core test macros and structures that make writing and organizing tests simple, effective, and maintainable. We'll focus on practical example scenarios so you gain confidence with real code right away.

---

## 1. Understanding the Basics of a Test Case

At the heart of GoogleTest are **tests** and **test suites**:

- A **test** exercises a specific program path with particular input values and verifies the expected results.
- A **test suite** groups related tests that logically belong together, often reflecting the structure of the tested code.

You write tests using the `TEST()` macro, which combines these into named test函数:

```cpp
TEST(TestSuiteName, TestName) {
  ... test body ...
}
```

- `TestSuiteName`: Groups related tests; should be unique and descriptive.
- `TestName`: Describes the specific behavior or condition under test.

**Important:**
- Names must be valid C++ identifiers and should **not** contain underscores (`_`).
- Tests within the same test suite share the suite name but have unique test names.

Example:

```cpp
// Function to test
int Factorial(int n);  // Computes factorial of n

// Define tests
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

Here, `FactorialTest` groups all factorial-related tests, making results easy to understand and maintain.

---

## 2. Writing Your First Test Step-by-Step

Follow these steps to write a simple but effective test.

<Steps>
<Step title="Step 1: Include the GoogleTest Header">
Begin any test source file by including GoogleTest's main header:

```cpp
#include <gtest/gtest.h>
```

This provides all test macros and utilities.
</Step>

<Step title="Step 2: Define a Test with TEST() Macro">
Use the `TEST()` macro to declare a test.

```cpp
TEST(SampleTestSuite, BasicAssertion) {
  int expected = 5;
  int actual = 4 + 1;
  EXPECT_EQ(actual, expected);
}
```

This test verifies that the sum `4 + 1` equals `5`.

Use `EXPECT_EQ` to check equality; if the check fails, GoogleTest will report it but continue running other tests.
</Step>

<Step title="Step 3: Compile Your Test">
Compile your test source file with your compiler, linking against the GoogleTest library.

Example with g++:

```shell
g++ -std=c++17 -isystem /path/to/googletest/include -pthread sample_test.cc \
    /path/to/libgtest.a /path/to/libgtest_main.a -o sample_test
```

Make sure to adjust include and library paths as per your setup.
</Step>

<Step title="Step 4: Run the Test Executable">
Execute your test binary:

```shell
./sample_test
```

You will see output showing which tests ran, their success or failure status, and summary.

If all assertions pass, the test suite succeeds.
</Step>
</Steps>

<Note>
GoogleTest automatically discovers tests at runtime; you don't need to manually list any tests to run them.
</Note>

---

## 3. Using Test Fixtures with TEST_F for Shared Data

When multiple tests share setup or data, you can use a **test fixture**:

1. Define a class derived from `testing::Test` for shared objects and setup.
2. Write tests using `TEST_F()` instead of `TEST()`, which grants access to fixture members.

Example - Testing a simple queue:

```cpp
template <typename T>
class Queue {
 public:
  void Enqueue(const T& e);  // Adds element
  T* Dequeue();               // Removes element or nullptr if empty
  size_t size() const;
};

class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  delete n;
}
```

Each test runs with a fresh `QueueTest` instance, ensuring test isolation.

<Check>
Use `ASSERT_*` assertions when continuing after failure is unsafe, to abort current test immediately.
</Check>

---

## 4. Running Your Tests

Tests are executed by calling the macro `RUN_ALL_TESTS()` inside your `main()` function after initializing GoogleTest:

```cpp
int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

GoogleTest will run all registered tests and return `0` if they all succeed, or `1` if any fail.

<Warning>
Do not ignore `RUN_ALL_TESTS()`'s return value; test runners rely on it to determine success.
</Warning>

---

## 5. Tips and Best Practices for Your First Tests

- Always group logically related tests into appropriately named test suites.
- Avoid underscores (`_`) in test suite and test names as it can cause conflicts.
- Use `EXPECT_*` for non-fatal checks that let tests continue.
- Use `ASSERT_*` for critical checks that require immediate test abortion.
- Prefer test fixtures (`TEST_F`) when shared setup or data is needed.
- Keep tests small, focused, and independent for repeatability and clarity.
- Use descriptive names that convey intent without special characters.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Common Pitfalls When Writing Your First Tests">
<Accordion title="Test Fixture Default Constructor Errors">
If you get errors like `no matching function for call to <FixtureName>::<FixtureName>()`, ensure your test fixture class has an accessible default constructor.

Example:
```cpp
class FooTest : public testing::Test {
 public:
  FooTest() = default;  // Define explicitly if other constructors exist
};
```
</Accordion>
<Accordion title="Tests Not Running or Found">
Verify your `main()` calls `testing::InitGoogleTest()` and `RUN_ALL_TESTS()`. Also check that test names do not contain underscores and that your tests compile successfully.
</Accordion>
<Accordion title="Assertion Failures During Test Execution">
Read failure messages carefully; GoogleTest outputs the file and line number of the failure for quick debug.

Use `ASSERT_*` to prevent further invalid operations which could cause crashes.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

Once you have successfully written and run your first test:

- Explore [Assertions Reference](../reference/assertions.md) to learn advanced assertions.
- Learn about [Test Fixtures and Sharing Data](../primer.md#same-data-multiple-tests).
- Try writing [Value-Parameterized Tests](../advanced.md#value-parameterized-tests) and [Typed Tests](../advanced.md#typed-tests) for comprehensive coverage.
- Explore [Running and Validating Tests](../getting-started/first-steps/running-tests) to master test execution and filtering.

---

### Additional Resources

- [GoogleTest Primer](primer.md): A practical introduction to writing tests
- [Getting Started with GoogleMock (Optional)](/getting-started/first-steps/first-mock-test): Add mocking to your toolbox
- [Initial Configuration](../getting-started/setup-overview/configuration-setup): Integrate GoogleTest with your build environment

Happy testing!