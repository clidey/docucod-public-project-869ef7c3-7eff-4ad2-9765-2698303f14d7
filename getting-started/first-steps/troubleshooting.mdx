---
title: "Troubleshooting & FAQ"
description: "Addresses the most common setup issues users encounter, such as build errors, missing dependencies, or failed test runs. Provides clear steps, error patterns to watch for, and helpful references to relevant FAQs."
---

# Troubleshooting & FAQ

This page addresses the most common setup and usage issues users encounter when working with GoogleTest and GoogleMock. Whether you face build errors, missing dependencies, unexpected test failures, or warnings about mock behavior, this guide provides clear explanations, actionable solutions, and references to detailed FAQs and guides.

---

## 1. Common Setup Issues

### 1.1 Build Failures

If you encounter build errors when compiling GoogleTest or your tests, verify the following:

- **System Requirements:** Ensure your compiler and platform meet the GoogleTest version requirements.
- **Dependencies:** Confirm CMake is installed and configured correctly if using CMake-based builds.
- **Include Paths:** Verify that your compiler include paths reference GoogleTest headers correctly.
- **Linking:** Check that your linker includes GoogleTest and GoogleMock libraries.

**Example:** When building on Linux with CMake:

```bash
git clone https://github.com/google/googletest.git
dirname=$(pwd)/googletest
mkdir build && cd build
cmake ${dirname}
make
```

<Tip>
If your build syntax or environment differs, consult the [Installation Instructions](https://github.com/google/googletest/blob/main/docs/getting-started/setup-basics/installation.md) guide for detailed platform-specific steps.
</Tip>

### 1.2 Missing Dependencies

- Confirm the presence of a standard C++ library and compiler support for C++11 or later.
- On Windows, ensure you have Visual Studio 2015 or newer installed.
- For macOS, make sure Xcode and related command line tools are installed.

### 1.3 Failed Test Runs

Verify that tests are linked with GoogleTest libraries and that the test executable runs with the proper environment and permissions.

<Warning>
Tests that never run or crash on start may indicate missing or improperly linked test fixtures or failures in global setup.
</Warning>

---

## 2. Mocking and Expectation Issues

### 2.1 Why Does My Mock Call the Real Method?

Only **virtual** methods can be mocked directly. To mock non-virtual methods, refer to the [high-perf dependency injection technique](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#MockingNonVirtualMethods).

### 2.2 Unexpected Calls and Warnings

GoogleMock differentiates between *uninteresting* calls (methods without expectations) and *unexpected* calls (methods called with unexpected arguments).

- **Uninteresting Calls:** By default, they produce a warning but don’t fail tests. Use `NiceMock<T>` to suppress these warnings or write an `EXPECT_CALL(...).Times(AnyNumber())` to explicitly allow these calls.

- **Unexpected Calls:** These are errors and indicate your test did not expect this call. Adjust your expectations or matchers accordingly.

### 2.3 Mock Methods with Commas in Arguments

If method return or argument types contain commas (e.g., `std::pair`, `std::map`), wrap them within extra parentheses or define type aliases to avoid compilation errors.

**Example:**

```cpp
using BoolAndInt = std::pair<bool, int>;
MOCK_METHOD(BoolAndInt, GetPair, ());

using MapIntDouble = std::map<int, double>;
MOCK_METHOD(bool, CheckMap, (MapIntDouble, bool));
```

### 2.4 How to Disable a Mock Method

If a method should never be called in a test, explicitly specify:

```cpp
EXPECT_CALL(mock_obj, Method(_)).Times(0);
```

Calling the method will generate a test failure.

### 2.5 Controlling Mock Strictness

Use wrappers to control how uninteresting calls are treated:

- `NiceMock<T>` suppresses uninteresting call warnings.
- `NaggyMock<T>` (default) warns on uninteresting calls.
- `StrictMock<T>` treats uninteresting calls as errors.

<Tip>
Prefer `NiceMock` to reduce noise in large test suites and reserve `StrictMock` for cases where every call must be verified.
</Tip>

### 2.6 Setting Default Behavior vs. Expectation

- Use `ON_CALL()` to specify default behavior without enforcing expectations.
- Use `EXPECT_CALL()` to set expectations and optionally define behaviors.

Avoid unnecessary `EXPECT_CALL()` statements for calls you do not want to verify.

### 2.7 Multiple Expectations on the Same Method

GoogleMock evaluates expectations in reverse order — the most recently declared matching expectation overrides older ones.

**Tip:** Place general catch-all expectations before more specific ones.

### 2.8 Ordering Calls

Use `InSequence` to enforce strict call order:

```cpp
{
  InSequence s;
  EXPECT_CALL(mock, Method1());
  EXPECT_CALL(mock, Method2());
}
```

Calls must follow this order or tests will fail.

### 2.9 Retiring Expectations

By default, expectations remain active after saturation. To make an expectation retire (become inactive) when it's saturated, use `.RetiresOnSaturation()`.

This is useful when you want later expectations to become active only after certain calls have occurred.

### 2.10 Leaked Mock Objects

Heap checker errors about leaked mock objects indicate mocks not being deleted, causing missing verification.

Resolve by:

- Ensuring mocks are properly deleted.
- Using `testing::Mock::AllowLeak(mock_obj);` if intentional.

---

## 3. Troubleshooting Common Failures and Warnings

### 3.1 Uninteresting Mock Function Call Warnings

This message means your test called a mock method without expectations.

- If intentional, use `NiceMock<>` or add an `EXPECT_CALL().Times(AnyNumber())`.
- If unexpected, add the correct `EXPECT_CALL` or fix your test logic.

See [Understanding Uninteresting vs Unexpected Calls](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md#uninteresting-vs-unexpected) for details.

### 3.2 Too Few Actions in an EXPECT_CALL

Warning indicating that fewer `WillOnce()` actions are specified than expected calls.

- Provide enough `WillOnce()` clauses or add a `WillRepeatedly()` clause.

### 3.3 Actions Ran Out

GoogleMock falls back to default actions after exhausting `WillOnce()` clauses if no `WillRepeatedly()` is defined, potentially causing unexpected behavior.

- Use `WillRepeatedly()` to specify continued behavior.

### 3.4 Unexpected Call Errors

These occur when a function call does not match any active expectation.

- Check argument matchers and call order.
- Run tests with `--gmock_verbose=info` to trace matching.

### 3.5 Excessive Call Errors

Function called more times than expected.

- Increase cardinality with `.Times()`.
- Use `.RetiresOnSaturation()` on expectations if switching is intended.

### 3.6 Unsatisfied Prerequisites

An expectation is denied because prior expected calls (prerequisites) have not been called yet.

- Review `InSequence()` and `.After()` dependencies.
- Adjust call order or relax sequences.

### 3.7 Mismatched Arguments and Matchers

Test failures with detailed mismatch reports on specific arguments or the combined `With()` matcher.

- Verify the correctness of argument matchers.
- Use `EXPECT_CALL` with detailed matchers.

### 3.8 Heapcheck Failure Reporting Leaked Mocks

Ensure all mocks are deleted or use `Mock::AllowLeak()` for controlled leaks.

---

## 4. Helpful Commands and Test Flags

### Set Verbosity Level

Control GoogleMock message verbosity at runtime:

```bash
--gmock_verbose=info   # Show all info, warnings, stack traces
--gmock_verbose=warning # Show warnings only (default)
--gmock_verbose=error  # Show errors only
```

### Enable Heapchecker

Use platform tools or GoogleTest integrations to catch leaked mocks and memory leaks.

---

## 5. References and Helpful Links

- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md): Recipes for common mocking patterns
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md): API and macros reference
- [gMock for Dummies](https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md): Introductory guide
- [GoogleTest Assertions Reference](https://github.com/google/googletest/blob/main/docs/reference/assertions.md): Test assertions
- [Troubleshooting and FAQ](https://github.com/google/googletest/blob/main/docs/faq.md): General help and answers to common questions

<TableOfContents>
- [Common Setup Issues](#1-common-setup-issues)
- [Mocking and Expectation Issues](#2-mocking-and-expectation-issues)
- [Troubleshooting Common Failures and Warnings](#3-troubleshooting-common-failures-and-warnings)
- [Helpful Commands and Test Flags](#4-helpful-commands-and-test-flags)
- [References and Helpful Links](#5-references-and-helpful-links)
</TableOfContents>

---

<Tip>
For detailed understanding and examples, explore the [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md) and [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md).
</Tip>