---
title: "Configuring Your Project"
description: "Guides users to set up include paths and linker settings for GoogleTest, explains integration of source files and dependencies, and points out best practices for flexible project setup across different build systems."
---

# Configuring Your Project

This guide helps you seamlessly set up your project to use GoogleTest. You'll learn how to configure include paths, adjust linker settings, integrate GoogleTest source files and dependencies, and apply best practices for flexible project setups across various build systems like CMake and Bazel.

---

## 1. Setting Up Include Paths

Before you can compile your tests, instruct your build system where to find GoogleTest headers.

- **Include the following directories in your project:**
  - `googletest/include`
  - `googlemock/include` (if using GoogleMock)
  
These contain the necessary header files like `gtest/gtest.h` and `gmock/gmock.h`.

> In CMake, this is typically done by linking against the targets `GTest::gtest` or `GMock::gmock` which carry include directories automatically.


## 2. Linking GoogleTest Libraries

To compile your tests, link against the appropriate GoogleTest libraries.

- Use `gtest` or `gmock` if you want to link the libraries manually.
- Use `gtest_main` or `gmock_main` if you prefer GoogleTestâ€™s or GoogleMock's built-in `main()` function.

### Key points:
- Linking with `gtest_main` or `gmock_main` saves you from writing your own `main()` function.
- When using GoogleMock, link against `gmock_main` to initialize both GoogleMock and GoogleTest properly.


## 3. Integrating Source Files and Dependencies

You can integrate GoogleTest into your project in two ways depending on your development workflow:

### A. Using Installed GoogleTest Libraries

1. Install GoogleTest system-wide or in a known location.
2. Use `find_package(GTest REQUIRED)` in CMake to locate the libraries.
3. Link your test targets against the found libraries:

```cmake
find_package(GTest REQUIRED)
target_link_libraries(your_test_target PRIVATE GTest::gtest_main)
```

This method is straightforward but requires the library to be properly installed on the development machine.

### B. Building GoogleTest as Part of Your Project

Use this method for tighter integration, ensuring consistent compiler and linker flags.

1. Add GoogleTest as a subdirectory to your build system, e.g.,

```cmake
add_subdirectory(path/to/googletest)
```

2. Link your tests directly with the GoogleTest targets:

```cmake
target_link_libraries(your_test_target PRIVATE gtest_main)
```

This approach avoids common issues related to incompatible compiler settings.


## 4. Build System Specific Guidance

### Using CMake

GoogleTest provides built-in CMake support.

- To include GoogleTest as part of your build:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/main.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(your_tests test.cpp)
target_link_libraries(your_tests GTest::gtest_main)
add_test(NAME your_tests COMMAND your_tests)
```

- To switch between static and shared libraries or tweak runtime linking on Windows, adjust options like `BUILD_SHARED_LIBS` and `gtest_force_shared_crt`.

### Using Bazel

Refer to Bazel build integration documentation (not covered in this guide) to properly add GoogleTest as a dependency and link with your test binaries.


## 5. Best Practices for Flexible Project Setup

- **Avoid duplicate linkage:** Link against either `gtest` + your own main, or simply `gtest_main` to use the default main function.
- **Consistent compiler flags:** Ensure GoogleTest and your code use the same C++ standard and runtime settings.
- **Use platform checks:** GoogleTest supports Linux, Windows, and macOS. Incorporate platform-specific logic if necessary for include and linker paths.

<Tip>
For most projects, the easiest setup uses CMake's `FetchContent` or installs a stable version and uses `find_package()` to avoid manual path management.
</Tip>


## 6. Writing Your Own main() (Optional)

If you need custom initialization before running tests, write your own `main()`:

```c++
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

- Call `testing::InitGoogleTest()` before `RUN_ALL_TESTS()`.
- Return the result of `RUN_ALL_TESTS()` for proper exit code reporting.

When using GoogleMock, replace `testing::InitGoogleTest()` with `testing::InitGoogleMock()`.


## 7. Verifying Your Configuration

After setup, verify everything works:

1. Compile your test target.
2. Run the test executable.
3. You should see output indicating GoogleTest initializes and the tests run.

Expected output example:

```
Running main() from gtest_main.cc
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[ RUN      ] SampleTest.Case1
[       OK ] SampleTest.Case1 (0 ms)
[ RUN      ] SampleTest.Case2
[       OK ] SampleTest.Case2 (1 ms)
[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (1 ms total)
[  PASSED  ] 2 tests.
```


## 8. Troubleshooting Common Issues

<AccordionGroup title="Common Configuration Issues">
  <Accordion title="Include Path Errors">
    If your compiler cannot find `gtest/gtest.h` or `gmock/gmock.h`:

    - Confirm include directories correctly point to GoogleTest and GoogleMock headers.
    - Check for typos in paths or CMake variable names.
    - Verify your editor or IDE has synced changes in build configuration.
  </Accordion>
  <Accordion title="Linker Errors (Undefined References)">
    If linking fails with undefined symbols from GoogleTest:

    - Ensure you are linking against the correct libraries (`gtest`, `gtest_main`, `gmock`, or `gmock_main`).
    - Check that library search paths include GoogleTest libraries.
    - Verify consistency between static/shared linkage.
  </Accordion>
  <Accordion title="Multiple main() Definition Errors">
    Errors arise when multiple definitions of `main()` exist:

    - Link with either `gtest` and supply your own main function, or
    - Link with `gtest_main`/`gmock_main` and do not define your own main.
  </Accordion>
  <Accordion title="Runtime Test Discovery Fails">
    If tests do not execute:

    - Confirm `RUN_ALL_TESTS()` is called in your `main()`.
    - Confirm test files are compiled and linked with GoogleTest.
    - Check that correct macros `TEST()` or `TEST_F()` are used to define tests.
  </Accordion>
</AccordionGroup>


---

## Additional Resources

- [Installing with CMake](/getting-started/setup-overview/install-cmake)
- [Installing with Bazel](/getting-started/setup-overview/install-bazel)
- [Writing and Running Your First Test](/getting-started/first-steps/write-first-test)
- [Troubleshooting Common Issues](/getting-started/first-steps/troubleshooting)

---

By following these steps, you will precisely configure your project to compile, link, and run GoogleTest-based tests smoothly and reliably across platforms and build systems.