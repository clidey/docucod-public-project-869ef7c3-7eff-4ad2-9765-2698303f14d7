---
title: "Writing Your First Unit Test"
description: "Walkthrough for creating and running your first unit test with GoogleTest. Includes a canonical example, explanations of macros, and running your test binary to see green/red results."
---

# Writing Your First Unit Test with GoogleTest

This guide walks you through creating and running your first unit test using GoogleTest. You will learn how to write tests with the canonical `TEST` macro, understand key concepts behind macros and test organization, and run your test binary to observe success (green) or failure (red) outcomes.

---

## 1. What Is a GoogleTest Unit Test?

A unit test in GoogleTest is a small, self-contained C++ function that verifies the behavior of a specific piece of your code. Tests are grouped logically into *test suites*.

A test looks like this:

```cpp
TEST(TestSuiteName, TestName) {
  ... your assertions ...
}
```

- `TestSuiteName` groups related tests (think of it like a class for your tests).
- `TestName` identifies the individual test case within the suite.

You write multiple tests targeting different behaviors, inputs, and outputs to validate your functionality thoroughly.

---

## 2. Preparing Your Environment

Before writing your first test, ensure your environment is set up:

- GoogleTest is installed and configured correctly in your project.
- Your compiler supports C++17 or later.
- Your build system (e.g., CMake or Bazel) can locate the GoogleTest headers and libraries.

For installation assistance, see [Installation via CMake](/getting-started/setup-and-installation/installation-via-cmake) or [Building from Source](/getting-started/setup-and-installation/building-from-source).

---

## 3. Creating a Simple Test

Follow these steps to write and run a simple test verifying a function's correctness.

### Step 1: Include GoogleTest Header

In your test source file (for example, `factorial_test.cc`), include the GoogleTest header:

```cpp
#include <gtest/gtest.h>
```

### Step 2: Write the Function to Test

Assuming the function you want to test is the factorial function:

```cpp
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}
```

### Step 3: Define Test Cases Using `TEST`

Create multiple tests in the same suite to cover different cases:

```cpp
// Test factorial of zero input
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Test factorial of positive numbers
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

The `EXPECT_EQ` assertion checks for equality. If the expected and actual values differ, the test will fail.

---

## 4. Understanding GoogleTest Macros

### `TEST` vs `TEST_F`

- Use `TEST` for simple tests with no shared setup.
- Use `TEST_F` when multiple tests share common data or setup encapsulated in a *test fixture* class derived from `testing::Test`.

### Assertions

GoogleTest provides many assertion macros:

- `EXPECT_*` - Non-fatal failures, lets the test continue.
- `ASSERT_*` - Fatal failures, aborts the test function immediately.

Use `EXPECT_*` when you want to check multiple conditions even if some fail; use `ASSERT_*` when subsequent statements depend on the assertion.

Example assertions:

```cpp
EXPECT_TRUE(condition);
EXPECT_EQ(val1, val2);
ASSERT_NE(ptr, nullptr);
ASSERT_LT(value, limit);
```

---

## 5. Writing and Using Test Fixtures

When several tests need the same initialization or cleanup, use fixtures.

### Step 1: Define a Fixture Class

```cpp
class QueueTest : public ::testing::Test {
 protected:
  QueueTest() {
    // Initialize queues
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};
```

### Step 2: Write Tests Using `TEST_F`

```cpp
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

Each test gets a fresh fixture; changes in one do not affect others.

---

## 6. Running Your Tests

### Step 1: Initialize GoogleTest

Usually you donâ€™t write your own `main()`; instead, link with `gtest_main`. If you do write a custom `main()`, it must look like this:

```cpp
int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Step 2: Build Your Test Binary

If using CMake, your `CMakeLists.txt` might link your test like:

```cmake
add_executable(factorial_test factorial_test.cc)
target_link_libraries(factorial_test gtest_main gtest)
add_test(NAME factorial_test COMMAND factorial_test)
```

Then build with:

```bash
cmake -S . -B build
cmake --build build
ctest --test-dir build
```

### Step 3: Run the Test

Execute your test binary:

```bash
./build/factorial_test
```

Successful tests print green "PASSED" messages; failures show detailed messages in red.

---

## 7. Interpreting Test Results

GoogleTest outputs detailed logs with line numbers and failure reasons when tests fail. Test grouping by suites helps organize results. Example:

```
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
factorial_test.cc:20: Failure
Expected equality of these values:
  Factorial(2)
    Which is: 3
  2
[  FAILED  ] FactorialTest.HandlesPositiveInput (0 ms)

  ... summary ...
```

Failing assertions are clearly indicated with file and line number, making fixes straightforward.

---

## 8. Tips and Best Practices

- **Name tests descriptively.** Use meaningful test and suite names to clarify intent.
- **Use `EXPECT_` vs `ASSERT_` wisely.** Prefer `EXPECT_` to let tests gather multiple failures, but use `ASSERT_` when subsequent code depends on conditions.
- **Avoid dependencies between tests.** Each test is independent; do not share state.
- **Group related tests into suites.** The suite provides logical organization.
- **Use test fixtures for shared setup.** Helps reduce duplication.
- **Run tests often.** Fast feedback helps early bug detection.

---

## 9. Troubleshooting Common Issues

### Tests Not Running

- Verify your test binary is linked properly with GoogleTest.
- Ensure `main()` is defined or link with `gtest_main`.

### Assertions Not Failing When Expected

- Confirm assertion macros are correctly called (`EXPECT_` or `ASSERT_`).
- Make sure your test actually exercises the code under test.

### Compilation Errors

- Verify C++ version is C++17 or later.
- Check if GoogleTest headers and libraries are correctly included and linked.

For more troubleshooting, see [Common Setup Issues](/getting-started/troubleshooting-and-resources/common-setup-issues).

---

## 10. Next Steps

After mastering your first test, you can explore:

- Writing parameterized tests and fixtures for complex scenarios.
- Integrating GoogleMock for mocking dependencies.
- Organizing large test suites efficiently.
- Advanced assertions and death tests.

Explore these related guides for further learning:

- [Project Configuration](/getting-started/configuration-and-first-test/project-configuration)
- [Using GoogleMock](/guides/mocking-with-googlemock/introduction-to-mocking)
- [Assertions Reference](/api-reference/core-testing-apis/assertions-expectations)

Feel confident to experiment, write more tests, and leverage the power of GoogleTest to ensure your C++ code is robust and reliable.

---