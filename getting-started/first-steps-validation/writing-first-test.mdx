---
title: "Writing and Running Your First Test"
description: "Quickly scaffold, write, and run your initial C++ test using GoogleTest or GoogleMock. Includes a sample test case to validate your setup and demonstrates core assertion mechanisms."
---

# Writing and Running Your First Test

Quickly scaffold, write, and run your initial C++ test using GoogleTest or GoogleMock. Includes a sample test case to validate your setup and demonstrates core assertion mechanisms.

---

## 1. Preparing Your Test Program

Before writing your first test, ensure you have completed the following setup steps:

- Installed GoogleTest and GoogleMock libraries in your project.
- Configured your build system to link against GoogleTest as described in the [Initial Project Configuration](../setup-overview/first-project-setup).
- Included GoogleTest headers (typically `<gtest/gtest.h>`) in your test files.
- Initialized GoogleTest in your `main()` function.


### Example `main()` Function

Create a `main()` function that initializes and runs all tests:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

> This `main()` handles command-line flag parsing and triggers test execution.


## 2. Defining Your First Basic Test

GoogleTest uses the `TEST()` macro to define test cases. Each test is part of a *test suite* and has a unique name within that suite.

**Important naming conventions:**

- Both test suite and test names must be valid C++ identifiers.
- Underscores (`_`) are not allowed in test names or test suite names.


### Writing a Simple Test

```cpp
TEST(SampleTest, AdditionWorks) {
  int result = 2 + 2;
  EXPECT_EQ(result, 4);
}
```

- `SampleTest` is the test suite name.
- `AdditionWorks` is the test name.
- `EXPECT_EQ` is an assertion that tests equality and records failures if it does not hold.


### What Happens When the Test Runs

- GoogleTest creates an instance of the testing environment.
- It calls the test function registered via the `TEST` macro.
- If any assertion fails (e.g., `EXPECT_EQ`) the test reports failure but continues.
- Fatal failures (via `ASSERT_*`) abort the test function immediately.


## 3. Using Test Fixtures for Reusable Setup

When multiple tests share setup or data, use *test fixtures* by defining a class derived from `testing::Test`. This lets you reuse member variables and setup/teardown code.


### Defining a Test Fixture Class

```cpp
class MathTest : public testing::Test {
 protected:
  void SetUp() override {
    // Initialize common data here
  }

  void TearDown() override {
    // Cleanup code here
  }

  // Shared data
  int base_value_ = 5;
};
```

### Writing Tests with Fixtures

Use `TEST_F()` where the first parameter is the fixture class name:

```cpp
TEST_F(MathTest, Multiplication) {
  int result = base_value_ * 3;
  EXPECT_EQ(result, 15);
}

TEST_F(MathTest, Addition) {
  EXPECT_EQ(base_value_ + 10, 15);
}
```

GoogleTest creates a fresh `MathTest` instance for each test, calling `SetUp()` before the test body and `TearDown()` after.


## 4. Running Your Tests

Compile your test binary with GoogleTest linked. Then run it directly from your terminal or IDE.

Example run output:

```
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from SampleTest
[ RUN      ] SampleTest.AdditionWorks
[       OK ] SampleTest.AdditionWorks (0 ms)
[ RUN      ] SampleTest.MultiplicationWorks
[       OK ] SampleTest.MultiplicationWorks (0 ms)
[----------] 2 tests from SampleTest (0 ms total)
[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```


## 5. Sample Full Test Source Code

Here's a complete example that combines the above steps:

```cpp
#include <gtest/gtest.h>

// Basic test
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(1, 1);  // Factorial(0) == 1
}

// Test fixture
class QueueTest : public testing::Test {
 protected:
  void SetUp() override {
    q_.clear();
  }

  std::deque<int> q_;
};

TEST_F(QueueTest, IsInitiallyEmpty) {
  EXPECT_TRUE(q_.empty());
}

TEST_F(QueueTest, CanEnqueueAndDequeue) {
  q_.push_back(5);
  ASSERT_FALSE(q_.empty());
  int front = q_.front();
  EXPECT_EQ(front, 5);
  q_.pop_front();
  EXPECT_TRUE(q_.empty());
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```


## 6. Best Practices and Tips

- Prefer `EXPECT_*` macros over `ASSERT_*` unless a failed assertion must abort the current test function immediately.
- Avoid underscores in test suite and test names to prevent naming collisions and compiler errors.
- Use test fixtures (`TEST_F`) when multiple tests need shared data or setup/teardown.
- Invoke `testing::InitGoogleTest()` before `RUN_ALL_TESTS()` in `main()` to process command-line flags.
- Always return the value of `RUN_ALL_TESTS()` from `main()` to correctly report test success/failure.


## 7. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Your First Test">
<Accordion title="Test Fixture Not Found or 'no matching function for call' Errors">
Check that your fixture class has a public default constructor. GoogleTest creates a fresh instance for each test; missing default constructors cause compile-time errors.
</Accordion>
<Accordion title="Tests Not Running or Being Discovered">
Ensure you have properly linked GoogleTest libraries and your test sources are included in your build target. Confirm you have called `testing::InitGoogleTest()` in `main()`.
</Accordion>
<Accordion title="Test Names Containing Underscores Causing Build Issues">
Rename your test suite and test names to exclude underscores (`_`). Use capitalized camel case (e.g., `SampleTest`) instead.
</Accordion>
<Accordion title="Assertions Not Aborting as Expected">
Remember that `ASSERT_*` macros abort only the current function, not the entire test suite or process. Use `EXPECT_NO_FATAL_FAILURE()` or `HasFatalFailure()` to control flow accordingly.
</Accordion>
</AccordionGroup>


## 8. Next Steps

- [Writing Parameterized Tests](../first-steps-validation/writing-first-test) to test code with varying inputs.
- [Using Mocks with GoogleMock](../../guides/core-testing-workflows/using-mocks) to isolate dependencies.
- [Assertions Reference](../reference/assertions) for a full list of assertion macros and their usage.


---

### Additional References

- [GoogleTest Primer](../primer): Learn foundational concepts before writing tests.
- [Initial Project Configuration](../setup-overview/first-project-setup): How to set up your project to use GoogleTest.
- [Installation Guide](../setup-overview/installation-guide): How to install and build GoogleTest.
- [Troubleshooting Common Setup Issues](../first-steps-validation/common-setup-issues): Resolving common build and runtime problems.

---

This page fits into the Getting Started section, following installation and project setup guides, providing a practical path to author, compile, and run your first tests successfully.

---

# Appendix: Core Test Macros Overview

| Macro     | Description                                     | Usage Example                      |
|-----------|------------------------------------------------|----------------------------------|
| `TEST`    | Defines a basic test case                       | `TEST(MySuite, MyTest) { ... }`   |
| `TEST_F`  | Defines a test with a test fixture             | `TEST_F(MyFixture, MyTest) { ... }`|
| `RUN_ALL_TESTS()` | Runs all tests registered                | `return RUN_ALL_TESTS();`          |

---