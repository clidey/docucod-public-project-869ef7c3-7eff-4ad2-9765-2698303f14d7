---
title: "Troubleshooting Common Setup Issues"
description: "Solutions to the most common new-user problems: build failures, missing dependencies, linking errors, or incompatible toolchains. Get unblocked fast with focused troubleshooting advice and references."
---

# Troubleshooting Common Setup Issues

When setting up GoogleTest and GoogleMock, users can encounter a range of problems—build failures, missing dependencies, linking errors, or incompatible toolchains. This page provides practical guidance to unblock you quickly, enabling a smooth start to writing and running your tests.

---

## Common Build Failures

### Cause: Missing or Incorrect Dependencies

Errors during compilation often stem from missing headers or libraries.

**Resolution Steps:**

1. Verify you have the necessary build tools installed:
   - C++ compiler supporting at least C++17.
   - CMake (version 3.14 or later recommended).
2. Check that your build configuration includes the GoogleTest and GoogleMock headers and sources.
3. If using CMake, confirm that the commands like `find_package(GTest CONFIG REQUIRED)` and `target_link_libraries` are correctly set up.

### Cause: Compiler Compatibility Issues

GoogleTest requires a modern C++17-compatible compiler.

**Resolution:**

- Upgrade your compiler to a version supporting C++17. Common minimum versions:
  - GCC 7 or later
  - Clang 5 or later
  - MSVC 2017 or later

Validate this by running `g++ --version` or equivalent and ensure your compiler flags specify `-std=c++17`.

### Cause: CMake Configuration Problems

Common issues include incorrect paths or missing targets.

**Resolution:**

- Make sure the build folder is clean (`rm -rf build/`)
- Re-run CMake from the root directory.
- If building GoogleTest standalone, use:

```bash
cmake ..
make
sudo make install
```
- If integrating GoogleTest into a project via `add_subdirectory()`, confirm relative paths are correct.


## Linking Errors

### Cause: Runtime Library Mismatch on Windows

You may see errors like:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

**Resolution:**

- Use the CMake option `gtest_force_shared_crt` to match your project’s runtime:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

- Ensure all code (GoogleTest and your code) use the same runtime library settings (dynamic vs static).

### Cause: Missing GoogleMock Symbols

When linking, unresolved symbols related to GoogleMock may occur.

**Resolution:**

- Verify you link both GoogleTest and GoogleMock libraries.
- When building standalone, GoogleMock is included by default. To disable, use `-DBUILD_GMOCK=OFF`.
- If you only want GoogleTest, ensure to disable gMock explicitly.

### Cause: Incorrect Build of GoogleMock Main

In some environments, building and linking the `gmock_main` library incorrectly leads to problems.

**Resolution:**

- When using `gmock_main`, do not call `testing::InitGoogleTest` separately; use `testing::InitGoogleMock` instead.
- See `googlemock/src/gmock_main.cc` for reference implementation.


## Runtime Issues

### Cause: Tests Not Running or Being Discovered

If your test executable runs but no tests are executed:

**Resolution:**

- Ensure tests are registered correctly, using `TEST()` or `TEST_F()` macros.
- Call `testing::InitGoogleTest(&argc, argv);` (or `InitGoogleMock` if including gMock) before `RUN_ALL_TESTS()`.
- Confirm your `main()` method returns the value of `RUN_ALL_TESTS()`.
- Make sure that the linker includes all test object files.

### Cause: GoogleMock Warnings About Uninteresting Calls

If you see warnings like "Uninteresting function call encountered - default action taken...":

**Resolution:**

- This means an expected mock method is called but hasn’t been given explicit expectations.
- To suppress warnings, either:
  - Use `NiceMock` wrappers.
  - Add a catch-all expectation with `EXPECT_CALL(mock, method(_)).Times(AnyNumber());`.


## Incompatible Toolchains

### Cause: Using Outdated MSVC Versions

Older MSVC compilers may show warnings or errors related to `const` parameters in mock methods.

**Resolution:**

- Upgrade to MSVC 2008 SP1 or later.
- Avoid declaring mock method parameters as `const` in the mock class; this causes MSVC to warn erroneously.
- For pointers or references to const, these qualifiers must be kept.

### Cause: Using Legacy Build Systems Without C++17 Support

**Resolution:**

- You must migrate your project or compiler settings to support C++17.
- This may involve setting the appropriate flags, for example: `-std=c++17` for GCC/Clang or `/std:c++17` for MSVC.


---

## Best Practices to Prevent Common Issues

- Always set expectations with `EXPECT_CALL` before exercising mock objects.
- Use `ON_CALL` to specify default behaviors without enforcing call expectations.
- Wrap complicated mock classes with `NiceMock` to minimize noisy warnings during test development.
- Clean your build directory before reconfiguring or rebuilding.
- Use verbose flags like `--gmock_verbose=info` to get detailed call traces for debugging expectation failures.

---

## Useful Commands for Troubleshooting

```bash
# Clean build
rm -rf build/
mkdir build && cd build
# Generate build files
cmake ..
# Build
make
# Run tests with detailed logging
./my_test_binary --gmock_verbose=info
```

---

## Where to Get More Help

- Review [Installation Guide](/getting-started/setup-overview/installation-guide) for detailed setup instructions.
- Use the [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) for specific mocking related issues.
- Consult [Writing and Running Your First Test](/getting-started/first-steps-validation/writing-first-test) to verify your test structure.
- Check build integration examples on [Integration with Build Systems](/overview/integrations/integration-with-build-systems).

---

## Summary
This troubleshooting guide addresses the most frequent setup problems encountered by new users of GoogleTest and GoogleMock, including build failures, linking errors, and incompatible environments, along with proven solutions and tips to avoid them. Employing recommended build configurations and tools ensures a smooth test development experience.

---

<AccordionGroup title="Frequently Encountered Setup Issues">
<Accordion title="Build Fails - Missing Headers or Libraries">
Ensure your build is configured with the correct include paths and linked with necessary GoogleTest and GoogleMock libraries. Use CMake’s `find_package` and verify C++17 support.
</Accordion>
<Accordion title="Linker Errors on Windows: Runtime Mismatch">
Resolve linker errors by enabling `gtest_force_shared_crt` in CMake to align runtime libraries across all components.
</Accordion>
<Accordion title="Tests Not Discovered or Executed">
Confirm your test functions use `TEST()` or `TEST_F()`. Initialize GoogleTest or GoogleMock properly before `RUN_ALL_TESTS()`.
</Accordion>
<Accordion title="MSVC Const Parameter Warning">
Remove top-level `const` qualifiers on mock method parameters to avoid MSVC warnings related to overriding virtual functions.
</Accordion>
</AccordionGroup>

<Tip>
Always clean your build directory after changing compiler versions or upgrading CMake to avoid stale configurations causing mysterious build issues.
</Tip>

<Note>
Using `NiceMock` in early test phases reduces noise by suppressing warnings about uninteresting calls; switch to stricter mocks when your tests mature.
</Note>

<Warning>
Do not mix incompatible runtime library settings and compiler versions; such mismatches are a frequent source of hard-to-diagnose build failures.
</Warning>

---

## Example: Minimal CMake Build for GoogleTest and GoogleMock

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
cd googletest
mkdir build && cd build
cmake ..
make
```

This sequence builds both GoogleTest and GoogleMock. If you want only GoogleTest,

```bash
cmake .. -DBUILD_GMOCK=OFF
make
```

After building, be sure to link your tests against the libraries properly.

---

## Check Your Test Main Function

Confirm your test executable’s `main()` looks like:

```cpp
int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Or use GoogleMock’s initializer if additionally mocking:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Incorrect or missing initialization leads to no tests running or ignored command-line options.

---

## Using Verbose Mode to Debug Expectations

Run your tests with:

```bash
./my_test_binary --gmock_verbose=info
```

This shows detailed trace of all mock calls and expectations, helping pinpoint why expectations fail.

---

## Reference Links

- [GoogleTest Installation Guide](/getting-started/setup-overview/installation-guide)
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html)
- [Writing and Running Your First Test](/getting-started/first-steps-validation/writing-first-test)
- [Integration with Build Systems](/overview/integrations/integration-with-build-systems)

---

<Info>
For advanced troubleshooting related to compiler-specific quirks or linking issues, consult your compiler and linker documentation alongside GoogleTest’s platform compatibility notes.
</Info>  