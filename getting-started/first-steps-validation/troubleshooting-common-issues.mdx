---
title: "Troubleshooting Common Setup Issues"
description: "Solve common problems encountered during installation, configuration, or your first test run. This page provides troubleshooting checklists, error explanations, and links to further support resources, enabling quick recovery from common pitfalls."
---

# Troubleshooting Common Setup Issues

This page guides you through solving common problems you may encounter during the installation, configuration, or your first test run of GoogleTest and GoogleMock. By systematically addressing frequent pitfalls and providing quick fixes, you can recover smoothly and continue developing tests with confidence.

---

## 1. Installation Problems

### Symptom: Missing or Unrecognized Headers

- **Cause:** Your compiler or project configuration does not find `gmock/gmock.h` or `gtest/gtest.h`.
- **Solution:**
  1. Ensure GoogleTest and GoogleMock are properly installed or added as submodules.
  2. Confirm your include paths in your build system (CMake, Bazel, manual) point to the correct directories containing the headers.
  3. For manual installs, verify the source tree structure is intact.

### Symptom: Linker Errors for gMock or gTest Symbols

- **Cause:** Missing linkage to the GoogleTest and GoogleMock libraries.
- **Solution:**
  1. Link against `gmock` and `gtest` libraries as appropriate in your linker settings.
  2. When using CMake, add `target_link_libraries(your_target gmock gtest)`.
  3. For Bazel, add `deps = ["@com_google_googletest//:gmock_main"]` or similar.

### Symptom: Compiler Errors Related to MOCK_METHOD

- **Cause:** Possibly due to incorrect macro usage or missing C++11 compiler support.
- **Solution:**
  1. Verify that methods mocked are virtual in the base class.
  2. Use the proper syntax for `MOCK_METHOD` as detailed in the [gMock Cookbook](docs/gmock_cook_book.md).
  3. Ensure your compiler supports C++11 or newer.

---

## 2. Configuration and Build Issues

### Symptom: Tests Not Discovering or Running

- **Cause:** Incorrect test executable setup or missing GoogleTest initialization.
- **Solution:**
  1. Make sure to call `::testing::InitGoogleMock(&argc, argv);` in your `main()`.
  2. Confirm that your test executable is correctly built and linked with GoogleTest and GoogleMock.
  3. When using CMake, use `gtest_add_tests()` or properly register tests.

### Symptom: Unexpected Behavior From Mocks

- **Cause:** Expectations might not be set properly before test execution.
- **Solution:**
  1. Define all `EXPECT_CALL` and `ON_CALL` statements before exercising the mock objects.
  2. Avoid calling mock methods before expectations are set to prevent undefined behavior.

### Symptom: Excessive Compiler Memory Usage or Long Compile Times

- **Cause:** Large mock classes with many methods can cause slow compile times.
- **Solution:**
  1. Move mock class constructors and destructors out of header files into `.cc` files to reduce recompilation costs.
  2. Use precompiled headers and optimize your build system accordingly.

---

## 3. Runtime Errors and Test Failures

### Symptom: Unexpected Mock Function Call Failures

You see messages like “Unexpected mock function call” or “Mock function called more times than expected.”

- **Understanding:** These errors occur when the calls to mock methods do not match any active expectation.
- **Common Causes:**
  - Calling a mock method without an `EXPECT_CALL` for that scenario.
  - Calling a method more times than specified by `Times()`.
  - Calling methods out of the declared order if using sequences.
- **Resolution Steps:**
  1. Review the console output to identify which mock method triggered the error.
  2. Verify that `EXPECT_CALL` coverage includes all expected calls.
  3. Adjust `.Times()` parameters if multiple calls are expected.
  4. Use sequences (`::testing::InSequence`) carefully to enforce order only if needed.

### Symptom: "Uninteresting mock function call" Warnings

- **Meaning:** A call to a mock method was made without a matching expectation, but gMock allowed it with a warning.
- **How to Address:**
  1. If the call is expected but should not cause warnings, replace `ON_CALL` with an `EXPECT_CALL` with `.Times(AnyNumber())`.
  2. If unimportant, consider using `NiceMock` to suppress these warnings.
  3. If strict verification is needed, use `StrictMock` instead to treat uninteresting calls as failures.

### Symptom: Test Hangs or Deadlocks When Using Mocks in Multi-threaded Tests

- **Cause:** Violating thread safety rules when interacting with mocks.
- **Recommendations:**
  1. Compose your test; execute test code on a single thread.
  2. Set expectations and default actions only when no mock method calls are in progress.
  3. Synchronize any access in multiple threads as needed.

---

## 4. Debugging Tips

### Use `--gmock_verbose=info` Flag

Run your tests with this flag to get detailed logs about which expectations are matched, the arguments passed, and the call stack. This output helps reveal why some calls fail to match.

### Review Stack Traces for Warnings and Errors

Detailed stack traces are included to help you trace the source of unexpected/uninteresting calls or failures.

### Verify Mock Object Lifetime

Ensure mock objects are destroyed at the end of the test so that expectations are automatically verified. Use `Mock::VerifyAndClearExpectations(&mock_object);` if you need to manually verify early.

### Avoid Test Flakiness

Use `RetiresOnSaturation()` on expectations that should deactivate after being fulfilled to prevent sticky expectations from causing failures in later calls.

---

## 5. Additional Resources

- [gMock Cookbook](docs/gmock_cook_book.md): Detailed recipes on common mocking techniques and troubleshooting.
- [gMock for Dummies](docs/gmock_for_dummies.md): Beginner-friendly introduction and examples.
- [Mocking Reference](docs/reference/mocking.md): In-depth explanation of macros and classes.
- [gMock Cheat Sheet](docs/gmock_cheat_sheet.md): Quick syntax and usage patterns.
- [FAQ: Legacy gMock FAQ](docs/gmock_faq.md): Answers to frequent technical questions.
- GoogleTest Build and Installation Guides in the Getting Started section.

---

## 6. Quick Checklist

| Issue                         | Quick Fix/Check                                     |
|-------------------------------|----------------------------------------------------|
| Headers not found              | Check include paths; ensure submodules or packages are fetched |
| Linker errors                 | Link GoogleTest and GoogleMock libraries correctly  |
| Mock methods fail to compile  | Verify `MOCK_METHOD` usage and virtual overrides    |
| Unexpected calls              | Add or adjust `EXPECT_CALL` on mock objects         |
| Uninteresting call warnings   | Use `NiceMock` or add default actions with `EXPECT_CALL(...).Times(AnyNumber())` |
| Tests hang in multithreaded   | Ensure proper usage of mocks only on single thread during setup and teardown   |

---

## 7. Troubleshooting Example

Suppose your test fails with:

```
GMOCK WARNING:
Uninteresting mock function call - returning default value.
    Function call: Bar2(0, 1)
          Returns: false

NOTE: You can safely ignore the above warning unless this call should not happen.
```

**How to resolve:**

1. Decide if the call to `Bar2(0, 1)` is intended.
2. If so, add:

```cpp
EXPECT_CALL(mock_obj, Bar2(0, 1)).Times(AnyNumber());
```

or make the mock "nice":

```cpp
NiceMock<MockClass> mock_obj;
```

3. If not intended, find the call site and fix your test or production code.

---

By following the above guidance, you can swiftly resolve setup and initial usage problems, ensuring your GoogleTest and GoogleMock environment works seamlessly for your C++ testing workflow.
