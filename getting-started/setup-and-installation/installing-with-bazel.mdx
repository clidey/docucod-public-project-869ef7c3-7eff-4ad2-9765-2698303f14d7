---
title: "Installing with Bazel"
description: "Targeted guidance for developers using Bazel: includes workspace setup, dependency management, and integration details to quickly enable GoogleTest and GoogleMock in Bazel-oriented environments."
---

# Installing with Bazel

This guide provides targeted, step-by-step instructions for C++ developers who want to quickly set up and use **GoogleTest** and **GoogleMock** in Bazel-based projects. By following this guide, you will configure your Bazel workspace, manage dependencies, and build your first test executable leveraging Bazel's build and test automation capabilities.

---

## 1. Prerequisites

Before starting, ensure the following:

- **Operating System**: Compatible OS such as Linux, macOS, or Windows.
- **C++ Compiler**: Must support at least **C++17** standard.
- **Bazel**: Version 7.0 or newer installed.

For detailed platform compatibility and compiler requirements, refer to the [Supported Platforms documentation](/getting-started/setup-and-installation/prerequisites-system-requirements).

If Bazel is not installed, follow the official [Bazel installation guide](https://bazel.build/install) to set it up.

---

## 2. Setting Up Your Bazel Workspace

### Step 1: Create Your Workspace Directory

Open a terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

This directory will contain your project files and Bazel configuration.

### Step 2: Define Dependencies in `MODULE.bazel`

Create a file named `MODULE.bazel` in your workspace root with the following content:

```python
# MODULE.bazel

# Use the latest stable version of GoogleTest
bazel_dep(name = "googletest", version = "1.17.0")
```

This instructs Bazel to fetch GoogleTest (which includes GoogleMock) from the Bazel Central Registry.

<Note>
Make sure to use the most recent stable version number available at https://registry.bazel.build/modules/googletest.
</Note>

---

## 3. Creating and Running a Test Binary

### Step 1: Create Your Test Source File

Inside your workspace directory, create a file named `hello_test.cc` with the following contents to demonstrate a simple test:

```cpp
#include <gtest/gtest.h>

// A test case named HelloTest with one test named BasicAssertions
TEST(HelloTest, BasicAssertions) {
  // Verify two strings are not equal
  EXPECT_STRNE("hello", "world");

  // Verify numeric equality
  EXPECT_EQ(7 * 6, 42);
}
```

### Step 2: Create the Bazel Build File

In the same directory, create a file named `BUILD` containing this Bazel build rule:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This defines a test binary that links against GoogleTest libraries, including the `main()` function implementation.

### Step 3: Build and Run Your Test

Build and execute the test with this one command:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures compiling with the C++17 standard.
- `--test_output=all` shows detailed test output in the console.

### Expected Success Output

```
INFO: Analyzed target //:hello_test (26 packages loaded, 362 targets configured).
INFO: Found 1 test target...
INFO: From Testing //:hello_test:
==================== Test output for //:hello_test:
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
================================================================================
Target //:hello_test up-to-date:
  bazel-bin/hello_test
INFO: Build completed successfully, 27 total actions
//:hello_test                                                     PASSED in 0.1s

INFO: Build completed successfully, 27 total actions
```

Congratulations! This confirms Bazel successfully built and ran your GoogleTest binary.

<Check>
If your output differs or tests fail, check your compiler supports C++17 and ensure Bazel dependencies are correctly defined.
</Check>

---

## 4. Understanding the Bazel Integration

- The `MODULE.bazel` file controls external dependency versions, enabling easy updates and dependency management.
- Bazel automatically downloads and caches GoogleTest based on your dependency declaration.
- The `cc_test` rule creates a test binary linked against GoogleTest's libraries. The special `gtest_main` library provides a standard `main()` function (see `gmock_main.cc`) that initializes GoogleTest and executes all tests.

<Info>
The `gtest_main` library internally calls `testing::InitGoogleTest()` and runs `RUN_ALL_TESTS()`, streamlining test executable configuration.
</Info>

---

## 5. Tips and Best Practices

- Always specify the C++ standard flag (`--cxxopt=-std=c++17`) to avoid compatibility issues.
- Use Bazelâ€™s incremental build capabilities to speed up test iteration.
- You can add additional source files and libraries in `cc_test` to expand your test coverage.
- For projects that want to build GoogleTest as part of the build instead of via prebuilt binaries, consider `add_subdirectory` usage in CMake-based workflows (see [Installing with CMake](/getting-started/setup-and-installation/installing-with-cmake)).

---

## 6. Next Steps

After successfully installing and running your first test with Bazel, explore these next steps:

- Learn how to write effective test cases in the [Writing and Running Your First Test](/getting-started/configuration-and-first-use/writing-first-test) guide.
- Begin using GoogleMock basics with [Basic Mocking](/getting-started/configuration-and-first-use/using-googlemock-basics).
- Customize your Bazel build to include multiple test targets and complex dependencies.

---

## Troubleshooting Common Issues

<AccordionGroup title="Common Bazel Installation Issues">
<Accordion title="Dependency Fetching Fails">
- Ensure your network connection allows Bazel to access the Bazel Central Registry.
- Verify that the `MODULE.bazel` syntax is exact; indentation and spelling matter.
- Run `bazel clean --expunge` to reset Bazel state and retry.
</Accordion>
<Accordion title="Compiler Does Not Support C++17">
- Confirm your compiler version supports C++17.
- Specify the appropriate C++ standard explicitly using Bazel's `--cxxopt=-std=c++17`.
- Update your compiler or switch to a supported one (GCC, Clang, MSVC).
</Accordion>
<Accordion title="Tests Not Executing or Linking Errors">
- Confirm you linked against `@googletest//:gtest_main` in your `BUILD` file.
- Check that GoogleTest and your test targets use compatible runtime libraries.
- Review Bazel logs for link errors regarding duplicate or missing symbols.
</Accordion>
</AccordionGroup>

---

## References

- [Official Bazel Documentation](https://docs.bazel.build)
- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Using with Bazel Tutorial](docs/quickstart-bazel.md)


---

<style>
pre { background-color: #f6f8fa; padding: 12px; border-radius: 5px; }
</style>
