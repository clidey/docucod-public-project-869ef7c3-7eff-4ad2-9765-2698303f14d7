---
title: "Building from Source"
description: "Instructions for manually building GoogleTest from source code. Use this path if you prefer direct compilation, need custom tweaks, or face restrictions on third-party package managers."
---

# Building from Source

This guide provides detailed instructions for manually building GoogleTest from its source code. This approach is ideal if you prefer direct compilation, require custom tweaks, or face restrictions using third-party package managers.

---

## 1. Prerequisites & System Requirements

Before starting the build process, ensure you have the following:

- **Operating System**: Compatible platforms include Linux, macOS, and Windows.
- **C++ Compiler**: Must support at least C++17 standard.
- **Build Tools**:
  - [CMake](https://cmake.org/) version 3.14 or higher.
  - Native build tools such as `make` (Unix), Visual Studio (Windows), or Xcode (macOS).
- **Permissions**: Sufficient privileges if installing system-wide.

> If CMake is not installed, download it from [https://cmake.org/](https://cmake.org/).

---

## 2. Cloning GoogleTest Source Code

Start by cloning the GoogleTest repository to get the source code.

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
dcd googletest
```

This clones a stable release version (`v1.17.0`) of GoogleTest.

---

## 3. Standalone Build with CMake

You can build GoogleTest as a standalone project using the following steps:

### Step 1: Create and enter a build directory

```bash
mkdir build
cd build
```

This keeps build artifacts separate from source code.

### Step 2: Generate build files with CMake

- To build both GoogleTest and GoogleMock (the mocking framework included by default):

  ```bash
  cmake ..
  ```

- To build GoogleTest **only**, disable GoogleMock explicitly:

  ```bash
  cmake .. -DBUILD_GMOCK=OFF
  ```

### Step 3: Build the libraries

On Unix/Linux/macOS:

```bash
make
```

On Windows:

- Open the generated `gtest.sln` solution file with Visual Studio.
- Build the solution within Visual Studio.

### Step 4: (Optional) Install GoogleTest system-wide

If you have administrator rights and want to install GoogleTest headers and libraries globally:

```bash
sudo make install
```

This installs files under `/usr/local/` by default.

---

## 4. Incorporating GoogleTest into an Existing CMake Project

Instead of standalone, you can build GoogleTest as part of your own CMake project.

### Option 1: Use Installed GoogleTest

If GoogleTest is already installed, import it using `find_package`:

```cmake
find_package(GTest CONFIG REQUIRED)
```

You can then link your targets with `GTest::gtest` or `GTest::gmock`.

### Option 2: Add GoogleTest Source as a Subdirectory

To tightly integrate GoogleTest with your projectâ€™s build and ensure consistent compiler settings across your code and tests:

1. Download or clone GoogleTest source code into a known location in your project tree.
2. Add the following to your `CMakeLists.txt`:

   ```cmake
   add_subdirectory(path/to/googletest)
   ```

3. Link against `gtest` or `gtest_main` targets.

### Option 3: Download GoogleTest via CMake at Configure Time

Use CMake's `FetchContent` module to download GoogleTest automatically during your build configuration:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

# For Windows: use dynamic runtime linkage
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

add_executable(example example.cpp)
target_link_libraries(example gtest_main)
add_test(NAME example_test COMMAND example)
```

This method requires CMake 3.14 or newer.

---

## 5. Important Build Configuration Notes

### C++ Standard

GoogleTest requires C++17 or newer. Ensure your project sets this standard explicitly:

```cmake
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

Alternatively, pass relevant compiler flags when invoking CMake:

```bash
cmake -DCMAKE_CXX_FLAGS="-std=c++17" ..
```


### Visual Studio Runtime Library Compatibility

Visual Studio defaults to linking C runtimes dynamically, but GoogleTest links statically by default. This can cause linker errors:

```
gtest.lib(gtest-all.obj) : error LNK2038: mismatch detected for 'RuntimeLibrary'
```

To resolve this, enable dynamic linking of the runtime library in GoogleTest by setting:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

before adding GoogleTest in your CMake configuration.

---

## 6. Tweaking and Advanced Build Options

GoogleTest allows customization by defining macros during compilation. Common scenarios include:

### Multi-threading Support

GoogleTest is thread-safe where `pthread` is available. To force pthread availability or disable it:

```bash
-DGTEST_HAS_PTHREAD=1
# or
-DGTEST_HAS_PTHREAD=0
```

CMake automatically adds necessary pthread flags when building with its scripts.

### Building as a Shared Library (DLL)

Most users build GoogleTest statically for simplicity, but you can choose to build as a shared library.

To build GoogleTest as a shared library:

```bash
-DGTEST_CREATE_SHARED_LIBRARY=1
```

Add the same flag to your test builds using GoogleTest shared library:

```bash
-DGTEST_LINKED_AS_SHARED_LIBRARY=1
```

Consult your linker documentation for how to create shared libraries if customizing outside CMake.

### Avoiding Macro Name Clashes

In some rare scenarios, GoogleTest macros may clash with other libraries. You can rename conflicting macros by defining compiler flags such as:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

This causes `TEST()` macros to be renamed to `GTEST_TEST()`, so you write:

```cpp
GTEST_TEST(SomeTest, DoesThis) { ... }
```

instead of

```cpp
TEST(SomeTest, DoesThis) { ... }
```

---

## 7. Verifying the Build

After building GoogleTest:

- Confirm libraries (`libgtest.a`, `libgmock.a`, or their equivalents) exist in your `build` directory.
- Run example tests if available.
- Integrate GoogleTest into a small test project and confirm linking and running works.

Example to run tests after building via `make`:

```bash
make
ctest
```

where `ctest` runs the tests configured via CMake.

---

## 8. Troubleshooting Common Build Issues

<AccordionGroup title="Common Build Issues and Solutions">
<Accordion title="CMake Not Found">
Ensure CMake is installed and available in your system path. If missing, install it from https://cmake.org/install.
</Accordion>
<Accordion title="Compiler Does Not Support C++17">
Update your compiler to a compatible version or specify the `-std=c++17` flag explicitly.
</Accordion>
<Accordion title="Runtime Library Mismatch on Windows">
Set `gtest_force_shared_crt` ON in your CMake configuration to ensure runtime libraries are linked consistently.
</Accordion>
<Accordion title="Linker Errors Related to pthread">
Make sure you link with pthread libraries if you enabled threading support manually outside CMake.
</Accordion>
</AccordionGroup>

---

## 9. Next Steps

- Explore [Writing Your First Unit Test](../configuration-and-first-test/writing-your-first-unit-test) to start leveraging GoogleTest.
- Review [Installation via CMake](../setup-and-installation/installation-via-cmake) for alternative installation and integration methods.
- Consult the [GoogleTest Primer](../../primer) for foundational concepts and best practices.

---

### Additional Resources

- GitHub Repository: [https://github.com/google/googletest](https://github.com/google/googletest)
- GoogleTest Documentation Homepage: [https://google.github.io/googletest/](https://google.github.io/googletest/)
- CMake Official Site: [https://cmake.org/](https://cmake.org/)

---

You are now equipped to manually build GoogleTest from source, customize builds as needed, and integrate it into your C++ projects for effective unit testing.