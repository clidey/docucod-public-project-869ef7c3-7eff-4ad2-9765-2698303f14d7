---
title: "Troubleshooting Common Issues"
description: "Diagnose and fix the most frequent setup and build problems. Covers C++ version mismatches, missing dependencies, linking errors, and platform-specific quirks, helping developers progress smoothly through typical first hurdles."
---

# Troubleshooting Common Issues

Welcome to the troubleshooting guide for typical setup and build issues encountered when using GoogleMock (gMock). This page focuses specifically on diagnosing and resolving common errors related to C++ version mismatches, missing dependencies, linking problems, and platform-specific quirks.

By navigating these frequent roadblocks early, you'll ensure a smooth journey as you build and test your C++ codebase with gMock.

---

## 1. Diagnosing C++ Version Mismatches

GoogleMock requires a modern C++ standard (C++17 or later). Encountering compilation errors related to language features often indicates a version mismatch.

### Symptoms
- Errors about unknown keywords, missing standard library features, or template failures.
- Build fails with incomprehensible parsing errors around modern C++ constructs.

### Steps to Fix
1. **Check Your Compiler Version**  
   - Use `g++ --version` or `clang++ --version` to verify the installed compiler supports C++17.
2. **Ensure Build System Sets Correct C++ Standard**  
   - If using CMake, confirm your `CMakeLists.txt` specifies at least `set(CMAKE_CXX_STANDARD 17)`.
3. **Verify Compiler Flags**  
   - Confirm that flags like `-std=c++17` are passed during compilation.

<Check>
Always ensure all compilation units and dependencies use the same or compatible C++ standards to avoid ABI or subtle runtime issues.
</Check>

---

## 2. Resolving Missing Dependencies

GoogleMock depends on GoogleTest. Missing or improperly linked testing libraries can cause build failures.

### Common Missing Dependency Errors
- Linker errors such as `undefined reference to gtest::...` or `gmock::...` symbols.
- Compiler errors indicating missing header files like `gmock/gmock.h` or `gtest/gtest.h`.

### Resolution Steps
1. **Verify GoogleTest and GoogleMock Installation**  
   - Confirm the headers and compiled libraries are present on your system.
2. **Include Paths**  
   - Make sure include paths reference the directories containing `gmock` and `gtest` headers.
3. **Link Against Both Libraries**  
   - For linking, include `-lgmock -lgtest` (or equivalent targets in your build system).
4. **Build Order**  
   - If building from source via CMake, GoogleMock and GoogleTest are built together.

<Tip>
When integrating with build systems like Bazel or CMake, follow their official examples to incorporate GoogleMock and GoogleTest correctly.
</Tip>

---

## 3. Troubleshooting Linking Errors

Linker errors can arise due to incompatible or missing object files and libraries.

### Typical Issues
- Multiple definitions or symbol conflicts.
- Missing virtual tables or undefined vtables.
- Incorrect linkage of static vs. dynamic libraries.

### Fixes
1. **Check for Multiple Definitions**  
   - Avoid including implementation files (`*.cc`) in multiple compilation units.
2. **Ensure Virtual Destructors Are Defined**  
   - Virtual destructors must be defined in the implementation file or via `MOCK_METHOD` generated code.
3. **Match Library Types**  
   - Consistently link either static or shared versions of the libraries.
4. **Separate Compilation**  
   - For large projects, consider moving mock class constructors and destructors to `.cc` files to accelerate builds and avoid multiple definition issues.

<Note>
Linker errors sometimes manifest differently across platforms. Confirm platform-specific quirks described next.
</Note>

---

## 4. Handling Platform-Specific Issues

GoogleMock supports Linux, Windows, and macOS, but each platform may require certain considerations.

### Windows
- Ensure calling conventions match using `Calltype(STDMETHODCALLTYPE)` qualifier in `MOCK_METHOD` when mocking Windows APIs.
- Use the provided main entry (`gmock_main.cc`) to avoid linker conflicts with MSVC.

### Linux/macOS
- Verify `pthread` support is enabled if using multi-threading tests.
- Adjust compiler flags to enable thread-safe behavior if required.

### Embedded Systems
- For platforms like ESP8266, ESP32, or NRF52 with Arduino, use the specialized `setup()` and `loop()` functions as provided in `gmock_main.cc` for running tests.

<Info>
Consult your platform's build environment documentation for best practices when integrating GoogleMock.
</Info>

---

## 5. Practical Tips to Avoid Common Pitfalls

- **Always Set Expectations Before Invoking Mock Methods:** Failing to do so can cause undefined behavior or unhelpful failure messages.
- **Use `NiceMock` to Suppress Noisy Warnings:** Default mocks warn on uninteresting calls; `NiceMock` silences those warnings.
- **Prefer `StrictMock` for Tighter Validation:** It treats unexpected calls as errors, ensuring your test only allows specified interactions.
- **Retire Expectations When Saturated:** Use `.RetiresOnSaturation()` to automatically disable expectations after the set number of calls.

---

## 6. Verifying Your Setup

After fixing issues, validate your setup by compiling and running a minimal example:

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

using ::testing::Return;

class MockExample {
 public:
  MOCK_METHOD(int, GetValue, (), ());
};

TEST(MockTest, VerifyCall) {
  MockExample mock;
  EXPECT_CALL(mock, GetValue())
      .WillOnce(Return(42));

  EXPECT_EQ(mock.GetValue(), 42);
}

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Run the above test to confirm
- It compiles without errors
- Runs tests and reports success

For platform-specific build invocation, check your build system or use `cmake` commands accordingly.

---

## 7. Further Help and Support

If you still encounter issues:

- Review the detailed [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for recipes on common problems.
- Consult the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for in-depth API insights.
- Visit the [GoogleTest Primer](https://google.github.io/googletest/primer.html) for broader context on test writing.
- Seek community support at official GoogleTest forums or issue trackers.

<Note>
Always report issues with precise build logs, platform, and toolchain details to facilitate troubleshooting.
</Note>

---

**Your seamless mocking journey starts by overcoming these common hurdles â€” happy testing!**