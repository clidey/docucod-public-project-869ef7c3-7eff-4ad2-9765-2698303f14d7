---
title: "Writing and Running Your First Test"
description: "Step through the process of adding GoogleTest to your project, writing a simple test, and executing it to see immediate results. This page guides you from zero to a successful test run using clear code examples and references to foundational API headers."
---

# Writing and Running Your First Test

Step through the process of adding GoogleTest to your project, writing a simple test, and executing it to see immediate results. This guide takes you from zero coding to a successful test run using concrete examples and references to essential API headers.

---

## 1. Add GoogleTest to Your Project

Before writing tests, ensure that GoogleTest is integrated into your project build environment. You can link against the `gtest` or `gtest_main` libraries:

- Use `gtest_main` for a pre-built `main()` function to simplify test execution.
- If you require a custom `main()`, link only against `gtest`.

Consult the [Installing GoogleTest](../setup-prerequisites-installation/installing-googletest.md) page for detailed setup instructions tailored to your platform and build system.


<Tip>
If you use CMake and want to save time, link your tests against `gtest_main` to avoid writing a main function manually.
</Tip>

## 2. Include the Core API Header

In your test source file, include the primary GoogleTest header to access all testing macros and utilities:

```cpp
#include <gtest/gtest.h>
```

This header provides all core testing APIs, including macros like `TEST()`, `TEST_F()`, `EXPECT_EQ()`, and `ASSERT_TRUE()`.


## 3. Write a Simple Test Using `TEST()` Macro

The easiest way to write a test is using the `TEST()` macro, which requires two valid C++ identifiers:

- The **test suite name** groups related tests logically.
- The **test name** identifies the individual test within the suite.

Both names must **not** contain underscores and follow your projectâ€™s naming style.

### Example: Testing a Factorial Function

Suppose you have the following function declared in your code:

```cpp
int Factorial(int n);  // Returns the factorial of n
```

You can add tests as follows:

```cpp
// Tests factorial of 0.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Tests factorial of positive numbers.
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

Each `TEST()` defines an independent test case run separately by GoogleTest.


<Note>
Tests within the same test suite (here `FactorialTest`) should be grouped logically and reflect structure or behavior of your code.
</Note>

## 4. Write Tests with Shared Setup Using Test Fixtures (`TEST_F()`)

If multiple tests require common objects or setup steps, you can use **test fixtures**:

1. Derive a class from `testing::Test`.
2. Add member variables and `SetUp()` methods to configure the environment.
3. Use `TEST_F()` instead of `TEST()` to define tests that use the fixture.

### Example: Testing a Queue Class

```cpp
// Test fixture for Queue<int> tests.
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Pre-populate queues with elements.
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  // Queues for testing.
  Queue<int> q0_;  // empty
  Queue<int> q1_;  // one element
  Queue<int> q2_;  // two elements
};

// Tests that a newly constructed queue is empty.
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

// Tests dequeue operation.
TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);  // Abort if null to avoid segfault.
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

Each test runs independently, with a fresh instance of the `QueueTest` fixture.


## 5. Write a `main()` Function (Optional)

Most users link against `gtest_main` which supplies a default `main()`.

If you need custom setup or integration, write your own `main()` and include the following pattern:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);  // Parse GoogleTest flags
  return RUN_ALL_TESTS();                // Run all registered tests
}
```

- `InitGoogleTest()` must be called before `RUN_ALL_TESTS()`.
- `RUN_ALL_TESTS()` returns 0 if all tests pass, or 1 otherwise, which your `main()` should return.


<Warning>
Never ignore the return value of `RUN_ALL_TESTS()`. It determines overall success or failure of your test run.
</Warning>

## 6. Build and Run Your Tests

- Compile your test source files, linking against GoogleTest libraries.
- Run the resulting executable to execute all tests automatically.

Example on Linux using `g++`:

```bash
g++ -std=c++17 -isystem /path/to/googletest/include \
    -pthread your_test.cc /path/to/libgtest.a /path/to/libgtest_main.a -o your_test

./your_test
```

Expected output includes detailed status per test and a summary:

```
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```


## 7. Interpret Test Results

- Tests that pass print `[       OK ]`.
- Failures show detailed messages including file, line number, and reason.
- Non-fatal failures allow tests to continue, while fatal failures abort the current test function.

If a test fails, the output includes the failed assertion and optionally any custom messages.

## 8. Practical Tips and Troubleshooting

- **Naming conventions**: Avoid underscores in test and suite names for best compatibility.
- **Independent tests**: Keep tests independent to avoid flaky tests.
- **Use `EXPECT_*` vs `ASSERT_*`**: Use `EXPECT_*` assertions for non-fatal checks and `ASSERT_*` when continuation makes no sense.
- **Assertions with messages**: Add `<<` streaming to your assertions to provide contextual failure descriptions.
- **Avoid multiple calls to `RUN_ALL_TESTS()`** in a single program.


## 9. Next Steps

After successfully running your first tests:

- Explore [Basic Configuration Options](../first-run-configuration-troubleshooting/basic-configuration-options.md) to customize test behavior.
- Learn how to write [Parameterized and Typed Tests](../guides/writing-effective-tests/parameterized-typed-tests.md).
- Consult the [GoogleTest Primer](../primer.md) for deeper understanding.
- Review [Assertions Reference](../reference/assertions.md) to master expressive assertions.


---

For detailed API documentation and in-depth topics, refer to:

- [Testing Reference](../reference/testing.md)
- [Advanced Topics](../advanced.md)
- [Troubleshooting Common Setup Issues](../first-run-configuration-troubleshooting/troubleshooting-common-setup-issues.md)

---

## Appendix: Minimal Complete Example

```cpp
#include <gtest/gtest.h>

int Factorial(int n) {
  int result = 1;
  for (int i = 2; i <= n; ++i) result *= i;
  return result;
}

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This file can be compiled and run to validate your GoogleTest installation and workflow.



<Check>
Ensure that you link `gtest_main` or provide a correct `main()` to allow test execution.
</Check>

<Check>
If you encounter linker errors, verify paths to headers and static libraries in your build configuration.
</Check>
