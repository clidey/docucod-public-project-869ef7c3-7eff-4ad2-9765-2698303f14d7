---
title: "Installing with CMake"
description: "Learn how to install and integrate GoogleTest into your C++ project using CMake, the most common build system. Walk through acquiring the source, configuring your project, and running an initial build."
---

# Installing with CMake

Learn how to install and integrate GoogleTest into your C++ project using CMake, the most common and flexible build system. This guide walks you step-by-step through acquiring the GoogleTest source, configuring your project, and running your first build with tests.

---

### 1. Prerequisites & System Requirements

- **Operating System:** Linux, macOS, Windows (CMake compatible)
- **Compiler:** C++ compiler with [C++17](https://en.cppreference.com/w/cpp/compiler_support) support (e.g., GCC 7+, Clang 5+, MSVC 2017+)
- **Build Tools:** [CMake](https://cmake.org/) (version 3.14 or later recommended), and a build tool such as [Make](https://www.gnu.org/software/make/), [Ninja](https://ninja-build.org/), or Visual Studio build tools
- **Network:** Internet access to download GoogleTest source if using `FetchContent`

<Tip>
Ensure your build environment uses C++17 or later to avoid incompatibilities while building GoogleTest.
</Tip>

### 2. Obtain GoogleTest Source Code

You can integrate GoogleTest in your project either by:

- Downloading the source manually from the [GitHub repository](https://github.com/google/googletest)
- Using CMake's `FetchContent` module to download it automatically during your project configuration

This guide focuses on the `FetchContent` approach for its ease and up-to-date usage.

### 3. Setting up Your Project with CMake

#### Step 3.1: Create Your Project Directory

Open a terminal and run:

```sh
mkdir my_project && cd my_project
```

#### Step 3.2: Create `CMakeLists.txt`

In the `my_project` directory, create a file named `CMakeLists.txt` with the following contents:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# Require C++17 standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Enable FetchContent to download GoogleTest
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
# For Windows: ensure compatible runtime linking
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

# Enable testing functionality
enable_testing()

# Declare your test executable
add_executable(
  hello_test
  hello_test.cc
)

# Link GoogleTest main library
# Provides main() so you don't have to write one
target_link_libraries(
  hello_test
  GTest::gtest_main
)

# Discover tests automatically
include(GoogleTest)
gtest_discover_tests(hello_test)
```

<Tip>
Replace the URL in `FetchContent_Declare` with the desired GoogleTest commit or release tag to pin your version. This example uses a specific commit hash.
</Tip>

### 4. Create Your First Test File

In the same directory (`my_project`), create a test source file named `hello_test.cc` with this content:

```cpp
#include <gtest/gtest.h>

// A simple test statement
TEST(HelloTest, BasicAssertions) {
  // Check that two strings are not equal
  EXPECT_STRNE("hello", "world");
  // Check that 7 times 6 equals 42
  EXPECT_EQ(7 * 6, 42);
}
```

This sample test demonstrates basic assertions provided by GoogleTest.

### 5. Build and Run Your Tests

#### Step 5.1: Generate Build Files

From the project root:

```sh
cmake -S . -B build
```

_Output sample:_
```
-- The C compiler identification is GNU 10.2.1
-- The CXX compiler identification is GNU 10.2.1
-- Build files have been written to: .../my_project/build
```

#### Step 5.2: Build the Test Executable

Run:

```sh
cmake --build build
```

You should see compilation output and linking steps.

#### Step 5.3: Run the Tests

Finally, run the test suite using CTest:

```sh
cd build && ctest
```

Expected output:
```
Test project .../my_project/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1

Total Test time (real) =   0.01 sec
```

Congratulations, your GoogleTest setup with CMake is complete and working!

### 6. Customizing Your Build

- To **build GoogleTest and GoogleMock from source** along with your project, add `add_subdirectory(googletest)` or `add_subdirectory(googlemock)` in your top-level `CMakeLists.txt` and link to those targets.

- Enable **shared libraries** via `-DBUILD_SHARED_LIBS=ON` if your project prefers dynamic linking.

- If you encounter runtime library mismatches on Windows, confirm the `gtest_force_shared_crt` option is set appropriately.

- To build GoogleTest standalone (not embedded), clone the repository manually, create a build directory inside, and run `cmake .. && cmake --build . && sudo make install` (or equivalent) to install system-wide.

### 7. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting">
<Accordion title="CMake cannot find FetchContent module">
Ensure you are using CMake version 3.14 or later. Older versions do not support `FetchContent`.
</Accordion>

<Accordion title="Linker errors related to pthread on Linux">
Make sure your compiler and linker flags include `-pthread`. The FetchContent approach automatically links threading libraries.
</Accordion>

<Accordion title="Runtime errors on Windows due to conflicting runtime libraries">
Enable `gtest_force_shared_crt` in your CMakeLists.txt:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This aligns runtime linkage with your Visual Studio project.
</Accordion>

<Accordion title="Tests not discovered or not running with ctest">
Confirm you have included:

```cmake
include(GoogleTest)
gtest_discover_tests(<your_test_executable>)
```

and that `enable_testing()` is called before adding tests.
</Accordion>
</AccordionGroup>

---

### 8. Next Steps

- Start writing more tests using the [GoogleTest Primer](../first-test-and-validation/quickstart-primer) to learn the fundamentals of assertions and test structure.
- Explore platform-specific build instructions in the [Platform-Specific Setup](./platform-specific-setup) page.
- For alternative build systems, see [Installing with Bazel](./installing-googletest-bazel).
- Review [Supported Platforms](../../overview/integration-and-ecosystem/supported-platforms) to verify compatibility.

---

### Additional Resources

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [CMake Official Documentation](https://cmake.org/documentation/)
- [GoogleTest Primer](../first-test-and-validation/quickstart-primer)

---

This guide ensures you can confidently integrate GoogleTest in your CMake-based C++ project, build your tests, and run them successfully for robust and maintainable testing.

---