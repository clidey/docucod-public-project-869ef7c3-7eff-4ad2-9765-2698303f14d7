---
title: "Installing with Bazel"
description: "Learn how to add GoogleTest/GoogleMock to your Bazel project, set up WORKSPACE and BUILD files, and configure your tests for Bazel builds."
---

# Installing with Bazel

Learn how to add GoogleTest and GoogleMock to your Bazel project by setting up the `WORKSPACE` and `BUILD` files correctly, enabling you to build and run your tests seamlessly within the Bazel build system.

## 1. Prerequisites & System Requirements
- **Supported Platforms:** Linux, macOS, Windows (see [Supported Platforms](platforms.md))
- **Compiler:** Compatible C++ compiler with C++17 support
- **Bazel Version:** Bazel 7.0 or higher

If Bazel is not installed, follow the [Bazel Installation Guide](https://bazel.build/install) before continuing.

<Note>
This guide assumes basic familiarity with the command line and your preferred shell environment. Commands shown are Unix shell style but work equivalently on Windows command prompt or PowerShell.
</Note>

## 2. Setting Up Your Bazel Workspace

A Bazel workspace is the root directory containing your source files and Bazel configuration. Setting it up correctly is crucial for Bazel to manage dependencies and builds.

### Step 1: Create Your Workspace Directory

Open a terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Create `MODULE.bazel` to Define Dependencies

GoogleTest is consumed via the Bazel Central Registry starting with Bazel 7.0. Create a file named `MODULE.bazel` in your workspace root with this content:

```python
# MODULE.bazel

# Choose the latest version at https://registry.bazel.build/modules/googletest
bazel_dep(name = "googletest", version = "1.17.0")
```

This declares GoogleTest as a dependency and directs Bazel to fetch it automatically.

<Check>
Ensure the version specified here matches the latest stable release to benefit from the latest fixes and features.
</Check>

## 3. Creating Your First Test

With the workspace configured, you can start writing and building your test code.

### Step 1: Add a Test Source File

Create `hello_test.cc` in the root of `my_workspace` with this example code:

```cpp
#include <gtest/gtest.h>

// Demonstrate some basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Strings should not be equal
  EXPECT_EQ(7 * 6, 42);              // 7 times 6 equals 42
}
```

This simple test asserts string inequality and arithmetic equality, demonstrating how GoogleTest assertions work.

### Step 2: Create a `BUILD` File for Bazel

Add a `BUILD` file alongside `hello_test.cc` with the following to declare your test target:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

Here,
- `cc_test` defines a C++ test binary.
- `deps` links the test binary with GoogleTest libraries fetched from the Bazel Central Registry.

<Note>
To ensure compilation with C++17, use `--cxxopt=-std=c++17` (or `--cxxopt=/std:c++17` on MSVC).
</Note>

## 4. Building and Running Your Test

Run the following command within your workspace to build and execute the test:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

### Expected Output Sample

```text
INFO: Analyzed target //:hello_test (26 packages loaded, 362 targets configured).
INFO: Found 1 test target...
INFO: From Testing //:hello_test:
==================== Test output for //:hello_test:
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
================================================================================
Target //:hello_test up-to-date:
  bazel-bin/hello_test
INFO: Elapsed time: 4.190s, Critical Path: 3.05s
INFO: 27 processes: 8 internal, 19 linux-sandbox.
INFO: Build completed successfully, 27 total actions
//:hello_test                                                     PASSED in 0.1s

INFO: Build completed successfully, 27 total actions
```

The key lines to look for:
- `[  PASSED  ] 1 test.` indicates all tests passed.
- `INFO: Build completed successfully` confirms Bazel finished without errors.

## 5. Tips and Best Practices

- **Always use the latest GoogleTest version** available through the Bazel Central Registry for bug fixes and features.
- **Set the C++ standard explicitly** with `--cxxopt` to avoid compatibility issues.
- **Keep your `MODULE.bazel` file at the workspace root** to manage dependencies centrally.
- **Use Bazel's `cc_test` rule** to define your test binaries and specify dependencies clearly.

## 6. Troubleshooting Common Issues

<AccordionGroup title="Common Troubleshooting Scenarios">
<Accordion title="Bazel command not found">
Make sure Bazel is installed and your system PATH is configured correctly. See the [Bazel installation guide](https://bazel.build/install).
</Accordion>
<Accordion title="Compilation errors related to C++ standard">
Ensure you pass the correct compiler flags (`--cxxopt=-std=c++17`) for your compiler. For MSVC, use `--cxxopt=/std:c++17`.
</Accordion>
<Accordion title="Dependency fetch failures">
Verify your `MODULE.bazel` file is present and spelled correctly. Check internet connectivity and proxy/firewall settings.
</Accordion>
<Accordion title="Test does not run or no test output"
>
Confirm that the `BUILD` file defines the test with `cc_test` and the `deps` include both `@googletest//:gtest` and `@googletest//:gtest_main`.
</Accordion>
</AccordionGroup>

## 7. Next Steps

- Explore the [Primer](primer.md) to learn how to write effective assertions and tests.
- Review [Code Samples](samples.md) for practical GoogleTest examples.
- Visit the [Installing with CMake](install-cmake.md) guide if you also use CMake for other projects.
- Check [Common Setup Issues](common-setup-issues.md) for more troubleshooting.

<Info>
Integrating GoogleMock follows a similar setup pattern since it is bundled with GoogleTest in the Bazel Central Registry. Use the same workspace and build file structure to leverage mocking in your tests.
</Info>

---

Happy testing with Bazel and GoogleTest!
