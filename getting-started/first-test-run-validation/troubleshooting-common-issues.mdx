---
title: "Troubleshooting Common Issues"
description: "Encountering errors? Quickly diagnose and resolve the most common installation and runtime issues seen by new users. This page enables you to avoid frustration and keep moving forward with confidence."
---

# Troubleshooting Common Issues

Encountering errors? This guide helps you quickly diagnose and resolve common installation and runtime issues faced when using GoogleMock. Follow these solutions to overcome hurdles and continue testing confidently.

---

## 1. Installation Failures

### 1.1 Compiler Support Issues

GoogleMock requires a C++17 compatible compiler, such as GCC 7+, Clang 5+, or MSVC 2017+. If your build fails due to unsupported language features, check your compiler version:

```bash
gcc --version
clang --version
cl.exe
```

Upgrade to a supported compiler release. Ensure you pass the standard flag `-std=c++17` or equivalent in your build system.

### 1.2 Missing Dependencies

GoogleMock depends on GoogleTest and certain build tools:
- CMake 3.14+ or Bazel for building
- Proper threading support on your platform

If you see missing headers or libraries, verify:
- GoogleTest is included correctly
- Your environment PATH and library paths include necessary tools
- Your build files properly link to GoogleMock and GoogleTest

### 1.3 Linking Errors

Linker errors often happen when GoogleMock or GoogleTest libraries are not linked or not built.

**Fix:**
- Build the GoogleTest and GoogleMock libraries first.
- Link your test executables to `gmock` and `gtest` libraries.

Check your `CMakeLists.txt` or Bazel BUILD file for proper linkage.

### 1.4 Source File Not Found

If you get errors about missing source files (e.g., `gmock.h` or `gmock-spec-builders.h`), verify the include path is correct and the GoogleMock repository is properly cloned.

---

## 2. Runtime Errors

### 2.1 Unexpected Calls

If your test prints "Unexpected mock function call" errors, it means the code called a mocked method in a way that does not match any `EXPECT_CALL` specifications.

**How to Fix:**
- Add or correct your `EXPECT_CALL` statements so that they match the actual calls.
- Use wildcard matchers `_` for arguments you don't care about to avoid over-specifying.
- Verify call order and sequences if order is expected.

### 2.2 Uninteresting Calls and Warnings

Sometimes, calls to mock methods without explicit expectations cause warnings about "Uninteresting mock function call".

**How to Fix:**
- Use `ON_CALL(mock, method(...)).WillByDefault(...)` to specify default behavior without setting expectations.
- Mark the mock as `NiceMock<MockType>` to suppress warnings about uninteresting calls.
- Add `EXPECT_CALL(...).Times(AnyNumber())` if you expect multiple calls but don't want to verify the count.

### 2.3 Life Cycle and Ownership Issues

If you see errors about leaked mocks or unexpected destructor timing:

- Ensure mock objects are properly destructed after usage.
- You can use `Mock::AllowLeak(mock_pointer)` if it is deliberate to keep a mock alive beyond test lifetime.
- Verify no early deletion happens while mocks have unmet expectations.

### 2.4 Failure Messages Are Hard to Understand

To get clearer insights on why a test is failing due to mock expectations:

- Run tests with the flag `--gmock_verbose=info` to get detailed traces of calls and expectation matches.
- Use `--gtest_stack_trace_depth=0` if you want to reduce stack trace verbosity.

### 2.5 Mock Method Declaration Conflicts

If your code has macros that clash with mock method names (e.g., Windows API macros), Google Mock handles this using some workarounds:
- Consider renaming mock methods or undefining conflicting macros.
- Google Mock test `gmock-spec-builders_test.cc` shows handling such cases with macro redefinitions.

---

## 3. Common Pitfalls

### 3.1 Forgetting `EXPECT_CALL` Before Use

`EXPECT_CALL()` must be declared *before* the mock method is called. Declaring it afterward leads to undefined behavior and unmet expectations.

### 3.2 Over-Specifying Matchers

Too specific matchers lead to brittle tests. Use `_` for arguments you don't care about.

### 3.3 Using `Return(...)` with Move-Only Types

Returning move-only types requires care:

- Use a lambda or callable in `WillOnce`/`WillRepeatedly` to create new objects.
- `Return(std::move(...))` can only be used once; subsequent calls will fail.

### 3.4 Setting Multiple `WillByDefault` or `With` Clauses on the Same Mock Method

These clauses can appear only once per `ON_CALL` or `EXPECT_CALL`. Adding more results in failures.

### 3.5 Mixing Nice, Naggy, and Strict Mocks

Understand how `NiceMock`, `NaggyMock`, and `StrictMock` affect uninteresting call treatment to avoid unexpected warnings or test failures.

---

## 4. Troubleshooting Checklist

| Issue                          | Symptom                        | Fixes                                |
|-------------------------------|--------------------------------|------------------------------------|
| Compiler too old               | Compile errors on C++ features | Upgrade to C++17 compatible compiler|
| Missing include files          | Errors: file not found         | Check include paths and clone repo |
| Missing libraries             | Linker errors                  | Build and link gmock/gtest libraries|
| Unexpected calls              | Test failure with call mismatch| Add or correct EXPECT_CALL        |
| Uninteresting call warnings   | Warning messages in output     | Use ON_CALL, NiceMock, or Times(AnyNumber())|
| Test hangs or crashes         | Deadlock or memory errors      | Check mock ownership and sequencing|
| Warning on multiple clause usage| Non-fatal failure             | Use clauses only once per statement|

---

## 5. Getting Additional Help

- Refer to [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html) for common questions and clarifications.
- Explore the [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for deeper recipes and examples.
- Check the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for API details.
- Review the [GoogleMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) for a beginner-friendly walkthrough.

---

## 6. Summary

This troubleshooting guide helps you rapidly identify and fix common GoogleMock installation and runtime issues. Following the advice here reduces test errors and smooths your mocking experience.

If you continue to encounter problems, consider re-examining your mock expectations, verifying your build environment, and enabling verbose logging for insights.

---

## 7. Example: Fixing an Unexpected Call

Suppose your test fails because the mock method was called with unexpected arguments:

```cpp
EXPECT_CALL(mock_obj, DoWork(5));  // Expect arg == 5
mock_obj.DoWork(10);               // Fails
```

**Fix:** Add a catch-all to tolerate other calls:

```cpp
EXPECT_CALL(mock_obj, DoWork(_)).Times(AnyNumber());
EXPECT_CALL(mock_obj, DoWork(5)).Times(1);
```

Now calls with argument 5 are expected once; other calls are accepted without errors.

---

### Source
<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/gmock_faq.md", "range": "1-157"},{"path": "docs/gmock_cook_book.md", "range": "1-521"},{"path": "docs/gmock_for_dummies.md", "range": "1-133"}]}/>
