---
title: "Writing Your First Test Case"
description: "Step-by-step instructions for writing, building, and executing a simple unit test using GoogleTest—learn about test macros, assertions, and interpreting results."
---

# Writing Your First Test Case with GoogleTest

Welcome to the first step in using GoogleTest: writing, building, and running a simple unit test. This guide walks you through the essential concepts—test macros, assertions—and demonstrates how to interpret test results to kickstart your testing journey.

---

## 1. Understanding Test Macros

GoogleTest relies on C++ macros to define and organize tests. The two most common macros you'll use are:

- `TEST(TestSuiteName, TestName)`: Defines a basic test case.
- `TEST_F(TestFixtureName, TestName)`: Defines a test case based on a test fixture (shared setup/teardown).

### The `TEST()` Macro

The `TEST()` macro declares an individual test named `TestName` within the suite `TestSuiteName`. Here is the structure:

```cpp
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}
```

- `FactorialTest` is the test suite grouping related tests.
- `HandlesZeroInput` is the specific test verifying factorial behavior for zero input.

Both names must be valid C++ identifiers without underscores. Tests in different suites can share the same `TestName`.

### The `TEST_F()` Macro and Test Fixtures

Use `TEST_F()` when multiple tests require shared data or setup. This macro uses a test fixture class derived from `testing::Test`. Example:

```cpp
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    q1_.Enqueue(1);
  }

  Queue<int> q1_;
};

TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q1_.size(), 1);
}
```

Here, all tests using `QueueTest` share access to `q1_` initialized in the constructor.

---

## 2. Writing Your First Simple Test

Let's write a straightforward test for a function that calculates factorials:

```cpp
int Factorial(int n) {
  if(n <= 1) return 1;
  return n * Factorial(n - 1);
}

// Tests factorial of 0.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Tests factorial of positive numbers.
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(3), 6);
}
```

Save this in a file named `factorial_test.cc`.

This test uses `EXPECT_EQ` assertions to check if the output matches the expected values.

> Tip: Use `EXPECT_*` for non-fatal assertions that let your tests continue after a failure, and `ASSERT_*` for fatal assertions that abort the current test upon failure.

---

## 3. Building and Running Your Test

To build and run your test:

### Prerequisites

- C++17-compatible compiler (e.g., GCC 7+, Clang 5+, MSVC 2017+)
- GoogleTest source or library (can use submodule, FetchContent, or system install)
- CMake (recommended build tool)

### Example CMakeLists.txt

Create a `CMakeLists.txt` to build your test:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_tests)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.13.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(factorial_test factorial_test.cc)
target_link_libraries(factorial_test gtest_main)

enable_testing()
gtest_discover_tests(factorial_test)
```

### Build and Run

From your project root:

```bash
cmake -S . -B build
cmake --build build
cd build
ctest
```

You should see output indicating the tests passed:

```
Test project .../build
    Start 1: FactorialTest.HandlesZeroInput
1/2 Test #1: FactorialTest.HandlesZeroInput .......   Passed    0.00 sec
    Start 2: FactorialTest.HandlesPositiveInput
2/2 Test #2: FactorialTest.HandlesPositiveInput ..   Passed    0.00 sec

100% tests passed, 0 tests failed out of 2
```

> Note: You can also run the executable directly (`./factorial_test`) to see detailed output.

---

## 4. Interpreting Test Results

When a test passes, GoogleTest prints `PASSED` or `OK`, with test suite and test names.

When a test fails, you see detailed output including:

- File and line number of the failure
- The failed assertion expression
- Expected and actual values
- Custom messages if provided

Example failure:

```
factorial_test.cc:10: Failure
Expected equality of these values:
  Factorial(1)
    Which is: 5
  1
```

This indicates that `Factorial(1)` returned `5`, which does not match expected `1`.

> Best Practice: Start with small, focused tests that verify distinct behavior and use descriptive test and suite names.

---

## 5. Writing a Simple Custom `main()` Function (Optional)

Usually, you link your test with `gtest_main` which provides `main()` automatically. But to customize or if you prefer, implement your own:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This function initializes GoogleTest with command line flags and runs all registered tests.

---

## 6. Tips, Best Practices, and Common Pitfalls

- **Test Isolation:** Each `TEST()` or `TEST_F()` runs independently. Don't rely on test ordering.
- **Use Assertions Properly:** Use `EXPECT_*` for non-fatal checks and `ASSERT_*` if test continuation doesn't make sense after failure.
- **Naming Conventions:** Avoid underscores; follow C++ style guides for naming test suites and test cases.
- **Fixture Setup:** Use fixtures (`TEST_F()`) if multiple tests share setup or resources.
- **Avoid Global State:** Tests should be repeatable and independent.
- **Fail Fast for Critical Assertions:** Use `ASSERT_*` when failure should abort the test to prevent invalid states.

---

## 7. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Your First Test">
<Accordion title="Tests Are Not Being Discovered or Run">
- Ensure your test source file is compiled and linked into the test binary.
- Verify your main() calls `RUN_ALL_TESTS()` and after `InitGoogleTest()`.
- Check that test names follow valid naming conventions without underscores.
- Confirm you linked against `gtest_main` or have your own main function.
</Accordion>
<Accordion title="Compilation Errors Related to GoogleTest Headers">
- Verify your include path includes GoogleTest headers.
- Ensure your compiler supports C++17.
- Confirm you are including `<gtest/gtest.h>` correctly.
</Accordion>
<Accordion title="Test Assertions Always Pass Though Code Is Wrong">
- Ensure assertions are in the test body.
- Use `EXPECT_*` or `ASSERT_*` macros, not plain if-statements.
- Double-check logic in your test code and production code.
</Accordion>
</AccordionGroup>

---

## 8. Next Steps

- Explore writing tests with test fixtures for shared setup.
- Learn to use GoogleMock for mocking dependencies.
- Dive into parameterized tests to test multiple input sets efficiently.
- Review [GoogleTest Primer](https://google.github.io/googletest/primer.html) for deeper learning.
- Check out available samples in the GoogleTest repository under `/googletest/samples`.

---

## References

- [GoogleTest Assertions](../reference/assertions.md)
- [GoogleTest Primer](../docs/primer.md)
- [GoogleTest Samples](../docs/samples.md)
- [Manual Build & Validation](../getting-started/installation-configuration/manual-build-validation.md)
- [Quickstart with CMake](../docs/quickstart-cmake.md)

---

Congratulations—you've successfully written and run your first test using GoogleTest. This foundational step sets the stage for writing reliable, maintainable C++ tests across your projects.


---

**Example: Complete `factorial_test.cc`**

```cpp
#include <gtest/gtest.h>

int Factorial(int n) {
  if (n <= 1) return 1;
  return n * Factorial(n - 1);
}

// Tests factorial of 0.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Tests factorial of positive numbers.
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

Run this test with your build configured as shown above to verify your GoogleTest setup.