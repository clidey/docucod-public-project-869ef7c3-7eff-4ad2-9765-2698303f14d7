---
title: "Installing on macOS"
description: "Detailed instructions to quickly set up GoogleTest and GoogleMock on macOS, covering both CMake and Bazel approaches. Addresses common macOS-specific issues and validation steps post-install."
---

# Installing on macOS

This guide provides detailed instructions to quickly set up GoogleTest and GoogleMock on macOS, covering the two primary build approaches: CMake and Bazel. You will find practical steps for installation, configuration, running tests, and troubleshooting common macOS-specific issues.

---

## 1. Prerequisites & System Requirements

Before starting the installation, ensure your macOS environment meets the following requirements:

- **Operating System:** macOS 10.15 Catalina or later
- **C++ Standard Support:** Compiler with C++17 support (Clang included with Xcode 12+)
- **Build Tools:**
  - **CMake** (version 3.14 or later) for the CMake build approach
  - **Bazel** (latest stable version recommended) for the Bazel build approach
- **Xcode:** Xcode installed with Command Line Tools

<Note>
For best results on macOS, ensure Xcode is selected as the active developer directory:

```bash
sudo xcode-select -s /Applications/Xcode.app/Contents/Developer
```
</Note>

## 2. Installing with CMake

GoogleTest provides a robust, cross-platform CMake build setup that automatically includes GoogleMock.

### Step 1: Clone the Repository

Open Terminal and clone the specific release version:

```bash
git clone https://github.com/google/googletest.git -b v1.17.0
d
cd googletest
```

### Step 2: Create and Enter a Build Directory

Create a separate folder for the build artifacts:

```bash
mkdir build
cd build
```

### Step 3: Generate Build Scripts

Run CMake to configure the build. By default, this will include GoogleMock as well.

```bash
cmake .. -DCMAKE_CXX_STANDARD=17
```

- To build **GoogleTest only** without GoogleMock, add `-DBUILD_GMOCK=OFF`:

```bash
cmake .. -DBUILD_GMOCK=OFF -DCMAKE_CXX_STANDARD=17
```

### Step 4: Build the Library

Compile using `make`:

```bash
make -j$(sysctl -n hw.ncpu)
```

This uses all CPU cores to speed up the build.

### Step 5: Install (Optional)

If you want to install the libraries and headers system-wide (usually requires admin rights):

```bash
sudo make install
```

By default, it installs to `/usr/local/`.

### Step 6: Verify the Installation

Run the test suite to confirm everything built correctly:

```bash
ctest --output-on-failure
```

You should see all tests pass without errors.

<Warning>
If you encounter errors about missing pthread support, make sure to specify `-DGTEST_HAS_PTHREAD=1` in your CMake flags or ensure your compiler environment has pthreads enabled.
</Warning>

---

## 3. Installing with Bazel

Bazel offers a scalable, hermetic build solution with fine-grained dependency management, ideal for larger projects or CI pipelines.

### Step 1: Ensure Bazel is Installed

Download and install Bazel following the official instructions from [bazel.build](https://bazel.build).

### Step 2: Build and Test GoogleTest

Navigate to the `googletest` root directory:

```bash
cd googletest
```

Run Bazel tests with C++17 enabled:

```bash
bazel test ... --cxxopt="-std=c++17"
```

This command builds all targets and runs the test suite.

### Step 3: Handling Bazel Vendor Mode (Optional)

If using Bazel in CI or with vendor dependencies, enable vendor mode to reduce external dependency conflicts by passing appropriate flags:

```bash
bazel test ... --enable_bzlmod=true
```

### Step 4: Verify Results

Test output should show all tests passing. If tests fail, verify compiler settings and C++ standards compatibility.

<Info>
Bazel automatically handles linking and fetching dependencies, reducing manual setup complexity.
</Info>

---

## 4. Addressing Common macOS-Specific Issues

### Issue: Xcode Developer Directory Not Set

Symptom: Build or test failures related to missing compiler or tooling.

Fix:

```bash
sudo xcode-select -s /Applications/Xcode.app/Contents/Developer
```

### Issue: Missing pthreads

Symptom: Linker errors related to pthread symbols.

Fix: Add `-DGTEST_HAS_PTHREAD=1` to your CMake flags or ensure your build environment supports pthread.

### Issue: Insufficient Permissions for Install

Symptom: `make install` fails with permission denied.

Fix: Run with `sudo` or choose an alternative install prefix using `-DCMAKE_INSTALL_PREFIX=PATH` during CMake configuration.

### Issue: Parallel Build Errors

Symptom: Race conditions or partial build failures when running `make -j`.

Fix: Retry with single-threaded build `make` or reduce concurrency with `make -j4`.

---

## 5. Post-Installation Validation

Confirm that both GoogleTest and GoogleMock are correctly installed and working.

### Step 1: Sample CMake Project Test

Create a simple `CMakeLists.txt` in a new directory with the following content:

```cmake
cmake_minimum_required(VERSION 3.14)
project(ExampleTest)

find_package(GTest REQUIRED)

add_executable(example_test example_test.cpp)
target_link_libraries(example_test GTest::gtest_main)

enable_testing()
add_test(NAME example_test COMMAND example_test)
```

Create a minimal test `example_test.cpp`:

```cpp
#include <gtest/gtest.h>

TEST(SampleTest, TrueIsTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char **argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run:

```bash
cmake .
make
ctest --output-on-failure
```

You should see the sample test passing successfully.

### Step 2: Validate Bazel Workspace

Similarly, write a simple test target in a Bazel workspace and run:

```bash
bazel test //:example_test
```

Confirm that the test completes successfully with no errors.

---

## 6. Best Practices & Tips

- Always specify `-DCMAKE_CXX_STANDARD=17` during CMake configuration to ensure compatibility.
- Use separate build directories to keep source trees clean.
- For continuous integration, consider using Bazel for its hermetic builds and caching.
- Monitor and match compiler versions between your project and GoogleTest builds to avoid ABI issues.

<Check>
Keep your GoogleTest version updated regularly to receive the latest fixes and improvements, especially on macOS where tooling evolves.
</Check>

## 7. Troubleshooting

### Build Fails with C++ Standard Errors

Ensure your compiler supports C++17. Run `clang++ --version` and update Xcode or Command Line Tools if needed.

### Tests Not Found or Not Running

Verify you linked against `gtest_main` and called `::testing::InitGoogleTest()` in your test binary.

### Linker Errors Related to `pthread`

Pass `-DGTEST_HAS_PTHREAD=1` or use the provided CMake script which handles this automatically.

### Bazel Test Runs Fail Due to Environment Issues

Check Bazel version compatibility with GoogleTest version, and ensure `--cxxopt="-std=c++17"` is supplied.

### Permission Denied Errors

Run install steps with `sudo` or change install prefix to a user-writable directory.

---

For advanced customization, building shared libraries, or integrating GoogleTest into existing projects, refer to [GoogleTest README](https://github.com/google/googletest/blob/main/README.md) and the related [CMake build instructions](https://github.com/google/googletest/blob/main/googletest/README.md).

---