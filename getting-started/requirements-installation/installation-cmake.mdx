---
title: "Installation with CMake"
description: "Step through the standard process for installing and building GoogleTest using CMake, the recommended and most widely supported build system. Covers cloning the repository, configuring the project, and building libraries for integration into your own projects."
---

# Installation with CMake

Step through the standard process for installing and building GoogleTest using CMake, the recommended and most widely supported build system. This guide walks you through cloning the repository, configuring the project, and building the libraries so you can integrate GoogleTest into your own projects.

---

## 1. Prerequisites & System Requirements
Before you begin, ensure your environment meets the following requirements:

- **Operating System:** Linux, macOS, Windows, or other supported platforms.
- **Compiler:** A C++ compiler that supports **C++17** or later.
- **CMake Version:** At least **3.16** (required by GoogleTest’s CMakeLists). Preferably newer (3.14+ if you plan to use FetchContent).
- **Build Tool:** Compatible with CMake generators such as Make, Ninja, Visual Studio, or Xcode.
- **Network Access:** Required to clone the repository.

For more details on supported platforms and compilers, see the [System Requirements](../requirements-installation/system-requirements) page.

---

## 2. Cloning and Preparing GoogleTest

GoogleTest is hosted on GitHub. Start by cloning the repository and preparing a build directory.

```bash
# Clone the GoogleTest repository (use the latest stable tag or main branch)
git clone https://github.com/google/googletest.git
cd googletest

# Create a separate directory to hold all build files
mkdir build
cd build
```

> **Tip:** Using a dedicated `build` directory avoids clutter and isolates build artifacts cleanly.

---

## 3. Configuring the Build with CMake

CMake is used to configure the build system and handle platform-specific setup. Run the following command inside the `build` directory:

```bash
cmake ..
```

This command generates build files based on your platform and default settings, including building GoogleMock (the mock framework bundled with GoogleTest).

### Building Only GoogleTest
If your project only requires GoogleTest (excluding GoogleMock), disable it by explicitly passing:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

### Important Options
- `BUILD_GMOCK` (default `ON`): Include/exclude GoogleMock.
- `INSTALL_GTEST` (default `ON`): Controls whether `make install` or equivalent installs GoogleTest on your system.
- `GTEST_HAS_ABSL` (default `OFF`): Use Abseil and RE2 libraries if available.

### Windows Considerations
If using Visual Studio, this will produce a solution file (`.sln`) and project files. You can open the solution in Visual Studio and build from there.

---

## 4. Building the Libraries

After successful configuration, build GoogleTest using your chosen build tool:

```bash
make
# Or, if you chose Ninja
ninja
```

On Windows with Visual Studio, compile the solution from the IDE or with ```msbuild```. 

Expected output includes compiling test binaries and libraries such as `gtest` and `gmock` (if enabled).

<Tip>
Use parallel build options (e.g., `make -jN`, where N is number of cores) to speed up compilation.
</Tip>

---

## 5. Installing GoogleTest

If you want to install GoogleTest system-wide (usually requires admin privileges), run:

```bash
sudo make install
```

> This installs headers and libraries to default system locations such as `/usr/local/include` and `/usr/local/lib`. You can customize install locations with CMake options:

```bash
cmake .. -DCMAKE_INSTALL_PREFIX=/custom/path
``` 

> Then run `make install`. Use this to install under user-specific directories or into sysroots for cross-compilation.

Note: Installation also configures pkg-config files that simplify integration in other build systems.

---

## 6. Integrating GoogleTest into Your Project

Once installed or built, you can link to GoogleTest libraries in your own CMake projects. 

### Example: Adding GoogleTest as a Subdirectory

If you want to build GoogleTest alongside your project (recommended for consistent compiler/linker settings), add the source as a git submodule or download and then add:

```cmake
add_subdirectory(path/to/googletest)

add_executable(my_test my_test.cc)
target_link_libraries(my_test GTest::gtest_main)

enable_testing()
gtest_discover_tests(my_test)
```

### Example: Using Installed GoogleTest

If GoogleTest is installed and discoverable, you can find and link it using:

```cmake
find_package(GTest REQUIRED)

add_executable(my_test my_test.cc)
target_link_libraries(my_test GTest::gtest_main)

enable_testing()
gtest_discover_tests(my_test)
```

Refer to the [Project Configuration](../configuration-bootstrap/project-setup) page for best practices.

---

## 7. Running Your First Test

Build your project (including the test target) and then launch tests via CTest or your build tool:

```bash
cmake --build build
cd build
ctest
```

If successful, CTest will run your test binary and report the results.

---

## 8. Troubleshooting Common Issues

### `cmake` Fails to Find Required Packages

- If CMake cannot find `GTest` or `gtest_main` when using `find_package`, ensure you have installed GoogleTest properly and that your `CMAKE_PREFIX_PATH` or `PKG_CONFIG_PATH` includes the installation directory.

- To help pkg-config find GoogleTest, export its path, e.g.: 

```bash
export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig
```

### Compiler Errors on Windows Regarding CRT

If you see runtime library conflicts (e.g., `MTd` vs `MDd`), enable:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```

This makes GoogleTest use the dynamic C runtime library to match typical Visual Studio projects.

### Pthread Link Errors

If your linker complains about missing pthread libraries, confirm your platform's pthread support. GoogleTest’s CMake scripts add necessary flags automatically if supported.

### Build Failures with Older CMake or Compiler Versions

Ensure at least CMake 3.16 and compiler supporting C++17 to avoid build failures.

---

## 9. Further Reading & Next Steps

- Explore [Writing and Running Your First Test](../configuration-bootstrap/first-test-case) to learn how to write GoogleTest tests.
- See [Project Configuration](../configuration-bootstrap/project-setup) for managing dependencies and test integration.
- Visit [pkg-config Usage](../../docs/pkgconfig.md) for advanced integration with other build tools.
- Review [System Requirements](../requirements-installation/system-requirements) to confirm environment compatibility.


---

Congratulations! You have now installed GoogleTest using CMake and are ready to write and run your first tests.


---

<AccordionGroup title="Summary of Key Commands">
<Accordion title="Clone and Prepare">
```bash
git clone https://github.com/google/googletest.git
cd googletest
mkdir build
cd build
```
</Accordion>
<Accordion title="Configure Build">
```bash
cmake ..
# To build only GoogleTest
cmake .. -DBUILD_GMOCK=OFF
```
</Accordion>
<Accordion title="Build and Test">
```bash
make
# or ninja
cmake --build .

ctest
```
</Accordion>
<Accordion title="Install">
```bash
sudo make install
# with custom prefix
cmake .. -DCMAKE_INSTALL_PREFIX=/custom/path
make install
```
</Accordion>
</AccordionGroup>