---
title: "Troubleshooting Installation and Configuration"
description: "Resolve the most frequent setup problems: build errors, linkage issues, incompatible compiler flags, or missing headers. Includes links to FAQ, community docs, and pointers to configuration files for a smooth start."
---

# Troubleshooting Installation and Configuration

This guide helps you resolve common problems encountered while installing and configuring GoogleTest and GoogleMock (gMock). It addresses issues related to build errors, linker troubles, compiler incompatibilities, and missing files. For a smooth start, this page also points you to key configuration files, FAQs, and community resources.

---

## 1. Common Setup Problems and Solutions

### 1.1 Build Errors

- **Problem:** Compilation fails due to missing headers such as `<gmock/gmock.h>` or `<gtest/gtest.h>`.
  
  **Solution:**
  - Confirm that your include paths correctly reference the downloaded GoogleTest source.
  - Follow the [Installation Instructions](/getting-started/prerequisites-installation/installation-methods) to properly fetch and build the source with CMake or Bazel.

- **Problem:** Error related to unsupported or incompatible compiler flags.

  **Solution:**
  - Verify your compiler version meets the minimum requirements for GoogleTest (C++11 or above).
  - Check that your project enforces at least C++17 standard as GoogleTest expects that.
  - Adjust your compiler flags per guidance in [Project Setup Guide](/getting-started/configuration-first-test/project-setup).

### 1.2 Linkage Issues

- **Problem:** Linker errors such as `undefined reference` to GoogleTest or GoogleMock symbols.

  **Solution:**
  - Make sure you link against the GoogleTest and GoogleMock libraries correctly.
  - The recommended approach is to build GoogleTest as a separate target and link your tests explicitly.
  - Check your CMakeLists.txt or build configuration follows the [Integration Workflows](/overview/arch-diagram-integration/integration-and-workflows) guide.

### 1.3 Incompatible Compiler Flags

- MSVC-specific warnings (e.g., C4301 or C4373) when mocking methods with `const` parameters.

  **Root Cause:** MSVC treats top-level const parameters as equivalent to non-const leading to warnings.

  **Recommended Fix:** Remove the top-level `const` qualifier from method signatures in both the base and mock classes as it has no effect and mitigates the warning.

### 1.4 Missing or Misconfigured Headers

- Ensure all `MOCK_METHOD` declarations are in the `public:` section of mock classes, even if mocking protected or private methods.

- Commas in argument or return types (e.g., `std::pair<bool, int>`) need to be wrapped in parentheses or aliased to avoid macro parsing errors.

---

## 2. Understanding Mock Object Strictness

GoogleMock provides modifiers to control how uninteresting (non-expected) calls are handled:

| Modifier        | Effect                                                                                      |
|-----------------|---------------------------------------------------------------------------------------------|
| `NiceMock<T>`   | Suppresses warnings on uninteresting calls, making your tests less verbose.                 |
| `NaggyMock<T>`  | Prints warnings on uninteresting calls (default behavior).                                 |
| `StrictMock<T>` | Treats all uninteresting calls as test failures, helping catch unexpected calls early.     |

### How to Use

Wrap your mock class:

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> nice_mock;  // Suppresses uninteresting call warnings

using ::testing::StrictMock;
StrictMock<MockFoo> strict_mock;  // Fails on uninteresting calls
```

### Best Practices

- Use `NiceMock` during most development for cleaner test output.
- Use `StrictMock` sparingly to enforce rigid call expectations.
- Avoid nesting modifiers (e.g., `NiceMock<StrictMock<MockFoo>>`) as unsupported.

---

## 3. Tips for Writing Mocks and Expectations

- **Defining Mock Methods:** Use `MOCK_METHOD(return_type, method_name, (args), (qualifiers))` directly in `public:`.
- **Handling Overloads:** Mock all overloads or use `using Base::method_name;` to prevent hiding.
- **Setting Expectations:** Use `EXPECT_CALL()` before exercising mock, specifying matchers, call counts, and actions.
- **Default Actions:** Use `ON_CALL()` to provide default behavior without requiring matching call count.

Example:

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, Bar, (int x), (override));
};

MockFoo mock;
ON_CALL(mock, Bar(_)).WillByDefault(Return(0));
EXPECT_CALL(mock, Bar(5)).WillOnce(Return(10));

int result = mock.Bar(5);  // Returns 10
int default_result = mock.Bar(3);  // Returns 0 (default action)
```

---

## 4. Where to Look for More Help

- **Official FAQ:** Resolve common questions and corner cases at [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html).
- **Mocking Reference:** Deep dive into mocking constructs at [Mocking Reference](/docs/reference/mocking).
- **Cookbook:** Recipes for common mocking patterns and techniques at [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html).
- **Community Docs:** Browse community discussions and additional troubleshooting tips via the GitHub repository.

---

## 5. Configuration Files and Flags

- GoogleTest behavior can be influenced by command line flags:
  - `--gmock_verbose=info|warning|error`: Controls mock framework logging verbosity.
  - `--gmock_catch_leaked_mocks=0|1`: Enables/disables leak detection for mocks.

- Use `Mock::AllowLeak(&mock_obj)` if you deliberately want to suppress leak detection for a mock.

---

## 6. Additional Troubleshooting

### When Unexpected Calls Occur

- Run tests with `--gmock_verbose=info` to trace mock calls and understand which expectations matched or failed.
- Use `.Times(0)` to explicitly forbid a method call.
- Use wildcard matcher `_` in `EXPECT_CALL` to capture unexpected calls you want to allow.

### Compiler and Platform Notes

- C++17 or later is required for full GoogleTest functionality.
- When mocking classes with non-default constructors, GoogleMock's strictness modifiers (`NiceMock`, etc.) inherit those constructors but verify your usage.

---

For detailed examples and workflows, see the following pages:

- [Installation and Project Setup](/getting-started/prerequisites-installation/installation-methods)
- [Configuring Your Project](/getting-started/configuration-first-test/project-setup)
- [Writing and Running Your First Test](/getting-started/configuration-first-test/first-successful-run)

---

<Tip>
Always define mock destructors as virtual to avoid undefined behaviors especially during object teardown.
</Tip>

<Tip>
When using complex argument types in mocks, consider using aliases or parentheses around types containing commas to prevent macro parsing errors.
</Tip>

<Tip>
If your tests output warnings about unexpected calls to mocks, refactor to use `NiceMock` or explicitly set expectations with `.Times(AnyNumber())` to clarify intent.
</Tip>

<Note>
Avoid over-specifying expectations that create brittle tests. Use `ON_CALL` for default behavior and `EXPECT_CALL` only to verify important interactions.
</Note>