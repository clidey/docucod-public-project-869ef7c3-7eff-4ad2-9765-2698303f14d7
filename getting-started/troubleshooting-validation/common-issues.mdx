---
title: "Troubleshooting Common Issues"
description: "Address frequent installation and configuration pitfalls, such as build errors, linker problems, or environment misconfiguration, with actionable solutions."
---

# Troubleshooting Common Issues

This guide addresses frequent installation and configuration challenges encountered when setting up GoogleTest and GoogleMock. It provides clear, actionable steps to resolve build errors, linker problems, environment misconfigurations, and common pitfalls, enabling you to confidently validate and stabilize your development environment.

---

## 1. Build Errors

### 1.1 C++ Compiler and Standard Compatibility

- **Issue**: Compiler rejects code with errors related to C++17 features or GoogleTest constructs.
- **Action**:
  1. Verify your compiler supports **C++17** or a later standard.
  2. Add the following flag to your build command:
     ```bash
     -std=c++17
     ```
  3. Ensure your compiler version is supported (GCC 7+, Clang 5+, MSVC 2017+).

<Tip>
Using outdated compilers is the most common cause of build failures. Check your compiler version with `gcc --version`, `clang --version`, or Visual Studio version.
</Tip>

### 1.2 Missing Include Paths

- **Issue**: Errors like `fatal error: 'gtest/gtest.h' file not found` or similar.
- **Action**:
  1. Confirm that the path to GoogleTest headers is added to your compilerâ€™s include directories.
  2. For CMake projects, add:
     ```cmake
     target_include_directories(your_target PRIVATE /path/to/googletest/include)
     ```
  3. For Bazel, ensure correct dependencies in your BUILD files.

<Check>
Without proper include paths, your build cannot find GoogleTest headers, causing compilation to fail.
</Check>

## 2. Linker Errors

### 2.1 Undefined References to GoogleTest or GoogleMock Symbols

- **Issue**: Linker errors referencing symbols like `testing::InitGoogleTest` or mock class methods.
- **Action**:
  1. Verify you are linking against the correct GoogleTest and GoogleMock libraries.
  2. With CMake, link libraries like:
     ```cmake
     target_link_libraries(your_target PRIVATE gtest gmock)
     ```
  3. If using `-lgtest` or `-lgmock`, ensure the libraries are built and installed.
  4. When using `gtest_main` or `gmock_main`, link accordingly to include the default `main()`.

<Tip>
A common pitfall is failing to link `gmock` library when mock features are used.
</Tip>

### 2.2 Namespace Conflicts or Multiple Definitions

- **Issue**: Errors about duplicate symbols or conflicts.
- **Action**:
  1. Ensure you are not linking both the static and shared versions of GoogleTest simultaneously.
  2. Remove duplicate library references.
  3. Check for mixing different versions of GoogleTest in your project or dependencies.

<Warning>
Mixing incompatible versions or mixing static and dynamic libraries may cause these errors.
</Warning>

## 3. Environment & Configuration Issues

### 3.1 Incorrect Initialization of GoogleTest

- **Issue**: Tests do not run or behave unexpectedly.
- **Action**:
  1. Always call `::testing::InitGoogleTest(&argc, argv);` before running tests.
  2. In the main function, use:
     ```cpp
     int main(int argc, char **argv) {
       ::testing::InitGoogleTest(&argc, argv);
       return RUN_ALL_TESTS();
     }
     ```

<Check>
Not initializing GoogleTest properly leads to missing tests or ignored command line flags.
</Check>

### 3.2 Fatal Assertions in Non-void Functions

- **Issue**: Compilation errors when using `ASSERT_*` or `FAIL()` in functions returning non-void.
- **Action**:
  1. Use `EXPECT_*` assertions in non-void functions to avoid compilation errors.
  2. Alternatively, refactor code so fatal assertions only appear in `void` returning methods.

### 3.3 Mismatched Macro Usage: TEST vs TEST_F

- **Issue**: Compiler errors when mixing test fixture classes.
- **Action**:
  1. Use `TEST` macros for simple tests.
  2. Use `TEST_F` macros when using test fixtures (classes derived from `::testing::Test`).
  3. Make sure the test fixture class is defined before using it in `TEST_F`.

<Tip>
Use `TEST_F` only if your test needs a fixture; otherwise, `TEST` suffices.
</Tip>

## 4. Mocking Issues

### 4.1 Mock Method Not Called or Expectations Not Met

- **Issue**: Tests fail with messages indicating unmet expectations or unexpected calls.
- **Action**:
  1. Confirm that all `EXPECT_CALL` statements are set before exercising mock calls.
  2. Verify that the argument matchers in `EXPECT_CALL` correctly match the call arguments.
  3. Use the `--gmock_verbose=info` flag to get detailed tracing of mock calls and expectations.
  4. If ignoring uninteresting calls, consider using `NiceMock` to suppress warnings.

### 4.2 Warning: Uninteresting Mock Function Calls

- **Issue**: Warnings about uninteresting calls even when you have `ON_CALL` default actions.
- **Action**:
  1. Understand that `ON_CALL` specifies default behaviors but does not set expectations.
  2. Add an `EXPECT_CALL(mock, Method(_)).Times(AnyNumber())` if calls without explicit expectations are allowed.
  3. Alternatively, use `NiceMock<MockClass>` to suppress such warnings.

<Note>
Ignoring uninteresting calls can mask bugs; use with care.
</Note>

### 4.3 Mocking Non-Virtual Methods

- **Issue**: Mocking non-virtual methods leads to unexpected behavior or compile errors.
- **Action**:
  1. Use interface-based design to make methods virtual.
  2. Alternatively, use template-based dependency injection for non-virtual methods (see gMock Cookbook).

### 4.4 Mocking Overloaded Methods

- **Issue**: Compiler errors or incorrect matching with overloaded methods.
- **Action**:
  1. Use explicit type matchers or `using` declarations to bring base class methods into scope.
  2. For disambiguating const and non-const overloads, use `Const()` wrapper.

### 4.5 Issues with Move-Only Types in Mocks

- **Issue**: Mocking methods with `std::unique_ptr` or other move-only types causes errors.
- **Action**:
  1. Use lambdas in `WillOnce()` or `WillRepeatedly()` to return freshly constructed objects.
  2. Avoid returning move-only objects multiple times with `Return(std::move(...))`.

<Tip>
Refer to the gMock Cookbook section on mocking methods with move-only types for patterns and best practices.
</Tip>

## 5. Test Execution and Runtime Issues

### 5.1 Tests Not Running or Being Skipped

- **Issue**: Tests do not execute or are silently skipped.
- **Action**:
  1. Verify your test registration - tests must be linked into the binary.
  2. Check if test names or test suite names start with `DISABLED_`.
  3. Ensure no typos in test macro arguments.
  4. Confirm `RUN_ALL_TESTS()` is called in your `main()`.

### 5.2 Death Tests Fail or Hang

- **Issue**: Death tests do not behave as expected or cause hangs.
- **Action**:
  1. Use recommended naming conventions: test suites with death tests are named `*DeathTest`.
  2. Use the appropriate death test style (`fast` vs `threadsafe`), settable via `GTEST_FLAG_SET(death_test_style, "threadsafe")`.
  3. Avoid spawning threads before running death tests.

### 5.3 Assertion Failures Difficult to Diagnose

- **Issue**: Failure messages lack context or are hard to trace.
- **Action**:
  1. Use the `SCOPED_TRACE` macro to add context traces.
  2. Run tests with `--gmock_verbose=info` and `--gtest_stack_trace_depth` to see detailed call and expectation trace.

<Info>
Using parameterized or typed tests could improve test clarity and reuse, reducing likelihood of confusing failures.
</Info>

## 6. Common Pitfalls and Best Practices

### 6.1 Setting Expectations After Calls

- **Issue**: Undefined behavior or unexpected failures.
- **Action**:
  Always set `EXPECT_CALL` expectations before calling the mock methods.

### 6.2 Over-Specifying Expectations

- **Issue**: Tests are brittle; break due to minor implementation changes.
- **Action**:
  1. Use `ON_CALL` to specify default mock behavior.
  2. Use `EXPECT_CALL` sparingly, only to verify critical interactions.
  3. Use `NiceMock` to suppress unnecessary warnings.

### 6.3 Mixing Mock Strictness

- **Issue**: Unexpected warnings or failures from uninteresting calls.
- **Action**:
  Choose between `NiceMock`, `NaggyMock`, and `StrictMock` according to your test needs.
  - Use `NiceMock` to suppress uninteresting call warnings.
  - Use `StrictMock` to fail on unexpected calls.
  - Default mocks behave as `NaggyMock`.

### 6.4 Memory Leaks with Mock Objects

- **Issue**: Heap check failures when mocks are not deleted.
- **Action**:
  1. Use scoped mocks or ensure manual deletion of mocks.
  2. Use `Mock::AllowLeak()` cautiously when leaks are intentional (e.g., in death tests).

## 7. Additional Tools & Debugging Tips

### 7.1 Using Verbose Flags

- Run tests with:
  ```
  --gmock_verbose=info
  ```
  to see detailed mock call traces and expectation matches.

### 7.2 Enabling Color Output

- Use:
  ```
  --gtest_color=yes
  ```
  for clearer visual differentiation between test results.

### 7.3 Inspecting Current Test Name

- Use the GoogleTest API:
  ```cpp
  const testing::TestInfo* info =
      testing::UnitTest::GetInstance()->current_test_info();
  std::cout << "Currently running: " << info->test_suite_name()
            << "." << info->name() << std::endl;
  ```

### 7.4 Using Event Listeners for Custom Output

- Implement custom `TestEventListener`s to augment test output,
  useful for CI integration or specialized logging.

---

## 8. Where to Get Help

- Consult the following documentation pages for detailed guidance:
  - [GoogleTest Primer](primer.md)
  - [gMock for Dummies](gmock_for_dummies.md)
  - [Mocking Reference](reference/mocking.md)
  - [Assertions Reference](reference/assertions.md)
  - [gMock Cookbook](gmock_cook_book.md)
  - [Legacy gMock FAQ](gmock_faq.md)

- Use the GoogleTest and GoogleMock issue trackers and community forums for reporting bugs and seeking support.

---