---
title: "Writing and Running Your First Test"
description: "Walks the user through crafting a minimal test with GoogleTest, building it, and interpreting the results. Provides sample code and guidance on using the test main function, as well as running the test binary with expected outputs."
---

# Writing and Running Your First Test

This guide takes you step-by-step through creating your first minimal test using GoogleTest, compiling it, and executing it to validate your setup. You'll see how to write a simple test, understand the test entry point, run the test binary, and interpret the output.

---

## 1. Prerequisites

Before writing your first test, ensure:

- Your development environment supports C++17 or later.
- GoogleTest is properly installed and configured in your build system.
- You have a C++ compiler installed and accessible.
- Your project is set up to link against the `gtest` or `gtest_main` libraries.

<Tip>
If you want to avoid writing your own `main()` function for tests, link against `gtest_main` or `gmock_main` instead. They provide a ready-to-use test runner entry point.
</Tip>

---

## 2. Writing a Minimal Test

Start with a simple test that checks a basic operation or function. Below is an example of a minimal GoogleTest test:

```cpp
#include <gtest/gtest.h>

// A sample function to test
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Defines a test case named FactorialTest and a test named HandlesZeroInput
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}
```

### Key Points:

- `TEST(TestSuiteName, TestName)` defines a test.
- Inside the test, assertions like `EXPECT_EQ` check expected vs. actual results.
- Test and suite names should be valid C++ identifiers without underscores.

---

## 3. Writing the main() Function (If Needed)

If you do not link with the provided `gtest_main` or `gmock_main` libraries, you must provide the test runner entry point `main()`. Here is a boilerplate main function:

```cpp
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  // Initialize GoogleTest, parsing command-line flags and arguments
  testing::InitGoogleTest(&argc, argv);

  // Runs all tests and returns 0 if they all succeed
  return RUN_ALL_TESTS();
}
```

### Important:

- Always return the result of `RUN_ALL_TESTS()` so that the process exit code correctly reflects test success or failure.
- `InitGoogleTest()` initializes the framework and must be called before running tests.


---

## 4. Building the Test Program

### Example using CMake

Ensure your `CMakeLists.txt` includes GoogleTest, and set up a target for your test:

```cmake
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})

add_executable(my_test test_file.cc)
target_link_libraries(my_test ${GTEST_LIBRARIES} pthread)  # pthread often required on Linux
```

Build your test binary using your usual build commands (`cmake --build`, `make`, etc.).

### Command Line Compilation Example

If compiling manually, for example on Linux:

```bash
# Compile
clang++ -std=c++17 -isystem /usr/include/gtest -pthread \
    test_file.cc -lgtest -lgtest_main -o my_test
```

Adjust paths and compiler flags according to your environment.

<Tip>
Always link with `-lgtest_main` if you want to use GoogleTest's default `main()` function and avoid writing your own.
</Tip>

---

## 5. Running Your Test

Run your test binary from the terminal:

```bash
./my_test
```

### Expected Output:

```
Running main() from <source_file>
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[----------] 1 test from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

### Understanding the Output:

- The `Running main() from ...` line identifies which main implementation is used. If you see your file name here, your own main() is in use.
- Each test being run is listed with the suite and test name.
- `PASSED` indicates all assertions succeeded.
- On failure, GoogleTest reports the failing assertion, file, and line number.

<Tip>
If you get no output or errors about missing `main()`, verify whether you linked to `gtest_main`. If not, implement your own `main()` as shown.
</Tip>

---

## 6. Tips for Success and Common Pitfalls

- Avoid underscores in test and suite names; it might cause issues with test discovery.
- Always return the value of `RUN_ALL_TESTS()` from your `main()`.
- If your tests are not discovered, ensure `InitGoogleTest()` is called before running them.
- Use `EXPECT_` assertions for non-fatal checks and to continue test execution after failures.
- Use `ASSERT_` assertions when failure should abort the current test immediately.

---

## 7. Next Steps

Now that you've written and run your first test, consider:

- Writing tests that use **test fixtures** (`TEST_F`) to share setup code.
- Exploring GoogleMock to add mocking capabilities for dependencies.
- Learning about `EXPECT_CALL` and mock behaviors.
- Running tests with advanced GoogleTest command-line flags.


---

For complete details about writing tests, check the [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md).


## References

- [GoogleTest Primer](https://github.com/google/googletest/blob/main/docs/primer.md)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md)

---

## Appendix: Example of a Full Minimal File

```cpp
#include <gtest/gtest.h>

int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run this file to confirm your setup is working.

---