---
title: "Configuring GoogleTest in Your Project"
description: "Explains how to add GoogleTest to an existing C++ project, including directory structure, include paths, and linking recommendations. Covers integrating with both GoogleTest and GoogleMock components as needed."
---

# Configuring GoogleTest in Your Project

This guide walks you through adding GoogleTest to an existing C++ project, covering directory setup, include paths, linking strategies, and integrating both GoogleTest and GoogleMock components. By following these steps, you will be able to compile and run tests using GoogleTest seamlessly within your project.

---

## 1. Prerequisites & System Setup

Before integrating GoogleTest, ensure your environment meets the following:

- **Compiler Support:** A C++17-compliant compiler is required.
- **Build System:** Familiarity with your build system (e.g., CMake, Bazel, Makefiles).
- **GoogleTest Source or Binary:** Obtain GoogleTest either as source code or via a package manager.

<Check>
Ensure you've followed the [System Requirements](../getting-started/prerequisites-installation/system-requirements) to verify your environment compatibility.
</Check>

---

## 2. Directory Structure and Source Placement

Integrate GoogleTest within your project directory layout according to your build workflow. Typical setups include:

- **Vendor or Third-Party Subdirectory:** Add GoogleTest as a git submodule or copy inside a `third_party/googletest` folder.
- **External Dependency Folder:** Use your system's or project's external dependencies directory.

This approach isolates test dependencies from production code.

<Info>
Organizing dependencies distinctly helps maintain clean separation and easy updates.
</Info>

---

## 3. Include Paths Configuration

Ensure your build system includes the GoogleTest headers when compiling test files.

### Steps:

1. Add the path to GoogleTest's `include` directory to your compiler flags. For example:

```bash
-I/path/to/googletest/include

# If using GoogleMock too:
-I/path/to/googlemock/include
```

2. When using CMake, you may link directly to targets with:

```cmake
find_package(GTest REQUIRED)
target_include_directories(your_test_target PRIVATE ${GTEST_INCLUDE_DIRS})
```

or if using bundled sources:

```cmake
add_subdirectory(third_party/googletest)
target_link_libraries(your_test_target gtest gtest_main)
```

<Warning>
Missing include paths will result in compiler errors related to missing `gtest/gtest.h` or `gmock/gmock.h`.
</Warning>

---

## 4. Linking GoogleTest and GoogleMock Libraries

To build and run tests successfully, link your test executables against GoogleTest and GoogleMock libraries.

### Recommendations:

- **GoogleTest Only:** Link `gtest` and `gtest_main`.
- **GoogleMock Included:** Link `gmock`, `gmock_main`, `gtest`, and `gtest_main`.

Example linking flags for GCC:

```bash
-lgmock -lgmock_main -lgtest -lgtest_main -pthread
```

In a CMake project:

```cmake
target_link_libraries(your_test_target gmock gmock_main gtest gtest_main pthread)
```

<Note>
Always link with `pthread` on POSIX systems for thread safety.
</Note>

---

## 5. Integrating GoogleMock (Optional)

If your project requires mocking capabilities, you need to include GoogleMock as well.

- Add GoogleMock from the same repository or package as GoogleTest.
- Include headers:

```cpp
#include <gmock/gmock.h>
```

- Link against `gmock` and `gmock_main` libraries along with GoogleTest.

<Check>
Make sure to use compatible versions of GoogleTest and GoogleMock.
</Check>

---

## 6. Writing and Compiling Test Files

### Writing a Simple Test Example

Create test source files, for example `example_test.cpp`, including GoogleTest headers and using its macros:

```cpp
#include <gtest/gtest.h>

TEST(SampleTest, BasicAssertions) {
  EXPECT_EQ(1 + 1, 2);
}
```

If using GoogleMock:

```cpp
#include <gmock/gmock.h>

using ::testing::Return;

class MockFoo {
 public:
  MOCK_METHOD(int, Bar, (), ());
};

TEST(MockTest, FooBar) {
  MockFoo mock;
  EXPECT_CALL(mock, Bar()).WillOnce(Return(5));
  EXPECT_EQ(mock.Bar(), 5);
}
```

### Compile and Link

Compile your tests ensuring the include paths and linking flags are correctly passed.

Example with g++:

```bash
g++ -std=c++17 -I/path/to/googletest/include -I/path/to/googlemock/include \
    example_test.cpp -L/path/to/libs -lgmock -lgmock_main -lgtest -lgtest_main -pthread -o example_test
```

---

## 7. Running Tests

Run your test executable as normal:

```bash
./example_test
```

GoogleTest will automatically discover and run all the tests defined with its macros.

<Info>
Read test summaries and use verbosity flags like `--gtest_filter` and `--gmock_verbose` for advanced test execution control and debug output.
</Info>

---

## 8. Best Practices and Troubleshooting

- **Use `gtest_main`/`gmock_main`**: These libraries provide prebuilt `main()` functions initializing the test framework and simplifying setup.
- **Separate Tests from Production Code**: Keep tests in dedicated directories.
- **Set Up Proper Compiler Flags**: Include necessary C++17 standard flags and warnings.
- **Verify Library Versions**: Avoid mixing incompatible versions of GoogleTest and GoogleMock.
- **Check Linker Errors**: If you get undefined references, ensure all required libraries are linked.
- **Suppress Uninteresting Call Warnings**: Use `NiceMock` to reduce noise during tests with mocks.

For in-depth troubleshooting, see [Troubleshooting Common Setup Issues](../getting-started/configuration-troubleshooting/common-issues-troubleshooting).

---

## 9. Additional Resources

- [GoogleTest Primer](../getting-started/first-test-validation/writing-running-first-test): Learn how to write and run your first test.
- [GoogleMock for Dummies](../docs/gmock_for_dummies.md): A gentle introduction to mocking with GoogleMock.
- [gMock Cookbook](../docs/gmock_cook_book.md): Recipes and patterns for mock usage.
- [Mocking Reference](../docs/reference/mocking.md): Details on macros and APIs for mocking.

---

## Summary

Integrating GoogleTest involves configuring include paths, linking proper libraries, and optionally using GoogleMock for mocks. Whether you manually include sources or use prebuilt libraries, ensuring proper compiler and linker flags are vital for smooth operation.

Following this guide will enable your project to benefit from automated C++ testing and mocking capabilities, improving code quality and maintainability.


---

# Code Snippet: Example CMake Setup

For users adopting CMake, hereâ€™s a minimal snippet demonstrating dependency management:

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject)

# Fetch GoogleTest using FetchContent
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests example_test.cpp)

target_link_libraries(my_tests PRIVATE gtest gtest_main gmock gmock_main pthread)

# Enable testing
enable_testing()
add_test(NAME MyTests COMMAND my_tests)
```

---

# Tips for Success

- Wrap complex mock definitions inside `public:` sections.
- Use `using ::testing::NiceMock;` to suppress warnings from uninteresting calls.
- Leverage the extensive gMock matchers and actions for expressive test behavior.

With these steps complete, you are ready to write robust, automated tests integrated with your project build flow.
