---
title: "Introducing GoogleMock: First Mock Test"
description: "Add basic mocking to your first test, utilizing GoogleMockâ€™s straightforward syntax. Focus on essential mocking macros and patterns for simulating dependencies."
---

# Introducing GoogleMock: First Mock Test

Welcome to your first look at adding mocking capabilities to your GoogleTest suite using GoogleMock. This guide introduces you to basic mocking techniques that help simulate dependencies, manage interactions, and improve the robustness of your tests.

---

## 1. What is GoogleMock?
GoogleMock is a powerful part of the GoogleTest framework that enables you to create mock objects following interfaces in C++. Using GoogleMock, you can specify expectations and behaviors for your mocks, allowing you to focus on the interactions your code should have with its dependencies.

### Why use GoogleMock?
- **Simulate complex dependencies:** Avoid using real dependencies that may be slow, unreliable, or unavailable during testing.
- **Control behavior:** Specify exactly how mocked methods behave and verify interactions.
- **Improve test clarity and reliability:** Your tests become fast, deterministic, and easy to understand.

For a comprehensive understanding, see the [GoogleMock Overview](https://github.com/google/googletest/blob/main/googlemock/README.md).

---

## 2. Creating Your First Mock Class

To use mocks, first create a mock class that inherits from the interface you want to mock, then use the `MOCK_METHOD` macro to declare mocked methods.

### Example Interface
```cpp
class Turtle {
 public:
  virtual ~Turtle() {}
  virtual void PenUp() = 0;
  virtual void PenDown() = 0;
  virtual void Forward(int distance) = 0;
  virtual void Turn(int degrees) = 0;
  virtual int GetX() const = 0;
};
```

### Defining a Mock Class
```cpp
#include <gmock/gmock.h>

class MockTurtle : public Turtle {
 public:
  MOCK_METHOD(void, PenUp, (), (override));
  MOCK_METHOD(void, PenDown, (), (override));
  MOCK_METHOD(void, Forward, (int distance), (override));
  MOCK_METHOD(void, Turn, (int degrees), (override));
  MOCK_METHOD(int, GetX, (), (const, override));
};
```

**Key Points:**
- The method signature is split into return type, method name, and argument list.
- Qualifiers such as `const` and `override` must be specified when applicable.
- Use `MOCK_METHOD` in the `public` section.

See [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html#Mocking-a-Normal-Class) for reference.

---

## 3. Using the Mock in a Test

Once you have defined a mock class, you can create instances and set expectations on method calls.

### Basic Workflow
1. Import gMock symbols.
2. Instantiate your mock object.
3. Set expectations specifying **what** methods should be called, **how often**, with **which arguments**, and **what they should return**.
4. Call the code under test, which exercises the mock.
5. GoogleMock will verify your expectations automatically when the mock object is destructed.

### Example Test
```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

using ::testing::AtLeast;
using ::testing::_;
using ::testing::Return;

TEST(PainterTest, CallsPenDown) {
  MockTurtle turtle;

  // Expect PenDown() to be called at least once.
  EXPECT_CALL(turtle, PenDown()).Times(AtLeast(1));

  // Sample class under test uses the turtle interface.
  Painter painter(&turtle);

  // Call method that should cause PenDown() to be invoked.
  EXPECT_TRUE(painter.DrawCircle(0, 0, 10));
}
```

**Explanation:**
- `EXPECT_CALL` sets an expectation on the mock.
- If `PenDown()` is never called, the test will fail.
- You can use matchers like `_` to accept any argument.

Refer to [gMock for Dummies - Using Mocks in Tests](https://google.github.io/googletest/gmock_for_dummies.html#Using-Mocks-in-Tests) for detailed workflows.

---

## 4. Setting Default Actions with `ON_CALL`

Not every call to a mock method must have a strict expectation. Use `ON_CALL` to set default behavior for methods when you don't need to verify exact call counts.

```cpp
using ::testing::Return;

MockTurtle turtle;

ON_CALL(turtle, GetX()).WillByDefault(Return(100));

// Calls to GetX() will return 100 unless overridden by EXPECT_CALL() with a specific action.
```

Use `ON_CALL` to provide general behavior and `EXPECT_CALL` to verify specific calls.

---

## 5. Understanding Mock Strictness

GoogleMock supports three common mock types to control warnings and failures on unexpected calls:

- **NaggyMock (default):** Warns on uninteresting calls.
- **NiceMock:** Suppresses warnings for uninteresting calls.
- **StrictMock:** Fails tests on uninteresting calls.

### How to Use:
```cpp
using ::testing::NiceMock;
using ::testing::StrictMock;

NiceMock<MockTurtle> nice_turtle;
StrictMock<MockTurtle> strict_turtle;
```

Choose the strictness level based on your test's tolerance for unexpected interactions.

### Best Practices:
- Use `NiceMock` to keep tests clean and focused.
- Use `StrictMock` only when you explicitly want every interaction verified.
- Avoid mixing mock strictness levels in complicated hierarchies.

See [Nice, Strict, and Naggy Mocks](https://google.github.io/googletest/reference/mocking.html#mocking-basics-naggy-nice-strict) for details.

---

## 6. Tips and Best Practices

- **Set expectations before exercising the mock.** `EXPECT_CALL` specifies *future* expected behavior.
- **Use matchers to avoid over-specifying arguments.** For instance, `_` matches any argument.
- **Specify call counts carefully:** Use `.Times()` with `Exactly(n)`, `AtLeast(n)`, or `AnyNumber()` as needed.
- **Use `.WillOnce()` and `.WillRepeatedly()` to define return values or actions.**
- **Keep mocks scoped properly** to ensure automatic verification on destruction.
- **Avoid mocking classes you donâ€™t own** if possible; consider creating wrapper interfaces.
- **Consider sequences or ordering constraints** with `InSequence` to verify call order.

---

## 7. Troubleshooting Common Issues

### Problem: _Mock function called more times than expected_
- Review your `.Times()` clauses to ensure they match actual invocation counts.

### Problem: _Uninteresting mock function call warning_
- Use `NiceMock` to suppress warnings if they are expected and donâ€™t add value.
- Add `EXPECT_CALL(...).Times(AnyNumber())` for catch-all expectations.

### Problem: _Unexpected call with wrong arguments_
- Check argument matchers used in `EXPECT_CALL`. Use `_` or specific matchers as needed.

### Problem: _Compile errors with MOCK_METHOD_
- Verify method signatures and qualifiers match the base interface.
- Use parentheses around return or argument types with commas.

For detailed troubleshooting, refer to [Troubleshooting Common Setup Issues](https://github.com/google/googletest/blob/main/docs/getting-started/troubleshooting-validation/common-setup-issues.md).

---

## 8. What Next?

After mastering basic mocks:

- Explore writing more complex mocks with actions, sequences, and call expectations.
- Learn about parameterized mocks and custom matchers.
- See guides on integrating GoogleMock with your build system and testing workflows.
- Delve into real-world usage examples and advanced mocking strategies.

Relevant guides include:
- [Writing Your First Test](../writing-your-first-test.md)
- [Using Mocks for Dependency Isolation](../using-mocks.md)

---

## References

- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [Mocking Reference](https://google.github.io/googletest/reference/mocking.html)
- [GoogleTest Official GitHub](https://github.com/google/googletest)

---

Happy Mocking! ðŸŽ‰


<Check>
Remember: Always define mock expectations *before* the mock methods are called to ensure correct test behavior.
</Check>

<Note>
If your mock class methods are overloaded, you might need to help GoogleMock disambiguate which overload you mock using matchers or specifying the exact function signature.
</Note>