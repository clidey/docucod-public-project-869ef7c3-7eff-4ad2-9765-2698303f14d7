---
title: "Build and Run Your First Test"
description: "Follow a practical example to write, build, and execute your earliest GoogleTest unit test. This page breaks down the development cycle, showing what to expect on success and providing real sample code."
---

# Build and Run Your First Test

This page guides you through writing, building, and running your very first GoogleTest unit test using GoogleMock. You will follow a concrete example that covers the essential steps of test development and execution, including what success looks like and real sample code that you can start using right away.

---

## 1. What You Will Achieve

By the end of this tutorial, you will:

- Define a simple mock class to enable mocking dependencies
- Write a test case that sets expectations and invokes methods on the mock
- Build your test executable with GoogleTest and GoogleMock
- Run the executable and interpret its output
- Understand key behaviors like expectation matching and test verification


## 2. Writing Your First Test Case

### Step 1: Include the Necessary Headers

Begin by including GoogleMock (which includes GoogleTest):
```cpp
#include <gmock/gmock.h>
```


### Step 2: Define a Mock Class

Define a mock class that inherits from the interface or abstract class you want to mock. Use `MOCK_METHOD` to mock virtual methods.

For example, consider a simple interface `Foo`:

```cpp
class Foo {
 public:
  virtual ~Foo() {}
  virtual bool Bar(int x, int y) = 0;
};
```

Define a mock:

```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(bool, Bar, (int x, int y), (override));
};
```

> Tip: Place all mock methods in `public:` regardless of base class access.


### Step 3: Write Your Test

Create a test that exercises `MockFoo`. Use `EXPECT_CALL()` to set expectations and specify behaviors.

```cpp
using ::testing::Return;
using ::testing::_;  // wildcard matcher

TEST(FooTest, BasicBarTest) {
  MockFoo mock_foo;

  // Expect Bar to be called once with arguments 0 and any value
  EXPECT_CALL(mock_foo, Bar(0, _))
      .WillOnce(Return(true));

  // Invoke Bar with matching arguments
  bool result = mock_foo.Bar(0, 10);

  EXPECT_TRUE(result);
}
```


## 3. Building the Test

### Step 1: Prepare Your Build Environment

- Make sure GoogleTest and GoogleMock are installed and properly linked in your build system.
- Include the necessary include paths and link against `gmock`, `gtest`, and `pthread` (on Linux).

Example CMake snippet:

```cmake
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})
add_executable(my_test my_test.cc)
target_link_libraries(my_test GTest::gtest_main GMock::gmock_main pthread)
```


### Step 2: Compile

Compile with C++11 or later support.

Example command using g++:

```sh
g++ -std=c++11 -pthread my_test.cc -lgmock -lgtest -o my_test
```


## 4. Running the Test

Run the compiled test executable:

```sh
./my_test
```

### Expected Output

On success, you will see output like:

```
[ RUN      ] FooTest.BasicBarTest
[       OK ] FooTest.BasicBarTest (0 ms)
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

- If an expectation is violated, GoogleTest will provide a clear failure message indicating which expectation was not met.
- When `EXPECT_CALL` expectations are satisfied, the test passes.


## 5. Understanding What Happens Behind the Scenes

- `MOCK_METHOD` generates code that tracks calls and validates arguments.
- `EXPECT_CALL` sets an expectation with argument matchers and invocation count.
- When the mock method is called, GoogleMock checks the expectations in reverse order, picks the latest matching and active one, and runs its actions.
- At test teardown, GoogleMock verifies all expectations were satisfied.


## 6. Best Practices

- Use `_` to match any argument when specific value doesn't matter.
- Use `.WillOnce()` with actions like `Return(value)` to specify return values.
- Prefer explicit `EXPECT_CALL` only when you want to verify a call happens.
- Use `ON_CALL` to specify default behavior without setting expectations (see later guides).
- Use `RetiresOnSaturation()` if you want expectations to become inactive after being satisfied.
- Use sequences or `.After()` to enforce call order.


## 7. Common Pitfalls & Troubleshooting

### Expectation Not Met Errors

If you get failures saying "Actual function call count doesn't match EXPECT_CALL...":

- Make sure your code calls the mock methods as expected.
- Verify argument matchers exactly match the calls.
- Check call order and sequences if used.


### "Uninteresting Mock Function Call" Warnings

This means a method was called without an expectation. This is often harmless but may indicate missing expectations.

- Use `NiceMock<>` to suppress these warnings if intentional.
- Use `EXPECT_CALL` for calls you want to verify.


### Build Errors with `MOCK_METHOD`

If your method signatures contain commas (e.g., template types like `std::pair<int,int>`), surround the type with parentheses or use type aliases:

```cpp
MOCK_METHOD((std::pair<int, int>), GetPair, ());
// or
using IntPair = std::pair<int,int>;
MOCK_METHOD(IntPair, GetPair, ());
```


## 8. Example: Full Minimal Test Code

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

class Foo {
 public:
  virtual ~Foo() {}
  virtual bool Bar(int x, int y) = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(bool, Bar, (int x, int y), (override));
};

using ::testing::Return;
using ::testing::_;

TEST(FooTest, BasicBarTest) {
  MockFoo mock_foo;
  EXPECT_CALL(mock_foo, Bar(0, _))
      .WillOnce(Return(true));

  bool result = mock_foo.Bar(0, 42);

  EXPECT_TRUE(result);
}

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```


## 9. Next Steps

- Explore [Writing and Running Your First Test](../guides/getting-started-workflows/writing-your-first-test) for more test writing patterns.
- Read the [gMock Cookbook](../docs/gmock_cook_book.md) for in-depth mocking recipes.
- Review the [Mocking Reference](../docs/reference/mocking.md) for detailed API and macros.
- Understand expectation ordering and sequencing techniques for complex scenarios.


---

## Additional Resources

- [GoogleMock for Dummies](../docs/gmock_for_dummies.md) — beginner-friendly
- [gMock Cheat Sheet](../docs/gmock_cheat_sheet.md) — quick syntax reference
- [Understanding Uninteresting vs Unexpected Calls](../docs/gmock_cook_book.md#uninteresting-vs-unexpected)
- [GoogleTest Primer](../overview/product-intro-core-concepts/about-googletest.mdx) for basics

---

Your successful first test will serve as a foundation for building comprehensive, robust unit tests with GoogleTest and GoogleMock.

<Check>
✔ Make sure to link against `gmock` and `gtest` libraries when building.
✔ Verify your mock method signatures carefully.
✔ Write expectations before calling mock methods.
</Check>

---

<AccordionGroup title="Troubleshooting Common Issues">
<Accordion title="Expectation Failed or Not Met">
Ensure that:
- You have an `EXPECT_CALL` matching the method call and its arguments.
- The call occurs as many times as specified or less.
- Your argument matchers match the actual call.
- Use `--gmock_verbose=info` for detailed logs.
</Accordion>
<Accordion title="Uninteresting Call Warning">
This happens when a mock method is called but no `EXPECT_CALL` is set.
Actions:
- Add an `EXPECT_CALL` for expected calls.
- Use `NiceMock` to suppress warnings when calls are uninteresting.
- Confirm if calls are really unexpected or not.
</Accordion>
<Accordion title="Build Errors on MOCK_METHOD with Commas">
Wrap complex types containing commas with extra parentheses or use `using` typedefs.
</Accordion>
</AccordionGroup>


---

<Source url="https://github.com/google/googletest" paths={[{"path": "docs/gmock_for_dummies.md", "range": "1-300"},{"path": "docs/gmock_cook_book.md", "range": "1-1000"},{"path": "docs/reference/mocking.md", "range": "1-300"}]} />
