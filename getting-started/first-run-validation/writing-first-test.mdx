---
title: "Writing and Running Your First Test"
description: "Demonstrates how to write a minimal test case and mock, build it, and execute it using the correct entry points. Links sample source files and explains output verification for confirming a working setup."
---

# Writing and Running Your First Test

This guide demonstrates how to write a minimal test case and mock using GoogleTest and GoogleMock, build it with the correct entry points, run your tests, and verify the output to confirm a working setup.

---

## 1. Writing a Minimal Test

Start by creating a simple test that verifies a basic function or behavior. This test will illustrate how GoogleTest discovers and runs tests automatically.

### Step-by-Step Example

```cpp
#include <gtest/gtest.h>

// A simple function to test.
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Define a test case using the TEST macro.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
}
```

**What happens here?**
- `TEST` creates two tests in `FactorialTest` suite.
- Each test contains expectations that check if `Factorial` returns expected values.
- GoogleTest will run these tests automatically when you invoke the test binary.

---

## 2. Writing a Minimal Mock

GoogleMock extends GoogleTest with mock objects for isolating dependencies.

### Example Mock Class

```cpp
#include <gmock/gmock.h>

// Interface to be mocked.
class Foo {
public:
  virtual ~Foo() = default;
  virtual int GetBar() const = 0;
  virtual void DoSomething(int n) = 0;
};

// Mock class derived from Foo using MOCK_METHOD macros.
class MockFoo : public Foo {
public:
  MOCK_METHOD(int, GetBar, (), (const, override));
  MOCK_METHOD(void, DoSomething, (int n), (override));
};

// Define a test that uses the mock.
TEST(MockFooTest, GetsBarCorrectly) {
  MockFoo mock;

  // Expect GetBar to be called once and return 42.
  EXPECT_CALL(mock, GetBar())
      .Times(1)
      .WillOnce(::testing::Return(42));

  // Exercise the mock.
  EXPECT_EQ(mock.GetBar(), 42);
}
```

### Key Points
- `MOCK_METHOD` defines mock methods.
- `EXPECT_CALL` sets expectations about calls to these methods.
- Calls that match expectations will behave as specified.

---

## 3. Building the Test Binary

### Basic Build Setup

Make sure your build process:
- Links against `gtest_main` or provides a `main()` function that calls:
  ```cpp
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
  ```
- Includes GoogleTest and GoogleMock headers.
- Links with GoogleTest and GoogleMock libraries.

### Sample `main()` if needed

If you need to write your own `main()`, use the following template:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

### Build commands example (CMake)

```bash
mkdir build && cd build
cmake ..
make
```

Or compile manually (adjust paths and library names):

```bash
g++ -std=c++17 -isystem /path/to/googletest/include \
    -pthread your_test_file.cc \
    -L/path/to/gtest/lib -lgtest_main -lgmock_main -o your_tests
```

---

## 4. Running Your Tests

After building your test executable, run it directly:

```bash
./your_tests
```

Expected console output on success:

```
[==========] Running X tests from Y test suites.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)

[----------] 1 test from MockFooTest
[ RUN      ] MockFooTest.GetsBarCorrectly
[       OK ] MockFooTest.GetsBarCorrectly (0 ms)
[----------] 1 test from MockFooTest (0 ms total)

[----------] Global test environment tear-down
[==========] 3 tests from 2 test suites ran. (0 ms total)
[  PASSED  ] 3 tests.
```

### Observing Failures

If any test fails, GoogleTest prints detailed failure messages with file name, line number, failed assertion details, and test suite and test names. This helps guide fixes.

---

## 5. Verifying Setup with Sample Source Files

You can also verify setup by compiling and running provided sample tests located in the [`googletest/samples`](https://github.com/google/googletest/tree/main/googletest/samples) directory. These cover basic to advanced usage.

---

## 6. Troubleshooting Tips

- Ensure linking with `-lgtest_main` or provide your own `main()` that calls `InitGoogleTest()` and `RUN_ALL_TESTS()`.
- Use `EXPECT_CALL` before exercising mocks to avoid unexpected call failures.
- Avoid underscores in test suite and test names (`TEST(FooTest, DoesBar)` preferred to `TEST(Foo_Test, Does_Bar)`).
- Confirm compilation and linking against the right versions of GoogleTest and GoogleMock.
- Use `--gtest_list_tests` flag to see recognized tests and confirm discovery.

---

## 7. Next Steps

- Explore the [GoogleTest Primer](primer.md) to deepen your understanding of writing tests.
- Learn how to structure tests with fixtures using `TEST_F`.
- Advance into mocking strategies with the [Using Mocks](guides/mocking-and-advanced-patterns/using-mocks.md) guide.
- Configure your build with [Basic Configuration & Project Setup](getting-started/overview-setup/basic-configuration.md).

---

## References & Further Reading

- [GoogleTest Primer](primer.md): in-depth tutorial on test writing.
- [Mocking Reference](docs/reference/mocking.md): full mock API and usage.
- [GoogleTest Advanced](advanced.md): explore advanced framework features.
- [Getting Started Overview & Setup](getting-started/overview-setup/introduction-prerequisites.md): environment preparation.
- [Sample Tests](docs/samples.md): real, working examples.

---

## Source Example Reference

For a minimal example test file, see the [GoogleTest Primer](primer.md#Simple-Tests) and [Mock usage example](docs/reference/mocking.md#MOCK_METHOD).


<Check>
Confirm your binary runs and outputs test results as shown. The appearance of "[  PASSED  ]" means success.
</Check>

---

_Start your testing journey confidently by writing simple `TEST()`s and mock definitions, compiling with the correct linkage, and running the test binary. You'll quickly observe your tests' results and be ready to expand to more comprehensive test suites._