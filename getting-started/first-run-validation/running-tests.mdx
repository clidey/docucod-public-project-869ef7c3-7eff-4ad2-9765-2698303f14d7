---
title: "Building & Running Tests"
description: "Build and execute your first tests using the recommended workflow for your build system. This includes sample commands, expected outputs, and verification procedures—ensuring you’ve successfully set up GoogleTest and can start testing your code."
---

# Building & Running Tests with GoogleTest & gMock

Welcome to the section where you will build and execute your first tests using GoogleTest and the recommended workflow for your build system. This guide walks you through compiling, running tests, checking their outputs, and verifying that your test environment—including GoogleMock—is correctly set up, so you’re ready to confidently write and run your own tests.

---

## 1. Prerequisites & Environment Setup

Before building and running tests, ensure the following prerequisites are met:

- **Compiler Support:** Use a modern C++ compiler with C++17 support.
- **Build System:** Ensure your build system (e.g., Bazel, CMake) is configured to include GoogleTest and GoogleMock sources and headers.
- **Project Dependencies:** Your project must have GoogleTest and GoogleMock code added and accessible to the build environment.

<Tip>
If you haven’t set up GoogleTest and GoogleMock in your build system yet, please refer to the [Installation Guide](https://github.com/google/googletest/blob/main/doc/installation.md) and the [Initial Configuration](https://github.com/google/googletest/blob/main/doc/setup.md) documentation first.
</Tip>

---

## 2. Building Your Tests

### Step 1: Write Your Test Files

- Create your test source files, e.g., `my_test.cc`, where you write tests using `TEST()`, `TEST_F()`, or your mock classes.
- Include the necessary headers:

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>
```

- Link your mocks if applicable using the `MOCK_METHOD` macro to define mock behaviors.

### Step 2: Compile Your Tests

- Use your build system commands to compile test binaries. For example, if you use `g++` manually:

```bash
# Compile test with GoogleTest and GoogleMock
g++ -std=c++17 -isystem path/to/googletest/include \ 
    -isystem path/to/googlemock/include \ 
    -pthread my_test.cc path/to/libgtest.a path/to/libgmock.a \ 
    -o my_test
```

- **Expected Output:** Successful compilation with no errors. Executable test binary `my_test` is produced.

<Tip>
If you use CMake or Bazel, ensure your targets link `gtest`, `gmock`, and `pthread` correctly.
</Tip>

---

## 3. Running Your First Tests

### Step 1: Run the Test Binary

Execute your compiled test binary:

```bash
./my_test
```

### Step 2: Interpreting Test Output

- A successful run outputs:

```plaintext
[==========] Running n tests from m test suites.
[----------] Global test environment set-up.
[ RUN      ] TestSuiteName.TestName
[       OK ] TestSuiteName.TestName (x ms)
[----------] Global test environment tear-down
[==========] n tests from m test suites ran. (x ms total)
[  PASSED  ] n tests.
```

- If tests fail, GoogleTest provides detailed error messages, including which test failed, failure reason, and stack trace (where available).

<Tip>
To get verbose output of mock function calls (including arguments and matched expectations), run with the flag:

```bash
./my_test --gmock_verbose=info
```
</Tip>

### Common Scenarios

| Scenario                              | What To Expect                             |
|-------------------------------------|-------------------------------------------|
| All tests pass                      | Summary indicates `[  PASSED  ]` with test count |
| Test assertion failure              | Failure message with location and reason  |
| Mock method unexpected call         | Error message describing unexpected call  |
| No tests found                     | Message: "[==========] 0 tests from 0 test suites ran". Check test registration |

---

## 4. Sample Build & Run Commands

Here is an example workflow using g++:

```bash
# Compile
g++ -std=c++17 -isystem /path/to/googletest/include \
    -isystem /path/to/googlemock/include \
    -pthread my_test.cc \
    /path/to/libgtest.a /path/to/libgmock.a -o my_test

# Run tests
./my_test
```

For CMake, your `CMakeLists.txt` usually includes:

```cmake
find_package(GTest REQUIRED)
find_package(GMock REQUIRED)

target_link_libraries(my_test PRIVATE GTest::gtest GMock::gmock pthread)
```

Run tests with:

```bash
ctest --verbose
```

---

## 5. Verification & Success Criteria

After running your tests:

- Verify the test runner completes and reports all tests passing.
- Check that your mocks, if used, verified the expectations (no warnings about uninteresting or unexpected calls).
- Confirm that the build output and test logs show no errors or warnings.

<Check>
If you see failures about unmet mock expectations or unexpected calls, verify your `EXPECT_CALL` setup matches the test code execution.
</Check>

---

## 6. Troubleshooting

### Common Issues and Solutions

| Issue                              | Cause & Fix                                         |
|----------------------------------|----------------------------------------------------|
| Tests not discovered or run      | Test function naming (must use `TEST` or `TEST_F`). Make sure `main()` calls `RUN_ALL_TESTS()`. |
| Linker errors for gMock symbols  | Link GoogleMock and GoogleTest libraries correctly; link pthread on Linux/macOS. |
| Uninteresting call warnings      | Use `NiceMock<YourMockClass>` to suppress warnings or add `EXPECT_CALL(...).Times(AnyNumber())` for methods called without expectations. |
| Unexpected calls error           | Add appropriate `EXPECT_CALL` statements to cover calls, or adjust argument matchers. |
| Multiple definitions errors      | Avoid including GoogleMock implementation files in multiple compilation units.

<Tip>
Refer to [GoogleMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) and the [Mocking Reference](https://google.github.io/googletest/reference/mocking.html) for detailed expectations and mock setup.
</Tip>

---

## 7. Next Steps

- Write further tests with mocks using `MOCK_METHOD` to define mock behaviors.
- Explore advanced mocking techniques: `ON_CALL`, specifying `EXPECT_CALL` cardinalities, sequences, and custom actions.
- Visit related guides:
  - [Writing Your First Test](https://github.com/google/googletest/blob/main/doc/writing-tests.md)
  - [Creating and Using Mocks](https://github.com/google/googletest/blob/main/doc/gmock_cook_book.md)
  - [Mocking Reference](https://github.com/google/googletest/blob/main/doc/reference/mocking.md)


---

### Example: A Simple Mock Test

```cpp
#include <gtest/gtest.h>
#include <gmock/gmock.h>

using ::testing::Return;

class Foo {
 public:
  virtual ~Foo() {}
  virtual int GetSize() const = 0;
};

class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, GetSize, (), (const, override));
};

TEST(FooTest, GetSizeReturnsExpectedValue) {
  MockFoo mock_foo;
  EXPECT_CALL(mock_foo, GetSize())
      .Times(1)
      .WillOnce(Return(42));

  int size = mock_foo.GetSize();
  EXPECT_EQ(size, 42);
}
```

Build and run this test to confirm your setup works.

---

For further documentation, see:

- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html)
- [GoogleTest Primer](https://google.github.io/googletest/primer.html)

---