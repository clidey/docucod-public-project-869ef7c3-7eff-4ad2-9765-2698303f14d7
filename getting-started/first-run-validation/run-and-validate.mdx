---
title: "Building and Running Tests"
description: "Explains compiling test code (with CMake, Bazel, or manual build), running the resulting test binary, and interpreting GoogleTest output. Describes success/failure output and common output flags/options for verification."
---

# Building and Running Tests

This guide explains how to compile your test code using popular build systems (CMake or Bazel) or manual methods, run the resulting test binary, and interpret the output produced by GoogleTest and GoogleMock. Understanding the test run output is crucial for verifying success, diagnosing failures, and customizing test runs.

---

## 1. Compiling Test Code

### Using CMake

GoogleTest and GoogleMock provide seamless integration with CMake. To compile your tests:

1. Create a `CMakeLists.txt` in your test directory or root project directory.
2. Use `find_package(GTest REQUIRED)` to locate the GoogleTest package.
3. Add your test source files and link against GoogleTest and pthread (on Linux).

Example `CMakeLists.txt` snippet:

```cmake
cmake_minimum_required(VERSION 3.10)
project(MyTests)

find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})

add_executable(my_test test_file1.cc test_file2.cc)

target_link_libraries(my_test ${GTEST_LIBRARIES} pthread)

enable_testing()
add_test(NAME MyTest COMMAND my_test)
```

Run the following commands to build:

```bash
mkdir build && cd build
cmake ..
make
```

This produces an executable (e.g., `my_test`) that can be run to execute your tests.


### Using Bazel

Bazel provides build rules for GoogleTest and GoogleMock.

1. Define a `cc_test` target in your `BUILD` file with sources and dependencies.

Example `BUILD` snippet:

```python
cc_test(
    name = "my_test",
    srcs = ["test_file1.cc", "test_file2.cc"],
    deps = ["@com_github_google_googletest//:gtest_main"],
)
```

2. Build and run with Bazel:

```bash
bazel test //path/to:my_test
```

Bazel compiles the test binary and runs it automatically.

### Manual Compilation

If you prefer manual compilation using a compiler like `g++`:

```bash
g++ -std=c++17 -isystem /path/to/gtest/include -pthread \
    /path/to/gtest/src/gtest_main.cc \
    my_test.cc \
    -o my_test
```

Ensure you adjust include paths and link pthread if needed.


<Tip>
Always prefer using CMake or Bazel for integration as they handle dependencies and platform specifics gracefully.
</Tip>

---

## 2. Running the Test Binary

Once compiled, run your test executable from a terminal:

```bash
./my_test
```

This command runs all tests registered in your code. You will see output like:

```
[==========] Running 3 tests from 1 test case.
[----------] Global test environment set-up.
[----------] 3 tests from MyTestSuite
[ RUN      ] MyTestSuite.TestCase1
[       OK ] MyTestSuite.TestCase1 (0 ms)
[ RUN      ] MyTestSuite.TestCase2
[       OK ] MyTestSuite.TestCase2 (0 ms)
[ RUN      ] MyTestSuite.TestCase3
[  FAILED  ] MyTestSuite.TestCase3 (1 ms)
[----------] 3 tests from MyTestSuite (1 ms total)
[----------] Global test environment tear-down
[==========] 3 tests from 1 test case ran. (1 ms total)
[  PASSED  ] 2 tests.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] MyTestSuite.TestCase3

 1 FAILED TEST
```

### Understanding Test Output

- `[ RUN      ]` - Indicates the start of a test.
- `[       OK ]` - The test passed.
- `[  FAILED  ]` - The test failed.
- Summary shows total tests run, passed, and failed.

Test failures output will include details showing the location of failure, assertion messages, and stack traces if enabled.

### Running Specific Tests

You can run specific tests using the `--gtest_filter` flag:

```bash
./my_test --gtest_filter=MyTestSuite.TestCase1
```

Wildcards are supported:

```bash
./my_test --gtest_filter=MyTestSuite.*
```

### Listing Available Tests

Use:

```bash
./my_test --gtest_list_tests
```

This displays all available test cases and tests.

---

## 3. Interpreting GoogleTest and GoogleMock Output

### Success Output

Success is indicated by all tests passing:

```
[  PASSED  ] N tests.
```

where `N` is the number of tests run.

### Failure Output

Failures include test name, file path, line number, and failure message, e.g.: 

```
/path/to/test.cc:42: Failure
Expected equality of these values:
  foo
  bar
  ...
[  FAILED  ] MyTestSuite.TestCase3
```

If a mock expectation fails, gMock prints details like which mock method was called unexpectedly or not called as expected, including argument mismatches.

### Common Flags and Options

| Flag                      | Purpose                                   |
| ------------------------- | ----------------------------------------- |
| `--gtest_filter=`         | Run only tests matching the filter         |
| `--gtest_list_tests`      | List tests without running them             |
| `--gtest_repeat=N`        | Repeat tests N times                        |
| `--gtest_output=xml:path` | Output test results in XML format           |
| `--gmock_verbose=LEVEL`   | Control level of GoogleMock messages (info, warning, error) |

### GoogleMock Output Levels

- `info` - Verbose including all call matches and stack traces
- `warning` *(default)* - Shows warnings for uninteresting calls without stack traces
- `error` - Shows errors only

Use `--gmock_verbose=info` to gain detailed insight during debugging.

---

## 4. Common Pitfalls and Troubleshooting

<Tip>
If your test reports unexpected calls or missing expectations:
- Ensure all `EXPECT_CALL` statements are set before exercising the code under test.
- Consider running tests with `--gmock_verbose=info` to trace mock calls.
- Use matchers (`_`, specific matchers) thoughtfully to avoid overconstraining.
</Tip>

<Warning>
A mock method must be virtual, or it will call the original method unexpectedly.
</Warning>

<Tip>
If you encounter warnings about uninteresting calls and you intend calls to the method to be allowed, either:
- Use a `NiceMock` to suppress uninteresting call warnings, or
- Add a catch-all `EXPECT_CALL(mock, Method(_)).Times(AnyNumber())`.
</Tip>

---

## 5. Advanced Usage Tips

- Use sequences (`InSequence`) to enforce call order.
- Use `.RetiresOnSaturation()` to stop expectations from matching calls after they're saturated.
- Use `ON_CALL` to set default behaviors without expectations.

See [gMock for Dummies](https://google.github.io/googletest/gmock_for_dummies.html) and [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html) for detailed patterns and examples.

---

## Troubleshooting Example

If you have a mock method unexpectedly called warning:

```cpp
EXPECT_CALL(mock_obj, Foo).Times(0);
```

Use this to explicitly forbid calls.

If you see warnings but want to suppress them:

```cpp
using ::testing::NiceMock;
NiceMock<MockClass> mock;
```

---

## Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html)
- [gMock Reference](https://google.github.io/googletest/reference/mocking.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)
- [Writing Your First Test](https://google.github.io/googletest/gtests.html#writing-your-first-test)

---

For installation with CMake or Bazel, review the respective installation guides available in this documentation suite.


<Check>
Remember to always build your tests with the same C++ standard (e.g., C++17) as your GoogleTest and GoogleMock libraries.
</Check>

---

*End of guide on Building and Running Tests.*