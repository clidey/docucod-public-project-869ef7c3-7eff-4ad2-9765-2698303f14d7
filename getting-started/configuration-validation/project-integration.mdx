---
title: "Configuring Your Project"
description: "Provides clear steps to connect your C++ project to GoogleTest and GoogleMock, including necessary include paths, linking instructions, and integration tips for both new and existing codebases."
---

# Configuring Your Project with GoogleTest and GoogleMock

This guide walks you through connecting your C++ project to GoogleTest and GoogleMock. You'll set up include paths, properly link libraries, and apply practical tips for seamless integration whether you are starting fresh or integrating into an existing codebase.

---

## 1. Prerequisites

Before proceeding with configuration, ensure you have:

- **Built or installed GoogleTest and GoogleMock libraries**
  - Refer to the [Installing with CMake](https://github.com/google/googletest/blob/main/README.md#getting-started) guide for building instructions.
- **C++17 compatible environment** (compiler and standard library support required)
- Basic familiarity with CMake or your project's build system


## 2. Setting Up Include Paths

Your project must be able to find GoogleTest and GoogleMock header files. There are two common scenarios:

### a) Using Installed Libraries

If you installed GoogleTest and GoogleMock system-wide or via package manager, include paths typically look like:

```cmake
# Example for CMake
find_package(GTest REQUIRED)

include_directories(${GTEST_INCLUDE_DIRS})
``` 

Ensure the include directories include both `gtest` and `gmock` headers, often found under an `include` folder.

### b) Using Source Tree / Embedded Sources

If you included GoogleTest/GoogleMock in your project source (e.g., as a git submodule or direct copy), add their include directories explicitly:

```cmake
include_directories(
  "${PROJECT_SOURCE_DIR}/googletest/include"
  "${PROJECT_SOURCE_DIR}/googlemock/include"
)
```

<Note>
GoogleMock depends on GoogleTest, so always include both.
</Note>


## 3. Linking GoogleTest and GoogleMock Libraries

Correct linking is critical to properly run tests.

### a) Linking with GoogleMock (Includes GoogleTest)

- Link against `gmock_main` if you want to use the provided main() function.
- Link against `gmock` and provide your own main() if you need a custom entry point.

Example CMake snippet:

```cmake
add_executable(my_tests test_main.cpp my_tests.cpp)
target_link_libraries(my_tests gmock_main pthread) # pthread required on POSIX
```

If you use gtest only, link against `gtest_main` or `gtest` accordingly.

### b) Manual main() Function Setup

If you want a custom main, link with `gmock` and `gtest`:

```cmake
add_executable(my_tests test_main.cpp my_tests.cpp)
target_link_libraries(my_tests gmock gtest pthread)
```

Your `test_main.cpp` should invoke:

```cpp
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

<Warning>
Avoid defining multiple `main()` functions or linking multiple `gmock_main` libraries simultaneously to prevent linker errors.
</Warning>


## 4. Integrating with Your Build System

### Using CMake's FetchContent (Recommended)

An effective way is to pull GoogleTest and GoogleMock into your build dynamically:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(my_tests test_main.cpp my_tests.cpp)
target_link_libraries(my_tests GTest::gmock_main)
```

This ensures compatibility and consistent compiler flags.

### Manual Adding of Subdirectory

If the code is local:

```cmake
add_subdirectory(googletest)
add_executable(my_tests test.cpp)
target_link_libraries(my_tests gmock_main)
```

### Other Build Systems

- For Bazel users, check the [Installing with Bazel](https://github.com/google/googletest/blob/main/README.md) guide.
- For other build tools, configure include paths and link libraries analogous to CMake.


## 5. Integration Tips and Best Practices

- **Use `gmock_main` for simplicity** if you do not need a custom main. This provides a ready-to-use test runner.
- **Order matters:** Include `gmock/gmock.h` before `gtest/gtest.h` when needed.
- **Avoid multiple definitions:** Ensure only one main() symbol is linked.
- **Link pthread (or equivalent)** on POSIX systems to avoid runtime errors.

<Tip>
If your build system supports it, prefer targets such as `GTest::gmock_main` as they automatically handle include and link dependencies.
</Tip>


## 6. Example Minimal CMake Setup

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyProject CXX)

set(CMAKE_CXX_STANDARD 17)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/release-1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(tests test_example.cpp)
target_link_libraries(tests GTest::gmock_main)
```

This minimal setup downloads, configures, and integrates GoogleMock and GoogleTest into your project seamlessly.


## 7. Common Pitfalls & Troubleshooting

### Problem: Link errors due to missing pthread or main symbols

- Solution: Link `pthread` explicitly on Linux/macOS.
- Use `gmock_main` to automatically get a main or provide your own only once.

### Problem: Undefined references to GoogleTest or GoogleMock symbols

- Solution: Verify correct libraries (`gmock`, `gmock_main`, `gtest`) are linked.
- Check include directories for headers and library directories for binaries.

### Problem: Macro conflicts or duplicate symbols

- Solution: Avoid linking multiple GoogleTest or GoogleMock versions.
- Use consistent versions of GoogleTest and GoogleMock across all dependencies.

<Warning>
Your compiler must support C++17. Failing to do so results in build errors.
</Warning>


## 8. Next Steps

- Write your first tests using `TEST()` and `TEST_F()` macros. See the [Writing and Running Your First Test](https://github.com/google/googletest/blob/main/docs/primer.md) guide.
- Explore advanced mocking features in the [Mocking Reference](https://github.com/google/googletest/blob/main/docs/reference/mocking.md).
- Validate your setup and learn more about troubleshooting in [Validating Setup & Troubleshooting](https://github.com/google/googletest/blob/main/docs/faq/getting-started-faq/installation-compatibility.md).

---

## Further Reading

- [GoogleTest Primer (Basic Test Writing)](https://github.com/google/googletest/blob/main/docs/primer.md)
- [GoogleMock README](https://github.com/google/googletest/blob/main/googlemock/README.md)
- [Installing with CMake](https://github.com/google/googletest/blob/main/README.md#getting-started)

---

This page is part of the [Getting Started & Integration](https://github.com/google/googletest/tree/main/docs/getting-started) documentation set.

---

<Check>
Ensure your build system correctly points to GoogleTest and GoogleMock headers and libraries.
Verify your executable links with `gmock_main` or has a main() that calls `testing::InitGoogleMock()` and `RUN_ALL_TESTS()`.
Verify your compiler supports C++17.
Run the example tests to validate your setup.
</Check>
