---
title: "Troubleshooting Common Setup Issues"
description: "Diagnoses and provides fixes for frequent errors encountered during setup or initial test runs—such as configuration missteps, missing dependencies, or build failures. Empowers users to recover quickly without leaving the onboarding flow."
---

# Troubleshooting Common Setup Issues

GoogleTest and GoogleMock provide robust mechanisms to write and run C++ unit and integration tests. However, during setup and initial test runs, you may encounter frequent errors such as configuration missteps, missing dependencies, or build failures. This guide helps you identify, diagnose, and recover from these common issues — enabling you to continue with onboarding smoothly.

---

## 1. Common Setup Issues Overview

Below are the typical problem areas when setting up GoogleTest and GoogleMock:

- **Missing or incompatible C++ compiler or standard library support**
- **Incorrect or incomplete inclusion of GoogleTest and GoogleMock headers and source files**
- **Linking failures due to missing or misconfigured test libraries**
- **Runtime errors such as failed test discovery or unexpected test behavior**
- **Unaddressed warnings about mock expectations or uninteresting mock calls**

Each section below addresses these issues with actionable troubleshooting steps.

---

## 2. Compiler and Platform Compatibility

### Symptoms

- Build errors indicating unsupported language features (e.g., missing C++17 support).
- Compiler warnings about virtual function overrides or macro conflicts.

### Resolution Steps

1. **Verify C++17 Standard Support:**
   - GoogleTest requires at least C++17 standard.
   - Confirm your compiler supports C++17 (e.g., GCC 7+, Clang 5+, MSVC 2017+).
   - Modify your build to explicitly enable C++17. Example for GCC/Clang:

    ```bash
    -std=c++17
    ```

2. **Check Platform Compatibility:**
   - Supported platforms include major Linux distributions, macOS, and Windows.
   - Refer to the [Prerequisites & Supported Platforms](/getting-started/setup-prerequisites-installation/prerequisites-supported-platforms) page.

3. **Resolve Macro Conflicts:**
   - Windows API headers may redefine common identifiers (e.g., `Method`).
   - To avoid macro name conflicts, include `<windows.h>` before GoogleMock headers or undefine macros after including Windows headers.

4. **Address Compiler Warnings:**
   - Pay attention to warnings about overriding methods with `const` parameters — these often reflect compiler quirks.

---

## 3. Including and Linking GoogleTest and GoogleMock

### Symptoms

- `fatal error: gmock/gmock.h: No such file or directory`
- Undefined references to GoogleTest/GoogleMock symbols during linking

### Resolution Steps

1. **Include Headers Correctly:**
   - Include GoogleMock and GoogleTest headers using:

    ```cpp
    #include <gmock/gmock.h>
    #include <gtest/gtest.h>
    ```

2. **Verify Source Files and Libraries in Your Build:**
   - GoogleTest and GoogleMock source files or compiled libraries must be linked into your test executable.
   - Use official installation instructions: [Installing with CMake](/getting-started/setup-prerequisites-installation/installation-cmake) or [Installing with Bazel](/getting-started/setup-prerequisites-installation/installation-bazel).

3. **Check Linker Flags:**
   - Link your test program with `-lgmock -lgtest -lpthread` on Linux/macOS.
   - Ensure library paths are passed with `-L` if necessary.

4. **Confirm Targets in Build System:**
   - If using CMake, verify test targets link to `gmock_main` or `gtest_main` libraries for main() function injection.

5. **Avoid Multiple Definition Errors:**
   - Do not compile GoogleTest/Mock source files multiple times.
   - Use precompiled libraries or single compilation units.

---

## 4. Runtime and Test Execution Issues

### Symptoms

- Tests not discovered or not running
- Unexpected failure messages
- Crashes during test execution

### Resolution Steps

1. **Initialize GoogleMock/GoogleTest Properly:**
   - In your `main()` function, call:

    ```cpp
    int main(int argc, char** argv) {
      testing::InitGoogleMock(&argc, argv);
      return RUN_ALL_TESTS();
    }
    ```

2. **Avoid Linking Conflicts or Multiple Mains:**
   - Link to either `gmock_main` or `gtest_main` to provide the main function.
   - If you define your own `main()`, do not link to these.

3. **Run Executable with Proper Arguments:**
   - Use `--gtest_filter` to select tests.
   - Use `--gmock_verbose=warning|error|info` to control mock logging verbosity.

4. **Use Verbose Logging to Troubleshoot:**
   - Run tests with `--gmock_verbose=info` to gain insights into mock function calls and expectation matching.

5. **Check for Leaked Mocks or Unsatisfied Expectations:**
   - GoogleMock will warn about leaked mocks if not properly cleaned.
   - Use `Mock::AllowLeak(&mock_obj);` to intentionally suppress leak warnings for mocks you want to keep alive beyond test scope.

---

## 5. Handling Uninteresting and Unexpected Mock Calls

### Symptoms

- Warnings: "Uninteresting mock function call"
- Failures: "Unexpected mock function call"

### Explanation

- **Uninteresting calls:** Mocks receive calls with no matching `EXPECT_CALL` expectation.
- **Unexpected calls:** Calls to mock methods with expectations but arguments do not match any.

### Resolution Steps

1. **Use `ON_CALL()` to Define Default Behavior:**
   - Define default actions for mock functions you do not explicitly set expectations on.
   - Example:

    ```cpp
    ON_CALL(mock_obj, SomeMethod(_)).WillByDefault(Return(0));
    ```

2. **Add Catch-All Expectations:**
   - Use `_` matcher with `Times(AnyNumber())` to allow any calls.

    ```cpp
    EXPECT_CALL(mock_obj, SomeMethod(_)).Times(AnyNumber());
    ```

3. **Suppress or Enforce Uninteresting Calls Using Mock Types:**
   - Use `NiceMock<MockClass>` to suppress uninteresting call warnings.
   - Use `StrictMock<MockClass>` to treat uninteresting calls as failures.
   - The default `MockClass` behaves like `NaggyMock` which warns.

4. **Make Expectations Less Restrictive:**
   - Use matchers like `_` when you don't care about specific arguments.

5. **Check Verbosity Levels:**
   - Control logging with `--gmock_verbose` to reduce noise or surface detailed call tracing.

---

## 6. Build and Link Troubleshooting Guide

| Issue                               | Cause                                   | Fix Recommendation                                  |
|-----------------------------------|----------------------------------------|----------------------------------------------------|
| Missing `gmock/gmock.h`           | Header not found in include paths      | Add GoogleMock include directory to build includes |
| Linker errors (undefined symbols) | GoogleTest/Mock libraries not linked   | Add `-lgmock -lgtest` and dependencies to linker    |
| Multiple definitions              | Compiled sources multiple times        | Use shared compiled libraries or single compile unit|
| Incompatible compiler versions    | Compiler doesn't support needed features | Upgrade compiler to version supporting C++17+      |

---

## 7. Practical Tips and Best Practices

- **Set expectations before exercising mocks:** `EXPECT_CALL` must precede mock method calls.
- **Use `ON_CALL` for default behaviors:** Helps prevent unexpected-call failures.
- **Prefer `NiceMock` by default:** Helps reduce noise from uninteresting calls.
- **Use sequences and ordering only when order matters:** Over-specification leads to brittle tests.
- **Leverage verbose mode for diagnosing failures:** `--gmock_verbose=info` shows matching, calls, and stacks.
- **Avoid mocking non-virtual methods unless necessary:** Use interface abstractions where possible.

---

## 8. Additional Troubleshooting Resources

- [Practical Initial Configuration Guide](/getting-started/configuration-validation/initial-configuration)
- [Writing and Running Your First Test](/getting-started/configuration-validation/write-and-run-first-test)
- [Mocking Reference Documentation](https://google.github.io/googletest/gmock_cook_book.html)
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [Legacy gMock FAQ](/docs/gmock_faq.md)

---

## 9. When All Else Fails

If issues persist after following the guidance above:

- Check your build configurations carefully for missing flags and paths.
- Simplify your test case to a minimal reproducible example.
- Use GoogleTest's verbose mode for diagnosing mismatch details.
- Consult the [GoogleTest GitHub repository](https://github.com/google/googletest) issues page for community discussions.
- Reach out on community forums or mailing lists for support.

---

By anticipating these common setup issues and using the best practices outlined here, you empower yourself to quickly recover from errors, maintain smooth onboarding, and gain confidence in your testing workflows with GoogleTest and GoogleMock.

---

# Appendix: Sample Commands and Checks

```bash
# Check compiler version and C++17 support
g++ --version
# Compile test with C++17 standard
g++ -std=c++17 your_test.cc -lgmock -lgtest -lpthread -o your_test

# Run the test with verbose logging
./your_test --gmock_verbose=info

# Verify that GoogleMock and GoogleTest are properly linked
ldd your_test | grep gmock
```


# Troubleshooting Snippet: Suppressing "Uninteresting mock function call" warning

```cpp
#include <gmock/gmock.h>

using ::testing::NiceMock;

class MockFoo {
public:
  MOCK_METHOD(void, DoSomething, (), ());
};

int main() {
  NiceMock<MockFoo> mock;

  // Expected call
  EXPECT_CALL(mock, DoSomething()).Times(1);

  // Call triggers expectation check
  mock.DoSomething();

  // Other calls produce no warning
  mock.DoSomething();  // No warning or failure
}
```


---

For detailed verification of your setup, consult the [Initial Configuration Guide](/getting-started/configuration-validation/initial-configuration) and [First Test Guide](/getting-started/configuration-validation/write-and-run-first-test).