---
title: "Initial Configuration"
description: "Introduces steps for configuring GoogleTest within your project, such as including the main header and linking libraries. Explains key variables and optional settings to fit a variety of project styles."
---

# Initial Configuration

Configure GoogleTest effectively within your C++ project by following these essential steps. This guide covers how to include the main header files, link to the correct libraries, and understand key configuration variables and settings to adapt GoogleTest to your project's style.

---

## 1. Include GoogleTest Headers

Before you write any tests, ensure your source files include the correct GoogleTest headers. At minimum, add:

```cpp
#include <gtest/gtest.h>
```

This header includes core GoogleTest components such as test macros, assertions, and the testing framework.

If you plan to use GoogleMock for mocking capabilities, additionally include:

```cpp
#include <gmock/gmock.h>
```

This brings the mocking support and related macros.

<Tip>
Always include GoogleTest headers in your test source files before writing test cases to avoid compilation errors.
</Tip>

## 2. Link Against the Correct Libraries

You must link your test executables against GoogleTest libraries to successfully compile and run the tests:

- `gtest` or `gtest_main` for GoogleTest functionality.
- `gmock` or `gmock_main` if using GoogleMock features.

For example, using CMake, link your executable like this:

```cmake
add_executable(my_tests test_main.cpp ...)
target_link_libraries(my_tests GTest::gtest_main)
# If mocks are used,
target_link_libraries(my_tests GMock::gmock_main)
```

Ensure the libraries correspond to your build setup and platform.

<Note>
Using `gtest_main` or `gmock_main` provides a ready-made main function for test execution, simplifying setup.
</Note>

## 3. Key Configuration Variables

### Control Macros

GoogleTest supports several macros to tweak behavior. These are usually passed as compiler flags (`-D` options). The most common are:
- `GTEST_HAS_PTHREAD=1` or `0`: Enable or disable pthread use for thread safety.
- `GTEST_CREATE_SHARED_LIBRARY=1`: Build GoogleTest as a shared library if needed.
- `GTEST_LINKED_AS_SHARED_LIBRARY=1`: Use this when linking tests against shared GoogleTest libraries.

Set these appropriately based on your platform and build system.

### Internal Flags

GoogleTest also offers advanced flags (prefixed with `GTEST_`) to customize test discovery, output format, stack trace depth, and more.

Consult GoogleTest build files or platform-specific documentation for advanced customization.

## 4. Integrating GoogleTest Initialization

Your test executable must initialize GoogleTest before running tests. If you link against `gtest_main` or `gmock_main`, the main entry point is provided for you.

Otherwise, include this in your `main()`:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This step prepares the framework to discover and run all tests.

<Check>
If you have a custom `main()`, ensure you call `InitGoogleTest()` exactly once with appropriate arguments.
</Check>

## 5. Optional Settings for Flexibility

### Macro Renaming for Conflicts

If GoogleTest macros like `TEST` or `ASSERT_EQ` conflict with other libraries, you can disable them via compiler flags:

```bash
-DGTEST_DONT_DEFINE_TEST=1
```

This requires you to use namespaced versions like `GTEST_TEST` instead.

### Configuring Concurrency

GoogleTest is thread-safe on platforms supporting pthreads. You can force or disable pthread detection with:

```bash
-DGTEST_HAS_PTHREAD=1
-DGTEST_HAS_PTHREAD=0
```

### Custom Memory and Build Setup

For advanced users, configuration files or compiler defines can adjust default output format, test filters, and other behaviors.

---

## Troubleshooting and Tips

<AccordionGroup title="Common Configuration Issues">
<Accordion title="Missing GoogleTest Headers or Libraries">
Ensure you've installed or cloned the GoogleTest repository properly and that your include and linker paths are set to the correct directories.
</Accordion>
<Accordion title="Build Errors on Linking">
Verify that you link against `gtest` or `gtest_main`. If using GoogleMock, also link against `gmock` or `gmock_main`. The order of linking sometimes matters.
</Accordion>
<Accordion title="Multiple Definitions of main()">
If you link both `gtest_main` and also provide your own `main()`, remove one to avoid conflicts.
</Accordion>
<Accordion title="Thread Safety Issues">
If you face thread-related errors, specify pthread usage explicitly and confirm your environment supports it.
</Accordion>
</AccordionGroup>

<Tip>
When encountering strange build or linkage errors, checking the output with verbose build flags or linking logs often reveals missing libraries or incorrect paths.
</Tip>

---

## Next Steps

Once you have configured GoogleTest, your next step is to write and run your first test.

See the [Writing and Running Your First Test](/getting-started/configuration-validation/write-and-run-first-test) page for a step-by-step guide.

For installation details, revisit [Installing with CMake](/getting-started/setup-prerequisites-installation/installation-cmake) or [Installing with Bazel](/getting-started/setup-prerequisites-installation/installation-bazel).

If you encounter issues, consult [Troubleshooting Common Setup Issues](/getting-started/configuration-validation/troubleshooting-common-issues).

---

## References and Additional Resources

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleMock (gMock) Overview](https://google.github.io/googletest/gmock_for_dummies.html)
- [GoogleTest Official Documentation Overview](/overview/introduction-and-value/product-purpose-and-value)
- [System Architecture Details](/overview/architecture-and-concepts/system-architecture)
- [Mocking Reference](/api-reference/core-mocking-api/mock-method-definition)

---

This completes your initial configuration of GoogleTest for robust, scalable C++ testing.


