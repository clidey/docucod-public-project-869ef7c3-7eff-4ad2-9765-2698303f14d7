---
title: "Quick Validation and Troubleshooting"
description: "Enable fast verification that your setup is working by outlining simple validation steps and known signs of success. Include troubleshooting advice for common pitfalls such as linker issues, missing dependencies, or unsupported compilers."
---

# Quick Validation and Troubleshooting

Ensure your GoogleTest and GoogleMock setup is functioning correctly by following these rapid validation steps. Detect and resolve common pitfalls such as linker errors, missing dependencies, and unsupported compiler issues early to guarantee smooth test execution.

---

## 1. Quick Validation Steps

Follow these steps to verify that your environment and GoogleTest/GoogleMock integration are working as expected.

### Step 1: Build Your Test Project

- Ensure your C++ project includes the GoogleTest and GoogleMock libraries correctly (see installation pages).
- Use your chosen build system (CMake, Bazel, or others) with correct compiler settings targeting C++17 or later.

### Step 2: Run a Basic GoogleTest Sample

Create a minimal test to confirm the framework is working.

```cpp
#include <gtest/gtest.h>

TEST(SanityCheck, TrueIsTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run this test:

- Success output example:
  ```
  [==========] Running 1 test from 1 test suite.
  [----------] Global test environment set-up.
  [ RUN      ] SanityCheck.TrueIsTrue
  [       OK ] SanityCheck.TrueIsTrue (0 ms)
  [----------] 1 test from SanityCheck ran. (0 ms total)
  [==========] 1 test from 1 test suite ran. (0 ms total)
  [  PASSED  ] 1 test.
  ```

If this works, GoogleTest is correctly integrated.

### Step 3: Run a Basic GoogleMock Sample

Create a minimal mock class with expectations:

```cpp
#include <gmock/gmock.h>
#include <gtest/gtest.h>

class MockInterface {
 public:
  MOCK_METHOD(int, GetValue, (), ());
};

TEST(MockSanityCheck, CanMockMethod) {
  MockInterface mock;
  EXPECT_CALL(mock, GetValue()).WillOnce(testing::Return(42));

  EXPECT_EQ(mock.GetValue(), 42);
}

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Build and run:

- Success indicates GoogleMock is set up correctly.

### Step 4: Verify Test Discovery and Execution

- Confirm your test runner automatically discovers tests and mocks.
- Use `--gtest_list_tests` to list tests and validate discovery.


## 2. Common Signs of Success

- Runs compile without errors or linking failures involving GoogleTest or GoogleMock.
- Tests execute and show `[  PASSED  ]` messages.
- No warnings about missing symbols, failed expectations, or linker issues.
- Tests that use mocks report expected verification behavior.

<Tip>
Running with `--gmock_verbose=info` provides detailed logs of mock call matching and expectation evaluation, helping you verify that mock expectations are triggered as intended.
</Tip>

## 3. Troubleshooting Common Issues

### Linker Errors (Undefined References)

**Cause:** GoogleTest/GoogleMock libraries not linked properly or version mismatch.

**Solution:**
1. Verify your linking command includes `-lgmock -lgtest` and their dependencies.
2. Ensure the library paths point to the correct versions installed.
3. If building from source, ensure you built GoogleTest/GoogleMock with C++17 or later.

### Missing Virtual Destructors in Mocks

**Cause:** Mocked classes lack virtual destructors, causing undefined behavior and heapcheck failures.

**Solution:**
- Always ensure the base class you mock declares a virtual destructor.

### Unsupported Compiler or Missing C++17 Features

**Cause:** Compiler or standard library does not support C++17 required by GoogleTest.

**Solution:**
- Upgrade to a supported compiler (MSVC 2015+, GCC 7+, Clang 4+, etc.)
- Confirm compiler flags enable C++17 (`-std=c++17` or equivalent).

### Uninteresting Call Warnings

When a mock method is called without an expectation, you may see warnings:

```
GMOCK WARNING:
Uninteresting mock function call - returning default value.
```

**Cause:** No `EXPECT_CALL()` set for the invoked method.

**Remedies:**
- Add a catch-all expectation `EXPECT_CALL(mock, Method(_)).Times(testing::AnyNumber());` if you want to allow and ignore these calls.
- Use `NiceMock` wrapper around your mock type to suppress such warnings globally.
- Do NOT suppress by adding arbitrary `EXPECT_CALL`s without intent - this will increase test brittleness.

### Leaked Mocks and Expectations Not Verified

If your test reports mock objects not deleted, expectations are not verified:

```
ERROR: this mock object should be deleted but never is.
```

**Cause:** Mock object lifetime is not managed carefully; allocated on heap and not deleted.

**Solution:**
- Ensure mock objects are properly destructed after use.
- Consider using `Mock::AllowLeak(&mock_object)` if the leak is intentional.
- Enable heap checker or `--gmock_catch_leaked_mocks=1` to detect early.

### Tests Failing With Unexpected Call Messages

If tests fail due to unexpected calls or argument mismatches, check:

- You have set all necessary `EXPECT_CALL`s before exercising the mocks.
- Argument matchers accurately reflect expected values.
- `EXPECT_CALL`s are not out of order when order matters (use `InSequence`).

### Using the `--gmock_verbose` Flag for Diagnostics

- Run tests with `--gmock_verbose=info` to see detailed tracing of expected and actual mock calls.
- Combine with `--gtest_stack_trace_depth=0` to suppress stack traces if needed.


## 4. Practical Tips and Best Practices

- Set expectations (`EXPECT_CALL`) before calling the functions under test. Setting expectations afterward leads to undefined behavior.
- Use `ON_CALL` to set default mock behaviors when calls are not verified but need a default.
- Consider using `NiceMock<>` for mocks in tests where most calls are uninteresting.
- Use `StrictMock<>` if you want unexpected calls to cause test failures.
- When mocking, ensure your mock methods exactly match the methods including qualifiers like `const` and `override`.


## 5. Additional Diagnostic Commands

- Verify test discovery:
  ```
  ./your_test_binary --gtest_list_tests
  ```
- Run tests with verbose mocking:
  ```
  ./your_test_binary --gmock_verbose=info
  ```
- Clear expectations and verify mocks early:
  ```cpp
  bool success = ::testing::Mock::VerifyAndClearExpectations(&mock_object);
  ASSERT_TRUE(success);
  ```


## 6. Where to Go Next

- For help setting up GoogleTest and GoogleMock in your build system, see the [Installation with CMake](../prerequisites-installation/installation-cmake.md) and [Installation with Bazel](../prerequisites-installation/installation-bazel.md) guides.
- To understand writing tests and mocks, read [gMock for Dummies](../docs/gmock_for_dummies.md) and the [Mocking Reference](../docs/reference/mocking.md).
- For help with troubleshooting linkage and build issues, consult [Common Build Errors FAQ](../../faq/troubleshooting-integration/common-build-errors.md).

---

<Check>
Following the steps above guarantees your GoogleTest and GoogleMock environment is correctly installed and ready for writing and running tests.
</Check>

<Warning>
Avoid skipping early setup validation. Problems found early save hours of debugging later.
</Warning>

<Info>
The `--gmock_verbose` flag is a powerful ally during test development. Use it liberally.
</Info>
