---
title: "Installing with Bazel"
description: "Explains how to add and use GoogleTest as a dependency in Bazel-based projects, covering WORKSPACE/Bazel module configuration for smooth integration."
---

# Installing with Bazel

This guide walks you through the process of integrating GoogleTest into your C++ project using the Bazel build system. It focuses on setting up your Bazel workspace and configuring Bazel’s module system for effortless GoogleTest dependency management and usage.

---

## 1. Prerequisites & System Requirements

Before proceeding, ensure you have the following:

- **Operating System & Compiler**: A supported platform such as Linux, macOS, or Windows with a C++ compiler that supports at least C++17.
- **Bazel Version**: Bazel 7.0 or higher installed.
- **Internet Access**: Required to fetch dependencies from the Bazel Central Registry.

If Bazel is not installed, follow the [Bazel installation guide](https://bazel.build/install).

---

## 2. Setting Up Your Bazel Workspace

### Step 1: Create a Workspace Directory

Open your terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

This command creates and navigates into a new directory that will serve as your Bazel workspace.

### Step 2: Declare the GoogleTest Dependency via MODULE.bazel

Starting with Bazel 7.0, the recommended method for adding external dependencies is using the Bazel Central Registry and `MODULE.bazel` file.

Create a file named `MODULE.bazel` in your workspace root with the following content:

```python
# MODULE.bazel

bazel_dep(name = "googletest", version = "1.17.0")
```

> **Tip:** Always check for the latest stable GoogleTest version on [Bazel Central Registry](https://registry.bazel.build/modules/googletest) and update the version accordingly.

---

## 3. Writing Your First Test

### Step 1: Create a Test Source File

In the workspace directory, create a file named `hello_test.cc` with the following sample content:

```cpp
#include <gtest/gtest.h>

// A simple test case demonstrating basic assertions.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");  // Check strings are not equal.
  EXPECT_EQ(7 * 6, 42);               // Check numeric equality.
}
```

This example includes GoogleTest's header and uses two basic assertions to validate behavior.

### Step 2: Create a Bazel BUILD File

Create a file named `BUILD` alongside `hello_test.cc` with the following contents:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This defines a Bazel test target that compiles your test code and links against GoogleTest and its included `main()` function.

---

## 4. Building and Running the Test

### Step 1: Build and Test Using Bazel

Run the following command from your workspace root:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures the tests are compiled with C++17 standard.
- `--test_output=all` ensures all test output is visible.

### Expected Output

You should see output similar to:

```
INFO: Analyzed target //:hello_test (26 packages loaded, 362 targets configured).
INFO: Found 1 test target...
INFO: From Testing //:hello_test:
==================== Test output for //:hello_test:
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
================================================================================
Target //:hello_test up-to-date:
  bazel-bin/hello_test
INFO: Elapsed time: 4.190s, Critical Path: 3.05s
INFO: 27 processes: 8 internal, 19 linux-sandbox.
INFO: Build completed successfully, 27 total actions
//:hello_test                                                     PASSED in 0.1s

INFO: Build completed successfully, 27 total actions
```

Congratulations! Your GoogleTest integration with Bazel is successful.

---

## 5. Tips & Best Practices

- **Keep Versions Up To Date:** Regularly update the `googletest` version in `MODULE.bazel` to get the latest fixes and features.
- **Use `gtest_main` for Simple Tests:** Linking against `@googletest//:gtest_main` provides a default `main()` function. For custom test runners or advanced setups, consider linking only `@googletest//:gtest` and providing your own `main()`.
- **Specify C++ Standard:** Always use `--cxxopt=-std=c++17` (or equivalent for MSVC) to ensure compatibility.
- **Separate Production and Test Code:** Use Bazel’s visibility and package rules to keep test dependencies separate from production builds.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting GoogleTest with Bazel">
<Accordion title="Tests Do Not Compile or Link">
Verify that your `BUILD` file correctly lists the dependencies:

- Ensure you include both `@googletest//:gtest` and `@googletest//:gtest_main` in `deps` for `cc_test`.
- Confirm the `MODULE.bazel` file is correctly formatted and that Bazel has synced dependencies.
- Run `bazel sync` to refresh external dependencies.
</Accordion>

<Accordion title="C++ Standard Conflicts or Errors">
Add the flag `--cxxopt=-std=c++17` when building and testing to enforce the required C++ version.

For MSVC, use `--cxxopt=/std:c++17`.

Check your compiler's version if issues persist.
</Accordion>

<Accordion title="Dependency Not Found or Download Fails">
Ensure your network allows Bazel to fetch packages.

If behind a proxy or firewall, configure Bazel accordingly.

Verify the version number in `MODULE.bazel` matches a published GoogleTest release.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Proceed to [Writing and Running Your First Test](/getting-started/first-steps-validation/creating-your-first-test) to expand your testing skills.
- Explore [Mocking Basics with GoogleMock](/getting-started/first-steps-validation/mocking-basics) for advanced test scenarios.
- Read about [Supported Platforms](/getting-started/environment-setup/supported-platforms) to verify your environment compatibility.
- Consult the [Troubleshooting Common Setup Issues](/getting-started/troubleshooting-resources/troubleshooting-common-issues) page if you run into problems.

---

## References

- [Bazel Central Registry: googletest module](https://registry.bazel.build/modules/googletest)
- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)
- [GoogleTest Assertions and Primer](primer.md)

---

Congratulations on integrating GoogleTest into your Bazel workflow. Enjoy confident, scalable C++ testing powered by GoogleTest!
