---
title: "Configure Your Project"
description: "Instructions for integrating GoogleTest and GoogleMock headers and libraries into users’ source trees, including directory structure guidance and linking advice for C++ projects of all sizes."
---

# Configure Your Project

Integrating GoogleTest and GoogleMock into your C++ project requires correctly setting up header files, library linking, and directory structure alignment. This guide walks you through actionable steps to include the testing framework effectively for projects of all sizes, ensuring a seamless build and test execution experience.

---

## 1. Organizing GoogleTest and GoogleMock in Your Source Tree

### Recommended Directory Structure

To maintain clarity and ease of use, organize GoogleTest and GoogleMock sources and headers within your project as follows:

```
/path/to/your-project/
│
├── third_party/
│   ├── googletest/       # Contains GoogleTest source and headers
│   │   ├── include/       # Public header files for GoogleTest
│   │   └── src/           # Source files
│   └── googlemock/        # Contains GoogleMock source and headers
│       ├── include/       # Public header files for GoogleMock
│       └── src/           # Source files
│
└── your_tests/            # Your own test cases
    └── ...
```

This structure clearly separates third-party testing libraries from your project code.

<Tip>
Maintaining this structure helps build systems locate the headers and source files easily, preventing header path conflicts.
</Tip>

### Using Installed System-Wide Libraries

Alternatively, if GoogleTest and GoogleMock are installed system-wide (e.g., via package managers or manual install), you can reference the installed include and library paths directly in your build configuration.


## 2. Including Headers in Your Test Source Files

Integrate GoogleTest and GoogleMock headers into your test files by including their public headers. Example:

```cpp
#include <gtest/gtest.h>      // Core GoogleTest headers
#include <gmock/gmock.h>      // Core GoogleMock headers - include only if mocking
```

These include paths assume that your compiler's include directories are set up to point to the relevant `include` folders.

<Check>
Make sure to include `<gtest/gtest.h>` prior to `<gmock/gmock.h>` if using both frameworks as GoogleMock depends on GoogleTest.
</Check>

## 3. Linking Your Tests with GoogleTest and GoogleMock Libraries

After compiling GoogleTest and GoogleMock (either via CMake or manual build), you'll have libraries to link against.

### Essential Link Libraries

- **For GoogleTest only:**
  Link with `gtest` or `gtest_main` (the latter provides a main function to run tests).

- **For GoogleMock + GoogleTest:**
  Link with `gmock` or `gmock_main` (which internally includes GoogleTest libraries).

When linking, prefer:

- `gtest_main` for simple GoogleTest programs
- `gmock_main` when GoogleMock features and automatic main function are desired

### Example Build Link Flags

If you built GoogleTest and GoogleMock using CMake or installed system-wide,
add these to your linker flags:

```
-lgmock_main -lgmock -lgtest_main -lgtest -pthread
```

*Note: Linking with threading libraries such as `pthread` may be required on Linux systems.*


## 4. Configuring Build Systems

### CMake Integration

You can integrate GoogleTest and GoogleMock either by embedding their source or referencing installed libraries.

#### Using FetchContent to Integrate GoogleTest & GoogleMock

Add this snippet to your `CMakeLists.txt`:

```cmake
include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/v1.17.0.zip
)
FetchContent_MakeAvailable(googletest)

add_executable(your_test_executable your_tests.cpp)
target_link_libraries(your_test_executable gtest_main gmock_main)
```

This method ensures consistent compiler flags and easy updates.

#### Configuring Include Paths

Confirm that your target includes the GoogleTest and GoogleMock headers:

```cmake
target_include_directories(your_test_executable PRIVATE
  ${googletest_SOURCE_DIR}/googletest/include
  ${googletest_SOURCE_DIR}/googlemock/include
)
```


### Other Build Systems

For other build environments, manually specify include directories and link flags to your compiler and linker:

- Add the include paths to your compiler's header search.
- Add the compiled GoogleTest and GoogleMock static or dynamic libraries to the linker.


## 5. Custom Main Function vs Provided Main

- **Use provided `gtest_main` or `gmock_main` libraries:**

  Simplifies your test programs by providing a default `main()` function to initialize and run tests.

- **Define your own `main()` if customization is needed:**

  See the [GoogleTest Primer `main()` example](https://github.com/google/googletest/blob/main/docs/primer.md) for guidance.

<Tip>
Linking with `gmock_main` or `gtest_main` eliminates the need to write boilerplate startup code for tests.
</Tip>

## 6. Best Practices and Tips

- **Consistent compiler flags:** When integrating GoogleTest/GoogleMock into your project, ensure compiler flags like C++ standard version and runtime linkage match across your tests and the framework to avoid subtle bugs.

- **Use GoogleMock only if mocking functionality is needed:** If you don't require mocks, link against GoogleTest only to keep your builds lean.

- **Keep GoogleTest and GoogleMock updated together:** GoogleMock depends on GoogleTest internals and API, so mismatches can cause build or runtime errors.

- **Manage dependencies carefully:** Avoid multiple copies of GoogleTest/GoogleMock in your project to prevent symbol clashes.

## 7. Troubleshooting Common Integration Issues

<AccordionGroup title="Troubleshooting Integration Issues">
<Accordion title="Header File Not Found">
Verify include paths are correctly set, pointing to the `include/` directories of GoogleTest and GoogleMock source or installation.
Check for typos in `#include <gtest/gtest.h>` or `#include <gmock/gmock.h>` directives.
</Accordion>
<Accordion title="Linker Can’t Find GoogleTest or GoogleMock Libraries">
Ensure the linker has the correct library search paths and that you link explicitly with `gtest`, `gtest_main`, `gmock`, or `gmock_main` as required.
On Linux, confirm `-pthread` is included.
</Accordion>
<Accordion title="Multiple Definition or Duplicate Symbols">
This often indicates multiple versions of GoogleTest/GoogleMock are included or linked.
Consolidate framework dependencies and verify your build configuration to link against a single compiled instance.
</Accordion>
</AccordionGroup>

## 8. Summary

By following this guide, you will have successfully integrated GoogleTest and GoogleMock headers and libraries into your source tree and build system. This foundation enables you to author and run tests efficiently on all supported platforms.


---

## Additional Resources and Next Steps

- [GoogleTest Primer](docs/primer.md) – Understand core testing concepts.
- [Install with CMake](getting-started/installation-quickstart/install-cmake) – Build instructions.
- [Create and Run Your First Test](getting-started/installation-quickstart/first-test) – Write your initial test.
- [Mocking API Reference](api-reference/core-apis/mocking) – Use GoogleMock effectively.

Use these resources to continue configuring your project and writing comprehensive tests.

---

*This documentation is part of the Getting Started Guide, focusing exclusively on project configuration.*

---