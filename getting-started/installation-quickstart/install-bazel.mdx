---
title: "Install with Bazel"
description: "Guides users through installing GoogleTest and GoogleMock via Bazel, including workspace configuration, dependency declarations, and sample build targets."
---

# Install with Bazel

This guide walks you through installing GoogleTest and GoogleMock using Bazelâ€”the fast, scalable build system recommended by the GoogleTest team. You'll learn how to configure your Bazel workspace, declare dependencies for GoogleTest, and build a simple test binary.

---

## 1. Prerequisites

Before continuing, ensure you have the following:

- A supported operating system (Linux, macOS, or Windows).
- A C++ compiler that supports at least C++17 standards.
- Bazel version 7.0 or higher installed. Follow the [Bazel installation guide](https://bazel.build/install) if needed.

> **Note:** Commands and file contents examples below use Unix shell syntax but can also be adapted for Windows command line.


## 2. Set Up Your Bazel Workspace

A Bazel workspace is a root directory that manages your source files and dependencies for building software. Follow these steps to create and configure your workspace for GoogleTest:

### Step 1: Create a workspace directory

Open your terminal and run:

```bash
mkdir my_workspace && cd my_workspace
```

This creates and switches to a new workspace directory.

### Step 2: Add a `MODULE.bazel` file to declare GoogleTest dependency

Create a file named `MODULE.bazel` in the root of your workspace with the following content:

```starlark
# MODULE.bazel

# Declare the GoogleTest module dependency
bazel_dep(name = "googletest", version = "1.17.0")
```

> **Tip:** Check [Bazel Central Registry for GoogleTest](https://registry.bazel.build/modules/googletest) for the latest stable version.


## 3. Write Your First Test

Create a new file `hello_test.cc` inside your workspace directory with this example GoogleTest unit test:

```cpp
#include <gtest/gtest.h>

// A simple test to verify basic assertions.
TEST(HelloTest, BasicAssertions) {
  // Verify two different strings are not equal.
  EXPECT_STRNE("hello", "world");

  // Verify the result of an arithmetic expression.
  EXPECT_EQ(7 * 6, 42);
}
```

This sample demonstrates how to use GoogleTest assertions to check expected behavior.


## 4. Define a Bazel Build Target

Create a file named `BUILD` (no extension) in the same directory, with this content to define the test target:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

- `cc_test` declares the C++ test binary.
- The `deps` specify linkage to GoogleTest libraries fetched from the Bazel Central Registry.


## 5. Build and Run the Test

Use Bazel to compile and execute your test.

### Step 1: Build and test using Bazel

Run:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures C++17 standard is used.
- `--test_output=all` shows the full output of the test run.

### Expected output snippet:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
```

This output confirms your test built and ran successfully using the Bazel build system.


## 6. Tips and Best Practices

- Keep your `MODULE.bazel` up to date with the latest GoogleTest version for the newest features and fixes.
- If you switch to a different compiler or platform, still ensure your Bazel build passes with `--cxxopt` flags set appropriately.
- Explore other Bazel build rules to organize larger test suites.


## 7. Troubleshooting

<AccordionGroup title="Common Issues When Installing and Using Bazel with GoogleTest">
<Accordion title="Error: Bazel cannot find GoogleTest module">
Ensure your `MODULE.bazel` contains the exact dependency declaration and you're running commands from the root workspace directory.
</Accordion>
<Accordion title="Test fails to build due to missing `cxxopt` flag for C++17">
Pass the `--cxxopt=-std=c++17` flag explicitly when invoking Bazel test/build commands to enforce C++17 support.
</Accordion>
<Accordion title="Linker errors related to threading or pthread">
Verify Bazel and the underlying environment support required threading libraries for your platform.
</Accordion>
</AccordionGroup>


## 8. Next Steps

- Learn to write balanced, maintainable tests using our [Test Project Structure and Initialization guide](/guides/getting-started/test-project-structure).
- Explore authoring more advanced tests with [Basic Unit Tests](/guides/writing-and-running-tests/basic-unit-tests).
- If you prefer another build system, see [Install with CMake](/getting-started/installation-quickstart/install-cmake).


---

## Summary
This guide provides a complete flow to set up GoogleTest and GoogleMock using Bazel, from workspace creation and dependency declaration to building and running your first test binary.

---

For full example projects, templates, and advanced Bazel build options, visit the GoogleTest GitHub repository and Bazel official documentation.


---

## Quick Reference Code Example

```bash
# Create workspace folder
mkdir my_workspace && cd my_workspace

# Add dependency declaration
cat > MODULE.bazel <<EOF
bazel_dep(name = "googletest", version = "1.17.0")
EOF

# Create test source file
cat > hello_test.cc <<EOF
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
EOF

# Create Bazel build rule
cat > BUILD <<EOF
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
EOF

# Build and run tests
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```
