---
title: "Create and Run Your First Test"
description: "Walks users through writing, building, and executing their first GoogleTest/GoogleMock test case. Emphasizes core concepts—test macros, main entry points, and interpreting output—to ensure an empowering first win."
---

# Create and Run Your First Test

Welcome to your first hands-on experience with GoogleTest and GoogleMock! This guide will walk you step-by-step through writing, building, and executing your first test case, highlighting key concepts such as test macros, the main function entry point, and how to interpret the test output.

---

## 1. Write Your First Test

At the core of GoogleTest is writing *tests* that verify your C++ code works as expected. You'll start by defining simple tests using the `TEST()` macro.

### Steps to Create a Simple Test

1. **Include the GoogleTest header** at the top of your test file:

```c++
#include <gtest/gtest.h>
```

2. **Define a test function using `TEST()`**. The first parameter is the *test suite* name, grouping related tests. The second is the *test name* distinct within that suite.

Example: Testing a simple Factorial function

```c++
int Factorial(int n) {
  return (n <= 1) ? 1 : n * Factorial(n - 1);
}

// Test that factorial(0) returns 1.
TEST(FactorialTest, HandlesZeroInput) {
  EXPECT_EQ(Factorial(0), 1);
}

// Test that factorial returns expected values for positive integers.
TEST(FactorialTest, HandlesPositiveInput) {
  EXPECT_EQ(Factorial(1), 1);
  EXPECT_EQ(Factorial(2), 2);
  EXPECT_EQ(Factorial(3), 6);
  EXPECT_EQ(Factorial(8), 40320);
}
```

### Key Points:
- `EXPECT_EQ()` checks if the two values are equal. Failures are reported but do not stop the test.
- The test suite is `FactorialTest`, containing multiple related tests.
- Test and suite names should be valid C++ identifiers without underscores.

<Tip>
Choose descriptive names for your tests to make failures easy to diagnose.
</Tip>

---

## 2. Write a Test Using a Fixture (Optional but Recommended)

When multiple tests require the same setup, use a *test fixture* to share data and code.

### How to Create and Use a Test Fixture

1. Define a fixture class inheriting from `testing::Test`:

```c++
class QueueTest : public testing::Test {
 protected:
  QueueTest() {
    // Setup code
    q1_.Enqueue(1);
    q2_.Enqueue(2);
    q2_.Enqueue(3);
  }

  Queue<int> q0_;
  Queue<int> q1_;
  Queue<int> q2_;
};
```

2. Write tests with `TEST_F()` instead of `TEST()`. The first argument is your fixture class.

```c++
TEST_F(QueueTest, IsEmptyInitially) {
  EXPECT_EQ(q0_.size(), 0);
}

TEST_F(QueueTest, DequeueWorks) {
  int* n = q0_.Dequeue();
  EXPECT_EQ(n, nullptr);

  n = q1_.Dequeue();
  ASSERT_NE(n, nullptr);  // Use ASSERT_ to stop if nullptr, prevents segfault.
  EXPECT_EQ(*n, 1);
  EXPECT_EQ(q1_.size(), 0);
  delete n;

  n = q2_.Dequeue();
  ASSERT_NE(n, nullptr);
  EXPECT_EQ(*n, 2);
  EXPECT_EQ(q2_.size(), 1);
  delete n;
}
```

### Why Use Fixtures?
- Share initialization and cleanup code.
- Ensure isolation: each test runs with a fresh fixture.

<Note>
Remember to use `ASSERT_*` macros when continuation after failure would cause crashes.
</Note>

---

## 3. Write the Main Function to Run Tests

GoogleTest offers a default main() implementation in the `gtest_main` or `gmock_main` libraries you can link against. However, if you want full control or need custom test setup, write your own:

```c++
#include <gtest/gtest.h>

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);  // Parses GoogleTest flags
  return RUN_ALL_TESTS();                // Runs all registered tests
}
```

### Important:
- Call `InitGoogleTest()` before running tests to initialize command line flags.
- Return `RUN_ALL_TESTS()` value to reflect test success or failure.
- `RUN_ALL_TESTS()` runs all tests registered by `TEST()` and `TEST_F()` macros.

<Tip>
Linking your tests with `gtest_main` (or `gmock_main` if using mocks) provides a ready-to-use main function, simplifying your build.
</Tip>

---

## 4. Build Your Test Executable

### Using CMake (common approach)

1. Make sure GoogleTest and GoogleMock are properly installed or added to your project.
2. Create a CMakeLists.txt file (example):

```cmake
cmake_minimum_required(VERSION 3.14)
project(FirstTest)

add_executable(first_test first_test.cpp)
find_package(GTest REQUIRED)
target_link_libraries(first_test GTest::gtest_main GTest::gmock_main pthread)
include(GoogleTest)
gtest_discover_tests(first_test)
```

3. Configure and build:

```bash
mkdir build && cd build
cmake ..
make
```

4. Run the test executable:

```bash
./first_test
```

### Example output on success:

```text
[==========] Running 2 tests from 1 test suite.
[----------] Global test environment set-up.
[----------] 2 tests from FactorialTest
[ RUN      ] FactorialTest.HandlesZeroInput
[       OK ] FactorialTest.HandlesZeroInput (0 ms)
[ RUN      ] FactorialTest.HandlesPositiveInput
[       OK ] FactorialTest.HandlesPositiveInput (0 ms)
[----------] 2 tests from FactorialTest (0 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 1 test suite ran. (0 ms total)
[  PASSED  ] 2 tests.
```

<Check>
If tests fail, GoogleTest prints detailed messages pinpointing where and why.
</Check>

---

## 5. Understand Your Test Output

When tests run, GoogleTest provides detailed output:

- **[ RUN      ]** — Denotes the test starting.
- **[       OK ]** — Test passed.
- **[  FAILED  ]** — Test failed along with file and line number.

For example, a failure looks like this:

```
[ RUN      ] FactorialTest.HandlesZeroInput
/path/to/file.cc:15: Failure
Expected equality of these values:
  Factorial(0)
    Which is: 0
  1
[  FAILED  ] FactorialTest.HandlesZeroInput (0 ms)
```

### Interpreting Failures
- Location and nature of failure are stated clearly.
- If you use `EXPECT_` macros, the test continues with other assertions.
- `ASSERT_` macros stop test upon failure.

<Tip>
Use `--gtest_filter=` command line argument to run specific tests for focused debugging.
</Tip>

---

## 6. Running Your First Mock Test

GoogleMock extends GoogleTest by allowing easy creation of mock objects.

### Example Mock Test

```c++
#include <gmock/gmock.h>
#include <gtest/gtest.h>

class MockFoo {
 public:
  MOCK_METHOD(int, DoSomething, (int x), ());
};

TEST(MockTest, BasicMockTest) {
  MockFoo mock;

  EXPECT_CALL(mock, DoSomething(5))
      .Times(1)
      .WillOnce(testing::Return(10));

  int result = mock.DoSomething(5);
  EXPECT_EQ(result, 10);
}
```

### Run this test using the same build and run steps.

<Tip>
Use `NiceMock` or `StrictMock` when you want to suppress or enforce warnings for uninteresting calls.
</Tip>

---

## Troubleshooting Common Pitfalls

### Test Not Running?
- Check that your test suite and test names are valid identifiers (no underscores).
- Make sure test functions are not accidentally skipped via filters or flags.

### Linking Errors?
- Confirm GoogleTest and GoogleMock libraries are linked.
- Use `gtest_main` or `gmock_main` for default main() implementations.

### Assertion Failures?
- Review test code and expectations. Use `--gtest_break_on_failure` for debugging.

### Multiple Test Runs?
- Avoid calling `RUN_ALL_TESTS()` multiple times; it supports only a single run.

### Mock Warnings?
- If you get "Uninteresting mock function call" warnings, consider adding `ON_CALL()` defaults or switch to `NiceMock`.

<Tip>
See the [Troubleshooting Common Issues](https://google.github.io/googletest/faq/troubleshooting/common-issues.html) guide for detailed help.
</Tip>

---

## Next Steps

- Explore [Writing and Running Tests](../guides/writing-and-running-tests/basic-unit-tests.md) for more testing techniques.
- Learn about [Using Mock Objects Effectively](../guides/writing-and-running-tests/using-mock-objects.md) to harness mocking power.
- Visit [GoogleTest Primer](../../docs/primer.md) for deeper conceptual understanding.

<Tip>
Keep your tests small, focused, and use descriptive names for quick debugging.
</Tip>

---

## Related Documentation

- [GoogleTest Primer](../../docs/primer.md)
- [Mocking API Reference](../../docs/reference/mocking.md)
- [Configure Your Project](../installation-quickstart/configure-project.md)
- [System Requirements & Supported Platforms](../setup-foundations/system-requirements.md)

---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/primer.md", "range": "1-250"},{"path": "docs/reference/testing.md", "range": "1-600"},{"path": "docs/reference/mocking.md", "range": "1-400"}]} />
