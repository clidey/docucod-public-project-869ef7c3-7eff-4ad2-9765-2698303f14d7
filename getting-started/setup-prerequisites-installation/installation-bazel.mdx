---
title: "Installation with Bazel"
description: "Instructions for integrating and building GoogleTest with the Bazel build system. This page details fetching the project, updating Bazel files, and verifying your build environment, making it easy for Bazel users to get started."
---

# Installation with Bazel

This guide provides clear, actionable instructions to integrate and build GoogleTest using the Bazel build system. You'll learn how to set up your Bazel workspace, configure build files, and run your first test binary with GoogleTest, ensuring a smooth onboarding experience for Bazel users.

---

## 1. Prerequisites & System Requirements

Before starting, make sure your environment meets the following requirements:

- **Operating System:** Compatible with Linux, macOS, or Windows.
- **C++ Compiler:** Must support **C++17** or later (for example, GCC 7+, Clang 5+, MSVC 2017+).
- **Bazel Version:** Use Bazel **7.0 or higher** for compatibility with the GoogleTest workspace and module system.
- **Network Access:** Required for fetching external dependencies.

If Bazel is not installed, get the latest version from the [Bazel official installation guide](https://bazel.build/install).


<Note>
If you are new to Bazel, ensure you understand the concept of a Bazel workspace—your root directory controlling your builds with a `MODULE.bazel` file.
</Note>

## 2. Set Up a Bazel Workspace for GoogleTest

### Step 1: Create a Workspace Directory

Choose a location on your machine and create a new directory for your Bazel workspace:

```bash
mkdir my_workspace && cd my_workspace
```

### Step 2: Create MODULE.bazel

To integrate GoogleTest through Bazel's module system (bzlmod), which is the recommended modern dependency method, create a `MODULE.bazel` file in the root of your workspace with the following content:

```python
# MODULE.bazel

# Declare the googletest dependency version
bazel_dep(name = "googletest", version = "1.17.0")
```

This declaration fetches GoogleTest version 1.17.0 from the Bazel Central Registry automatically.

<Info>
For environments or existing workflows not using Bazel modules, you may alternatively use the `WORKSPACE` file method with `http_archive` to specify dependencies, but `MODULE.bazel` is the preferred approach for Bazel 7.0+.
</Info>

## 3. Create a Build File (`BUILD`)

To build and run your GoogleTest tests, you need a Bazel `BUILD` file describing your test targets.

### Example `BUILD` file to compile a test `hello_test.cc`:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

This declares a C++ test named `hello_test` with the source file and links it against GoogleTest's core (`gtest`) and main function (`gtest_main`).

## 4. Your First Test Source File

Create a simple test file `hello_test.cc` with this example to verify your setup:

```cpp
#include <gtest/gtest.h>

// Basic test cases demonstrating some assertions
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

## 5. Build and Run Your Tests

Use Bazel commands from your workspace root to build and run the tests:

### Build and run the test with C++17 enabled:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

### Expected output snippet:

```
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[  PASSED  ] 1 test.
```

Successfully running the test confirms that GoogleTest was correctly integrated with your Bazel build.

<Check>
To ensure Bazel is compiling with the correct C++ standard, always specify `--cxxopt=-std=c++17` (or `/std:c++17` on MSVC). This avoids build errors due to incompatible language versions.
</Check>

## 6. Advanced Configuration Tips

- **Multiple Bazel Versions or Custom Bazel Binaries**: If your environment requires a specific Bazel binary (e.g., on Kokoro CI), adjust your Bazel executable path accordingly.

- **Using Bazel Vendor Mode:**
  To reduce external dependency downloads, you can leverage Bazel's vendor directory. For example, if you have `googletest_vendor.tar.gz`, instruct Bazel to use it by passing `--vendor_dir="path/to/dir"`.

- **Handling Abseil Dependency:**
  GoogleTest optionally uses [Abseil](https://abseil.io/) libraries. Bazel’s configuration can enable this with `--define=absl=1`.

## 7. Troubleshooting Common Issues

<AccordionGroup title="Common Bazel Installation and Build Issues">
<Accordion title="Build Fails with C++ Standard Errors">
Make sure to pass `--cxxopt=-std=c++17` or the MSVC equivalent when running bazel build/test. Without this, compiler defaults might be incompatible with GoogleTest.
</Accordion>
<Accordion title="Unable to Fetch External Repositories">
Check network access and proxy settings. If using a corporate proxy or restricted network, ensure Bazel can access GitHub and Bazel Central Registry URLs.
</Accordion>
<Accordion title="Tests Do Not Run or No Output Shown">
Use the flag `--test_output=all` during `bazel test` to see detailed test logs.
</Accordion>
</AccordionGroup>

## 8. Next Steps & Additional Resources

- Explore the [GoogleTest Primer](primer.md) to learn how to write detailed unit tests.
- Visit the [Quickstart: Building with CMake](getting-started/setup-prerequisites-installation/installation-cmake) guide to compare build configurations.
- Review the [Building with Bazel Quickstart](docs/quickstart-bazel.md) for a hands-on tutorial with samples.
- Refer to the MODULE.bazel and WORKSPACE files in the GoogleTest repository to understand advanced dependency configurations.

---

### Sample Minimal Workspace Structure:

```
my_workspace/
 ├─ MODULE.bazel         # Dependency declaration
 ├─ BUILD                # Build rules for your tests
 ├─ hello_test.cc        # Your test source
```

With this setup, you're ready to build and run your first GoogleTest test using Bazel.

---

### Related Documentation

- [Quickstart: Building with Bazel](docs/quickstart-bazel.md)
- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Bazel Official Documentation](https://bazel.build)
- [GoogleTest Primer](primer.md)
- [Installation with CMake](getting-started/setup-prerequisites-installation/installation-cmake)

---

If you encounter issues beyond this guide, consult the [Troubleshooting & Quick Validation](getting-started/configuration-first-test-validation/troubleshooting-validation) documentation for deeper diagnostics and solutions.

---