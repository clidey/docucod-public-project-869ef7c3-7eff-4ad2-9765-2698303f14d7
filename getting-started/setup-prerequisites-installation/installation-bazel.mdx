---
title: "Installing with Bazel"
description: "Step-by-step walkthrough for setting up GoogleTest with Bazel. Addresses Bazel users' specific workflows for incorporating and managing the GoogleTest dependency."
---

# Installing with Bazel

This guide provides a practical, step-by-step walkthrough for setting up GoogleTest in projects that use the Bazel build system. It is tailored specifically for Bazel users managing the GoogleTest dependency and aims to help you build, configure, and run your first unit test with confidence.

---

## 1. Prerequisites & System Requirements

Before starting, ensure your environment meets these requirements:

- **Operating System:** Linux, macOS, or Windows.
- **Compiler:** Compatible C++ compiler with C++17 support (minimum).
- **Bazel Version:** Bazel 7.0 or higher.

> For detailed platform and compiler support, refer to the [Supported Platforms](../setup-prerequisites-installation/prerequisites-supported-platforms) page.
>
> If you need Bazel installation instructions, visit the [Bazel installation guide](https://bazel.build/install).

<Note>
The command examples use Unix-style shell prompts but are compatible with Windows command line environments.
</Note>

---

## 2. Setting Up Your Bazel Workspace

Bazel manages projects within a **workspace**, a directory with a `MODULE.bazel` file that tracks external dependencies.

### Step 1: Create a Workspace Directory

Open your terminal or command prompt and run:

```bash
mkdir my_workspace && cd my_workspace
```

This creates and enters a new directory named `my_workspace` which will serve as your Bazel workspace.

### Step 2: Add `MODULE.bazel` to Declare GoogleTest Dependency

Create a new file named `MODULE.bazel` in your workspace root with the following content:

```python
# MODULE.bazel

# Declare the GoogleTest dependency via Bazel Central Registry
bazel_dep(name = "googletest", version = "1.17.0")
```

- Adjust the version string to the latest release if needed by checking [Bazel Central Registry](https://registry.bazel.build/modules/googletest).

> This declaration instructs Bazel to fetch GoogleTest automatically as an external dependency.

---

## 3. Adding Your First Test

Now that your workspace knows about GoogleTest, letâ€™s create a test to verify everything works.

### Step 1: Write a Simple Test File

Inside `my_workspace`, create a file named `hello_test.cc` with this example code:

```cpp
#include <gtest/gtest.h>

// Basic test demonstrating GoogleTest assertions
TEST(HelloTest, BasicAssertions) {
    // Verify these strings are not equal
    EXPECT_STRNE("hello", "world");
    // Verify this mathematical assertion
    EXPECT_EQ(7 * 6, 42);
}
```

This C++ file includes GoogleTest's main header and defines a simple test case.

### Step 2: Create a Bazel Build File

Create a file named `BUILD` in the same directory with the following content:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```

- The `cc_test` rule defines a test target.
- It depends on GoogleTest core (`gtest`) and the default test main entry point (`gtest_main`).

> See the [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html) for more on `BUILD` files.

---

## 4. Build and Run Your Test

With your workspace and test in place, you are ready to build and run your test.

### Step 1: Build and Test with Bazel

Execute this command:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

- `--cxxopt=-std=c++17` ensures the test is compiled with C++17 standard.
- `--test_output=all` shows the full output from the test.

### Expected Output

You will see output similar to this:

```
INFO: Found 1 test target...
INFO: From Testing //:hello_test:
Running main() from gmock_main.cc
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from HelloTest
[ RUN      ] HelloTest.BasicAssertions
[       OK ] HelloTest.BasicAssertions (0 ms)
[----------] 1 test from HelloTest (0 ms total)
[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

This confirms your test ran successfully with GoogleTest.

<Check>
If you encounter build errors related to compiler flags, verify your compiler supports C++17 and adjust flags accordingly.
</Check>

---

## 5. Additional Configuration & Best Practices

### Using MSVC on Windows

- Use the `--cxxopt=/std:c++17` flag instead of `--cxxopt=-std=c++17` when using Microsoft Visual Studio's compiler.

### Managing Dependencies

- Bazel's recommended way to consume GoogleTest is through the Bazel Central Registry as shown. Avoid manual options to reduce configuration errors.

### Support for pthread

- On platforms that require it (Linux, macOS), GoogleTest uses pthread. Bazel automatically links the required libraries.

### Updating GoogleTest Version

- Regularly update the version in your `MODULE.bazel` file to get the latest features and fixes.

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Bazel Installation and Build Issues">
<Accordion title="Build errors related to C++ standard version or compiler">
Ensure your compiler supports C++17. Adjust Bazel's compiler options (like `--cxxopt`) to explicitly target C++17 or higher. For example:

```bash
bazel test --cxxopt=-std=c++17 ...
```

On MSVC, use `/std:c++17` instead of `-std=c++17`.
</Accordion>
<Accordion title="Cannot find GoogleTest dependencies in Bazel">
Check that your `MODULE.bazel` file is correctly named and located at the workspace root.

Make sure it includes the correct `bazel_dep` entry pointing to a valid GoogleTest version.

Run `bazel clean --expunge` and retry to clear cached dependency errors.
</Accordion>
<Accordion title="Test binary does not run or exits early">
Verify that your `cc_test` rule includes both `@googletest//:gtest` and `@googletest//:gtest_main` dependencies.

Missing `gtest_main` often causes test binaries to lack a `main()` function.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Explore the [Writing and Running Your First Test](../configuration-validation/write-and-run-first-test) page to learn how to write more complex tests.
- Visit the [Primer](../../../primer.md) to deepen your understanding of GoogleTest assertions and features.
- Check out the [Troubleshooting Common Setup Issues](../configuration-validation/troubleshooting-common-issues) section if you encounter difficulties.


---

Congratulations! You have successfully installed and run GoogleTest with Bazel, positioning you to integrate robust C++ testing into your Bazel-managed project.


---

## References

- [Bazel Central Registry: GoogleTest Module](https://registry.bazel.build/modules/googletest)
- [Bazel Official Documentation](https://bazel.build/)
- [GoogleTest Primer](primer.md)
- [Supported Platforms](../setup-prerequisites-installation/prerequisites-supported-platforms)
- [Bazel C++ Tutorial](https://docs.bazel.build/versions/main/tutorial/cpp.html)


---

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "docs/quickstart-bazel.md", "range": "0-100"},{"path": "MODULE.bazel", "range": "0-40"}]}/>