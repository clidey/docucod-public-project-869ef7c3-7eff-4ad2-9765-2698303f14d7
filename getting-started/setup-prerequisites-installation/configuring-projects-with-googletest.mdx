---
title: "Configuring Projects with GoogleTest"
description: "Guides users through linking GoogleTest into their codebase, setting up source trees, and proper configuration for different build systems. Includes advice on integrating as a submodule or external dependency."
---

# Configuring Projects with GoogleTest

This guide helps you integrate GoogleTest into your C++ project. It covers linking GoogleTest libraries, structuring your source tree, and configuring different build systems effectively. Whether you use GoogleTest as a submodule or an external dependency, this document offers clear, step-by-step instructions to get started.

---

## 1. Preparing Your Project to Use GoogleTest

Before writing tests, you need to set up your project to link against GoogleTest libraries and include its headers properly.

### Choosing How to Integrate GoogleTest

You have multiple options to include GoogleTest in your project:

- **As an External Dependency:** Install GoogleTest system-wide or download it separately, then link against the installed libraries.
- **As a Git Submodule:** Include the GoogleTest repository inside your source tree to keep the dependency version controlled.
- **Fetch During Build:** Use CMake's `FetchContent` or other mechanisms to download GoogleTest during the configuration step.

Each approach affects how you configure and organize your build files.

---

## 2. Linking GoogleTest in Your Build System

The exact steps vary based on your build system. Below are detailed instructions for **CMake**, the most commonly used build system.

### Linking GoogleTest with CMake

GoogleTest ships with CMake configuration files that export `gtest` and `gtest_main` targets. These allow easy linking.

#### Step-by-Step Setup Using FetchContent

1. **Specify your required CMake minimum version and project name**

```cmake
cmake_minimum_required(VERSION 3.14)
project(your_project_name)

# Require at least C++17 standard
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
```

2. **Import GoogleTest using `FetchContent`**

```cmake
include(FetchContent)

FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)

# Prevent overriding compiler options of the parent project on Windows
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)
```

3. **Add your test executable target and link it with GoogleTest**

```cmake
add_executable(your_test_executable your_test_file.cc)
target_link_libraries(your_test_executable PRIVATE GTest::gtest_main)
```

4. **Enable CMake Testing and automatically discover tests**

```cmake
enable_testing()
include(GoogleTest)
gtest_discover_tests(your_test_executable)
```

#### Example Minimal `CMakeLists.txt`

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/refs/tags/release-1.17.0.zip
)
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)

add_executable(hello_test hello_test.cc)
target_link_libraries(hello_test PRIVATE GTest::gtest_main)

enable_testing()
include(GoogleTest)
gtest_discover_tests(hello_test)
```

5. **Build and Run**

```bash
cmake -S . -B build
cmake --build build
cd build
ctest
```

This process automatically builds GoogleTest, links it to your tests, and runs all discovered tests.


### Using GoogleTest as a Submodule

1. **Add GoogleTest as a git submodule:**

```bash
git submodule add https://github.com/google/googletest.git third_party/googletest
```

2. **Add GoogleTest to your CMake project:**

```cmake
add_subdirectory(third_party/googletest)
add_executable(your_test your_test.cc)
target_link_libraries(your_test PRIVATE gtest_main)
enable_testing()
include(GoogleTest)
gtest_discover_tests(your_test)
```

---

## 3. Best Practices for Project Structuring

- **Keep test sources separate:** Place test files in a dedicated folder, e.g., `/tests/`.
- **Name conventions:** Use consistent test naming, for example, `foo_test.cc` for tests related to `foo.cc`.
- **Link only test targets to GoogleTest:** Do not link application binaries to testing libraries.
- **Use `gtest_main` for default `main()`**: Link `gtest_main` to provide a ready-to-use `main()` for your tests, so you don't have to write one.

---

## 4. Troubleshooting Common Configuration Issues

<AccordionGroup title="Common Setup Issues">
<Accordion title="GoogleTest Not Found by CMake">
Ensure your CMake version is at least 3.14 to support `FetchContent`. If using an external installation, set `CMAKE_PREFIX_PATH` to the directory containing `GTestConfig.cmake`.
</Accordion>
<Accordion title="Linker Errors for pthread or Threads">
GoogleTest uses pthreads on Unix-like systems. Make sure your linker links with pthread correctly. Using CMake's `FindThreads` module usually resolves this automatically.
</Accordion>
<Accordion title="Mismatched Runtime Library on Windows">
When building GoogleTest and your project with Visual Studio, enable `gtest_force_shared_crt` in CMake to avoid runtime library conflicts.
</Accordion>
</AccordionGroup>

---

## 5. Additional Configuration Tips

- **Disable building GoogleTest tests if embedding as submodule:**
  Set `gtest_build_tests` option to `OFF` to reduce build times.

```cmake
set(gtest_build_tests OFF CACHE BOOL "" FORCE)
```

- **Customized `main()` function:**
  If you need to write custom code before or after running tests, link against `gtest` instead of `gtest_main` and provide your own `main()`.

- **Building Shared vs Static Libraries:**
  GoogleTest defaults to static libs. Use `-DBUILD_SHARED_LIBS=ON` with CMake for shared libraries.

---

## 6. Summary

By following these steps, you will have properly configured your project to build and run tests using GoogleTest:

- Integrated GoogleTest using modern CMake practices.
- Linked your test binaries with `gtest_main` to avoid writing your own `main()`.
- Organized test source files sensibly to maintain clean project structure.
- Handled common platform-specific issues and build system nuances.

For more advanced integration and customization guidance, see the [Using GoogleTest and GoogleMock in Your Build System](https://github.com/google/googletest/blob/main/docs/guides/real-world-integration/using-google-test-in-your-build-system.md) guide.

---

## Related Documentation & Resources

- [GoogleTest Primer](../primer.md): Learn to write tests using GoogleTest.
- [Quickstart: Building with CMake](../quickstart-cmake.md): Beginner-friendly CMake setup tutorial.
- [Writing Your First Test](../first-test-run-validation/writing-your-first-test.md): Step-by-step test authoring.
- [Building and Running Tests](../first-test-run-validation/building-and-running-tests.md): Executing your tests after setup.
- [Troubleshooting Common Setup Issues](../troubleshooting-faq-support/common-setup-errors.md): Fix typical build and configuration problems.

---

## Support and Next Steps

- After successful configuration, start writing tests and running them regularly to improve code quality.
- Explore parameterized tests and mocks to extend your testing capabilities.
- Engage with the community or browse issue trackers if you encounter persistent configuration challenges.

With this guide, you are fully equipped to configure your project to leverage the powerful testing capabilities of GoogleTest efficiently and reliably.