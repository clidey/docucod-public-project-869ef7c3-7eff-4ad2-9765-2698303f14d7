---
title: "Installing with CMake"
description: "Guides users through installing GoogleTest using CMake, the primary and recommended build system. Presents clear, reproducible commands for fetching, building, and integrating GoogleTest into C++ projects, reducing time to first test."
---

# Installing with CMake

This guide walks you through installing and integrating GoogleTest using CMakeâ€”the recommended build system for GoogleTest. By following the steps below, you'll quickly fetch, build, and link GoogleTest into your C++ projects, enabling effective unit testing with minimal setup.

---

## 1. Prerequisites & System Requirements

Before beginning, ensure your environment meets these requirements:

- **Operating System:** Linux, macOS, or Windows (supported platforms).
- **Compiler:** A C++ compiler compatible with C++17 or later (e.g., GCC, Clang, MSVC).
- **Build Tools:** 
  - [CMake](https://cmake.org/) version 3.14 or higher.
  - A build tool such as [Make](https://www.gnu.org/software/make/), [Ninja](https://ninja-build.org/), or native build systems (Visual Studio, Xcode).

If CMake is not installed, please install it by following the official [CMake installation guide](https://cmake.org/install).

<Tip>
Although the command examples use Unix shell syntax, the instructions are also valid for Windows command prompt.
</Tip>

---

## 2. Setting Up Your Project with GoogleTest Using CMake

To start, create a project directory and configure `CMakeLists.txt` to fetch and build GoogleTest automatically.

### Step 1: Create Project Directory

Open a terminal and run:

```sh
mkdir my_project && cd my_project
```

### Step 2: Create `CMakeLists.txt` with GoogleTest Dependency

In the `my_project` directory, create a `CMakeLists.txt` file with the following content:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

# GoogleTest requires at least C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)
# For Windows: Prevent overriding the parent project's compiler/linker settings
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
FetchContent_MakeAvailable(googletest)
```

This setup uses CMake's `FetchContent` module to download a specific version of GoogleTest directly from GitHub. The commit hash used here (`03597a01ee50ed33e9dfd640b249b4be3799d395`) locks the version; update it regularly for the latest fixes.

<Tip>
If you are on Windows, the `gtest_force_shared_crt` flag ensures GoogleTest uses the same runtime library as your project to avoid linking errors.
</Tip>

---

## 3. Creating and Running Your First Test

With GoogleTest added as a dependency, you can now write and run your first test executable.

### Step 1: Write a Basic Test Source File

Create a file named `hello_test.cc` inside `my_project` with the following content:

```cpp
#include <gtest/gtest.h>

// Demonstrate some basic assertions.
TEST(HelloTest, BasicAssertions) {
  // Expect two strings not to be equal.
  EXPECT_STRNE("hello", "world");
  // Expect equality.
  EXPECT_EQ(7 * 6, 42);
}
```

This test includes the core GoogleTest header and demonstrates simple assertions to validate code behavior.

### Step 2: Extend `CMakeLists.txt` to Build and Link the Test

Append the following to your `CMakeLists.txt`:

```cmake
enable_testing()

add_executable(
  hello_test
  hello_test.cc
)
target_link_libraries(
  hello_test
  GTest::gtest_main
)

include(GoogleTest)
gtest_discover_tests(hello_test)
```

This configures CMake to:

- Enable testing features.
- Compile `hello_test.cc` into an executable.
- Link the executable against the GoogleTest main library.
- Automatically discover test cases for CTest.

---

## 4. Building and Running Tests

You are now ready to build and run your GoogleTest tests.

### Step 1: Configure the Build

In your project root, run the following:

```sh
cmake -S . -B build
```

This generates build files in the `build` directory.

**Expected Outcome:** Log output indicating compilers detected and build files generated.

### Step 2: Build the Test Binary

Run:

```sh
cmake --build build
```

This compiles GoogleTest and your `hello_test` executable.

**Expected Outcome:** Compilation succeeds without errors.

### Step 3: Run Tests Using CTest

Navigate to the build directory and run tests:

```sh
cd build && ctest
```

You should see output similar to:

```
Test project /path/to/my_project/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1

Total Test time (real) =   0.01 sec
```

Congratulations! Your first GoogleTest test has built and run successfully.

---

## 5. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Common Setup Issues">
<Accordion title="CMake Version Too Low">
If you encounter errors about unknown commands like `FetchContent_MakeAvailable`, ensure you have CMake version 3.14 or greater by running `cmake --version`.
Upgrade CMake if necessary from https://cmake.org/install.
</Accordion>
<Accordion title="Compiler Does Not Support C++17">
Verify your compiler supports C++17 by compiling a simple program with `-std=c++17` (or the equivalent flag).
Update your compiler if it lacks support (e.g., older GCC or MSVC versions).
</Accordion>
<Accordion title="Linker Errors on Windows">
Set `gtest_force_shared_crt` to `ON` in your `CMakeLists.txt` to align runtime library usage.
Example:
```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```
This avoids conflicts between static and dynamic runtime linkage.
</Accordion>
<Accordion title="Tests Not Discovered When Running ctest">
Check that `include(GoogleTest)` and `gtest_discover_tests()` are properly defined in your `CMakeLists.txt`.
Ensure tests are named according to GoogleTest conventions (e.g., using `TEST` macros).
</Accordion>
</AccordionGroup>

---

## 6. Next Steps

- Explore [Writing and Running Your First Test](../configuration-validation/write-and-run-first-test) for deeper test authoring guidance.
- Review [GoogleTest Primer](../../primer.md) to understand assertions and test writing best practices.
- Check out [Samples and Examples](../../samples.md) to see advanced testing features.

---

## Additional Resources

- [CMake Official Documentation - FetchContent](https://cmake.org/cmake/help/latest/module/FetchContent.html)
- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Installing CMake](https://cmake.org/install)
- [Supported Platforms](platforms.md)

---

By integrating GoogleTest with CMake as described, you establish a robust foundation for writing and running unit tests within your C++ projects efficiently and effectively.