---
title: "Installation (CMake & Bazel)"
description: "Step-by-step instructions to install GoogleTest using CMake or Bazel, the primary supported build systems. Covers fetching sources, building the framework, and integrating it into your project for seamless usage."
---

# Installation (CMake & Bazel)

This guide provides step-by-step instructions to install GoogleTest using its primary supported build systems: **CMake** and **Bazel**. It covers fetching the source code, building the framework, and integrating it into your project so you can start writing and running tests efficiently.

---

## 1. Prerequisites

Before installing GoogleTest, ensure your system meets these requirements:

- **Operating System**: Linux, Windows, or macOS supported.
- **Compiler**: A C++17 compatible compiler (e.g., GCC 7+, Clang 5+, MSVC 2017+).
- **Build tools**:
  - For CMake installation: [CMake](https://cmake.org/) version 3.14 or later.
  - For Bazel installation: [Bazel](https://bazel.build/) version compatible with your platform.
- **Git**: To clone the GoogleTest repository.

<Tip>Make sure your compiler supports C++17 as GoogleTest requires it. You can verify by running `g++ --version` or equivalent.</Tip>

---

## 2. Installing GoogleTest with CMake

### 2.1 Clone the Repository

Start by cloning the GoogleTest source:

```bash
git clone https://github.com/google/googletest.git -b main
googletest
cd googletest
```

This clones the latest GoogleTest source into the `googletest` directory.

### 2.2 Create a Build Directory

Separate source and build artifacts by creating a build folder:

```bash
mkdir build
cd build
```

### 2.3 Configure the Build with CMake

Run CMake to configure the build and generate the proper native build files:

```bash
cmake ..
```

By default, this will build **both GoogleTest and GoogleMock**.

If you want to build only GoogleTest, disable GoogleMock explicitly:

```bash
cmake .. -DBUILD_GMOCK=OFF
```

### 2.4 Build GoogleTest

Use your platform's standard build command:

- On Linux/macOS:

  ```bash
  make
  ```

- On Windows (Visual Studio):

  Open the generated `.sln` file in Visual Studio and build the solution.

- On macOS with Xcode:

  Open the `.xcodeproj` file and build.

### 2.5 Optional: Install GoogleTest System-wide

If you have the necessary permissions and want to install GoogleTest libraries and headers to your system include and lib directories, run:

```bash
sudo make install
```

This installs files typically to `/usr/local/include` and `/usr/local/lib`.

<Tip>If you install system-wide, your projects can find GoogleTest via `find_package(GTest CONFIG REQUIRED)` in CMake.</Tip>

### 2.6 Integrate GoogleTest into Your Project

**Recommended ways to use GoogleTest in your projects:**

- **Link to installed GoogleTest targets:** If installed, use CMake's `find_package(GTest CONFIG REQUIRED)` and link against targets `GTest::gtest` or `GTest::gtest_main`.

- **Add GoogleTest as a dependency using FetchContent:**

  In your `CMakeLists.txt`:

  ```cmake
  include(FetchContent)
  FetchContent_Declare(
    googletest
    URL https://github.com/google/googletest/archive/main.zip
  )
  FetchContent_MakeAvailable(googletest)

  add_executable(my_tests test.cpp)
  target_link_libraries(my_tests GTest::gtest_main)
  add_test(NAME my_tests COMMAND my_tests)
  ```

- **Add GoogleTest source as a subdirectory:**

  Clone GoogleTest source inside your project and do:

  ```cmake
  add_subdirectory(path/to/googletest)
  target_link_libraries(my_tests gtest_main)
  ```

_<Note> Linking with `gtest_main` provides a ready-to-use main() function for your test program, so you don't have to write your own unless custom initialization is needed.</Note>_

---

## 3. Installing GoogleTest with Bazel

GoogleTest also supports Bazel for those preferring Bazel as their build system.

### 3.1 Fetch the Repository

Clone or include GoogleTest sources in your Bazel workspace.

### 3.2 Add gtest to Your Workspace

In your workspace `WORKSPACE` file, add:

```python
http_archive(
    name = "com_google_googletest",
    urls = ["https://github.com/google/googletest/archive/main.zip"],
    strip_prefix = "googletest-main",
)
```

### 3.3 Declare gtest in BUILD Files

In your `BUILD` file:

```python
cc_test(
    name = "my_test",
    srcs = ["my_test.cc"],
    deps = ["@com_google_googletest//:gtest_main"],
)
```

### 3.4 Build and Run Tests

Build and run your tests using Bazel:

```bash
bazel test //:my_test
```

_Bazel handles dependencies, compilation, and test execution automatically._

---

## 4. Verifying Your Installation

After building and linking GoogleTest, verify it works by compiling and running a minimal test:

Create `sample_test.cpp`:

```c++
#include <gtest/gtest.h>

TEST(SampleTest, AssertionTrue) {
  EXPECT_TRUE(true);
}

int main(int argc, char **argv) {
  testing::InitGoogleTest(&argc, argv);
  return RUN_ALL_TESTS();
}
```

Compile (example for CMake projects with GoogleTest installed):

```bash
g++ sample_test.cpp -lgtest_main -lpthread -o sample_test
./sample_test
```

Expected output:

```
[==========] Running 1 test from 1 test suite.
[----------] Global test environment set-up.
[----------] 1 test from SampleTest
[ RUN      ] SampleTest.AssertionTrue
[       OK ] SampleTest.AssertionTrue (0 ms)
[----------] 1 test from SampleTest (0 ms total)
[----------] Global test environment tear-down
[==========] 1 test from 1 test suite ran. (0 ms total)
[  PASSED  ] 1 test.
```

If you see this output, GoogleTest is installed and functioning properly.

---

## 5. Tips & Best Practices

- **Use `gtest_main` for convenience**: It ships with an implemented `main()`, so you don't have to write one.
- **Isolate tests in separate test suites**: Organize logically related tests using `TEST()` or `TEST_F()` macros.
- **Keep dependencies consistent**: When integrating GoogleTest into your build system, ensure compiler and linker options remain compatible.
- **Enable thread-safe mode if needed**: GoogleTest detects pthreads automatically but you can force it with `-DGTEST_HAS_PTHREAD=1`.
- **For Windows users**: If you encounter runtime library conflicts, try using `-Dgtest_force_shared_crt=ON` in CMake.

<Tip>Linking with shared or static runtimes on MSVC can cause linker errors; the `gtest_force_shared_crt` CMake option helps align runtimes between your project and GoogleTest.</Tip>

---

## 6. Troubleshooting Common Issues

<AccordionGroup title="Common Installation Problems">
<Accordion title="Missing pthreads linkage on Linux">
On Linux, if you get undefined references to pthread functions:
- Ensure you link with `-lpthread`.
- Using the provided CMake build takes care of this automatically.
- If manual build happens, add `-pthread` compiler and linker flags.
</Accordion>
<Accordion title="Runtime Library Mismatch on Windows">
You might see linker errors about runtime library mismatch.
- This is typically because your project and GoogleTest are linking different runtimes (static vs dynamic).
- Use `-Dgtest_force_shared_crt=ON` when configuring GoogleTest with CMake to fix this.
- Alternatively, align your project's runtime linking with GoogleTest's.
</Accordion>
<Accordion title="C++17 Compatibility Errors">
Compiler errors about language standards typically mean your compiler is older than required.
- GoogleTest needs C++17 support.
- Upgrade your compiler to a version supporting C++17 and ensure you set the compiler flag (e.g., `-std=c++17`).
</Accordion>
<Accordion title="Linker errors: Undefined references to GoogleTest symbols">
This often means GoogleTest libraries are not linked properly.
- Ensure your linker command includes `-lgtest` or `-lgtest_main`, depending on usage.
- For CMake users, link to `GTest::gtest` or `GTest::gtest_main` targets.
- Confirm installation paths if using system-installed GoogleTest.
</Accordion>
</AccordionGroup>

---

## 7. Next Steps

- Write and run your first tests — see the [GoogleTest Primer](overview/getting-started/product-intro#google-test-primer).
- Explore advanced testing features like fixtures, parameterized tests, and custom assertions.
- For mocking support, consider integrating with GoogleMock — see the [GoogleMock documentation](https://github.com/google/googletest/tree/main/googlemock).
- Learn build system integration best practices in the Integration Points guide.

---

## 8. References

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [GoogleTest Primer](overview/getting-started/product-intro#google-test-primer)
- [CMake Documentation](https://cmake.org/cmake/help/latest/)
- [Bazel Documentation](https://bazel.build/)
- [GoogleMock Build and Usage](googlemock/CMakeLists.txt)

---

**Enjoy writing better tests with GoogleTest!**
