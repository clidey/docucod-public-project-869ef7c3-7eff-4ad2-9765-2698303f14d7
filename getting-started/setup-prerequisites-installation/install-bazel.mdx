---
title: "Installation Using Bazel"
description: "Step-by-step instructions to add GoogleTest as a dependency in Bazel projects, configure tests, and validate setup. Ideal for teams leveraging Bazel for scalable C++ builds. Detailed configuration examples ensure reliable installation across different codebases."
---

# Installation Using Bazel

Get up and running with GoogleTest in Bazel-managed C++ projects using this step-by-step guide. Perfect for teams leveraging Bazel's scalable build system, this page walks you through adding GoogleTest as a dependency, configuring tests, and validating your setup with clear examples and troubleshooting tips.

---

## 1. Prerequisites & Environment Setup

Before integrating GoogleTest with Bazel, ensure the following:

- **Supported Platforms:** Linux, macOS, Windows (see [Supported Platforms](../setup-prerequisites-installation/system-requirements-supported-platforms.md)).
- **Compiler Requirements:** A C++ compiler supporting at least C++17.
- **Bazel Version:** Bazel 7.0 or higher installed and configured. For details, visit [Bazel Installation Guide](https://bazel.build/install).

<Tip>
Make sure Bazel is added to your system's PATH so you can run `bazel` commands from your terminal or command prompt.
</Tip>

---

## 2. Setting Up Your Bazel Workspace

A Bazel workspace is a directory containing your source files and build configuration.

<Steps>
<Step title="Create Workspace Directory">
Open your terminal and create a new directory for your workspace, then navigate into it:

```bash
mkdir my_workspace && cd my_workspace
```
</Step>
<Step title="Add MODULE.bazel for Dependency Management">
Create a file named `MODULE.bazel` in the root of your workspace with the following content:

```python
# MODULE.bazel

# Always check for the latest version at https://registry.bazel.build/modules/googletest
bazel_dep(name = "googletest", version = "1.17.0")
```
This enables consuming GoogleTest via Bazel Central Registry, ensuring stable, version-controlled dependencies.
</Step>
</Steps>

<Note>
If your project already uses a `WORKSPACE` file instead of `MODULE.bazel`, consider migrating to `MODULE.bazel` for Bazelâ€™s module system. If not, you can add GoogleTest dependencies via `WORKSPACE`, but the recommended way is via `MODULE.bazel`.
</Note>

---

## 3. Adding Your First GoogleTest-Based Test

You are now ready to create and run a simple test using GoogleTest.

<Steps>
<Step title="Create a Test Source File">
Create a file named `hello_test.cc` inside your workspace directory with the following content:

```cpp
#include <gtest/gtest.h>

// A simple test case.
TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world"); // Strings should not be equal.
  EXPECT_EQ(7 * 6, 42);              // Numeric equality check.
}
```
This test demonstrates some basic GoogleTest assertions.
</Step>

<Step title="Create a BUILD file">
Adjacent to your test source, create a `BUILD` file to build the test binary:

```python
cc_test(
    name = "hello_test",
    size = "small",
    srcs = ["hello_test.cc"],
    deps = [
        "@googletest//:gtest",
        "@googletest//:gtest_main",
    ],
)
```
This defines a test target that links your test with GoogleTest's libraries.
</Step>
</Steps>

---

## 4. Building and Running Tests

Build your test binary and run the tests in one command:

```bash
bazel test --cxxopt=-std=c++17 --test_output=all //:hello_test
```

**Expected output includes:**

- Bazel analyzing and building the target.
- GoogleTest running the test suite with results.
- Confirmation that the test passed.

<Check>
Ensure you use `--cxxopt=-std=c++17` (for GCC/Clang) or the equivalent for MSVC `--cxxopt=/std:c++17` to enforce the correct C++ standard required by GoogleTest.
</Check>

<Tip>
If your build or test fails with linker errors, double-check the `deps` in your `BUILD` file. Your test must link against both `@googletest//:gtest` and `@googletest//:gtest_main`.
</Tip>

---

## 5. Configuring Advanced Bazel Options (Optional)

For large projects or CI pipelines, controlling Bazel flags improves consistency and reliability.

Here are key options to consider when running tests:

- `--enable_bzlmod=true`: Enables Bazel's module system.
- `--keep_going`: Continues building other targets even if some fail.
- `--test_output=errors`: Displays output only on test failures.
- `--test_tag_filters`: Use to exclude incompatible tests (e.g., `-no_test_msvc2017` on Windows).

Example command integrating these flags:

```bash
bazel test --cxxopt=-std=c++17 --enable_bzlmod=true --keep_going --test_output=errors //:hello_test
```

---

## 6. Verification and Troubleshooting

If your test runs and passes, your installation is successful.

Otherwise, check these common issues:

<AccordionGroup title="Troubleshooting Common Bazel + GoogleTest Issues">
<Accordion title="Test Binary Fails to Compile or Link">
- Verify your `BUILD` file includes both `@googletest//:gtest` and `@googletest//:gtest_main` in `deps`.
- Confirm your compiler supports C++17 and Bazel is passing the correct flags (`--cxxopt=-std=c++17`).
- On Windows, watch for runtime library mismatch errors. Consider checking compiler runtime settings.
</Accordion>

<Accordion title="Bazel Can't Find GoogleTest Module or Rules">
- Ensure your `MODULE.bazel` file is in place and correctly references the googletest Bazel Central Registry dependency.
- If you're still using `WORKSPACE` without `MODULE.bazel`, you may need to update your Bazel version or configuration.
</Accordion>

<Accordion title="Tests Are Not Detected or Run by Bazel">
- Confirm your test target uses the `cc_test` rule, not `cc_binary`.
- Ensure the test source includes `#include <gtest/gtest.h>`.
- Check usage of `@googletest//:gtest_main` to provide `main()` entry point.
</Accordion>
</AccordionGroup>

<Tip>
Use `bazel test --test_output=all` to see all test logs for better diagnosis in case of failures.
</Tip>

---

## 7. Next Steps

- Explore the [GoogleTest Primer](../../overview/integration-and-getting-started/quickstart-resources.md#primer) to learn writing advanced tests.
- Review [Integration with Build Systems and Tools](../../overview/integration-and-getting-started/integration-with-build-systems-and-tools.md) for CI pipeline setup and best practices.
- Check out [Writing and Running Your First Test](../configuration-and-validation/writing-your-first-test.md) for test design guidance.

---

## Summary Diagram: Bazel Integration Workflow

```mermaid
flowchart TD
  A[Create Bazel Workspace Directory] --> B[Add MODULE.bazel with googletest dependency]
  B --> C[Create Test Source File (hello_test.cc)]
  C --> D[Create BUILD File with cc_test rule]
  D --> E[Run Bazel Test Command]
  E --> F{Test Passes?}
  F -- Yes --> G[Celebrate: GoogleTest Setup Successful]
  F -- No --> H[Troubleshoot Using Common Issues]
```

---

This guide empowers you to confidently set up GoogleTest in Bazel-based environments with minimal friction, focusing on straightforward steps toward reliable test integration.


---

# References

- [GoogleTest Bazel Quickstart Tutorial](../docs/quickstart-bazel.md)
- [GoogleTest Core Concepts](../../overview/architecture-and-core-concepts/core-concepts-and-terminology.md)
- [Supported Platforms & System Requirements](../setup-prerequisites-installation/system-requirements-supported-platforms.md)
- [Integration with Build Systems and Tools](../../overview/integration-and-getting-started/integration-with-build-systems-and-tools.md)



