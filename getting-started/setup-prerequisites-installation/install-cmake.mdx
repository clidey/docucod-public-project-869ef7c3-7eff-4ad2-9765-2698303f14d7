---
title: "Installation Using CMake"
description: "Learn how to install and add GoogleTest to your C++ projects with CMake. Step through cloning, configuring, and building GoogleTest using modern CMake best practices. Includes guidance for integrating with your project's CMakeLists.txt for seamless developer experience."
---

# Installation Using CMake

Learn how to install and integrate GoogleTest into your C++ projects using CMake. This guide walks you through cloning the source, configuring the build environment, compiling, and linking GoogleTest with your projects following modern CMake best practices.

---

## 1. Prerequisites & System Requirements

- **Operating System Support:** Linux, macOS, Windows
- **C++ Compiler:** Must support at least C++17 standard
- **CMake Version:** Minimum 3.13 for basic builds, 3.14+ recommended especially for FetchContent integration
- **Build Tools:** Make, Ninja, Visual Studio, or any CMake-supported generators

<Tip>
Ensure your compiler and development environment support C++17, as GoogleTest requires it for successful builds.
You can specify this explicitly in your `CMakeLists.txt` with `set(CMAKE_CXX_STANDARD 17)`.
</Tip>

---

## 2. Cloning and Building GoogleTest Standalone

You can build GoogleTest as a standalone project to install or verify your build environment.

### Step-by-step:

<Steps>
<Step title="Clone the GoogleTest Repository">

Run the following commands in your terminal:

```bash
$ git clone https://github.com/google/googletest.git -b v1.17.0
download latest stable tag if needed
$ cd googletest
```

This fetches the source code tagged at version 1.17.0. You can choose to replace this tag with the latest commit or release.

</Step>

<Step title="Create and Navigate to Build Directory">

Create a separate directory for build artifacts to keep your source tree clean:

```bash
$ mkdir build
$ cd build
```

</Step>

<Step title="Configure the Build with CMake">

Generate build files for your platform and environment:

```bash
$ cmake ..
```

> This runs CMake to generate native build configurations.

**Optional:** To build only GoogleTest (no GoogleMock), use:

```bash
$ cmake .. -DBUILD_GMOCK=OFF
```

</Step>

<Step title="Build the Libraries">

Run the native build system to compile GoogleTest:

```bash
$ make
```

On Windows, open the generated `.sln` file with Visual Studio and build.

</Step>

<Step title="(Optional) Install GoogleTest">

Installing copies the headers and libraries to system directories (usually `/usr/local`):

```bash
$ sudo make install
```

This step is recommended when you want GoogleTest available system-wide.

</Step>
</Steps>

---

## 3. Incorporating GoogleTest into Your Existing CMake Project

Rather than installing globally, you can embed GoogleTest directly into your project to align compiler and linker settings and simplify CI workflows.

### Method 1: Using FetchContent (Recommended)

Add the following to your `CMakeLists.txt`:

```cmake
cmake_minimum_required(VERSION 3.14)
project(your_project_name)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip
)

# For Windows: Prevent overriding the parent's compiler/linker settings
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)

FetchContent_MakeAvailable(googletest)

# Define your test executable
add_executable(your_test_executable your_test.cc)

# Link to GoogleTest libraries
target_link_libraries(your_test_executable GTest::gtest_main)

# Enable CTest integration
enable_testing()
include(GoogleTest)
gtest_discover_tests(your_test_executable)
```

<Tip>
Update the URL hash regularly to the latest commit or release tag for the most up-to-date GoogleTest.
</Tip>

### Explanation:

- `FetchContent` downloads and builds GoogleTest as part of your project
- `gtest_force_shared_crt` makes Visual Studio use the shared runtime to avoid linkage conflicts
- Linking against `GTest::gtest_main` provides a main() function for your tests
- `gtest_discover_tests` enables automatic test discovery for CTest

---

## 4. Creating a Simple Test Example

Create a file named `hello_test.cc` with the following contents:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

This basic test verifies string non-equality and arithmetic equality.

---

## 5. Building and Running Tests in Your Project

### Build your project:

```bash
cmake -S . -B build
cmake --build build
```

This configures and builds your project including GoogleTest.

### Run tests:

```bash
cd build
ctest
```

You should see output similar to:

```
Test project /path/to/my_project/build
    Start 1: HelloTest.BasicAssertions
1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec

100% tests passed, 0 tests failed out of 1
```

<Tip>
On Windows, run tests from the Visual Studio Test Explorer or via the command line as appropriate.
</Tip>

---

## 6. Best Practices & Troubleshooting

### Best Practices

- Use `FetchContent` to avoid managing GoogleTest separately and ensure compiler/linker settings match.
- Specify C++17 or newer globally in your project.
- Enable `gtest_force_shared_crt` on Windows if using Visual Studio to avoid runtime conflicts.
- Use `gtest_discover_tests()` for seamless integration with CTest and continuous integration.

### Common Issues

- **Build fails due to compiler incompatibility:** Verify your compiler supports at least C++17.
- **Linker errors on Windows for runtime libraries:** Enable `gtest_force_shared_crt` option.
- **Tests not discovered by CTest:** Make sure `include(GoogleTest)` and `gtest_discover_tests()` are called after adding your test executable.
- **`make` command not found on Windows:** Use Visual Studio or Ninja generator for CMake.

<Tip>
If installation paths or pkg-config files are not found after installation, set environment variables like `PKG_CONFIG_PATH` accordingly (especially on Linux).
</Tip>

---

## 7. Additional Resources & Next Steps

- Explore the **[Writing and Running Your First Test](../configuration-and-validation/writing-your-first-test)** guide to learn test authoring.
- Review the **[System Requirements & Supported Platforms](../setup-prerequisites-installation/system-requirements-supported-platforms)** document to verify compatibility.
- Visit the official CMake documentation on [FetchContent](https://cmake.org/cmake/help/latest/module/FetchContent.html) for advanced dependency management.
- Consult the [GoogleTest Primer](../overview/integration-and-getting-started/quickstart-resources#primer) to deepen your understanding of testing patterns.

---

By following this guide, you have successfully added GoogleTest to your C++ project with CMake and run your first tests. This setup fosters a smooth, maintainable testing workflow that integrates tightly into your build system.

<Source url="https://github.com/google/googletest" branch="main" paths={[{"path": "googletest/README.md", "range": "8-140"},{"path": "docs/quickstart-cmake.md", "range": "1-83"}]} />
