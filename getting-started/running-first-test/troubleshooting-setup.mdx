---
title: "Troubleshooting Common Setup Issues"
description: "Addresses frequent problems new users might encounter, such as compiler errors, missing dependencies, or linking issues. Provides actionable solutions and directs users to additional resources for deeper troubleshooting."
---

# Troubleshooting Common Setup Issues

This page guides you through the frequent problems new users encounter when setting up GoogleTest and GoogleMock, such as compiler errors, missing dependencies, and linking issues. You will find actionable solutions and pointers to additional resources for deeper troubleshooting.

---

## 1. Addressing Compiler Errors

Compiler errors often arise from missing or incorrect mock method declarations, improper includes, or incompatibilities in your build environment.

### Common Causes & Solutions

- **Missing `#include <gmock/gmock.h>`**
  - Always include the GoogleMock header in your test files using mocks.

- **Incorrect `MOCK_METHOD` usage**
  - Ensure you correctly declare mock methods:
  ```cpp
  class MockClass : public RealClass {
   public:
    MOCK_METHOD(return_type, method_name, (arg_types), (qualifiers));
  };
  ```
  - Wrap complex return or argument types containing commas in additional parentheses or use type aliases.

- **Mocking Non-Virtual Methods**
  - GoogleMock mocks only virtual methods by default. For non-virtual methods, consider template-based dependency injection or redesign your interface.

- **Overloaded methods conflict**
  - Mock each overload explicitly and use `using` declarations to avoid hiding.


### Sample Correct MOCK_METHOD Declaration
```cpp
class MockFoo : public Foo {
 public:
  MOCK_METHOD(int, Bar, (int x), (override));
  MOCK_METHOD(void, Baz, (std::string s), (const, override));
};
```

### Troubleshooting Tips
- Verify your mock methods are declared in the public section, even if the base method is protected or private.
- Remove top-level `const` qualifiers on parameters; they are ignored and may cause compiler warnings.
- Ensure your compiler supports C++17, required by GoogleTest/GoogleMock.

<Warning>
Compiler warnings C4301 and C4373 on MSVC are commonly caused by const qualifications on parameters.
We recommend removing the top-level const qualifier on such parameters to resolve this.
</Warning>

---

## 2. Resolving Missing Dependencies

GoogleTest and GoogleMock require a compliant C++17 compiler and depend on certain libraries and build tools.

### Prerequisites

- **C++17 Support**: Confirm your compiler supports C++17 features.
- **Standard Library**: Ensure your standard C++ library is updated (libstdc++ or libc++).
- **Build Tools**: CMake or Bazel installed and configured.
- **Repository Setup**: Cloned googletest repository should be complete.

### Common Dependency Issues
- Missing or outdated compiler.
- Incorrect or incomplete inclusion of header files.
- GoogleMock requires linking with `gmock` and `gtest` libraries appropriately.

### Action Steps

1. Confirm compiler version supports C++17.
2. Ensure `#include <gmock/gmock.h>` and `#include <gtest/gtest.h>` are present.
3. Link your test binaries with GoogleTest and GoogleMock libraries:

#### Example CMake snippet for linking:
```cmake
find_package(GTest REQUIRED)
find_package(GMock REQUIRED)

add_executable(MyTest test_file.cc)
target_link_libraries(MyTest GTest::GTest GMock::GMock pthread)
```

4. For Bazel, declare appropriate dependencies as documented in installation guides.

<Note>
If you use separate static libraries for GoogleTest and GoogleMock, link them both in your build.
</Note>

---

## 3. Fixing Linking Issues

Linker errors often occur due to missing library files or incorrect linkage order.

### Symptoms

- Undefined reference to GoogleTest or GoogleMock symbols.
- Missing symbols for mock methods or test runners.

### Solutions

- Confirm linking against both `libgmock` and `libgtest` libraries.
- Order of linkage matters; list GoogleMock before GoogleTest.
- Include pthread (on Linux) or appropriate threading libraries.
- For Windows MSVC builds, ensure corresponding `.lib` files are linked.

### Typical Link Command Example (Linux):
```
g++ -std=c++17 -o my_tests test_main.o my_tests.o -lgmock -lgtest -lpthread
```

### Troubleshooting
- Check verbose build output to verify the linker is receiving correct library paths.
- Confirm library search paths include GoogleTest/GoogleMock libraries.
- If using CMake, ensure `target_link_libraries` is correctly set.

<Warning>
If you receive errors about missing symbols for mock methods:
- Ensure mock classes are fully defined and included in the build.
- Ensure constructors and destructors of mock classes are implemented or declared properly (preferably defined outside header). Refer to the mock compilation tips.
</Warning>

---

## 4. Practical Tips and Best Practices

- **Use `NiceMock` to suppress warnings about uninteresting calls**
  - If you see "Uninteresting mock function call" warnings that are not a concern, consider using `NiceMock<YourMockClass>`.

- **Set expectations before invoking mock methods**
  - Always call `EXPECT_CALL` *before* exercising the code that makes calls to mocked methods.

- **Use `ON_CALL` to define default behaviors without enforcing call counts**
  - This avoids overly constraining your tests.

- **Check `gmock` verbose flags for debugging**
  - Run tests with `--gmock_verbose=info` to get detailed mock call trace.

- **Use `RetiresOnSaturation()` on expectations for sequences**
  - Prevents errors from sticky expectations when repeated calls are involved.

- **For slow compilation**
  - Define mock class constructors and destructors in `.cc` files instead of inline.

- **Verify expectations at the right time**
  - Use `Mock::VerifyAndClearExpectations(&mock_obj)` if mock object lifetime is managed externally.

---

## 5. Additional Resources

- [GoogleMock CookBook](https://google.github.io/googletest/gmock_cook_book.html): Practical usage patterns and advanced techniques.
- [Legacy gMock FAQ](https://google.github.io/googletest/gmock_faq.html): Answers common questions and detailed troubleshooting.
- [gMock Cheat Sheet](https://google.github.io/googletest/gmock_cheat_sheet.html): Quick reference for commands and macros.
- [Integration and Ecosystem Overview](/overview/architecture-concepts/integration-and-extensions): Build system integration and CI/CD pipeline guidance.

<Callout title="Pro Tip">
For deeper issues with mocking and linkage, review the mock class definitions and ensure all virtual methods are mocked correctly, especially with proper `MOCK_METHOD` syntax.
</Callout>

---

## Summary
This troubleshooting guide clarifies how to overcome common compiler errors, missing dependency problems, and linking issues when setting up GoogleTest and GoogleMock. Following these recommendations will ensure a smooth setup and robust test builds.

---