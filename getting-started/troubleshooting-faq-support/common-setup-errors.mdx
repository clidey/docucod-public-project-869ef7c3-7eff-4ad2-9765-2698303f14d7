---
title: "Troubleshooting Common Setup Issues"
description: "Lists frequent errors users may face during installation, configuration, or first runs, with actionable fixes. Covers problems with linking, missing symbols, incompatible compilers, and bad outputs."
---

# Troubleshooting Common Setup Issues

This page helps you diagnose and resolve frequent errors that occur during installation, configuration, or running your first tests with GoogleMock and GoogleTest. You will find actionable solutions for linker problems, missing symbols, compiler incompatibilities, and unexpected runtime outputs.

---

## 1. Linking Errors and Missing Symbols

Linker errors often indicate incorrect project configuration or missing library references. Here's how to address common linking issues:

### Symptoms

- Errors about undefined references to GoogleMock or GoogleTest functions.
- Missing symbols related to mock or test classes.
- Linker fails to find `InitGoogleMock` or main test runner.

### Diagnostics & Fixes

1. **Verify Library Inclusion:**
   - Ensure `libgmock.a` (or the equivalent static/shared library) and `libgtest.a` are built and linked correctly.
   - If using CMake, confirm `target_link_libraries(your_test PRIVATE gmock gtest)` is present.

2. **Correct Include Paths:**
   - Check that your compiler includes the headers from `googletest/include/` and `googlemock/include/`.

3. **Match Compiler and ABI:**
   - Use the same compiler and settings for GoogleMock and your project to avoid ABI incompatibilities.

4. **Provide a Main Function:**
   - Use the default main provided by `gmock_main.cc` or define your own that calls `testing::InitGoogleMock()` and `RUN_ALL_TESTS()`.

5. **Check Build Configuration:**
   - For Bazel users, add `deps = ["@com_google_googletest//:gmock_main"]` for test targets.

### Example Fix

For CMake projects, your CMakeLists.txt test target should look like:

```cmake
add_executable(my_tests test.cpp)
target_link_libraries(my_tests PRIVATE gmock_main)
```

<Tip>
Always clean and rebuild your project after adjusting library or include paths to avoid stale build artifacts causing linker errors.
</Tip>

---

## 2. Compiler Compatibility Issues

GoogleMock requires a modern C++17-compliant compiler. Compatibility problems can manifest as build failures or obscure errors.

### Common Symptoms

- Compilation errors referencing unsupported language features.
- Template instantiation failures or ambiguous overload issues.
- Default constructor missing errors on mock classes.

### Resolution Steps

1. **Check Compiler Version:**
   - Ensure use of GCC 7+, Clang 7+, MSVC 2017+ with full C++17 support.

2. **Set Proper Language Standard:**
   - Use compiler flags like `-std=c++17` or `/std:c++17`.

3. **Ensure Threading Support:**
   - For some environments, enable threading (e.g., `-pthread` on GCC/Clang).

4. **Avoid Deprecated or Custom Flags:**
   - Remove legacy or conflicting compiler flags that may inhibit C++17 features.

5. **Template Usage Caveats:**
   - When mocking methods with certain complex types, wrap return or argument types with parentheses or define type aliases to handle commas properly.

### Example

```cpp
class MyMock {
 public:
  MOCK_METHOD((std::pair<bool, int>), GetPair, ());      // Note parentheses
  MOCK_METHOD(bool, CheckMap, ((std::map<int, double>), bool));
};
```

<Note>
GoogleMock's `MOCK_METHOD` macro requires mock methods to reside in the public section, regardless of their original access level.
</Note>

---

## 3. Bad or Unexpected Output During Test Runs

Sometimes your tests compile and link successfully but produce confusing output or unexpected failures.

### Common Problems

- Unexpected warnings about "uninteresting mock function calls".
- Unmatched or excessive calls reported as failures.
- Default return values causing test logic errors.

### Why It Happens

- Uninteresting calls occur when mock methods are invoked without matching `EXPECT_CALL` specifications.
- Strict vs. nice mock behavior affects these warnings or errors.

### Solutions

1. **Use NiceMock to Suppress Warnings:**

   ```cpp
   using ::testing::NiceMock;

   NiceMock<MockFoo> mock_foo;  // suppress uninteresting call warnings
   EXPECT_CALL(mock_foo, DoThis());
   ...
   ```

2. **Use StrictMock to Enforce No Unmatched Calls:**

   ```cpp
   using ::testing::StrictMock;

   StrictMock<MockFoo> mock_foo;  // fails tests on uninteresting calls
   EXPECT_CALL(mock_foo, DoThis());
   ...
   ```

3. **Add Catch-All Expectations for Method Calls:**
   - To allow unexpected calls without triggering errors/warnings.

   ```cpp
   EXPECT_CALL(mock_foo, SomeMethod(_)).Times(::testing::AnyNumber());
   ```

4. **Inspect Arguments in Expectations:**
   - Ensure matchers correctly specify expected calls to avoid mismatches.

5. **Adjust Verbosity for Debugging:**
   - Use flag `--gmock_verbose=info` to get detailed traces of mock function calls.

### Understanding Uninteresting vs Unexpected Calls

- **Uninteresting:** No `EXPECT_CALL` exists for this method call. The warning may occur but is not a failure.
- **Unexpected:** `EXPECT_CALL`s exist but none match the call. This is always an error.

<Tip>
When receiving excessive uninteresting call warnings, prefer switching to `NiceMock` instead of cluttering your tests with catch-all expectations or disabling warnings via hacks.
</Tip>

---

## 4. Common Pitfalls

### Nesting Strictness Modifiers

- Avoid nesting `NiceMock<StrictMock<MockFoo>>` or similar. GoogleMock does not support nested strictness modifiers.

### Mock Methods in Base Classes

- `NiceMock` and `StrictMock` only reliably affect mock methods declared **directly** in the mock class using `MOCK_METHOD`. Methods mocked in base classes may not behave as expected.

### Non-Virtual Destructors

- Ensure mock classes have virtual destructors for correctness when using strictness modifiers.

### Memory Leaks of Mock Objects

- GoogleMock detects leaks. If your mock instances must survive for a long time or are intentionally leaked, use `Mock::AllowLeak(mock_ptr)` to suppress leak warnings.

---

## 5. Troubleshooting Flow

Follow these steps when you encounter setup issues:

<Steps>
<Step title="Confirm environment compatibility">
Check compiler versions and C++17 support.
</Step>
<Step title="Verify installation and linkage">
Confirm GoogleMock and GoogleTest libraries are built and linked properly.
</Step>
<Step title="Review project include paths">
Ensure headers can be found during compilation.
</Step>
<Step title="Inspect mock setup">
Use correct mock class declarations and `EXPECT_CALL` usage.
</Step>
<Step title="Adjust mock strictness">
Use `NiceMock` or `StrictMock` to manage warnings and failures for mock calls.
</Step>
<Step title="Run with verbose output">
Enable `--gmock_verbose=info` to see detailed matching and call logs.
</Step>
</Steps>

---

## 6. Additional Resources

For further help and deep dives, consult:

- [Configuring Projects with GoogleTest](../setup-prerequisites-installation/configuring-projects-with-googletest)
- [Installation: Linux, macOS, and Windows](../setup-prerequisites-installation/installing-on-linux-macos-windows)
- [Writing Your First Test](../first-test-run-validation/writing-your-first-test)
- [Mocking Reference](../../../api-reference/core-testing-apis/mocking-apis)
- [gMock Cookbook](https://google.github.io/googletest/gmock_cook_book.html)

---

## 7. Summary

By carefully configuring your compiler, linking libraries, and structuring mock use with attention to strictness behaviors, you will avoid most common setup hurdles. Use verbose logging and detailed error messages to trace unexpected test behaviors. Remember to use `NiceMock` to suppress benign warnings and `StrictMock` to enforce stricter test correctness.

<Check>
Ensure your build environment uses a C++17 compiler with threading support and that all required GoogleTest and GoogleMock libraries are linked correctly.
</Check>

<Check>
Use explicit `EXPECT_CALL` or `ON_CALL` for methods you expect to be called; manage uninteresting calls with `NiceMock` or catch-all expectations.
</Check>

<Warning>
Avoid nesting strictness modifiers and ensure your mock classes have virtual destructors to prevent undefined behavior.
</Warning>

---

For more information, see the [GoogleMock Mocking Reference](../reference/mocking.md) and [gMock Cookbook](../docs/gmock_cook_book.md).

---

### Example: Resolving a "Linking Error" Missing symbol `InitGoogleMock`

1. Confirm you include `gmock_main` in your link line.

```bash
clang++ -std=c++17 -isystem /path/to/googletest/include \ 
    /path/to/test_file.cc /path/to/libgmock_main.a -o test_binary
```

2. Ensure `InitGoogleMock` is called in your test app main (or provided by `gmock_main`).

3. If using CMake, link using:

```cmake
target_link_libraries(my_test PRIVATE gmock_main)
```

4. Clean your build directory and re-run the build.

---

### Example: Suppressing Uninteresting Call Warnings

```cpp
using ::testing::NiceMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoSomething, (int));
};

TEST(MyTestSuite, TestCase) {
  NiceMock<MockFoo> mock;

  EXPECT_CALL(mock, DoSomething(5));

  mock.DoSomething(3);  // No warning is produced.
  mock.DoSomething(5);  // Expected call.
}
```

<Info>
Using `NiceMock` preserves test correctness without spamming warnings for unimportant mock calls.
</Info>

---

_This troubleshooting guide aims to get you quickly through common setup pitfalls so you can focus on writing effective tests with GoogleTest and GoogleMock._