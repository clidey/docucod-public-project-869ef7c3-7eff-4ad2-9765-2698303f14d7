---
title: "Configuration & Integration"
description: "Explains how to configure GoogleTest for use within new or existing C++ projects. Describes linking strategies, header inclusion (`#include <gtest/gtest.h>`), and optional environment settings. Provides examples for both standalone and integrated builds, with tips for package managers and configuring PATHs."
---

# Configuration & Integration

## Introduction

This guide explains how to configure GoogleTest for use within new or existing C++ projects. It covers strategies for linking GoogleTest libraries, the required header inclusions, and optional environment settings that can affect test behavior. Whether you are incorporating GoogleTest as a standalone framework or integrating it into your build system, these instructions will help you get started quickly and efficiently.

---

## 1. Including GoogleTest in Your Project

To write tests with GoogleTest, include the main header in your test source files:

```cpp
#include <gtest/gtest.h>
```

This header provides access to all testing macros, assertions, and utilities you need.

<Tip>
If you use GoogleMock alongside GoogleTest, include `<gmock/gmock.h>` instead which also includes GoogleTest.
</Tip>

## 2. Linking Strategies

There are multiple ways you can link GoogleTest into your C++ project:

### 2.1 Standalone Build

- **Build GoogleTest Separately:**
  1. Clone the repository.
  2. Build and install GoogleTest using CMake or your build system.
  3. Link your test executable against the installed `gtest` or `gtest_main` libraries.

Example CMake linkage:

```cmake
find_package(GTest REQUIRED)
target_link_libraries(your_test_target GTest::gtest_main)
```

### 2.2 Incorporate Source in Your Build

- Add GoogleTest as a subdirectory inside your project's source tree.
- Use `add_subdirectory(googletest)` in your `CMakeLists.txt`.
- Link tests against the imported targets `gtest` or `gtest_main`.

This approach ensures that GoogleTest is built with the same compiler flags and environment as your tests.

### 2.3 Package Manager Installations

- If you have installed GoogleTest via a package manager, ensure your compiler and linker can locate the headers and libraries.
- Set appropriate include paths (e.g. `-I/usr/include/gtest`) and linker flags (e.g., `-lgtest -lgtest_main`).

<Tip>
When using package managers, verify that the GoogleTest version meets the minimum required C++17 compatibility.
</Tip>

## 3. Library Options and Linking Flags

- To link with the default `main()` provided by GoogleTest, link against `gtest_main`. This lets you focus on writing tests without providing a custom `main()`.

- If you require a custom test runner or additional initialization, link directly with `gtest` and write your own `main()` function.

- For shared library builds, define `-DGTEST_CREATE_SHARED_LIBRARY=1` during GoogleTest compilation.
- Ensure that your test executables link consistently with the runtime library options, especially on Windows (static vs dynamic runtimes). The `gtest_force_shared_crt` option in CMake can help resolve conflicts.

## 4. Environment Settings and Optional Flags

GoogleTest behavior can be modified using environment variables and command-line flags. Some notable environment variables:

- `GTEST_COLOR`: Controls colored output (`yes`, `no`, `auto`). Default is `auto`.
- `GTEST_FILTER`: Specify which tests to run using a glob pattern.
- `GTEST_REPEAT`: Number of times to repeat the tests.
- `GTEST_OUTPUT`: Enables output of XML or JSON reports (e.g., `xml:report.xml`).
- `GTEST_FAIL_FAST`: Stops test execution on first failure.

Set these either in your shell environment or pass them as command-line flags prefixed with `--gtest_`. For example:

```bash
./my_tests --gtest_color=yes --gtest_filter=MySuite.*
```

<Tip>
Remember that environment variables are overridden by command-line flags if both are specified.
</Tip>

## 5. Example: Standalone CMake Build with GoogleTest

Assuming GoogleTest is checked out into a `googletest` directory inside your project:

```cmake
cmake_minimum_required(VERSION 3.14)
project(MyTests CXX)

# Enable C++17
set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# Add GoogleTest
add_subdirectory(googletest)

# Your test executable
add_executable(my_test test1.cpp test2.cpp)

# Link with GoogleTest main
target_link_libraries(my_test GTest::gtest_main)

# Enable CTest if using
include(CTest)
add_test(NAME my_test COMMAND my_test)
```

Build:

```bash
mkdir build && cd build
cmake ..
make
ctest
```

This produces and runs the tests while linking correctly against GoogleTest.

## 6. Configuring PATHs and Include Directories

Ensure your compiler can find GoogleTest headers and your linker can find its libraries:

- Include paths must include GoogleTest's `include` directory, e.g.,
  `-I/path/to/googletest/include`.
- Library paths must include the directory where `libgtest.a` or equivalent resides, e.g., `-L/path/to/googletest/lib`.

Adjust your build system accordingly if you installed GoogleTest manually or use system-wide packages.

## 7. Best Practices and Tips

- Prefer linking with `gtest_main` unless you need a custom test runner.
- Always compile and link GoogleTest and your test code with the same compiler and standard settings.
- Use CMake or Bazel for reproducible builds.
- If you see issues with runtime library conflicts on Windows, try enabling the `gtest_force_shared_crt` CMake option.
- Avoid mixing debug and release versions of GoogleTest and your tests.
- To debug failed test runs, enable `--gtest_break_on_failure`.

## 8. Troubleshooting Common Issues

| Problem                                  | Solution                                                                                  |
|------------------------------------------|-------------------------------------------------------------------------------------------|
| Linking errors for GoogleTest symbols    | Check that you link with `gtest` or `gtest_main` libraries and set proper include paths.  |
| Conflicts with runtime libraries on Win  | Use `gtest_force_shared_crt` option or align your runtime flags across projects.          |
| Tests not running or filtered unintentionally | Verify `--gtest_filter` and environment variables do not exclude your tests.          |
| No tests linked error                     | Ensure that your project includes at least one test source file defining tests.           |

## 9. Additional Resources

- [GoogleTest GitHub Repository](https://github.com/google/googletest)
- [Installing with CMake](https://github.com/google/googletest/blob/main/README.md#generic-build-instructions)
- [Getting Started with GoogleTest](../guides/gtest-core-guides/getting-started)
- [Writing and Organizing Tests](../guides/gtest-core-guides/writing-tests)
- [Running and Interpreting Tests](../guides/gtest-core-guides/running-tests)

---

Feel free to explore other documentation sections to deepen your understanding of test writing, assertions, mocking, and advanced features.
