---
title: "Installing with CMake"
description: "Provides a guided walkthrough for downloading, configuring, and building GoogleTest using CMake, covering both source and package-based installation on all major platforms. Includes verification tips and troubleshooting advice for common build issues."
---

# Installing with CMake

This guide walks you through downloading, configuring, and building GoogleTest using CMake on major platforms like Linux, macOS, and Windows. You will learn how to perform both source-based and package-based installations, verify your build, and troubleshoot common issues.

---

## 1. Prerequisites & System Requirements

Before you start building GoogleTest with CMake, ensure you have the following:

- **Supported Platforms:** Linux, macOS, Windows
- **C++ Compiler:** Must support C++17 (e.g., GCC 7+, Clang 5+, MSVC 2017+)
- **CMake Version:** 3.14 or higher (required for `FetchContent_MakeAvailable`)
- **Build Tools:** 
  - On Linux/macOS: Make, Ninja, or other CMake-compatible generators
  - On Windows: Visual Studio with C++ workload, or other supported generators
- **Network Access:** Required for package-based installation to download GoogleTest sources

<Tip>
If you are unsure about your environment’s compatibility, review the [System Requirements](getting-started/setup-prerequisites/system-requirements) and [Supported Platforms and Compatibility](overview/integration-and-ecosystem/supported-platforms-and-compatibility) documentation for detailed guidance.
</Tip>

---

## 2. Installation Methods

### 2.1 Standalone Source Build

This method clones GoogleTest’s repository and builds it independently.

<Steps>
<Step title="Clone the GoogleTest Repository">
Open your terminal or command prompt and run:
```bash
git clone https://github.com/google/googletest.git -b v1.17.0
downloads the stable v1.17.0 release.
```
</Step>
<Step title="Navigate to the Directory and Create Build Folder">
```bash
cd googletest
mkdir build
cd build
```
Creating a separate build directory helps keep source files clean.
</Step>
<Step title="Run CMake Configuration">
To include GoogleMock (the mocking library bundled with GoogleTest), run:
```bash
cmake ..
```
If you only want GoogleTest (without GoogleMock), use:
```bash
cmake .. -DBUILD_GMOCK=OFF
```
</Step>
<Step title="Build the Library">
- On Linux/macOS:
```bash
make
```
- On Windows:
Open the generated `.sln` file with Visual Studio and build it, or run:
```powershell
cmake --build .
```
</Step>
<Step title="(Optional) Install the Library">
If you want to install GoogleTest system-wide (requires admin privileges):
```bash
sudo make install
```
On Windows, install steps depend on your environment.
</Step>
</Steps>

### 2.2 Using GoogleTest as a Package Dependency in Your Project

You can have CMake download and build GoogleTest automatically during your project’s configuration.

<Steps>
<Step title="Create or Update Your `CMakeLists.txt`">
Add the following snippet to your project’s `CMakeLists.txt`:

```cmake
cmake_minimum_required(VERSION 3.14)
project(my_project)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

include(FetchContent)
FetchContent_Declare(
  googletest
  URL https://github.com/google/googletest/archive/5376968f6948923e2411081fd9372e71a59d8e77.zip
)

set(gtest_force_shared_crt ON CACHE BOOL "" FORCE) # For Windows dynamic CRT compatibility
FetchContent_MakeAvailable(googletest)
```

This approach eliminates the need to manually clone and build GoogleTest.
</Step>
<Step title="Link GoogleTest to Your Targets">
Simply link GoogleTest libraries in your targets:

```cmake
add_executable(your_test test.cpp)
target_link_libraries(your_test gtest_main)
```
</Step>
<Step title="Build Your Project as Usual">
Configure and build your project:

```bash
cmake -S . -B build
cmake --build build
```
</Step>
</Steps>

<Tip>
Keep your GoogleTest version current by updating the commit hash or URL in the `FetchContent_Declare` section.
</Tip>

---

## 3. Verification of Installation

Confirm GoogleTest built correctly with these validations.

### 3.1 Confirm Build Artifacts

- Check the `build` directory for generated libraries (`libgtest.a`, `gtest.lib`, etc.) and executables.
- On Windows, verify that the `.sln` or `.vcxproj` files are present when using Visual Studio.

### 3.2 Build and Run a Sample Test

Create a simple test file `hello_test.cc`:

```cpp
#include <gtest/gtest.h>

TEST(HelloTest, BasicAssertions) {
  EXPECT_STRNE("hello", "world");
  EXPECT_EQ(7 * 6, 42);
}
```

Add to `CMakeLists.txt`:

```cmake
enable_testing()
add_executable(hello_test hello_test.cc)
target_link_libraries(hello_test GTest::gtest_main)
include(GoogleTest)
gtest_discover_tests(hello_test)
```

Build and Test:

```bash
cmake -S . -B build
cmake --build build
cd build
ctest
```

Successful output shows tests passed.

<Tip>
Use `ctest -V` inside the build directory for verbose test output.
</Tip>

---

## 4. Troubleshooting Common Issues

<AccordionGroup title="Troubleshooting Installation and Build Problems">
<Accordion title="CMake Version Too Low">
Ensure you are running CMake 3.14 or newer. Use `cmake --version` to check.
Update from https://cmake.org if necessary.
</Accordion>
<Accordion title="Compiler Does Not Support C++17">
Confirm your compiler supports C++17. Check the version or upgrade your compiler.
</Accordion>
<Accordion title="Linker Errors Related to pthreads on Linux/macOS">
If you encounter pthread linker errors, ensure pthread is installed and linked. The GoogleTest CMake scripts handle this automatically, but for custom builds, add `-pthread` compiler and linker flags.
</Accordion>
<Accordion title="Visual Studio Runtime Library Mismatch Errors">
Enable the CMake option `gtest_force_shared_crt` to align runtime library linkage when building with Visual Studio to avoid `LNK2038` errors.
Set it in your `CMakeLists.txt`:

```cmake
set(gtest_force_shared_crt ON CACHE BOOL "" FORCE)
```
</Accordion>
<Accordion title="Missing Headers or Source Files">
Make sure you are in the correct directory and the GoogleTest repository was cloned successfully.
</Accordion>
</AccordionGroup>

---

## 5. Best Practices and Tips

- Always build GoogleTest and your test code with the **same compiler flags** and toolchain to avoid ABI mismatches.
- Prefer using GoogleTest as a subdirectory in your project with `add_subdirectory()` or via `FetchContent` for easier updates.
- On Windows, use `gtest_force_shared_crt` to ensure your runtime libraries are consistent.
- For continuous integration, automate cloning and building GoogleTest in your build scripts.
- Use `ctest` after building to consistently run and report your tests.

---

## 6. Next Steps

- Proceed to [Writing Your First Test](getting-started/first-run-validation/write-first-test) to learn how to create effective tests with GoogleTest.
- Explore [Configuration & Integration](getting-started/installation-config/configuration-setup) for advanced build system integration techniques.
- Review [Troubleshooting Setup Issues](getting-started/first-run-validation/troubleshooting-setup) if you encounter unexpected problems.


---

For more information and the latest updates, visit the official GoogleTest GitHub repository: [https://github.com/google/googletest](https://github.com/google/googletest)


---

<Check>
You have now learned how to download, configure, build, verify, and troubleshoot GoogleTest with CMake across major platforms. Building a reliable test foundation enables you to confidently maintain and improve your C++ code.
</Check>
