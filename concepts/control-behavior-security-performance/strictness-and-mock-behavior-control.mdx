---
title: "Strictness and Mock Behavior Control"
description: "Investigate how different mock class flavors (NiceMock, NaggyMock, StrictMock) enable fine-grained control over failure handling and test diagnostics, offering the flexibility to tailor test strictness to your needs."
---

# Strictness and Mock Behavior Control

GoogleTest's mocking framework (GoogleMock) offers flexible control over the behavior of mock objects, particularly how they handle unexpected or uninteresting method calls. This page explores how different mock class wrappers—`NiceMock`, `NaggyMock`, and `StrictMock`—allow you to tailor failure handling and test diagnostics, providing a spectrum of strictness levels to fit your testing needs.

---

## Understanding Uninteresting and Unexpected Calls

When working with mock objects, it's essential to differentiate between two key types of calls:

- **Unexpected calls:** Invocations of mock methods for which *some* expectations (`EXPECT_CALL`) exist, but none match the actual call arguments.
- **Uninteresting calls:** Invocations of mock methods for which *no* expectations exist.

Unexpected calls always indicate a test failure because the test explicitly sets constraints violated by that call. Uninteresting calls, however, may or may not be errors depending on the strictness level of the mock.

## The Default Behavior: Naggy Mocks

By default, a mock object behaves like a *naggy mock*. This means:

- Warnings are produced when uninteresting calls occur, drawing your attention to possible unintended calls or missing expectations.
- Unexpected calls always cause test failures.

Naggy mocks strike a balance by flagging potentially problematic calls without failing immediately on every unimportant call.

### Example:

```cpp
MockFoo mock;  // Behaves as NaggyMock<MockFoo> by default.
EXPECT_CALL(mock, DoThis());
mock.DoThis();     // Expected call, passes.
mock.DoThat(true); // Uninteresting call; prints warning but test continues.
```

<Callout type="tip">
**Tip:** To reduce noisy warnings on uninteresting calls you intentionally don’t want to check, consider using a different strictness level or explicitly expect calls with `Times(AnyNumber())`.
</Callout>

## NiceMock: Suppressing Warnings on Uninteresting Calls

When uninteresting calls are expected or not important, use `NiceMock<T>` as a wrapper.

- Suppresses warnings for uninteresting calls.
- Unexpected calls still cause test failures.

`NiceMock` is a subclass of your mock class `T` and supports all constructors of `T`, making it a drop-in replacement.

### Example:

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> nice_mock;
EXPECT_CALL(nice_mock, DoThis());
nice_mock.DoThis();       // Expected call, passes.
nice_mock.DoThat(true);   // Uninteresting call, no warning.
```

This is useful to create less noisy test logs, especially when your test isn’t concerned with all calls to the mock.

## StrictMock: Enforcing Failures on Uninteresting Calls

`StrictMock<T>` enforces the highest level of strictness:

- All uninteresting calls cause test failures.
- Unexpected calls also cause test failures as usual.

This helps you catch any unintended calls early but can make tests more brittle and harder to maintain.

### Example:

```cpp
using ::testing::StrictMock;
StrictMock<MockFoo> strict_mock;
EXPECT_CALL(strict_mock, DoThis());
strict_mock.DoThis();       // Expected call, passes.
strict_mock.DoThat(true);   // Uninteresting call, test fails immediately.
```

## Choosing the Right Strictness Level

| Strictness Level | Behavior on Uninteresting Calls          | Typical Use Case                                        |
|------------------|-----------------------------------------|--------------------------------------------------------|
| **NaggyMock**    | Warns, but does not fail the test       | Default, useful during development to catch missing expectations without breaking tests early. |
| **NiceMock**     | Ignores uninteresting calls silently    | Keeps test output clean when those calls are not relevant to test correctness. |
| **StrictMock**   | Fails the test immediately               | Ensures no unexpected calls occur, useful in very high-assurance or tightly controlled tests. |

Our recommendation:

- Use **NiceMock** for most tests to maintain clean and maintainable test logs.
- Use **NaggyMock** if you want verbose diagnostics during test development.
- Use **StrictMock** only when you need to catch *all* unexpected or uninteresting calls as errors.

## How to Use These Wrappers

You can instantiate or otherwise declare mocks using these strictness modifiers as follows:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

// Assumes MockFoo is a mock class defined with MOCK_METHOD
NiceMock<MockFoo> nice_mock(args...);
NaggyMock<MockFoo> naggy_mock(args...);
StrictMock<MockFoo> strict_mock(args...);
```

Since these wrappers inherit constructors from their base mock class, you can pass any constructor arguments supported by `MockFoo`.

<Note>
`NiceMock`, `NaggyMock`, and `StrictMock` only affect mock methods defined *directly* in the given mock class via `MOCK_METHOD` macros. Methods inherited from base classes may not respect these behaviors depending on compiler support.
</Note>

## Internal Behavior

Each wrapper registers its desired handling behavior upon construction:

- `NiceMock` allows uninteresting calls.
- `NaggyMock` warns on uninteresting calls.
- `StrictMock` fails on uninteresting calls.

When the mock object is destructed, it unregisters this strictness behavior.

This registration ensures you get consistent handling of uninteresting calls for the lifetime of each mock instance.

## Common Scenarios & Best Practices

### When to Use NiceMock

- Your test is stable and you want to focus on expected calls only.
- You want to suppress noise from uninteresting method calls.

### When to Use NaggyMock

- You are writing or debugging tests and want to be warned about unexpected or possibly forgotten calls.
- You want to see potential uninteresting calls without failing the test.

### When to Use StrictMock

- You want to enforce very strict interaction contracts.
- Your mocks represent external critical dependencies that should never receive unexpected calls.

### Dealing with Uninteresting Call Warnings

If you run into warnings like:

```
Uninteresting mock function call - returning default value.
```

- Review if you need to add an `EXPECT_CALL` or `ON_CALL` default behavior.
- Switch to `NiceMock` if the calls are expected but uninteresting.
- Explicitly disable warnings by setting the `--gmock_verbose=error` flag to silence diagnostic messages.

## Summary of Effects on Calls

| Call Type           | Default Mock/NaggyMock | NiceMock            | StrictMock          |
|---------------------|------------------------|---------------------|---------------------|
| Expected Call       | Behaves normally        | Behaves normally     | Behaves normally     |
| Unexpected Call     | Fail test               | Fail test            | Fail test            |
| Uninteresting Call  | Warn, continue          | Discard, continue    | Fail test            |

## Notes on Mixed Strictness

- Nesting strictness wrappers is not supported (e.g., `NiceMock<StrictMock<MockFoo>>`).
- The mock class itself must not already use a strictness modifier.
- Destructors of mock classes should be virtual to ensure proper cleanup.

## Example Code

```cpp
#include <gmock/gmock.h>
using ::testing::NiceMock;
using ::testing::StrictMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoThis, (), ());
  MOCK_METHOD(void, DoThat, (bool flag), ());
};

// NiceMock example suppresses warnings on uninteresting calls.
NiceMock<MockFoo> nice_mock;
EXPECT_CALL(nice_mock, DoThis());
nice_mock.DoThis();    // OK
nice_mock.DoThat(true);  // No warning

// StrictMock example fails on uninteresting calls.
StrictMock<MockFoo> strict_mock;
EXPECT_CALL(strict_mock, DoThis());
strict_mock.DoThis();    // OK
strict_mock.DoThat(true);  // Test failure: uninteresting call.
```

## Troubleshooting

### Uninteresting Call Warning Despite `ON_CALL`

`ON_CALL` sets default actions but does *not* suppress warnings on uninteresting calls. Use `NiceMock` to suppress warnings or add catch-all `EXPECT_CALL` with `Times(AnyNumber())`.

### Unexpected Call Failure

Check your `EXPECT_CALL` argument matchers to ensure they properly cover all expected method calls.

### Leaked Mock Objects

If mock objects are leaked (not deleted), their expectations may not be verified, leading to false positives. Use mock wrappers responsibly and call `Mock::AllowLeak(mock_ptr)` if intentional.

## Related Concepts

- [Mocking: Principles and Patterns](../concepts/architecture-core-abstractions/mocking-core-principles.md)
- [Mocking API Reference](../api-reference/core-apis/mocking.md)
- [Controlling Mock Strictness and Behavior](../guides/test-design-and-best-practices/mock-strictness-and-behavior.md)
- [Understanding Uninteresting vs Unexpected Calls](../docs/gmock_cook_book.md#uninteresting-vs-unexpected)

---

This page focuses on how to control mock object strictness and behavior. For guidance on defining mock classes, setting expectations, and advanced mocking techniques, refer to the Mocking Reference and the gMock Cookbook.

---