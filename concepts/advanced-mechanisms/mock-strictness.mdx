---
title: "Mock Strictness and Behavioral Control"
description: "Learn how mock strictness levels affect test outcomes, from allowing uninteresting calls without error to enforcing strict call expectations. Explore the use of NiceMock, NaggyMock, and StrictMock to control warnings and failures in test scenarios."
---

# Mock Strictness and Behavioral Control

Understanding how mock strictness influences your test outcomes is essential for writing clear, maintainable, and reliable unit tests using GoogleMock. This guide explains the behaviors associated with different strictness levels—*NiceMock*, *NaggyMock*, and *StrictMock*—and how each controls warnings and failures related to uninteresting and unexpected calls.

---

## Overview of Mock Strictness Levels

By default, GoogleMock treats all mock objects as *naggy*, meaning it warns about uninteresting calls but does not fail the test. Depending on your testing needs, you may want to adjust this behavior to suppress warnings or treat uninteresting calls as errors.

| Strictness Level | Description                                                              | Behavior With Uninteresting Calls                           |
| ---------------- | ------------------------------------------------------------------------ | ----------------------------------------------------------- |
| **NiceMock<T>**  | Suppresses warnings for uninteresting calls; test fails only on unexpected calls. | Uninteresting calls are ignored silently.                    |
| **NaggyMock<T>** | The default behavior; warns on uninteresting calls but allows them.     | Prints warnings but does not fail the test.                   |
| **StrictMock<T>**| Fails the test on uninteresting calls; no warnings.                     | Treated as errors; tests fail immediately upon uninteresting calls. |

---

## What Are Uninteresting and Unexpected Calls?

Before diving into strictness modifiers, it is crucial to understand these two concepts.

- **Uninteresting calls**: Calls to a mock method for which no `EXPECT_CALL` expectation exists.
- **Unexpected calls**: Calls that *do* match some mock method's expectations, but none of the expectations match the call arguments or any other specified constraints.

Uninteresting calls are allowed (by default) but trigger warnings, whereas unexpected calls always fail the test.

<Info>
Strictness modifiers affect only uninteresting calls, not unexpected calls.
</Info>

---

## Using NiceMock: Ignoring Uninteresting Calls

`NiceMock<T>` is a subclass of your mock class `T` that ignores warnings for uninteresting calls. Use it when uninteresting calls are expected and not indicative of test issues.

### Benefits

- Simplifies tests by suppressing noisy warnings.
- Focuses on expected interactions without clutter.
- Ideal for complex mocks where only specific methods are of interest.

### Example
```cpp
using ::testing::NiceMock;

class MockFoo {
 public:
  MOCK_METHOD(void, DoSomething, ());
  MOCK_METHOD(int, GetValue, (), (const));
};

TEST(FooTest, NiceMockExample) {
  NiceMock<MockFoo> mock_foo;

  EXPECT_CALL(mock_foo, DoSomething());  // We care about this method.

  mock_foo.DoSomething();    // Expected call: passes
  mock_foo.GetValue();       // Uninteresting call: no warning
}
```

### Important Notes

- `NiceMock` only affects methods defined with `MOCK_METHOD` directly in your mock class.
- Destructors in the mock class should be virtual for `NiceMock` to behave correctly.

---

## Using NaggyMock: The Default Behavior

`NaggyMock<T>` is essentially the default mock behavior that warns about all uninteresting calls.

### Summary
- Warns you when methods without expectations are called.
- Helps detect potentially missing expectations during test development.

### Example
```cpp
using ::testing::NaggyMock;

NaggyMock<MockFoo> mock_foo;

EXPECT_CALL(mock_foo, DoSomething());

mock_foo.DoSomething();    // Matches expectation: passes
mock_foo.GetValue();       // Uninteresting call: prints warning
```

### Use Case
- Useful during test development.
- Helps uncover incomplete test coverage.

---

## Using StrictMock: Treat Uninteresting Calls As Errors

`StrictMock<T>` subclass fails your test immediately when any uninteresting call occurs.

### When to Use
- Enforce rigorous interface conformance.
- Detect unexpected interactions early.
- Drive stricter testing disciplines.

### Example
```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> mock_foo;

EXPECT_CALL(mock_foo, DoSomething());

mock_foo.DoSomething();    // Passes
mock_foo.GetValue();       // Fails test immediately
```

### Important Caveats
- Like `NiceMock`, requires `MOCK_METHOD` defined methods directly in the mock class.
- May make tests brittle if overused; Refactor tests and mock interface to reduce noise.

---

## How to Use Strictness Modifiers

Given a mock class `MockFoo`, the strictness wrappers are used as follows:

```cpp
using ::testing::NiceMock;
using ::testing::NaggyMock;
using ::testing::StrictMock;

NiceMock<MockFoo> nice_foo;      // Ignores uninteresting calls silently.
NaggyMock<MockFoo> naggy_foo;    // Default: warns on uninteresting calls.
StrictMock<MockFoo> strict_foo;  // Fails on uninteresting calls.
```

You can construct them with the same arguments as the underlying mock:

```cpp
NiceMock<MockFoo> nice_foo(42, "hello");
StrictMock<MockFoo> strict_foo("world");
```

---

## Best Practices for Managing Strictness

- **Prefer `NiceMock` for general-use tests:** Avoid unnecessary warning noise to keep test logs clean.
- **Use `NaggyMock` strategically during test debugging:** Leverage warnings to find missing expectations.
- **Employ `StrictMock` sparingly:** Use only when you need to enforce strict call discipline and uninteresting calls are genuine issues.
- **Always define expectations before exercising your mock:** Setting expectations after calls is undefined behavior.
- **Avoid nesting multiple strictness wrappers:** Not supported and can cause unexpected issues.

---

## Diagnosing Issues with Strictness

If your test fails due to unexpected or uninteresting calls, consider:

- Using the `--gmock_verbose=info` flag to see detailed traces of mock method calls and which expectations they matched or failed.
- Adding appropriate `EXPECT_CALL` or `ON_CALL` clauses to explicitly define behaviors and suppress unwanted warnings.
- Utilizing `Times(AnyNumber())` on methods to allow calls without strict expectations.

---

## Internals and Limitations

- Strictness wrappers only influence uninteresting calls (no expectations defined).
- Expected calls that fail due to argument mismatch always cause test failure regardless of strictness.
- `NiceMock`, `NaggyMock`, and `StrictMock` only affect methods mocked via the `MOCK_METHOD` macro directly in your class.
- Virtual destructors are necessary for correct destruction and strictness control.

---

## Troubleshooting Common Questions

### Why do I sometimes see warnings despite using `NiceMock`?
Ensure that:
- You use `MOCK_METHOD` within your mock class definition (not inherited methods).
- Your mock class has a virtual destructor.

### Can I mix different strictness levels in nested mocks?
No, nesting strictness wrappers like `NiceMock<StrictMock<MockFoo>>` is unsupported.

### What if my test is failing due to uninteresting calls on `StrictMock`?
Review your expectations and either:
- Add missing `EXPECT_CALL`s to cover those calls.
- Switch to `NiceMock` if the calls are genuinely uninteresting and do not impact test correctness.

---

## Summary

Using `NiceMock`, `NaggyMock`, and `StrictMock` allows precise control over the behavior of uninteresting calls in your tests:

- Use **`NiceMock`** to silence warnings and focus on essential expectations.
- Use **`NaggyMock`** to get notified about unplanned mock interactions.
- Use **`StrictMock`** to enforce complete specification of expected calls and disallow others.

Selecting the right level of strictness will help maintain a balance between test robustness and maintainability.

---

## Additional Resources

- [gMock Cookbook: The Nice, the Strict, and the Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [Mocking Reference - Basic Concepts and Usage](https://google.github.io/googletest/reference/mocking.html)
- [gMock for Dummies - Getting Started](https://google.github.io/googletest/gmock_for_dummies.html)
- [gMock Cheat Sheet - Mocking and Expectations](https://google.github.io/googletest/gmock_cheat_sheet.html)
- API Reference: [gmock-nice-strict.h](https://github.com/google/googletest/blob/main/googlemock/include/gmock/gmock-nice-strict.h)

---

## Related Topics

- Setting default actions with `ON_CALL` and expectations with `EXPECT_CALL`.
- Controlling call ordering with `InSequence` and `After` clauses.
- Using matchers and actions effectively to specify mock behavior.
- Understanding uninteresting vs unexpected calls and their effect on test results.

Consider reviewing these topics to deepen your mastery of GoogleMock and writing effective tests.
