---
title: "Mock Behavior Strictness"
description: "Learn about different strictness policies (NiceMock, NaggyMock, StrictMock) and how they influence test feedback and enforcement of correct usage patterns. This section guides users to select the appropriate behavior for their testing context."
---

# Mock Behavior Strictness in GoogleMock

Understanding the behaviors of mock objects when unexpected or uninteresting calls occur is crucial to writing effective and maintainable tests using GoogleMock. This guide explores **mock behavior strictness**, explaining the different strictness policies—**NiceMock**, **NaggyMock**, and **StrictMock**—and their impact on test outputs and enforcement. You will learn when and how to select the appropriate strictness policy for your testing scenarios.

---

## What Are Uninteresting and Unexpected Calls?

Before diving into strictness policies, it's vital to clarify two fundamental concepts:

- **Uninteresting Calls:** Calls made to mock methods *without* any prior `EXPECT_CALL` expectation matching their arguments. These calls receive default behavior unless overridden.

- **Unexpected Calls:** Calls made to mock methods that *do have* expectations via `EXPECT_CALL`, but the actual call arguments do *not* match any expectation.

GoogleMock treats unexpected calls as errors irrespective of strictness. However, uninteresting calls are handled differently depending on the mock's strictness setting.

---

## Strictness Policies Explained

GoogleMock offers three policies to manage uninteresting calls on mock objects:

| Strictness      | Behavior on Uninteresting Calls                         | Purpose & Use Cases                                                |
|-----------------|--------------------------------------------------------|------------------------------------------------------------------|
| **NiceMock**    | Suppresses warnings and allows the call silently.     | Use when you want to ignore unimportant method calls and keep test output clean. Ideal for most scenarios to reduce noise.           |
| **NaggyMock**   | Prints warnings but allows execution to continue.      | Default policy. Use to notice unexpected interactions without causing test failures immediately. Useful during test development and debugging. |
| **StrictMock**  | Treats uninteresting calls as test failures.           | Use to enforce strictly that all calls must be expected. Helpful for high-assurance testing or when you want tight control over mock interactions. |

---

## Using Strictness Wrappers in Your Tests

GoogleMock provides convenient class templates to apply these policies:

- `NiceMock<MockClass>`
- `NaggyMock<MockClass>`
- `StrictMock<MockClass>`

All these are subclasses of your mock class `MockClass` and can be used interchangeably wherever the original mock can be used.

### Example: Applying NiceMock

```cpp
using ::testing::NiceMock;

class MockFoo {
public:
  MOCK_METHOD(void, DoThis, (), ());
};

TEST(MyTest, NiceMockExample) {
  NiceMock<MockFoo> mock_foo;
  EXPECT_CALL(mock_foo, DoThis());

  mock_foo.DoThis();       // Allowed and expected call.
  mock_foo.DoSomething();  // Uninteresting call: no warning or error.
}
```

### Example: Applying StrictMock

```cpp
using ::testing::StrictMock;

StrictMock<MockFoo> strict_foo;
EXPECT_CALL(strict_foo, DoThis());

strict_foo.DoThis();       // Allowed
strict_foo.DoOtherThing(); // Uninteresting call: results in test failure
```

---

## Choosing the Appropriate Strictness Policy

GoogleMock historically has defaulted to **NaggyMock**, which warns you about potential issues without failing your tests. This is helpful during test development. However, over time, Google recommends switching to **NiceMock** as the default because it produces cleaner test output and promotes maintainable, less brittle tests.

### Best Practices

- Use **NiceMock** as the default policy to reduce noise from uninteresting calls.
- Use **NaggyMock** temporarily to debug unexpected mock calls or when exploring unfamiliar test failures.
- Use **StrictMock** sparingly when you want to enforce absolute expectations on interactions. This tight control can make tests harder to maintain due to brittleness.

> _Tip:_ Avoid mixing or nesting strictness modifiers, like `NiceMock<StrictMock<MockFoo>>`, which is unsupported.

---

## Behavior on Uninteresting Calls by Strictness

| Strictness  | Message on Uninteresting Call               | Test Outcome            |
|-------------|---------------------------------------------|------------------------|
| NiceMock    | No warning or error                          | Test continues normally |
| NaggyMock   | Warning printed to test output               | Test continues normally |
| StrictMock  | Test failure reported                        | Test fails immediately  |

Unexpected calls always cause test failures regardless of strictness.

---

## Common Scenarios and Guidance

### Suppressing Warnings on Unnecessary Calls

Sometimes mocks are called on methods you explicitly don't care about. In this case, wrapping the mock instance in `NiceMock` will suppress repetitive warnings, keeping test logs clean:

```cpp
NiceMock<MockFoo> mock;
// Uninteresting method calls will be silently ignored
```

### Detecting Missing Expectations

If you want to detect any unexpected interactions during test development, use `NaggyMock`:

```cpp
NaggyMock<MockFoo> mock;
// Will warn loudly about uninteresting calls
```

### Enforcing Strict Interactions

When you want to verify every call against an expectation (for example, in critical components), choose `StrictMock`. This ensures no method calls go unchecked, but requires precise expectation setup to avoid brittle tests.

---

## Usage Notes and Caveats

- Strictness wrappers affect **only uninteresting calls** (calls without any matching `EXPECT_CALL`). They do not affect unexpected calls (calls that do not match any configured expectation), which always cause a test failure.
- Wrappers like `NiceMock` and `StrictMock` only affect mock methods declared directly in the mock class (with `MOCK_METHOD` macros). Methods inherited from base classes may not be affected depending on your compiler.
- Constructor arguments are forwarded transparently, so use the strictness wrapper just as you would the original mock class.
- Be cautious using `StrictMock`: overly strict mocks can increase test fragility when refactoring.

---

## How GoogleMock Implements Strictness (Overview)

Under the hood, GoogleMock maintains a registry tracking the *reaction* policy for each mock object:

- Calls to uninteresting methods on a mock trigger behavior based on the assigned policy:
  - `kAllow`: allow silently (NiceMock)
  - `kWarn`: print a warning (NaggyMock)
  - `kFail`: treat as test failure (StrictMock)

The strictness wrappers (`NiceMock`, `NaggyMock`, `StrictMock`) register and deregister this behavior when constructed or destructed.

---

## Troubleshooting Common Issues

- **Unexpected warnings with NiceMock?**
  - Check if the uninteresting methods are declared in base classes; `NiceMock` only suppresses warnings for methods declared directly in the wrapped class.

- **Test failures due to unexpected calls?**
  - Remember that unexpected calls always cause a failure. Add appropriate `EXPECT_CALL` with argument matchers or use `.Times(AnyNumber())` to permit calls.

- **Nesting strictness wrappers causes compiler errors or has no effect.**
  - Avoid nesting or mixing `NiceMock`, `NaggyMock`, and `StrictMock` on the same object.

- **Mock destructor warnings.**
  - If a mock object is leaked without deletion, GoogleMock will report it as a test error unless you mark it using `Mock::AllowLeak()`.

---

## Summary

Using mock behavior strictness correctly lets you balance noise vs. rigor in test feedback. **NiceMock** is suitable for everyday development to reduce spurious warnings, **NaggyMock** helps expose uninteresting call warnings during debugging, and **StrictMock** enforces strict contract adherence for critical tests.

Select your policy based on your test maintenance and quality priorities to achieve clean, effective, and reliable tests.

---

## Additional Resources

- [gMock Cookbook - Nice, Strict, and Naggy](https://google.github.io/googletest/gmock_cook_book.html#NiceStrictNaggy)
- [gMock Cheat Sheet - Mocks and Strictness](https://google.github.io/googletest/gmock_cheat_sheet.html)
- [Mocking Reference - EXPECT_CALL, ON_CALL, Strictness](reference/mocking.md)
- [Understanding Uninteresting vs Unexpected Calls](https://google.github.io/googletest/gmock_cook_book.html#uninteresting-vs-unexpected)

---

## Quick Reference Examples

### NiceMock Suppresses Warnings

```cpp
using ::testing::NiceMock;
NiceMock<MockFoo> foo;
foo.UnexpectedMethod();  // No warning or error
```

### NaggyMock Gives Warnings

```cpp
using ::testing::NaggyMock;
NaggyMock<MockFoo> foo;
foo.UnexpectedMethod();  // Warning printed, but test continues
```

### StrictMock Treats as Failure

```cpp
using ::testing::StrictMock;
StrictMock<MockFoo> foo;
foo.UnexpectedMethod();  // Test failure reported
```
