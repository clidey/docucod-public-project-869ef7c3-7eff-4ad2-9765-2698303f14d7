---
title: "Test Discovery and Parallel Test Execution"
description: "See how GoogleTest automatically discovers all tests and how users can leverage parallel test execution or filtering to accelerate feedback cycles, especially in large codebases."
---

# Test Discovery and Parallel Test Execution

Discover how GoogleTest's automatic test discovery, parallel test execution capabilities, and filtering options empower you to accelerate feedback cycles—especially critical in large codebases with extensive test suites.

---

## Introduction

When managing large C++ codebases, reducing the time between code changes and test feedback is vital for productivity and code quality. GoogleTest simplifies this challenge by automatically discovering all your tests at runtime and providing mechanisms to run them in parallel or selectively filter them. This document walks you through these concepts, showing you how to leverage them effectively to speed up your testing workflow.

## Automatic Test Discovery

### What It Means

GoogleTest automatically discovers all tests by registering tests at runtime when the test executable is launched. Thanks to macros such as `TEST()`, `TEST_F()`, and related mechanisms, you do not need to manually list or register your tests.

The framework inspects all linked test cases and test suites, then runs tests that match your specified filters or all tests by default.

### How It Works for the User

- **Writing tests**: Define tests using macros like `TEST(TestSuiteName, TestName)`. As soon as your binary runs, GoogleTest knows about these tests.
- **Running tests**: Calling `RUN_ALL_TESTS()` runs every discovered test that matches the filter (or all if no filter).
- **Listing tests**: Use the flag `--gtest_list_tests` to see all available tests without running them.

### Benefits

- Eliminates the risk of forgetting to run or update test lists.
- Enables dynamic test filtering.
- Supports modular test compilation where test binaries aggregate tests automatically.

<Info>
This feature frees you from manual bookkeeping, allowing you to focus purely on writing and maintaining test logic.
</Info>

## Parallel Test Execution

### Why Parallelism Matters

Running tests serially can become prohibitively slow as test suites grow. GoogleTest supports parallel execution, allowing multiple tests to run simultaneously across CPU cores, decreasing total test duration significantly.

### Approaches to Parallel Execution

GoogleTest itself provides groundwork for parallelism; however, it delegates actual parallel test execution management to test runners or CI systems, such as the open-source `gtest-parallel` tool.

You can distribute tests:

- **Across multiple threads or processes:** Run separate tests or test suites concurrently.
- **Across multiple machines (sharding):** Split test sets to run on different hosts using environment variables `GTEST_TOTAL_SHARDS` and `GTEST_SHARD_INDEX`.

### How to Use Sharding

1. Set the total number of shards via `GTEST_TOTAL_SHARDS`.
2. Set the shard index for the current process via `GTEST_SHARD_INDEX`.
3. Run the same test binary on all shards.

GoogleTest ensures that each test is run by exactly one shard, avoiding duplication.

### Filtering to Accelerate Feedback

To focus your testing effort and time, GoogleTest supports powerful filtering via:

- **Command-line flag `--gtest_filter`**: Specify wildcard patterns to include or exclude certain tests.
- For example, `--gtest_filter=MySuite.*:OtherSuite.TestA` runs all tests under `MySuite` and the single test `OtherSuite.TestA`.
- **Running disabled tests**: Use `--gtest_also_run_disabled_tests` to include tests marked as disabled.

Filtering can be combined with parallel execution to split test runs into smaller, faster subsets.

## Putting It All Together: Accelerated Testing Workflow

### Typical User Journey

1. **Write and compile your tests** using `TEST` macros.
2. **Run your tests binary** running all tests by default.
3. For faster feedback in large projects:
   - Use **test filtering** with `--gtest_filter` to narrow focus to relevant tests.
   - Use **parallel execution tools** like `gtest-parallel` or CI shards to run tests concurrently.
4. **Iterate rapidly**, leveraging filtered and parallel test runs.

### Example: Running Specific Tests In Parallel

```bash
# Run tests whose suite names start with 'Networking' and a specific test
./my_tests --gtest_filter=Networking*:*CheckConnection

# Use gtest-parallel for parallel runs (requires separate tool)
gtest-parallel -- ./my_tests

# Run a shard (e.g., shard 0 out of 4)
GTEST_TOTAL_SHARDS=4 GTEST_SHARD_INDEX=0 ./my_tests
```

<Note>
Parallel execution requires your tests to be independent and thread-safe. GoogleTest itself is thread-safe for common operations like assertions.
</Note>

## Best Practices

- **Ensure test isolation**: Each test should be free of dependencies on others to allow safe parallel execution.
- **Use appropriate filters** for iterative development to avoid running unnecessary tests.
- **Leverage sharding** for scaling test execution across multiple machines in CI systems.
- **Utilize reporting flags** for clear output when running in parallel.

## Troubleshooting Common Issues

### Tests Not Discovered

- Verify tests use GoogleTest macros (`TEST`, `TEST_F`, etc.).
- Make sure test source files are linked into the test executable.
- Check that `InitGoogleTest()` and `RUN_ALL_TESTS()` are called properly.

### Parallel Runs Fail or Interfere

- Check that your tests do not share mutable global state without synchronization.
- Use `SetUp()` and `TearDown()` properly to prepare/clean test fixtures.
- Ensure no shared hardware or files cause race conditions.

### Filtering Does Not Work

- Confirm the filter pattern matches the full test name (`TestSuite.TestName`).
- Use `--gtest_list_tests` to verify exact names.

## Additional Resources

- [GoogleTest Primer](https://google.github.io/googletest/primer.html) — introduction to test writing
- [Running a Subset of the Tests](../advanced.md#selecting-tests) for advanced filtering details
- [Scaling Your Test Suite and Optimizing Performance](https://google.github.io/googletest/guides/practical-examples-and-patterns/scaling-tests.html) for large-scale execution guidance
- [`gtest-parallel`](https://github.com/google/gtest-parallel) — unofficial tool for parallel test execution

## Visualizing Test Execution Flow

```mermaid
flowchart TD
  Start([Start Test Execution]) --> Init[InitGoogleTest()]
  Init --> Discover[Automatic Test Discovery]
  Discover --> Filter{Apply Test Filter}
  Filter -->|Filtered Tests| RunTests[Run Selected Tests]
  Filter -->|No Filter| RunTests
  RunTests --> Parallel{Run Tests in Parallel?}
  Parallel -->|Yes| ParallelRun[Execute Tests Concurrently (Multiple Threads/Machines)]
  Parallel -->|No| SerialRun[Execute Tests Serially]
  ParallelRun --> CollectResults[Collect and Aggregate Results]
  SerialRun --> CollectResults
  CollectResults --> Report[Report Test Results]
  Report --> End([End])
```

---

## Summary

GoogleTest automatically discovers tests, freeing you from manual registration. You can speed up test feedback by running tests in parallel using external tools or CI shard-based sharding. Filtering allows targeting suites or individual tests, improving iteration time. Combined, these features ensure fast, scalable, and focused testing essential for growing C++ codebases.


---

<Callout title="Tip">
For large projects, configure your CI to run GoogleTest with sharding and filtering, along with tools like `gtest-parallel`, maximizing resource use and minimizing build times.
</Callout>

---

## Key Command Line Flags

| Flag                                 | Description                                                   |
|-------------------------------------|---------------------------------------------------------------|
| `--gtest_list_tests`                 | Lists all available tests without running them                |
| `--gtest_filter=<pattern>`           | Runs only tests matching the filter pattern                    |
| `--gtest_also_run_disabled_tests`   | Includes disabled tests in test runs                           |
| Environment: `GTEST_TOTAL_SHARDS`    | Total number of shards for distributed test execution         |
| Environment: `GTEST_SHARD_INDEX`     | Index of this shard (zero-based)                               |

---

## Conclusion

Mastering test discovery, filtering, and parallel execution allows you to harness GoogleTest’s full power for accelerating development, maintaining test quality, and scaling testing in large C++ projects. Use this guide to streamline your testing workflows and reduce feedback cycle times effectively.

---