---
title: "Platform Support and Portability"
description: "Understand the portability features, platform abstractions, and configuration options that ensure GoogleTest and GoogleMock run across diverse environments."
---

# Platform Support and Portability

GoogleTest and GoogleMock are designed to run reliably across a wide range of operating systems, compiler toolchains, and build environments. This page explains the portability features, platform abstractions, and configuration options that enable this behavior, helping users understand how the framework adapts to diverse platforms and how to tailor its configuration accordingly.

---

## 1. Supported Platforms Overview

GoogleTest follows Google's [Foundational C++ Support Policy](https://opensource.google/documentation/policies/cplusplus-support). The detailed list of supported platforms, compilers, and build tools is maintained in a compatibility matrix available [here](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md).

This policy ensures that GoogleTest maintains compatibility and stability across major platforms including Linux distributions, Windows variants (Desktop, MinGW, Mobile), Mac OS, BSD flavors, Solaris, and embedded environments. Users should verify their development environment against this matrix to confirm compatibility.

## 2. Platform Detection and Macros

To provide platform-specific behavior where necessary, GoogleTest uses a set of predefined macros detecting operating systems and platforms at compile time. These macros are automatically defined and must not be manually set by the user.

Some of the key macros include:

- `GTEST_OS_WINDOWS`, `GTEST_OS_WINDOWS_DESKTOP`, `GTEST_OS_WINDOWS_MINGW`, `GTEST_OS_WINDOWS_MOBILE` — Windows and its variants.
- `GTEST_OS_LINUX`, `GTEST_OS_LINUX_ANDROID` — Linux and Android.
- `GTEST_OS_MAC`, `GTEST_OS_IOS` — Apple platforms.
- `GTEST_OS_FREEBSD`, `GTEST_OS_OPENBSD`, `GTEST_OS_NETBSD` — BSD flavors.
- `GTEST_OS_SOLARIS` — Solaris.
- Several others for specialized or embedded platforms such as QNX, Haiku, Fuchsia, Espressif (ESP32, ESP8266), Xtensa, and more.

These macros allow internal GoogleTest code to adjust functionality such as file system operations, threading, and synchronization in a platform-appropriate manner, ensuring consistent behavior regardless of the system.

## 3. Threading and Synchronization Support

GoogleTest attempts to leverage native threading and synchronization mechanisms depending on the platform capabilities:

- **POSIX pthreads support:** When available (e.g., on Linux, BSD, Mac OS), GoogleTest uses pthreads for mutexes, thread-local storage, and thread management. This support is detected by `GTEST_HAS_PTHREAD` macro, which can be manually overridden if automatic detection fails.

- **Windows threading primitives:** On Windows platforms, including MinGW, GoogleTest employs native Windows synchronization primitives like critical sections and mutexes.

- **Thread safety:** When threading support is available and enabled, GoogleTest is fully thread-safe (`GTEST_IS_THREADSAFE` defined to 1). This ensures correct behavior in multi-threaded test scenarios.

Users can control or override threading support by defining the relevant macros at compile time, e.g., forcing `-DGTEST_HAS_PTHREAD=0` to disable pthreads.

## 4. Platform-Specific Feature Flags

GoogleTest provides feature flags reflecting platform capabilities, allowing users and internal code to adapt accordingly:

- `GTEST_HAS_DEATH_TEST` — defined on platforms supporting death tests, requiring both threading and file system support.
- `GTEST_HAS_EXCEPTIONS` — whether C++ exceptions are enabled on the compilation target.
- `GTEST_HAS_RTTI` — availability of run-time type information.
- `GTEST_HAS_STD_WSTRING` — support for `std::wstring` type.
- `GTEST_HAS_POSIX_RE` — access to POSIX regular expressions.
- `GTEST_HAS_STREAM_REDIRECTION` — if stream redirect is supported (required for some output testing & death tests).

These flags influence GoogleTest internal behavior and can also be checked by users in custom test or extension code to implement platform-aware features and workarounds.

## 5. Configuration and Platform Adaptation Mechanisms

### 5.1 Macro-Driven Portability Layer

GoogleTest and GoogleMock isolate platform differences behind macros and internal utility functions. For example, file system access, threading, and synchronization primitives are abstracted and implemented using conditional compilation and platform detection.

This approach allows GoogleTest's public API to maintain a uniform interface while adapting performance and behavior internally to the host environment.

### 5.2 Customization Points

Developers can tailor certain platform-related settings and behaviors via macros and configuration headers:

- The internal header `gmock/internal/gmock-port.h` (and inherited from `gtest-port.h`) defines platform abstractions, macro definitions, and porting utilities.

- A user-accessible customization hook exists in the `googlemock/include/gmock/internal/custom/` directory, specifically in `gmock-port.h`, where users can define or override flag-related macros such as:

  ```cpp
  GMOCK_DEFINE_bool_(name, default_val, doc)
  GMOCK_DECLARE_bool_(name)
  GMOCK_FLAG_GET(name)
  GMOCK_FLAG_SET(name, value)
  ```

  This allows control over GoogleMock's runtime flags in a platform-aware fashion.

### 5.3 Build System Integration

GoogleTest provides comprehensive build system support facilitating portability: 

- **CMake support:** Provides platform-aware compiler and linker flag configurations, adjusting for platform-specific compiler quirks and threading options (`-DGTEST_HAS_PTHREAD`, MSVC runtime linking).

- **Bazel support:** Contains platform-specific build config settings in `BUILD.bazel`, ensuring dependency and flag management matches target environments.

This reduces the chance of platform mismatches or configuration mistakes when building and deploying GoogleTest/GoogleMock.

## 6. Common Portability Considerations and Best Practices

- **Compiler Requirements:** GoogleTest requires at least C++17 support. Platforms or compilers that do not meet this requirement are not supported.

- **Runtime Exception and RTTI Status:** Ensure consistency of Exception and RTTI usage across your build system and GoogleTest to avoid linkage or behavior issues.

- **Threading Pragma and Flags:** On platforms where pthreads are optional or unavailable, explicitly define `GTEST_HAS_PTHREAD=0` to disable threading and avoid runtime surprises.

- **Avoid Manual Macro Overrides:** Unless absolutely necessary, rely on GoogleTest's automatic platform detection macros to prevent subtle build or execution faults.

- **Build Flags on Windows:** When using Visual Studio, ensure consistent runtime (static vs dynamic) linkage to avoid LNK2038 errors. The `gtest_force_shared_crt` option in CMake helps with this.

- **File System and Path Support:** GoogleTest adapts to varying file system and path conventions internally. However, tests themselves should consider platform path separators and encoding.

## 7. Troubleshooting Platform Issues

If GoogleTest fails or does not function properly on your platform, consider these steps:

- Verify your compiler fully supports C++17.
- Confirm platform support against the [Foundational C++ Support Matrix](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md).
- Check if forcing or disabling threading (`GTEST_HAS_PTHREAD`) helps.
- If linking errors occur on Windows, check runtime library settings and the `gtest_force_shared_crt` option.
- Consult the [Troubleshooting Common Setup Issues Guide](/getting-started/configuration-validation/troubleshooting-common-issues) for environment-specific fixes.

---

## Diagram: Platform Detection and Adaptation Flow

```mermaid
flowchart TD

  A[Start Build] --> B{Is Platform Detected?}

  B -->|Yes| C[Set Platform Macros (e.g. GTEST_OS_LINUX)]
  B -->|No| D[Fallback Defaults]

  C --> E{Is pthread Supported?}
  D --> E

  E -->|Yes| F[Define GTEST_HAS_PTHREAD=1]
  E -->|No| G[Define GTEST_HAS_PTHREAD=0]

  F & G --> H{Exceptions Enabled?}

  H -->|Yes| I[Define GTEST_HAS_EXCEPTIONS=1]
  H -->|No| J[Define GTEST_HAS_EXCEPTIONS=0]

  I & J --> K{RTTI Enabled?}

  K -->|Yes| L[Define GTEST_HAS_RTTI=1]
  K -->|No| M[Define GTEST_HAS_RTTI=0]

  L & M --> N{File System Available?}

  N -->|Yes| O[Define GTEST_HAS_FILE_SYSTEM=1]
  N -->|No| P[Define GTEST_HAS_FILE_SYSTEM=0]

  O & P --> Q[Configure Platform Abstractions & Build Flags]

  Q --> R[Build and Link GoogleTest/GoogleMock]

  R --> S[Run Tests]
``` 

---

## Additional Resources

- [Supported Platforms Table (External Link)](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md)
- [CMake Installation Instructions](/getting-started/setup-prerequisites-installation/installation-cmake)
- [Bazel Installation Instructions](/getting-started/setup-prerequisites-installation/installation-bazel)
- [Troubleshooting Common Setup Issues](/getting-started/configuration-validation/troubleshooting-common-issues)
- [Platform Compatibility API Reference](/api-reference/mock-behavior-extensions/platform-compatibility-configuration)


---

## Summary

Understanding platform support and portability is essential to successfully building and running GoogleTest and GoogleMock across a variety of environments. This page guides you through the platform detection macros, threading and synchronization considerations, feature flags, build integration techniques, and troubleshooting advice that ensure your test suite runs reliably on your target platforms.

Take advantage of GoogleTest's platform abstractions and comprehensive build system integrations to minimize environment-specific issues and maximize test portability.


---

## Next Steps

- Verify your development environment against the supported platforms matrix.
- Review and apply recommended compiler and build tool flags for your platform.
- Consult the [Initial Configuration Guide](/getting-started/configuration-validation/initial-configuration) and [Troubleshooting Guide](/getting-started/configuration-validation/troubleshooting-common-issues) for smooth onboarding.
- Explore the [Platform Compatibility API Reference](/api-reference/mock-behavior-extensions/platform-compatibility-configuration) to customize or extend behavior.
