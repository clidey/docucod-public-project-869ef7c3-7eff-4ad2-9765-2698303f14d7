---
title: "Assertions: Expressing Expectations"
description: "Explore the rich assertion model in GoogleTest, including built-in assertions, user-defined checks, and handling of fatal vs. non-fatal failures. Understand how these mechanisms shape test outcomes and reporting."
---

# Assertions: Expressing Expectations in GoogleTest

GoogleTest's assertion model is a cornerstone of writing robust and clear C++ tests. It enables you to express expectations about your code's behavior and verify correctness with detailed diagnostics when tests fail. This guide dives into the assertion mechanisms, covering built-in assertions, predicate assertions, fatal vs. non-fatal failures, custom messages, and best practices to help you leverage assertions effectively.

---

## 1. Overview of Assertions

GoogleTest provides a rich set of macros to check conditions in your tests. Assertions determine whether a test passes or fails by evaluating expressions you provide. They come in two flavors:

- **Fatal failures (`ASSERT_*`)**: Halt test execution immediately upon failure, resulting in abortion of the current test function.
- **Non-fatal failures (`EXPECT_*`)**: Record the failure but allow the test function to continue executing.

This dual model helps facilitate both strict enforcement and more lenient checks within the same or different tests.


### Purpose and Value

Assertions help you:

- Validate assumptions and invariants in your code.
- Get informative error messages when something goes wrong.
- Control test flow by stopping tests early on fatal failures.
- Distinguish between recoverable and unrecoverable test errors.


## 2. Built-in Assertion Macros

GoogleTest supplies a comprehensive set of macros for common testing needs.

### 2.1. Boolean Conditions

- `EXPECT_TRUE(condition)` / `ASSERT_TRUE(condition)`: Verify *condition* is true.
- `EXPECT_FALSE(condition)` / `ASSERT_FALSE(condition)`: Verify *condition* is false.

### 2.2. Binary Comparisons

Compare two values using standard comparison operators:

- `EXPECT_EQ(val1, val2)` / `ASSERT_EQ(val1, val2)`: Check equality (`==`).
- `EXPECT_NE(val1, val2)` / `ASSERT_NE(val1, val2)`: Check inequality (`!=`).
- `EXPECT_LT(val1, val2)`, `ASSERT_LT(val1, val2)`: Less-than check.
- `EXPECT_LE(val1, val2)`, `ASSERT_LE(val1, val2)`: Less-or-equal check.
- `EXPECT_GT(val1, val2)`, `ASSERT_GT(val1, val2)`: Greater-than check.
- `EXPECT_GE(val1, val2)`, `ASSERT_GE(val1, val2)`: Greater-or-equal check.

*Example:* 
```cpp
EXPECT_EQ(x, 10) << "x should be 10";
```

### 2.3. String Comparisons

C strings use special macros that compare content correctly, not just pointers:

- `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ(str1, str2)`: String equality.
- `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE(str1, str2)`: String inequality.
- `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ(str1, str2)`: Case-insensitive equality.
- `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE(str1, str2)`: Case-insensitive inequality.


### 2.4. Floating-Point Comparisons

Due to rounding errors, floating-point comparisons require special handling. GoogleTest implements:

- `EXPECT_FLOAT_EQ(val1, val2)` / `ASSERT_FLOAT_EQ(val1, val2)`: Approximate equality for `float`.
- `EXPECT_DOUBLE_EQ(val1, val2)` / `ASSERT_DOUBLE_EQ(val1, val2)`: Approximate equality for `double`.
- `EXPECT_NEAR(val1, val2, abs_error)` / `ASSERT_NEAR(val1, val2, abs_error)`: Numerical closeness within specified absolute error.


### 2.5. Exception Assertions

Verify whether code throws exceptions as expected:

- `EXPECT_THROW(statement, exception_type)` / `ASSERT_THROW(statement, exception_type)`: Ensure `statement` throws
- `EXPECT_ANY_THROW(statement)` / `ASSERT_ANY_THROW(statement)`: Ensure `statement` throws any exception
- `EXPECT_NO_THROW(statement)` / `ASSERT_NO_THROW(statement)`: Ensure `statement` does not throw


### 2.6. Explicit Success and Failure

You can generate success or failure explicitly:

- `SUCCEED()`: Records a success. Use for documentation or control flow.
- `FAIL()`: Generates a fatal failure and immediately aborts execution.
- `ADD_FAILURE()`: Generates a non-fatal failure.
- `ADD_FAILURE_AT(file, line)`: Mark failure at the specified location.

Example usage:
```cpp
if (!some_condition) {
  FAIL() << "Unexpected condition occurred";
}
```


## 3. Predicate Assertions for Richer Failure Messages

Boolean assertions often lack detailed diagnostics. To improve this, you can write predicate functions returning `AssertionResult` instead of `bool`.


### 3.1. Using `AssertionResult`

`AssertionResult` encapsulates both success/failure and detailed messages, created via factory functions:

```cpp
AssertionResult AssertionSuccess();
AssertionResult AssertionFailure();
```

You can stream explanatory messages via the `<<` operator.

### 3.2. Benefits

- Failed assertions provide descriptive info, making debugging easier.
- Works seamlessly with `EXPECT_TRUE()` / `EXPECT_FALSE()`.

Example predicate:

```cpp
testing::AssertionResult IsEven(int n) {
  if (n % 2 == 0)
    return testing::AssertionSuccess() << n << " is even";
  else
    return testing::AssertionFailure() << n << " is odd";
}
```

Using this in tests:

```cpp
EXPECT_TRUE(IsEven(5));  // Prints "5 is odd" on failure.
```

### 3.3. Predicate-Formatter Functions

For maximal control, GoogleTest supports predicate-formatter assertions, allowing you to fully customize messages according to the expressions and values:

```cpp
EXPECT_PRED_FORMAT2(MyPredicateFormatter, val1, val2);
```

Where the formatter has signature:

```cpp
testing::AssertionResult MyPredicateFormatter(const char* expr1, const char* expr2, T1 val1, T2 val2);
```


## 4. Handling Fatal vs. Non-Fatal Failures

Understanding the difference affects your test structure and flow control.

- **Fatal failures** (e.g., via `ASSERT_*` macros) abort the current test function: remaining code is skipped.
- **Non-fatal failures** (e.g., via `EXPECT_*` macros) record the failure but continue execution.

Use fatal assertions when failure makes continuing unsafe; use non-fatal assertions when you want to accumulate all failures before stopping.


## 5. Custom Failure Messages and Streaming

All assertion macros support streaming additional context to enhance failure messages.

```cpp
EXPECT_EQ(expected, actual) << "Check failed because of unexpected value.";
```

You can stream any type supporting `operator<<`, including strings, numbers, and manipulators like `std::endl`.


## 6. Working with Predicate Assertions in Practice

### Example: Simple Predicate Return

```cpp
bool IsPositive(int x) {
  return x > 0;
}

TEST(MyTest, PositiveCheck) {
  EXPECT_PRED1(IsPositive, value);
}
```

### Example: Rich Predicate With Messages

```cpp
testing::AssertionResult IsEven(int n) {
  if ((n % 2) == 0)
    return testing::AssertionSuccess() << n << " is even";
  else
    return testing::AssertionFailure() << n << " is odd";
}

TEST(MyTest, EvenCheck) {
  EXPECT_TRUE(IsEven(number));
}
```

### Example: Predicate-Formatter for Custom Messages

```cpp
testing::AssertionResult AssertSumIsEven(const char* e1, const char* e2, int n1, int n2) {
  int sum = n1 + n2;
  if ((sum % 2) == 0) return testing::AssertionSuccess();
  return testing::AssertionFailure() << e1 << " + " << e2 << " evaluates to " << sum << ", which is not even.";
}

TEST(MyTest, SumIsEven) {
  EXPECT_PRED_FORMAT2(AssertSumIsEven, a, b);
}
```


## 7. Common Pitfalls and Best Practices

- Avoid using fatal assertions in constructors or destructors since they won't terminate the test as expected.
- Use `SCOPED_TRACE` to add trace messages when testing sub-functions to help locate failures.
- For subroutines with fatal assertions that should interrupt calling tests, consider using `ASSERT_NO_FATAL_FAILURE()` or exceptions to propagate failures.
- Test carefully when using predicate assertions, especially to ensure arguments are evaluated exactly once.
- Avoid mixing `TEST` and `TEST_F` with different fixtures in the same test suite.


## 8. Advanced Usage and Extensions

Beyond the built-in set, GoogleTest allows extending assertions with:

- Custom predicates returning `AssertionResult`.
- Predicate-formatter macros for customized outcome messages.
- Integration with matchers (`EXPECT_THAT`) to combine expressive assertions.



---

# Additional Resources and Related Documentation

- [Assertions Reference](../reference/assertions.md): Full list of assertion macros with syntax and behavior.
- [Advanced Assertions](../advanced.md#more-assertions): Extending and using predicate assertions, custom messages, and exception tests.
- [Test Macros and Test Suites](../api-reference/core-testing-apis/test-macros-suites.md): How to organize tests using these assertions.
- [Core Workflows: Assertions and Matchers in Practice](../guides/core-workflows/assertions-matchers.md): Practical workflows and examples.
- [Using Predicate-Format Assertions](../advanced.md#predicate-assertions-for-better-error-messages).

Leverage these to write clearer, more maintainable tests that express your intent and provide diagnosis when failures occur.

---