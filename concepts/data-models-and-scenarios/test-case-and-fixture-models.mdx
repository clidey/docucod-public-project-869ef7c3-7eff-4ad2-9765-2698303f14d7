---
title: "Test Cases, Fixtures, and Parametrization"
description: "Examines how test cases, test suites, and shared fixtures are defined and arranged in GoogleTest. Discusses support for value-parameterized and type-parameterized tests to enable thorough validation across varied data."
---

# Test Cases, Fixtures, and Parametrization in GoogleTest

GoogleTest organizes tests around three fundamental concepts: **test cases**, **test fixtures**, and **parameterized tests**. Understanding how these components interrelate enables you to build highly organized, reusable, and scalable tests that cover a wide range of scenarios with minimal duplication.

---

## 1. Test Cases and Test Suites

### What is a Test Case (Test Suite)?
In GoogleTest, a **test case** (sometimes called a *test suite*) is a collection of related test functions. Each test case groups tests that verify the behavior of some component or logical functionality.

```cpp
TEST(TestCaseName, TestName) {
  // test code goes here
}
```

- `TestCaseName`: Groups related tests.
- `TestName`: Describes the specific behavior or aspect being tested.

### Example
```cpp
TEST(MathUtils, ReturnsTrueForEvenNumbers) {
  EXPECT_TRUE(IsEven(2));
  EXPECT_TRUE(IsEven(4));
}

TEST(MathUtils, ReturnsFalseForOddNumbers) {
  EXPECT_FALSE(IsEven(3));
  EXPECT_FALSE(IsEven(5));
}
```

Here, `MathUtils` is the test case housing multiple focused tests about even/odd detection.

---

## 2. Test Fixtures: Sharing Setup and Teardown Logic

### Why Use Test Fixtures?
Often, multiple tests require some common set-up and tear-down, like creating objects or allocating resources. Manually repeating this leads to duplication and fragile tests.

GoogleTest's **test fixtures** provide a reusable class that:

- Sets up preconditions common to several tests.
- Cleans up after tests.
- Houses shared test data members.

### Defining a Test Fixture
Define your fixture class by deriving from `::testing::Test`: 

```cpp
class MyTestFixture : public ::testing::Test {
 protected:
  void SetUp() override {
    // run before each test
  }

  void TearDown() override {
    // run after each test
  }

  // shared data members
  int shared_value;
};
```

### Writing Tests With Test Fixtures
Use the `TEST_F` macro, associating tests with your fixture:

```cpp
TEST_F(MyTestFixture, Test1) {
  shared_value = 42;
  EXPECT_EQ(shared_value, 42);
}

TEST_F(MyTestFixture, Test2) {
  shared_value = 10;
  EXPECT_EQ(shared_value, 10);
}
```

Each test runs with a fresh fixture instance, ensuring no cross-test pollution.

---

## 3. Parameterized Tests

Parameterized tests enable running the same test logic repeatedly with different input data. This avoids test duplication and allows thorough coverage across diverse inputs.

GoogleTest supports two main forms:

### 3.1 Value-Parameterized Tests

These tests run repeatedly with varying values supplied by the user.

#### Defining a Value-Parameterized Test Fixture

```cpp
class MyValueParamTest : public ::testing::TestWithParam<int> {
  // Test code can access GetParam() to retrieve the current parameter.
};
```

#### Writing Parameterized Tests

```cpp
TEST_P(MyValueParamTest, ReturnsTrueForValidInputs) {
  int val = GetParam();
  EXPECT_TRUE(IsValid(val));
}
```

#### Instantiating a Value-Parameterized Test

Use the `INSTANTIATE_TEST_SUITE_P` macro to give your test parameters:

```cpp
INSTANTIATE_TEST_SUITE_P(
    ValidInputs,      // Instance name
    MyValueParamTest, // Test case name
    ::testing::Values(1, 2, 3, 10, 20));
```

#### What Happens
GoogleTest runs `ReturnsTrueForValidInputs` 5 times, once for each parameter.

### 3.2 Type-Parameterized Tests

Sometimes, test logic needs to be validated against multiple typesâ€”e.g., ensuring a container-like class works with various element types.

#### Defining a Type-Parameterized Test Fixture

```cpp
template <typename T>
class MyTypeParamTest : public ::testing::Test {
  // Use T inside tests
};
```

#### Declaring the Test Case

```cpp
TYPED_TEST_SUITE(MyTypeParamTest, MyTypes);
```

`MyTypes` is a list of types you want to test with.

#### Writing Tests

```cpp
TYPED_TEST(MyTypeParamTest, SupportsDefaultConstruction) {
  TypeParam obj;
  EXPECT_TRUE(obj.IsEmpty());
}
```

#### Defining the Type List

```cpp
using MyTypes = ::testing::Types<int, double, std::string>;
```

GoogleTest instantiates the test once for each type in `MyTypes`.

---

## 4. Shared Fixtures and Parameterized Testing Combined

You can combine fixtures with parameterized tests to reuse setup with varied data.

This is useful for tests that share common state but need to run through diverse inputs or type variations.

---

## 5. Best Practices and Tips

- **Group related tests into test cases/suites** to structure your test code logically.
- **Use test fixtures to avoid repeating setup/teardown** code and share context cleanly.
- Always **keep tests isolated** by ensuring fixture state resets between tests.
- **Choose parameterized tests to cover many input scenarios efficiently**, reducing boilerplate.
- Use **value-parameterized tests when only inputs vary** but test code remains the same.
- Use **type-parameterized tests when test the same logic against different types or templates**.
- Avoid excessive parameterization that makes tests hard to read.
- Combine **`EXPECT_CALL` and fixture setup carefully** for mocks used in parameterized tests.

---

## 6. Troubleshooting

### Fixture Setup & Teardown
- Make sure `SetUp()` and `TearDown()` are declared `override` so they run as expected.
- Use the constructor and destructor *only* when initialization/destruction is light and failure-safe.

### Parameterized Tests
- Ensure you provide *all* necessary parameter values or types in instantiations.
- When testing templates, confirm that types are correctly declared in the type list.

### Common Pitfalls
- Avoid sharing state between tests via static or global variables; fixtures should own test state.
- Remember that `TEST_F` requires the test fixture to be a subclass of `::testing::Test`.
- Don't mix `TEST` and `TEST_F` styles for similar use cases.
- In parameterized tests, never expect test execution order unless explicitly ordered with sequences.

---

## 7. Related Topics

- [Defining Mock Methods and Setting Expectations](https://github.com/google/googletest/blob/main/docs/concepts/data-models-and-scenarios/mock-method-definition-and-expectations.md)
- [Call Sequencing and Cardinality](https://github.com/google/googletest/blob/main/docs/concepts/data-models-and-scenarios/sequence-and-cardinality.md)
- [Matchers and Actions](https://github.com/google/googletest/blob/main/docs/api-reference/core-apis/matchers.md)
- [gMock Cookbook](https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md)

---