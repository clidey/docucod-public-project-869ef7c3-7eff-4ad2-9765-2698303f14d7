---
title: "Test, Mock, and Data Models"
description: "Explore the principal data models: test suites, individual tests, fixtures, assertions, and mock object hierarchies. Understand how the framework represents and tracks test outcomes, manages parameters and types, and orchestrates setup and teardown lifecycles."
---

# Test, Mock, and Data Models

Explore the principal data models within GoogleTest, including test suites, individual tests, fixtures, assertions, and mock object hierarchies. This guide offers a clear understanding of how the framework represents and tracks test outcomes, manages parameters and types, and orchestrates setup and teardown lifecycles to ensure reliable and maintainable test execution.

---

## Understanding GoogleTest's Core Test Models

GoogleTest organizes tests into structured data models to manage your test code effectively. These models allow you to write, execute, and analyze tests with precision and flexibility.

### 1. Test Suites: The Containers of Tests

- **Definition**: A *test suite* is a collection of logically related tests grouped together. It typically corresponds to a component or class under test.
- **Characteristics**:
  - Named collections (e.g., `QueueTest`, `FactorialTest`).
  - Can be typed or parameterized with types or values.
  - May share common setup and teardown procedures (`SetUpTestSuite`, `TearDownTestSuite`).
  - Tracks test run statistics: counts of passed, failed, skipped, and disabled tests.

### 2. Individual Tests (TestInfos)

- **Definition**: An individual *test* is a unit of execution within a test suite. GoogleTest represents each test by a `TestInfo` object.
- **Identity**: Defined by a name and the suite it belongs to.
- **Properties**:
  - Knows if it is enabled or disabled.
  - Tracks if it should run given filters and sharding.
  - Stores parameter type and parameter value strings if parameterized.
  - Records detailed test execution results, including failures and timing.

### 3. Test Fixtures: Reusable Test Contexts

- **Purpose**: Test fixtures (`testing::Test` subclasses) encapsulate shared setup and teardown logic for tests.
- **Lifecycle Methods**:
  - `SetUpTestSuite()` / `TearDownTestSuite()`: Static methods for suite-level setup/teardown.
  - `SetUp()` / `TearDown()`: Instance methods called before and after each test.
- **Execution Flow**: For each test, GoogleTest creates a new fixture instance, runs `SetUp()`, executes the test body, runs `TearDown()`, then destroys the instance.

### 4. Assertions and Results

- **Assertions** contribute to a test’s `TestResult`.
- Each assertion produces a `TestPartResult` that records:
  - Outcome (`kSuccess`, `kNonFatalFailure`, `kFatalFailure`, `kSkip`).
  - Source file and line number.
  - Failure messages and optional stack traces.
- `TestResult` maintains all `TestPartResults` and properties recorded during execution.
- Tests are considered passing if they have no failed assertions and are not skipped.

### 5. Parameterized and Typed Tests

- **Value-Parameterized Tests (`TEST_P`)**
  - Run the same test logic with different data inputs.
  - Test classes inherit from `TestWithParam<T>`.
  - Parameters are accessed at runtime via `GetParam()`.
  - Instantiated using `INSTANTIATE_TEST_SUITE_P` with generators like `Values()`, `Range()`, etc.
  - Helpful to test functions or classes with multiple sets of inputs without duplicated code.

- **Typed Tests (`TYPED_TEST`) and Type-Parameterized Tests (`TYPED_TEST_P`)**
  - Enable running tests against a list of types.
  - Fixtures are class templates parameterized by a type.
  - Declare type lists with `::testing::Types<Types...>`.
  - Register and instantiate typed test suites with provided macros.
  - Useful for template-based code verification across type variations.

### 6. Mock Object Hierarchies (Overview)

- While not detailed here, mocks in GoogleMock fit into test models as specialized fixtures or objects providing controlled behavior.
- Mocks link to expectations, actions, and matchers to simulate complex interactions.

---

## Lifecycle and Result Tracking

Understanding lifecycle methods and result tracking is essential to managing test execution and reporting reliably.

### Test Execution Lifecycle

1. **Test Suite Setup**: Before any test runs in a suite, `SetUpTestSuite()` is called once.
2. **Test Preparation**: For each test:
   - GoogleTest constructs a fresh fixture instance.
   - Runs the fixture's `SetUp()` method.
3. **Test Body Execution**: The test logic defined in the test body runs.
4. **Test Teardown**: Immediately after the test, the fixture's `TearDown()` method is called.
5. **Test Suite Teardown**: After all tests in the suite finish, `TearDownTestSuite()` runs.

### Result Aggregation

- Each test execution produces a `TestResult` with assertion outcomes.
- Test suite aggregates individual test successes, failures, skips, disabled counts.
- GoogleTest aggregates overall test program success from all test suites.

---

## Practical User Insights

### Accessing Test Information at Runtime

- Use APIs like `testing::UnitTest::GetInstance()` to query test results, e.g.,

```cpp
const testing::TestSuite* suite = 
    testing::UnitTest::GetInstance()->GetTestSuite(0);
int passed = suite->successful_test_count();
```

- Retrieve detailed failure info via `TestInfo` and `TestResult` objects.

### Controlling Test Execution

- Enable or disable tests by naming conventions (`DISABLED_` prefix).
- Filter tests at runtime using wildcards on test suite or test names.
- Use sharding environment integration to run subsets of tests concurrently.

### Parameterized Test Example

```cpp
class MyParamTest : public testing::TestWithParam<int> {};

TEST_P(MyParamTest, HandlesVariousInputs) {
  int param = GetParam();
  EXPECT_GT(param, 0);
}

INSTANTIATE_TEST_SUITE_P(PositiveNumbers, MyParamTest, testing::Values(1, 2, 3));
```

### Typed Test Example

```cpp
template <typename T>
class MyTypedTest : public testing::Test {
 protected:
  T value_ = T();
};

using MyTypes = ::testing::Types<int, double>;
TYPED_TEST_SUITE(MyTypedTest, MyTypes);

TYPED_TEST(MyTypedTest, IsDefaultConstructible) {
  EXPECT_EQ(this->value_, TypeParam());
}
```

---

## Common Pitfalls & Best Practices

- Always call `testing::InitGoogleTest(&argc, argv)` before `RUN_ALL_TESTS()`.
- Use proper macros that correspond to your test fixture type (`TEST`, `TEST_F`, `TEST_P`, `TYPED_TEST`).
- Avoid mixing `TEST` and `TEST_F` in the same test suite.
- For parameterized tests, remember to instantiate your test suites or allow uninstantiated suites explicitly.
- Use the `RecordProperty` API to attach metadata for test cases.
- Prefer `EXPECT_` assertions for validations where continuation after failure is useful.
- Use `ASSERT_` assertions when it does not make sense to continue after a failure in a test.

---

## Diagram: GoogleTest Core Data Model Overview

```mermaid
classDiagram
  class UnitTest {
    +GetInstance()
    +GetTestSuite(int)
    +Run()
    +successful_test_count()
    +failed_test_count()
  }

  class TestSuite {
    +name()
    +AddTestInfo(TestInfo)
    +Run()
    +successful_test_count()
    +failed_test_count()
    +test_to_run_count()
  }

  class TestInfo {
    +name()
    +should_run()
    +result()
    +Run()
  }

  class TestResult {
    +Passed()
    +Failed()
    +Skipped()
    +GetTestPartResult(int)
  }

  class TestPartResult {
    +passed()
    +failed()
    +message()
  }

  UnitTest "1" -- "*" TestSuite : contains >
  TestSuite "1" -- "*" TestInfo : contains >
  TestInfo "1" -- "1" TestResult : has >
  TestResult "*" -- "*" TestPartResult : contains >

  class Test {
    +SetUp()
    +TearDown()
    +TestBody()
  }
  TestInfo "1" -- "1" Test : creates >

  class TestWithParam<T> {
    +GetParam()
  }
  TestInfo ..> TestWithParam : For parameterized tests

  class TypedTest<Fixture,T> {
  }
  TestSuite ..> TypedTest : For typed tests
```

---

## Related APIs and Further Reading

- [TEST, TEST_F, TEST_P Macros](../reference/testing.md#TEST)
- [Parameterized Tests](../api-reference/core-testing-apis/parameterized-typed-tests.md)
- [Typed Tests](../api-reference/core-testing-apis/parameterized-typed-tests.md#typed-tests)
- [Test Fixtures and Setup/Teardown](../guides/core-testing-workflows/fixtures-setup-teardown.md)
- [Assertions and Expectations](../api-reference/core-testing-apis/assertions.md)
- [Mocking Concepts and Expectations](../overview/core-concepts-terminology/concepts-mocking.md)

---

GoogleTest’s structured data models help you organize, run, and understand your tests with precision. Grasping the lifecycle and relations of test suites, tests, results, and parameters empowers you to write expressive, maintainable, and scalable tests.


---