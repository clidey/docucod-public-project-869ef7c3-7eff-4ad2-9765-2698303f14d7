---
title: "Platform Support and Test Isolation"
description: "Review GoogleTest's support across compilers, platforms, and the steps taken to ensure test isolation and predictable execution. Understand sandboxing, output management, and guarding against environmental contamination."
---

# Platform Support and Test Isolation

GoogleTest delivers robust and consistent C++ test execution across a broad range of platforms and compilers, with deliberate design measures to ensure test isolation and predictable behavior. This documentation page clarifies how GoogleTest achieves portability, test sandboxing, output management, and isolation from environmental contamination, addressing the challenges faced when running tests in diverse environments.

---

## Supported Platforms and Compiler Compatibility

GoogleTest adheres to Google's [Foundational C++ Support Policy](https://opensource.google/documentation/policies/cplusplus-support), ensuring compatibility with numerous widely used operating systems and compilers. This enables developers to write platform-neutral tests that run seamlessly on Linux, Windows, macOS, and various embedded systems.

- **Core supported platforms include:** Linux (x86/x64/ARM), Windows Desktop and MinGW, macOS, FreeBSD, and Android.
- **Embedded platforms with partial support:** ESP8266, ESP32, and NRF52 with Arduino frameworks.
- **Compilers:** GCC (generally recent versions supporting C++17), Clang, MSVC (Visual Studio 2015 and above), Intel Compiler, and others.

> GoogleTest internally detects platform types via predefined macros (e.g., `GTEST_OS_LINUX`, `GTEST_OS_WINDOWS_MINGW`) and configures features accordingly.

### Key Compiler and Platform Considerations

- **Thread Safety:** GoogleTest is thread-safe on platforms supporting pthreads or Windows threading. It uses synchronization mechanisms where available; otherwise, it disables threading features safely.
- **Exception and RTTI Support:** GoogleTest adapts to environments both with and without exceptions or RTTI enabled, broadening portability.
- **Wide-string and Unicode:** Unicode support varies by platform, and wide strings are handled carefully to maintain consistent test reporting.

Users should consult the official [platform compatibility matrix](https://github.com/google/oss-policies-info/blob/main/foundational-cxx-support-matrix.md) for the latest compiler and platform support details.

---

## Ensuring Test Isolation and Predictable Execution

One of GoogleTest's foundational principles is that **tests must be independent and repeatable**, ensuring that a failing test does not affect the outcome of others and simplifying debugging.

### Isolation Mechanisms

- **Fresh Test Fixtures:** Each test creates a new test fixture instance, running constructor, `SetUp()`, test body, `TearDown()`, and destructor in a clean scope. This guarantees no state leakage between tests.
- **Environment Resetting:** GoogleTest avoids persistent side effects by managing thread-local storage and by restricting global mutable state usage.
- **Output Capture and Management:** On supported platforms, GoogleTest captures standard output and error streams during test execution, enabling isolated, per-test logging and preventing output interleaving.

<Tip>
When a test uses global or static resources, consider resetting or isolating those manually in your fixtures to maintain true independence.
</Tip>

### Sandboxing and Death Tests

- **Death Tests:** GoogleTest supports running death tests in separate processes on platforms that allow it, preventing crashes or undefined behavior in one test from halting the entire suite.
- **Sandboxing Limitations:** While GoogleTest itself does not provide OS-level sandboxing, it leverages OS features (fork on POSIX, process spawning on Windows) to isolate certain test types.

### Best Practices for Users to Enhance Isolation

- Avoid sharing mutable global state.
- Use thread-safe constructs to protect shared resources.
- Isolate system resource usage (files, environment variables) within test fixture setup and teardown.

---

## Initialization and Main Entry Points Adapted to Platforms

GoogleTest provides platform-specific main entry points to simplify test execution:

- On most desktop platforms, users link with `gtest_main` or `gmock_main` libraries providing a default `main()` function that initializes GoogleTest/GoogleMock and runs all tests.
- On embedded platforms such as ESP8266/ESP32 with Arduino, GoogleTest adapts by providing `setup()` and `loop()` functions instead, integrating with the Arduino lifecycle and running tests in `loop()`.

For example, on embedded Arduino-like platforms:

```c++
void setup() {
  testing::InitGoogleMock();  // Initializes both GoogleMock and GoogleTest
}

void loop() {
  RUN_ALL_TESTS();  // Executes all tests continuously (typically once)
}
```

On Windows Desktop and other desktop platforms, the default `main()` looks like:

```c++
int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Parses flags and initializes
  return RUN_ALL_TESTS();  // Runs all tests and returns pass/fail status
}
```

> These standardized entry points ensure reliable and consistent test runs across environments.

---

## Managing Output and Environmental Contamination

To maintain clean test results and assist in debugging, GoogleTest carefully handles output streams:

- **Stream Redirection:** On platforms that support it, standard output (stdout) and standard error (stderr) can be captured and associated with individual tests. This captures logs while isolating output, preventing interleaving between concurrently running tests.
- **Filtering and Flags:** Users can customize verbosity and output formatting through command-line flags parsed by `InitGoogleTest` and `InitGoogleMock`.

Environmental factors are managed as follows:

- GoogleTest checks for file system availability and disables features such as death tests if the environment cannot support them.
- Flags and environment variables are respected, allowing flexibility in enabling/disabling behaviors like verbose logging, mock behavior settings, and threading.

---

## Troubleshooting Platform-Specific Issues

Common platform-related issues arise when:

- Running on embedded or minimal environments that lack full OS services.
- Using unsupported compilers or outdated toolchains.
- Sharing environment/global state unintentionally between tests.

GoogleTest mitigates these by:

- Detecting platform capabilities at compile-time and adjusting feature availability.
- Providing diagnostics and flag-driven controls.

Users encountering platform issues should review build configurations against the supported matrices and apply isolation best practices.

---

## Summary

GoogleTest ensures broad platform compatibility and rigorous test isolation by combining OS-level awareness, fresh test fixture creation, output capture, and adaptable entry points tailored to various environments. Whether running on desktop Linux or embedded microcontrollers, GoogleTest provides reliable, predictable test execution that maximizes portability and minimizes flaky test behavior.

For comprehensive usage, users are encouraged to consult integration and setup documentation tailored to their platform and build system.

---

## Related Documentation

- [Overview: Core Concepts & Terminology](https://google.github.io/googletest/overview/concepts-architecture/core-concepts-terminology)
- [Configuration and Integration Guide](https://google.github.io/googletest/api/configuration_integration/running_tests_entrypoints.html)
- [Installation and Setup for Multiple Platforms](https://google.github.io/googletest/guides/getting-started/setup-installation.html)
- [Troubleshooting Common Issues](https://google.github.io/googletest/guides/integration-and-real-world-scenarios/troubleshooting-common-issues.html)

---

## Example Code Snippet: Using Default main() on Desktop

```c++
#include <gmock/gmock.h>

int main(int argc, char** argv) {
  testing::InitGoogleMock(&argc, argv);  // Parses flags for GoogleMock & GoogleTest
  return RUN_ALL_TESTS();  // Executes all tests and returns the status
}
```

## Example Code Snippet: Embedded Platform Arduino Integration

```c++
#include <gmock/gmock.h>

void setup() {
  testing::InitGoogleMock();
}

void loop() {
  RUN_ALL_TESTS();
}
```

---