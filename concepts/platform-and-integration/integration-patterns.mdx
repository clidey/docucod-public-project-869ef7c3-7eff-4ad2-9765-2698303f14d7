---
title: "Integration Patterns and Main Entry Points"
description: "Master typical integration workflows: invoking test runners, collaborating with build systems, and extending test environments for embedded, desktop, and CI contexts. Identify main entry points and hooks for customizing execution."
---

# Integration Patterns and Main Entry Points

Master typical integration workflows: invoking test runners, collaborating with build systems, and extending test environments for embedded, desktop, and CI contexts. Identify main entry points and hooks for customizing execution.

---

## Introduction

Working with GoogleTest and GoogleMock involves coordinating various integration patterns that enable seamless invocation of tests, interaction with build systems, and extension of test environments across diverse platforms. This guide breaks down these typical integration workflows, focusing on the practical entry points and extensibility mechanisms that users employ to control test execution.

You'll learn how to invoke test runners programmatically or via build integrations, engage with CI environments effectively, and extend testing contexts for embedded and desktop use cases.

---

## Invoking Test Runners

Whether running tests locally during development or automating test execution in CI pipelines, knowing how to invoke the GoogleTest runner is crucial.

### Typical User Flow

1. **Local Invocation:** Running tests via the command line or IDE integration.
2. **Automated Invocation:** Integration with build tools like CMake or Bazel.
3. **Programmatic Invocation:** Using API entry points to control test execution from custom harnesses.

### Command-Line Run

You typically run your tests executable directly, optionally supplying command-line flags to control behavior:

```bash
./my_test_executable --gtest_filter=MyTestSuite.* --gmock_verbose=warning
```

Key flags include:
- `--gtest_filter`: Selects tests to execute.
- `--gmock_verbose`: Controls logging verbosity of mock-related warnings.

### Programmatic Main Entry Point

In your test driver, GoogleTest provides the main entry function:

```cpp
int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  return RUN_ALL_TESTS();
}
```

This initializes GoogleMock and GoogleTest, parses flags, and runs all registered tests.

---

## Collaborating with Build Systems

Integration with build systems like CMake and Bazel is common and essential for automated testing.

### Key Integration Patterns

- **Target Definition:** Define test binaries with dependencies and compiler flags.
- **Test Registration:** Add tests to build system test runners (e.g., `add_test()` in CMake).
- **Parallel Execution:** Enable parallel test runs where possible.
- **Test Filtering:** Pass test filtering flags through the build system.

### Example: CMake

```cmake
add_executable(my_tests test1.cpp test2.cpp)
target_link_libraries(my_tests gmock_main gtest_main)
add_test(NAME runMyTests COMMAND my_tests)
```

This defines a test executable and registers it with the CTest runner.

### Example: Bazel

```bzl
cc_test(
    name = "my_tests",
    srcs = ["test1.cc", "test2.cc"],
    deps = ["@com_google_googletest//:gmock_main"],
)
```

Bazel runs the tests as part of its testing infrastructure.

---

## Extending Test Environments

GoogleTest and GoogleMock are designed to support extension and customization for specialized environments.

### Embedded Systems

Tests may run on constrained platforms or simulators. Integration often involves:

- Custom test runners that invoke GoogleTest APIs.
- Adapted logging and output capture to fit embedded constraints.

### Desktop Applications

Integration leverages unit test drivers executed locally or as part of IDE workflows.

### Continuous Integration (CI)

CI contexts require special considerations:

- Automated triggers for test runs on code pushes.
- Reporting test outcomes in formats compatible with CI dashboards.
- Use of command-line options to select tests or output XML for test reports.

### Main Entry Points and Hooks for Customizing Execution

GoogleTest provides hooks and customization points, such as:

- **Event Listeners:** Allow injecting custom logic before and after tests or test cases.
- **Environment Objects:** Set up shared resources before any test runs and clean up after all tests.
- **Test Filters:** Programmatically control which tests run.

Example of registering a custom event listener to log additional info:

```cpp
class MyListener : public ::testing::EmptyTestEventListener {
  void OnTestStart(const ::testing::TestInfo& test_info) override {
    std::cout << "Starting test: " << test_info.name() << std::endl;
  }
};

int main(int argc, char** argv) {
  ::testing::InitGoogleMock(&argc, argv);
  ::testing::TestEventListeners& listeners = 
      ::testing::UnitTest::GetInstance()->listeners();
  listeners.Append(new MyListener);
  return RUN_ALL_TESTS();
}
```

This lets users inject behavior without modifying individual tests.

---

## Best Practices

- Integrate test execution via the build system for automation.
- Use the GoogleTest main function or invoke tests programmatically for flexible control.
- Extend test lifecycle using environments and event listeners to accommodate specialized contexts.
- Use command-line flags to manage test selection and output verbosity.
- Where applicable, leverage GoogleMock features like expectations, default actions, and strictness options to manage mock behavior during test execution.

---

## Troubleshooting Common Integration Issues

- Ensure all mock expectations are set before test execution begins.
- Verify correct linkage of GoogleTest and GoogleMock libraries in your build system.
- Use `--gmock_verbose=info` to diagnose mock call interactions during tests.
- For flaky tests in CI, consider parallel test execution impact and synchronization.

---

## Summary

This page focused exclusively on key integration patterns and primary entry points for GoogleTest and GoogleMock. It complements other documentation surrounding mocking techniques, expectation management, and testing workflows.

For deeper exploration, please consult:

- **[gMock Cookbook](gmock_cook_book.md)** for advanced mocking idioms and recipes
- **[Mocking Reference](reference/mocking.md)** for detailed macro and API usage
- **[Integration & Platform Support](overview/integration-and-getting-started/integration-points.md)** covering platform-portability and build system integration
- **[Test Discovery & Execution Workflows](guides/essential-testing-patterns/test-discovery-execution.md)** to understand filtering and test runs

---

## Related Links

- [GoogleMock API Reference: Mock Classes & Methods](api-reference/mocking-apis/mock-classes-methods.md)
- [GoogleMock API Reference: Defining Expectations & Actions](api-reference/mocking-apis/defining-expectations-actions.md)
- [GoogleTest Guide: Integration & Platform Support](overview/integration-and-getting-started/integration-points.md)
- [GoogleMock for Dummies Tutorial](gmock_for_dummies.md)

---