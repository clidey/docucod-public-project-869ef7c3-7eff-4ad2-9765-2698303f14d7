---
title: "Assertions and Failure Handling"
description: "Explore the principles behind GoogleTest's assertion mechanisms, including how fatal and non-fatal failures are processed and the impact on test flow. Understand how assertions provide meaningful diagnostics for more robust tests."
---

# Assertions and Failure Handling

Explore the principles behind GoogleTest's assertion mechanisms, including how fatal and non-fatal failures are processed and the impact on test flow. Understand how assertions provide meaningful diagnostics for more robust tests.

---

## Overview

Assertions are the core of GoogleTest's capability to verify code correctness during test execution. They allow you to state expected conditions and compare actual outcomes against these expectations. When assertions fail, GoogleTest provides informative diagnostics to help you identify and resolve issues quickly.

GoogleTest distinguishes between two types of failures:

- **Fatal failures**: Indicate a critical test failure and will abort the current function immediately.
- **Non-fatal failures**: Indicate a failure but allow the current function to continue running, enabling multiple checks in one test.

Using the right type of assertion in the right context is essential for efficient and effective testing.

---

## Types of Assertions

### Fatal Assertions

Fatal assertions immediately abort the current function upon failure, preventing any further test code execution in that function. They are useful when continuing could cause misleading or cascading errors.

Fatal assertion macros begin with `ASSERT_`, such as:

- `ASSERT_TRUE(condition)`
- `ASSERT_EQ(val1, val2)`
- `ASSERT_THROW(statement, exception_type)`

#### Example:

```cpp
ASSERT_EQ(expected_value, actual_value) << "Mismatch detected in calculation.";
// Code below won't be executed if assertion fails.
```

### Non-Fatal Assertions

Non-fatal assertions report failures but allow the test to proceed, enabling multiple verifications in a single test case. They begin with `EXPECT_`, for example:

- `EXPECT_TRUE(condition)`
- `EXPECT_NE(val1, val2)`
- `EXPECT_NO_THROW(statement)`

#### Example:

```cpp
EXPECT_TRUE(IsInitialized());
EXPECT_EQ(expected_size, container.size()) << "Container size mismatch.";
// Further assertions and test logic will continue despite failures.
```

---

## Explicit Success and Failure

GoogleTest provides explicit macros to document success or signal failures directly when control flow determines the outcome rather than an expression.

| Macro        | Description                                 |
|--------------|---------------------------------------------|
| `SUCCEED()`  | Generates a non-failure success indication. Useful for documentation or signaling explicit pass conditions.
| `FAIL()`     | Generates a fatal failure and aborts the current function.
| `ADD_FAILURE()` | Generates a non-fatal failure, continuing execution.
| `ADD_FAILURE_AT(file, line)` | Generates a non-fatal failure at a specified source location, improving error traceability.

### Example:

```cpp
switch (value) {
  case expected_value:
    SUCCEED();
    break;
  default:
    FAIL() << "Unexpected value encountered: " << value;
}
```

---

## Generalized Assertions

GoogleTest extends the assertion model through matcher-based conditions, allowing expressive, readable validations.

### `EXPECT_THAT`

`EXPECT_THAT(value, matcher)` verifies `value` against a gMock matcher, supporting powerful, readable conditions.

```cpp
EXPECT_THAT(name, StartsWith("User_"));
EXPECT_THAT(numbers, ElementsAre(1, 2, 3));
```

Matchers enable concise and expressive assertions, yielding clear diagnostics on failure.

For more details, see [Matchers Reference](matchers.md).

---

## Boolean Condition Assertions

GoogleTest provides assertions directly testing Boolean expressions:

- `EXPECT_TRUE(condition)`, `ASSERT_TRUE(condition)`
- `EXPECT_FALSE(condition)`, `ASSERT_FALSE(condition)`

Use these when your test logic depends on predicates or functions returning Booleans.

### Example:

```cpp
EXPECT_TRUE(IsValid(input)) << "Input should be valid.";
```

---

## Binary Comparison Assertions

Use these to compare two values with operators (`==`, `!=`, `<`, `>`, `<=`, `>=`). When failing, GoogleTest prints both values for diagnostic clarity.

| Macro       | Description                                   |
|-------------|-----------------------------------------------|
| `EXPECT_EQ(val1, val2)` / `ASSERT_EQ` | Tests if `val1 == val2`.
| `EXPECT_NE(val1, val2)` / `ASSERT_NE` | Tests if `val1 != val2`.
| `EXPECT_LT(val1, val2)` / `ASSERT_LT` | Tests if `val1 < val2`.
| `EXPECT_LE(val1, val2)` / `ASSERT_LE` | Tests if `val1 <= val2`.
| `EXPECT_GT(val1, val2)` / `ASSERT_GT` | Tests if `val1 > val2`.
| `EXPECT_GE(val1, val2)` / `ASSERT_GE` | Tests if `val1 >= val2`.

**Important:** For C strings, prefer `EXPECT_STREQ` or `EXPECT_STRNE` for content comparison.

### Example:

```cpp
EXPECT_EQ(expected_size, vector.size()) << "Vector size mismatch.";
```

---

## String Comparison Assertions

Specialized assertions handle C string comparisons (char pointers). Unlike `EXPECT_EQ`, these test string contents instead of pointer equality.

| Macro           | Description                             |
|-----------------|-----------------------------------------|
| `EXPECT_STREQ(str1, str2)` / `ASSERT_STREQ` | Verifies string equality.
| `EXPECT_STRNE(str1, str2)` / `ASSERT_STRNE` | Verifies string inequality.
| `EXPECT_STRCASEEQ(str1, str2)` / `ASSERT_STRCASEEQ` | Case-insensitive equality.
| `EXPECT_STRCASENE(str1, str2)` / `ASSERT_STRCASENE` | Case-insensitive inequality.

---

## Floating-Point Comparison Assertions

Floating-point numbers require approximate comparison due to rounding errors. GoogleTest provides specific macros:

- `EXPECT_FLOAT_EQ(val1, val2)`: compares floats within 4 Units in the Last Place (ULPs).
- `EXPECT_DOUBLE_EQ(val1, val2)`: compares doubles with similar precision.
- `EXPECT_NEAR(val1, val2, abs_error)`: compares values within a specified absolute error.

### Example:

```cpp
EXPECT_NEAR(computed_value, expected_value, 1e-5) << "Computation error too large.";
```

---

## Exception Assertions

Verify that code throws or does not throw exceptions:

- `EXPECT_THROW(statement, exception_type)`
- `EXPECT_ANY_THROW(statement)`
- `EXPECT_NO_THROW(statement)`

### Example:

```cpp
EXPECT_THROW(MyFunc(42), std::invalid_argument);
```

Supports checking compound statements as well.

---

## Best Practices and Tips

- Use `ASSERT_` macros when a failure invalidates subsequent code in the test.
- Use `EXPECT_` macros to continue testing multiple conditions for richer diagnostics.
- Add custom failure messages with streaming `<<` to clarify intent.
- Prefer specialized assertions (e.g., `EXPECT_STREQ` for strings) to ensure semantic correctness.

---

## Troubleshooting Common Issues

### Assertion Failures

When an assertion fails, GoogleTest prints the failed expression, expected condition, and actual values to help find the root cause quickly.

### Test Flow

Remember that fatal failures abort only the current function, allowing other tests or test cases to continue.

### Debugging

Leverage verbose test output and failure messages to quickly identify and fix assertion failures.

---

For detailed usage, examples, and advanced scenarios, see GoogleTest's [Assertions Reference](reference/assertions.md) and [Matchers Reference](reference/matchers.md).

---

### Related Documentation

- [Assertions Reference](reference/assertions.md)
- [Matchers Reference](reference/matchers.md)
- [Advanced GoogleTest Features](advanced.md)
- [Writing Your First Test](googletest-guides/getting-started/primer-first-test)

---

Together, these assertions and their powerful failure diagnostics empower you to build robust, maintainable test suites that catch defects early and provide clear feedback for rapid fixes.
